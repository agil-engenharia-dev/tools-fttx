var jA=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var uf=(t,e,n)=>(jA(t,e,"read from private field"),n?n.call(t):e.get(t)),k0=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Hb=(t,e,n,o)=>(jA(t,e,"write to private field"),o?o.call(t,n):e.set(t,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function n(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerpolicy&&(c.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?c.credentials="include":l.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(l){if(l.ep)return;l.ep=!0;const c=n(l);fetch(l.href,c)}})();var fa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function QS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pv={},qk={get exports(){return Pv},set exports(t){Pv=t}},dx={},Jn={},Jk={get exports(){return Jn},set exports(t){Jn=t}},qr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qv=Symbol.for("react.element"),Kk=Symbol.for("react.portal"),Qk=Symbol.for("react.fragment"),tP=Symbol.for("react.strict_mode"),eP=Symbol.for("react.profiler"),nP=Symbol.for("react.provider"),iP=Symbol.for("react.context"),rP=Symbol.for("react.forward_ref"),oP=Symbol.for("react.suspense"),sP=Symbol.for("react.memo"),aP=Symbol.for("react.lazy"),UA=Symbol.iterator;function lP(t){return t===null||typeof t!="object"?null:(t=UA&&t[UA]||t["@@iterator"],typeof t=="function"?t:null)}var tE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},eE=Object.assign,nE={};function Eg(t,e,n){this.props=t,this.context=e,this.refs=nE,this.updater=n||tE}Eg.prototype.isReactComponent={};Eg.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Eg.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iE(){}iE.prototype=Eg.prototype;function e2(t,e,n){this.props=t,this.context=e,this.refs=nE,this.updater=n||tE}var n2=e2.prototype=new iE;n2.constructor=e2;eE(n2,Eg.prototype);n2.isPureReactComponent=!0;var GA=Array.isArray,rE=Object.prototype.hasOwnProperty,i2={current:null},oE={key:!0,ref:!0,__self:!0,__source:!0};function sE(t,e,n){var o,l={},c=null,p=null;if(e!=null)for(o in e.ref!==void 0&&(p=e.ref),e.key!==void 0&&(c=""+e.key),e)rE.call(e,o)&&!oE.hasOwnProperty(o)&&(l[o]=e[o]);var r=arguments.length-2;if(r===1)l.children=n;else if(1<r){for(var w=Array(r),M=0;M<r;M++)w[M]=arguments[M+2];l.children=w}if(t&&t.defaultProps)for(o in r=t.defaultProps,r)l[o]===void 0&&(l[o]=r[o]);return{$$typeof:Qv,type:t,key:c,ref:p,props:l,_owner:i2.current}}function uP(t,e){return{$$typeof:Qv,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function r2(t){return typeof t=="object"&&t!==null&&t.$$typeof===Qv}function cP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ZA=/\/+/g;function $b(t,e){return typeof t=="object"&&t!==null&&t.key!=null?cP(""+t.key):e.toString(36)}function c1(t,e,n,o,l){var c=typeof t;(c==="undefined"||c==="boolean")&&(t=null);var p=!1;if(t===null)p=!0;else switch(c){case"string":case"number":p=!0;break;case"object":switch(t.$$typeof){case Qv:case Kk:p=!0}}if(p)return p=t,l=l(p),t=o===""?"."+$b(p,0):o,GA(l)?(n="",t!=null&&(n=t.replace(ZA,"$&/")+"/"),c1(l,e,n,"",function(M){return M})):l!=null&&(r2(l)&&(l=uP(l,n+(!l.key||p&&p.key===l.key?"":(""+l.key).replace(ZA,"$&/")+"/")+t)),e.push(l)),1;if(p=0,o=o===""?".":o+":",GA(t))for(var r=0;r<t.length;r++){c=t[r];var w=o+$b(c,r);p+=c1(c,e,n,w,l)}else if(w=lP(t),typeof w=="function")for(t=w.call(t),r=0;!(c=t.next()).done;)c=c.value,w=o+$b(c,r++),p+=c1(c,e,n,w,l);else if(c==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return p}function P0(t,e,n){if(t==null)return t;var o=[],l=0;return c1(t,o,"","",function(c){return e.call(n,c,l++)}),o}function hP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vu={current:null},h1={transition:null},fP={ReactCurrentDispatcher:vu,ReactCurrentBatchConfig:h1,ReactCurrentOwner:i2};qr.Children={map:P0,forEach:function(t,e,n){P0(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return P0(t,function(){e++}),e},toArray:function(t){return P0(t,function(e){return e})||[]},only:function(t){if(!r2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qr.Component=Eg;qr.Fragment=Qk;qr.Profiler=eP;qr.PureComponent=e2;qr.StrictMode=tP;qr.Suspense=oP;qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fP;qr.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var o=eE({},t.props),l=t.key,c=t.ref,p=t._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,p=i2.current),e.key!==void 0&&(l=""+e.key),t.type&&t.type.defaultProps)var r=t.type.defaultProps;for(w in e)rE.call(e,w)&&!oE.hasOwnProperty(w)&&(o[w]=e[w]===void 0&&r!==void 0?r[w]:e[w])}var w=arguments.length-2;if(w===1)o.children=n;else if(1<w){r=Array(w);for(var M=0;M<w;M++)r[M]=arguments[M+2];o.children=r}return{$$typeof:Qv,type:t.type,key:l,ref:c,props:o,_owner:p}};qr.createContext=function(t){return t={$$typeof:iP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:nP,_context:t},t.Consumer=t};qr.createElement=sE;qr.createFactory=function(t){var e=sE.bind(null,t);return e.type=t,e};qr.createRef=function(){return{current:null}};qr.forwardRef=function(t){return{$$typeof:rP,render:t}};qr.isValidElement=r2;qr.lazy=function(t){return{$$typeof:aP,_payload:{_status:-1,_result:t},_init:hP}};qr.memo=function(t,e){return{$$typeof:sP,type:t,compare:e===void 0?null:e}};qr.startTransition=function(t){var e=h1.transition;h1.transition={};try{t()}finally{h1.transition=e}};qr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};qr.useCallback=function(t,e){return vu.current.useCallback(t,e)};qr.useContext=function(t){return vu.current.useContext(t)};qr.useDebugValue=function(){};qr.useDeferredValue=function(t){return vu.current.useDeferredValue(t)};qr.useEffect=function(t,e){return vu.current.useEffect(t,e)};qr.useId=function(){return vu.current.useId()};qr.useImperativeHandle=function(t,e,n){return vu.current.useImperativeHandle(t,e,n)};qr.useInsertionEffect=function(t,e){return vu.current.useInsertionEffect(t,e)};qr.useLayoutEffect=function(t,e){return vu.current.useLayoutEffect(t,e)};qr.useMemo=function(t,e){return vu.current.useMemo(t,e)};qr.useReducer=function(t,e,n){return vu.current.useReducer(t,e,n)};qr.useRef=function(t){return vu.current.useRef(t)};qr.useState=function(t){return vu.current.useState(t)};qr.useSyncExternalStore=function(t,e,n){return vu.current.useSyncExternalStore(t,e,n)};qr.useTransition=function(){return vu.current.useTransition()};qr.version="18.2.0";(function(t){t.exports=qr})(Jk);const Aa=QS(Jn);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dP=Jn,pP=Symbol.for("react.element"),mP=Symbol.for("react.fragment"),gP=Object.prototype.hasOwnProperty,_P=dP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vP={key:!0,ref:!0,__self:!0,__source:!0};function aE(t,e,n){var o,l={},c=null,p=null;n!==void 0&&(c=""+n),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(p=e.ref);for(o in e)gP.call(e,o)&&!vP.hasOwnProperty(o)&&(l[o]=e[o]);if(t&&t.defaultProps)for(o in e=t.defaultProps,e)l[o]===void 0&&(l[o]=e[o]);return{$$typeof:pP,type:t,key:c,ref:p,props:l,_owner:_P.current}}dx.Fragment=mP;dx.jsx=aE;dx.jsxs=aE;(function(t){t.exports=dx})(qk);const lE=Pv.Fragment,In=Pv.jsx,Ko=Pv.jsxs;var jI={},A1={},yP={get exports(){return A1},set exports(t){A1=t}},hc={},UI={},xP={get exports(){return UI},set exports(t){UI=t}},uE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_e,Me){var be=_e.length;_e.push(Me);t:for(;0<be;){var ue=be-1>>>1,Yt=_e[ue];if(0<l(Yt,Me))_e[ue]=Me,_e[be]=Yt,be=ue;else break t}}function n(_e){return _e.length===0?null:_e[0]}function o(_e){if(_e.length===0)return null;var Me=_e[0],be=_e.pop();if(be!==Me){_e[0]=be;t:for(var ue=0,Yt=_e.length,Ee=Yt>>>1;ue<Ee;){var ve=2*(ue+1)-1,ye=_e[ve],fe=ve+1,mn=_e[fe];if(0>l(ye,be))fe<Yt&&0>l(mn,ye)?(_e[ue]=mn,_e[fe]=be,ue=fe):(_e[ue]=ye,_e[ve]=be,ue=ve);else if(fe<Yt&&0>l(mn,be))_e[ue]=mn,_e[fe]=be,ue=fe;else break t}}return Me}function l(_e,Me){var be=_e.sortIndex-Me.sortIndex;return be!==0?be:_e.id-Me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var p=Date,r=p.now();t.unstable_now=function(){return p.now()-r}}var w=[],M=[],N=1,E=null,Z=3,Y=!1,K=!1,q=!1,at=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function lt(_e){for(var Me=n(M);Me!==null;){if(Me.callback===null)o(M);else if(Me.startTime<=_e)o(M),Me.sortIndex=Me.expirationTime,e(w,Me);else break;Me=n(M)}}function Ct(_e){if(q=!1,lt(_e),!K)if(n(w)!==null)K=!0,ln(j);else{var Me=n(M);Me!==null&&Le(Ct,Me.startTime-_e)}}function j(_e,Me){K=!1,q&&(q=!1,J(yt),yt=-1),Y=!0;var be=Z;try{for(lt(Me),E=n(w);E!==null&&(!(E.expirationTime>Me)||_e&&!de());){var ue=E.callback;if(typeof ue=="function"){E.callback=null,Z=E.priorityLevel;var Yt=ue(E.expirationTime<=Me);Me=t.unstable_now(),typeof Yt=="function"?E.callback=Yt:E===n(w)&&o(w),lt(Me)}else o(w);E=n(w)}if(E!==null)var Ee=!0;else{var ve=n(M);ve!==null&&Le(Ct,ve.startTime-Me),Ee=!1}return Ee}finally{E=null,Z=be,Y=!1}}var k=!1,rt=null,yt=-1,xt=5,kt=-1;function de(){return!(t.unstable_now()-kt<xt)}function Et(){if(rt!==null){var _e=t.unstable_now();kt=_e;var Me=!0;try{Me=rt(!0,_e)}finally{Me?te():(k=!1,rt=null)}}else k=!1}var te;if(typeof Q=="function")te=function(){Q(Et)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,ie=ht.port2;ht.port1.onmessage=Et,te=function(){ie.postMessage(null)}}else te=function(){at(Et,0)};function ln(_e){rt=_e,k||(k=!0,te())}function Le(_e,Me){yt=at(function(){_e(t.unstable_now())},Me)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_e){_e.callback=null},t.unstable_continueExecution=function(){K||Y||(K=!0,ln(j))},t.unstable_forceFrameRate=function(_e){0>_e||125<_e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xt=0<_e?Math.floor(1e3/_e):5},t.unstable_getCurrentPriorityLevel=function(){return Z},t.unstable_getFirstCallbackNode=function(){return n(w)},t.unstable_next=function(_e){switch(Z){case 1:case 2:case 3:var Me=3;break;default:Me=Z}var be=Z;Z=Me;try{return _e()}finally{Z=be}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_e,Me){switch(_e){case 1:case 2:case 3:case 4:case 5:break;default:_e=3}var be=Z;Z=_e;try{return Me()}finally{Z=be}},t.unstable_scheduleCallback=function(_e,Me,be){var ue=t.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?ue+be:ue):be=ue,_e){case 1:var Yt=-1;break;case 2:Yt=250;break;case 5:Yt=1073741823;break;case 4:Yt=1e4;break;default:Yt=5e3}return Yt=be+Yt,_e={id:N++,callback:Me,priorityLevel:_e,startTime:be,expirationTime:Yt,sortIndex:-1},be>ue?(_e.sortIndex=be,e(M,_e),n(w)===null&&_e===n(M)&&(q?(J(yt),yt=-1):q=!0,Le(Ct,be-ue))):(_e.sortIndex=Yt,e(w,_e),K||Y||(K=!0,ln(j))),_e},t.unstable_shouldYield=de,t.unstable_wrapCallback=function(_e){var Me=Z;return function(){var be=Z;Z=Me;try{return _e.apply(this,arguments)}finally{Z=be}}}})(uE);(function(t){t.exports=uE})(xP);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE=Jn,uc=UI;function Hn(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hE=new Set,zv={};function Op(t,e){gg(t,e),gg(t+"Capture",e)}function gg(t,e){for(zv[t]=e,t=0;t<e.length;t++)hE.add(e[t])}var vf=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),GI=Object.prototype.hasOwnProperty,wP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,VA={},WA={};function bP(t){return GI.call(WA,t)?!0:GI.call(VA,t)?!1:wP.test(t)?WA[t]=!0:(VA[t]=!0,!1)}function IP(t,e,n,o){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function CP(t,e,n,o){if(e===null||typeof e>"u"||IP(t,e,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function yu(t,e,n,o,l,c,p){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=c,this.removeEmptyString=p}var Tl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tl[t]=new yu(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tl[e]=new yu(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tl[t]=new yu(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tl[t]=new yu(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tl[t]=new yu(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tl[t]=new yu(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tl[t]=new yu(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tl[t]=new yu(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tl[t]=new yu(t,5,!1,t.toLowerCase(),null,!1,!1)});var o2=/[\-:]([a-z])/g;function s2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(o2,s2);Tl[e]=new yu(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(o2,s2);Tl[e]=new yu(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(o2,s2);Tl[e]=new yu(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tl[t]=new yu(t,1,!1,t.toLowerCase(),null,!1,!1)});Tl.xlinkHref=new yu("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tl[t]=new yu(t,1,!1,t.toLowerCase(),null,!0,!0)});function a2(t,e,n,o){var l=Tl.hasOwnProperty(e)?Tl[e]:null;(l!==null?l.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(CP(e,n,l,o)&&(n=null),o||l===null?bP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):l.mustUseProperty?t[l.propertyName]=n===null?l.type===3?!1:"":n:(e=l.attributeName,o=l.attributeNamespace,n===null?t.removeAttribute(e):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,o?t.setAttributeNS(o,e,n):t.setAttribute(e,n))))}var bf=cE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,z0=Symbol.for("react.element"),Xm=Symbol.for("react.portal"),Hm=Symbol.for("react.fragment"),l2=Symbol.for("react.strict_mode"),ZI=Symbol.for("react.profiler"),fE=Symbol.for("react.provider"),dE=Symbol.for("react.context"),u2=Symbol.for("react.forward_ref"),VI=Symbol.for("react.suspense"),WI=Symbol.for("react.suspense_list"),c2=Symbol.for("react.memo"),nd=Symbol.for("react.lazy"),pE=Symbol.for("react.offscreen"),YA=Symbol.iterator;function iv(t){return t===null||typeof t!="object"?null:(t=YA&&t[YA]||t["@@iterator"],typeof t=="function"?t:null)}var Bs=Object.assign,qb;function pv(t){if(qb===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qb=e&&e[1]||""}return`
`+qb+t}var Jb=!1;function Kb(t,e){if(!t||Jb)return"";Jb=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(M){var o=M}Reflect.construct(t,[],e)}else{try{e.call()}catch(M){o=M}t.call(e.prototype)}else{try{throw Error()}catch(M){o=M}t()}}catch(M){if(M&&o&&typeof M.stack=="string"){for(var l=M.stack.split(`
`),c=o.stack.split(`
`),p=l.length-1,r=c.length-1;1<=p&&0<=r&&l[p]!==c[r];)r--;for(;1<=p&&0<=r;p--,r--)if(l[p]!==c[r]){if(p!==1||r!==1)do if(p--,r--,0>r||l[p]!==c[r]){var w=`
`+l[p].replace(" at new "," at ");return t.displayName&&w.includes("<anonymous>")&&(w=w.replace("<anonymous>",t.displayName)),w}while(1<=p&&0<=r);break}}}finally{Jb=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?pv(t):""}function AP(t){switch(t.tag){case 5:return pv(t.type);case 16:return pv("Lazy");case 13:return pv("Suspense");case 19:return pv("SuspenseList");case 0:case 2:case 15:return t=Kb(t.type,!1),t;case 11:return t=Kb(t.type.render,!1),t;case 1:return t=Kb(t.type,!0),t;default:return""}}function YI(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Hm:return"Fragment";case Xm:return"Portal";case ZI:return"Profiler";case l2:return"StrictMode";case VI:return"Suspense";case WI:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case dE:return(t.displayName||"Context")+".Consumer";case fE:return(t._context.displayName||"Context")+".Provider";case u2:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case c2:return e=t.displayName||null,e!==null?e:YI(t.type)||"Memo";case nd:e=t._payload,t=t._init;try{return YI(t(e))}catch{}}return null}function TP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return YI(e);case 8:return e===l2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xd(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function SP(t){var e=mE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),o=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,c=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return l.call(this)},set:function(p){o=""+p,c.call(this,p)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(p){o=""+p},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function D0(t){t._valueTracker||(t._valueTracker=SP(t))}function gE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),o="";return t&&(o=mE(t)?t.checked?"true":"false":t.value),t=o,t!==n?(e.setValue(t),!0):!1}function T1(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function XI(t,e){var n=e.checked;return Bs({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function XA(t,e){var n=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;n=xd(e.value!=null?e.value:n),t._wrapperState={initialChecked:o,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _E(t,e){e=e.checked,e!=null&&a2(t,"checked",e,!1)}function HI(t,e){_E(t,e);var n=xd(e.value),o=e.type;if(n!=null)o==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(o==="submit"||o==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$I(t,e.type,n):e.hasOwnProperty("defaultValue")&&$I(t,e.type,xd(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function HA(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $I(t,e,n){(e!=="number"||T1(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var mv=Array.isArray;function lg(t,e,n,o){if(t=t.options,e){e={};for(var l=0;l<n.length;l++)e["$"+n[l]]=!0;for(n=0;n<t.length;n++)l=e.hasOwnProperty("$"+t[n].value),t[n].selected!==l&&(t[n].selected=l),l&&o&&(t[n].defaultSelected=!0)}else{for(n=""+xd(n),e=null,l=0;l<t.length;l++){if(t[l].value===n){t[l].selected=!0,o&&(t[l].defaultSelected=!0);return}e!==null||t[l].disabled||(e=t[l])}e!==null&&(e.selected=!0)}}function qI(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Hn(91));return Bs({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function $A(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Hn(92));if(mv(n)){if(1<n.length)throw Error(Hn(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:xd(n)}}function vE(t,e){var n=xd(e.value),o=xd(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),o!=null&&(t.defaultValue=""+o)}function qA(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function JI(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var N0,xE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,o,l){MSApp.execUnsafeLocalFunction(function(){return t(e,n,o,l)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(N0=N0||document.createElement("div"),N0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=N0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Dv(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var yv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EP=["Webkit","ms","Moz","O"];Object.keys(yv).forEach(function(t){EP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),yv[e]=yv[t]})});function wE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||yv.hasOwnProperty(t)&&yv[t]?(""+e).trim():e+"px"}function bE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var o=n.indexOf("--")===0,l=wE(n,e[n],o);n==="float"&&(n="cssFloat"),o?t.setProperty(n,l):t[n]=l}}var MP=Bs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function KI(t,e){if(e){if(MP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Hn(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Hn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Hn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Hn(62))}}function QI(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tC=null;function h2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var eC=null,ug=null,cg=null;function JA(t){if(t=ny(t)){if(typeof eC!="function")throw Error(Hn(280));var e=t.stateNode;e&&(e=vx(e),eC(t.stateNode,t.type,e))}}function IE(t){ug?cg?cg.push(t):cg=[t]:ug=t}function CE(){if(ug){var t=ug,e=cg;if(cg=ug=null,JA(t),e)for(t=0;t<e.length;t++)JA(e[t])}}function AE(t,e){return t(e)}function TE(){}var Qb=!1;function SE(t,e,n){if(Qb)return t(e,n);Qb=!0;try{return AE(t,e,n)}finally{Qb=!1,(ug!==null||cg!==null)&&(TE(),CE())}}function Nv(t,e){var n=t.stateNode;if(n===null)return null;var o=vx(n);if(o===null)return null;n=o[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(t=t.type,o=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!o;break t;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Hn(231,e,typeof n));return n}var nC=!1;if(vf)try{var rv={};Object.defineProperty(rv,"passive",{get:function(){nC=!0}}),window.addEventListener("test",rv,rv),window.removeEventListener("test",rv,rv)}catch{nC=!1}function LP(t,e,n,o,l,c,p,r,w){var M=Array.prototype.slice.call(arguments,3);try{e.apply(n,M)}catch(N){this.onError(N)}}var xv=!1,S1=null,E1=!1,iC=null,kP={onError:function(t){xv=!0,S1=t}};function PP(t,e,n,o,l,c,p,r,w){xv=!1,S1=null,LP.apply(kP,arguments)}function zP(t,e,n,o,l,c,p,r,w){if(PP.apply(this,arguments),xv){if(xv){var M=S1;xv=!1,S1=null}else throw Error(Hn(198));E1||(E1=!0,iC=M)}}function Rp(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function EE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function KA(t){if(Rp(t)!==t)throw Error(Hn(188))}function DP(t){var e=t.alternate;if(!e){if(e=Rp(t),e===null)throw Error(Hn(188));return e!==t?null:t}for(var n=t,o=e;;){var l=n.return;if(l===null)break;var c=l.alternate;if(c===null){if(o=l.return,o!==null){n=o;continue}break}if(l.child===c.child){for(c=l.child;c;){if(c===n)return KA(l),t;if(c===o)return KA(l),e;c=c.sibling}throw Error(Hn(188))}if(n.return!==o.return)n=l,o=c;else{for(var p=!1,r=l.child;r;){if(r===n){p=!0,n=l,o=c;break}if(r===o){p=!0,o=l,n=c;break}r=r.sibling}if(!p){for(r=c.child;r;){if(r===n){p=!0,n=c,o=l;break}if(r===o){p=!0,o=c,n=l;break}r=r.sibling}if(!p)throw Error(Hn(189))}}if(n.alternate!==o)throw Error(Hn(190))}if(n.tag!==3)throw Error(Hn(188));return n.stateNode.current===n?t:e}function ME(t){return t=DP(t),t!==null?LE(t):null}function LE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=LE(t);if(e!==null)return e;t=t.sibling}return null}var kE=uc.unstable_scheduleCallback,QA=uc.unstable_cancelCallback,NP=uc.unstable_shouldYield,OP=uc.unstable_requestPaint,ha=uc.unstable_now,RP=uc.unstable_getCurrentPriorityLevel,f2=uc.unstable_ImmediatePriority,PE=uc.unstable_UserBlockingPriority,M1=uc.unstable_NormalPriority,BP=uc.unstable_LowPriority,zE=uc.unstable_IdlePriority,px=null,zh=null;function FP(t){if(zh&&typeof zh.onCommitFiberRoot=="function")try{zh.onCommitFiberRoot(px,t,void 0,(t.current.flags&128)===128)}catch{}}var ah=Math.clz32?Math.clz32:GP,jP=Math.log,UP=Math.LN2;function GP(t){return t>>>=0,t===0?32:31-(jP(t)/UP|0)|0}var O0=64,R0=4194304;function gv(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function L1(t,e){var n=t.pendingLanes;if(n===0)return 0;var o=0,l=t.suspendedLanes,c=t.pingedLanes,p=n&268435455;if(p!==0){var r=p&~l;r!==0?o=gv(r):(c&=p,c!==0&&(o=gv(c)))}else p=n&~l,p!==0?o=gv(p):c!==0&&(o=gv(c));if(o===0)return 0;if(e!==0&&e!==o&&!(e&l)&&(l=o&-o,c=e&-e,l>=c||l===16&&(c&4194240)!==0))return e;if(o&4&&(o|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=o;0<e;)n=31-ah(e),l=1<<n,o|=t[n],e&=~l;return o}function ZP(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VP(t,e){for(var n=t.suspendedLanes,o=t.pingedLanes,l=t.expirationTimes,c=t.pendingLanes;0<c;){var p=31-ah(c),r=1<<p,w=l[p];w===-1?(!(r&n)||r&o)&&(l[p]=ZP(r,e)):w<=e&&(t.expiredLanes|=r),c&=~r}}function rC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function DE(){var t=O0;return O0<<=1,!(O0&4194240)&&(O0=64),t}function tI(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ty(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ah(e),t[e]=n}function WP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var o=t.eventTimes;for(t=t.expirationTimes;0<n;){var l=31-ah(n),c=1<<l;e[l]=0,o[l]=-1,t[l]=-1,n&=~c}}function d2(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var o=31-ah(n),l=1<<o;l&e|t[o]&e&&(t[o]|=e),n&=~l}}var jo=0;function NE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var OE,p2,RE,BE,FE,oC=!1,B0=[],cd=null,hd=null,fd=null,Ov=new Map,Rv=new Map,rd=[],YP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tT(t,e){switch(t){case"focusin":case"focusout":cd=null;break;case"dragenter":case"dragleave":hd=null;break;case"mouseover":case"mouseout":fd=null;break;case"pointerover":case"pointerout":Ov.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rv.delete(e.pointerId)}}function ov(t,e,n,o,l,c){return t===null||t.nativeEvent!==c?(t={blockedOn:e,domEventName:n,eventSystemFlags:o,nativeEvent:c,targetContainers:[l]},e!==null&&(e=ny(e),e!==null&&p2(e)),t):(t.eventSystemFlags|=o,e=t.targetContainers,l!==null&&e.indexOf(l)===-1&&e.push(l),t)}function XP(t,e,n,o,l){switch(e){case"focusin":return cd=ov(cd,t,e,n,o,l),!0;case"dragenter":return hd=ov(hd,t,e,n,o,l),!0;case"mouseover":return fd=ov(fd,t,e,n,o,l),!0;case"pointerover":var c=l.pointerId;return Ov.set(c,ov(Ov.get(c)||null,t,e,n,o,l)),!0;case"gotpointercapture":return c=l.pointerId,Rv.set(c,ov(Rv.get(c)||null,t,e,n,o,l)),!0}return!1}function jE(t){var e=vp(t.target);if(e!==null){var n=Rp(e);if(n!==null){if(e=n.tag,e===13){if(e=EE(n),e!==null){t.blockedOn=e,FE(t.priority,function(){RE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function f1(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=sC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var o=new n.constructor(n.type,n);tC=o,n.target.dispatchEvent(o),tC=null}else return e=ny(n),e!==null&&p2(e),t.blockedOn=n,!1;e.shift()}return!0}function eT(t,e,n){f1(t)&&n.delete(e)}function HP(){oC=!1,cd!==null&&f1(cd)&&(cd=null),hd!==null&&f1(hd)&&(hd=null),fd!==null&&f1(fd)&&(fd=null),Ov.forEach(eT),Rv.forEach(eT)}function sv(t,e){t.blockedOn===e&&(t.blockedOn=null,oC||(oC=!0,uc.unstable_scheduleCallback(uc.unstable_NormalPriority,HP)))}function Bv(t){function e(l){return sv(l,t)}if(0<B0.length){sv(B0[0],t);for(var n=1;n<B0.length;n++){var o=B0[n];o.blockedOn===t&&(o.blockedOn=null)}}for(cd!==null&&sv(cd,t),hd!==null&&sv(hd,t),fd!==null&&sv(fd,t),Ov.forEach(e),Rv.forEach(e),n=0;n<rd.length;n++)o=rd[n],o.blockedOn===t&&(o.blockedOn=null);for(;0<rd.length&&(n=rd[0],n.blockedOn===null);)jE(n),n.blockedOn===null&&rd.shift()}var hg=bf.ReactCurrentBatchConfig,k1=!0;function $P(t,e,n,o){var l=jo,c=hg.transition;hg.transition=null;try{jo=1,m2(t,e,n,o)}finally{jo=l,hg.transition=c}}function qP(t,e,n,o){var l=jo,c=hg.transition;hg.transition=null;try{jo=4,m2(t,e,n,o)}finally{jo=l,hg.transition=c}}function m2(t,e,n,o){if(k1){var l=sC(t,e,n,o);if(l===null)cI(t,e,o,P1,n),tT(t,o);else if(XP(l,t,e,n,o))o.stopPropagation();else if(tT(t,o),e&4&&-1<YP.indexOf(t)){for(;l!==null;){var c=ny(l);if(c!==null&&OE(c),c=sC(t,e,n,o),c===null&&cI(t,e,o,P1,n),c===l)break;l=c}l!==null&&o.stopPropagation()}else cI(t,e,o,null,n)}}var P1=null;function sC(t,e,n,o){if(P1=null,t=h2(o),t=vp(t),t!==null)if(e=Rp(t),e===null)t=null;else if(n=e.tag,n===13){if(t=EE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return P1=t,null}function UE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RP()){case f2:return 1;case PE:return 4;case M1:case BP:return 16;case zE:return 536870912;default:return 16}default:return 16}}var ad=null,g2=null,d1=null;function GE(){if(d1)return d1;var t,e=g2,n=e.length,o,l="value"in ad?ad.value:ad.textContent,c=l.length;for(t=0;t<n&&e[t]===l[t];t++);var p=n-t;for(o=1;o<=p&&e[n-o]===l[c-o];o++);return d1=l.slice(t,1<o?1-o:void 0)}function p1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function F0(){return!0}function nT(){return!1}function fc(t){function e(n,o,l,c,p){this._reactName=n,this._targetInst=l,this.type=o,this.nativeEvent=c,this.target=p,this.currentTarget=null;for(var r in t)t.hasOwnProperty(r)&&(n=t[r],this[r]=n?n(c):c[r]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?F0:nT,this.isPropagationStopped=nT,this}return Bs(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=F0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=F0)},persist:function(){},isPersistent:F0}),e}var Mg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_2=fc(Mg),ey=Bs({},Mg,{view:0,detail:0}),JP=fc(ey),eI,nI,av,mx=Bs({},ey,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:v2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==av&&(av&&t.type==="mousemove"?(eI=t.screenX-av.screenX,nI=t.screenY-av.screenY):nI=eI=0,av=t),eI)},movementY:function(t){return"movementY"in t?t.movementY:nI}}),iT=fc(mx),KP=Bs({},mx,{dataTransfer:0}),QP=fc(KP),t3=Bs({},ey,{relatedTarget:0}),iI=fc(t3),e3=Bs({},Mg,{animationName:0,elapsedTime:0,pseudoElement:0}),n3=fc(e3),i3=Bs({},Mg,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),r3=fc(i3),o3=Bs({},Mg,{data:0}),rT=fc(o3),s3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},a3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=l3[t])?!!e[t]:!1}function v2(){return u3}var c3=Bs({},ey,{key:function(t){if(t.key){var e=s3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=p1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?a3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:v2,charCode:function(t){return t.type==="keypress"?p1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?p1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),h3=fc(c3),f3=Bs({},mx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oT=fc(f3),d3=Bs({},ey,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:v2}),p3=fc(d3),m3=Bs({},Mg,{propertyName:0,elapsedTime:0,pseudoElement:0}),g3=fc(m3),_3=Bs({},mx,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),v3=fc(_3),y3=[9,13,27,32],y2=vf&&"CompositionEvent"in window,wv=null;vf&&"documentMode"in document&&(wv=document.documentMode);var x3=vf&&"TextEvent"in window&&!wv,ZE=vf&&(!y2||wv&&8<wv&&11>=wv),sT=String.fromCharCode(32),aT=!1;function VE(t,e){switch(t){case"keyup":return y3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $m=!1;function w3(t,e){switch(t){case"compositionend":return WE(e);case"keypress":return e.which!==32?null:(aT=!0,sT);case"textInput":return t=e.data,t===sT&&aT?null:t;default:return null}}function b3(t,e){if($m)return t==="compositionend"||!y2&&VE(t,e)?(t=GE(),d1=g2=ad=null,$m=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ZE&&e.locale!=="ko"?null:e.data;default:return null}}var I3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!I3[t.type]:e==="textarea"}function YE(t,e,n,o){IE(o),e=z1(e,"onChange"),0<e.length&&(n=new _2("onChange","change",null,n,o),t.push({event:n,listeners:e}))}var bv=null,Fv=null;function C3(t){iM(t,0)}function gx(t){var e=Km(t);if(gE(e))return t}function A3(t,e){if(t==="change")return e}var XE=!1;if(vf){var rI;if(vf){var oI="oninput"in document;if(!oI){var uT=document.createElement("div");uT.setAttribute("oninput","return;"),oI=typeof uT.oninput=="function"}rI=oI}else rI=!1;XE=rI&&(!document.documentMode||9<document.documentMode)}function cT(){bv&&(bv.detachEvent("onpropertychange",HE),Fv=bv=null)}function HE(t){if(t.propertyName==="value"&&gx(Fv)){var e=[];YE(e,Fv,t,h2(t)),SE(C3,e)}}function T3(t,e,n){t==="focusin"?(cT(),bv=e,Fv=n,bv.attachEvent("onpropertychange",HE)):t==="focusout"&&cT()}function S3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return gx(Fv)}function E3(t,e){if(t==="click")return gx(e)}function M3(t,e){if(t==="input"||t==="change")return gx(e)}function L3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var uh=typeof Object.is=="function"?Object.is:L3;function jv(t,e){if(uh(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var l=n[o];if(!GI.call(e,l)||!uh(t[l],e[l]))return!1}return!0}function hT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fT(t,e){var n=hT(t);t=0;for(var o;n;){if(n.nodeType===3){if(o=t+n.textContent.length,t<=e&&o>=e)return{node:n,offset:e-t};t=o}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=hT(n)}}function $E(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$E(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qE(){for(var t=window,e=T1();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=T1(t.document)}return e}function x2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function k3(t){var e=qE(),n=t.focusedElem,o=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$E(n.ownerDocument.documentElement,n)){if(o!==null&&x2(n)){if(e=o.start,t=o.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var l=n.textContent.length,c=Math.min(o.start,l);o=o.end===void 0?c:Math.min(o.end,l),!t.extend&&c>o&&(l=o,o=c,c=l),l=fT(n,c);var p=fT(n,o);l&&p&&(t.rangeCount!==1||t.anchorNode!==l.node||t.anchorOffset!==l.offset||t.focusNode!==p.node||t.focusOffset!==p.offset)&&(e=e.createRange(),e.setStart(l.node,l.offset),t.removeAllRanges(),c>o?(t.addRange(e),t.extend(p.node,p.offset)):(e.setEnd(p.node,p.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var P3=vf&&"documentMode"in document&&11>=document.documentMode,qm=null,aC=null,Iv=null,lC=!1;function dT(t,e,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lC||qm==null||qm!==T1(o)||(o=qm,"selectionStart"in o&&x2(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Iv&&jv(Iv,o)||(Iv=o,o=z1(aC,"onSelect"),0<o.length&&(e=new _2("onSelect","select",null,e,n),t.push({event:e,listeners:o}),e.target=qm)))}function j0(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Jm={animationend:j0("Animation","AnimationEnd"),animationiteration:j0("Animation","AnimationIteration"),animationstart:j0("Animation","AnimationStart"),transitionend:j0("Transition","TransitionEnd")},sI={},JE={};vf&&(JE=document.createElement("div").style,"AnimationEvent"in window||(delete Jm.animationend.animation,delete Jm.animationiteration.animation,delete Jm.animationstart.animation),"TransitionEvent"in window||delete Jm.transitionend.transition);function _x(t){if(sI[t])return sI[t];if(!Jm[t])return t;var e=Jm[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in JE)return sI[t]=e[n];return t}var KE=_x("animationend"),QE=_x("animationiteration"),tM=_x("animationstart"),eM=_x("transitionend"),nM=new Map,pT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bd(t,e){nM.set(t,e),Op(e,[t])}for(var aI=0;aI<pT.length;aI++){var lI=pT[aI],z3=lI.toLowerCase(),D3=lI[0].toUpperCase()+lI.slice(1);bd(z3,"on"+D3)}bd(KE,"onAnimationEnd");bd(QE,"onAnimationIteration");bd(tM,"onAnimationStart");bd("dblclick","onDoubleClick");bd("focusin","onFocus");bd("focusout","onBlur");bd(eM,"onTransitionEnd");gg("onMouseEnter",["mouseout","mouseover"]);gg("onMouseLeave",["mouseout","mouseover"]);gg("onPointerEnter",["pointerout","pointerover"]);gg("onPointerLeave",["pointerout","pointerover"]);Op("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Op("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Op("onBeforeInput",["compositionend","keypress","textInput","paste"]);Op("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Op("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Op("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _v="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),N3=new Set("cancel close invalid load scroll toggle".split(" ").concat(_v));function mT(t,e,n){var o=t.type||"unknown-event";t.currentTarget=n,zP(o,e,void 0,t),t.currentTarget=null}function iM(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var o=t[n],l=o.event;o=o.listeners;t:{var c=void 0;if(e)for(var p=o.length-1;0<=p;p--){var r=o[p],w=r.instance,M=r.currentTarget;if(r=r.listener,w!==c&&l.isPropagationStopped())break t;mT(l,r,M),c=w}else for(p=0;p<o.length;p++){if(r=o[p],w=r.instance,M=r.currentTarget,r=r.listener,w!==c&&l.isPropagationStopped())break t;mT(l,r,M),c=w}}}if(E1)throw t=iC,E1=!1,iC=null,t}function ms(t,e){var n=e[dC];n===void 0&&(n=e[dC]=new Set);var o=t+"__bubble";n.has(o)||(rM(e,t,2,!1),n.add(o))}function uI(t,e,n){var o=0;e&&(o|=4),rM(n,t,o,e)}var U0="_reactListening"+Math.random().toString(36).slice(2);function Uv(t){if(!t[U0]){t[U0]=!0,hE.forEach(function(n){n!=="selectionchange"&&(N3.has(n)||uI(n,!1,t),uI(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[U0]||(e[U0]=!0,uI("selectionchange",!1,e))}}function rM(t,e,n,o){switch(UE(e)){case 1:var l=$P;break;case 4:l=qP;break;default:l=m2}n=l.bind(null,e,n,t),l=void 0,!nC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(l=!0),o?l!==void 0?t.addEventListener(e,n,{capture:!0,passive:l}):t.addEventListener(e,n,!0):l!==void 0?t.addEventListener(e,n,{passive:l}):t.addEventListener(e,n,!1)}function cI(t,e,n,o,l){var c=o;if(!(e&1)&&!(e&2)&&o!==null)t:for(;;){if(o===null)return;var p=o.tag;if(p===3||p===4){var r=o.stateNode.containerInfo;if(r===l||r.nodeType===8&&r.parentNode===l)break;if(p===4)for(p=o.return;p!==null;){var w=p.tag;if((w===3||w===4)&&(w=p.stateNode.containerInfo,w===l||w.nodeType===8&&w.parentNode===l))return;p=p.return}for(;r!==null;){if(p=vp(r),p===null)return;if(w=p.tag,w===5||w===6){o=c=p;continue t}r=r.parentNode}}o=o.return}SE(function(){var M=c,N=h2(n),E=[];t:{var Z=nM.get(t);if(Z!==void 0){var Y=_2,K=t;switch(t){case"keypress":if(p1(n)===0)break t;case"keydown":case"keyup":Y=h3;break;case"focusin":K="focus",Y=iI;break;case"focusout":K="blur",Y=iI;break;case"beforeblur":case"afterblur":Y=iI;break;case"click":if(n.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=iT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=QP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=p3;break;case KE:case QE:case tM:Y=n3;break;case eM:Y=g3;break;case"scroll":Y=JP;break;case"wheel":Y=v3;break;case"copy":case"cut":case"paste":Y=r3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=oT}var q=(e&4)!==0,at=!q&&t==="scroll",J=q?Z!==null?Z+"Capture":null:Z;q=[];for(var Q=M,lt;Q!==null;){lt=Q;var Ct=lt.stateNode;if(lt.tag===5&&Ct!==null&&(lt=Ct,J!==null&&(Ct=Nv(Q,J),Ct!=null&&q.push(Gv(Q,Ct,lt)))),at)break;Q=Q.return}0<q.length&&(Z=new Y(Z,K,null,n,N),E.push({event:Z,listeners:q}))}}if(!(e&7)){t:{if(Z=t==="mouseover"||t==="pointerover",Y=t==="mouseout"||t==="pointerout",Z&&n!==tC&&(K=n.relatedTarget||n.fromElement)&&(vp(K)||K[yf]))break t;if((Y||Z)&&(Z=N.window===N?N:(Z=N.ownerDocument)?Z.defaultView||Z.parentWindow:window,Y?(K=n.relatedTarget||n.toElement,Y=M,K=K?vp(K):null,K!==null&&(at=Rp(K),K!==at||K.tag!==5&&K.tag!==6)&&(K=null)):(Y=null,K=M),Y!==K)){if(q=iT,Ct="onMouseLeave",J="onMouseEnter",Q="mouse",(t==="pointerout"||t==="pointerover")&&(q=oT,Ct="onPointerLeave",J="onPointerEnter",Q="pointer"),at=Y==null?Z:Km(Y),lt=K==null?Z:Km(K),Z=new q(Ct,Q+"leave",Y,n,N),Z.target=at,Z.relatedTarget=lt,Ct=null,vp(N)===M&&(q=new q(J,Q+"enter",K,n,N),q.target=lt,q.relatedTarget=at,Ct=q),at=Ct,Y&&K)e:{for(q=Y,J=K,Q=0,lt=q;lt;lt=Zm(lt))Q++;for(lt=0,Ct=J;Ct;Ct=Zm(Ct))lt++;for(;0<Q-lt;)q=Zm(q),Q--;for(;0<lt-Q;)J=Zm(J),lt--;for(;Q--;){if(q===J||J!==null&&q===J.alternate)break e;q=Zm(q),J=Zm(J)}q=null}else q=null;Y!==null&&gT(E,Z,Y,q,!1),K!==null&&at!==null&&gT(E,at,K,q,!0)}}t:{if(Z=M?Km(M):window,Y=Z.nodeName&&Z.nodeName.toLowerCase(),Y==="select"||Y==="input"&&Z.type==="file")var j=A3;else if(lT(Z))if(XE)j=M3;else{j=S3;var k=T3}else(Y=Z.nodeName)&&Y.toLowerCase()==="input"&&(Z.type==="checkbox"||Z.type==="radio")&&(j=E3);if(j&&(j=j(t,M))){YE(E,j,n,N);break t}k&&k(t,Z,M),t==="focusout"&&(k=Z._wrapperState)&&k.controlled&&Z.type==="number"&&$I(Z,"number",Z.value)}switch(k=M?Km(M):window,t){case"focusin":(lT(k)||k.contentEditable==="true")&&(qm=k,aC=M,Iv=null);break;case"focusout":Iv=aC=qm=null;break;case"mousedown":lC=!0;break;case"contextmenu":case"mouseup":case"dragend":lC=!1,dT(E,n,N);break;case"selectionchange":if(P3)break;case"keydown":case"keyup":dT(E,n,N)}var rt;if(y2)t:{switch(t){case"compositionstart":var yt="onCompositionStart";break t;case"compositionend":yt="onCompositionEnd";break t;case"compositionupdate":yt="onCompositionUpdate";break t}yt=void 0}else $m?VE(t,n)&&(yt="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(yt="onCompositionStart");yt&&(ZE&&n.locale!=="ko"&&($m||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&$m&&(rt=GE()):(ad=N,g2="value"in ad?ad.value:ad.textContent,$m=!0)),k=z1(M,yt),0<k.length&&(yt=new rT(yt,t,null,n,N),E.push({event:yt,listeners:k}),rt?yt.data=rt:(rt=WE(n),rt!==null&&(yt.data=rt)))),(rt=x3?w3(t,n):b3(t,n))&&(M=z1(M,"onBeforeInput"),0<M.length&&(N=new rT("onBeforeInput","beforeinput",null,n,N),E.push({event:N,listeners:M}),N.data=rt))}iM(E,e)})}function Gv(t,e,n){return{instance:t,listener:e,currentTarget:n}}function z1(t,e){for(var n=e+"Capture",o=[];t!==null;){var l=t,c=l.stateNode;l.tag===5&&c!==null&&(l=c,c=Nv(t,n),c!=null&&o.unshift(Gv(t,c,l)),c=Nv(t,e),c!=null&&o.push(Gv(t,c,l))),t=t.return}return o}function Zm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function gT(t,e,n,o,l){for(var c=e._reactName,p=[];n!==null&&n!==o;){var r=n,w=r.alternate,M=r.stateNode;if(w!==null&&w===o)break;r.tag===5&&M!==null&&(r=M,l?(w=Nv(n,c),w!=null&&p.unshift(Gv(n,w,r))):l||(w=Nv(n,c),w!=null&&p.push(Gv(n,w,r)))),n=n.return}p.length!==0&&t.push({event:e,listeners:p})}var O3=/\r\n?/g,R3=/\u0000|\uFFFD/g;function _T(t){return(typeof t=="string"?t:""+t).replace(O3,`
`).replace(R3,"")}function G0(t,e,n){if(e=_T(e),_T(t)!==e&&n)throw Error(Hn(425))}function D1(){}var uC=null,cC=null;function hC(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var fC=typeof setTimeout=="function"?setTimeout:void 0,B3=typeof clearTimeout=="function"?clearTimeout:void 0,vT=typeof Promise=="function"?Promise:void 0,F3=typeof queueMicrotask=="function"?queueMicrotask:typeof vT<"u"?function(t){return vT.resolve(null).then(t).catch(j3)}:fC;function j3(t){setTimeout(function(){throw t})}function hI(t,e){var n=e,o=0;do{var l=n.nextSibling;if(t.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(o===0){t.removeChild(l),Bv(e);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=l}while(n);Bv(e)}function dd(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function yT(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Lg=Math.random().toString(36).slice(2),Mh="__reactFiber$"+Lg,Zv="__reactProps$"+Lg,yf="__reactContainer$"+Lg,dC="__reactEvents$"+Lg,U3="__reactListeners$"+Lg,G3="__reactHandles$"+Lg;function vp(t){var e=t[Mh];if(e)return e;for(var n=t.parentNode;n;){if(e=n[yf]||n[Mh]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=yT(t);t!==null;){if(n=t[Mh])return n;t=yT(t)}return e}t=n,n=t.parentNode}return null}function ny(t){return t=t[Mh]||t[yf],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Km(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Hn(33))}function vx(t){return t[Zv]||null}var pC=[],Qm=-1;function Id(t){return{current:t}}function gs(t){0>Qm||(t.current=pC[Qm],pC[Qm]=null,Qm--)}function ss(t,e){Qm++,pC[Qm]=t.current,t.current=e}var wd={},Xl=Id(wd),Ru=Id(!1),Tp=wd;function _g(t,e){var n=t.type.contextTypes;if(!n)return wd;var o=t.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var l={},c;for(c in n)l[c]=e[c];return o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=l),l}function Bu(t){return t=t.childContextTypes,t!=null}function N1(){gs(Ru),gs(Xl)}function xT(t,e,n){if(Xl.current!==wd)throw Error(Hn(168));ss(Xl,e),ss(Ru,n)}function oM(t,e,n){var o=t.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var l in o)if(!(l in e))throw Error(Hn(108,TP(t)||"Unknown",l));return Bs({},n,o)}function O1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||wd,Tp=Xl.current,ss(Xl,t),ss(Ru,Ru.current),!0}function wT(t,e,n){var o=t.stateNode;if(!o)throw Error(Hn(169));n?(t=oM(t,e,Tp),o.__reactInternalMemoizedMergedChildContext=t,gs(Ru),gs(Xl),ss(Xl,t)):gs(Ru),ss(Ru,n)}var ff=null,yx=!1,fI=!1;function sM(t){ff===null?ff=[t]:ff.push(t)}function Z3(t){yx=!0,sM(t)}function Cd(){if(!fI&&ff!==null){fI=!0;var t=0,e=jo;try{var n=ff;for(jo=1;t<n.length;t++){var o=n[t];do o=o(!0);while(o!==null)}ff=null,yx=!1}catch(l){throw ff!==null&&(ff=ff.slice(t+1)),kE(f2,Cd),l}finally{jo=e,fI=!1}}return null}var tg=[],eg=0,R1=null,B1=0,Mc=[],Lc=0,Sp=null,df=1,pf="";function pp(t,e){tg[eg++]=B1,tg[eg++]=R1,R1=t,B1=e}function aM(t,e,n){Mc[Lc++]=df,Mc[Lc++]=pf,Mc[Lc++]=Sp,Sp=t;var o=df;t=pf;var l=32-ah(o)-1;o&=~(1<<l),n+=1;var c=32-ah(e)+l;if(30<c){var p=l-l%5;c=(o&(1<<p)-1).toString(32),o>>=p,l-=p,df=1<<32-ah(e)+l|n<<l|o,pf=c+t}else df=1<<c|n<<l|o,pf=t}function w2(t){t.return!==null&&(pp(t,1),aM(t,1,0))}function b2(t){for(;t===R1;)R1=tg[--eg],tg[eg]=null,B1=tg[--eg],tg[eg]=null;for(;t===Sp;)Sp=Mc[--Lc],Mc[Lc]=null,pf=Mc[--Lc],Mc[Lc]=null,df=Mc[--Lc],Mc[Lc]=null}var lc=null,ac=null,Ts=!1,nh=null;function lM(t,e){var n=zc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function bT(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,lc=t,ac=dd(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,lc=t,ac=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Sp!==null?{id:df,overflow:pf}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=zc(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,lc=t,ac=null,!0):!1;default:return!1}}function mC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gC(t){if(Ts){var e=ac;if(e){var n=e;if(!bT(t,e)){if(mC(t))throw Error(Hn(418));e=dd(n.nextSibling);var o=lc;e&&bT(t,e)?lM(o,n):(t.flags=t.flags&-4097|2,Ts=!1,lc=t)}}else{if(mC(t))throw Error(Hn(418));t.flags=t.flags&-4097|2,Ts=!1,lc=t}}}function IT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;lc=t}function Z0(t){if(t!==lc)return!1;if(!Ts)return IT(t),Ts=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hC(t.type,t.memoizedProps)),e&&(e=ac)){if(mC(t))throw uM(),Error(Hn(418));for(;e;)lM(t,e),e=dd(e.nextSibling)}if(IT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Hn(317));t:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ac=dd(t.nextSibling);break t}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ac=null}}else ac=lc?dd(t.stateNode.nextSibling):null;return!0}function uM(){for(var t=ac;t;)t=dd(t.nextSibling)}function vg(){ac=lc=null,Ts=!1}function I2(t){nh===null?nh=[t]:nh.push(t)}var V3=bf.ReactCurrentBatchConfig;function th(t,e){if(t&&t.defaultProps){e=Bs({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var F1=Id(null),j1=null,ng=null,C2=null;function A2(){C2=ng=j1=null}function T2(t){var e=F1.current;gs(F1),t._currentValue=e}function _C(t,e,n){for(;t!==null;){var o=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),t===n)break;t=t.return}}function fg(t,e){j1=t,C2=ng=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ou=!0),t.firstContext=null)}function Oc(t){var e=t._currentValue;if(C2!==t)if(t={context:t,memoizedValue:e,next:null},ng===null){if(j1===null)throw Error(Hn(308));ng=t,j1.dependencies={lanes:0,firstContext:t}}else ng=ng.next=t;return e}var yp=null;function S2(t){yp===null?yp=[t]:yp.push(t)}function cM(t,e,n,o){var l=e.interleaved;return l===null?(n.next=n,S2(e)):(n.next=l.next,l.next=n),e.interleaved=n,xf(t,o)}function xf(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var id=!1;function E2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hM(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function gf(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function pd(t,e,n){var o=t.updateQueue;if(o===null)return null;if(o=o.shared,xo&2){var l=o.pending;return l===null?e.next=e:(e.next=l.next,l.next=e),o.pending=e,xf(t,n)}return l=o.interleaved,l===null?(e.next=e,S2(o)):(e.next=l.next,l.next=e),o.interleaved=e,xf(t,n)}function m1(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var o=e.lanes;o&=t.pendingLanes,n|=o,e.lanes=n,d2(t,n)}}function CT(t,e){var n=t.updateQueue,o=t.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var l=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?l=c=p:c=c.next=p,n=n.next}while(n!==null);c===null?l=c=e:c=c.next=e}else l=c=e;n={baseState:o.baseState,firstBaseUpdate:l,lastBaseUpdate:c,shared:o.shared,effects:o.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function U1(t,e,n,o){var l=t.updateQueue;id=!1;var c=l.firstBaseUpdate,p=l.lastBaseUpdate,r=l.shared.pending;if(r!==null){l.shared.pending=null;var w=r,M=w.next;w.next=null,p===null?c=M:p.next=M,p=w;var N=t.alternate;N!==null&&(N=N.updateQueue,r=N.lastBaseUpdate,r!==p&&(r===null?N.firstBaseUpdate=M:r.next=M,N.lastBaseUpdate=w))}if(c!==null){var E=l.baseState;p=0,N=M=w=null,r=c;do{var Z=r.lane,Y=r.eventTime;if((o&Z)===Z){N!==null&&(N=N.next={eventTime:Y,lane:0,tag:r.tag,payload:r.payload,callback:r.callback,next:null});t:{var K=t,q=r;switch(Z=e,Y=n,q.tag){case 1:if(K=q.payload,typeof K=="function"){E=K.call(Y,E,Z);break t}E=K;break t;case 3:K.flags=K.flags&-65537|128;case 0:if(K=q.payload,Z=typeof K=="function"?K.call(Y,E,Z):K,Z==null)break t;E=Bs({},E,Z);break t;case 2:id=!0}}r.callback!==null&&r.lane!==0&&(t.flags|=64,Z=l.effects,Z===null?l.effects=[r]:Z.push(r))}else Y={eventTime:Y,lane:Z,tag:r.tag,payload:r.payload,callback:r.callback,next:null},N===null?(M=N=Y,w=E):N=N.next=Y,p|=Z;if(r=r.next,r===null){if(r=l.shared.pending,r===null)break;Z=r,r=Z.next,Z.next=null,l.lastBaseUpdate=Z,l.shared.pending=null}}while(1);if(N===null&&(w=E),l.baseState=w,l.firstBaseUpdate=M,l.lastBaseUpdate=N,e=l.shared.interleaved,e!==null){l=e;do p|=l.lane,l=l.next;while(l!==e)}else c===null&&(l.shared.lanes=0);Mp|=p,t.lanes=p,t.memoizedState=E}}function AT(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var o=t[e],l=o.callback;if(l!==null){if(o.callback=null,o=n,typeof l!="function")throw Error(Hn(191,l));l.call(o)}}}var fM=new cE.Component().refs;function vC(t,e,n,o){e=t.memoizedState,n=n(o,e),n=n==null?e:Bs({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var xx={isMounted:function(t){return(t=t._reactInternals)?Rp(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var o=_u(),l=gd(t),c=gf(o,l);c.payload=e,n!=null&&(c.callback=n),e=pd(t,c,l),e!==null&&(lh(e,t,l,o),m1(e,t,l))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var o=_u(),l=gd(t),c=gf(o,l);c.tag=1,c.payload=e,n!=null&&(c.callback=n),e=pd(t,c,l),e!==null&&(lh(e,t,l,o),m1(e,t,l))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=_u(),o=gd(t),l=gf(n,o);l.tag=2,e!=null&&(l.callback=e),e=pd(t,l,o),e!==null&&(lh(e,t,o,n),m1(e,t,o))}};function TT(t,e,n,o,l,c,p){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(o,c,p):e.prototype&&e.prototype.isPureReactComponent?!jv(n,o)||!jv(l,c):!0}function dM(t,e,n){var o=!1,l=wd,c=e.contextType;return typeof c=="object"&&c!==null?c=Oc(c):(l=Bu(e)?Tp:Xl.current,o=e.contextTypes,c=(o=o!=null)?_g(t,l):wd),e=new e(n,c),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xx,t.stateNode=e,e._reactInternals=t,o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=l,t.__reactInternalMemoizedMaskedChildContext=c),e}function ST(t,e,n,o){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,o),e.state!==t&&xx.enqueueReplaceState(e,e.state,null)}function yC(t,e,n,o){var l=t.stateNode;l.props=n,l.state=t.memoizedState,l.refs=fM,E2(t);var c=e.contextType;typeof c=="object"&&c!==null?l.context=Oc(c):(c=Bu(e)?Tp:Xl.current,l.context=_g(t,c)),l.state=t.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(vC(t,e,c,n),l.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(e=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),e!==l.state&&xx.enqueueReplaceState(l,l.state,null),U1(t,n,l,o),l.state=t.memoizedState),typeof l.componentDidMount=="function"&&(t.flags|=4194308)}function lv(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Hn(309));var o=n.stateNode}if(!o)throw Error(Hn(147,t));var l=o,c=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(p){var r=l.refs;r===fM&&(r=l.refs={}),p===null?delete r[c]:r[c]=p},e._stringRef=c,e)}if(typeof t!="string")throw Error(Hn(284));if(!n._owner)throw Error(Hn(290,t))}return t}function V0(t,e){throw t=Object.prototype.toString.call(e),Error(Hn(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ET(t){var e=t._init;return e(t._payload)}function pM(t){function e(J,Q){if(t){var lt=J.deletions;lt===null?(J.deletions=[Q],J.flags|=16):lt.push(Q)}}function n(J,Q){if(!t)return null;for(;Q!==null;)e(J,Q),Q=Q.sibling;return null}function o(J,Q){for(J=new Map;Q!==null;)Q.key!==null?J.set(Q.key,Q):J.set(Q.index,Q),Q=Q.sibling;return J}function l(J,Q){return J=_d(J,Q),J.index=0,J.sibling=null,J}function c(J,Q,lt){return J.index=lt,t?(lt=J.alternate,lt!==null?(lt=lt.index,lt<Q?(J.flags|=2,Q):lt):(J.flags|=2,Q)):(J.flags|=1048576,Q)}function p(J){return t&&J.alternate===null&&(J.flags|=2),J}function r(J,Q,lt,Ct){return Q===null||Q.tag!==6?(Q=yI(lt,J.mode,Ct),Q.return=J,Q):(Q=l(Q,lt),Q.return=J,Q)}function w(J,Q,lt,Ct){var j=lt.type;return j===Hm?N(J,Q,lt.props.children,Ct,lt.key):Q!==null&&(Q.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===nd&&ET(j)===Q.type)?(Ct=l(Q,lt.props),Ct.ref=lv(J,Q,lt),Ct.return=J,Ct):(Ct=w1(lt.type,lt.key,lt.props,null,J.mode,Ct),Ct.ref=lv(J,Q,lt),Ct.return=J,Ct)}function M(J,Q,lt,Ct){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==lt.containerInfo||Q.stateNode.implementation!==lt.implementation?(Q=xI(lt,J.mode,Ct),Q.return=J,Q):(Q=l(Q,lt.children||[]),Q.return=J,Q)}function N(J,Q,lt,Ct,j){return Q===null||Q.tag!==7?(Q=Cp(lt,J.mode,Ct,j),Q.return=J,Q):(Q=l(Q,lt),Q.return=J,Q)}function E(J,Q,lt){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=yI(""+Q,J.mode,lt),Q.return=J,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case z0:return lt=w1(Q.type,Q.key,Q.props,null,J.mode,lt),lt.ref=lv(J,null,Q),lt.return=J,lt;case Xm:return Q=xI(Q,J.mode,lt),Q.return=J,Q;case nd:var Ct=Q._init;return E(J,Ct(Q._payload),lt)}if(mv(Q)||iv(Q))return Q=Cp(Q,J.mode,lt,null),Q.return=J,Q;V0(J,Q)}return null}function Z(J,Q,lt,Ct){var j=Q!==null?Q.key:null;if(typeof lt=="string"&&lt!==""||typeof lt=="number")return j!==null?null:r(J,Q,""+lt,Ct);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case z0:return lt.key===j?w(J,Q,lt,Ct):null;case Xm:return lt.key===j?M(J,Q,lt,Ct):null;case nd:return j=lt._init,Z(J,Q,j(lt._payload),Ct)}if(mv(lt)||iv(lt))return j!==null?null:N(J,Q,lt,Ct,null);V0(J,lt)}return null}function Y(J,Q,lt,Ct,j){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number")return J=J.get(lt)||null,r(Q,J,""+Ct,j);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case z0:return J=J.get(Ct.key===null?lt:Ct.key)||null,w(Q,J,Ct,j);case Xm:return J=J.get(Ct.key===null?lt:Ct.key)||null,M(Q,J,Ct,j);case nd:var k=Ct._init;return Y(J,Q,lt,k(Ct._payload),j)}if(mv(Ct)||iv(Ct))return J=J.get(lt)||null,N(Q,J,Ct,j,null);V0(Q,Ct)}return null}function K(J,Q,lt,Ct){for(var j=null,k=null,rt=Q,yt=Q=0,xt=null;rt!==null&&yt<lt.length;yt++){rt.index>yt?(xt=rt,rt=null):xt=rt.sibling;var kt=Z(J,rt,lt[yt],Ct);if(kt===null){rt===null&&(rt=xt);break}t&&rt&&kt.alternate===null&&e(J,rt),Q=c(kt,Q,yt),k===null?j=kt:k.sibling=kt,k=kt,rt=xt}if(yt===lt.length)return n(J,rt),Ts&&pp(J,yt),j;if(rt===null){for(;yt<lt.length;yt++)rt=E(J,lt[yt],Ct),rt!==null&&(Q=c(rt,Q,yt),k===null?j=rt:k.sibling=rt,k=rt);return Ts&&pp(J,yt),j}for(rt=o(J,rt);yt<lt.length;yt++)xt=Y(rt,J,yt,lt[yt],Ct),xt!==null&&(t&&xt.alternate!==null&&rt.delete(xt.key===null?yt:xt.key),Q=c(xt,Q,yt),k===null?j=xt:k.sibling=xt,k=xt);return t&&rt.forEach(function(de){return e(J,de)}),Ts&&pp(J,yt),j}function q(J,Q,lt,Ct){var j=iv(lt);if(typeof j!="function")throw Error(Hn(150));if(lt=j.call(lt),lt==null)throw Error(Hn(151));for(var k=j=null,rt=Q,yt=Q=0,xt=null,kt=lt.next();rt!==null&&!kt.done;yt++,kt=lt.next()){rt.index>yt?(xt=rt,rt=null):xt=rt.sibling;var de=Z(J,rt,kt.value,Ct);if(de===null){rt===null&&(rt=xt);break}t&&rt&&de.alternate===null&&e(J,rt),Q=c(de,Q,yt),k===null?j=de:k.sibling=de,k=de,rt=xt}if(kt.done)return n(J,rt),Ts&&pp(J,yt),j;if(rt===null){for(;!kt.done;yt++,kt=lt.next())kt=E(J,kt.value,Ct),kt!==null&&(Q=c(kt,Q,yt),k===null?j=kt:k.sibling=kt,k=kt);return Ts&&pp(J,yt),j}for(rt=o(J,rt);!kt.done;yt++,kt=lt.next())kt=Y(rt,J,yt,kt.value,Ct),kt!==null&&(t&&kt.alternate!==null&&rt.delete(kt.key===null?yt:kt.key),Q=c(kt,Q,yt),k===null?j=kt:k.sibling=kt,k=kt);return t&&rt.forEach(function(Et){return e(J,Et)}),Ts&&pp(J,yt),j}function at(J,Q,lt,Ct){if(typeof lt=="object"&&lt!==null&&lt.type===Hm&&lt.key===null&&(lt=lt.props.children),typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case z0:t:{for(var j=lt.key,k=Q;k!==null;){if(k.key===j){if(j=lt.type,j===Hm){if(k.tag===7){n(J,k.sibling),Q=l(k,lt.props.children),Q.return=J,J=Q;break t}}else if(k.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===nd&&ET(j)===k.type){n(J,k.sibling),Q=l(k,lt.props),Q.ref=lv(J,k,lt),Q.return=J,J=Q;break t}n(J,k);break}else e(J,k);k=k.sibling}lt.type===Hm?(Q=Cp(lt.props.children,J.mode,Ct,lt.key),Q.return=J,J=Q):(Ct=w1(lt.type,lt.key,lt.props,null,J.mode,Ct),Ct.ref=lv(J,Q,lt),Ct.return=J,J=Ct)}return p(J);case Xm:t:{for(k=lt.key;Q!==null;){if(Q.key===k)if(Q.tag===4&&Q.stateNode.containerInfo===lt.containerInfo&&Q.stateNode.implementation===lt.implementation){n(J,Q.sibling),Q=l(Q,lt.children||[]),Q.return=J,J=Q;break t}else{n(J,Q);break}else e(J,Q);Q=Q.sibling}Q=xI(lt,J.mode,Ct),Q.return=J,J=Q}return p(J);case nd:return k=lt._init,at(J,Q,k(lt._payload),Ct)}if(mv(lt))return K(J,Q,lt,Ct);if(iv(lt))return q(J,Q,lt,Ct);V0(J,lt)}return typeof lt=="string"&&lt!==""||typeof lt=="number"?(lt=""+lt,Q!==null&&Q.tag===6?(n(J,Q.sibling),Q=l(Q,lt),Q.return=J,J=Q):(n(J,Q),Q=yI(lt,J.mode,Ct),Q.return=J,J=Q),p(J)):n(J,Q)}return at}var yg=pM(!0),mM=pM(!1),iy={},Dh=Id(iy),Vv=Id(iy),Wv=Id(iy);function xp(t){if(t===iy)throw Error(Hn(174));return t}function M2(t,e){switch(ss(Wv,e),ss(Vv,t),ss(Dh,iy),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:JI(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=JI(e,t)}gs(Dh),ss(Dh,e)}function xg(){gs(Dh),gs(Vv),gs(Wv)}function gM(t){xp(Wv.current);var e=xp(Dh.current),n=JI(e,t.type);e!==n&&(ss(Vv,t),ss(Dh,n))}function L2(t){Vv.current===t&&(gs(Dh),gs(Vv))}var Os=Id(0);function G1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dI=[];function k2(){for(var t=0;t<dI.length;t++)dI[t]._workInProgressVersionPrimary=null;dI.length=0}var g1=bf.ReactCurrentDispatcher,pI=bf.ReactCurrentBatchConfig,Ep=0,Rs=null,Za=null,ol=null,Z1=!1,Cv=!1,Yv=0,W3=0;function Zl(){throw Error(Hn(321))}function P2(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!uh(t[n],e[n]))return!1;return!0}function z2(t,e,n,o,l,c){if(Ep=c,Rs=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,g1.current=t===null||t.memoizedState===null?$3:q3,t=n(o,l),Cv){c=0;do{if(Cv=!1,Yv=0,25<=c)throw Error(Hn(301));c+=1,ol=Za=null,e.updateQueue=null,g1.current=J3,t=n(o,l)}while(Cv)}if(g1.current=V1,e=Za!==null&&Za.next!==null,Ep=0,ol=Za=Rs=null,Z1=!1,e)throw Error(Hn(300));return t}function D2(){var t=Yv!==0;return Yv=0,t}function Th(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ol===null?Rs.memoizedState=ol=t:ol=ol.next=t,ol}function Rc(){if(Za===null){var t=Rs.alternate;t=t!==null?t.memoizedState:null}else t=Za.next;var e=ol===null?Rs.memoizedState:ol.next;if(e!==null)ol=e,Za=t;else{if(t===null)throw Error(Hn(310));Za=t,t={memoizedState:Za.memoizedState,baseState:Za.baseState,baseQueue:Za.baseQueue,queue:Za.queue,next:null},ol===null?Rs.memoizedState=ol=t:ol=ol.next=t}return ol}function Xv(t,e){return typeof e=="function"?e(t):e}function mI(t){var e=Rc(),n=e.queue;if(n===null)throw Error(Hn(311));n.lastRenderedReducer=t;var o=Za,l=o.baseQueue,c=n.pending;if(c!==null){if(l!==null){var p=l.next;l.next=c.next,c.next=p}o.baseQueue=l=c,n.pending=null}if(l!==null){c=l.next,o=o.baseState;var r=p=null,w=null,M=c;do{var N=M.lane;if((Ep&N)===N)w!==null&&(w=w.next={lane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),o=M.hasEagerState?M.eagerState:t(o,M.action);else{var E={lane:N,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null};w===null?(r=w=E,p=o):w=w.next=E,Rs.lanes|=N,Mp|=N}M=M.next}while(M!==null&&M!==c);w===null?p=o:w.next=r,uh(o,e.memoizedState)||(Ou=!0),e.memoizedState=o,e.baseState=p,e.baseQueue=w,n.lastRenderedState=o}if(t=n.interleaved,t!==null){l=t;do c=l.lane,Rs.lanes|=c,Mp|=c,l=l.next;while(l!==t)}else l===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function gI(t){var e=Rc(),n=e.queue;if(n===null)throw Error(Hn(311));n.lastRenderedReducer=t;var o=n.dispatch,l=n.pending,c=e.memoizedState;if(l!==null){n.pending=null;var p=l=l.next;do c=t(c,p.action),p=p.next;while(p!==l);uh(c,e.memoizedState)||(Ou=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),n.lastRenderedState=c}return[c,o]}function _M(){}function vM(t,e){var n=Rs,o=Rc(),l=e(),c=!uh(o.memoizedState,l);if(c&&(o.memoizedState=l,Ou=!0),o=o.queue,N2(wM.bind(null,n,o,t),[t]),o.getSnapshot!==e||c||ol!==null&&ol.memoizedState.tag&1){if(n.flags|=2048,Hv(9,xM.bind(null,n,o,l,e),void 0,null),al===null)throw Error(Hn(349));Ep&30||yM(n,e,l)}return l}function yM(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Rs.updateQueue,e===null?(e={lastEffect:null,stores:null},Rs.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function xM(t,e,n,o){e.value=n,e.getSnapshot=o,bM(e)&&IM(t)}function wM(t,e,n){return n(function(){bM(e)&&IM(t)})}function bM(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!uh(t,n)}catch{return!0}}function IM(t){var e=xf(t,1);e!==null&&lh(e,t,1,-1)}function MT(t){var e=Th();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xv,lastRenderedState:t},e.queue=t,t=t.dispatch=H3.bind(null,Rs,t),[e.memoizedState,t]}function Hv(t,e,n,o){return t={tag:t,create:e,destroy:n,deps:o,next:null},e=Rs.updateQueue,e===null?(e={lastEffect:null,stores:null},Rs.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(o=n.next,n.next=t,t.next=o,e.lastEffect=t)),t}function CM(){return Rc().memoizedState}function _1(t,e,n,o){var l=Th();Rs.flags|=t,l.memoizedState=Hv(1|e,n,void 0,o===void 0?null:o)}function wx(t,e,n,o){var l=Rc();o=o===void 0?null:o;var c=void 0;if(Za!==null){var p=Za.memoizedState;if(c=p.destroy,o!==null&&P2(o,p.deps)){l.memoizedState=Hv(e,n,c,o);return}}Rs.flags|=t,l.memoizedState=Hv(1|e,n,c,o)}function LT(t,e){return _1(8390656,8,t,e)}function N2(t,e){return wx(2048,8,t,e)}function AM(t,e){return wx(4,2,t,e)}function TM(t,e){return wx(4,4,t,e)}function SM(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function EM(t,e,n){return n=n!=null?n.concat([t]):null,wx(4,4,SM.bind(null,e,t),n)}function O2(){}function MM(t,e){var n=Rc();e=e===void 0?null:e;var o=n.memoizedState;return o!==null&&e!==null&&P2(e,o[1])?o[0]:(n.memoizedState=[t,e],t)}function LM(t,e){var n=Rc();e=e===void 0?null:e;var o=n.memoizedState;return o!==null&&e!==null&&P2(e,o[1])?o[0]:(t=t(),n.memoizedState=[t,e],t)}function kM(t,e,n){return Ep&21?(uh(n,e)||(n=DE(),Rs.lanes|=n,Mp|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ou=!0),t.memoizedState=n)}function Y3(t,e){var n=jo;jo=n!==0&&4>n?n:4,t(!0);var o=pI.transition;pI.transition={};try{t(!1),e()}finally{jo=n,pI.transition=o}}function PM(){return Rc().memoizedState}function X3(t,e,n){var o=gd(t);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},zM(t))DM(e,n);else if(n=cM(t,e,n,o),n!==null){var l=_u();lh(n,t,o,l),NM(n,e,o)}}function H3(t,e,n){var o=gd(t),l={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(zM(t))DM(e,l);else{var c=t.alternate;if(t.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var p=e.lastRenderedState,r=c(p,n);if(l.hasEagerState=!0,l.eagerState=r,uh(r,p)){var w=e.interleaved;w===null?(l.next=l,S2(e)):(l.next=w.next,w.next=l),e.interleaved=l;return}}catch{}finally{}n=cM(t,e,l,o),n!==null&&(l=_u(),lh(n,t,o,l),NM(n,e,o))}}function zM(t){var e=t.alternate;return t===Rs||e!==null&&e===Rs}function DM(t,e){Cv=Z1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function NM(t,e,n){if(n&4194240){var o=e.lanes;o&=t.pendingLanes,n|=o,e.lanes=n,d2(t,n)}}var V1={readContext:Oc,useCallback:Zl,useContext:Zl,useEffect:Zl,useImperativeHandle:Zl,useInsertionEffect:Zl,useLayoutEffect:Zl,useMemo:Zl,useReducer:Zl,useRef:Zl,useState:Zl,useDebugValue:Zl,useDeferredValue:Zl,useTransition:Zl,useMutableSource:Zl,useSyncExternalStore:Zl,useId:Zl,unstable_isNewReconciler:!1},$3={readContext:Oc,useCallback:function(t,e){return Th().memoizedState=[t,e===void 0?null:e],t},useContext:Oc,useEffect:LT,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_1(4194308,4,SM.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _1(4194308,4,t,e)},useInsertionEffect:function(t,e){return _1(4,2,t,e)},useMemo:function(t,e){var n=Th();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var o=Th();return e=n!==void 0?n(e):e,o.memoizedState=o.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},o.queue=t,t=t.dispatch=X3.bind(null,Rs,t),[o.memoizedState,t]},useRef:function(t){var e=Th();return t={current:t},e.memoizedState=t},useState:MT,useDebugValue:O2,useDeferredValue:function(t){return Th().memoizedState=t},useTransition:function(){var t=MT(!1),e=t[0];return t=Y3.bind(null,t[1]),Th().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var o=Rs,l=Th();if(Ts){if(n===void 0)throw Error(Hn(407));n=n()}else{if(n=e(),al===null)throw Error(Hn(349));Ep&30||yM(o,e,n)}l.memoizedState=n;var c={value:n,getSnapshot:e};return l.queue=c,LT(wM.bind(null,o,c,t),[t]),o.flags|=2048,Hv(9,xM.bind(null,o,c,n,e),void 0,null),n},useId:function(){var t=Th(),e=al.identifierPrefix;if(Ts){var n=pf,o=df;n=(o&~(1<<32-ah(o)-1)).toString(32)+n,e=":"+e+"R"+n,n=Yv++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=W3++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},q3={readContext:Oc,useCallback:MM,useContext:Oc,useEffect:N2,useImperativeHandle:EM,useInsertionEffect:AM,useLayoutEffect:TM,useMemo:LM,useReducer:mI,useRef:CM,useState:function(){return mI(Xv)},useDebugValue:O2,useDeferredValue:function(t){var e=Rc();return kM(e,Za.memoizedState,t)},useTransition:function(){var t=mI(Xv)[0],e=Rc().memoizedState;return[t,e]},useMutableSource:_M,useSyncExternalStore:vM,useId:PM,unstable_isNewReconciler:!1},J3={readContext:Oc,useCallback:MM,useContext:Oc,useEffect:N2,useImperativeHandle:EM,useInsertionEffect:AM,useLayoutEffect:TM,useMemo:LM,useReducer:gI,useRef:CM,useState:function(){return gI(Xv)},useDebugValue:O2,useDeferredValue:function(t){var e=Rc();return Za===null?e.memoizedState=t:kM(e,Za.memoizedState,t)},useTransition:function(){var t=gI(Xv)[0],e=Rc().memoizedState;return[t,e]},useMutableSource:_M,useSyncExternalStore:vM,useId:PM,unstable_isNewReconciler:!1};function wg(t,e){try{var n="",o=e;do n+=AP(o),o=o.return;while(o);var l=n}catch(c){l=`
Error generating stack: `+c.message+`
`+c.stack}return{value:t,source:e,stack:l,digest:null}}function _I(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function xC(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var K3=typeof WeakMap=="function"?WeakMap:Map;function OM(t,e,n){n=gf(-1,n),n.tag=3,n.payload={element:null};var o=e.value;return n.callback=function(){Y1||(Y1=!0,LC=o),xC(t,e)},n}function RM(t,e,n){n=gf(-1,n),n.tag=3;var o=t.type.getDerivedStateFromError;if(typeof o=="function"){var l=e.value;n.payload=function(){return o(l)},n.callback=function(){xC(t,e)}}var c=t.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){xC(t,e),typeof o!="function"&&(md===null?md=new Set([this]):md.add(this));var p=e.stack;this.componentDidCatch(e.value,{componentStack:p!==null?p:""})}),n}function kT(t,e,n){var o=t.pingCache;if(o===null){o=t.pingCache=new K3;var l=new Set;o.set(e,l)}else l=o.get(e),l===void 0&&(l=new Set,o.set(e,l));l.has(n)||(l.add(n),t=fz.bind(null,t,e,n),e.then(t,t))}function PT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function zT(t,e,n,o,l){return t.mode&1?(t.flags|=65536,t.lanes=l,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=gf(-1,1),e.tag=2,pd(n,e,1))),n.lanes|=1),t)}var Q3=bf.ReactCurrentOwner,Ou=!1;function fu(t,e,n,o){e.child=t===null?mM(e,null,n,o):yg(e,t.child,n,o)}function DT(t,e,n,o,l){n=n.render;var c=e.ref;return fg(e,l),o=z2(t,e,n,o,c,l),n=D2(),t!==null&&!Ou?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~l,wf(t,e,l)):(Ts&&n&&w2(e),e.flags|=1,fu(t,e,o,l),e.child)}function NT(t,e,n,o,l){if(t===null){var c=n.type;return typeof c=="function"&&!V2(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=c,BM(t,e,c,o,l)):(t=w1(n.type,null,o,e,e.mode,l),t.ref=e.ref,t.return=e,e.child=t)}if(c=t.child,!(t.lanes&l)){var p=c.memoizedProps;if(n=n.compare,n=n!==null?n:jv,n(p,o)&&t.ref===e.ref)return wf(t,e,l)}return e.flags|=1,t=_d(c,o),t.ref=e.ref,t.return=e,e.child=t}function BM(t,e,n,o,l){if(t!==null){var c=t.memoizedProps;if(jv(c,o)&&t.ref===e.ref)if(Ou=!1,e.pendingProps=o=c,(t.lanes&l)!==0)t.flags&131072&&(Ou=!0);else return e.lanes=t.lanes,wf(t,e,l)}return wC(t,e,n,o,l)}function FM(t,e,n){var o=e.pendingProps,l=o.children,c=t!==null?t.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ss(rg,oc),oc|=n;else{if(!(n&1073741824))return t=c!==null?c.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ss(rg,oc),oc|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=c!==null?c.baseLanes:n,ss(rg,oc),oc|=o}else c!==null?(o=c.baseLanes|n,e.memoizedState=null):o=n,ss(rg,oc),oc|=o;return fu(t,e,l,n),e.child}function jM(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function wC(t,e,n,o,l){var c=Bu(n)?Tp:Xl.current;return c=_g(e,c),fg(e,l),n=z2(t,e,n,o,c,l),o=D2(),t!==null&&!Ou?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~l,wf(t,e,l)):(Ts&&o&&w2(e),e.flags|=1,fu(t,e,n,l),e.child)}function OT(t,e,n,o,l){if(Bu(n)){var c=!0;O1(e)}else c=!1;if(fg(e,l),e.stateNode===null)v1(t,e),dM(e,n,o),yC(e,n,o,l),o=!0;else if(t===null){var p=e.stateNode,r=e.memoizedProps;p.props=r;var w=p.context,M=n.contextType;typeof M=="object"&&M!==null?M=Oc(M):(M=Bu(n)?Tp:Xl.current,M=_g(e,M));var N=n.getDerivedStateFromProps,E=typeof N=="function"||typeof p.getSnapshotBeforeUpdate=="function";E||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(r!==o||w!==M)&&ST(e,p,o,M),id=!1;var Z=e.memoizedState;p.state=Z,U1(e,o,p,l),w=e.memoizedState,r!==o||Z!==w||Ru.current||id?(typeof N=="function"&&(vC(e,n,N,o),w=e.memoizedState),(r=id||TT(e,n,r,o,Z,w,M))?(E||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(e.flags|=4194308)):(typeof p.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=w),p.props=o,p.state=w,p.context=M,o=r):(typeof p.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{p=e.stateNode,hM(t,e),r=e.memoizedProps,M=e.type===e.elementType?r:th(e.type,r),p.props=M,E=e.pendingProps,Z=p.context,w=n.contextType,typeof w=="object"&&w!==null?w=Oc(w):(w=Bu(n)?Tp:Xl.current,w=_g(e,w));var Y=n.getDerivedStateFromProps;(N=typeof Y=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(r!==E||Z!==w)&&ST(e,p,o,w),id=!1,Z=e.memoizedState,p.state=Z,U1(e,o,p,l);var K=e.memoizedState;r!==E||Z!==K||Ru.current||id?(typeof Y=="function"&&(vC(e,n,Y,o),K=e.memoizedState),(M=id||TT(e,n,M,o,Z,K,w)||!1)?(N||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,K,w),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,K,w)),typeof p.componentDidUpdate=="function"&&(e.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof p.componentDidUpdate!="function"||r===t.memoizedProps&&Z===t.memoizedState||(e.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||r===t.memoizedProps&&Z===t.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=K),p.props=o,p.state=K,p.context=w,o=M):(typeof p.componentDidUpdate!="function"||r===t.memoizedProps&&Z===t.memoizedState||(e.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||r===t.memoizedProps&&Z===t.memoizedState||(e.flags|=1024),o=!1)}return bC(t,e,n,o,c,l)}function bC(t,e,n,o,l,c){jM(t,e);var p=(e.flags&128)!==0;if(!o&&!p)return l&&wT(e,n,!1),wf(t,e,c);o=e.stateNode,Q3.current=e;var r=p&&typeof n.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,t!==null&&p?(e.child=yg(e,t.child,null,c),e.child=yg(e,null,r,c)):fu(t,e,r,c),e.memoizedState=o.state,l&&wT(e,n,!0),e.child}function UM(t){var e=t.stateNode;e.pendingContext?xT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&xT(t,e.context,!1),M2(t,e.containerInfo)}function RT(t,e,n,o,l){return vg(),I2(l),e.flags|=256,fu(t,e,n,o),e.child}var IC={dehydrated:null,treeContext:null,retryLane:0};function CC(t){return{baseLanes:t,cachePool:null,transitions:null}}function GM(t,e,n){var o=e.pendingProps,l=Os.current,c=!1,p=(e.flags&128)!==0,r;if((r=p)||(r=t!==null&&t.memoizedState===null?!1:(l&2)!==0),r?(c=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(l|=1),ss(Os,l&1),t===null)return gC(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(p=o.children,t=o.fallback,c?(o=e.mode,c=e.child,p={mode:"hidden",children:p},!(o&1)&&c!==null?(c.childLanes=0,c.pendingProps=p):c=Cx(p,o,0,null),t=Cp(t,o,n,null),c.return=e,t.return=e,c.sibling=t,e.child=c,e.child.memoizedState=CC(n),e.memoizedState=IC,t):R2(e,p));if(l=t.memoizedState,l!==null&&(r=l.dehydrated,r!==null))return tz(t,e,p,o,r,l,n);if(c){c=o.fallback,p=e.mode,l=t.child,r=l.sibling;var w={mode:"hidden",children:o.children};return!(p&1)&&e.child!==l?(o=e.child,o.childLanes=0,o.pendingProps=w,e.deletions=null):(o=_d(l,w),o.subtreeFlags=l.subtreeFlags&14680064),r!==null?c=_d(r,c):(c=Cp(c,p,n,null),c.flags|=2),c.return=e,o.return=e,o.sibling=c,e.child=o,o=c,c=e.child,p=t.child.memoizedState,p=p===null?CC(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},c.memoizedState=p,c.childLanes=t.childLanes&~n,e.memoizedState=IC,o}return c=t.child,t=c.sibling,o=_d(c,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=n),o.return=e,o.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=o,e.memoizedState=null,o}function R2(t,e){return e=Cx({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function W0(t,e,n,o){return o!==null&&I2(o),yg(e,t.child,null,n),t=R2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function tz(t,e,n,o,l,c,p){if(n)return e.flags&256?(e.flags&=-257,o=_I(Error(Hn(422))),W0(t,e,p,o)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(c=o.fallback,l=e.mode,o=Cx({mode:"visible",children:o.children},l,0,null),c=Cp(c,l,p,null),c.flags|=2,o.return=e,c.return=e,o.sibling=c,e.child=o,e.mode&1&&yg(e,t.child,null,p),e.child.memoizedState=CC(p),e.memoizedState=IC,c);if(!(e.mode&1))return W0(t,e,p,null);if(l.data==="$!"){if(o=l.nextSibling&&l.nextSibling.dataset,o)var r=o.dgst;return o=r,c=Error(Hn(419)),o=_I(c,o,void 0),W0(t,e,p,o)}if(r=(p&t.childLanes)!==0,Ou||r){if(o=al,o!==null){switch(p&-p){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(o.suspendedLanes|p)?0:l,l!==0&&l!==c.retryLane&&(c.retryLane=l,xf(t,l),lh(o,t,l,-1))}return Z2(),o=_I(Error(Hn(421))),W0(t,e,p,o)}return l.data==="$?"?(e.flags|=128,e.child=t.child,e=dz.bind(null,t),l._reactRetry=e,null):(t=c.treeContext,ac=dd(l.nextSibling),lc=e,Ts=!0,nh=null,t!==null&&(Mc[Lc++]=df,Mc[Lc++]=pf,Mc[Lc++]=Sp,df=t.id,pf=t.overflow,Sp=e),e=R2(e,o.children),e.flags|=4096,e)}function BT(t,e,n){t.lanes|=e;var o=t.alternate;o!==null&&(o.lanes|=e),_C(t.return,e,n)}function vI(t,e,n,o,l){var c=t.memoizedState;c===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:l}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=o,c.tail=n,c.tailMode=l)}function ZM(t,e,n){var o=e.pendingProps,l=o.revealOrder,c=o.tail;if(fu(t,e,o.children,n),o=Os.current,o&2)o=o&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)t:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&BT(t,n,e);else if(t.tag===19)BT(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;t.sibling===null;){if(t.return===null||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}o&=1}if(ss(Os,o),!(e.mode&1))e.memoizedState=null;else switch(l){case"forwards":for(n=e.child,l=null;n!==null;)t=n.alternate,t!==null&&G1(t)===null&&(l=n),n=n.sibling;n=l,n===null?(l=e.child,e.child=null):(l=n.sibling,n.sibling=null),vI(e,!1,l,n,c);break;case"backwards":for(n=null,l=e.child,e.child=null;l!==null;){if(t=l.alternate,t!==null&&G1(t)===null){e.child=l;break}t=l.sibling,l.sibling=n,n=l,l=t}vI(e,!0,n,null,c);break;case"together":vI(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function v1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function wf(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Mp|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Hn(153));if(e.child!==null){for(t=e.child,n=_d(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=_d(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ez(t,e,n){switch(e.tag){case 3:UM(e),vg();break;case 5:gM(e);break;case 1:Bu(e.type)&&O1(e);break;case 4:M2(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,l=e.memoizedProps.value;ss(F1,o._currentValue),o._currentValue=l;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(ss(Os,Os.current&1),e.flags|=128,null):n&e.child.childLanes?GM(t,e,n):(ss(Os,Os.current&1),t=wf(t,e,n),t!==null?t.sibling:null);ss(Os,Os.current&1);break;case 19:if(o=(n&e.childLanes)!==0,t.flags&128){if(o)return ZM(t,e,n);e.flags|=128}if(l=e.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),ss(Os,Os.current),o)break;return null;case 22:case 23:return e.lanes=0,FM(t,e,n)}return wf(t,e,n)}var VM,AC,WM,YM;VM=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};AC=function(){};WM=function(t,e,n,o){var l=t.memoizedProps;if(l!==o){t=e.stateNode,xp(Dh.current);var c=null;switch(n){case"input":l=XI(t,l),o=XI(t,o),c=[];break;case"select":l=Bs({},l,{value:void 0}),o=Bs({},o,{value:void 0}),c=[];break;case"textarea":l=qI(t,l),o=qI(t,o),c=[];break;default:typeof l.onClick!="function"&&typeof o.onClick=="function"&&(t.onclick=D1)}KI(n,o);var p;n=null;for(M in l)if(!o.hasOwnProperty(M)&&l.hasOwnProperty(M)&&l[M]!=null)if(M==="style"){var r=l[M];for(p in r)r.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(zv.hasOwnProperty(M)?c||(c=[]):(c=c||[]).push(M,null));for(M in o){var w=o[M];if(r=l!=null?l[M]:void 0,o.hasOwnProperty(M)&&w!==r&&(w!=null||r!=null))if(M==="style")if(r){for(p in r)!r.hasOwnProperty(p)||w&&w.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in w)w.hasOwnProperty(p)&&r[p]!==w[p]&&(n||(n={}),n[p]=w[p])}else n||(c||(c=[]),c.push(M,n)),n=w;else M==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,r=r?r.__html:void 0,w!=null&&r!==w&&(c=c||[]).push(M,w)):M==="children"?typeof w!="string"&&typeof w!="number"||(c=c||[]).push(M,""+w):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(zv.hasOwnProperty(M)?(w!=null&&M==="onScroll"&&ms("scroll",t),c||r===w||(c=[])):(c=c||[]).push(M,w))}n&&(c=c||[]).push("style",n);var M=c;(e.updateQueue=M)&&(e.flags|=4)}};YM=function(t,e,n,o){n!==o&&(e.flags|=4)};function uv(t,e){if(!Ts)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:o.sibling=null}}function Vl(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,o=0;if(e)for(var l=t.child;l!==null;)n|=l.lanes|l.childLanes,o|=l.subtreeFlags&14680064,o|=l.flags&14680064,l.return=t,l=l.sibling;else for(l=t.child;l!==null;)n|=l.lanes|l.childLanes,o|=l.subtreeFlags,o|=l.flags,l.return=t,l=l.sibling;return t.subtreeFlags|=o,t.childLanes=n,e}function nz(t,e,n){var o=e.pendingProps;switch(b2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vl(e),null;case 1:return Bu(e.type)&&N1(),Vl(e),null;case 3:return o=e.stateNode,xg(),gs(Ru),gs(Xl),k2(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(Z0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nh!==null&&(zC(nh),nh=null))),AC(t,e),Vl(e),null;case 5:L2(e);var l=xp(Wv.current);if(n=e.type,t!==null&&e.stateNode!=null)WM(t,e,n,o,l),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(Hn(166));return Vl(e),null}if(t=xp(Dh.current),Z0(e)){o=e.stateNode,n=e.type;var c=e.memoizedProps;switch(o[Mh]=e,o[Zv]=c,t=(e.mode&1)!==0,n){case"dialog":ms("cancel",o),ms("close",o);break;case"iframe":case"object":case"embed":ms("load",o);break;case"video":case"audio":for(l=0;l<_v.length;l++)ms(_v[l],o);break;case"source":ms("error",o);break;case"img":case"image":case"link":ms("error",o),ms("load",o);break;case"details":ms("toggle",o);break;case"input":XA(o,c),ms("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!c.multiple},ms("invalid",o);break;case"textarea":$A(o,c),ms("invalid",o)}KI(n,c),l=null;for(var p in c)if(c.hasOwnProperty(p)){var r=c[p];p==="children"?typeof r=="string"?o.textContent!==r&&(c.suppressHydrationWarning!==!0&&G0(o.textContent,r,t),l=["children",r]):typeof r=="number"&&o.textContent!==""+r&&(c.suppressHydrationWarning!==!0&&G0(o.textContent,r,t),l=["children",""+r]):zv.hasOwnProperty(p)&&r!=null&&p==="onScroll"&&ms("scroll",o)}switch(n){case"input":D0(o),HA(o,c,!0);break;case"textarea":D0(o),qA(o);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(o.onclick=D1)}o=l,e.updateQueue=o,o!==null&&(e.flags|=4)}else{p=l.nodeType===9?l:l.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=p.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof o.is=="string"?t=p.createElement(n,{is:o.is}):(t=p.createElement(n),n==="select"&&(p=t,o.multiple?p.multiple=!0:o.size&&(p.size=o.size))):t=p.createElementNS(t,n),t[Mh]=e,t[Zv]=o,VM(t,e,!1,!1),e.stateNode=t;t:{switch(p=QI(n,o),n){case"dialog":ms("cancel",t),ms("close",t),l=o;break;case"iframe":case"object":case"embed":ms("load",t),l=o;break;case"video":case"audio":for(l=0;l<_v.length;l++)ms(_v[l],t);l=o;break;case"source":ms("error",t),l=o;break;case"img":case"image":case"link":ms("error",t),ms("load",t),l=o;break;case"details":ms("toggle",t),l=o;break;case"input":XA(t,o),l=XI(t,o),ms("invalid",t);break;case"option":l=o;break;case"select":t._wrapperState={wasMultiple:!!o.multiple},l=Bs({},o,{value:void 0}),ms("invalid",t);break;case"textarea":$A(t,o),l=qI(t,o),ms("invalid",t);break;default:l=o}KI(n,l),r=l;for(c in r)if(r.hasOwnProperty(c)){var w=r[c];c==="style"?bE(t,w):c==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,w!=null&&xE(t,w)):c==="children"?typeof w=="string"?(n!=="textarea"||w!=="")&&Dv(t,w):typeof w=="number"&&Dv(t,""+w):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(zv.hasOwnProperty(c)?w!=null&&c==="onScroll"&&ms("scroll",t):w!=null&&a2(t,c,w,p))}switch(n){case"input":D0(t),HA(t,o,!1);break;case"textarea":D0(t),qA(t);break;case"option":o.value!=null&&t.setAttribute("value",""+xd(o.value));break;case"select":t.multiple=!!o.multiple,c=o.value,c!=null?lg(t,!!o.multiple,c,!1):o.defaultValue!=null&&lg(t,!!o.multiple,o.defaultValue,!0);break;default:typeof l.onClick=="function"&&(t.onclick=D1)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break t;case"img":o=!0;break t;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Vl(e),null;case 6:if(t&&e.stateNode!=null)YM(t,e,t.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(Hn(166));if(n=xp(Wv.current),xp(Dh.current),Z0(e)){if(o=e.stateNode,n=e.memoizedProps,o[Mh]=e,(c=o.nodeValue!==n)&&(t=lc,t!==null))switch(t.tag){case 3:G0(o.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&G0(o.nodeValue,n,(t.mode&1)!==0)}c&&(e.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[Mh]=e,e.stateNode=o}return Vl(e),null;case 13:if(gs(Os),o=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ts&&ac!==null&&e.mode&1&&!(e.flags&128))uM(),vg(),e.flags|=98560,c=!1;else if(c=Z0(e),o!==null&&o.dehydrated!==null){if(t===null){if(!c)throw Error(Hn(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(Hn(317));c[Mh]=e}else vg(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Vl(e),c=!1}else nh!==null&&(zC(nh),nh=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(o=o!==null,o!==(t!==null&&t.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(t===null||Os.current&1?Va===0&&(Va=3):Z2())),e.updateQueue!==null&&(e.flags|=4),Vl(e),null);case 4:return xg(),AC(t,e),t===null&&Uv(e.stateNode.containerInfo),Vl(e),null;case 10:return T2(e.type._context),Vl(e),null;case 17:return Bu(e.type)&&N1(),Vl(e),null;case 19:if(gs(Os),c=e.memoizedState,c===null)return Vl(e),null;if(o=(e.flags&128)!==0,p=c.rendering,p===null)if(o)uv(c,!1);else{if(Va!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(p=G1(t),p!==null){for(e.flags|=128,uv(c,!1),o=p.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=n,n=e.child;n!==null;)c=n,t=o,c.flags&=14680066,p=c.alternate,p===null?(c.childLanes=0,c.lanes=t,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=p.childLanes,c.lanes=p.lanes,c.child=p.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=p.memoizedProps,c.memoizedState=p.memoizedState,c.updateQueue=p.updateQueue,c.type=p.type,t=p.dependencies,c.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ss(Os,Os.current&1|2),e.child}t=t.sibling}c.tail!==null&&ha()>bg&&(e.flags|=128,o=!0,uv(c,!1),e.lanes=4194304)}else{if(!o)if(t=G1(p),t!==null){if(e.flags|=128,o=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),uv(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!Ts)return Vl(e),null}else 2*ha()-c.renderingStartTime>bg&&n!==1073741824&&(e.flags|=128,o=!0,uv(c,!1),e.lanes=4194304);c.isBackwards?(p.sibling=e.child,e.child=p):(n=c.last,n!==null?n.sibling=p:e.child=p,c.last=p)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=ha(),e.sibling=null,n=Os.current,ss(Os,o?n&1|2:n&1),e):(Vl(e),null);case 22:case 23:return G2(),o=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?oc&1073741824&&(Vl(e),e.subtreeFlags&6&&(e.flags|=8192)):Vl(e),null;case 24:return null;case 25:return null}throw Error(Hn(156,e.tag))}function iz(t,e){switch(b2(e),e.tag){case 1:return Bu(e.type)&&N1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xg(),gs(Ru),gs(Xl),k2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return L2(e),null;case 13:if(gs(Os),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Hn(340));vg()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gs(Os),null;case 4:return xg(),null;case 10:return T2(e.type._context),null;case 22:case 23:return G2(),null;case 24:return null;default:return null}}var Y0=!1,Wl=!1,rz=typeof WeakSet=="function"?WeakSet:Set,yi=null;function ig(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){qs(t,e,o)}else n.current=null}function TC(t,e,n){try{n()}catch(o){qs(t,e,o)}}var FT=!1;function oz(t,e){if(uC=k1,t=qE(),x2(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{n=(n=t.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var l=o.anchorOffset,c=o.focusNode;o=o.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break t}var p=0,r=-1,w=-1,M=0,N=0,E=t,Z=null;e:for(;;){for(var Y;E!==n||l!==0&&E.nodeType!==3||(r=p+l),E!==c||o!==0&&E.nodeType!==3||(w=p+o),E.nodeType===3&&(p+=E.nodeValue.length),(Y=E.firstChild)!==null;)Z=E,E=Y;for(;;){if(E===t)break e;if(Z===n&&++M===l&&(r=p),Z===c&&++N===o&&(w=p),(Y=E.nextSibling)!==null)break;E=Z,Z=E.parentNode}E=Y}n=r===-1||w===-1?null:{start:r,end:w}}else n=null}n=n||{start:0,end:0}}else n=null;for(cC={focusedElem:t,selectionRange:n},k1=!1,yi=e;yi!==null;)if(e=yi,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,yi=t;else for(;yi!==null;){e=yi;try{var K=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(K!==null){var q=K.memoizedProps,at=K.memoizedState,J=e.stateNode,Q=J.getSnapshotBeforeUpdate(e.elementType===e.type?q:th(e.type,q),at);J.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var lt=e.stateNode.containerInfo;lt.nodeType===1?lt.textContent="":lt.nodeType===9&&lt.documentElement&&lt.removeChild(lt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Hn(163))}}catch(Ct){qs(e,e.return,Ct)}if(t=e.sibling,t!==null){t.return=e.return,yi=t;break}yi=e.return}return K=FT,FT=!1,K}function Av(t,e,n){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&t)===t){var c=l.destroy;l.destroy=void 0,c!==void 0&&TC(e,n,c)}l=l.next}while(l!==o)}}function bx(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var o=n.create;n.destroy=o()}n=n.next}while(n!==e)}}function SC(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function XM(t){var e=t.alternate;e!==null&&(t.alternate=null,XM(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Mh],delete e[Zv],delete e[dC],delete e[U3],delete e[G3])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function HM(t){return t.tag===5||t.tag===3||t.tag===4}function jT(t){t:for(;;){for(;t.sibling===null;){if(t.return===null||HM(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue t;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function EC(t,e,n){var o=t.tag;if(o===5||o===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=D1));else if(o!==4&&(t=t.child,t!==null))for(EC(t,e,n),t=t.sibling;t!==null;)EC(t,e,n),t=t.sibling}function MC(t,e,n){var o=t.tag;if(o===5||o===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(o!==4&&(t=t.child,t!==null))for(MC(t,e,n),t=t.sibling;t!==null;)MC(t,e,n),t=t.sibling}var Il=null,eh=!1;function Qf(t,e,n){for(n=n.child;n!==null;)$M(t,e,n),n=n.sibling}function $M(t,e,n){if(zh&&typeof zh.onCommitFiberUnmount=="function")try{zh.onCommitFiberUnmount(px,n)}catch{}switch(n.tag){case 5:Wl||ig(n,e);case 6:var o=Il,l=eh;Il=null,Qf(t,e,n),Il=o,eh=l,Il!==null&&(eh?(t=Il,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Il.removeChild(n.stateNode));break;case 18:Il!==null&&(eh?(t=Il,n=n.stateNode,t.nodeType===8?hI(t.parentNode,n):t.nodeType===1&&hI(t,n),Bv(t)):hI(Il,n.stateNode));break;case 4:o=Il,l=eh,Il=n.stateNode.containerInfo,eh=!0,Qf(t,e,n),Il=o,eh=l;break;case 0:case 11:case 14:case 15:if(!Wl&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){l=o=o.next;do{var c=l,p=c.destroy;c=c.tag,p!==void 0&&(c&2||c&4)&&TC(n,e,p),l=l.next}while(l!==o)}Qf(t,e,n);break;case 1:if(!Wl&&(ig(n,e),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(r){qs(n,e,r)}Qf(t,e,n);break;case 21:Qf(t,e,n);break;case 22:n.mode&1?(Wl=(o=Wl)||n.memoizedState!==null,Qf(t,e,n),Wl=o):Qf(t,e,n);break;default:Qf(t,e,n)}}function UT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new rz),e.forEach(function(o){var l=pz.bind(null,t,o);n.has(o)||(n.add(o),o.then(l,l))})}}function Qc(t,e){var n=e.deletions;if(n!==null)for(var o=0;o<n.length;o++){var l=n[o];try{var c=t,p=e,r=p;t:for(;r!==null;){switch(r.tag){case 5:Il=r.stateNode,eh=!1;break t;case 3:Il=r.stateNode.containerInfo,eh=!0;break t;case 4:Il=r.stateNode.containerInfo,eh=!0;break t}r=r.return}if(Il===null)throw Error(Hn(160));$M(c,p,l),Il=null,eh=!1;var w=l.alternate;w!==null&&(w.return=null),l.return=null}catch(M){qs(l,e,M)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)qM(e,t),e=e.sibling}function qM(t,e){var n=t.alternate,o=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qc(e,t),Ah(t),o&4){try{Av(3,t,t.return),bx(3,t)}catch(q){qs(t,t.return,q)}try{Av(5,t,t.return)}catch(q){qs(t,t.return,q)}}break;case 1:Qc(e,t),Ah(t),o&512&&n!==null&&ig(n,n.return);break;case 5:if(Qc(e,t),Ah(t),o&512&&n!==null&&ig(n,n.return),t.flags&32){var l=t.stateNode;try{Dv(l,"")}catch(q){qs(t,t.return,q)}}if(o&4&&(l=t.stateNode,l!=null)){var c=t.memoizedProps,p=n!==null?n.memoizedProps:c,r=t.type,w=t.updateQueue;if(t.updateQueue=null,w!==null)try{r==="input"&&c.type==="radio"&&c.name!=null&&_E(l,c),QI(r,p);var M=QI(r,c);for(p=0;p<w.length;p+=2){var N=w[p],E=w[p+1];N==="style"?bE(l,E):N==="dangerouslySetInnerHTML"?xE(l,E):N==="children"?Dv(l,E):a2(l,N,E,M)}switch(r){case"input":HI(l,c);break;case"textarea":vE(l,c);break;case"select":var Z=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!c.multiple;var Y=c.value;Y!=null?lg(l,!!c.multiple,Y,!1):Z!==!!c.multiple&&(c.defaultValue!=null?lg(l,!!c.multiple,c.defaultValue,!0):lg(l,!!c.multiple,c.multiple?[]:"",!1))}l[Zv]=c}catch(q){qs(t,t.return,q)}}break;case 6:if(Qc(e,t),Ah(t),o&4){if(t.stateNode===null)throw Error(Hn(162));l=t.stateNode,c=t.memoizedProps;try{l.nodeValue=c}catch(q){qs(t,t.return,q)}}break;case 3:if(Qc(e,t),Ah(t),o&4&&n!==null&&n.memoizedState.isDehydrated)try{Bv(e.containerInfo)}catch(q){qs(t,t.return,q)}break;case 4:Qc(e,t),Ah(t);break;case 13:Qc(e,t),Ah(t),l=t.child,l.flags&8192&&(c=l.memoizedState!==null,l.stateNode.isHidden=c,!c||l.alternate!==null&&l.alternate.memoizedState!==null||(j2=ha())),o&4&&UT(t);break;case 22:if(N=n!==null&&n.memoizedState!==null,t.mode&1?(Wl=(M=Wl)||N,Qc(e,t),Wl=M):Qc(e,t),Ah(t),o&8192){if(M=t.memoizedState!==null,(t.stateNode.isHidden=M)&&!N&&t.mode&1)for(yi=t,N=t.child;N!==null;){for(E=yi=N;yi!==null;){switch(Z=yi,Y=Z.child,Z.tag){case 0:case 11:case 14:case 15:Av(4,Z,Z.return);break;case 1:ig(Z,Z.return);var K=Z.stateNode;if(typeof K.componentWillUnmount=="function"){o=Z,n=Z.return;try{e=o,K.props=e.memoizedProps,K.state=e.memoizedState,K.componentWillUnmount()}catch(q){qs(o,n,q)}}break;case 5:ig(Z,Z.return);break;case 22:if(Z.memoizedState!==null){ZT(E);continue}}Y!==null?(Y.return=Z,yi=Y):ZT(E)}N=N.sibling}t:for(N=null,E=t;;){if(E.tag===5){if(N===null){N=E;try{l=E.stateNode,M?(c=l.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(r=E.stateNode,w=E.memoizedProps.style,p=w!=null&&w.hasOwnProperty("display")?w.display:null,r.style.display=wE("display",p))}catch(q){qs(t,t.return,q)}}}else if(E.tag===6){if(N===null)try{E.stateNode.nodeValue=M?"":E.memoizedProps}catch(q){qs(t,t.return,q)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===t)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===t)break t;for(;E.sibling===null;){if(E.return===null||E.return===t)break t;N===E&&(N=null),E=E.return}N===E&&(N=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:Qc(e,t),Ah(t),o&4&&UT(t);break;case 21:break;default:Qc(e,t),Ah(t)}}function Ah(t){var e=t.flags;if(e&2){try{t:{for(var n=t.return;n!==null;){if(HM(n)){var o=n;break t}n=n.return}throw Error(Hn(160))}switch(o.tag){case 5:var l=o.stateNode;o.flags&32&&(Dv(l,""),o.flags&=-33);var c=jT(t);MC(t,c,l);break;case 3:case 4:var p=o.stateNode.containerInfo,r=jT(t);EC(t,r,p);break;default:throw Error(Hn(161))}}catch(w){qs(t,t.return,w)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function sz(t,e,n){yi=t,JM(t)}function JM(t,e,n){for(var o=(t.mode&1)!==0;yi!==null;){var l=yi,c=l.child;if(l.tag===22&&o){var p=l.memoizedState!==null||Y0;if(!p){var r=l.alternate,w=r!==null&&r.memoizedState!==null||Wl;r=Y0;var M=Wl;if(Y0=p,(Wl=w)&&!M)for(yi=l;yi!==null;)p=yi,w=p.child,p.tag===22&&p.memoizedState!==null?VT(l):w!==null?(w.return=p,yi=w):VT(l);for(;c!==null;)yi=c,JM(c),c=c.sibling;yi=l,Y0=r,Wl=M}GT(t)}else l.subtreeFlags&8772&&c!==null?(c.return=l,yi=c):GT(t)}}function GT(t){for(;yi!==null;){var e=yi;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Wl||bx(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!Wl)if(n===null)o.componentDidMount();else{var l=e.elementType===e.type?n.memoizedProps:th(e.type,n.memoizedProps);o.componentDidUpdate(l,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&AT(e,c,o);break;case 3:var p=e.updateQueue;if(p!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}AT(e,p,n)}break;case 5:var r=e.stateNode;if(n===null&&e.flags&4){n=r;var w=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":w.autoFocus&&n.focus();break;case"img":w.src&&(n.src=w.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var M=e.alternate;if(M!==null){var N=M.memoizedState;if(N!==null){var E=N.dehydrated;E!==null&&Bv(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Hn(163))}Wl||e.flags&512&&SC(e)}catch(Z){qs(e,e.return,Z)}}if(e===t){yi=null;break}if(n=e.sibling,n!==null){n.return=e.return,yi=n;break}yi=e.return}}function ZT(t){for(;yi!==null;){var e=yi;if(e===t){yi=null;break}var n=e.sibling;if(n!==null){n.return=e.return,yi=n;break}yi=e.return}}function VT(t){for(;yi!==null;){var e=yi;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bx(4,e)}catch(w){qs(e,n,w)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var l=e.return;try{o.componentDidMount()}catch(w){qs(e,l,w)}}var c=e.return;try{SC(e)}catch(w){qs(e,c,w)}break;case 5:var p=e.return;try{SC(e)}catch(w){qs(e,p,w)}}}catch(w){qs(e,e.return,w)}if(e===t){yi=null;break}var r=e.sibling;if(r!==null){r.return=e.return,yi=r;break}yi=e.return}}var az=Math.ceil,W1=bf.ReactCurrentDispatcher,B2=bf.ReactCurrentOwner,Dc=bf.ReactCurrentBatchConfig,xo=0,al=null,Ca=null,Al=0,oc=0,rg=Id(0),Va=0,$v=null,Mp=0,Ix=0,F2=0,Tv=null,Nu=null,j2=0,bg=1/0,cf=null,Y1=!1,LC=null,md=null,X0=!1,ld=null,X1=0,Sv=0,kC=null,y1=-1,x1=0;function _u(){return xo&6?ha():y1!==-1?y1:y1=ha()}function gd(t){return t.mode&1?xo&2&&Al!==0?Al&-Al:V3.transition!==null?(x1===0&&(x1=DE()),x1):(t=jo,t!==0||(t=window.event,t=t===void 0?16:UE(t.type)),t):1}function lh(t,e,n,o){if(50<Sv)throw Sv=0,kC=null,Error(Hn(185));ty(t,n,o),(!(xo&2)||t!==al)&&(t===al&&(!(xo&2)&&(Ix|=n),Va===4&&od(t,Al)),Fu(t,o),n===1&&xo===0&&!(e.mode&1)&&(bg=ha()+500,yx&&Cd()))}function Fu(t,e){var n=t.callbackNode;VP(t,e);var o=L1(t,t===al?Al:0);if(o===0)n!==null&&QA(n),t.callbackNode=null,t.callbackPriority=0;else if(e=o&-o,t.callbackPriority!==e){if(n!=null&&QA(n),e===1)t.tag===0?Z3(WT.bind(null,t)):sM(WT.bind(null,t)),F3(function(){!(xo&6)&&Cd()}),n=null;else{switch(NE(o)){case 1:n=f2;break;case 4:n=PE;break;case 16:n=M1;break;case 536870912:n=zE;break;default:n=M1}n=oL(n,KM.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function KM(t,e){if(y1=-1,x1=0,xo&6)throw Error(Hn(327));var n=t.callbackNode;if(dg()&&t.callbackNode!==n)return null;var o=L1(t,t===al?Al:0);if(o===0)return null;if(o&30||o&t.expiredLanes||e)e=H1(t,o);else{e=o;var l=xo;xo|=2;var c=tL();(al!==t||Al!==e)&&(cf=null,bg=ha()+500,Ip(t,e));do try{cz();break}catch(r){QM(t,r)}while(1);A2(),W1.current=c,xo=l,Ca!==null?e=0:(al=null,Al=0,e=Va)}if(e!==0){if(e===2&&(l=rC(t),l!==0&&(o=l,e=PC(t,l))),e===1)throw n=$v,Ip(t,0),od(t,o),Fu(t,ha()),n;if(e===6)od(t,o);else{if(l=t.current.alternate,!(o&30)&&!lz(l)&&(e=H1(t,o),e===2&&(c=rC(t),c!==0&&(o=c,e=PC(t,c))),e===1))throw n=$v,Ip(t,0),od(t,o),Fu(t,ha()),n;switch(t.finishedWork=l,t.finishedLanes=o,e){case 0:case 1:throw Error(Hn(345));case 2:mp(t,Nu,cf);break;case 3:if(od(t,o),(o&130023424)===o&&(e=j2+500-ha(),10<e)){if(L1(t,0)!==0)break;if(l=t.suspendedLanes,(l&o)!==o){_u(),t.pingedLanes|=t.suspendedLanes&l;break}t.timeoutHandle=fC(mp.bind(null,t,Nu,cf),e);break}mp(t,Nu,cf);break;case 4:if(od(t,o),(o&4194240)===o)break;for(e=t.eventTimes,l=-1;0<o;){var p=31-ah(o);c=1<<p,p=e[p],p>l&&(l=p),o&=~c}if(o=l,o=ha()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*az(o/1960))-o,10<o){t.timeoutHandle=fC(mp.bind(null,t,Nu,cf),o);break}mp(t,Nu,cf);break;case 5:mp(t,Nu,cf);break;default:throw Error(Hn(329))}}}return Fu(t,ha()),t.callbackNode===n?KM.bind(null,t):null}function PC(t,e){var n=Tv;return t.current.memoizedState.isDehydrated&&(Ip(t,e).flags|=256),t=H1(t,e),t!==2&&(e=Nu,Nu=n,e!==null&&zC(e)),t}function zC(t){Nu===null?Nu=t:Nu.push.apply(Nu,t)}function lz(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var l=n[o],c=l.getSnapshot;l=l.value;try{if(!uh(c(),l))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function od(t,e){for(e&=~F2,e&=~Ix,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ah(e),o=1<<n;t[n]=-1,e&=~o}}function WT(t){if(xo&6)throw Error(Hn(327));dg();var e=L1(t,0);if(!(e&1))return Fu(t,ha()),null;var n=H1(t,e);if(t.tag!==0&&n===2){var o=rC(t);o!==0&&(e=o,n=PC(t,o))}if(n===1)throw n=$v,Ip(t,0),od(t,e),Fu(t,ha()),n;if(n===6)throw Error(Hn(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,mp(t,Nu,cf),Fu(t,ha()),null}function U2(t,e){var n=xo;xo|=1;try{return t(e)}finally{xo=n,xo===0&&(bg=ha()+500,yx&&Cd())}}function Lp(t){ld!==null&&ld.tag===0&&!(xo&6)&&dg();var e=xo;xo|=1;var n=Dc.transition,o=jo;try{if(Dc.transition=null,jo=1,t)return t()}finally{jo=o,Dc.transition=n,xo=e,!(xo&6)&&Cd()}}function G2(){oc=rg.current,gs(rg)}function Ip(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,B3(n)),Ca!==null)for(n=Ca.return;n!==null;){var o=n;switch(b2(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&N1();break;case 3:xg(),gs(Ru),gs(Xl),k2();break;case 5:L2(o);break;case 4:xg();break;case 13:gs(Os);break;case 19:gs(Os);break;case 10:T2(o.type._context);break;case 22:case 23:G2()}n=n.return}if(al=t,Ca=t=_d(t.current,null),Al=oc=e,Va=0,$v=null,F2=Ix=Mp=0,Nu=Tv=null,yp!==null){for(e=0;e<yp.length;e++)if(n=yp[e],o=n.interleaved,o!==null){n.interleaved=null;var l=o.next,c=n.pending;if(c!==null){var p=c.next;c.next=l,o.next=p}n.pending=o}yp=null}return t}function QM(t,e){do{var n=Ca;try{if(A2(),g1.current=V1,Z1){for(var o=Rs.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}Z1=!1}if(Ep=0,ol=Za=Rs=null,Cv=!1,Yv=0,B2.current=null,n===null||n.return===null){Va=1,$v=e,Ca=null;break}t:{var c=t,p=n.return,r=n,w=e;if(e=Al,r.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){var M=w,N=r,E=N.tag;if(!(N.mode&1)&&(E===0||E===11||E===15)){var Z=N.alternate;Z?(N.updateQueue=Z.updateQueue,N.memoizedState=Z.memoizedState,N.lanes=Z.lanes):(N.updateQueue=null,N.memoizedState=null)}var Y=PT(p);if(Y!==null){Y.flags&=-257,zT(Y,p,r,c,e),Y.mode&1&&kT(c,M,e),e=Y,w=M;var K=e.updateQueue;if(K===null){var q=new Set;q.add(w),e.updateQueue=q}else K.add(w);break t}else{if(!(e&1)){kT(c,M,e),Z2();break t}w=Error(Hn(426))}}else if(Ts&&r.mode&1){var at=PT(p);if(at!==null){!(at.flags&65536)&&(at.flags|=256),zT(at,p,r,c,e),I2(wg(w,r));break t}}c=w=wg(w,r),Va!==4&&(Va=2),Tv===null?Tv=[c]:Tv.push(c),c=p;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var J=OM(c,w,e);CT(c,J);break t;case 1:r=w;var Q=c.type,lt=c.stateNode;if(!(c.flags&128)&&(typeof Q.getDerivedStateFromError=="function"||lt!==null&&typeof lt.componentDidCatch=="function"&&(md===null||!md.has(lt)))){c.flags|=65536,e&=-e,c.lanes|=e;var Ct=RM(c,r,e);CT(c,Ct);break t}}c=c.return}while(c!==null)}nL(n)}catch(j){e=j,Ca===n&&n!==null&&(Ca=n=n.return);continue}break}while(1)}function tL(){var t=W1.current;return W1.current=V1,t===null?V1:t}function Z2(){(Va===0||Va===3||Va===2)&&(Va=4),al===null||!(Mp&268435455)&&!(Ix&268435455)||od(al,Al)}function H1(t,e){var n=xo;xo|=2;var o=tL();(al!==t||Al!==e)&&(cf=null,Ip(t,e));do try{uz();break}catch(l){QM(t,l)}while(1);if(A2(),xo=n,W1.current=o,Ca!==null)throw Error(Hn(261));return al=null,Al=0,Va}function uz(){for(;Ca!==null;)eL(Ca)}function cz(){for(;Ca!==null&&!NP();)eL(Ca)}function eL(t){var e=rL(t.alternate,t,oc);t.memoizedProps=t.pendingProps,e===null?nL(t):Ca=e,B2.current=null}function nL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=iz(n,e),n!==null){n.flags&=32767,Ca=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Va=6,Ca=null;return}}else if(n=nz(n,e,oc),n!==null){Ca=n;return}if(e=e.sibling,e!==null){Ca=e;return}Ca=e=t}while(e!==null);Va===0&&(Va=5)}function mp(t,e,n){var o=jo,l=Dc.transition;try{Dc.transition=null,jo=1,hz(t,e,n,o)}finally{Dc.transition=l,jo=o}return null}function hz(t,e,n,o){do dg();while(ld!==null);if(xo&6)throw Error(Hn(327));n=t.finishedWork;var l=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Hn(177));t.callbackNode=null,t.callbackPriority=0;var c=n.lanes|n.childLanes;if(WP(t,c),t===al&&(Ca=al=null,Al=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||X0||(X0=!0,oL(M1,function(){return dg(),null})),c=(n.flags&15990)!==0,n.subtreeFlags&15990||c){c=Dc.transition,Dc.transition=null;var p=jo;jo=1;var r=xo;xo|=4,B2.current=null,oz(t,n),qM(n,t),k3(cC),k1=!!uC,cC=uC=null,t.current=n,sz(n),OP(),xo=r,jo=p,Dc.transition=c}else t.current=n;if(X0&&(X0=!1,ld=t,X1=l),c=t.pendingLanes,c===0&&(md=null),FP(n.stateNode),Fu(t,ha()),e!==null)for(o=t.onRecoverableError,n=0;n<e.length;n++)l=e[n],o(l.value,{componentStack:l.stack,digest:l.digest});if(Y1)throw Y1=!1,t=LC,LC=null,t;return X1&1&&t.tag!==0&&dg(),c=t.pendingLanes,c&1?t===kC?Sv++:(Sv=0,kC=t):Sv=0,Cd(),null}function dg(){if(ld!==null){var t=NE(X1),e=Dc.transition,n=jo;try{if(Dc.transition=null,jo=16>t?16:t,ld===null)var o=!1;else{if(t=ld,ld=null,X1=0,xo&6)throw Error(Hn(331));var l=xo;for(xo|=4,yi=t.current;yi!==null;){var c=yi,p=c.child;if(yi.flags&16){var r=c.deletions;if(r!==null){for(var w=0;w<r.length;w++){var M=r[w];for(yi=M;yi!==null;){var N=yi;switch(N.tag){case 0:case 11:case 15:Av(8,N,c)}var E=N.child;if(E!==null)E.return=N,yi=E;else for(;yi!==null;){N=yi;var Z=N.sibling,Y=N.return;if(XM(N),N===M){yi=null;break}if(Z!==null){Z.return=Y,yi=Z;break}yi=Y}}}var K=c.alternate;if(K!==null){var q=K.child;if(q!==null){K.child=null;do{var at=q.sibling;q.sibling=null,q=at}while(q!==null)}}yi=c}}if(c.subtreeFlags&2064&&p!==null)p.return=c,yi=p;else t:for(;yi!==null;){if(c=yi,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Av(9,c,c.return)}var J=c.sibling;if(J!==null){J.return=c.return,yi=J;break t}yi=c.return}}var Q=t.current;for(yi=Q;yi!==null;){p=yi;var lt=p.child;if(p.subtreeFlags&2064&&lt!==null)lt.return=p,yi=lt;else t:for(p=Q;yi!==null;){if(r=yi,r.flags&2048)try{switch(r.tag){case 0:case 11:case 15:bx(9,r)}}catch(j){qs(r,r.return,j)}if(r===p){yi=null;break t}var Ct=r.sibling;if(Ct!==null){Ct.return=r.return,yi=Ct;break t}yi=r.return}}if(xo=l,Cd(),zh&&typeof zh.onPostCommitFiberRoot=="function")try{zh.onPostCommitFiberRoot(px,t)}catch{}o=!0}return o}finally{jo=n,Dc.transition=e}}return!1}function YT(t,e,n){e=wg(n,e),e=OM(t,e,1),t=pd(t,e,1),e=_u(),t!==null&&(ty(t,1,e),Fu(t,e))}function qs(t,e,n){if(t.tag===3)YT(t,t,n);else for(;e!==null;){if(e.tag===3){YT(e,t,n);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(md===null||!md.has(o))){t=wg(n,t),t=RM(e,t,1),e=pd(e,t,1),t=_u(),e!==null&&(ty(e,1,t),Fu(e,t));break}}e=e.return}}function fz(t,e,n){var o=t.pingCache;o!==null&&o.delete(e),e=_u(),t.pingedLanes|=t.suspendedLanes&n,al===t&&(Al&n)===n&&(Va===4||Va===3&&(Al&130023424)===Al&&500>ha()-j2?Ip(t,0):F2|=n),Fu(t,e)}function iL(t,e){e===0&&(t.mode&1?(e=R0,R0<<=1,!(R0&130023424)&&(R0=4194304)):e=1);var n=_u();t=xf(t,e),t!==null&&(ty(t,e,n),Fu(t,n))}function dz(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),iL(t,n)}function pz(t,e){var n=0;switch(t.tag){case 13:var o=t.stateNode,l=t.memoizedState;l!==null&&(n=l.retryLane);break;case 19:o=t.stateNode;break;default:throw Error(Hn(314))}o!==null&&o.delete(e),iL(t,n)}var rL;rL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ru.current)Ou=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ou=!1,ez(t,e,n);Ou=!!(t.flags&131072)}else Ou=!1,Ts&&e.flags&1048576&&aM(e,B1,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;v1(t,e),t=e.pendingProps;var l=_g(e,Xl.current);fg(e,n),l=z2(null,e,o,t,l,n);var c=D2();return e.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bu(o)?(c=!0,O1(e)):c=!1,e.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,E2(e),l.updater=xx,e.stateNode=l,l._reactInternals=e,yC(e,o,t,n),e=bC(null,e,o,!0,c,n)):(e.tag=0,Ts&&c&&w2(e),fu(null,e,l,n),e=e.child),e;case 16:o=e.elementType;t:{switch(v1(t,e),t=e.pendingProps,l=o._init,o=l(o._payload),e.type=o,l=e.tag=gz(o),t=th(o,t),l){case 0:e=wC(null,e,o,t,n);break t;case 1:e=OT(null,e,o,t,n);break t;case 11:e=DT(null,e,o,t,n);break t;case 14:e=NT(null,e,o,th(o.type,t),n);break t}throw Error(Hn(306,o,""))}return e;case 0:return o=e.type,l=e.pendingProps,l=e.elementType===o?l:th(o,l),wC(t,e,o,l,n);case 1:return o=e.type,l=e.pendingProps,l=e.elementType===o?l:th(o,l),OT(t,e,o,l,n);case 3:t:{if(UM(e),t===null)throw Error(Hn(387));o=e.pendingProps,c=e.memoizedState,l=c.element,hM(t,e),U1(e,o,null,n);var p=e.memoizedState;if(o=p.element,c.isDehydrated)if(c={element:o,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){l=wg(Error(Hn(423)),e),e=RT(t,e,o,n,l);break t}else if(o!==l){l=wg(Error(Hn(424)),e),e=RT(t,e,o,n,l);break t}else for(ac=dd(e.stateNode.containerInfo.firstChild),lc=e,Ts=!0,nh=null,n=mM(e,null,o,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vg(),o===l){e=wf(t,e,n);break t}fu(t,e,o,n)}e=e.child}return e;case 5:return gM(e),t===null&&gC(e),o=e.type,l=e.pendingProps,c=t!==null?t.memoizedProps:null,p=l.children,hC(o,l)?p=null:c!==null&&hC(o,c)&&(e.flags|=32),jM(t,e),fu(t,e,p,n),e.child;case 6:return t===null&&gC(e),null;case 13:return GM(t,e,n);case 4:return M2(e,e.stateNode.containerInfo),o=e.pendingProps,t===null?e.child=yg(e,null,o,n):fu(t,e,o,n),e.child;case 11:return o=e.type,l=e.pendingProps,l=e.elementType===o?l:th(o,l),DT(t,e,o,l,n);case 7:return fu(t,e,e.pendingProps,n),e.child;case 8:return fu(t,e,e.pendingProps.children,n),e.child;case 12:return fu(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(o=e.type._context,l=e.pendingProps,c=e.memoizedProps,p=l.value,ss(F1,o._currentValue),o._currentValue=p,c!==null)if(uh(c.value,p)){if(c.children===l.children&&!Ru.current){e=wf(t,e,n);break t}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var r=c.dependencies;if(r!==null){p=c.child;for(var w=r.firstContext;w!==null;){if(w.context===o){if(c.tag===1){w=gf(-1,n&-n),w.tag=2;var M=c.updateQueue;if(M!==null){M=M.shared;var N=M.pending;N===null?w.next=w:(w.next=N.next,N.next=w),M.pending=w}}c.lanes|=n,w=c.alternate,w!==null&&(w.lanes|=n),_C(c.return,n,e),r.lanes|=n;break}w=w.next}}else if(c.tag===10)p=c.type===e.type?null:c.child;else if(c.tag===18){if(p=c.return,p===null)throw Error(Hn(341));p.lanes|=n,r=p.alternate,r!==null&&(r.lanes|=n),_C(p,n,e),p=c.sibling}else p=c.child;if(p!==null)p.return=c;else for(p=c;p!==null;){if(p===e){p=null;break}if(c=p.sibling,c!==null){c.return=p.return,p=c;break}p=p.return}c=p}fu(t,e,l.children,n),e=e.child}return e;case 9:return l=e.type,o=e.pendingProps.children,fg(e,n),l=Oc(l),o=o(l),e.flags|=1,fu(t,e,o,n),e.child;case 14:return o=e.type,l=th(o,e.pendingProps),l=th(o.type,l),NT(t,e,o,l,n);case 15:return BM(t,e,e.type,e.pendingProps,n);case 17:return o=e.type,l=e.pendingProps,l=e.elementType===o?l:th(o,l),v1(t,e),e.tag=1,Bu(o)?(t=!0,O1(e)):t=!1,fg(e,n),dM(e,o,l),yC(e,o,l,n),bC(null,e,o,!0,t,n);case 19:return ZM(t,e,n);case 22:return FM(t,e,n)}throw Error(Hn(156,e.tag))};function oL(t,e){return kE(t,e)}function mz(t,e,n,o){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zc(t,e,n,o){return new mz(t,e,n,o)}function V2(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gz(t){if(typeof t=="function")return V2(t)?1:0;if(t!=null){if(t=t.$$typeof,t===u2)return 11;if(t===c2)return 14}return 2}function _d(t,e){var n=t.alternate;return n===null?(n=zc(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function w1(t,e,n,o,l,c){var p=2;if(o=t,typeof t=="function")V2(t)&&(p=1);else if(typeof t=="string")p=5;else t:switch(t){case Hm:return Cp(n.children,l,c,e);case l2:p=8,l|=8;break;case ZI:return t=zc(12,n,e,l|2),t.elementType=ZI,t.lanes=c,t;case VI:return t=zc(13,n,e,l),t.elementType=VI,t.lanes=c,t;case WI:return t=zc(19,n,e,l),t.elementType=WI,t.lanes=c,t;case pE:return Cx(n,l,c,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case fE:p=10;break t;case dE:p=9;break t;case u2:p=11;break t;case c2:p=14;break t;case nd:p=16,o=null;break t}throw Error(Hn(130,t==null?t:typeof t,""))}return e=zc(p,n,e,l),e.elementType=t,e.type=o,e.lanes=c,e}function Cp(t,e,n,o){return t=zc(7,t,o,e),t.lanes=n,t}function Cx(t,e,n,o){return t=zc(22,t,o,e),t.elementType=pE,t.lanes=n,t.stateNode={isHidden:!1},t}function yI(t,e,n){return t=zc(6,t,null,e),t.lanes=n,t}function xI(t,e,n){return e=zc(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _z(t,e,n,o,l){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tI(0),this.expirationTimes=tI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tI(0),this.identifierPrefix=o,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function W2(t,e,n,o,l,c,p,r,w){return t=new _z(t,e,n,r,w),e===1?(e=1,c===!0&&(e|=8)):e=0,c=zc(3,null,null,e),t.current=c,c.stateNode=t,c.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},E2(c),t}function vz(t,e,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xm,key:o==null?null:""+o,children:t,containerInfo:e,implementation:n}}function sL(t){if(!t)return wd;t=t._reactInternals;t:{if(Rp(t)!==t||t.tag!==1)throw Error(Hn(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Bu(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(e!==null);throw Error(Hn(171))}if(t.tag===1){var n=t.type;if(Bu(n))return oM(t,n,e)}return e}function aL(t,e,n,o,l,c,p,r,w){return t=W2(n,o,!0,t,l,c,p,r,w),t.context=sL(null),n=t.current,o=_u(),l=gd(n),c=gf(o,l),c.callback=e??null,pd(n,c,l),t.current.lanes=l,ty(t,l,o),Fu(t,o),t}function Ax(t,e,n,o){var l=e.current,c=_u(),p=gd(l);return n=sL(n),e.context===null?e.context=n:e.pendingContext=n,e=gf(c,p),e.payload={element:t},o=o===void 0?null:o,o!==null&&(e.callback=o),t=pd(l,e,p),t!==null&&(lh(t,l,p,c),m1(t,l,p)),p}function $1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function XT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Y2(t,e){XT(t,e),(t=t.alternate)&&XT(t,e)}function yz(){return null}var lL=typeof reportError=="function"?reportError:function(t){console.error(t)};function X2(t){this._internalRoot=t}Tx.prototype.render=X2.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Hn(409));Ax(t,e,null,null)};Tx.prototype.unmount=X2.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Lp(function(){Ax(null,t,null,null)}),e[yf]=null}};function Tx(t){this._internalRoot=t}Tx.prototype.unstable_scheduleHydration=function(t){if(t){var e=BE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<rd.length&&e!==0&&e<rd[n].priority;n++);rd.splice(n,0,t),n===0&&jE(t)}};function H2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Sx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function HT(){}function xz(t,e,n,o,l){if(l){if(typeof o=="function"){var c=o;o=function(){var M=$1(p);c.call(M)}}var p=aL(e,o,t,0,null,!1,!1,"",HT);return t._reactRootContainer=p,t[yf]=p.current,Uv(t.nodeType===8?t.parentNode:t),Lp(),p}for(;l=t.lastChild;)t.removeChild(l);if(typeof o=="function"){var r=o;o=function(){var M=$1(w);r.call(M)}}var w=W2(t,0,!1,null,null,!1,!1,"",HT);return t._reactRootContainer=w,t[yf]=w.current,Uv(t.nodeType===8?t.parentNode:t),Lp(function(){Ax(e,w,n,o)}),w}function Ex(t,e,n,o,l){var c=n._reactRootContainer;if(c){var p=c;if(typeof l=="function"){var r=l;l=function(){var w=$1(p);r.call(w)}}Ax(e,p,t,l)}else p=xz(n,e,t,l,o);return $1(p)}OE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=gv(e.pendingLanes);n!==0&&(d2(e,n|1),Fu(e,ha()),!(xo&6)&&(bg=ha()+500,Cd()))}break;case 13:Lp(function(){var o=xf(t,1);if(o!==null){var l=_u();lh(o,t,1,l)}}),Y2(t,1)}};p2=function(t){if(t.tag===13){var e=xf(t,134217728);if(e!==null){var n=_u();lh(e,t,134217728,n)}Y2(t,134217728)}};RE=function(t){if(t.tag===13){var e=gd(t),n=xf(t,e);if(n!==null){var o=_u();lh(n,t,e,o)}Y2(t,e)}};BE=function(){return jo};FE=function(t,e){var n=jo;try{return jo=t,e()}finally{jo=n}};eC=function(t,e,n){switch(e){case"input":if(HI(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var o=n[e];if(o!==t&&o.form===t.form){var l=vx(o);if(!l)throw Error(Hn(90));gE(o),HI(o,l)}}}break;case"textarea":vE(t,n);break;case"select":e=n.value,e!=null&&lg(t,!!n.multiple,e,!1)}};AE=U2;TE=Lp;var wz={usingClientEntryPoint:!1,Events:[ny,Km,vx,IE,CE,U2]},cv={findFiberByHostInstance:vp,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},bz={bundleType:cv.bundleType,version:cv.version,rendererPackageName:cv.rendererPackageName,rendererConfig:cv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bf.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ME(t),t===null?null:t.stateNode},findFiberByHostInstance:cv.findFiberByHostInstance||yz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var H0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!H0.isDisabled&&H0.supportsFiber)try{px=H0.inject(bz),zh=H0}catch{}}hc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wz;hc.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!H2(e))throw Error(Hn(200));return vz(t,e,null,n)};hc.createRoot=function(t,e){if(!H2(t))throw Error(Hn(299));var n=!1,o="",l=lL;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(l=e.onRecoverableError)),e=W2(t,1,!1,null,null,n,!1,o,l),t[yf]=e.current,Uv(t.nodeType===8?t.parentNode:t),new X2(e)};hc.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Hn(188)):(t=Object.keys(t).join(","),Error(Hn(268,t)));return t=ME(e),t=t===null?null:t.stateNode,t};hc.flushSync=function(t){return Lp(t)};hc.hydrate=function(t,e,n){if(!Sx(e))throw Error(Hn(200));return Ex(null,t,e,!0,n)};hc.hydrateRoot=function(t,e,n){if(!H2(t))throw Error(Hn(405));var o=n!=null&&n.hydratedSources||null,l=!1,c="",p=lL;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),e=aL(e,null,t,1,n??null,l,!1,c,p),t[yf]=e.current,Uv(t),o)for(t=0;t<o.length;t++)n=o[t],l=n._getVersion,l=l(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,l]:e.mutableSourceEagerHydrationData.push(n,l);return new Tx(e)};hc.render=function(t,e,n){if(!Sx(e))throw Error(Hn(200));return Ex(null,t,e,!1,n)};hc.unmountComponentAtNode=function(t){if(!Sx(t))throw Error(Hn(40));return t._reactRootContainer?(Lp(function(){Ex(null,null,t,!1,function(){t._reactRootContainer=null,t[yf]=null})}),!0):!1};hc.unstable_batchedUpdates=U2;hc.unstable_renderSubtreeIntoContainer=function(t,e,n,o){if(!Sx(n))throw Error(Hn(200));if(t==null||t._reactInternals===void 0)throw Error(Hn(38));return Ex(t,e,n,!1,o)};hc.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=hc})(yP);var $T=A1;jI.createRoot=$T.createRoot,jI.hydrateRoot=$T.hydrateRoot;var q1={},Iz={get exports(){return q1},set exports(t){q1=t}};(function(t,e){(function(n,o){t.exports=o()})(fa,function(){var n,o,l;function c(r,w){if(!n)n=w;else if(!o)o=w;else{var M="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+o+")(sharedChunk); self.onerror = null;",N={};n(N),l=w(N),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(l.workerUrl=window.URL.createObjectURL(new Blob([M],{type:"text/javascript"})))}}c(["exports"],function(r){var w=typeof self<"u"?self:{},M="2.12.1";let N;const E={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(N==null){const s=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{N={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):s}catch{N=s}}return N},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Z={supported:!1,testSupport:function(s){!q&&K&&(at?J(s):Y=s)}};let Y,K,q=!1,at=!1;function J(s){const i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,K),s.isContextLost())return;Z.supported=!0}catch{}s.deleteTexture(i),q=!0}w.document&&(K=w.document.createElement("img"),K.onload=function(){Y&&J(Y),Y=null,at=!0},K.onerror=function(){q=!0,Y=null},K.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Q="01";var lt=Ct;function Ct(s,i,a,h){this.cx=3*s,this.bx=3*(a-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(h-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=i,this.p2x=a,this.p2y=h}Ct.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,i){if(i===void 0&&(i=1e-6),s<0)return 0;if(s>1)return 1;for(var a=s,h=0;h<8;h++){var m=this.sampleCurveX(a)-s;if(Math.abs(m)<i)return a;var v=this.sampleCurveDerivativeX(a);if(Math.abs(v)<1e-6)break;a-=m/v}var x=0,T=1;for(a=s,h=0;h<20&&(m=this.sampleCurveX(a),!(Math.abs(m-s)<i));h++)s>m?x=a:T=a,a=.5*(T-x)+x;return a},solve:function(s,i){return this.sampleCurveY(this.solveCurveX(s,i))}};var j=k;function k(s,i){this.x=s,this.y=i}k.prototype={clone:function(){return new k(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,i){return this.clone()._rotateAround(s,i)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var i=s.x-this.x,a=s.y-this.y;return i*i+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,i){return Math.atan2(this.x*i-this.y*s,this.x*s+this.y*i)},_matMult:function(s){var i=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=i,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var i=Math.cos(s),a=Math.sin(s),h=a*this.x+i*this.y;return this.x=i*this.x-a*this.y,this.y=h,this},_rotateAround:function(s,i){var a=Math.cos(s),h=Math.sin(s),m=i.y+h*(this.x-i.x)+a*(this.y-i.y);return this.x=i.x+a*(this.x-i.x)-h*(this.y-i.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},k.convert=function(s){return s instanceof k?s:Array.isArray(s)?new k(s[0],s[1]):s};const rt=Math.PI/180,yt=180/Math.PI;function xt(s){return s*rt}function kt(s){return s*yt}const de=[[0,0],[1,0],[1,1],[0,1]];function Et(s){if(s<=0)return 0;if(s>=1)return 1;const i=s*s,a=i*s;return 4*(s<.5?a:3*(s-i)+a-.75)}function te(s,i,a,h){const m=new lt(s,i,a,h);return function(v){return m.solve(v)}}const ht=te(.25,.1,.25,1);function ie(s,i,a){return Math.min(a,Math.max(i,s))}function ln(s,i,a){return(a=ie((a-s)/(i-s),0,1))*a*(3-2*a)}function Le(s,i,a){const h=a-i,m=((s-i)%h+h)%h+i;return m===i?a:m}function _e(s,i,a){if(!s.length)return a(null,[]);let h=s.length;const m=new Array(s.length);let v=null;s.forEach((x,T)=>{i(x,(P,O)=>{P&&(v=P),m[T]=O,--h==0&&a(v,m)})})}function Me(s){const i=[];for(const a in s)i.push(s[a]);return i}function be(s,...i){for(const a of i)for(const h in a)s[h]=a[h];return s}let ue=1;function Yt(){return ue++}function Ee(){return function s(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function ve(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function ye(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function fe(s,i){s.forEach(a=>{i[a]&&(i[a]=i[a].bind(i))})}function mn(s,i){return s.indexOf(i,s.length-i.length)!==-1}function Ue(s,i,a){const h={};for(const m in s)h[m]=i.call(a||this,s[m],m,s);return h}function Cn(s,i,a){const h={};for(const m in s)i.call(a||this,s[m],m,s)&&(h[m]=s[m]);return h}function Bn(s){return Array.isArray(s)?s.map(Bn):typeof s=="object"&&s?Ue(s,Bn):s}const Pn={};function cn(s){Pn[s]||(typeof console<"u"&&console.warn(s),Pn[s]=!0)}function Un(s,i,a){return(a.y-s.y)*(i.x-s.x)>(i.y-s.y)*(a.x-s.x)}function R(s){let i=0;for(let a,h,m=0,v=s.length,x=v-1;m<v;x=m++)a=s[m],h=s[x],i+=(h.x-a.x)*(a.y+h.y);return i}function st(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function gt(s){const i={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,m,v)=>{const x=m||v;return i[h]=!x||x.toLowerCase(),""}),i["max-age"]){const a=parseInt(i["max-age"],10);isNaN(a)?delete i["max-age"]:i["max-age"]=a}return i}let dt=null;function wt(s){if(dt==null){const i=s.navigator?s.navigator.userAgent:null;dt=!!s.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return dt}function Zt(s){try{const i=w[s];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}}function we(s,i){return[s[4*i],s[4*i+1],s[4*i+2],s[4*i+3]]}const We="mapbox-tiles";let pe,un,Ye=500,Ge=50;function Gn(){try{return w.caches}catch{}}function _i(){Gn()&&!pe&&(pe=w.caches.open(We))}function ui(s){const i=s.indexOf("?");if(i<0)return s;const a=function(m){const v=m.indexOf("?");return v>0?m.slice(v+1).split("&"):[]}(s),h=a.filter(m=>{const v=m.split("=");return v[0]==="language"||v[0]==="worldview"});return h.length?`${s.slice(0,i)}?${h.join("&")}`:s.slice(0,i)}let ji=1/0;const Hi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Hi);class vr extends Error{constructor(i,a,h){a===401&&co(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=a,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Jr=st()?()=>self.worker&&self.worker.referrer:()=>(w.location.protocol==="blob:"?w.parent:w).location.href,$i=function(s,i){if(!(/^file:/.test(a=s.url)||/^file:/.test(Jr())&&!/^\w+:/.test(a))){if(w.fetch&&w.Request&&w.AbortController&&w.Request.prototype.hasOwnProperty("signal"))return function(h,m){const v=new w.AbortController,x=new w.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Jr(),signal:v.signal});let T=!1,P=!1;const O=(V=x.url).indexOf("sku=")>0&&co(V);var V;h.type==="json"&&x.headers.set("Accept","application/json");const $=(ot,ct,bt)=>{if(P)return;if(ot&&ot.message!=="SecurityError"&&cn(ot),ct&&bt)return tt(ct);const zt=Date.now();w.fetch(x).then(Jt=>{if(Jt.ok){const le=O?Jt.clone():null;return tt(Jt,le,zt)}return m(new vr(Jt.statusText,Jt.status,h.url))}).catch(Jt=>{Jt.code!==20&&m(new Error(Jt.message))})},tt=(ot,ct,bt)=>{(h.type==="arrayBuffer"?ot.arrayBuffer():h.type==="json"?ot.json():ot.text()).then(zt=>{P||(ct&&bt&&function(Jt,le,Xt){if(_i(),!pe)return;const Qt={status:le.status,statusText:le.statusText,headers:new w.Headers};le.headers.forEach((Xe,Ze)=>Qt.headers.set(Ze,Xe));const ge=gt(le.headers.get("Cache-Control")||"");if(ge["no-store"])return;ge["max-age"]&&Qt.headers.set("Expires",new Date(Xt+1e3*ge["max-age"]).toUTCString());const he=Qt.headers.get("Expires");he&&(new Date(he).getTime()-Xt<42e4||function(Xe,Ze){if(un===void 0)try{new Response(new ReadableStream),un=!0}catch{un=!1}un?Ze(Xe.body):Xe.blob().then(Ze)}(le,Xe=>{const Ze=new w.Response(Xe,Qt);_i(),pe&&pe.then(dn=>dn.put(ui(Jt.url),Ze)).catch(dn=>cn(dn.message))}))}(x,ct,bt),T=!0,m(null,zt,ot.headers.get("Cache-Control"),ot.headers.get("Expires")))}).catch(zt=>{P||m(new Error(zt.message))})};return O?function(ot,ct){if(_i(),!pe)return ct(null);const bt=ui(ot.url);pe.then(zt=>{zt.match(bt).then(Jt=>{const le=function(Xt){if(!Xt)return!1;const Qt=new Date(Xt.headers.get("Expires")||0),ge=gt(Xt.headers.get("Cache-Control")||"");return Qt>Date.now()&&!ge["no-cache"]}(Jt);zt.delete(bt),le&&zt.put(bt,Jt.clone()),ct(null,Jt,le)}).catch(ct)}).catch(ct)}(x,$):$(null,null),{cancel:()=>{P=!0,T||v.abort()}}}(s,i);if(st()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,i,void 0,!0)}var a;return function(h,m){const v=new w.XMLHttpRequest;v.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const x in h.headers)v.setRequestHeader(x,h.headers[x]);return h.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=h.credentials==="include",v.onerror=()=>{m(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let x=v.response;if(h.type==="json")try{x=JSON.parse(v.response)}catch(T){return m(T)}m(null,x,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else m(new vr(v.statusText,v.status,h.url))},v.send(h.body),{cancel:()=>v.abort()}}(s,i)},uo=function(s,i){return $i(be(s,{type:"arrayBuffer"}),i)};function Go(s){const i=w.document.createElement("a");return i.href=s,i.protocol===w.document.location.protocol&&i.host===w.document.location.host}const Ir="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ar,Ro;Ar=[],Ro=0;const Qo=function(s,i){if(Z.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),Ro>=E.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:s,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return Ar.push(v),v}Ro++;let a=!1;const h=()=>{if(!a)for(a=!0,Ro--;Ar.length&&Ro<E.MAX_PARALLEL_IMAGE_REQUESTS;){const v=Ar.shift(),{requestParameters:x,callback:T,cancelled:P}=v;P||(v.cancel=Qo(x,T).cancel)}},m=uo(s,(v,x,T,P)=>{h(),v?i(v):x&&(w.createImageBitmap?function(O,V){const $=new w.Blob([new Uint8Array(O)],{type:"image/png"});w.createImageBitmap($).then(tt=>{V(null,tt)}).catch(tt=>{V(new Error(`Could not load image because of ${tt.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(O,V)=>i(O,V,T,P)):function(O,V){const $=new w.Image,tt=w.URL;$.onload=()=>{V(null,$),tt.revokeObjectURL($.src),$.onload=null,w.requestAnimationFrame(()=>{$.src=Ir})},$.onerror=()=>V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ot=new w.Blob([new Uint8Array(O)],{type:"image/png"});$.src=O.byteLength?tt.createObjectURL(ot):Ir}(x,(O,V)=>i(O,V,T,P)))});return{cancel:()=>{m.cancel(),h()}}},_s="NO_ACCESS_TOKEN";function bo(s){return s.indexOf("mapbox:")===0}function co(s){return E.API_URL_REGEX.test(s)}function io(s){return E.API_CDN_URL_REGEX.test(s)}function Ta(s){return E.API_STYLE_REGEX.test(s)&&!Wa(s)}function Wa(s){return E.API_SPRITE_REGEX.test(s)}const Sa=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ts(s){const i=s.match(Sa);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function js(s){const i=s.params.length?`?${s.params.join("&")}`:"";return`${s.protocol}://${s.authority}${s.path}${i}`}function Ea(s){if(!s)return null;const i=s.split(".");if(!i||i.length!==3)return null;try{return JSON.parse(decodeURIComponent(w.atob(i[1]).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Vt{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const a=Ea(E.ACCESS_TOKEN);let h="";return h=a&&a.u?w.btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,(m,v)=>String.fromCharCode(Number("0x"+v)))):E.ACCESS_TOKEN||"",i?`mapbox.eventData.${i}:${h}`:`mapbox.eventData:${h}`}fetchEventData(){const i=Zt("localStorage"),a=this.getStorageKey(),h=this.getStorageKey("uuid");if(i)try{const m=w.localStorage.getItem(a);m&&(this.eventData=JSON.parse(m));const v=w.localStorage.getItem(h);v&&(this.anonId=v)}catch{cn("Unable to read from LocalStorage")}}saveEventData(){const i=Zt("localStorage"),a=this.getStorageKey(),h=this.getStorageKey("uuid");if(i)try{w.localStorage.setItem(h,this.anonId),Object.keys(this.eventData).length>=1&&w.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{cn("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,a,h,m){if(!E.EVENTS_URL)return;const v=ts(E.EVENTS_URL);v.params.push(`access_token=${m||E.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(i).toISOString()},T=a?be(x,a):x,P={url:js(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};this.pendingRequest=function(O,V){return $i(be(O,{method:"POST"}),V)}(P,O=>{this.pendingRequest=null,h(O),this.saveEventData(),this.processRequests(m)})}queueRequest(i,a){this.queue.push(i),this.processRequests(a)}}const pt=new class extends Vt{constructor(s){super("appUserTurnstile"),this._customAccessToken=s}postTurnstileEvent(s,i){E.EVENTS_URL&&E.ACCESS_TOKEN&&Array.isArray(s)&&s.some(a=>bo(a)||co(a))&&this.queueRequest(Date.now(),i)}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=Ea(E.ACCESS_TOKEN),a=i?i.u:E.ACCESS_TOKEN;let h=a!==this.eventData.tokenU;ye(this.anonId)||(this.anonId=Ee(),h=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),x=new Date(m),T=(m-this.eventData.lastSuccess)/864e5;h=h||T>=1||T<-1||v.getDate()!==x.getDate()}else h=!0;h?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:M,skuId:Q,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=m,this.eventData.tokenU=a)},s):this.processRequests()}},It=pt.postTurnstileEvent.bind(pt),Ut=new class extends Vt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(s,i,a,h){this.skuToken=i,this.errorCb=h,E.EVENTS_URL&&(a||E.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(_s)))}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:a}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),ye(this.anonId)||(this.anonId=Ee()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:M,skuId:Q,skuToken:this.skuToken,userId:this.anonId},h=>{h?this.errorCb(h):i&&(this.success[i]=!0)},s))}},qt=Ut.postMapLoadEvent.bind(Ut),Ht=new class extends Vt{constructor(){super("gljs.performance")}postPerformanceEvent(s,i){E.EVENTS_URL&&(s||E.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},s)}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:i,performanceData:a}=this.queue.shift(),h=function(m){const v=w.performance.getEntriesByType("resource"),x=w.performance.getEntriesByType("mark"),T=function(tt){const ot={};if(tt){for(const ct in tt)if(ct!=="other")for(const bt of tt[ct]){const zt=`${ct}ResolveRangeMin`,Jt=`${ct}ResolveRangeMax`,le=`${ct}RequestCount`,Xt=`${ct}RequestCachedCount`;ot[zt]=Math.min(ot[zt]||1/0,bt.startTime),ot[Jt]=Math.max(ot[Jt]||-1/0,bt.responseEnd);const Qt=ge=>{ot[ge]===void 0&&(ot[ge]=0),++ot[ge]};bt.transferSize!==void 0&&bt.transferSize===0&&Qt(Xt),Qt(le)}}return ot}(function(tt,ot){const ct={};if(tt)for(const bt of tt){const zt=ot(bt);ct[zt]===void 0&&(ct[zt]=[]),ct[zt].push(bt)}return ct}(v,bn)),P=w.devicePixelRatio,O=w.navigator.connection||w.navigator.mozConnection||w.navigator.webkitConnection,V={counters:[],metadata:[],attributes:[]},$=(tt,ot,ct)=>{ct!=null&&tt.push({name:ot,value:ct.toString()})};for(const tt in T)$(V.counters,tt,T[tt]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&($(V.counters,"interactionRangeMin",m.interactionRange[0]),$(V.counters,"interactionRangeMax",m.interactionRange[1])),x)for(const tt of Object.keys(hn)){const ot=hn[tt],ct=x.find(bt=>bt.name===ot);ct&&$(V.counters,ot,ct.startTime)}return $(V.counters,"visibilityHidden",m.visibilityHidden),$(V.attributes,"style",function(tt){if(tt)for(const ot of tt){const ct=ot.name.split("?")[0];if(Ta(ct)){const bt=ct.split("/").slice(-2);if(bt.length===2)return`mapbox://styles/${bt[0]}/${bt[1]}`}}}(v)),$(V.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),$(V.attributes,"fogEnabled",m.fogEnabled?"true":"false"),$(V.attributes,"projection",m.projection),$(V.attributes,"zoom",m.zoom),$(V.metadata,"devicePixelRatio",P),$(V.metadata,"connectionEffectiveType",O?O.effectiveType:void 0),$(V.metadata,"navigatorUserAgent",w.navigator.userAgent),$(V.metadata,"screenWidth",w.screen.width),$(V.metadata,"screenHeight",w.screen.height),$(V.metadata,"windowWidth",w.innerWidth),$(V.metadata,"windowHeight",w.innerHeight),$(V.metadata,"mapWidth",m.width/P),$(V.metadata,"mapHeight",m.height/P),$(V.metadata,"webglRenderer",m.renderer),$(V.metadata,"webglVendor",m.vendor),$(V.metadata,"sdkVersion",M),$(V.metadata,"sdkIdentifier","mapbox-gl-js"),V}(a);for(const m of h.metadata);for(const m of h.counters);for(const m of h.attributes);this.postEvent(i,h,()=>{},s)}},Pe=Ht.postPerformanceEvent.bind(Ht),Se=new class extends Vt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(s,i,a,h){if(!E.API_URL||!E.SESSION_PATH)return;const m=ts(E.API_URL+E.SESSION_PATH);m.params.push(`sku=${i||""}`),m.params.push(`access_token=${h||E.ACCESS_TOKEN||""}`);const v={url:js(m),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(x,T){return $i(be(x,{method:"GET"}),T)}(v,x=>{this.pendingRequest=null,a(x),this.saveEventData(),this.processRequests(h)})}getSessionAPI(s,i,a,h){this.skuToken=i,this.errorCb=h,E.SESSION_PATH&&E.API_URL&&(a||E.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(_s)))}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:a}=this.queue.shift();i&&this.success[i]||this.getSession(a,this.skuToken,h=>{h?this.errorCb(h):i&&(this.success[i]=!0)},s)}},xe=Se.getSessionAPI.bind(Se),Re=new Set,hn={create:"create",load:"load",fullLoad:"fullLoad"},Zn={mark(s){w.performance.mark(s)},measure(s,i,a){w.performance.measure(s,i,a)}};function bn(s){const i=s.name.split("?")[0];return io(i)&&i.includes("mapbox-gl.js")?"javascript":io(i)&&i.includes("mapbox-gl.css")?"css":function(a){return E.API_FONTS_REGEX.test(a)}(i)?"fontRange":Wa(i)?"sprite":Ta(i)?"style":function(a){return E.API_TILEJSON_REGEX.test(a)}(i)?"tilejson":"other"}const ci=w.performance;function hi(s){const i=s?s.url.toString():void 0;return ci.getEntriesByName(i)}let Qn,pi,qi,ur;const ti={now:()=>qi!==void 0?qi:w.performance.now(),setNow(s){qi=s},restoreNow(){qi=void 0},frame(s){const i=w.requestAnimationFrame(s);return{cancel:()=>w.cancelAnimationFrame(i)}},getImageData(s,i=0){const{width:a,height:h}=s;ur||(ur=w.document.createElement("canvas"));const m=ur.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(a>ur.width||h>ur.height)&&(ur.width=a,ur.height=h),m.clearRect(-i,-i,a+2*i,h+2*i),m.drawImage(s,0,0,a,h),m.getImageData(-i,-i,a+2*i,h+2*i)},resolveURL:s=>(Qn||(Qn=w.document.createElement("a")),Qn.href=s,Qn.href),get devicePixelRatio(){return w.devicePixelRatio},get prefersReducedMotion(){return!!w.matchMedia&&(pi==null&&(pi=w.matchMedia("(prefers-reduced-motion: reduce)")),pi.matches)}};function yr(s,i,a){a[s]&&a[s].indexOf(i)!==-1||(a[s]=a[s]||[],a[s].push(i))}function xr(s,i,a){if(a&&a[s]){const h=a[s].indexOf(i);h!==-1&&a[s].splice(h,1)}}class Js{constructor(i,a={}){be(this,a),this.type=i}}class Ss extends Js{constructor(i,a={}){super("error",be({error:i},a))}}class vs{on(i,a){return this._listeners=this._listeners||{},yr(i,a,this._listeners),this}off(i,a){return xr(i,a,this._listeners),xr(i,a,this._oneTimeListeners),this}once(i,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},yr(i,a,this._oneTimeListeners),this):new Promise(h=>this.once(i,h))}fire(i,a){typeof i=="string"&&(i=new Js(i,a||{}));const h=i.type;if(this.listens(h)){i.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const T of m)T.call(this,i);const v=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const T of v)xr(h,T,this._oneTimeListeners),T.call(this,i);const x=this._eventedParent;x&&(be(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(i))}else i instanceof Ss&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,a){return this._eventedParent=i,this._eventedParentData=a,this}}var Ke=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Po(s,...i){for(const a of i)for(const h in a)s[h]=a[h];return s}function Xr(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function ro(s){if(Array.isArray(s))return s.map(ro);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const i={};for(const a in s)i[a]=ro(s[a]);return i}return Xr(s)}class hl extends Error{constructor(i,a){super(a),this.message=a,this.key=i}}var Io=hl;class cr{constructor(i,a=[]){this.parent=i,this.bindings={};for(const[h,m]of a)this.bindings[h]=m}concat(i){return new cr(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}var Kr=cr;const Co={kind:"null"},jn={kind:"number"},Ti={kind:"string"},Oi={kind:"boolean"},Si={kind:"color"},Tr={kind:"object"},vi={kind:"value"},Ma={kind:"collator"},oo={kind:"formatted"},Yo={kind:"resolvedImage"};function Nr(s,i){return{kind:"array",itemType:s,N:i}}function nr(s){if(s.kind==="array"){const i=nr(s.itemType);return typeof s.N=="number"?`array<${i}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${i}>`}return s.kind}const ir=[Co,jn,Ti,Oi,Si,oo,Tr,Nr(vi),Yo];function es(s,i){if(i.kind==="error")return null;if(s.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!es(s.itemType,i.itemType))&&(typeof s.N!="number"||s.N===i.N))return null}else{if(s.kind===i.kind)return null;if(s.kind==="value"){for(const a of ir)if(!es(a,i))return null}}return`Expected ${nr(s)} but found ${nr(i)} instead.`}function ns(s,i){return i.some(a=>a.kind===s.kind)}function is(s,i){return i.some(a=>a==="null"?s===null:a==="array"?Array.isArray(s):a==="object"?s&&!Array.isArray(s)&&typeof s=="object":a===typeof s)}var da,zo={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ks(s){return(s=Math.round(s))<0?0:s>255?255:s}function Us(s){return Ks(s[s.length-1]==="%"?parseFloat(s)/100*255:parseInt(s))}function La(s){return(i=s[s.length-1]==="%"?parseFloat(s)/100:parseFloat(s))<0?0:i>1?1:i;var i}function fl(s,i,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?s+(i-s)*a*6:2*a<1?i:3*a<2?s+(i-s)*(2/3-a)*6:s}try{da={}.parseCSSColor=function(s){var i,a=s.replace(/ /g,"").toLowerCase();if(a in zo)return zo[a].slice();if(a[0]==="#")return a.length===4?(i=parseInt(a.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:a.length===7&&(i=parseInt(a.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var h=a.indexOf("("),m=a.indexOf(")");if(h!==-1&&m+1===a.length){var v=a.substr(0,h),x=a.substr(h+1,m-(h+1)).split(","),T=1;switch(v){case"rgba":if(x.length!==4)return null;T=La(x.pop());case"rgb":return x.length!==3?null:[Us(x[0]),Us(x[1]),Us(x[2]),T];case"hsla":if(x.length!==4)return null;T=La(x.pop());case"hsl":if(x.length!==3)return null;var P=(parseFloat(x[0])%360+360)%360/360,O=La(x[1]),V=La(x[2]),$=V<=.5?V*(O+1):V+O-V*O,tt=2*V-$;return[Ks(255*fl(tt,$,P+1/3)),Ks(255*fl(tt,$,P)),Ks(255*fl(tt,$,P-1/3)),T];default:return null}}return null}}catch{}class Zo{constructor(i,a,h,m=1){this.r=i,this.g=a,this.b=h,this.a=m}static parse(i){if(!i)return;if(i instanceof Zo)return i;if(typeof i!="string")return;const a=da(i);return a?new Zo(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[i,a,h,m]=this.toArray();return`rgba(${Math.round(i)},${Math.round(a)},${Math.round(h)},${m})`}toArray(){const{r:i,g:a,b:h,a:m}=this;return m===0?[0,0,0,0]:[255*i/m,255*a/m,255*h/m,m]}toArray01(){const{r:i,g:a,b:h,a:m}=this;return m===0?[0,0,0,0]:[i/m,a/m,h/m,m]}toArray01PremultipliedAlpha(){const{r:i,g:a,b:h,a:m}=this;return[i,a,h,m]}}Zo.black=new Zo(0,0,0,1),Zo.white=new Zo(1,1,1,1),Zo.transparent=new Zo(0,0,0,0),Zo.red=new Zo(1,0,0,1),Zo.blue=new Zo(0,0,1,1);var Zr=Zo;class Qs{constructor(i,a,h){this.sensitivity=i?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,a){return this.collator.compare(i,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Hl{constructor(i,a,h,m,v){this.text=i.normalize?i.normalize():i,this.image=a,this.scale=h,this.fontStack=m,this.textColor=v}}class Vo{constructor(i){this.sections=i}static fromString(i){return new Vo([new Hl(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Vo?i:Vo.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const a of this.sections){if(a.image){i.push(["image",a.image.name]);continue}i.push(a.text);const h={};a.fontStack&&(h["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(h["font-scale"]=a.scale),a.textColor&&(h["text-color"]=["rgba"].concat(a.textColor.toArray())),i.push(h)}return i}}class wi{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new wi({name:i,available:!1}):null}serialize(){return["image",this.name]}}function ta(s,i,a,h){return typeof s=="number"&&s>=0&&s<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[s,i,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[s,i,a,h]:[s,i,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zr(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Zr||s instanceof Qs||s instanceof Vo||s instanceof wi)return!0;if(Array.isArray(s)){for(const i of s)if(!zr(i))return!1;return!0}if(typeof s=="object"){for(const i in s)if(!zr(s[i]))return!1;return!0}return!1}function Ao(s){if(s===null)return Co;if(typeof s=="string")return Ti;if(typeof s=="boolean")return Oi;if(typeof s=="number")return jn;if(s instanceof Zr)return Si;if(s instanceof Qs)return Ma;if(s instanceof Vo)return oo;if(s instanceof wi)return Yo;if(Array.isArray(s)){const i=s.length;let a;for(const h of s){const m=Ao(h);if(a){if(a===m)continue;a=vi;break}a=m}return Nr(a||vi,i)}return Tr}function ka(s){const i=typeof s;return s===null?"":i==="string"||i==="number"||i==="boolean"?String(s):s instanceof Zr||s instanceof Vo||s instanceof wi?s.toString():JSON.stringify(s)}class dl{constructor(i,a){this.type=i,this.value=a}static parse(i,a){if(i.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!zr(i[1]))return a.error("invalid value");const h=i[1];let m=Ao(h);const v=a.expectedType;return m.kind!=="array"||m.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(m=v),new dl(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Zr?["rgba"].concat(this.value.toArray()):this.value instanceof Vo?this.value.serialize():this.value}}var ea=dl,Or=class{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}};const na={string:Ti,number:jn,boolean:Oi,object:Tr};class Ya{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");let h,m=1;const v=i[0];if(v==="array"){let T,P;if(i.length>2){const O=i[1];if(typeof O!="string"||!(O in na)||O==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);T=na[O],m++}else T=vi;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return a.error('The length argument to "array" must be a positive integer literal',2);P=i[2],m++}h=Nr(T,P)}else h=na[v];const x=[];for(;m<i.length;m++){const T=a.parse(i[m],m,vi);if(!T)return null;x.push(T)}return new Ya(h,x)}evaluate(i){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(i);if(!es(this.type,Ao(h)))return h;if(a===this.args.length-1)throw new Or(`Expected value to be of type ${nr(this.type)}, but found ${nr(Ao(h))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,a=[i.kind];if(i.kind==="array"){const h=i.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){a.push(h.kind);const m=i.N;(typeof m=="number"||this.args.length>1)&&a.push(m)}}return a.concat(this.args.map(h=>h.serialize()))}}var Ei=Ya;class rr{constructor(i){this.type=oo,this.sections=i}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");const h=i[1];if(!Array.isArray(h)&&typeof h=="object")return a.error("First argument must be an image or text section.");const m=[];let v=!1;for(let x=1;x<=i.length-1;++x){const T=i[x];if(v&&typeof T=="object"&&!Array.isArray(T)){v=!1;let P=null;if(T["font-scale"]&&(P=a.parse(T["font-scale"],1,jn),!P))return null;let O=null;if(T["text-font"]&&(O=a.parse(T["text-font"],1,Nr(Ti)),!O))return null;let V=null;if(T["text-color"]&&(V=a.parse(T["text-color"],1,Si),!V))return null;const $=m[m.length-1];$.scale=P,$.font=O,$.textColor=V}else{const P=a.parse(i[x],1,vi);if(!P)return null;const O=P.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,m.push({content:P,scale:null,font:null,textColor:null})}}return new rr(m)}evaluate(i){return new Vo(this.sections.map(a=>{const h=a.content.evaluate(i);return Ao(h)===Yo?new Hl("",h,null,null,null):new Hl(ka(h),null,a.scale?a.scale.evaluate(i):null,a.font?a.font.evaluate(i).join(","):null,a.textColor?a.textColor.evaluate(i):null)}))}eachChild(i){for(const a of this.sections)i(a.content),a.scale&&i(a.scale),a.font&&i(a.font),a.textColor&&i(a.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const a of this.sections){i.push(a.content.serialize());const h={};a.scale&&(h["font-scale"]=a.scale.serialize()),a.font&&(h["text-font"]=a.font.serialize()),a.textColor&&(h["text-color"]=a.textColor.serialize()),i.push(h)}return i}}class pl{constructor(i){this.type=Yo,this.input=i}static parse(i,a){if(i.length!==2)return a.error("Expected two arguments.");const h=a.parse(i[1],1,Ti);return h?new pl(h):a.error("No image name provided.")}evaluate(i){const a=this.input.evaluate(i),h=wi.fromString(a);return h&&i.availableImages&&(h.available=i.availableImages.indexOf(a)>-1),h}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const pc={"to-boolean":Oi,"to-color":Si,"to-number":jn,"to-string":Ti};class $l{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");const h=i[0];if((h==="to-boolean"||h==="to-string")&&i.length!==2)return a.error("Expected one argument.");const m=pc[h],v=[];for(let x=1;x<i.length;x++){const T=a.parse(i[x],x,vi);if(!T)return null;v.push(T)}return new $l(m,v)}evaluate(i){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(i));if(this.type.kind==="color"){let a,h;for(const m of this.args){if(a=m.evaluate(i),h=null,a instanceof Zr)return a;if(typeof a=="string"){const v=i.parseColor(a);if(v)return v}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:ta(a[0],a[1],a[2],a[3]),!h))return new Zr(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Or(h||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const h of this.args){if(a=h.evaluate(i),a===null)return 0;const m=Number(a);if(!isNaN(m))return m}throw new Or(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?Vo.fromString(ka(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?wi.fromString(ka(this.args[0].evaluate(i))):ka(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new rr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new pl(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(a=>{i.push(a.serialize())}),i}}var Es=$l;const Pa=["Unknown","Point","LineString","Polygon"];var vt=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Pa[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:a,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*i-s[0])+this.featureDistanceData.bearing[1]*(h*i-s[1])}return 0}parseColor(s){let i=this._parseColorCache[s];return i||(i=this._parseColorCache[s]=Zr.parse(s)),i}};class Lt{constructor(i,a,h,m){this.name=i,this.type=a,this._evaluate=h,this.args=m}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,a){const h=i[0],m=Lt.definitions[h];if(!m)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=x.filter(([O])=>!Array.isArray(O)||O.length===i.length-1);let P=null;for(const[O,V]of T){P=new wr(a.registry,a.path,null,a.scope);const $=[];let tt=!1;for(let ot=1;ot<i.length;ot++){const ct=i[ot],bt=Array.isArray(O)?O[ot-1]:O.type,zt=P.parse(ct,1+$.length,bt);if(!zt){tt=!0;break}$.push(zt)}if(!tt)if(Array.isArray(O)&&O.length!==$.length)P.error(`Expected ${O.length} arguments, but found ${$.length} instead.`);else{for(let ot=0;ot<$.length;ot++){const ct=Array.isArray(O)?O[ot]:O.type,bt=$[ot];P.concat(ot+1).checkSubtype(ct,bt.type)}if(P.errors.length===0)return new Lt(h,v,V,$)}}if(T.length===1)a.errors.push(...P.errors);else{const O=(T.length?T:x).map(([$])=>{return tt=$,Array.isArray(tt)?`(${tt.map(nr).join(", ")})`:`(${nr(tt.type)}...)`;var tt}).join(" | "),V=[];for(let $=1;$<i.length;$++){const tt=a.parse(i[$],1+V.length);if(!tt)return null;V.push(nr(tt.type))}a.error(`Expected arguments of type ${O}, but found (${V.join(", ")}) instead.`)}return null}static register(i,a){Lt.definitions=a;for(const h in a)i[h]=Lt}}var $t=Lt;class oe{constructor(i,a,h){this.type=Ma,this.locale=h,this.caseSensitive=i,this.diacriticSensitive=a}static parse(i,a){if(i.length!==2)return a.error("Expected one argument.");const h=i[1];if(typeof h!="object"||Array.isArray(h))return a.error("Collator options argument must be an object.");const m=a.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Oi);if(!m)return null;const v=a.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Oi);if(!v)return null;let x=null;return h.locale&&(x=a.parse(h.locale,1,Ti),!x)?null:new oe(m,v,x)}evaluate(i){return new Qs(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const C=8192;function z(s,i){s[0]=Math.min(s[0],i[0]),s[1]=Math.min(s[1],i[1]),s[2]=Math.max(s[2],i[0]),s[3]=Math.max(s[3],i[1])}function U(s,i){return!(s[0]<=i[0]||s[2]>=i[2]||s[1]<=i[1]||s[3]>=i[3])}function X(s,i){const a=(180+s[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,m=Math.pow(2,i.z);return[Math.round(a*m*C),Math.round(h*m*C)]}function ft(s,i,a){const h=s[0]-i[0],m=s[1]-i[1],v=s[0]-a[0],x=s[1]-a[1];return h*x-v*m==0&&h*v<=0&&m*x<=0}function mt(s,i){let a=!1;for(let x=0,T=i.length;x<T;x++){const P=i[x];for(let O=0,V=P.length;O<V-1;O++){if(ft(s,P[O],P[O+1]))return!1;(m=P[O])[1]>(h=s)[1]!=(v=P[O+1])[1]>h[1]&&h[0]<(v[0]-m[0])*(h[1]-m[1])/(v[1]-m[1])+m[0]&&(a=!a)}}var h,m,v;return a}function Tt(s,i){for(let a=0;a<i.length;a++)if(mt(s,i[a]))return!0;return!1}function ce(s,i,a,h){const m=h[0]-a[0],v=h[1]-a[1],x=(s[0]-a[0])*v-m*(s[1]-a[1]),T=(i[0]-a[0])*v-m*(i[1]-a[1]);return x>0&&T<0||x<0&&T>0}function ee(s,i,a){for(const O of a)for(let V=0;V<O.length-1;++V)if((T=[(x=O[V+1])[0]-(v=O[V])[0],x[1]-v[1]])[0]*(P=[(m=i)[0]-(h=s)[0],m[1]-h[1]])[1]-T[1]*P[0]!=0&&ce(h,m,v,x)&&ce(v,x,h,m))return!0;var h,m,v,x,T,P;return!1}function Oe(s,i){for(let a=0;a<s.length;++a)if(!mt(s[a],i))return!1;for(let a=0;a<s.length-1;++a)if(ee(s[a],s[a+1],i))return!1;return!0}function Qe(s,i){for(let a=0;a<i.length;a++)if(Oe(s,i[a]))return!0;return!1}function pn(s,i,a){const h=[];for(let m=0;m<s.length;m++){const v=[];for(let x=0;x<s[m].length;x++){const T=X(s[m][x],a);z(i,T),v.push(T)}h.push(v)}return h}function qe(s,i,a){const h=[];for(let m=0;m<s.length;m++){const v=pn(s[m],i,a);h.push(v)}return h}function an(s,i,a,h){if(s[0]<a[0]||s[0]>a[2]){const m=.5*h;let v=s[0]-a[0]>m?-h:a[0]-s[0]>m?h:0;v===0&&(v=s[0]-a[2]>m?-h:a[2]-s[0]>m?h:0),s[0]+=v}z(i,s)}function Fn(s,i,a,h){const m=Math.pow(2,h.z)*C,v=[h.x*C,h.y*C],x=[];if(!s)return x;for(const T of s)for(const P of T){const O=[P.x+v[0],P.y+v[1]];an(O,i,a,m),x.push(O)}return x}function Ui(s,i,a,h){const m=Math.pow(2,h.z)*C,v=[h.x*C,h.y*C],x=[];if(!s)return x;for(const P of s){const O=[];for(const V of P){const $=[V.x+v[0],V.y+v[1]];z(i,$),O.push($)}x.push(O)}if(i[2]-i[0]<=m/2){(T=i)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const P of x)for(const O of P)an(O,i,a,m)}var T;return x}class ei{constructor(i,a){this.type=Oi,this.geojson=i,this.geometries=a}static parse(i,a){if(i.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(zr(i[1])){const h=i[1];if(h.type==="FeatureCollection")for(let m=0;m<h.features.length;++m){const v=h.features[m].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new ei(h,h.features[m].geometry)}else if(h.type==="Feature"){const m=h.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new ei(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new ei(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(a,h){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=a.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const T=pn(h.coordinates,v,x),P=Fn(a.geometry(),m,v,x);if(!U(m,v))return!1;for(const O of P)if(!mt(O,T))return!1}if(h.type==="MultiPolygon"){const T=qe(h.coordinates,v,x),P=Fn(a.geometry(),m,v,x);if(!U(m,v))return!1;for(const O of P)if(!Tt(O,T))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(a,h){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=a.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const T=pn(h.coordinates,v,x),P=Ui(a.geometry(),m,v,x);if(!U(m,v))return!1;for(const O of P)if(!Oe(O,T))return!1}if(h.type==="MultiPolygon"){const T=qe(h.coordinates,v,x),P=Ui(a.geometry(),m,v,x);if(!U(m,v))return!1;for(const O of P)if(!Qe(O,T))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var To=ei;function Qr(s){if(s instanceof $t&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof To)return!1;let i=!0;return s.eachChild(a=>{i&&!Qr(a)&&(i=!1)}),i}function tr(s){if(s instanceof $t&&s.name==="feature-state")return!1;let i=!0;return s.eachChild(a=>{i&&!tr(a)&&(i=!1)}),i}function sr(s,i){if(s instanceof $t&&i.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild(h=>{a&&!sr(h,i)&&(a=!1)}),a}class Di{constructor(i,a){this.type=a.type,this.name=i,this.boundExpression=a}static parse(i,a){if(i.length!==2||typeof i[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const h=i[1];return a.scope.has(h)?new Di(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var ls=Di;class er{constructor(i,a=[],h,m=new Kr,v=[]){this.registry=i,this.path=a,this.key=a.map(x=>`[${x}]`).join(""),this.scope=m,this.errors=v,this.expectedType=h}parse(i,a,h,m,v={}){return a?this.concat(a,h,m)._parse(i,v):this._parse(i,v)}_parse(i,a){function h(m,v,x){return x==="assert"?new Ei(v,[m]):x==="coerce"?new Es(v,[m]):m}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=i[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[m];if(v){let x=v.parse(i,this);if(!x)return null;if(this.expectedType){const T=this.expectedType,P=x.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||P.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(T,P))return null}else x=h(x,T,a.typeAnnotation||"coerce");else x=h(x,T,a.typeAnnotation||"assert")}if(!(x instanceof ea)&&x.type.kind!=="resolvedImage"&&Xa(x)){const T=new vt;try{x=new ea(x.type,x.evaluate(T))}catch(P){return this.error(P.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,a,h){const m=typeof i=="number"?this.path.concat(i):this.path,v=h?this.scope.concat(h):this.scope;return new er(this.registry,m,a||null,v,this.errors)}error(i,...a){const h=`${this.key}${a.map(m=>`[${m}]`).join("")}`;this.errors.push(new Io(h,i))}checkSubtype(i,a){const h=es(i,a);return h&&this.error(h),h}}var wr=er;function Xa(s){if(s instanceof ls)return Xa(s.boundExpression);if(s instanceof $t&&s.name==="error"||s instanceof oe||s instanceof To)return!1;const i=s instanceof Es||s instanceof Ei;let a=!0;return s.eachChild(h=>{a=i?a&&Xa(h):a&&h instanceof ea}),!!a&&Qr(s)&&sr(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function za(s,i){const a=s.length-1;let h,m,v=0,x=a,T=0;for(;v<=x;)if(T=Math.floor((v+x)/2),h=s[T],m=s[T+1],h<=i){if(T===a||i<m)return T;v=T+1}else{if(!(h>i))throw new Or("Input is not a number.");x=T-1}return 0}class Vr{constructor(i,a,h){this.type=i,this.input=a,this.labels=[],this.outputs=[];for(const[m,v]of h)this.labels.push(m),this.outputs.push(v)}static parse(i,a){if(i.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(i[1],1,jn);if(!h)return null;const m=[];let v=null;a.expectedType&&a.expectedType.kind!=="value"&&(v=a.expectedType);for(let x=1;x<i.length;x+=2){const T=x===1?-1/0:i[x],P=i[x+1],O=x,V=x+1;if(typeof T!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(m.length&&m[m.length-1][0]>=T)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const $=a.parse(P,V,v);if(!$)return null;v=v||$.type,m.push([T,$])}return new Vr(v,h,m)}evaluate(i){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(i);const m=this.input.evaluate(i);if(m<=a[0])return h[0].evaluate(i);const v=a.length;return m>=a[v-1]?h[v-1].evaluate(i):h[za(a,m)].evaluate(i)}eachChild(i){i(this.input);for(const a of this.outputs)i(a)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&i.push(this.labels[a]),i.push(this.outputs[a].serialize());return i}}var Gs=Vr;function Ri(s,i,a){return s*(1-a)+i*a}var us=Object.freeze({__proto__:null,number:Ri,color:function(s,i,a){return new Zr(Ri(s.r,i.r,a),Ri(s.g,i.g,a),Ri(s.b,i.b,a),Ri(s.a,i.a,a))},array:function(s,i,a){return s.map((h,m)=>Ri(h,i[m],a))}});const pa=.95047,Ms=1.08883,ma=4/29,ml=6/29,Da=3*ml*ml,mc=Math.PI/180,Mr=180/Math.PI;function ia(s){return s>.008856451679035631?Math.pow(s,1/3):s/Da+ma}function Zu(s){return s>ml?s*s*s:Da*(s-ma)}function ys(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Wo(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function ql(s){const i=Wo(s.r),a=Wo(s.g),h=Wo(s.b),m=ia((.4124564*i+.3575761*a+.1804375*h)/pa),v=ia((.2126729*i+.7151522*a+.072175*h)/1);return{l:116*v-16,a:500*(m-v),b:200*(v-ia((.0193339*i+.119192*a+.9503041*h)/Ms)),alpha:s.a}}function Zs(s){let i=(s.l+16)/116,a=isNaN(s.a)?i:i+s.a/500,h=isNaN(s.b)?i:i-s.b/200;return i=1*Zu(i),a=pa*Zu(a),h=Ms*Zu(h),new Zr(ys(3.2404542*a-1.5371385*i-.4985314*h),ys(-.969266*a+1.8760108*i+.041556*h),ys(.0556434*a-.2040259*i+1.0572252*h),s.alpha)}function Fc(s,i,a){const h=i-s;return s+a*(h>180||h<-180?h-360*Math.round(h/360):h)}const Na={forward:ql,reverse:Zs,interpolate:function(s,i,a){return{l:Ri(s.l,i.l,a),a:Ri(s.a,i.a,a),b:Ri(s.b,i.b,a),alpha:Ri(s.alpha,i.alpha,a)}}},xu={forward:function(s){const{l:i,a,b:h}=ql(s),m=Math.atan2(h,a)*Mr;return{h:m<0?m+360:m,c:Math.sqrt(a*a+h*h),l:i,alpha:s.a}},reverse:function(s){const i=s.h*mc,a=s.c;return Zs({l:s.l,a:Math.cos(i)*a,b:Math.sin(i)*a,alpha:s.alpha})},interpolate:function(s,i,a){return{h:Fc(s.h,i.h,a),c:Ri(s.c,i.c,a),l:Ri(s.l,i.l,a),alpha:Ri(s.alpha,i.alpha,a)}}};var wu=Object.freeze({__proto__:null,lab:Na,hcl:xu});class Sl{constructor(i,a,h,m,v){this.type=i,this.operator=a,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[x,T]of v)this.labels.push(x),this.outputs.push(T)}static interpolationFactor(i,a,h,m){let v=0;if(i.name==="exponential")v=bu(a,i.base,h,m);else if(i.name==="linear")v=bu(a,1,h,m);else if(i.name==="cubic-bezier"){const x=i.controlPoints;v=new lt(x[0],x[1],x[2],x[3]).solve(bu(a,1,h,m))}return v}static parse(i,a){let[h,m,v,...x]=i;if(!Array.isArray(m)||m.length===0)return a.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const O=m[1];if(typeof O!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:O}}else{if(m[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const O=m.slice(1);if(O.length!==4||O.some(V=>typeof V!="number"||V<0||V>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:O}}}if(i.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(v=a.parse(v,2,jn),!v)return null;const T=[];let P=null;h==="interpolate-hcl"||h==="interpolate-lab"?P=Si:a.expectedType&&a.expectedType.kind!=="value"&&(P=a.expectedType);for(let O=0;O<x.length;O+=2){const V=x[O],$=x[O+1],tt=O+3,ot=O+4;if(typeof V!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',tt);if(T.length&&T[T.length-1][0]>=V)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',tt);const ct=a.parse($,ot,P);if(!ct)return null;P=P||ct.type,T.push([V,ct])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new Sl(P,h,m,v,T):a.error(`Type ${nr(P)} is not interpolatable.`)}evaluate(i){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(i);const m=this.input.evaluate(i);if(m<=a[0])return h[0].evaluate(i);const v=a.length;if(m>=a[v-1])return h[v-1].evaluate(i);const x=za(a,m),T=Sl.interpolationFactor(this.interpolation,m,a[x],a[x+1]),P=h[x].evaluate(i),O=h[x+1].evaluate(i);return this.operator==="interpolate"?us[this.type.kind.toLowerCase()](P,O,T):this.operator==="interpolate-hcl"?xu.reverse(xu.interpolate(xu.forward(P),xu.forward(O),T)):Na.reverse(Na.interpolate(Na.forward(P),Na.forward(O),T))}eachChild(i){i(this.input);for(const a of this.outputs)i(a)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,i,this.input.serialize()];for(let h=0;h<this.labels.length;h++)a.push(this.labels[h],this.outputs[h].serialize());return a}}function bu(s,i,a,h){const m=h-a,v=s-a;return m===0?0:i===1?v/m:(Math.pow(i,v)-1)/(Math.pow(i,m)-1)}var Ha=Sl;class xs{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expectected at least one argument.");let h=null;const m=a.expectedType;m&&m.kind!=="value"&&(h=m);const v=[];for(const T of i.slice(1)){const P=a.parse(T,1+v.length,h,void 0,{typeAnnotation:"omit"});if(!P)return null;h=h||P.type,v.push(P)}const x=m&&v.some(T=>es(m,T.type));return new xs(x?vi:h,v)}evaluate(i){let a,h=null,m=0;for(const v of this.args){if(m++,h=v.evaluate(i),h&&h instanceof wi&&!h.available&&(a||(a=h),h=null,m===this.args.length))return a;if(h!==null)break}return h}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(a=>{i.push(a.serialize())}),i}}var $a=xs;class gc{constructor(i,a){this.type=a.type,this.bindings=[].concat(i),this.result=a}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const a of this.bindings)i(a[1]);i(this.result)}static parse(i,a){if(i.length<4)return a.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const h=[];for(let v=1;v<i.length-1;v+=2){const x=i[v];if(typeof x!="string")return a.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return a.error("Variable names must contain only alphanumeric characters or '_'.",v);const T=a.parse(i[v+1],v+1);if(!T)return null;h.push([x,T])}const m=a.parse(i[i.length-1],i.length-1,a.expectedType,h);return m?new gc(h,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[a,h]of this.bindings)i.push(a,h.serialize());return i.push(this.result.serialize()),i}}var El=gc;class ga{constructor(i,a,h){this.type=i,this.index=a,this.input=h}static parse(i,a){if(i.length!==3)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,jn),m=a.parse(i[2],2,Nr(a.expectedType||vi));return h&&m?new ga(m.type.itemType,h,m):null}evaluate(i){const a=this.index.evaluate(i),h=this.input.evaluate(i);if(a<0)throw new Or(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new Or(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new Or(`Array index must be an integer, but found ${a} instead.`);return h[a]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ho=ga;class Ml{constructor(i,a){this.type=Oi,this.needle=i,this.haystack=a}static parse(i,a){if(i.length!==3)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,vi),m=a.parse(i[2],2,vi);return h&&m?ns(h.type,[Oi,Ti,jn,Co,vi])?new Ml(h,m):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${nr(h.type)} instead`):null}evaluate(i){const a=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(h==null)return!1;if(!is(a,["boolean","string","number","null"]))throw new Or(`Expected first argument to be of type boolean, string, number or null, but found ${nr(Ao(a))} instead.`);if(!is(h,["string","array"]))throw new Or(`Expected second argument to be of type array or string, but found ${nr(Ao(h))} instead.`);return h.indexOf(a)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Ll=Ml;class Vu{constructor(i,a,h){this.type=jn,this.needle=i,this.haystack=a,this.fromIndex=h}static parse(i,a){if(i.length<=2||i.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,vi),m=a.parse(i[2],2,vi);if(!h||!m)return null;if(!ns(h.type,[Oi,Ti,jn,Co,vi]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${nr(h.type)} instead`);if(i.length===4){const v=a.parse(i[3],3,jn);return v?new Vu(h,m,v):null}return new Vu(h,m)}evaluate(i){const a=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!is(a,["boolean","string","number","null"]))throw new Or(`Expected first argument to be of type boolean, string, number or null, but found ${nr(Ao(a))} instead.`);if(!is(h,["string","array"]))throw new Or(`Expected second argument to be of type array or string, but found ${nr(Ao(h))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(i);return h.indexOf(a,m)}return h.indexOf(a)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var gl=Vu;class dr{constructor(i,a,h,m,v,x){this.inputType=i,this.type=a,this.input=h,this.cases=m,this.outputs=v,this.otherwise=x}static parse(i,a){if(i.length<5)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return a.error("Expected an even number of arguments.");let h,m;a.expectedType&&a.expectedType.kind!=="value"&&(m=a.expectedType);const v={},x=[];for(let O=2;O<i.length-1;O+=2){let V=i[O];const $=i[O+1];Array.isArray(V)||(V=[V]);const tt=a.concat(O);if(V.length===0)return tt.error("Expected at least one branch label.");for(const ct of V){if(typeof ct!="number"&&typeof ct!="string")return tt.error("Branch labels must be numbers or strings.");if(typeof ct=="number"&&Math.abs(ct)>Number.MAX_SAFE_INTEGER)return tt.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ct=="number"&&Math.floor(ct)!==ct)return tt.error("Numeric branch labels must be integer values.");if(h){if(tt.checkSubtype(h,Ao(ct)))return null}else h=Ao(ct);if(v[String(ct)]!==void 0)return tt.error("Branch labels must be unique.");v[String(ct)]=x.length}const ot=a.parse($,O,m);if(!ot)return null;m=m||ot.type,x.push(ot)}const T=a.parse(i[1],1,vi);if(!T)return null;const P=a.parse(i[i.length-1],i.length-1,m);return P?T.type.kind!=="value"&&a.concat(1).checkSubtype(h,T.type)?null:new dr(h,m,T,v,x,P):null}evaluate(i){const a=this.input.evaluate(i);return(Ao(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),h=[],m={};for(const x of a){const T=m[this.cases[x]];T===void 0?(m[this.cases[x]]=h.length,h.push([this.cases[x],[x]])):h[T][1].push(x)}const v=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,T]of h)i.push(T.length===1?v(T[0]):T.map(v)),i.push(this.outputs[x].serialize());return i.push(this.otherwise.serialize()),i}}var Ls=dr;class Xo{constructor(i,a,h){this.type=i,this.branches=a,this.otherwise=h}static parse(i,a){if(i.length<4)return a.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const m=[];for(let x=1;x<i.length-1;x+=2){const T=a.parse(i[x],x,Oi);if(!T)return null;const P=a.parse(i[x+1],x+1,h);if(!P)return null;m.push([T,P]),h=h||P.type}const v=a.parse(i[i.length-1],i.length-1,h);return v?new Xo(h,m,v):null}evaluate(i){for(const[a,h]of this.branches)if(a.evaluate(i))return h.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[a,h]of this.branches)i(a),i(h);i(this.otherwise)}outputDefined(){return this.branches.every(([i,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(a=>{i.push(a.serialize())}),i}}var ws=Xo;class _l{constructor(i,a,h,m){this.type=i,this.input=a,this.beginIndex=h,this.endIndex=m}static parse(i,a){if(i.length<=2||i.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,vi),m=a.parse(i[2],2,jn);if(!h||!m)return null;if(!ns(h.type,[Nr(vi),Ti,vi]))return a.error(`Expected first argument to be of type array or string, but found ${nr(h.type)} instead`);if(i.length===4){const v=a.parse(i[3],3,jn);return v?new _l(h.type,h,m,v):null}return new _l(h.type,h,m)}evaluate(i){const a=this.input.evaluate(i),h=this.beginIndex.evaluate(i);if(!is(a,["string","array"]))throw new Or(`Expected first argument to be of type array or string, but found ${nr(Ao(a))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(i);return a.slice(h,m)}return a.slice(h)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Wu=_l;function Jl(s,i){return s==="=="||s==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function Yu(s,i,a,h){return h.compare(i,a)===0}function ks(s,i,a){const h=s!=="=="&&s!=="!=";return class uL{constructor(v,x,T){this.type=Oi,this.lhs=v,this.rhs=x,this.collator=T,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const T=v[0];let P=x.parse(v[1],1,vi);if(!P)return null;if(!Jl(T,P.type))return x.concat(1).error(`"${T}" comparisons are not supported for type '${nr(P.type)}'.`);let O=x.parse(v[2],2,vi);if(!O)return null;if(!Jl(T,O.type))return x.concat(2).error(`"${T}" comparisons are not supported for type '${nr(O.type)}'.`);if(P.type.kind!==O.type.kind&&P.type.kind!=="value"&&O.type.kind!=="value")return x.error(`Cannot compare types '${nr(P.type)}' and '${nr(O.type)}'.`);h&&(P.type.kind==="value"&&O.type.kind!=="value"?P=new Ei(O.type,[P]):P.type.kind!=="value"&&O.type.kind==="value"&&(O=new Ei(P.type,[O])));let V=null;if(v.length===4){if(P.type.kind!=="string"&&O.type.kind!=="string"&&P.type.kind!=="value"&&O.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(V=x.parse(v[3],3,Ma),!V)return null}return new uL(P,O,V)}evaluate(v){const x=this.lhs.evaluate(v),T=this.rhs.evaluate(v);if(h&&this.hasUntypedArgument){const P=Ao(x),O=Ao(T);if(P.kind!==O.kind||P.kind!=="string"&&P.kind!=="number")throw new Or(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${P.kind}, ${O.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const P=Ao(x),O=Ao(T);if(P.kind!=="string"||O.kind!=="string")return i(v,x,T)}return this.collator?a(v,x,T,this.collator.evaluate(v)):i(v,x,T)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[s];return this.eachChild(x=>{v.push(x.serialize())}),v}}}const ze=ks("==",function(s,i,a){return i===a},Yu),gn=ks("!=",function(s,i,a){return i!==a},function(s,i,a,h){return!Yu(0,i,a,h)}),on=ks("<",function(s,i,a){return i<a},function(s,i,a,h){return h.compare(i,a)<0}),ni=ks(">",function(s,i,a){return i>a},function(s,i,a,h){return h.compare(i,a)>0}),Bi=ks("<=",function(s,i,a){return i<=a},function(s,i,a,h){return h.compare(i,a)<=0}),Sr=ks(">=",function(s,i,a){return i>=a},function(s,i,a,h){return h.compare(i,a)>=0});class Do{constructor(i,a,h,m,v,x){this.type=Ti,this.number=i,this.locale=a,this.currency=h,this.unit=m,this.minFractionDigits=v,this.maxFractionDigits=x}static parse(i,a){if(i.length!==3)return a.error("Expected two arguments.");const h=a.parse(i[1],1,jn);if(!h)return null;const m=i[2];if(typeof m!="object"||Array.isArray(m))return a.error("NumberFormat options argument must be an object.");let v=null;if(m.locale&&(v=a.parse(m.locale,1,Ti),!v))return null;let x=null;if(m.currency&&(x=a.parse(m.currency,1,Ti),!x))return null;let T=null;if(m.unit&&(T=a.parse(m.unit,1,Ti),!T))return null;let P=null;if(m["min-fraction-digits"]&&(P=a.parse(m["min-fraction-digits"],1,jn),!P))return null;let O=null;return m["max-fraction-digits"]&&(O=a.parse(m["max-fraction-digits"],1,jn),!O)?null:new Do(h,v,x,T,P,O)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class Lr{constructor(i){this.type=jn,this.input=i}static parse(i,a){if(i.length!==2)return a.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=a.parse(i[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${nr(h.type)} instead.`):new Lr(h):null}evaluate(i){const a=this.input.evaluate(i);if(typeof a=="string"||Array.isArray(a))return a.length;throw new Or(`Expected value to be of type string or array, but found ${nr(Ao(a))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(a=>{i.push(a.serialize())}),i}}const Ps={"==":ze,"!=":gn,">":ni,"<":on,">=":Sr,"<=":Bi,array:Ei,at:ho,boolean:Ei,case:ws,coalesce:$a,collator:oe,format:rr,image:pl,in:Ll,"index-of":gl,interpolate:Ha,"interpolate-hcl":Ha,"interpolate-lab":Ha,length:Lr,let:El,literal:ea,match:Ls,number:Ei,"number-format":Do,object:Ei,slice:Wu,step:Gs,string:Ei,"to-boolean":Es,"to-color":Es,"to-number":Es,"to-string":Es,var:ls,within:To};function Kl(s,[i,a,h,m]){i=i.evaluate(s),a=a.evaluate(s),h=h.evaluate(s);const v=m?m.evaluate(s):1,x=ta(i,a,h,v);if(x)throw new Or(x);return new Zr(i/255*v,a/255*v,h/255*v,v)}function Vs(s,i){return s in i}function Nt(s,i){const a=i[s];return a===void 0?null:a}function ae(s){return{type:s}}$t.register(Ps,{error:[{kind:"error"},[Ti],(s,[i])=>{throw new Or(i.evaluate(s))}],typeof:[Ti,[vi],(s,[i])=>nr(Ao(i.evaluate(s)))],"to-rgba":[Nr(jn,4),[Si],(s,[i])=>i.evaluate(s).toArray()],rgb:[Si,[jn,jn,jn],Kl],rgba:[Si,[jn,jn,jn,jn],Kl],has:{type:Oi,overloads:[[[Ti],(s,[i])=>Vs(i.evaluate(s),s.properties())],[[Ti,Tr],(s,[i,a])=>Vs(i.evaluate(s),a.evaluate(s))]]},get:{type:vi,overloads:[[[Ti],(s,[i])=>Nt(i.evaluate(s),s.properties())],[[Ti,Tr],(s,[i,a])=>Nt(i.evaluate(s),a.evaluate(s))]]},"feature-state":[vi,[Ti],(s,[i])=>Nt(i.evaluate(s),s.featureState||{})],properties:[Tr,[],s=>s.properties()],"geometry-type":[Ti,[],s=>s.geometryType()],id:[vi,[],s=>s.id()],zoom:[jn,[],s=>s.globals.zoom],pitch:[jn,[],s=>s.globals.pitch||0],"distance-from-center":[jn,[],s=>s.distanceFromCenter()],"heatmap-density":[jn,[],s=>s.globals.heatmapDensity||0],"line-progress":[jn,[],s=>s.globals.lineProgress||0],"sky-radial-progress":[jn,[],s=>s.globals.skyRadialProgress||0],accumulated:[vi,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[jn,ae(jn),(s,i)=>{let a=0;for(const h of i)a+=h.evaluate(s);return a}],"*":[jn,ae(jn),(s,i)=>{let a=1;for(const h of i)a*=h.evaluate(s);return a}],"-":{type:jn,overloads:[[[jn,jn],(s,[i,a])=>i.evaluate(s)-a.evaluate(s)],[[jn],(s,[i])=>-i.evaluate(s)]]},"/":[jn,[jn,jn],(s,[i,a])=>i.evaluate(s)/a.evaluate(s)],"%":[jn,[jn,jn],(s,[i,a])=>i.evaluate(s)%a.evaluate(s)],ln2:[jn,[],()=>Math.LN2],pi:[jn,[],()=>Math.PI],e:[jn,[],()=>Math.E],"^":[jn,[jn,jn],(s,[i,a])=>Math.pow(i.evaluate(s),a.evaluate(s))],sqrt:[jn,[jn],(s,[i])=>Math.sqrt(i.evaluate(s))],log10:[jn,[jn],(s,[i])=>Math.log(i.evaluate(s))/Math.LN10],ln:[jn,[jn],(s,[i])=>Math.log(i.evaluate(s))],log2:[jn,[jn],(s,[i])=>Math.log(i.evaluate(s))/Math.LN2],sin:[jn,[jn],(s,[i])=>Math.sin(i.evaluate(s))],cos:[jn,[jn],(s,[i])=>Math.cos(i.evaluate(s))],tan:[jn,[jn],(s,[i])=>Math.tan(i.evaluate(s))],asin:[jn,[jn],(s,[i])=>Math.asin(i.evaluate(s))],acos:[jn,[jn],(s,[i])=>Math.acos(i.evaluate(s))],atan:[jn,[jn],(s,[i])=>Math.atan(i.evaluate(s))],min:[jn,ae(jn),(s,i)=>Math.min(...i.map(a=>a.evaluate(s)))],max:[jn,ae(jn),(s,i)=>Math.max(...i.map(a=>a.evaluate(s)))],abs:[jn,[jn],(s,[i])=>Math.abs(i.evaluate(s))],round:[jn,[jn],(s,[i])=>{const a=i.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[jn,[jn],(s,[i])=>Math.floor(i.evaluate(s))],ceil:[jn,[jn],(s,[i])=>Math.ceil(i.evaluate(s))],"filter-==":[Oi,[Ti,vi],(s,[i,a])=>s.properties()[i.value]===a.value],"filter-id-==":[Oi,[vi],(s,[i])=>s.id()===i.value],"filter-type-==":[Oi,[Ti],(s,[i])=>s.geometryType()===i.value],"filter-<":[Oi,[Ti,vi],(s,[i,a])=>{const h=s.properties()[i.value],m=a.value;return typeof h==typeof m&&h<m}],"filter-id-<":[Oi,[vi],(s,[i])=>{const a=s.id(),h=i.value;return typeof a==typeof h&&a<h}],"filter->":[Oi,[Ti,vi],(s,[i,a])=>{const h=s.properties()[i.value],m=a.value;return typeof h==typeof m&&h>m}],"filter-id->":[Oi,[vi],(s,[i])=>{const a=s.id(),h=i.value;return typeof a==typeof h&&a>h}],"filter-<=":[Oi,[Ti,vi],(s,[i,a])=>{const h=s.properties()[i.value],m=a.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[Oi,[vi],(s,[i])=>{const a=s.id(),h=i.value;return typeof a==typeof h&&a<=h}],"filter->=":[Oi,[Ti,vi],(s,[i,a])=>{const h=s.properties()[i.value],m=a.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[Oi,[vi],(s,[i])=>{const a=s.id(),h=i.value;return typeof a==typeof h&&a>=h}],"filter-has":[Oi,[vi],(s,[i])=>i.value in s.properties()],"filter-has-id":[Oi,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Oi,[Nr(Ti)],(s,[i])=>i.value.indexOf(s.geometryType())>=0],"filter-id-in":[Oi,[Nr(vi)],(s,[i])=>i.value.indexOf(s.id())>=0],"filter-in-small":[Oi,[Ti,Nr(vi)],(s,[i,a])=>a.value.indexOf(s.properties()[i.value])>=0],"filter-in-large":[Oi,[Ti,Nr(vi)],(s,[i,a])=>function(h,m,v,x){for(;v<=x;){const T=v+x>>1;if(m[T]===h)return!0;m[T]>h?x=T-1:v=T+1}return!1}(s.properties()[i.value],a.value,0,a.value.length-1)],all:{type:Oi,overloads:[[[Oi,Oi],(s,[i,a])=>i.evaluate(s)&&a.evaluate(s)],[ae(Oi),(s,i)=>{for(const a of i)if(!a.evaluate(s))return!1;return!0}]]},any:{type:Oi,overloads:[[[Oi,Oi],(s,[i,a])=>i.evaluate(s)||a.evaluate(s)],[ae(Oi),(s,i)=>{for(const a of i)if(a.evaluate(s))return!0;return!1}]]},"!":[Oi,[Oi],(s,[i])=>!i.evaluate(s)],"is-supported-script":[Oi,[Ti],(s,[i])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(i.evaluate(s))}],upcase:[Ti,[Ti],(s,[i])=>i.evaluate(s).toUpperCase()],downcase:[Ti,[Ti],(s,[i])=>i.evaluate(s).toLowerCase()],concat:[Ti,ae(vi),(s,i)=>i.map(a=>ka(a.evaluate(s))).join("")],"resolved-locale":[Ti,[Ma],(s,[i])=>i.evaluate(s).resolvedLocale()]});var Ce=Ps;function vn(s){return{result:"success",value:s}}function ke(s){return{result:"error",value:s}}function rn(s){return s["property-type"]==="data-driven"}function Sn(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Yn(s){return!!s.expression&&s.expression.interpolated}function Mn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function bi(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function mi(s){return s}function Mi(s,i){const a=i.type==="color",h=s.stops&&typeof s.stops[0][0]=="object",m=h||!(h||s.property!==void 0),v=s.type||(Yn(i)?"exponential":"interval");if(a&&((s=Po({},s)).stops&&(s.stops=s.stops.map(O=>[O[0],Zr.parse(O[1])])),s.default=Zr.parse(s.default?s.default:i.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!wu[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let x,T,P;if(v==="exponential")x=fo;else if(v==="interval")x=Ii;else if(v==="categorical"){x=or,T=Object.create(null);for(const O of s.stops)T[O[0]]=O[1];P=typeof s.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);x=po}if(h){const O={},V=[];for(let ot=0;ot<s.stops.length;ot++){const ct=s.stops[ot],bt=ct[0].zoom;O[bt]===void 0&&(O[bt]={zoom:bt,type:s.type,property:s.property,default:s.default,stops:[]},V.push(bt)),O[bt].stops.push([ct[0].value,ct[1]])}const $=[];for(const ot of V)$.push([O[ot].zoom,Mi(O[ot],i)]);const tt={name:"linear"};return{kind:"composite",interpolationType:tt,interpolationFactor:Ha.interpolationFactor.bind(void 0,tt),zoomStops:$.map(ot=>ot[0]),evaluate:({zoom:ot},ct)=>fo({stops:$,base:s.base},i,ot).evaluate(ot,ct)}}if(m){const O=v==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:Ha.interpolationFactor.bind(void 0,O),zoomStops:s.stops.map(V=>V[0]),evaluate:({zoom:V})=>x(s,i,V,T,P)}}return{kind:"source",evaluate(O,V){const $=V&&V.properties?V.properties[s.property]:void 0;return $===void 0?Gi(s.default,i.default):x(s,i,$,T,P)}}}function Gi(s,i,a){return s!==void 0?s:i!==void 0?i:a!==void 0?a:void 0}function or(s,i,a,h,m){return Gi(typeof a===m?h[a]:void 0,s.default,i.default)}function Ii(s,i,a){if(Mn(a)!=="number")return Gi(s.default,i.default);const h=s.stops.length;if(h===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[h-1][0])return s.stops[h-1][1];const m=za(s.stops.map(v=>v[0]),a);return s.stops[m][1]}function fo(s,i,a){const h=s.base!==void 0?s.base:1;if(Mn(a)!=="number")return Gi(s.default,i.default);const m=s.stops.length;if(m===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[m-1][0])return s.stops[m-1][1];const v=za(s.stops.map(V=>V[0]),a),x=function(V,$,tt,ot){const ct=ot-tt,bt=V-tt;return ct===0?0:$===1?bt/ct:(Math.pow($,bt)-1)/(Math.pow($,ct)-1)}(a,h,s.stops[v][0],s.stops[v+1][0]),T=s.stops[v][1],P=s.stops[v+1][1];let O=us[i.type]||mi;if(s.colorSpace&&s.colorSpace!=="rgb"){const V=wu[s.colorSpace];O=($,tt)=>V.reverse(V.interpolate(V.forward($),V.forward(tt),x))}return typeof T.evaluate=="function"?{evaluate(...V){const $=T.evaluate.apply(void 0,V),tt=P.evaluate.apply(void 0,V);if($!==void 0&&tt!==void 0)return O($,tt,x)}}:O(T,P,x)}function po(s,i,a){return i.type==="color"?a=Zr.parse(a):i.type==="formatted"?a=Vo.fromString(a.toString()):i.type==="resolvedImage"?a=wi.fromString(a.toString()):Mn(a)===i.type||i.type==="enum"&&i.values[a]||(a=void 0),Gi(a,s.default,i.default)}class rs{constructor(i,a){this.expression=i,this._warningHistory={},this._evaluator=new vt,this._defaultValue=a?function(h){return h.type==="color"&&(bi(h.default)||Array.isArray(h.default))?new Zr(0,0,0,0):h.type==="color"?Zr.parse(h.default)||null:h.default===void 0?null:h.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(i,a,h,m,v,x,T,P){return this._evaluator.globals=i,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(i,a,h,m,v,x,T,P){this._evaluator.globals=i,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=P||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new Or(`Expected value to be one of ${Object.keys(this._enumValues).map(V=>JSON.stringify(V)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(O.message)),this._defaultValue}}}function Rr(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Ce}function zs(s,i){const a=new wr(Ce,[],i?function(m){const v={color:Si,string:Ti,number:jn,enum:Ti,boolean:Oi,formatted:oo,resolvedImage:Yo};return m.type==="array"?Nr(v[m.value]||vi,m.length):v[m.type]}(i):void 0),h=a.parse(s,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?vn(new rs(h,i)):ke(a.errors)}class Ws{constructor(i,a){this.kind=i,this._styleExpression=a,this.isStateDependent=i!=="constant"&&!tr(a.expression)}evaluateWithoutErrorHandling(i,a,h,m,v,x){return this._styleExpression.evaluateWithoutErrorHandling(i,a,h,m,v,x)}evaluate(i,a,h,m,v,x){return this._styleExpression.evaluate(i,a,h,m,v,x)}}class Bo{constructor(i,a,h,m){this.kind=i,this.zoomStops=h,this._styleExpression=a,this.isStateDependent=i!=="camera"&&!tr(a.expression),this.interpolationType=m}evaluateWithoutErrorHandling(i,a,h,m,v,x){return this._styleExpression.evaluateWithoutErrorHandling(i,a,h,m,v,x)}evaluate(i,a,h,m,v,x){return this._styleExpression.evaluate(i,a,h,m,v,x)}interpolationFactor(i,a,h){return this.interpolationType?Ha.interpolationFactor(this.interpolationType,i,a,h):0}}function kl(s,i){if((s=zs(s,i)).result==="error")return s;const a=s.value.expression,h=Qr(a);if(!h&&!rn(i))return ke([new Io("","data expressions not supported")]);const m=sr(a,["zoom","pitch","distance-from-center"]);if(!m&&!Sn(i))return ke([new Io("","zoom expressions not supported")]);const v=_c(a);return v||m?v instanceof Io?ke([v]):v instanceof Ha&&!Yn(i)?ke([new Io("",'"interpolate" expressions cannot be used with this property')]):vn(v?new Bo(h?"camera":"composite",s.value,v.labels,v instanceof Ha?v.interpolation:void 0):new Ws(h?"constant":"source",s.value)):ke([new Io("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Pl{constructor(i,a){this._parameters=i,this._specification=a,Po(this,Mi(this._parameters,this._specification))}static deserialize(i){return new Pl(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function _c(s){let i=null;if(s instanceof El)i=_c(s.result);else if(s instanceof $a){for(const a of s.args)if(i=_c(a),i)break}else(s instanceof Gs||s instanceof Ha)&&s.input instanceof $t&&s.input.name==="zoom"&&(i=s);return i instanceof Io||s.eachChild(a=>{const h=_c(a);h instanceof Io?i=h:!i&&h?i=new Io("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&h&&i!==h&&(i=new Io("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}class $n{constructor(i,a,h,m){this.message=(i?`${i}: `:"")+h,m&&(this.identifier=m),a!=null&&a.__line__&&(this.line=a.__line__)}}function Oa(s){const i=s.key,a=s.value,h=s.valueSpec||{},m=s.objectElementValidators||{},v=s.style,x=s.styleSpec;let T=[];const P=Mn(a);if(P!=="object")return[new $n(i,a,`object expected, ${P} found`)];for(const O in a){const V=O.split(".")[0],$=h[V]||h["*"];let tt;m[V]?tt=m[V]:h[V]?tt=Ni:m["*"]?tt=m["*"]:h["*"]&&(tt=Ni),tt?T=T.concat(tt({key:(i&&`${i}.`)+O,value:a[O],valueSpec:$,style:v,styleSpec:x,object:a,objectKey:O},a)):T.push(new $n(i,a[O],`unknown property "${O}"`))}for(const O in h)m[O]||h[O].required&&h[O].default===void 0&&a[O]===void 0&&T.push(new $n(i,a,`missing required property "${O}"`));return T}function Ql(s){const i=s.value,a=s.valueSpec,h=s.style,m=s.styleSpec,v=s.key,x=s.arrayElementValidator||Ni;if(Mn(i)!=="array")return[new $n(v,i,`array expected, ${Mn(i)} found`)];if(a.length&&i.length!==a.length)return[new $n(v,i,`array length ${a.length} expected, length ${i.length} found`)];if(a["min-length"]&&i.length<a["min-length"])return[new $n(v,i,`array length at least ${a["min-length"]} expected, length ${i.length} found`)];let T={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};m.$version<7&&(T.function=a.function),Mn(a.value)==="object"&&(T=a.value);let P=[];for(let O=0;O<i.length;O++)P=P.concat(x({array:i,arrayIndex:O,value:i[O],valueSpec:T,style:h,styleSpec:m,key:`${v}[${O}]`}));return P}function jc(s){const i=s.key,a=s.value,h=s.valueSpec;let m=Mn(a);if(m==="number"&&a!=a&&(m="NaN"),m!=="number")return[new $n(i,a,`number expected, ${m} found`)];if("minimum"in h){let v=h.minimum;if(Mn(h.minimum)==="array"&&(v=h.minimum[s.arrayIndex]),a<v)return[new $n(i,a,`${a} is less than the minimum value ${v}`)]}if("maximum"in h){let v=h.maximum;if(Mn(h.maximum)==="array"&&(v=h.maximum[s.arrayIndex]),a>v)return[new $n(i,a,`${a} is greater than the maximum value ${v}`)]}return[]}function d(s){const i=s.valueSpec,a=Xr(s.value.type);let h,m,v,x={};const T=a!=="categorical"&&s.value.property===void 0,P=!T,O=Mn(s.value.stops)==="array"&&Mn(s.value.stops[0])==="array"&&Mn(s.value.stops[0][0])==="object",V=Oa({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(ot){if(a==="identity")return[new $n(ot.key,ot.value,'identity function may not have a "stops" property')];let ct=[];const bt=ot.value;return ct=ct.concat(Ql({key:ot.key,value:bt,valueSpec:ot.valueSpec,style:ot.style,styleSpec:ot.styleSpec,arrayElementValidator:$})),Mn(bt)==="array"&&bt.length===0&&ct.push(new $n(ot.key,bt,"array must have at least one stop")),ct},default:function(ot){return Ni({key:ot.key,value:ot.value,valueSpec:i,style:ot.style,styleSpec:ot.styleSpec})}}});return a==="identity"&&T&&V.push(new $n(s.key,s.value,'missing required property "property"')),a==="identity"||s.value.stops||V.push(new $n(s.key,s.value,'missing required property "stops"')),a==="exponential"&&s.valueSpec.expression&&!Yn(s.valueSpec)&&V.push(new $n(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(P&&!rn(s.valueSpec)?V.push(new $n(s.key,s.value,"property functions not supported")):T&&!Sn(s.valueSpec)&&V.push(new $n(s.key,s.value,"zoom functions not supported"))),a!=="categorical"&&!O||s.value.property!==void 0||V.push(new $n(s.key,s.value,'"property" property is required')),V;function $(ot){let ct=[];const bt=ot.value,zt=ot.key;if(Mn(bt)!=="array")return[new $n(zt,bt,`array expected, ${Mn(bt)} found`)];if(bt.length!==2)return[new $n(zt,bt,`array length 2 expected, length ${bt.length} found`)];if(O){if(Mn(bt[0])!=="object")return[new $n(zt,bt,`object expected, ${Mn(bt[0])} found`)];if(bt[0].zoom===void 0)return[new $n(zt,bt,"object stop key must have zoom")];if(bt[0].value===void 0)return[new $n(zt,bt,"object stop key must have value")];const Jt=Xr(bt[0].zoom);if(typeof Jt!="number")return[new $n(zt,bt[0].zoom,"stop zoom values must be numbers")];if(v&&v>Jt)return[new $n(zt,bt[0].zoom,"stop zoom values must appear in ascending order")];Jt!==v&&(v=Jt,m=void 0,x={}),ct=ct.concat(Oa({key:`${zt}[0]`,value:bt[0],valueSpec:{zoom:{}},style:ot.style,styleSpec:ot.styleSpec,objectElementValidators:{zoom:jc,value:tt}}))}else ct=ct.concat(tt({key:`${zt}[0]`,value:bt[0],valueSpec:{},style:ot.style,styleSpec:ot.styleSpec},bt));return Rr(ro(bt[1]))?ct.concat([new $n(`${zt}[1]`,bt[1],"expressions are not allowed in function stops.")]):ct.concat(Ni({key:`${zt}[1]`,value:bt[1],valueSpec:i,style:ot.style,styleSpec:ot.styleSpec}))}function tt(ot,ct){const bt=Mn(ot.value),zt=Xr(ot.value),Jt=ot.value!==null?ot.value:ct;if(h){if(bt!==h)return[new $n(ot.key,Jt,`${bt} stop domain type must match previous stop domain type ${h}`)]}else h=bt;if(bt!=="number"&&bt!=="string"&&bt!=="boolean"&&typeof zt!="number"&&typeof zt!="string"&&typeof zt!="boolean")return[new $n(ot.key,Jt,"stop domain value must be a number, string, or boolean")];if(bt!=="number"&&a!=="categorical"){let le=`number expected, ${bt} found`;return rn(i)&&a===void 0&&(le+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $n(ot.key,Jt,le)]}return a!=="categorical"||bt!=="number"||typeof zt=="number"&&isFinite(zt)&&Math.floor(zt)===zt?a!=="categorical"&&bt==="number"&&typeof zt=="number"&&typeof m=="number"&&m!==void 0&&zt<m?[new $n(ot.key,Jt,"stop domain values must appear in ascending order")]:(m=zt,a==="categorical"&&zt in x?[new $n(ot.key,Jt,"stop domain values must be unique")]:(x[zt]=!0,[])):[new $n(ot.key,Jt,`integer expected, found ${String(zt)}`)]}}function b(s){const i=(s.expressionContext==="property"?kl:zs)(ro(s.value),s.valueSpec);if(i.result==="error")return i.value.map(h=>new $n(`${s.key}${h.key}`,s.value,h.message));const a=i.value.expression||i.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!a.outputDefined())return[new $n(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!tr(a))return[new $n(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter")return D(a,s);if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!sr(a,["zoom","feature-state"]))return[new $n(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Qr(a))return[new $n(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function D(s,i){const a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const m of i.valueSpec.expression.parameters)a.delete(m);if(a.size===0)return[];const h=[];return s instanceof $t&&a.has(s.name)?[new $n(i.key,i.value,`["${s.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(s.eachChild(m=>{h.push(...D(m,i))}),h)}function H(s){const i=s.key,a=s.value,h=s.valueSpec,m=[];return Array.isArray(h.values)?h.values.indexOf(Xr(a))===-1&&m.push(new $n(i,a,`expected one of [${h.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(h.values).indexOf(Xr(a))===-1&&m.push(new $n(i,a,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(a)} found`)),m}function ut(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const i of s.slice(1))if(!ut(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function St(s,i="fill"){if(s==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ut(s)||(s=Qi(s));const a=s;let h=!0;try{h=function(O){if(!sn(O))return O;let V=ro(O);return Ve(V),V=ne(V),V}(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(a,null,2)}
        `)}const m=Ke[`filter_${i}`],v=zs(h,m);let x=null;if(v.result==="error")throw new Error(v.value.map(O=>`${O.key}: ${O.message}`).join(", "));x=(O,V,$)=>v.value.evaluate(O,V,{},$);let T=null,P=null;if(h!==a){const O=zs(a,m);if(O.result==="error")throw new Error(O.value.map(V=>`${V.key}: ${V.message}`).join(", "));T=(V,$,tt,ot,ct)=>O.value.evaluate(V,$,{},tt,void 0,void 0,ot,ct),P=!Qr(O.value.expression)}return{filter:x,dynamicFilter:T||void 0,needGeometry:Zi(h),needFeature:!!P}}function ne(s){if(!Array.isArray(s))return s;const i=function(a){if(On.has(a[0])){for(let h=1;h<a.length;h++)if(sn(a[h]))return!0}return a}(s);return i===!0?i:i.map(a=>ne(a))}function Ve(s){let i=!1;const a=[];if(s[0]==="case"){for(let h=1;h<s.length-1;h+=2)i=i||sn(s[h]),a.push(s[h+1]);a.push(s[s.length-1])}else if(s[0]==="match"){i=i||sn(s[1]);for(let h=2;h<s.length-1;h+=2)a.push(s[h+1]);a.push(s[s.length-1])}else if(s[0]==="step"){i=i||sn(s[1]);for(let h=1;h<s.length-1;h+=2)a.push(s[h+1])}i&&(s.length=0,s.push("any",...a));for(let h=1;h<s.length;h++)Ve(s[h])}function sn(s){if(!Array.isArray(s))return!1;if((i=s[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let a=1;a<s.length;a++)if(sn(s[a]))return!0;return!1}const On=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ii(s,i){return s<i?-1:s>i?1:0}function Zi(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(let i=1;i<s.length;i++)if(Zi(s[i]))return!0;return!1}function Qi(s){if(!s)return!0;const i=s[0];return s.length<=1?i!=="any":i==="=="?Ys(s[1],s[2],"=="):i==="!="?oa(Ys(s[1],s[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Ys(s[1],s[2],i):i==="any"?(a=s.slice(1),["any"].concat(a.map(Qi))):i==="all"?["all"].concat(s.slice(1).map(Qi)):i==="none"?["all"].concat(s.slice(1).map(Qi).map(oa)):i==="in"?ra(s[1],s.slice(2)):i==="!in"?oa(ra(s[1],s.slice(2))):i==="has"?tu(s[1]):i==="!has"?oa(tu(s[1])):i!=="within"||s;var a}function Ys(s,i,a){switch(s){case"$type":return[`filter-type-${a}`,i];case"$id":return[`filter-id-${a}`,i];default:return[`filter-${a}`,s,i]}}function ra(s,i){if(i.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(a=>typeof a!=typeof i[0])?["filter-in-large",s,["literal",i.sort(ii)]]:["filter-in-small",s,["literal",i]]}}function tu(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function oa(s){return["!",s]}function zl(s){return ut(ro(s.value))?b(Po({},s,{expressionContext:"filter",valueSpec:s.styleSpec[`filter_${s.layerType||"fill"}`]})):Xu(s)}function Xu(s){const i=s.value,a=s.key;if(Mn(i)!=="array")return[new $n(a,i,`array expected, ${Mn(i)} found`)];const h=s.styleSpec;let m,v=[];if(i.length<1)return[new $n(a,i,"filter array must have at least 1 element")];switch(v=v.concat(H({key:`${a}[0]`,value:i[0],valueSpec:h.filter_operator,style:s.style,styleSpec:s.styleSpec})),Xr(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&Xr(i[1])==="$type"&&v.push(new $n(a,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&v.push(new $n(a,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(m=Mn(i[1]),m!=="string"&&v.push(new $n(`${a}[1]`,i[1],`string expected, ${m} found`)));for(let x=2;x<i.length;x++)m=Mn(i[x]),Xr(i[1])==="$type"?v=v.concat(H({key:`${a}[${x}]`,value:i[x],valueSpec:h.geometry_type,style:s.style,styleSpec:s.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&v.push(new $n(`${a}[${x}]`,i[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<i.length;x++)v=v.concat(Xu({key:`${a}[${x}]`,value:i[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":m=Mn(i[1]),i.length!==2?v.push(new $n(a,i,`filter array for "${i[0]}" operator must have 2 elements`)):m!=="string"&&v.push(new $n(`${a}[1]`,i[1],`string expected, ${m} found`));break;case"within":m=Mn(i[1]),i.length!==2?v.push(new $n(a,i,`filter array for "${i[0]}" operator must have 2 elements`)):m!=="object"&&v.push(new $n(`${a}[1]`,i[1],`object expected, ${m} found`))}return v}function Bh(s,i){const a=s.key,h=s.style,m=s.styleSpec,v=s.value,x=s.objectKey,T=m[`${i}_${s.layerType}`];if(!T)return[];const P=x.match(/^(.*)-transition$/);if(i==="paint"&&P&&T[P[1]]&&T[P[1]].transition)return Ni({key:a,value:v,valueSpec:m.transition,style:h,styleSpec:m});const O=s.valueSpec||T[x];if(!O)return[new $n(a,v,`unknown property "${x}"`)];let V;if(Mn(v)==="string"&&rn(O)&&!O.tokens&&(V=/^{([^}]+)}$/.exec(v)))return[new $n(a,v,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const $=[];return s.layerType==="symbol"&&(x==="text-field"&&h&&!h.glyphs&&$.push(new $n(a,v,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&bi(ro(v))&&Xr(v.type)==="identity"&&$.push(new $n(a,v,'"text-font" does not support identity functions'))),$.concat(Ni({key:s.key,value:v,valueSpec:O,style:h,styleSpec:m,expressionContext:"property",propertyType:i,propertyKey:x}))}function Fh(s){return Bh(s,"paint")}function jh(s){return Bh(s,"layout")}function fh(s){let i=[];const a=s.value,h=s.key,m=s.style,v=s.styleSpec;a.type||a.ref||i.push(new $n(h,a,'either "type" or "ref" is required'));let x=Xr(a.type);const T=Xr(a.ref);if(a.id){const P=Xr(a.id);for(let O=0;O<s.arrayIndex;O++){const V=m.layers[O];Xr(V.id)===P&&i.push(new $n(h,a.id,`duplicate layer id "${a.id}", previously used at line ${V.id.__line__}`))}}if("ref"in a){let P;["type","source","source-layer","filter","layout"].forEach(O=>{O in a&&i.push(new $n(h,a[O],`"${O}" is prohibited for ref layers`))}),m.layers.forEach(O=>{Xr(O.id)===T&&(P=O)}),P?P.ref?i.push(new $n(h,a.ref,"ref cannot reference another ref layer")):x=Xr(P.type):typeof T=="string"&&i.push(new $n(h,a.ref,`ref layer "${T}" not found`))}else if(x!=="background"&&x!=="sky")if(a.source){const P=m.sources&&m.sources[a.source],O=P&&Xr(P.type);P?O==="vector"&&x==="raster"?i.push(new $n(h,a.source,`layer "${a.id}" requires a raster source`)):O==="raster"&&x!=="raster"?i.push(new $n(h,a.source,`layer "${a.id}" requires a vector source`)):O!=="vector"||a["source-layer"]?O==="raster-dem"&&x!=="hillshade"?i.push(new $n(h,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||O==="geojson"&&P.lineMetrics||i.push(new $n(h,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new $n(h,a,`layer "${a.id}" must specify a "source-layer"`)):i.push(new $n(h,a.source,`source "${a.source}" not found`))}else i.push(new $n(h,a,'missing required property "source"'));return i=i.concat(Oa({key:h,value:a,valueSpec:v.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ni({key:`${h}.type`,value:a.type,valueSpec:v.layer.type,style:s.style,styleSpec:s.styleSpec,object:a,objectKey:"type"}),filter:P=>zl(Po({layerType:x},P)),layout:P=>Oa({layer:a,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":O=>jh(Po({layerType:x},O))}}),paint:P=>Oa({layer:a,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":O=>Fh(Po({layerType:x},O))}})}})),i}function Dl(s){const i=s.value,a=s.key,h=Mn(i);return h!=="string"?[new $n(a,i,`string expected, ${h} found`)]:[]}const Lo={promoteId:function({key:s,value:i}){if(Mn(i)==="string")return Dl({key:s,value:i});{const a=[];for(const h in i)a.push(...Dl({key:`${s}.${h}`,value:i[h]}));return a}}};function eu(s){const i=s.value,a=s.key,h=s.styleSpec,m=s.style;if(!i.type)return[new $n(a,i,'"type" is required')];const v=Xr(i.type);let x;switch(v){case"vector":case"raster":case"raster-dem":return x=Oa({key:a,value:i,valueSpec:h[`source_${v.replace("-","_")}`],style:s.style,styleSpec:h,objectElementValidators:Lo}),x;case"geojson":if(x=Oa({key:a,value:i,valueSpec:h.source_geojson,style:m,styleSpec:h,objectElementValidators:Lo}),i.cluster)for(const T in i.clusterProperties){const[P,O]=i.clusterProperties[T],V=typeof P=="string"?[P,["accumulated"],["get",T]]:P;x.push(...b({key:`${a}.${T}.map`,value:O,expressionContext:"cluster-map"})),x.push(...b({key:`${a}.${T}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return x;case"video":return Oa({key:a,value:i,valueSpec:h.source_video,style:m,styleSpec:h});case"image":return Oa({key:a,value:i,valueSpec:h.source_image,style:m,styleSpec:h});case"canvas":return[new $n(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return H({key:`${a}.type`,value:i.type,valueSpec:{values:Uh(h)},style:m,styleSpec:h})}}function Uh(s){return s.source.reduce((i,a)=>{const h=s[a];return h.type.type==="enum"&&(i=i.concat(Object.keys(h.type.values))),i},[])}function Dt(s){const i=s.value,a=s.styleSpec,h=a.light,m=s.style;let v=[];const x=Mn(i);if(i===void 0)return v;if(x!=="object")return v=v.concat([new $n("light",i,`object expected, ${x} found`)]),v;for(const T in i){const P=T.match(/^(.*)-transition$/);v=v.concat(P&&h[P[1]]&&h[P[1]].transition?Ni({key:T,value:i[T],valueSpec:a.transition,style:m,styleSpec:a}):h[T]?Ni({key:T,value:i[T],valueSpec:h[T],style:m,styleSpec:a}):[new $n(T,i[T],`unknown property "${T}"`)])}return v}function nu(s){const i=s.value,a=s.key,h=s.style,m=s.styleSpec,v=m.terrain;let x=[];const T=Mn(i);if(i===void 0)return x;if(T!=="object")return x=x.concat([new $n("terrain",i,`object expected, ${T} found`)]),x;for(const P in i){const O=P.match(/^(.*)-transition$/);x=x.concat(O&&v[O[1]]&&v[O[1]].transition?Ni({key:P,value:i[P],valueSpec:m.transition,style:h,styleSpec:m}):v[P]?Ni({key:P,value:i[P],valueSpec:v[P],style:h,styleSpec:m}):[new $n(P,i[P],`unknown property "${P}"`)])}if(i.source){const P=h.sources&&h.sources[i.source],O=P&&Xr(P.type);P?O!=="raster-dem"&&x.push(new $n(a,i.source,`terrain cannot be used with a source of type ${String(O)}, it only be used with a "raster-dem" source type`)):x.push(new $n(a,i.source,`source "${i.source}" not found`))}else x.push(new $n(a,i,'terrain is missing required property "source"'));return x}function Hu(s){const i=s.value,a=s.style,h=s.styleSpec,m=h.fog;let v=[];const x=Mn(i);if(i===void 0)return v;if(x!=="object")return v=v.concat([new $n("fog",i,`object expected, ${x} found`)]),v;for(const T in i){const P=T.match(/^(.*)-transition$/);v=v.concat(P&&m[P[1]]&&m[P[1]].transition?Ni({key:T,value:i[T],valueSpec:h.transition,style:a,styleSpec:h}):m[T]?Ni({key:T,value:i[T],valueSpec:m[T],style:a,styleSpec:h}):[new $n(T,i[T],`unknown property "${T}"`)])}return v}const _a={"*":()=>[],array:Ql,boolean:function(s){const i=s.value,a=s.key,h=Mn(i);return h!=="boolean"?[new $n(a,i,`boolean expected, ${h} found`)]:[]},number:jc,color:function(s){const i=s.key,a=s.value,h=Mn(a);return h!=="string"?[new $n(i,a,`color expected, ${h} found`)]:da(a)===null?[new $n(i,a,`color expected, "${a}" found`)]:[]},enum:H,filter:zl,function:d,layer:fh,object:Oa,source:eu,light:Dt,terrain:nu,fog:Hu,string:Dl,formatted:function(s){return Dl(s).length===0?[]:b(s)},resolvedImage:function(s){return Dl(s).length===0?[]:b(s)},projection:function(s){const i=s.value,a=s.styleSpec,h=a.projection,m=s.style;let v=[];const x=Mn(i);if(x==="object")for(const T in i)v=v.concat(Ni({key:T,value:i[T],valueSpec:h[T],style:m,styleSpec:a}));else x!=="string"&&(v=v.concat([new $n("projection",i,`object or string expected, ${x} found`)]));return v}};function Ni(s){const i=s.value,a=s.valueSpec,h=s.styleSpec;return a.expression&&bi(Xr(i))?d(s):a.expression&&Rr(ro(i))?b(s):a.type&&_a[a.type]?_a[a.type](s):Oa(Po({},s,{valueSpec:a.type?h[a.type]:a}))}function Pg(s){const i=s.value,a=s.key,h=Dl(s);return h.length||(i.indexOf("{fontstack}")===-1&&h.push(new $n(a,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&h.push(new $n(a,i,'"glyphs" url must include a "{range}" token'))),h}function Sd(s,i=Ke){return $u(Ni({key:"",value:s,valueSpec:i.$root,styleSpec:i,style:s,objectElementValidators:{glyphs:Pg,"*":()=>[]}}))}const zg=s=>$u(Fh(s)),Uc=s=>$u(jh(s));function $u(s){return s.slice().sort((i,a)=>i.line&&a.line?i.line-a.line:0)}function Gp(s,i){let a=!1;if(i&&i.length)for(const h of i)s.fire(new Ss(new Error(h.message))),a=!0;return a}var dh=Iu;function Iu(s,i,a){var h=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var m=new Int32Array(this.arrayBuffer);s=m[0],this.d=(i=m[1])+2*(a=m[2]);for(var v=0;v<this.d*this.d;v++){var x=m[3+v],T=m[3+v+1];h.push(x===T?null:m.subarray(x,T))}var P=m[3+h.length+1];this.keys=m.subarray(m[3+h.length],P),this.bboxes=m.subarray(P),this.insert=this._insertReadonly}else{this.d=i+2*a;for(var O=0;O<this.d*this.d;O++)h.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=s,this.padding=a,this.scale=i/s,this.uid=0;var V=a/i*s;this.min=-V,this.max=s+V}Iu.prototype.insert=function(s,i,a,h,m){this._forEachCell(i,a,h,m,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(m)},Iu.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Iu.prototype._insertCell=function(s,i,a,h,m,v){this.cells[m].push(v)},Iu.prototype.query=function(s,i,a,h,m){var v=this.min,x=this.max;if(s<=v&&i<=v&&x<=a&&x<=h&&!m)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(s,i,a,h,this._queryCell,T,{},m),T},Iu.prototype._queryCell=function(s,i,a,h,m,v,x,T){var P=this.cells[m];if(P!==null)for(var O=this.keys,V=this.bboxes,$=0;$<P.length;$++){var tt=P[$];if(x[tt]===void 0){var ot=4*tt;(T?T(V[ot+0],V[ot+1],V[ot+2],V[ot+3]):s<=V[ot+2]&&i<=V[ot+3]&&a>=V[ot+0]&&h>=V[ot+1])?(x[tt]=!0,v.push(O[tt])):x[tt]=!1}}},Iu.prototype._forEachCell=function(s,i,a,h,m,v,x,T){for(var P=this._convertToCellCoord(s),O=this._convertToCellCoord(i),V=this._convertToCellCoord(a),$=this._convertToCellCoord(h),tt=P;tt<=V;tt++)for(var ot=O;ot<=$;ot++){var ct=this.d*ot+tt;if((!T||T(this._convertFromCellCoord(tt),this._convertFromCellCoord(ot),this._convertFromCellCoord(tt+1),this._convertFromCellCoord(ot+1)))&&m.call(this,s,i,a,h,ct,v,x,T))return}},Iu.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},Iu.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},Iu.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,i=3+this.cells.length+1+1,a=0,h=0;h<this.cells.length;h++)a+=this.cells[h].length;var m=new Int32Array(i+a+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var v=i,x=0;x<s.length;x++){var T=s[x];m[3+x]=v,m.set(T,v),v+=T.length}return m[3+s.length]=v,m.set(this.keys,v),m[3+s.length+1]=v+=this.keys.length,m.set(this.bboxes,v),v+=this.bboxes.length,m.buffer};const Tf={};function Xn(s,i,a={}){Object.defineProperty(s,"_classRegistryKey",{value:i,writeable:!1}),Tf[i]={klass:s,omit:a.omit||[]}}Xn(Object,"Object"),dh.serialize=function(s,i){const a=s.toArrayBuffer();return i&&i.push(a),{buffer:a}},dh.deserialize=function(s){return new dh(s.buffer)},Object.defineProperty(dh,"name",{value:"Grid"}),Xn(dh,"Grid"),Xn(Zr,"Color"),Xn(Error,"Error"),Xn(vr,"AJAXError"),Xn(wi,"ResolvedImage"),Xn(Pl,"StylePropertyFunction"),Xn(rs,"StyleExpression",{omit:["_evaluator"]}),Xn(Bo,"ZoomDependentExpression"),Xn(Ws,"ZoomConstantExpression"),Xn($t,"CompoundExpression",{omit:["_evaluate"]});for(const s in Ce)Tf[Ce[s]._classRegistryKey]||Xn(Ce[s],`Expression${s}`);function Zp(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Vp(s){return w.ImageBitmap&&s instanceof w.ImageBitmap}function vc(s,i){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(Zp(s)||Vp(s))return i&&i.push(s),s;if(ArrayBuffer.isView(s)){const a=s;return i&&i.push(a.buffer),a}if(s instanceof w.ImageData)return i&&i.push(s.data.buffer),s;if(Array.isArray(s)){const a=[];for(const h of s)a.push(vc(h,i));return a}if(typeof s=="object"){const a=s.constructor,h=a._classRegistryKey;if(!h)throw new Error(`can't serialize object of unregistered class ${h}`);const m=a.serialize?a.serialize(s,i):{};if(!a.serialize){for(const v in s)s.hasOwnProperty(v)&&(Tf[h].omit.indexOf(v)>=0||(m[v]=vc(s[v],i)));s instanceof Error&&(m.message=s.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(m.$name=h),m}throw new Error("can't serialize object of type "+typeof s)}function Gh(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||Zp(s)||Vp(s)||ArrayBuffer.isView(s)||s instanceof w.ImageData)return s;if(Array.isArray(s))return s.map(Gh);if(typeof s=="object"){const i=s.$name||"Object",{klass:a}=Tf[i];if(!a)throw new Error(`can't deserialize unregistered class ${i}`);if(a.deserialize)return a.deserialize(s);const h=Object.create(a.prototype);for(const m of Object.keys(s))m!=="$name"&&(h[m]=Gh(s[m]));return h}throw new Error("can't deserialize object of type "+typeof s)}const Ed=s=>s>=1536&&s<=1791,Cu=s=>s>=1872&&s<=1919,Md=s=>s>=2208&&s<=2303,Ld=s=>s>=11904&&s<=12031,kd=s=>s>=12032&&s<=12255,Pd=s=>s>=12272&&s<=12287,ph=s=>s>=12288&&s<=12351,iu=s=>s>=12352&&s<=12447,Sf=s=>s>=12448&&s<=12543,Wp=s=>s>=12544&&s<=12591,vl=s=>s>=12704&&s<=12735,Yp=s=>s>=12736&&s<=12783,Xp=s=>s>=12784&&s<=12799,Hp=s=>s>=12800&&s<=13055,$p=s=>s>=13056&&s<=13311,qp=s=>s>=13312&&s<=19903,Ef=s=>s>=19968&&s<=40959,zd=s=>s>=40960&&s<=42127,Jp=s=>s>=42128&&s<=42191,Dd=s=>s>=44032&&s<=55215,Gc=s=>s>=63744&&s<=64255,_=s=>s>=64336&&s<=65023,u=s=>s>=65040&&s<=65055,f=s=>s>=65072&&s<=65103,y=s=>s>=65104&&s<=65135,A=s=>s>=65136&&s<=65279,S=s=>s>=65280&&s<=65519;function B(s){for(const i of s)if(it(i.charCodeAt(0)))return!0;return!1}function G(s){for(const i of s)if(!W(i.charCodeAt(0)))return!1;return!0}function W(s){return!(Ed(s)||Cu(s)||Md(s)||_(s)||A(s))}function it(s){return!(s!==746&&s!==747&&(s<4352||!(vl(s)||Wp(s)||f(s)&&!(s>=65097&&s<=65103)||Gc(s)||$p(s)||Ld(s)||Yp(s)||!(!ph(s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||qp(s)||Ef(s)||Hp(s)||(i=>i>=12592&&i<=12687)(s)||(i=>i>=43360&&i<=43391)(s)||(i=>i>=55216&&i<=55295)(s)||(i=>i>=4352&&i<=4607)(s)||Dd(s)||iu(s)||Pd(s)||(i=>i>=12688&&i<=12703)(s)||kd(s)||Xp(s)||Sf(s)&&s!==12540||!(!S(s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!y(s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||(i=>i>=5120&&i<=5759)(s)||(i=>i>=6320&&i<=6399)(s)||u(s)||(i=>i>=19904&&i<=19967)(s)||zd(s)||Jp(s))))}function et(s){return!(it(s)||function(i){return!!((a=>a>=128&&a<=255)(i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||(a=>a>=8192&&a<=8303)(i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||(a=>a>=8448&&a<=8527)(i)||(a=>a>=8528&&a<=8591)(i)||(a=>a>=8960&&a<=9215)(i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||(a=>a>=9216&&a<=9279)(i)&&i!==9251||(a=>a>=9280&&a<=9311)(i)||(a=>a>=9312&&a<=9471)(i)||(a=>a>=9632&&a<=9727)(i)||(a=>a>=9728&&a<=9983)(i)&&!(i>=9754&&i<=9759)||(a=>a>=11008&&a<=11263)(i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||ph(i)||Sf(i)||(a=>a>=57344&&a<=63743)(i)||f(i)||y(i)||S(i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(s))}function _t(s){return s>=1424&&s<=2303||_(s)||A(s)}function Mt(s,i){return!(!i&&_t(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||(a=>a>=6016&&a<=6143)(s))}function Bt(s){for(const i of s)if(_t(i.charCodeAt(0)))return!0;return!1}const Ft="deferred",Gt="loading",Pt="loaded";let Ot=null,Wt="unavailable",jt=null;const Kt=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(Wt="error"),Ot&&Ot(s)};function me(){re.fire(new Js("pluginStateChange",{pluginStatus:Wt,pluginURL:jt}))}const re=new vs,Ae=function(){return Wt},He=function(){if(Wt!==Ft||!jt)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Wt=Gt,me(),jt&&uo({url:jt},s=>{s?Kt(s):(Wt=Pt,me())})},je={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Wt===Pt||je.applyArabicShaping!=null,isLoading:()=>Wt===Gt,setState(s){Wt=s.pluginStatus,jt=s.pluginURL},isParsed:()=>je.applyArabicShaping!=null&&je.processBidirectionalText!=null&&je.processStyledBidirectionalText!=null,getPluginURL:()=>jt};class De{constructor(i,a){this.zoom=i,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(i){return function(a,h){for(const m of a)if(!Mt(m.charCodeAt(0),h))return!1;return!0}(i,je.isLoaded())}}class An{constructor(i,a){this.property=i,this.value=a,this.expression=function(h,m){if(bi(h))return new Pl(h,m);if(Rr(h)){const v=kl(h,m);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=h;return typeof h=="string"&&m.type==="color"&&(v=Zr.parse(h)),{kind:"constant",evaluate:()=>v}}}(a===void 0?i.specification.default:a,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,a,h){return this.property.possiblyEvaluate(this,i,a,h)}}class Fe{constructor(i){this.property=i,this.value=new An(i,void 0)}transitioned(i,a){return new Je(this.property,this.value,a,be({},i.transition,this.transition),i.now)}untransitioned(){return new Je(this.property,this.value,null,{},0)}}class fn{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Bn(this._values[i].value.value)}setValue(i,a){this._values.hasOwnProperty(i)||(this._values[i]=new Fe(this._values[i].property)),this._values[i].value=new An(this._values[i].property,a===null?void 0:Bn(a))}getTransition(i){return Bn(this._values[i].transition)}setTransition(i,a){this._values.hasOwnProperty(i)||(this._values[i]=new Fe(this._values[i].property)),this._values[i].transition=Bn(a)||void 0}serialize(){const i={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(i[a]=h);const m=this.getTransition(a);m!==void 0&&(i[`${a}-transition`]=m)}return i}transitioned(i,a){const h=new Ln(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(i,a._values[m]);return h}untransitioned(){const i=new Ln(this._properties);for(const a of Object.keys(this._values))i._values[a]=this._values[a].untransitioned();return i}}class Je{constructor(i,a,h,m,v){const x=m.delay||0,T=m.duration||0;v=v||0,this.property=i,this.value=a,this.begin=v+x,this.end=this.begin+T,i.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(i,a,h){const m=i.now||0,v=this.value.possiblyEvaluate(i,a,h),x=this.prior;if(x){if(m>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(m<this.begin)return x.possiblyEvaluate(i,a,h);{const T=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(i,a,h),v,Et(T))}}return v}}class Ln{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,a,h){const m=new zn(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(i,a,h);return m}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class tn{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return Bn(this._values[i].value)}setValue(i,a){this._values[i]=new An(this._values[i].property,a===null?void 0:Bn(a))}serialize(){const i={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(i[a]=h)}return i}possiblyEvaluate(i,a,h){const m=new zn(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(i,a,h);return m}}class xn{constructor(i,a,h){this.property=i,this.value=a,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,a,h,m){return this.property.evaluate(this.value,this.parameters,i,a,h,m)}}class zn{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Ne{constructor(i){this.specification=i}possiblyEvaluate(i,a){return i.expression.evaluate(a)}interpolate(i,a,h){const m=us[this.specification.type];return m?m(i,a,h):i}}class $e{constructor(i,a){this.specification=i,this.overrides=a}possiblyEvaluate(i,a,h,m){return new xn(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(a,null,{},h,m)}:i.expression,a)}interpolate(i,a,h){if(i.value.kind!=="constant"||a.value.kind!=="constant")return i;if(i.value.value===void 0||a.value.value===void 0)return new xn(this,{kind:"constant",value:void 0},i.parameters);const m=us[this.specification.type];return m?new xn(this,{kind:"constant",value:m(i.value.value,a.value.value,h)},i.parameters):i}evaluate(i,a,h,m,v,x){return i.kind==="constant"?i.value:i.evaluate(a,h,m,v,x)}}class ri{constructor(i){this.specification=i}possiblyEvaluate(i,a,h,m){return!!i.expression.evaluate(a,null,{},h,m)}interpolate(){return!1}}class fi{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new De(0,{});for(const h in i){const m=i[h];m.specification.overridable&&this.overridableProperties.push(h);const v=this.defaultPropertyValues[h]=new An(m,void 0),x=this.defaultTransitionablePropertyValues[h]=new Fe(m);this.defaultTransitioningPropertyValues[h]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=v.possiblyEvaluate(a)}}}function oi(s,i){return 256*(s=ie(Math.floor(s),0,255))+ie(Math.floor(i),0,255)}Xn($e,"DataDrivenProperty"),Xn(Ne,"DataConstantProperty"),Xn(ri,"ColorRampProperty");const Li={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ki{constructor(i,a){this._structArray=i,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,a){return i._trim(),a&&(i.isTransferred=!0,a.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const a=Object.create(this.prototype);return a.arrayBuffer=i.arrayBuffer,a.length=i.length,a.capacity=i.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Kn(s,i=1){let a=0,h=0;return{members:s.map(m=>{const v=Li[m.type].BYTES_PER_ELEMENT,x=a=Hr(a,Math.max(i,v)),T=m.components||1;return h=Math.max(h,v),a+=v*T,{name:m.name,type:m.type,components:T,offset:x}}),size:Hr(a,Math.max(h,i)),alignment:i}}function Hr(s,i){return Math.ceil(s/i)*i}class Dr extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const m=2*i;return this.int16[m+0]=a,this.int16[m+1]=h,i}}Dr.prototype.bytesPerElement=4,Xn(Dr,"StructArrayLayout2i4");class to extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,a,h)}emplace(i,a,h,m){const v=3*i;return this.int16[v+0]=a,this.int16[v+1]=h,this.int16[v+2]=m,i}}to.prototype.bytesPerElement=6,Xn(to,"StructArrayLayout3i6");class Wr extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,a,h,m)}emplace(i,a,h,m,v){const x=4*i;return this.int16[x+0]=a,this.int16[x+1]=h,this.int16[x+2]=m,this.int16[x+3]=v,i}}Wr.prototype.bytesPerElement=8,Xn(Wr,"StructArrayLayout4i8");class qa extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v,x,T){const P=this.length;return this.resize(P+1),this.emplace(P,i,a,h,m,v,x,T)}emplace(i,a,h,m,v,x,T,P){const O=6*i,V=12*i,$=3*i;return this.int16[O+0]=a,this.int16[O+1]=h,this.uint8[V+4]=m,this.uint8[V+5]=v,this.uint8[V+6]=x,this.uint8[V+7]=T,this.float32[$+2]=P,i}}qa.prototype.bytesPerElement=12,Xn(qa,"StructArrayLayout2i4ub1f12");class Ra extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,a,h,m)}emplace(i,a,h,m,v){const x=4*i;return this.float32[x+0]=a,this.float32[x+1]=h,this.float32[x+2]=m,this.float32[x+3]=v,i}}Ra.prototype.bytesPerElement=16,Xn(Ra,"StructArrayLayout4f16");class va extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,h,m,v)}emplace(i,a,h,m,v,x){const T=6*i,P=3*i;return this.uint16[T+0]=a,this.uint16[T+1]=h,this.uint16[T+2]=m,this.uint16[T+3]=v,this.float32[P+2]=x,i}}va.prototype.bytesPerElement=12,Xn(va,"StructArrayLayout4ui1f12");class ru extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,a,h,m)}emplace(i,a,h,m,v){const x=4*i;return this.uint16[x+0]=a,this.uint16[x+1]=h,this.uint16[x+2]=m,this.uint16[x+3]=v,i}}ru.prototype.bytesPerElement=8,Xn(ru,"StructArrayLayout4ui8");class mo extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v,x){const T=this.length;return this.resize(T+1),this.emplace(T,i,a,h,m,v,x)}emplace(i,a,h,m,v,x,T){const P=6*i;return this.int16[P+0]=a,this.int16[P+1]=h,this.int16[P+2]=m,this.int16[P+3]=v,this.int16[P+4]=x,this.int16[P+5]=T,i}}mo.prototype.bytesPerElement=12,Xn(mo,"StructArrayLayout6i12");class Yr extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v,x,T,P,O,V,$,tt){const ot=this.length;return this.resize(ot+1),this.emplace(ot,i,a,h,m,v,x,T,P,O,V,$,tt)}emplace(i,a,h,m,v,x,T,P,O,V,$,tt,ot){const ct=12*i;return this.int16[ct+0]=a,this.int16[ct+1]=h,this.int16[ct+2]=m,this.int16[ct+3]=v,this.uint16[ct+4]=x,this.uint16[ct+5]=T,this.uint16[ct+6]=P,this.uint16[ct+7]=O,this.int16[ct+8]=V,this.int16[ct+9]=$,this.int16[ct+10]=tt,this.int16[ct+11]=ot,i}}Yr.prototype.bytesPerElement=24,Xn(Yr,"StructArrayLayout4i4ui4i24");class kr extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v,x){const T=this.length;return this.resize(T+1),this.emplace(T,i,a,h,m,v,x)}emplace(i,a,h,m,v,x,T){const P=10*i,O=5*i;return this.int16[P+0]=a,this.int16[P+1]=h,this.int16[P+2]=m,this.float32[O+2]=v,this.float32[O+3]=x,this.float32[O+4]=T,i}}kr.prototype.bytesPerElement=20,Xn(kr,"StructArrayLayout3i3f20");class Ho extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint32[1*i+0]=a,i}}Ho.prototype.bytesPerElement=4,Xn(Ho,"StructArrayLayout1ul4");class sa extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v,x,T,P,O,V,$,tt,ot){const ct=this.length;return this.resize(ct+1),this.emplace(ct,i,a,h,m,v,x,T,P,O,V,$,tt,ot)}emplace(i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct){const bt=20*i,zt=10*i;return this.int16[bt+0]=a,this.int16[bt+1]=h,this.int16[bt+2]=m,this.int16[bt+3]=v,this.int16[bt+4]=x,this.float32[zt+3]=T,this.float32[zt+4]=P,this.float32[zt+5]=O,this.float32[zt+6]=V,this.int16[bt+14]=$,this.uint32[zt+8]=tt,this.uint16[bt+18]=ot,this.uint16[bt+19]=ct,i}}sa.prototype.bytesPerElement=40,Xn(sa,"StructArrayLayout5i4f1i1ul2ui40");class go extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v,x,T){const P=this.length;return this.resize(P+1),this.emplace(P,i,a,h,m,v,x,T)}emplace(i,a,h,m,v,x,T,P){const O=8*i;return this.int16[O+0]=a,this.int16[O+1]=h,this.int16[O+2]=m,this.int16[O+4]=v,this.int16[O+5]=x,this.int16[O+6]=T,this.int16[O+7]=P,i}}go.prototype.bytesPerElement=16,Xn(go,"StructArrayLayout3i2i2i16");class ya extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,h,m,v)}emplace(i,a,h,m,v,x){const T=4*i,P=8*i;return this.float32[T+0]=a,this.float32[T+1]=h,this.float32[T+2]=m,this.int16[P+6]=v,this.int16[P+7]=x,i}}ya.prototype.bytesPerElement=16,Xn(ya,"StructArrayLayout2f1f2i16");class Zh extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,a,h,m)}emplace(i,a,h,m,v){const x=12*i,T=3*i;return this.uint8[x+0]=a,this.uint8[x+1]=h,this.float32[T+1]=m,this.float32[T+2]=v,i}}Zh.prototype.bytesPerElement=12,Xn(Zh,"StructArrayLayout2ub2f12");class ou extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,a,h)}emplace(i,a,h,m){const v=3*i;return this.float32[v+0]=a,this.float32[v+1]=h,this.float32[v+2]=m,i}}ou.prototype.bytesPerElement=12,Xn(ou,"StructArrayLayout3f12");class aa extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,a,h)}emplace(i,a,h,m){const v=3*i;return this.uint16[v+0]=a,this.uint16[v+1]=h,this.uint16[v+2]=m,i}}aa.prototype.bytesPerElement=6,Xn(aa,"StructArrayLayout3ui6");class Ja extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct,bt,zt,Jt,le,Xt,Qt,ge){const he=this.length;return this.resize(he+1),this.emplace(he,i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct,bt,zt,Jt,le,Xt,Qt,ge)}emplace(i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct,bt,zt,Jt,le,Xt,Qt,ge,he){const Xe=30*i,Ze=15*i,dn=60*i;return this.int16[Xe+0]=a,this.int16[Xe+1]=h,this.int16[Xe+2]=m,this.float32[Ze+2]=v,this.float32[Ze+3]=x,this.uint16[Xe+8]=T,this.uint16[Xe+9]=P,this.uint32[Ze+5]=O,this.uint32[Ze+6]=V,this.uint32[Ze+7]=$,this.uint16[Xe+16]=tt,this.uint16[Xe+17]=ot,this.uint16[Xe+18]=ct,this.float32[Ze+10]=bt,this.float32[Ze+11]=zt,this.uint8[dn+48]=Jt,this.uint8[dn+49]=le,this.uint8[dn+50]=Xt,this.uint32[Ze+13]=Qt,this.int16[Xe+28]=ge,this.uint8[dn+58]=he,i}}Ja.prototype.bytesPerElement=60,Xn(Ja,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Au extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct,bt,zt,Jt,le,Xt,Qt,ge,he,Xe,Ze,dn,Dn,en,_n,wn,En){const Nn=this.length;return this.resize(Nn+1),this.emplace(Nn,i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct,bt,zt,Jt,le,Xt,Qt,ge,he,Xe,Ze,dn,Dn,en,_n,wn,En)}emplace(i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct,bt,zt,Jt,le,Xt,Qt,ge,he,Xe,Ze,dn,Dn,en,_n,wn,En,Nn){const nn=38*i,Vn=19*i;return this.int16[nn+0]=a,this.int16[nn+1]=h,this.int16[nn+2]=m,this.float32[Vn+2]=v,this.float32[Vn+3]=x,this.int16[nn+8]=T,this.int16[nn+9]=P,this.int16[nn+10]=O,this.int16[nn+11]=V,this.int16[nn+12]=$,this.int16[nn+13]=tt,this.uint16[nn+14]=ot,this.uint16[nn+15]=ct,this.uint16[nn+16]=bt,this.uint16[nn+17]=zt,this.uint16[nn+18]=Jt,this.uint16[nn+19]=le,this.uint16[nn+20]=Xt,this.uint16[nn+21]=Qt,this.uint16[nn+22]=ge,this.uint16[nn+23]=he,this.uint16[nn+24]=Xe,this.uint16[nn+25]=Ze,this.uint16[nn+26]=dn,this.uint16[nn+27]=Dn,this.uint16[nn+28]=en,this.uint32[Vn+15]=_n,this.float32[Vn+16]=wn,this.float32[Vn+17]=En,this.float32[Vn+18]=Nn,i}}Au.prototype.bytesPerElement=76,Xn(Au,"StructArrayLayout3i2f6i15ui1ul3f76");class Nl extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.float32[1*i+0]=a,i}}Nl.prototype.bytesPerElement=4,Xn(Nl,"StructArrayLayout1f4");class ar extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,h,m,v)}emplace(i,a,h,m,v,x){const T=5*i;return this.float32[T+0]=a,this.float32[T+1]=h,this.float32[T+2]=m,this.float32[T+3]=v,this.float32[T+4]=x,i}}ar.prototype.bytesPerElement=20,Xn(ar,"StructArrayLayout5f20");class mh extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,a,h,m)}emplace(i,a,h,m,v){const x=6*i;return this.uint32[3*i+0]=a,this.uint16[x+2]=h,this.uint16[x+3]=m,this.uint16[x+4]=v,i}}mh.prototype.bytesPerElement=12,Xn(mh,"StructArrayLayout1ul3ui12");class Tu extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const m=2*i;return this.uint16[m+0]=a,this.uint16[m+1]=h,i}}Tu.prototype.bytesPerElement=4,Xn(Tu,"StructArrayLayout2ui4");class Zc extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint16[1*i+0]=a,i}}Zc.prototype.bytesPerElement=2,Xn(Zc,"StructArrayLayout1ui2");class Nd extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const m=2*i;return this.float32[m+0]=a,this.float32[m+1]=h,i}}Nd.prototype.bytesPerElement=8,Xn(Nd,"StructArrayLayout2f8");class cy extends Ki{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}cy.prototype.size=40;class Dg extends sa{get(i){return new cy(this,i)}}Xn(Dg,"CollisionBoxArray");class su extends Ki{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}su.prototype.size=60;class hy extends Ja{get(i){return new su(this,i)}}Xn(hy,"PlacedSymbolArray");class Od extends Ki{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(i){this._structArray.uint32[this._pos4+15]=i}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Od.prototype.size=76;class Kp extends Au{get(i){return new Od(this,i)}}Xn(Kp,"SymbolInstanceArray");class Ng extends Nl{getoffsetX(i){return this.float32[1*i+0]}}Xn(Ng,"GlyphOffsetArray");class Og extends Dr{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}Xn(Og,"SymbolLineVertexArray");class Ol extends Ki{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ol.prototype.size=12;class Vc extends mh{get(i){return new Ol(this,i)}}Xn(Vc,"FeatureIndexArray");class Qp extends Tu{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}Xn(Qp,"FillExtrusionCentroidArray");const fy=Kn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),tm=Kn([{name:"a_dash",components:4,type:"Uint16"}]);var Vh={exports:{}},em={exports:{}};em.exports=function(s,i){var a,h,m,v,x,T,P,O;for(h=s.length-(a=3&s.length),m=i,x=3432918353,T=461845907,O=0;O<h;)P=255&s.charCodeAt(O)|(255&s.charCodeAt(++O))<<8|(255&s.charCodeAt(++O))<<16|(255&s.charCodeAt(++O))<<24,++O,m=27492+(65535&(v=5*(65535&(m=(m^=P=(65535&(P=(P=(65535&P)*x+(((P>>>16)*x&65535)<<16)&4294967295)<<15|P>>>17))*T+(((P>>>16)*T&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(P=0,a){case 3:P^=(255&s.charCodeAt(O+2))<<16;case 2:P^=(255&s.charCodeAt(O+1))<<8;case 1:m^=P=(65535&(P=(P=(65535&(P^=255&s.charCodeAt(O)))*x+(((P>>>16)*x&65535)<<16)&4294967295)<<15|P>>>17))*T+(((P>>>16)*T&65535)<<16)&4294967295}return m^=s.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var Rg={exports:{}};Rg.exports=function(s,i){for(var a,h=s.length,m=i^h,v=0;h>=4;)a=1540483477*(65535&(a=255&s.charCodeAt(v)|(255&s.charCodeAt(++v))<<8|(255&s.charCodeAt(++v))<<16|(255&s.charCodeAt(++v))<<24))+((1540483477*(a>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),h-=4,++v;switch(h){case 3:m^=(255&s.charCodeAt(v+2))<<16;case 2:m^=(255&s.charCodeAt(v+1))<<8;case 1:m=1540483477*(65535&(m^=255&s.charCodeAt(v)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var nm=em.exports,Bg=Rg.exports;Vh.exports=nm,Vh.exports.murmur3=nm,Vh.exports.murmur2=Bg;class qu{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,a,h,m){this.ids.push(dy(i)),this.positions.push(a,h,m)}getPositions(i){const a=dy(i);let h=0,m=this.ids.length-1;for(;h<m;){const x=h+m>>1;this.ids[x]>=a?m=x:h=x+1}const v=[];for(;this.ids[h]===a;)v.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return v}static serialize(i,a){const h=new Float64Array(i.ids),m=new Uint32Array(i.positions);return yc(h,m,0,h.length-1),a&&a.push(h.buffer,m.buffer),{ids:h,positions:m}}static deserialize(i){const a=new qu;return a.ids=i.ids,a.positions=i.positions,a.indexed=!0,a}}function dy(s){const i=+s;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:Vh.exports(String(s))}function yc(s,i,a,h){for(;a<h;){const m=s[a+h>>1];let v=a-1,x=h+1;for(;;){do v++;while(s[v]<m);do x--;while(s[x]>m);if(v>=x)break;Rd(s,v,x),Rd(i,3*v,3*x),Rd(i,3*v+1,3*x+1),Rd(i,3*v+2,3*x+2)}x-a<h-x?(yc(s,i,a,x),a=x+1):(yc(s,i,x+1,h),h=x)}}function Rd(s,i,a){const h=s[i];s[i]=s[a],s[a]=h}Xn(qu,"FeaturePositionMap");class xc{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,a),this.initialized=!0),!!this.location}}class Mf extends xc{constructor(i){super(i),this.current=0}set(i,a,h){this.fetchUniformLocation(i,a)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class py extends xc{constructor(i){super(i),this.current=[0,0,0,0]}set(i,a,h){this.fetchUniformLocation(i,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class my extends xc{constructor(i){super(i),this.current=Zr.transparent}set(i,a,h){this.fetchUniformLocation(i,a)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const iw=new Float32Array(16),gy=new Float32Array(9),_y=new Float32Array(4);function Fg(s){return[oi(255*s.r,255*s.g),oi(255*s.b,255*s.a)]}class Lf{constructor(i,a,h){this.value=i,this.uniformNames=a.map(m=>`u_${m}`),this.type=h}setUniform(i,a,h,m,v){a.set(i,v,m.constantOr(this.value))}getBinding(i,a){return this.type==="color"?new my(i):new Mf(i)}}class Wh{constructor(i,a){this.uniformNames=a.map(h=>`u_${h}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(i){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br)}setUniform(i,a,h,m,v){const x=v==="u_pattern"||v==="u_dash"?this.pattern:v==="u_pixel_ratio"?this.pixelRatio:null;x&&a.set(i,v,x)}getBinding(i,a){return a==="u_pattern"||a==="u_dash"?new py(i):new Mf(i)}}class bs{constructor(i,a,h,m){this.expression=i,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(v=>({name:`a_${v}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(i,a,h,m,v,x){const T=this.paintVertexArray.length,P=this.expression.evaluate(new De(0),a,{},v,m,x);this.paintVertexArray.resize(i),this._setPaintValue(T,i,P)}updatePaintArray(i,a,h,m,v){const x=this.expression.evaluate({zoom:0},h,m,void 0,v);this._setPaintValue(i,a,x)}_setPaintValue(i,a,h){if(this.type==="color"){const m=Fg(h);for(let v=i;v<a;v++)this.paintVertexArray.emplace(v,m[0],m[1])}else{for(let m=i;m<a;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xs{constructor(i,a,h,m,v,x){this.expression=i,this.uniformNames=a.map(T=>`u_${T}_t`),this.type=h,this.useIntegerZoom=m,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=a.map(T=>({name:`a_${T}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(i,a,h,m,v,x){const T=this.expression.evaluate(new De(this.zoom),a,{},v,m,x),P=this.expression.evaluate(new De(this.zoom+1),a,{},v,m,x),O=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(O,i,T,P)}updatePaintArray(i,a,h,m,v){const x=this.expression.evaluate({zoom:this.zoom},h,m,void 0,v),T=this.expression.evaluate({zoom:this.zoom+1},h,m,void 0,v);this._setPaintValue(i,a,x,T)}_setPaintValue(i,a,h,m){if(this.type==="color"){const v=Fg(h),x=Fg(m);for(let T=i;T<a;T++)this.paintVertexArray.emplace(T,v[0],v[1],x[0],x[1])}else{for(let v=i;v<a;v++)this.paintVertexArray.emplace(v,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,a,h,m,v){const x=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,T=ie(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);a.set(i,v,T)}getBinding(i,a){return new Mf(i)}}class gh{constructor(i,a,h,m,v){this.expression=i,this.layerId=v,this.paintVertexAttributes=(h==="array"?tm:fy).members;for(let x=0;x<a.length;++x);this.paintVertexArray=new m}populatePaintArray(i,a,h){const m=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(m,i,a.patterns&&a.patterns[this.layerId],h)}updatePaintArray(i,a,h,m,v,x){this._setPaintValues(i,a,h.patterns&&h.patterns[this.layerId],x)}_setPaintValues(i,a,h,m){if(!m||!h)return;const v=m[h];if(!v)return;const{tl:x,br:T,pixelRatio:P}=v;for(let O=i;O<a;O++)this.paintVertexArray.emplace(O,x[0],x[1],T[0],T[1],P)}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _h{constructor(i,a,h=()=>!0){this.binders={},this._buffers=[];const m=[];for(const v in i.paint._values){if(!h(v))continue;const x=i.paint.get(v);if(!(x instanceof xn&&rn(x.property.specification)))continue;const T=vy(v,i.type),P=x.value,O=x.property.specification.type,V=x.property.useIntegerZoom,$=v==="line-dasharray"||v.endsWith("pattern"),tt=v==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant";if(P.kind!=="constant"||tt)if(P.kind==="source"||tt||$){const ot=jg(v,O,"source");this.binders[v]=$?new gh(P,T,O,ot,i.id):new bs(P,T,O,ot),m.push(`/a_${v}`)}else{const ot=jg(v,O,"composite");this.binders[v]=new Xs(P,T,O,V,a,ot),m.push(`/z_${v}`)}else this.binders[v]=$?new Wh(P.value,T):new Lf(P.value,T,O),m.push(`/u_${v}`)}this.cacheKey=m.sort().join("")}getMaxValue(i){const a=this.binders[i];return a instanceof bs||a instanceof Xs?a.maxValue:0}populatePaintArrays(i,a,h,m,v,x){for(const T in this.binders){const P=this.binders[T];(P instanceof bs||P instanceof Xs||P instanceof gh)&&P.populatePaintArray(i,a,h,m,v,x)}}setConstantPatternPositions(i){for(const a in this.binders){const h=this.binders[a];h instanceof Wh&&h.setConstantPatternPositions(i)}}updatePaintArrays(i,a,h,m,v,x){let T=!1;for(const P in i){const O=a.getPositions(P);for(const V of O){const $=h.feature(V.index);for(const tt in this.binders){const ot=this.binders[tt];if((ot instanceof bs||ot instanceof Xs||ot instanceof gh)&&ot.expression.isStateDependent===!0){const ct=m.paint.get(tt);ot.expression=ct.value,ot.updatePaintArray(V.start,V.end,$,i[P],v,x),T=!0}}}}return T}defines(){const i=[];for(const a in this.binders){const h=this.binders[a];(h instanceof Lf||h instanceof Wh)&&i.push(...h.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return i}getBinderAttributes(){const i=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof bs||h instanceof Xs||h instanceof gh)for(let m=0;m<h.paintVertexAttributes.length;m++)i.push(h.paintVertexAttributes[m].name)}return i}getBinderUniforms(){const i=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Lf||h instanceof Wh||h instanceof Xs)for(const m of h.uniformNames)i.push(m)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Lf||m instanceof Wh||m instanceof Xs)for(const v of m.uniformNames)a.push({name:v,property:h,binding:m.getBinding(i,v)})}return a}setUniforms(i,a,h,m,v){for(const{name:x,property:T,binding:P}of h)this.binders[T].setUniform(i,P,v,m.get(T),x)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const a=this.binders[i];(a instanceof bs||a instanceof Xs||a instanceof gh)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(i){for(const a in this.binders){const h=this.binders[a];(h instanceof bs||h instanceof Xs||h instanceof gh)&&h.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const a=this.binders[i];(a instanceof bs||a instanceof Xs||a instanceof gh)&&a.destroy()}}}class wc{constructor(i,a,h=()=>!0){this.programConfigurations={};for(const m of i)this.programConfigurations[m.id]=new _h(m,a,h);this.needsUpload=!1,this._featureMap=new qu,this._bufferOffset=0}populatePaintArrays(i,a,h,m,v,x,T){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(i,a,m,v,x,T);a.id!==void 0&&this._featureMap.add(a.id,h,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,a,h,m,v){for(const x of h)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(i,this._featureMap,a,x,m,v)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const kf={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function vy(s,i){return kf[s]||[s.replace(`${i}-`,"").replace(/-/g,"_")]}const yy={"line-pattern":{source:va,composite:va},"fill-pattern":{source:va,composite:va},"fill-extrusion-pattern":{source:va,composite:va},"line-dasharray":{source:ru,composite:ru}},rw={color:{source:Nd,composite:Ra},number:{source:Nl,composite:Nd}};function jg(s,i,a){const h=yy[s];return h&&h[a]||rw[i][a]}Xn(Lf,"ConstantBinder"),Xn(Wh,"PatternConstantBinder"),Xn(bs,"SourceExpressionBinder"),Xn(gh,"PatternCompositeBinder"),Xn(Xs,"CompositeExpressionBinder"),Xn(_h,"ProgramConfiguration",{omit:["_buffers"]}),Xn(wc,"ProgramConfigurationSet");const Wc="-transition";class yl extends vs{constructor(i,a){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&i.type!=="sky"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),a.layout&&(this._unevaluatedLayout=new tn(a.layout)),a.paint)){this._transitionablePaint=new fn(a.paint);for(const h in i.paint)this.setPaintProperty(h,i.paint[h],{validate:!1});for(const h in i.layout)this.setLayoutProperty(h,i.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new zn(a.paint)}}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,a,h={}){a!=null&&this._validate(Uc,`layers.${this.id}.layout.${i}`,i,a,h)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,a):this.visibility=a)}getPaintProperty(i){return mn(i,Wc)?this._transitionablePaint.getTransition(i.slice(0,-Wc.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,a,h={}){if(a!=null&&this._validate(zg,`layers.${this.id}.paint.${i}`,i,a,h))return!1;if(mn(i,Wc))return this._transitionablePaint.setTransition(i.slice(0,-Wc.length),a||void 0),!1;{const m=this._transitionablePaint._values[i],v=m.value.isDataDriven(),x=m.value;this._transitionablePaint.setValue(i,a),this._handleSpecialPaintPropertyUpdate(i);const T=this._transitionablePaint._values[i].value,P=T.isDataDriven(),O=mn(i,"pattern")||i==="line-dasharray";return P||v||O||this._handleOverridablePaintPropertyUpdate(i,x,T)}}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getProgramConfiguration(i){return null}_handleOverridablePaintPropertyUpdate(i,a,h){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,a)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Cn(i,(a,h)=>!(a===void 0||h==="layout"&&!Object.keys(a).length||h==="paint"&&!Object.keys(a).length))}_validate(i,a,h,m,v={}){return(!v||v.validate!==!1)&&Gp(this,i.call(Sd,{key:a,layerType:this.type,objectKey:h,value:m,styleSpec:Ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const a=this.paint.get(i);if(a instanceof xn&&rn(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=St(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ow=Kn([{name:"a_pos",components:2,type:"Int16"}],4),xy=Kn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class cs{constructor(i=[]){this.segments=i}prepareSegment(i,a,h,m){let v=this.segments[this.segments.length-1];return i>cs.MAX_VERTEX_ARRAY_LENGTH&&cn(`Max vertices per segment is ${cs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!v||v.vertexLength+i>cs.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==m)&&(v={vertexOffset:a.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},m!==void 0&&(v.sortKey=m),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const i of this.segments)for(const a in i.vaos)i.vaos[a].destroy()}static simpleSegment(i,a,h,m){return new cs([{vertexOffset:i,primitiveOffset:a,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}cs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xn(cs,"SegmentVector");var xi=8192;class Yc{constructor(i,a){i&&(a?this.setSouthWest(i).setNorthEast(a):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof br?new br(i.lng,i.lat):br.convert(i),this}setSouthWest(i){return this._sw=i instanceof br?new br(i.lng,i.lat):br.convert(i),this}extend(i){const a=this._sw,h=this._ne;let m,v;if(i instanceof br)m=i,v=i;else{if(!(i instanceof Yc))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Yc.convert(i)):this.extend(br.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&i.hasOwnProperty("lon")?this.extend(br.convert(i)):this;if(m=i._sw,v=i._ne,!m||!v)return this}return a||h?(a.lng=Math.min(m.lng,a.lng),a.lat=Math.min(m.lat,a.lat),h.lng=Math.max(v.lng,h.lng),h.lat=Math.max(v.lat,h.lat)):(this._sw=new br(m.lng,m.lat),this._ne=new br(v.lng,v.lat)),this}getCenter(){return new br((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new br(this.getWest(),this.getNorth())}getSouthEast(){return new br(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:a,lat:h}=br.convert(i);let m=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&m}static convert(i){return!i||i instanceof Yc?i:new Yc(i)}}const Yh=63710088e-1;class br{constructor(i,a){if(isNaN(i)||isNaN(a))throw new Error(`Invalid LngLat object: (${i}, ${a})`);if(this.lng=+i,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new br(Le(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const a=Math.PI/180,h=this.lat*a,m=i.lat*a,v=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((i.lng-this.lng)*a);return Yh*Math.acos(Math.min(v,1))}toBounds(i=0){const a=360*i/40075017,h=a/Math.cos(Math.PI/180*this.lat);return new Yc(new br(this.lng-h,this.lat-a),new br(this.lng+h,this.lat+a))}static convert(i){if(i instanceof br)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new br(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new br(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Bd=2*Math.PI*Yh;function Ug(s){return Bd*Math.cos(s*Math.PI/180)}function Ju(s){return(180+s)/360}function au(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function lu(s,i){return s/Ug(i)}function xl(s){return 360*s-180}function xa(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Gg(s,i){return s*Ug(xa(i))}const wa=85.051129;function Zg(s){return 1/Math.cos(s*Math.PI/180)}class Xh{constructor(i,a,h=0){this.x=+i,this.y=+a,this.z=+h}static fromLngLat(i,a=0){const h=br.convert(i);return new Xh(Ju(h.lng),au(h.lat),lu(a,h.lat))}toLngLat(){return new br(xl(this.x),xa(this.y))}toAltitude(){return Gg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Bd*Zg(xa(this.y))}}function Vg(s,i,a,h,m,v,x,T,P){const O=(i+h)/2,V=(a+m)/2,$=new j(O,V);T($),function(tt,ot,ct,bt,zt,Jt){const le=ct-zt,Xt=bt-Jt;return Math.abs((bt-ot)*le-(ct-tt)*Xt)/Math.hypot(le,Xt)}($.x,$.y,v.x,v.y,x.x,x.y)>=P?(Vg(s,i,a,O,V,v,$,T,P),Vg(s,O,V,h,m,$,x,T,P)):s.push(x)}function Wg(s,i,a){let h=s[0],m=h.x,v=h.y;i(h);const x=[h];for(let T=1;T<s.length;T++){const P=s[T],{x:O,y:V}=P;i(P),Vg(x,m,v,O,V,h,P,i,a),m=O,v=V,h=P}return x}function Yg(s,i,a,h){if(h(i,a)){const m=i.add(a)._mult(.5);Yg(s,i,m,h),Yg(s,m,a,h)}else s.push(a)}function sw(s,i){let a=s[0];const h=[a];for(let m=1;m<s.length;m++){const v=s[m];Yg(h,a,v,i),a=v}return h}const Ku=Math.pow(2,14)-1,im=-Ku-1;function Xg(s,i){const a=Math.round(s.x*i),h=Math.round(s.y*i);return s.x=ie(a,im,Ku),s.y=ie(h,im,Ku),(a<s.x||a>s.x+1||h<s.y||h>s.y+1)&&cn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function Qu(s,i,a){const h=s.loadGeometry(),m=s.extent,v=xi/m;if(i&&a&&a.projection.isReprojectedInTileSpace){const x=1<<i.z,{scale:T,x:P,y:O,projection:V}=a,$=tt=>{const ot=xl((i.x+tt.x/m)/x),ct=xa((i.y+tt.y/m)/x),bt=V.project(ot,ct);tt.x=(bt.x*T-P)*m,tt.y=(bt.y*T-O)*m};for(let tt=0;tt<h.length;tt++)if(s.type!==1)h[tt]=Wg(h[tt],$,1);else{const ot=[];for(const ct of h[tt])ct.x<0||ct.x>=m||ct.y<0||ct.y>=m||($(ct),ot.push(ct));h[tt]=ot}}for(const x of h)for(const T of x)Xg(T,v);return h}function bc(s,i){return{type:s.type,id:s.id,properties:s.properties,geometry:i?Qu(s):[]}}function Xc(s,i,a,h,m){s.emplaceBack(2*i+(h+1)/2,2*a+(m+1)/2)}function Fi(s,i,a){s.emplaceBack(i.x,i.y,i.z,a[0]*16384,a[1]*16384,a[2]*16384)}class Pf{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.id),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new Dr,this.indexArray=new aa,this.segments=new cs,this.programConfigurations=new wc(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(i,a,h,m){const v=this.layers[0],x=[];let T=null;v.type==="circle"&&(T=v.layout.get("circle-sort-key"));for(const{feature:O,id:V,index:$,sourceLayerIndex:tt}of i){const ot=this.layers[0]._featureFilter.needGeometry,ct=bc(O,ot);if(!this.layers[0]._featureFilter.filter(new De(this.zoom),ct,h))continue;const bt=T?T.evaluate(ct,{},h):void 0,zt={id:V,properties:O.properties,type:O.type,sourceLayerIndex:tt,index:$,geometry:ot?ct.geometry:Qu(O,h,m),patterns:{},sortKey:bt};x.push(zt)}T&&x.sort((O,V)=>O.sortKey-V.sortKey);let P=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new mo,P=m.projection);for(const O of x){const{geometry:V,index:$,sourceLayerIndex:tt}=O,ot=i[$].feature;this.addFeature(O,V,$,a.availableImages,h,P),a.featureIndex.insert(ot,V,$,tt,this.index)}}update(i,a,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ow.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,xy.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,a,h,m,v,x){for(const T of a)for(const P of T){const O=P.x,V=P.y;if(O<0||O>=xi||V<0||V>=xi)continue;if(x){const ot=x.projectTilePoint(O,V,v),ct=x.upVector(v,O,V),bt=this.globeExtVertexArray;Fi(bt,ot,ct),Fi(bt,ot,ct),Fi(bt,ot,ct),Fi(bt,ot,ct)}const $=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),tt=$.vertexLength;Xc(this.layoutVertexArray,O,V,-1,-1),Xc(this.layoutVertexArray,O,V,1,-1),Xc(this.layoutVertexArray,O,V,1,1),Xc(this.layoutVertexArray,O,V,-1,1),this.indexArray.emplaceBack(tt,tt+1,tt+2),this.indexArray.emplaceBack(tt,tt+2,tt+3),$.vertexLength+=4,$.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,{},m,v)}}function rm(s,i){for(let a=0;a<s.length;a++)if($h(i,s[a]))return!0;for(let a=0;a<i.length;a++)if($h(s,i[a]))return!0;return!!om(s,i)}function Hh(s,i,a){return!!$h(s,i)||!!$g(i,s,a)}function wy(s,i){if(s.length===1)return qg(i,s[0]);for(let a=0;a<i.length;a++){const h=i[a];for(let m=0;m<h.length;m++)if($h(s,h[m]))return!0}for(let a=0;a<s.length;a++)if(qg(i,s[a]))return!0;for(let a=0;a<i.length;a++)if(om(s,i[a]))return!0;return!1}function Hg(s,i,a){if(s.length>1){if(om(s,i))return!0;for(let h=0;h<i.length;h++)if($g(i[h],s,a))return!0}for(let h=0;h<s.length;h++)if($g(s[h],i,a))return!0;return!1}function om(s,i){if(s.length===0||i.length===0)return!1;for(let a=0;a<s.length-1;a++){const h=s[a],m=s[a+1];for(let v=0;v<i.length-1;v++)if(Ka(h,m,i[v],i[v+1]))return!0}return!1}function Ka(s,i,a,h){return Un(s,a,h)!==Un(i,a,h)&&Un(s,i,a)!==Un(s,i,h)}function $g(s,i,a){const h=a*a;if(i.length===1)return s.distSqr(i[0])<h;for(let m=1;m<i.length;m++)if(by(s,i[m-1],i[m])<h)return!0;return!1}function by(s,i,a){const h=i.distSqr(a);if(h===0)return s.distSqr(i);const m=((s.x-i.x)*(a.x-i.x)+(s.y-i.y)*(a.y-i.y))/h;return s.distSqr(m<0?i:m>1?a:a.sub(i)._mult(m)._add(i))}function qg(s,i){let a,h,m,v=!1;for(let x=0;x<s.length;x++){a=s[x];for(let T=0,P=a.length-1;T<a.length;P=T++)h=a[T],m=a[P],h.y>i.y!=m.y>i.y&&i.x<(m.x-h.x)*(i.y-h.y)/(m.y-h.y)+h.x&&(v=!v)}return v}function $h(s,i){let a=!1;for(let h=0,m=s.length-1;h<s.length;m=h++){const v=s[h],x=s[m];v.y>i.y!=x.y>i.y&&i.x<(x.x-v.x)*(i.y-v.y)/(x.y-v.y)+v.x&&(a=!a)}return a}function Jg(s,i,a,h,m){for(const x of s)if(i<=x.x&&a<=x.y&&h>=x.x&&m>=x.y)return!0;const v=[new j(i,a),new j(i,m),new j(h,m),new j(h,a)];if(s.length>2){for(const x of v)if($h(s,x))return!0}for(let x=0;x<s.length-1;x++)if(aw(s[x],s[x+1],v))return!0;return!1}function aw(s,i,a){const h=a[0],m=a[2];if(s.x<h.x&&i.x<h.x||s.x>m.x&&i.x>m.x||s.y<h.y&&i.y<h.y||s.y>m.y&&i.y>m.y)return!1;const v=Un(s,i,a[0]);return v!==Un(s,i,a[1])||v!==Un(s,i,a[2])||v!==Un(s,i,a[3])}function zf(s,i,a){const h=i.paint.get(s).value;return h.kind==="constant"?h.value:a.programConfigurations.get(i.id).getMaxValue(s)}function sm(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Ic(s,i,a,h,m){if(!i[0]&&!i[1])return s;const v=j.convert(i)._mult(m);a==="viewport"&&v._rotate(-h);const x=[];for(let T=0;T<s.length;T++)x.push(s[T].sub(v));return x}function Qa(s,i,a,h){const m=j.convert(s)._mult(h);return i==="viewport"&&m._rotate(-a),m}Xn(Pf,"CircleBucket",{omit:["layers"]});const Kg=new fi({"circle-sort-key":new $e(Ke.layout_circle["circle-sort-key"])});var lw={paint:new fi({"circle-radius":new $e(Ke.paint_circle["circle-radius"]),"circle-color":new $e(Ke.paint_circle["circle-color"]),"circle-blur":new $e(Ke.paint_circle["circle-blur"]),"circle-opacity":new $e(Ke.paint_circle["circle-opacity"]),"circle-translate":new Ne(Ke.paint_circle["circle-translate"]),"circle-translate-anchor":new Ne(Ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ne(Ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ne(Ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new $e(Ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new $e(Ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new $e(Ke.paint_circle["circle-stroke-opacity"])}),layout:Kg},Df=1e-6,Rl=typeof Float32Array<"u"?Float32Array:Array;function Iy(){var s=new Rl(9);return Rl!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Nf(s,i,a){var h=i[0],m=i[1],v=i[2],x=i[3],T=i[4],P=i[5],O=i[6],V=i[7],$=i[8],tt=a[0],ot=a[1],ct=a[2],bt=a[3],zt=a[4],Jt=a[5],le=a[6],Xt=a[7],Qt=a[8];return s[0]=tt*h+ot*x+ct*O,s[1]=tt*m+ot*T+ct*V,s[2]=tt*v+ot*P+ct*$,s[3]=bt*h+zt*x+Jt*O,s[4]=bt*m+zt*T+Jt*V,s[5]=bt*v+zt*P+Jt*$,s[6]=le*h+Xt*x+Qt*O,s[7]=le*m+Xt*T+Qt*V,s[8]=le*v+Xt*P+Qt*$,s}function Su(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function am(s,i){var a=i[0],h=i[1],m=i[2],v=i[3],x=i[4],T=i[5],P=i[6],O=i[7],V=i[8],$=i[9],tt=i[10],ot=i[11],ct=i[12],bt=i[13],zt=i[14],Jt=i[15],le=a*T-h*x,Xt=a*P-m*x,Qt=a*O-v*x,ge=h*P-m*T,he=h*O-v*T,Xe=m*O-v*P,Ze=V*bt-$*ct,dn=V*zt-tt*ct,Dn=V*Jt-ot*ct,en=$*zt-tt*bt,_n=$*Jt-ot*bt,wn=tt*Jt-ot*zt,En=le*wn-Xt*_n+Qt*en+ge*Dn-he*dn+Xe*Ze;return En?(s[0]=(T*wn-P*_n+O*en)*(En=1/En),s[1]=(m*_n-h*wn-v*en)*En,s[2]=(bt*Xe-zt*he+Jt*ge)*En,s[3]=(tt*he-$*Xe-ot*ge)*En,s[4]=(P*Dn-x*wn-O*dn)*En,s[5]=(a*wn-m*Dn+v*dn)*En,s[6]=(zt*Qt-ct*Xe-Jt*Xt)*En,s[7]=(V*Xe-tt*Qt+ot*Xt)*En,s[8]=(x*_n-T*Dn+O*Ze)*En,s[9]=(h*Dn-a*_n-v*Ze)*En,s[10]=(ct*he-bt*Qt+Jt*le)*En,s[11]=($*Qt-V*he-ot*le)*En,s[12]=(T*dn-x*en-P*Ze)*En,s[13]=(a*en-h*dn+m*Ze)*En,s[14]=(bt*Xt-ct*ge-zt*le)*En,s[15]=(V*ge-$*Xt+tt*le)*En,s):null}function qh(s,i,a){var h=i[0],m=i[1],v=i[2],x=i[3],T=i[4],P=i[5],O=i[6],V=i[7],$=i[8],tt=i[9],ot=i[10],ct=i[11],bt=i[12],zt=i[13],Jt=i[14],le=i[15],Xt=a[0],Qt=a[1],ge=a[2],he=a[3];return s[0]=Xt*h+Qt*T+ge*$+he*bt,s[1]=Xt*m+Qt*P+ge*tt+he*zt,s[2]=Xt*v+Qt*O+ge*ot+he*Jt,s[3]=Xt*x+Qt*V+ge*ct+he*le,s[4]=(Xt=a[4])*h+(Qt=a[5])*T+(ge=a[6])*$+(he=a[7])*bt,s[5]=Xt*m+Qt*P+ge*tt+he*zt,s[6]=Xt*v+Qt*O+ge*ot+he*Jt,s[7]=Xt*x+Qt*V+ge*ct+he*le,s[8]=(Xt=a[8])*h+(Qt=a[9])*T+(ge=a[10])*$+(he=a[11])*bt,s[9]=Xt*m+Qt*P+ge*tt+he*zt,s[10]=Xt*v+Qt*O+ge*ot+he*Jt,s[11]=Xt*x+Qt*V+ge*ct+he*le,s[12]=(Xt=a[12])*h+(Qt=a[13])*T+(ge=a[14])*$+(he=a[15])*bt,s[13]=Xt*m+Qt*P+ge*tt+he*zt,s[14]=Xt*v+Qt*O+ge*ot+he*Jt,s[15]=Xt*x+Qt*V+ge*ct+he*le,s}function Fd(s,i,a){var h,m,v,x,T,P,O,V,$,tt,ot,ct,bt=a[0],zt=a[1],Jt=a[2];return i===s?(s[12]=i[0]*bt+i[4]*zt+i[8]*Jt+i[12],s[13]=i[1]*bt+i[5]*zt+i[9]*Jt+i[13],s[14]=i[2]*bt+i[6]*zt+i[10]*Jt+i[14],s[15]=i[3]*bt+i[7]*zt+i[11]*Jt+i[15]):(m=i[1],v=i[2],x=i[3],T=i[4],P=i[5],O=i[6],V=i[7],$=i[8],tt=i[9],ot=i[10],ct=i[11],s[0]=h=i[0],s[1]=m,s[2]=v,s[3]=x,s[4]=T,s[5]=P,s[6]=O,s[7]=V,s[8]=$,s[9]=tt,s[10]=ot,s[11]=ct,s[12]=h*bt+T*zt+$*Jt+i[12],s[13]=m*bt+P*zt+tt*Jt+i[13],s[14]=v*bt+O*zt+ot*Jt+i[14],s[15]=x*bt+V*zt+ct*Jt+i[15]),s}function Jh(s,i,a){var h=a[0],m=a[1],v=a[2];return s[0]=i[0]*h,s[1]=i[1]*h,s[2]=i[2]*h,s[3]=i[3]*h,s[4]=i[4]*m,s[5]=i[5]*m,s[6]=i[6]*m,s[7]=i[7]*m,s[8]=i[8]*v,s[9]=i[9]*v,s[10]=i[10]*v,s[11]=i[11]*v,s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s}function Qg(s,i,a){var h=Math.sin(a),m=Math.cos(a),v=i[4],x=i[5],T=i[6],P=i[7],O=i[8],V=i[9],$=i[10],tt=i[11];return i!==s&&(s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[4]=v*m+O*h,s[5]=x*m+V*h,s[6]=T*m+$*h,s[7]=P*m+tt*h,s[8]=O*m-v*h,s[9]=V*m-x*h,s[10]=$*m-T*h,s[11]=tt*m-P*h,s}function jd(s,i,a){var h=Math.sin(a),m=Math.cos(a),v=i[0],x=i[1],T=i[2],P=i[3],O=i[8],V=i[9],$=i[10],tt=i[11];return i!==s&&(s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=v*m-O*h,s[1]=x*m-V*h,s[2]=T*m-$*h,s[3]=P*m-tt*h,s[8]=v*h+O*m,s[9]=x*h+V*m,s[10]=T*h+$*m,s[11]=P*h+tt*m,s}function t_(s,i){return s[0]=i[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=i[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=i[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Cy(s,i,a){var h,m,v,x=a[0],T=a[1],P=a[2],O=Math.hypot(x,T,P);return O<Df?null:(x*=O=1/O,T*=O,P*=O,h=Math.sin(i),m=Math.cos(i),s[0]=x*x*(v=1-m)+m,s[1]=T*x*v+P*h,s[2]=P*x*v-T*h,s[3]=0,s[4]=x*T*v-P*h,s[5]=T*T*v+m,s[6]=P*T*v+x*h,s[7]=0,s[8]=x*P*v+T*h,s[9]=T*P*v-x*h,s[10]=P*P*v+m,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}Math.hypot||(Math.hypot=function(){for(var s=0,i=arguments.length;i--;)s+=arguments[i]*arguments[i];return Math.sqrt(s)});var e_=qh;function lm(){var s=new Rl(3);return Rl!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Of(s){var i=new Rl(3);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i}function Kh(s){return Math.hypot(s[0],s[1],s[2])}function Qh(s,i,a){var h=new Rl(3);return h[0]=s,h[1]=i,h[2]=a,h}function Cc(s,i,a){return s[0]=i[0]+a[0],s[1]=i[1]+a[1],s[2]=i[2]+a[2],s}function Rf(s,i,a){return s[0]=i[0]-a[0],s[1]=i[1]-a[1],s[2]=i[2]-a[2],s}function n_(s,i,a){return s[0]=i[0]*a[0],s[1]=i[1]*a[1],s[2]=i[2]*a[2],s}function Bl(s,i,a){return s[0]=Math.min(i[0],a[0]),s[1]=Math.min(i[1],a[1]),s[2]=Math.min(i[2],a[2]),s}function tc(s,i,a){return s[0]=Math.max(i[0],a[0]),s[1]=Math.max(i[1],a[1]),s[2]=Math.max(i[2],a[2]),s}function uu(s,i,a){return s[0]=i[0]*a,s[1]=i[1]*a,s[2]=i[2]*a,s}function Bf(s,i,a,h){return s[0]=i[0]+a[0]*h,s[1]=i[1]+a[1]*h,s[2]=i[2]+a[2]*h,s}function tl(s,i){var a=i[0],h=i[1],m=i[2],v=a*a+h*h+m*m;return v>0&&(v=1/Math.sqrt(v)),s[0]=i[0]*v,s[1]=i[1]*v,s[2]=i[2]*v,s}function Eu(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]}function i_(s,i,a){var h=i[0],m=i[1],v=i[2],x=a[0],T=a[1],P=a[2];return s[0]=m*P-v*T,s[1]=v*x-h*P,s[2]=h*T-m*x,s}function os(s,i,a){var h=i[0],m=i[1],v=i[2],x=a[3]*h+a[7]*m+a[11]*v+a[15];return s[0]=(a[0]*h+a[4]*m+a[8]*v+a[12])/(x=x||1),s[1]=(a[1]*h+a[5]*m+a[9]*v+a[13])/x,s[2]=(a[2]*h+a[6]*m+a[10]*v+a[14])/x,s}function Ay(s,i,a){var h=a[0],m=a[1],v=a[2],x=i[0],T=i[1],P=i[2],O=m*P-v*T,V=v*x-h*P,$=h*T-m*x,tt=m*$-v*V,ot=v*O-h*$,ct=h*V-m*O,bt=2*a[3];return V*=bt,$*=bt,ot*=2,ct*=2,s[0]=x+(O*=bt)+(tt*=2),s[1]=T+V+ot,s[2]=P+$+ct,s}var Ud,ec=Rf,uw=n_,cw=Kh;function Ty(s,i,a){return s[0]=i[0]*a,s[1]=i[1]*a,s[2]=i[2]*a,s[3]=i[3]*a,s}function Sy(s,i){var a=i[0],h=i[1],m=i[2],v=i[3],x=a*a+h*h+m*m+v*v;return x>0&&(x=1/Math.sqrt(x)),s[0]=a*x,s[1]=h*x,s[2]=m*x,s[3]=v*x,s}function vh(s,i,a){var h=i[0],m=i[1],v=i[2],x=i[3];return s[0]=a[0]*h+a[4]*m+a[8]*v+a[12]*x,s[1]=a[1]*h+a[5]*m+a[9]*v+a[13]*x,s[2]=a[2]*h+a[6]*m+a[10]*v+a[14]*x,s[3]=a[3]*h+a[7]*m+a[11]*v+a[15]*x,s}function r_(){var s=new Rl(4);return Rl!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function o_(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function Ey(s,i,a){a*=.5;var h=i[0],m=i[1],v=i[2],x=i[3],T=Math.sin(a),P=Math.cos(a);return s[0]=h*P+x*T,s[1]=m*P+v*T,s[2]=v*P-m*T,s[3]=x*P-h*T,s}function My(s,i,a){a*=.5;var h=i[0],m=i[1],v=i[2],x=i[3],T=Math.sin(a),P=Math.cos(a);return s[0]=h*P-v*T,s[1]=m*P+x*T,s[2]=v*P+h*T,s[3]=x*P-m*T,s}lm(),Ud=new Rl(4),Rl!=Float32Array&&(Ud[0]=0,Ud[1]=0,Ud[2]=0,Ud[3]=0);var hw=Sy;lm(),Qh(1,0,0),Qh(0,1,0),r_(),r_(),Iy();class um{constructor(i,a){this.pos=i,this.dir=a}intersectsPlane(i,a,h){const m=Eu(a,this.dir);if(Math.abs(m)<1e-6)return!1;const v=((i[0]-this.pos[0])*a[0]+(i[1]-this.pos[1])*a[1]+(i[2]-this.pos[2])*a[2])/m;return h[0]=this.pos[0]+this.dir[0]*v,h[1]=this.pos[1]+this.dir[1]*v,h[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(i,a,h){if(function(ot,ct){var bt=ot[0],zt=ot[1],Jt=ot[2],le=ct[0],Xt=ct[1],Qt=ct[2];return Math.abs(bt-le)<=Df*Math.max(1,Math.abs(bt),Math.abs(le))&&Math.abs(zt-Xt)<=Df*Math.max(1,Math.abs(zt),Math.abs(Xt))&&Math.abs(Jt-Qt)<=Df*Math.max(1,Math.abs(Jt),Math.abs(Qt))}(this.pos,i)||a===0)return h[0]=h[1]=h[2]=0,!1;const[m,v,x]=this.dir,T=this.pos[0]-i[0],P=this.pos[1]-i[1],O=this.pos[2]-i[2],V=m*m+v*v+x*x,$=2*(T*m+P*v+O*x),tt=$*$-4*V*(T*T+P*P+O*O-a*a);if(tt<0){const ot=Math.max(-$/2,0),ct=T+m*ot,bt=P+v*ot,zt=O+x*ot,Jt=Math.hypot(ct,bt,zt);return h[0]=ct*a/Jt,h[1]=bt*a/Jt,h[2]=zt*a/Jt,!1}{const ot=(-$-Math.sqrt(tt))/(2*V);if(ot<0){const ct=Math.hypot(T,P,O);return h[0]=T*a/ct,h[1]=P*a/ct,h[2]=O*a/ct,!1}return h[0]=T+m*ot,h[1]=P+v*ot,h[2]=O+x*ot,!0}}}class s_{constructor(i,a,h,m,v){this.TL=i,this.TR=a,this.BR=h,this.BL=m,this.horizon=v}static fromInvProjectionMatrix(i,a,h){const m=[-1,1,1],v=[1,1,1],x=[1,-1,1],T=[-1,-1,1],P=os(m,m,i),O=os(v,v,i),V=os(x,x,i),$=os(T,T,i);return new s_(P,O,V,$,a/h)}}class a_{constructor(i,a){this.points=i,this.planes=a}static fromInvProjectionMatrix(i,a,h,m){const v=Math.pow(2,h),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const O=vh([],P,i),V=1/O[3]/a*v;return function($,tt,ot){return $[0]=tt[0]*ot[0],$[1]=tt[1]*ot[1],$[2]=tt[2]*ot[2],$[3]=tt[3]*ot[3],$}(O,O,[V,V,m?1/O[3]:V,V])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const O=tl([],i_([],ec([],x[P[0]],x[P[1]]),ec([],x[P[2]],x[P[1]]))),V=-Eu(O,x[P[1]]);return O.concat(V)});return new a_(x,T)}}class el{static fromPoints(i){const a=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const m of i)Bl(a,a,m),tc(h,h,m);return new el(a,h)}static applyTransform(i,a){const h=i.getCorners();for(let m=0;m<h.length;++m)os(h[m],h[m],a);return el.fromPoints(h)}constructor(i,a){this.min=i,this.max=a,this.center=uu([],Cc([],this.min,this.max),.5)}quadrant(i){const a=[i%2==0,i<2],h=Of(this.min),m=Of(this.max);for(let v=0;v<a.length;v++)h[v]=a[v]?this.min[v]:this.center[v],m[v]=a[v]?this.center[v]:this.max[v];return m[2]=this.max[2],new el(h,m)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,a=this.max;return[[i[0],i[1],i[2]],[a[0],i[1],i[2]],[a[0],a[1],i[2]],[i[0],a[1],i[2]],[i[0],i[1],a[2]],[a[0],i[1],a[2]],[a[0],a[1],a[2]],[i[0],a[1],a[2]]]}intersects(i){const a=this.getCorners();let h=!0;for(let m=0;m<i.planes.length;m++){const v=i.planes[m];let x=0;for(let T=0;T<a.length;T++)x+=Eu(v,a[T])+v[3]>=0;if(x===0)return 0;x!==a.length&&(h=!1)}if(h)return 2;for(let m=0;m<3;m++){let v=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let T=0;T<i.points.length;T++){const P=i.points[T][m]-this.min[m];v=Math.min(v,P),x=Math.max(x,P)}if(x<0||v>this.max[m]-this.min[m])return 0}return 1}}function Ly(s,i,a,h,m,v,x,T,P){if(v&&s.queryGeometry.isAboveHorizon)return!1;v&&(P*=s.pixelToTileUnitsFactor);const O=s.tileID.canonical,V=a.projection.upVectorScale(O,a.center.lat,a.worldSize).metersToTile;for(const $ of i)for(const tt of $){const ot=tt.add(T),ct=m&&a.elevation?a.elevation.exaggeration()*m.getElevationAt(ot.x,ot.y,!0):0,bt=a.projection.projectTilePoint(ot.x,ot.y,O);if(ct>0){const Xt=a.projection.upVector(O,ot.x,ot.y);bt.x+=Xt[0]*V*ct,bt.y+=Xt[1]*V*ct,bt.z+=Xt[2]*V*ct}const zt=v?ot:fw(bt.x,bt.y,bt.z,h),Jt=v?s.tilespaceRays.map(Xt=>dw(Xt,ct)):s.queryGeometry.screenGeometry,le=vh([],[bt.x,bt.y,bt.z,1],h);if(!x&&v?P*=le[3]/a.cameraToCenterDistance:x&&!v&&(P*=a.cameraToCenterDistance/le[3]),v){const Xt=xa((tt.y/xi+O.y)/(1<<O.z));P/=a.projection.pixelsPerMeter(Xt,1)/lu(1,Xt)}if(Hh(Jt,zt,P))return!0}return!1}function fw(s,i,a,h){const m=vh([],[s,i,a,1],h);return new j(m[0]/m[3],m[1]/m[3])}const ky=Qh(0,0,0),Mu=Qh(0,0,1);function dw(s,i){const a=lm();return ky[2]=i,s.intersectsPlane(ky,Mu,a),new j(a[0],a[1])}class Py extends Pf{}function zy(s,{width:i,height:a},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==i*a*h)throw new RangeError("mismatched image size")}else m=new Uint8Array(i*a*h);return s.width=i,s.height=a,s.data=m,s}function l_(s,i,a){const{width:h,height:m}=i;h===s.width&&m===s.height||(u_(s,i,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,h),height:Math.min(s.height,m)},a),s.width=h,s.height=m,s.data=i.data)}function u_(s,i,a,h,m,v){if(m.width===0||m.height===0)return i;if(m.width>s.width||m.height>s.height||a.x>s.width-m.width||a.y>s.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>i.width||m.height>i.height||h.x>i.width-m.width||h.y>i.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,T=i.data;for(let P=0;P<m.height;P++){const O=((a.y+P)*s.width+a.x)*v,V=((h.y+P)*i.width+h.x)*v;for(let $=0;$<m.width*v;$++)T[V+$]=x[O+$]}return i}Xn(Py,"HeatmapBucket",{omit:["layers"]});class Hc{constructor(i,a){zy(this,i,1,a)}resize(i){l_(this,new Hc(i),1)}clone(){return new Hc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,a,h,m,v){u_(i,a,h,m,v,1)}}class Fl{constructor(i,a){zy(this,i,4,a)}resize(i){l_(this,new Fl(i),4)}replace(i,a){a?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Fl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,a,h,m,v){u_(i,a,h,m,v,4)}}Xn(Hc,"AlphaImage"),Xn(Fl,"RGBAImage");var pw={paint:new fi({"heatmap-radius":new $e(Ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new $e(Ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ne(Ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ri(Ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ne(Ke.paint_heatmap["heatmap-opacity"])})};function Gd(s){const i={},a=s.resolution||256,h=s.clips?s.clips.length:1,m=s.image||new Fl({width:a,height:h}),v=(x,T,P)=>{i[s.evaluationKey]=P;const O=s.expression.evaluate(i);m.data[x+T+0]=Math.floor(255*O.r/O.a),m.data[x+T+1]=Math.floor(255*O.g/O.a),m.data[x+T+2]=Math.floor(255*O.b/O.a),m.data[x+T+3]=Math.floor(255*O.a)};if(s.clips)for(let x=0,T=0;x<h;++x,T+=4*a)for(let P=0,O=0;P<a;P++,O+=4){const V=P/(a-1),{start:$,end:tt}=s.clips[x];v(T,O,$*(1-V)+tt*V)}else for(let x=0,T=0;x<a;x++,T+=4)v(0,T,x/(a-1));return m}var mw={paint:new fi({"hillshade-illumination-direction":new Ne(Ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ne(Ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ne(Ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ne(Ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ne(Ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ne(Ke.paint_hillshade["hillshade-accent-color"])})};const gw=Kn([{name:"a_pos",components:2,type:"Int16"}],4),{members:_w}=gw;var Zd={exports:{}};function cm(s,i,a){a=a||2;var h,m,v,x,T,P,O,V=i&&i.length,$=V?i[0]*a:s.length,tt=Dy(s,0,$,a,!0),ot=[];if(!tt||tt.next===tt.prev)return ot;if(V&&(tt=function(bt,zt,Jt,le){var Xt,Qt,ge,he=[];for(Xt=0,Qt=zt.length;Xt<Qt;Xt++)(ge=Dy(bt,zt[Xt]*le,Xt<Qt-1?zt[Xt+1]*le:bt.length,le,!1))===ge.next&&(ge.steiner=!0),he.push(Aw(ge));for(he.sort(bw),Xt=0;Xt<he.length;Xt++)Jt=Iw(he[Xt],Jt);return Jt}(s,i,tt,a)),s.length>80*a){h=v=s[0],m=x=s[1];for(var ct=a;ct<$;ct+=a)(T=s[ct])<h&&(h=T),(P=s[ct+1])<m&&(m=P),T>v&&(v=T),P>x&&(x=P);O=(O=Math.max(v-h,x-m))!==0?32767/O:0}return Vd(tt,ot,a,h,m,O,0),ot}function Dy(s,i,a,h,m){var v,x;if(m===d_(s,i,a,h)>0)for(v=i;v<a;v+=h)x=Oy(v,s[v],s[v+1],x);else for(v=a-h;v>=i;v-=h)x=Oy(v,s[v],s[v+1],x);return x&&jf(x,x.next)&&(Yd(x),x=x.next),x}function tf(s,i){if(!s)return s;i||(i=s);var a,h=s;do if(a=!1,h.steiner||!jf(h,h.next)&&hs(h.prev,h,h.next)!==0)h=h.next;else{if(Yd(h),(h=i=h.prev)===h.next)break;a=!0}while(a||h!==i);return i}function Vd(s,i,a,h,m,v,x){if(s){!x&&v&&function(V,$,tt,ot){var ct=V;do ct.z===0&&(ct.z=c_(ct.x,ct.y,$,tt,ot)),ct.prevZ=ct.prev,ct.nextZ=ct.next,ct=ct.next;while(ct!==V);ct.prevZ.nextZ=null,ct.prevZ=null,function(bt){var zt,Jt,le,Xt,Qt,ge,he,Xe,Ze=1;do{for(Jt=bt,bt=null,Qt=null,ge=0;Jt;){for(ge++,le=Jt,he=0,zt=0;zt<Ze&&(he++,le=le.nextZ);zt++);for(Xe=Ze;he>0||Xe>0&&le;)he!==0&&(Xe===0||!le||Jt.z<=le.z)?(Xt=Jt,Jt=Jt.nextZ,he--):(Xt=le,le=le.nextZ,Xe--),Qt?Qt.nextZ=Xt:bt=Xt,Xt.prevZ=Qt,Qt=Xt;Jt=le}Qt.nextZ=null,Ze*=2}while(ge>1)}(ct)}(s,h,m,v);for(var T,P,O=s;s.prev!==s.next;)if(T=s.prev,P=s.next,v?yw(s,h,m,v):vw(s))i.push(T.i/a|0),i.push(s.i/a|0),i.push(P.i/a|0),Yd(s),s=P.next,O=P.next;else if((s=P)===O){x?x===1?Vd(s=xw(tf(s),i,a),i,a,h,m,v,2):x===2&&ww(s,i,a,h,m,v):Vd(tf(s),i,a,h,m,v,1);break}}}function vw(s){var i=s.prev,a=s,h=s.next;if(hs(i,a,h)>=0)return!1;for(var m=i.x,v=a.x,x=h.x,T=i.y,P=a.y,O=h.y,V=m<v?m<x?m:x:v<x?v:x,$=T<P?T<O?T:O:P<O?P:O,tt=m>v?m>x?m:x:v>x?v:x,ot=T>P?T>O?T:O:P>O?P:O,ct=h.next;ct!==i;){if(ct.x>=V&&ct.x<=tt&&ct.y>=$&&ct.y<=ot&&Ff(m,T,v,P,x,O,ct.x,ct.y)&&hs(ct.prev,ct,ct.next)>=0)return!1;ct=ct.next}return!0}function yw(s,i,a,h){var m=s.prev,v=s,x=s.next;if(hs(m,v,x)>=0)return!1;for(var T=m.x,P=v.x,O=x.x,V=m.y,$=v.y,tt=x.y,ot=T<P?T<O?T:O:P<O?P:O,ct=V<$?V<tt?V:tt:$<tt?$:tt,bt=T>P?T>O?T:O:P>O?P:O,zt=V>$?V>tt?V:tt:$>tt?$:tt,Jt=c_(ot,ct,i,a,h),le=c_(bt,zt,i,a,h),Xt=s.prevZ,Qt=s.nextZ;Xt&&Xt.z>=Jt&&Qt&&Qt.z<=le;){if(Xt.x>=ot&&Xt.x<=bt&&Xt.y>=ct&&Xt.y<=zt&&Xt!==m&&Xt!==x&&Ff(T,V,P,$,O,tt,Xt.x,Xt.y)&&hs(Xt.prev,Xt,Xt.next)>=0||(Xt=Xt.prevZ,Qt.x>=ot&&Qt.x<=bt&&Qt.y>=ct&&Qt.y<=zt&&Qt!==m&&Qt!==x&&Ff(T,V,P,$,O,tt,Qt.x,Qt.y)&&hs(Qt.prev,Qt,Qt.next)>=0))return!1;Qt=Qt.nextZ}for(;Xt&&Xt.z>=Jt;){if(Xt.x>=ot&&Xt.x<=bt&&Xt.y>=ct&&Xt.y<=zt&&Xt!==m&&Xt!==x&&Ff(T,V,P,$,O,tt,Xt.x,Xt.y)&&hs(Xt.prev,Xt,Xt.next)>=0)return!1;Xt=Xt.prevZ}for(;Qt&&Qt.z<=le;){if(Qt.x>=ot&&Qt.x<=bt&&Qt.y>=ct&&Qt.y<=zt&&Qt!==m&&Qt!==x&&Ff(T,V,P,$,O,tt,Qt.x,Qt.y)&&hs(Qt.prev,Qt,Qt.next)>=0)return!1;Qt=Qt.nextZ}return!0}function xw(s,i,a){var h=s;do{var m=h.prev,v=h.next.next;!jf(m,v)&&h_(m,h,h.next,v)&&Wd(m,v)&&Wd(v,m)&&(i.push(m.i/a|0),i.push(h.i/a|0),i.push(v.i/a|0),Yd(h),Yd(h.next),h=s=v),h=h.next}while(h!==s);return tf(h)}function ww(s,i,a,h,m,v){var x=s;do{for(var T=x.next.next;T!==x.prev;){if(x.i!==T.i&&Tw(x,T)){var P=Ny(x,T);return x=tf(x,x.next),P=tf(P,P.next),Vd(x,i,a,h,m,v,0),void Vd(P,i,a,h,m,v,0)}T=T.next}x=x.next}while(x!==s)}function bw(s,i){return s.x-i.x}function Iw(s,i){var a=function(m,v){var x,T=v,P=m.x,O=m.y,V=-1/0;do{if(O<=T.y&&O>=T.next.y&&T.next.y!==T.y){var $=T.x+(O-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if($<=P&&$>V&&(V=$,x=T.x<T.next.x?T:T.next,$===P))return x}T=T.next}while(T!==v);if(!x)return null;var tt,ot=x,ct=x.x,bt=x.y,zt=1/0;T=x;do P>=T.x&&T.x>=ct&&P!==T.x&&Ff(O<bt?P:V,O,ct,bt,O<bt?V:P,O,T.x,T.y)&&(tt=Math.abs(O-T.y)/(P-T.x),Wd(T,m)&&(tt<zt||tt===zt&&(T.x>x.x||T.x===x.x&&Cw(x,T)))&&(x=T,zt=tt)),T=T.next;while(T!==ot);return x}(s,i);if(!a)return i;var h=Ny(a,s);return tf(h,h.next),tf(a,a.next)}function Cw(s,i){return hs(s.prev,s,i.prev)<0&&hs(i.next,s,s.next)<0}function c_(s,i,a,h,m){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-h)*m|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Aw(s){var i=s,a=s;do(i.x<a.x||i.x===a.x&&i.y<a.y)&&(a=i),i=i.next;while(i!==s);return a}function Ff(s,i,a,h,m,v,x,T){return(m-x)*(i-T)>=(s-x)*(v-T)&&(s-x)*(h-T)>=(a-x)*(i-T)&&(a-x)*(v-T)>=(m-x)*(h-T)}function Tw(s,i){return s.next.i!==i.i&&s.prev.i!==i.i&&!function(a,h){var m=a;do{if(m.i!==a.i&&m.next.i!==a.i&&m.i!==h.i&&m.next.i!==h.i&&h_(m,m.next,a,h))return!0;m=m.next}while(m!==a);return!1}(s,i)&&(Wd(s,i)&&Wd(i,s)&&function(a,h){var m=a,v=!1,x=(a.x+h.x)/2,T=(a.y+h.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&x<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(v=!v),m=m.next;while(m!==a);return v}(s,i)&&(hs(s.prev,s,i.prev)||hs(s,i.prev,i))||jf(s,i)&&hs(s.prev,s,s.next)>0&&hs(i.prev,i,i.next)>0)}function hs(s,i,a){return(i.y-s.y)*(a.x-i.x)-(i.x-s.x)*(a.y-i.y)}function jf(s,i){return s.x===i.x&&s.y===i.y}function h_(s,i,a,h){var m=fm(hs(s,i,a)),v=fm(hs(s,i,h)),x=fm(hs(a,h,s)),T=fm(hs(a,h,i));return m!==v&&x!==T||!(m!==0||!hm(s,a,i))||!(v!==0||!hm(s,h,i))||!(x!==0||!hm(a,s,h))||!(T!==0||!hm(a,i,h))}function hm(s,i,a){return i.x<=Math.max(s.x,a.x)&&i.x>=Math.min(s.x,a.x)&&i.y<=Math.max(s.y,a.y)&&i.y>=Math.min(s.y,a.y)}function fm(s){return s>0?1:s<0?-1:0}function Wd(s,i){return hs(s.prev,s,s.next)<0?hs(s,i,s.next)>=0&&hs(s,s.prev,i)>=0:hs(s,i,s.prev)<0||hs(s,s.next,i)<0}function Ny(s,i){var a=new f_(s.i,s.x,s.y),h=new f_(i.i,i.x,i.y),m=s.next,v=i.prev;return s.next=i,i.prev=s,a.next=m,m.prev=a,h.next=a,a.prev=h,v.next=h,h.prev=v,h}function Oy(s,i,a,h){var m=new f_(s,i,a);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function Yd(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function f_(s,i,a){this.i=s,this.x=i,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function d_(s,i,a,h){for(var m=0,v=i,x=a-h;v<a;v+=h)m+=(s[x]-s[v])*(s[v+1]+s[x+1]),x=v;return m}function Ry(s,i,a,h,m){By(s,i,a||0,h||s.length-1,m||Sw)}function By(s,i,a,h,m){for(;h>a;){if(h-a>600){var v=h-a+1,x=i-a+1,T=Math.log(v),P=.5*Math.exp(2*T/3),O=.5*Math.sqrt(T*P*(v-P)/v)*(x-v/2<0?-1:1);By(s,i,Math.max(a,Math.floor(i-x*P/v+O)),Math.min(h,Math.floor(i+(v-x)*P/v+O)),m)}var V=s[i],$=a,tt=h;for(yh(s,a,i),m(s[h],V)>0&&yh(s,a,h);$<tt;){for(yh(s,$,tt),$++,tt--;m(s[$],V)<0;)$++;for(;m(s[tt],V)>0;)tt--}m(s[a],V)===0?yh(s,a,tt):yh(s,++tt,h),tt<=i&&(a=tt+1),i<=tt&&(h=tt-1)}}function yh(s,i,a){var h=s[i];s[i]=s[a],s[a]=h}function Sw(s,i){return s<i?-1:s>i?1:0}function p_(s,i){const a=s.length;if(a<=1)return[s];const h=[];let m,v;for(let x=0;x<a;x++){const T=R(s[x]);T!==0&&(s[x].area=Math.abs(T),v===void 0&&(v=T<0),v===T<0?(m&&h.push(m),m=[s[x]]):m.push(s[x]))}if(m&&h.push(m),i>1)for(let x=0;x<h.length;x++)h[x].length<=i||(Ry(h[x],i,1,h[x].length-1,Ew),h[x]=h[x].slice(0,i));return h}function Ew(s,i){return i.area-s.area}function m_(s,i,a){const h=a.patternDependencies;let m=!1;for(const v of i){const x=v.paint.get(`${s}-pattern`);x.isConstant()||(m=!0);const T=x.constantOr(null);T&&(m=!0,h[T]=!0)}return m}function g_(s,i,a,h,m){const v=m.patternDependencies;for(const x of i){const T=x.paint.get(`${s}-pattern`).value;if(T.kind!=="constant"){let P=T.evaluate({zoom:h},a,{},m.availableImages);P=P&&P.name?P.name:P,v[P]=!0,a.patterns[x.id]=P}}return a}Zd.exports=cm,Zd.exports.default=cm,cm.deviation=function(s,i,a,h){var m=i&&i.length,v=Math.abs(d_(s,0,m?i[0]*a:s.length,a));if(m)for(var x=0,T=i.length;x<T;x++)v-=Math.abs(d_(s,i[x]*a,x<T-1?i[x+1]*a:s.length,a));var P=0;for(x=0;x<h.length;x+=3){var O=h[x]*a,V=h[x+1]*a,$=h[x+2]*a;P+=Math.abs((s[O]-s[$])*(s[V+1]-s[O+1])-(s[O]-s[V])*(s[$+1]-s[O+1]))}return v===0&&P===0?0:Math.abs((P-v)/v)},cm.flatten=function(s){for(var i=s[0][0].length,a={vertices:[],holes:[],dimensions:i},h=0,m=0;m<s.length;m++){for(var v=0;v<s[m].length;v++)for(var x=0;x<i;x++)a.vertices.push(s[m][v][x]);m>0&&a.holes.push(h+=s[m-1].length)}return a};class dm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Dr,this.indexArray=new aa,this.indexArray2=new Tu,this.programConfigurations=new wc(i.layers,i.zoom),this.segments=new cs,this.segments2=new cs,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=i.projection}populate(i,a,h,m){this.hasPattern=m_("fill",this.layers,a);const v=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:T,id:P,index:O,sourceLayerIndex:V}of i){const $=this.layers[0]._featureFilter.needGeometry,tt=bc(T,$);if(!this.layers[0]._featureFilter.filter(new De(this.zoom),tt,h))continue;const ot=v?v.evaluate(tt,{},h,a.availableImages):void 0,ct={id:P,properties:T.properties,type:T.type,sourceLayerIndex:V,index:O,geometry:$?tt.geometry:Qu(T,h,m),patterns:{},sortKey:ot};x.push(ct)}v&&x.sort((T,P)=>T.sortKey-P.sortKey);for(const T of x){const{geometry:P,index:O,sourceLayerIndex:V}=T;if(this.hasPattern){const $=g_("fill",this.layers,T,this.zoom,a);this.patternFeatures.push($)}else this.addFeature(T,P,O,h,{},a.availableImages);a.featureIndex.insert(i[O].feature,P,O,V,this.index)}}update(i,a,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,h,m)}addFeatures(i,a,h,m,v){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,a,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,_w),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,a,h,m,v,x=[]){for(const T of p_(a,500)){let P=0;for(const ct of T)P+=ct.length;const O=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),V=O.vertexLength,$=[],tt=[];for(const ct of T){if(ct.length===0)continue;ct!==T[0]&&tt.push($.length/2);const bt=this.segments2.prepareSegment(ct.length,this.layoutVertexArray,this.indexArray2),zt=bt.vertexLength;this.layoutVertexArray.emplaceBack(ct[0].x,ct[0].y),this.indexArray2.emplaceBack(zt+ct.length-1,zt),$.push(ct[0].x),$.push(ct[0].y);for(let Jt=1;Jt<ct.length;Jt++)this.layoutVertexArray.emplaceBack(ct[Jt].x,ct[Jt].y),this.indexArray2.emplaceBack(zt+Jt-1,zt+Jt),$.push(ct[Jt].x),$.push(ct[Jt].y);bt.vertexLength+=ct.length,bt.primitiveLength+=ct.length}const ot=Zd.exports($,tt);for(let ct=0;ct<ot.length;ct+=3)this.indexArray.emplaceBack(V+ot[ct],V+ot[ct+1],V+ot[ct+2]);O.vertexLength+=P,O.primitiveLength+=ot.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,v,x,m)}}Xn(dm,"FillBucket",{omit:["layers","patternFeatures"]});const Mw=new fi({"fill-sort-key":new $e(Ke.layout_fill["fill-sort-key"])});var Lw={paint:new fi({"fill-antialias":new Ne(Ke.paint_fill["fill-antialias"]),"fill-opacity":new $e(Ke.paint_fill["fill-opacity"]),"fill-color":new $e(Ke.paint_fill["fill-color"]),"fill-outline-color":new $e(Ke.paint_fill["fill-outline-color"]),"fill-translate":new Ne(Ke.paint_fill["fill-translate"]),"fill-translate-anchor":new Ne(Ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new $e(Ke.paint_fill["fill-pattern"])}),layout:Mw};const kw=Kn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Pw=Kn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),zw=Kn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Dw}=kw;var pm={},Nw=j,Fy=Uf;function Uf(s,i,a,h,m){this.properties={},this.extent=a,this.type=0,this._pbf=s,this._geometry=-1,this._keys=h,this._values=m,s.readFields(jy,this,i)}function jy(s,i,a){s==1?i.id=a.readVarint():s==2?function(h,m){for(var v=h.readVarint()+h.pos;h.pos<v;){var x=m._keys[h.readVarint()],T=m._values[h.readVarint()];m.properties[x]=T}}(a,i):s==3?i.type=a.readVarint():s==4&&(i._geometry=a.pos)}function Uy(s){for(var i,a,h=0,m=0,v=s.length,x=v-1;m<v;x=m++)h+=((a=s[x]).x-(i=s[m]).x)*(i.y+a.y);return h}Uf.types=["Unknown","Point","LineString","Polygon"],Uf.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var i,a=s.readVarint()+s.pos,h=1,m=0,v=0,x=0,T=[];s.pos<a;){if(m<=0){var P=s.readVarint();h=7&P,m=P>>3}if(m--,h===1||h===2)v+=s.readSVarint(),x+=s.readSVarint(),h===1&&(i&&T.push(i),i=[]),i.push(new Nw(v,x));else{if(h!==7)throw new Error("unknown command "+h);i&&i.push(i[0].clone())}}return i&&T.push(i),T},Uf.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var i=s.readVarint()+s.pos,a=1,h=0,m=0,v=0,x=1/0,T=-1/0,P=1/0,O=-1/0;s.pos<i;){if(h<=0){var V=s.readVarint();a=7&V,h=V>>3}if(h--,a===1||a===2)(m+=s.readSVarint())<x&&(x=m),m>T&&(T=m),(v+=s.readSVarint())<P&&(P=v),v>O&&(O=v);else if(a!==7)throw new Error("unknown command "+a)}return[x,P,T,O]},Uf.prototype.toGeoJSON=function(s,i,a){var h,m,v=this.extent*Math.pow(2,a),x=this.extent*s,T=this.extent*i,P=this.loadGeometry(),O=Uf.types[this.type];function V(ot){for(var ct=0;ct<ot.length;ct++){var bt=ot[ct];ot[ct]=[360*(bt.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(bt.y+T)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(h=0;h<P.length;h++)$[h]=P[h][0];V(P=$);break;case 2:for(h=0;h<P.length;h++)V(P[h]);break;case 3:for(P=function(ot){var ct=ot.length;if(ct<=1)return[ot];for(var bt,zt,Jt=[],le=0;le<ct;le++){var Xt=Uy(ot[le]);Xt!==0&&(zt===void 0&&(zt=Xt<0),zt===Xt<0?(bt&&Jt.push(bt),bt=[ot[le]]):bt.push(ot[le]))}return bt&&Jt.push(bt),Jt}(P),h=0;h<P.length;h++)for(m=0;m<P[h].length;m++)V(P[h][m])}P.length===1?P=P[0]:O="Multi"+O;var tt={type:"Feature",geometry:{type:O,coordinates:P},properties:this.properties};return"id"in this&&(tt.id=this.id),tt};var Ow=Fy,Gy=Zy;function Zy(s,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(Rw,this,i),this.length=this._features.length}function Rw(s,i,a){s===15?i.version=a.readVarint():s===1?i.name=a.readString():s===5?i.extent=a.readVarint():s===2?i._features.push(a.pos):s===3?i._keys.push(a.readString()):s===4&&i._values.push(function(h){for(var m=null,v=h.readVarint()+h.pos;h.pos<v;){var x=h.readVarint()>>3;m=x===1?h.readString():x===2?h.readFloat():x===3?h.readDouble():x===4?h.readVarint64():x===5?h.readVarint():x===6?h.readSVarint():x===7?h.readBoolean():null}return m}(a))}Zy.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var i=this._pbf.readVarint()+this._pbf.pos;return new Ow(this._pbf,i,this.extent,this._keys,this._values)};var mm=Gy;function Bw(s,i,a){if(s===3){var h=new mm(a,a.readVarint()+a.pos);h.length&&(i[h.name]=h)}}var __=pm.VectorTile=function(s,i){this.layers=s.readFields(Bw,{},i)},gm=pm.VectorTileFeature=Fy;function _m(s,i,a,h){const m=[],v=h===0?(x,T,P,O,V,$)=>{x.push(new j($,P+($-T)/(O-T)*(V-P)))}:(x,T,P,O,V,$)=>{x.push(new j(T+($-P)/(V-P)*(O-T),$))};for(const x of s){const T=[];for(const P of x){if(P.length<=2)continue;const O=[];for(let tt=0;tt<P.length-1;tt++){const ot=P[tt].x,ct=P[tt].y,bt=P[tt+1].x,zt=P[tt+1].y,Jt=h===0?ot:ct,le=h===0?bt:zt;Jt<i?le>i&&v(O,ot,ct,bt,zt,i):Jt>a?le<a&&v(O,ot,ct,bt,zt,a):O.push(P[tt]),le<i&&Jt>=i&&v(O,ot,ct,bt,zt,i),le>a&&Jt<=a&&v(O,ot,ct,bt,zt,a)}let V=P[P.length-1];const $=h===0?V.x:V.y;$>=i&&$<=a&&O.push(V),O.length&&(V=O[O.length-1],O[0].x===V.x&&O[0].y===V.y||O.push(O[0]),T.push(O))}T.length&&m.push(T)}return m}pm.VectorTileLayer=Gy;const Fw=gm.types,jw=Math.pow(2,13);function Xd(s,i,a,h,m,v,x,T){s.emplaceBack((i<<1)+x,(a<<1)+v,(Math.floor(h*jw)<<1)+m,Math.round(T))}function Hd(s,i,a){s.emplaceBack(i.x,i.y,i.z,a[0]*16384,a[1]*16384,a[2]*16384)}class Vy{constructor(){this.acc=new j(0,0),this.polyCount=[]}startRing(i){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new j(i.x,i.y),this.max=new j(i.x,i.y))}append(i,a){this.currentPolyCount.edges++,this.acc._add(i);const h=this.min,m=this.max;i.x<h.x?h.x=i.x:i.x>m.x&&(m.x=i.x),i.y<h.y?h.y=i.y:i.y>m.y&&(m.y=i.y),((i.x===0||i.x===xi)&&i.x===a.x)!=((i.y===0||i.y===xi)&&i.y===a.y)&&this.processBorderOverlap(i,a),a.x<0!=i.x<0&&this.addBorderIntersection(0,Ri(a.y,i.y,(0-a.x)/(i.x-a.x))),a.x>xi!=i.x>xi&&this.addBorderIntersection(1,Ri(a.y,i.y,(xi-a.x)/(i.x-a.x))),a.y<0!=i.y<0&&this.addBorderIntersection(2,Ri(a.x,i.x,(0-a.y)/(i.y-a.y))),a.y>xi!=i.y>xi&&this.addBorderIntersection(3,Ri(a.x,i.x,(xi-a.y)/(i.y-a.y)))}addBorderIntersection(i,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[i];a<h[0]&&(h[0]=a),a>h[1]&&(h[1]=a)}processBorderOverlap(i,a){if(i.x===a.x){if(i.y===a.y)return;const h=i.x===0?0:1;this.addBorderIntersection(h,a.y),this.addBorderIntersection(h,i.y)}else{const h=i.y===0?2:3;this.addBorderIntersection(h,a.x),this.addBorderIntersection(h,i.x)}}centroid(){const i=this.polyCount.reduce((a,h)=>a+h.edges,0);return i!==0?this.acc.div(i)._round():new j(0,0)}span(){return new j(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((i,a)=>i+ +(a[0]!==Number.MAX_VALUE),0)}}class $d{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.id),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.layoutVertexArray=new Wr,this.centroidVertexArray=new Qp,this.indexArray=new aa,this.programConfigurations=new wc(i.layers,i.zoom),this.segments=new cs,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.enableTerrain=i.enableTerrain}populate(i,a,h,m){this.features=[],this.hasPattern=m_("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(v){const x=Math.exp(Math.PI*(1-v.y/(1<<v.z)*2));return 80150034*x/(x*x+1)/xi/(1<<v.z)}(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:v,id:x,index:T,sourceLayerIndex:P}of i){const O=this.layers[0]._featureFilter.needGeometry,V=bc(v,O);if(!this.layers[0]._featureFilter.filter(new De(this.zoom),V,h))continue;const $={id:x,sourceLayerIndex:P,index:T,geometry:O?V.geometry:Qu(v,h,m),properties:v.properties,type:v.type,patterns:{}},tt=this.layoutVertexArray.length;this.hasPattern?this.features.push(g_("fill-extrusion",this.layers,$,this.zoom,a)):this.addFeature($,$.geometry,T,h,{},a.availableImages,m),a.featureIndex.insert(v,$.geometry,T,P,this.index,tt)}this.sortBorders()}addFeatures(i,a,h,m,v){for(const x of this.features){const{geometry:T}=x;this.addFeature(x,T,x.index,a,h,m,v)}this.sortBorders()}update(i,a,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Dw),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,zw.members,!0))),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,Pw.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,a,h,m,v,x,T){const P=[new j(0,0),new j(xi,xi)],O=T.projection,V=O.name==="globe",$=this.enableTerrain&&!V?new Vy:null,tt=Fw[i.type]==="Polygon";V&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new mo);const ot=p_(a,500);for(let Jt=ot.length-1;Jt>=0;Jt--){const le=ot[Jt];(le.length===0||(ct=le[0]).every(Xt=>Xt.x<=0)||ct.every(Xt=>Xt.x>=xi)||ct.every(Xt=>Xt.y<=0)||ct.every(Xt=>Xt.y>=xi))&&ot.splice(Jt,1)}var ct;let bt;if(V)bt=w_(ot,P,m);else{bt=[];for(const Jt of ot)bt.push({polygon:Jt,bounds:P})}const zt=tt?this.edgeRadius:0;for(const{polygon:Jt,bounds:le}of bt){let Xt=0,Qt=0;for(const he of Jt)tt&&!he[0].equals(he[he.length-1])&&he.push(he[0]),Qt+=tt?he.length-1:he.length;const ge=this.segments.prepareSegment((tt?5:4)*Qt,this.layoutVertexArray,this.indexArray);if(tt){const he=[],Xe=[];Xt=ge.vertexLength;for(const dn of Jt){let Dn,en;dn.length&&dn!==Jt[0]&&Xe.push(he.length/2),Dn=dn[1].sub(dn[0])._perp()._unit();for(let _n=1;_n<dn.length;_n++){const wn=dn[_n],En=dn[_n===dn.length-1?1:_n+1];let{x:Nn,y:nn}=wn;if(zt){en=En.sub(wn)._perp()._unit();const Vn=Dn.add(en)._unit(),Ai=zt*Math.min(4,1/(Dn.x*Vn.x+Dn.y*Vn.y));Nn+=Ai*Vn.x,nn+=Ai*Vn.y,Dn=en}Xd(this.layoutVertexArray,Nn,nn,0,0,1,1,0),ge.vertexLength++,he.push(wn.x,wn.y),V&&Hd(this.layoutVertexExtArray,O.projectTilePoint(Nn,nn,m),O.upVector(m,Nn,nn))}}const Ze=Zd.exports(he,Xe);for(let dn=0;dn<Ze.length;dn+=3)this.indexArray.emplaceBack(Xt+Ze[dn],Xt+Ze[dn+2],Xt+Ze[dn+1]),ge.primitiveLength++}for(const he of Jt){$&&he.length&&$.startRing(he[0]);let Xe,Ze,dn,Dn=he.length>4&&y_(he[he.length-2],he[0],he[1]),en=zt?vm(he[he.length-2],he[0],he[1],zt):0;Ze=he[1].sub(he[0])._perp()._unit();let _n=!0;for(let wn=1,En=0;wn<he.length;wn++){let Nn=he[wn-1],nn=he[wn];const Vn=he[wn===he.length-1?1:wn+1];if($&&tt&&$.currentPolyCount.top++,v_(nn,Nn,le)){zt&&(Ze=Vn.sub(nn)._perp()._unit(),_n=!_n);continue}$&&$.append(nn,Nn);const Ai=nn.sub(Nn)._perp(),qn=Ai.x/(Math.abs(Ai.x)+Math.abs(Ai.y)),li=Ai.y>0?1:0,Wn=Nn.dist(nn);if(En+Wn>32768&&(En=0),zt){dn=Vn.sub(nn)._perp()._unit();let fr=Yy(Nn,nn,Vn,Wy(Ze,dn),zt);isNaN(fr)&&(fr=0);const Pi=nn.sub(Nn)._unit();Nn=Nn.add(Pi.mult(en))._round(),nn=nn.add(Pi.mult(-fr))._round(),en=fr,Ze=dn}const ki=ge.vertexLength,mr=he.length>4&&y_(Nn,nn,Vn);let pr=ym(En,Dn,_n);if(Xd(this.layoutVertexArray,Nn.x,Nn.y,qn,li,0,0,pr),Xd(this.layoutVertexArray,Nn.x,Nn.y,qn,li,0,1,pr),En+=Wn,pr=ym(En,mr,!_n),Dn=mr,Xd(this.layoutVertexArray,nn.x,nn.y,qn,li,0,0,pr),Xd(this.layoutVertexArray,nn.x,nn.y,qn,li,0,1,pr),ge.vertexLength+=4,this.indexArray.emplaceBack(ki+0,ki+1,ki+2),this.indexArray.emplaceBack(ki+1,ki+3,ki+2),ge.primitiveLength+=2,zt){const fr=Xt+(wn===1?he.length-2:wn-2),Pi=wn===1?Xt:fr+1;if(this.indexArray.emplaceBack(ki+1,fr,ki+3),this.indexArray.emplaceBack(fr,Pi,ki+3),ge.primitiveLength+=2,Xe===void 0&&(Xe=ki),!v_(Vn,he[wn],le)){const so=wn===he.length-1?Xe:ge.vertexLength;this.indexArray.emplaceBack(ki+2,ki+3,so),this.indexArray.emplaceBack(ki+3,so+1,so),this.indexArray.emplaceBack(ki+3,Pi,so+1),ge.primitiveLength+=3}_n=!_n}if(V){const fr=this.layoutVertexExtArray,Pi=O.projectTilePoint(Nn.x,Nn.y,m),so=O.projectTilePoint(nn.x,nn.y,m),Xi=O.upVector(m,Nn.x,Nn.y),gr=O.upVector(m,nn.x,nn.y);Hd(fr,Pi,Xi),Hd(fr,Pi,Xi),Hd(fr,so,gr),Hd(fr,so,gr)}}tt&&(Xt+=he.length-1)}}if($&&$.polyCount.length>0){if($.borders){$.vertexArrayOffset=this.centroidVertexArray.length;const Jt=$.borders,le=this.featuresOnBorder.push($)-1;for(let Xt=0;Xt<4;Xt++)Jt[Xt][0]!==Number.MAX_VALUE&&this.borders[Xt].push(le)}this.encodeCentroid($.borders?void 0:$.centroid(),$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,v,x,m)}sortBorders(){for(let i=0;i<4;i++)this.borders[i].sort((a,h)=>this.featuresOnBorder[a].borders[i][0]-this.featuresOnBorder[h].borders[i][0])}encodeCentroid(i,a,h=!0){let m,v;if(i)if(i.y!==0){const T=a.span()._mult(this.tileToMeter);m=(Math.max(i.x,1)<<3)+Math.min(7,Math.round(T.x/10)),v=(Math.max(i.y,1)<<3)+Math.min(7,Math.round(T.y/10))}else m=Math.ceil(7*(i.x+450)),v=0;else m=0,v=+h;let x=h?this.centroidVertexArray.length:a.vertexArrayOffset;for(const T of a.polyCount){h&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*T.edges+T.top);for(let P=0;P<T.top;P++)this.centroidVertexArray.emplace(x++,m,v);for(let P=0;P<2*T.edges;P++)this.centroidVertexArray.emplace(x++,0,v),this.centroidVertexArray.emplace(x++,m,v)}}}function Wy(s,i){const a=s.add(i)._unit();return s.x*a.x+s.y*a.y}function vm(s,i,a,h){const m=i.sub(s)._perp()._unit(),v=a.sub(i)._perp()._unit();return Yy(s,i,a,Wy(m,v),h)}function Yy(s,i,a,h,m){const v=Math.sqrt(1-h*h);return Math.min(s.dist(i)/3,i.dist(a)/3,m*v/h)}function v_(s,i,a){return s.x<a[0].x&&i.x<a[0].x||s.x>a[1].x&&i.x>a[1].x||s.y<a[0].y&&i.y<a[0].y||s.y>a[1].y&&i.y>a[1].y}function y_(s,i,a){if(s.x<0||s.x>=xi||i.x<0||i.x>=xi||a.x<0||a.x>=xi)return!1;const h=a.sub(i),m=h.perp(),v=s.sub(i);return(h.x*v.x+h.y*v.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(v.x*v.x+v.y*v.y))>-.866&&m.x*v.x+m.y*v.y<0}function ym(s,i,a){const h=i?2|s:-3&s;return a?1|h:-2&h}function x_(){const s=Math.PI/32,i=Math.tan(s),a=Yh;return a*Math.sqrt(1+2*i*i)-a}function w_(s,i,a){const h=1<<a.z,m=xl(a.x/h),v=xl((a.x+1)/h),x=xa(a.y/h),T=xa((a.y+1)/h);return function(P,O,V,$,tt=0,ot){const ct=[];if(!P.length||!V||!$)return ct;const bt=(he,Xe)=>{for(const Ze of he)ct.push({polygon:Ze,bounds:Xe})},zt=Math.ceil(Math.log2(V)),Jt=Math.ceil(Math.log2($)),le=zt-Jt,Xt=[];for(let he=0;he<Math.abs(le);he++)Xt.push(le>0?0:1);for(let he=0;he<Math.min(zt,Jt);he++)Xt.push(0),Xt.push(1);let Qt=P;if(Qt=_m(Qt,O[0].y-tt,O[1].y+tt,1),Qt=_m(Qt,O[0].x-tt,O[1].x+tt,0),!Qt.length)return ct;const ge=[];for(Xt.length?ge.push({polygons:Qt,bounds:O,depth:0}):bt(Qt,O);ge.length;){const he=ge.pop(),Xe=he.depth,Ze=Xt[Xe],dn=he.bounds[0],Dn=he.bounds[1],en=Ze===0?dn.x:dn.y,_n=Ze===0?Dn.x:Dn.y,wn=ot?ot(Ze,en,_n):.5*(en+_n),En=_m(he.polygons,en-tt,wn+tt,Ze),Nn=_m(he.polygons,wn-tt,_n+tt,Ze);if(En.length){const nn=[dn,new j(Ze===0?wn:Dn.x,Ze===1?wn:Dn.y)];Xt.length>Xe+1?ge.push({polygons:En,bounds:nn,depth:Xe+1}):bt(En,nn)}if(Nn.length){const nn=[new j(Ze===0?wn:dn.x,Ze===1?wn:dn.y),Dn];Xt.length>Xe+1?ge.push({polygons:Nn,bounds:nn,depth:Xe+1}):bt(Nn,nn)}}return ct}(s,i,Math.ceil((v-m)/11.25),Math.ceil((x-T)/11.25),1,(P,O,V)=>{if(P===0)return .5*(O+V);{const $=xa((a.y+O/xi)/h);return(au(.5*(xa((a.y+V/xi)/h)+$))*h-a.y)*xi}})}Xn($d,"FillExtrusionBucket",{omit:["layers","features"]}),Xn(Vy,"PartMetadata");const Xy=new fi({"fill-extrusion-edge-radius":new Ne(Ke["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Hy={paint:new fi({"fill-extrusion-opacity":new Ne(Ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new $e(Ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ne(Ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ne(Ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $e(Ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new $e(Ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new $e(Ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ne(Ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ne(Ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ne(Ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:Xy};function $y(s,i,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[s*h-2*Math.PI*6378137/2,i*h-2*Math.PI*6378137/2]}class xm{constructor(i,a,h){this.z=i,this.x=a,this.y=h,this.key=xh(0,i,i,a,h)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,a){const h=function(v,x,T){var P=$y(256*v,256*(x=Math.pow(2,T)-x-1),T),O=$y(256*(v+1),256*(x+1),T);return P[0]+","+P[1]+","+O[0]+","+O[1]}(this.x,this.y,this.z),m=function(v,x,T){let P,O="";for(let V=v;V>0;V--)P=1<<V-1,O+=(x&P?1:0)+(T&P?2:0);return O}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class qy{constructor(i,a){this.wrap=i,this.canonical=a,this.key=xh(i,a.z,a.z,a.x,a.y)}}class la{constructor(i,a,h,m,v){this.overscaledZ=i,this.wrap=a,this.canonical=new xm(h,+m,+v),this.key=a===0&&i===h?this.canonical.key:xh(a,i,h,m,v)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const a=this.canonical.z-i;return i>this.canonical.z?new la(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new la(i,this.wrap,i,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(i,a=!0){if(this.overscaledZ===i&&a)return this.key;if(i>this.canonical.z)return xh(this.wrap*+a,i,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-i;return xh(this.wrap*+a,i,i,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const a=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>a&&i.canonical.y===this.canonical.y>>a}children(i){if(this.overscaledZ>=i)return[new la(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new la(a,this.wrap,a,h,m),new la(a,this.wrap,a,h+1,m),new la(a,this.wrap,a,h,m+1),new la(a,this.wrap,a,h+1,m+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new la(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new la(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new qy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function xh(s,i,a,h,m){const v=1<<Math.min(a,22);let x=v*(m%v)+h%v;return s&&a<22&&(x+=v*v*((s<0?-2*s-1:2*s)%(1<<2*(22-a)))),16*(32*x+a)+(i-a)}Xn(xm,"CanonicalTileID"),Xn(la,"OverscaledTileID",{omit:["projMatrix"]});class Gf extends j{constructor(i,a,h){super(i,a),this.z=h}}function qd(s,i){return s.x*i.x+s.y*i.y}function wm(s,i){if(s.length===1){let a=0;const h=i[a++];let m;for(;!m||h.equals(m);)if(m=i[a++],!m)return 1/0;for(;a<i.length;a++){const v=i[a],x=s[0],T=m.sub(h),P=v.sub(h),O=x.sub(h),V=qd(T,T),$=qd(T,P),tt=qd(P,P),ot=qd(O,T),ct=qd(O,P),bt=V*tt-$*$,zt=(tt*ot-$*ct)/bt,Jt=(V*ct-$*ot)/bt,le=h.z*(1-zt-Jt)+m.z*zt+v.z*Jt;if(isFinite(le))return le}return 1/0}{let a=1/0;for(const h of i)a=Math.min(a,h.z);return a}}function b_(s,i,a,h,m,v,x,T){const P=x*m.getElevationAt(s,i,!0,!0),O=v[0]!==0,V=O?v[1]===0?x*(v[0]/7-450):x*function($,tt,ot){const ct=Math.floor(tt[0]/8),bt=Math.floor(tt[1]/8),zt=10*(tt[0]-8*ct),Jt=10*(tt[1]-8*bt),le=$.getElevationAt(ct,bt,!0,!0),Xt=$.getMeterToDEM(ot),Qt=Math.floor(.5*(zt*Xt-1)),ge=Math.floor(.5*(Jt*Xt-1)),he=$.tileCoordToPixel(ct,bt),Xe=2*Qt+1,Ze=2*ge+1,dn=function(Nn,nn,Vn,Ai,qn){return[Nn.getElevationAtPixel(nn,Vn,!0),Nn.getElevationAtPixel(nn+qn,Vn,!0),Nn.getElevationAtPixel(nn,Vn+qn,!0),Nn.getElevationAtPixel(nn+Ai,Vn+qn,!0)]}($,he.x-Qt,he.y-ge,Xe,Ze),Dn=Math.abs(dn[0]-dn[1]),en=Math.abs(dn[2]-dn[3]),_n=Math.abs(dn[0]-dn[2])+Math.abs(dn[1]-dn[3]),wn=Math.min(.25,.5*Xt*(Dn+en)/Xe),En=Math.min(.25,.5*Xt*_n/Ze);return le+Math.max(wn*zt,En*Jt)}(m,v,T):P;return{base:P+(a===0)?-1:a,top:O?Math.max(V+h,P+a+2):P+h}}const Uw=Kn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Gw}=Uw,Zw=Kn([{name:"a_packed",components:4,type:"Float32"}]),{members:Vw}=Zw,Ww=gm.types,Yw=Math.cos(Math.PI/180*37.5);class bm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.id),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new qa,this.layoutVertexArray2=new Ra,this.indexArray=new aa,this.programConfigurations=new wc(i.layers,i.zoom),this.segments=new cs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(i,a,h,m){this.hasPattern=m_("line",this.layers,a);const v=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:V,id:$,index:tt,sourceLayerIndex:ot}of i){const ct=this.layers[0]._featureFilter.needGeometry,bt=bc(V,ct);if(!this.layers[0]._featureFilter.filter(new De(this.zoom),bt,h))continue;const zt=v?v.evaluate(bt,{},h):void 0,Jt={id:$,properties:V.properties,type:V.type,sourceLayerIndex:ot,index:tt,geometry:ct?bt.geometry:Qu(V,h,m),patterns:{},sortKey:zt};x.push(Jt)}v&&x.sort((V,$)=>V.sortKey-$.sortKey);const{lineAtlas:T,featureIndex:P}=a,O=this.addConstantDashes(T);for(const V of x){const{geometry:$,index:tt,sourceLayerIndex:ot}=V;if(O&&this.addFeatureDashes(V,T),this.hasPattern){const ct=g_("line",this.layers,V,this.zoom,a);this.patternFeatures.push(ct)}else this.addFeature(V,$,tt,h,T.positions,a.availableImages);P.insert(i[tt].feature,$,tt,ot,this.index)}}addConstantDashes(i){let a=!1;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,v=h.layout.get("line-cap").value;if(m.kind!=="constant"||v.kind!=="constant")a=!0;else{const x=v.value,T=m.value;if(!T)continue;i.addDash(T,x)}}return a}addFeatureDashes(i,a){const h=this.zoom;for(const m of this.layers){const v=m.paint.get("line-dasharray").value,x=m.layout.get("line-cap").value;if(v.kind==="constant"&&x.kind==="constant")continue;let T,P;if(v.kind==="constant"){if(T=v.value,!T)continue}else T=v.evaluate({zoom:h},i);P=x.kind==="constant"?x.value:x.evaluate({zoom:h},i),a.addDash(T,P),i.patterns[m.id]=a.getKey(T,P)}}update(i,a,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,h,m)}addFeatures(i,a,h,m,v){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,a,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Vw)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Gw),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,a,h,m,v,x){const T=this.layers[0].layout,P=T.get("line-join").evaluate(i,{}),O=T.get("line-cap").evaluate(i,{}),V=T.get("line-miter-limit"),$=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const tt of a)this.addLine(tt,i,P,O,V,$);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,v,x,m)}addLine(i,a,h,m,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Jt=0;Jt<i.length-1;Jt++)this.totalDistance+=i[Jt].dist(i[Jt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=Ww[a.type]==="Polygon";let P=i.length;for(;P>=2&&i[P-1].equals(i[P-2]);)P--;let O=0;for(;O<P-1&&i[O].equals(i[O+1]);)O++;if(P<(T?3:2))return;h==="bevel"&&(v=1.05);const V=this.overscaling<=16?122880/(512*this.overscaling):0,$=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let tt,ot,ct,bt,zt;this.e1=this.e2=-1,T&&(tt=i[P-2],zt=i[O].sub(tt)._unit()._perp());for(let Jt=O;Jt<P;Jt++){if(ct=Jt===P-1?T?i[O+1]:void 0:i[Jt+1],ct&&i[Jt].equals(ct))continue;zt&&(bt=zt),tt&&(ot=tt),tt=i[Jt],zt=ct?ct.sub(tt)._unit()._perp():bt,bt=bt||zt;let le=bt.add(zt);le.x===0&&le.y===0||le._unit();const Xt=bt.x*zt.x+bt.y*zt.y,Qt=le.x*zt.x+le.y*zt.y,ge=Qt!==0?1/Qt:1/0,he=2*Math.sqrt(2-2*Qt),Xe=Qt<Yw&&ot&&ct,Ze=bt.x*zt.y-bt.y*zt.x>0;if(Xe&&Jt>O){const en=tt.dist(ot);if(en>2*V){const _n=tt.sub(tt.sub(ot)._mult(V/en)._round());this.updateDistance(ot,_n),this.addCurrentVertex(_n,bt,0,0,$),ot=_n}}const dn=ot&&ct;let Dn=dn?h:T?"butt":m;if(dn&&Dn==="round"&&(ge<x?Dn="miter":ge<=2&&(Dn="fakeround")),Dn==="miter"&&ge>v&&(Dn="bevel"),Dn==="bevel"&&(ge>2&&(Dn="flipbevel"),ge<v&&(Dn="miter")),ot&&this.updateDistance(ot,tt),Dn==="miter")le._mult(ge),this.addCurrentVertex(tt,le,0,0,$);else if(Dn==="flipbevel"){if(ge>100)le=zt.mult(-1);else{const en=ge*bt.add(zt).mag()/bt.sub(zt).mag();le._perp()._mult(en*(Ze?-1:1))}this.addCurrentVertex(tt,le,0,0,$),this.addCurrentVertex(tt,le.mult(-1),0,0,$)}else if(Dn==="bevel"||Dn==="fakeround"){const en=-Math.sqrt(ge*ge-1),_n=Ze?en:0,wn=Ze?0:en;if(ot&&this.addCurrentVertex(tt,bt,_n,wn,$),Dn==="fakeround"){const En=Math.round(180*he/Math.PI/20);for(let Nn=1;Nn<En;Nn++){let nn=Nn/En;if(nn!==.5){const Ai=nn-.5;nn+=nn*Ai*(nn-1)*((1.0904+Xt*(Xt*(3.55645-1.43519*Xt)-3.2452))*Ai*Ai+(.848013+Xt*(.215638*Xt-1.06021)))}const Vn=zt.sub(bt)._mult(nn)._add(bt)._unit()._mult(Ze?-1:1);this.addHalfVertex(tt,Vn.x,Vn.y,!1,Ze,0,$)}}ct&&this.addCurrentVertex(tt,zt,-_n,-wn,$)}else if(Dn==="butt")this.addCurrentVertex(tt,le,0,0,$);else if(Dn==="square"){const en=ot?1:-1;ot||this.addCurrentVertex(tt,le,en,en,$),this.addCurrentVertex(tt,le,0,0,$),ot&&this.addCurrentVertex(tt,le,en,en,$)}else Dn==="round"&&(ot&&(this.addCurrentVertex(tt,bt,0,0,$),this.addCurrentVertex(tt,bt,1,1,$,!0)),ct&&(this.addCurrentVertex(tt,zt,-1,-1,$,!0),this.addCurrentVertex(tt,zt,0,0,$)));if(Xe&&Jt<P-1){const en=tt.dist(ct);if(en>2*V){const _n=tt.add(ct.sub(tt)._mult(V/en)._round());this.updateDistance(tt,_n),this.addCurrentVertex(_n,zt,0,0,$),tt=_n}}}}addCurrentVertex(i,a,h,m,v,x=!1){const T=a.y*m-a.x,P=-a.y-a.x*m;this.addHalfVertex(i,a.x+a.y*h,a.y-a.x*h,x,!1,h,v),this.addHalfVertex(i,T,P,x,!0,-m,v)}addHalfVertex({x:i,y:a},h,m,v,x,T,P){this.layoutVertexArray.emplaceBack((i<<1)+(v?1:0),(a<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const O=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,O),P.primitiveLength++),x?this.e2=O:this.e1=O}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,a){this.distance+=i.dist(a),this.updateScaledDistance()}}Xn(bm,"LineBucket",{omit:["layers","patternFeatures"]});const Xw=new fi({"line-cap":new $e(Ke.layout_line["line-cap"]),"line-join":new $e(Ke.layout_line["line-join"]),"line-miter-limit":new Ne(Ke.layout_line["line-miter-limit"]),"line-round-limit":new Ne(Ke.layout_line["line-round-limit"]),"line-sort-key":new $e(Ke.layout_line["line-sort-key"])});var Jy={paint:new fi({"line-opacity":new $e(Ke.paint_line["line-opacity"]),"line-color":new $e(Ke.paint_line["line-color"]),"line-translate":new Ne(Ke.paint_line["line-translate"]),"line-translate-anchor":new Ne(Ke.paint_line["line-translate-anchor"]),"line-width":new $e(Ke.paint_line["line-width"]),"line-gap-width":new $e(Ke.paint_line["line-gap-width"]),"line-offset":new $e(Ke.paint_line["line-offset"]),"line-blur":new $e(Ke.paint_line["line-blur"]),"line-dasharray":new $e(Ke.paint_line["line-dasharray"]),"line-pattern":new $e(Ke.paint_line["line-pattern"]),"line-gradient":new ri(Ke.paint_line["line-gradient"]),"line-trim-offset":new Ne(Ke.paint_line["line-trim-offset"])}),layout:Xw};const Ky=new class extends $e{possiblyEvaluate(s,i){return i=new De(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,transition:i.transition}),super.possiblyEvaluate(s,i)}evaluate(s,i,a,h){return i=be({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(s,i,a,h)}}(Jy.paint.properties["line-width"].specification);function Qy(s,i){return i>0?i+2*s:s}Ky.useIntegerZoom=!0;const Hw=Kn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nc=Kn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),$w=Kn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Kn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const qw=Kn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ef=Kn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Kn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hr=Kn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Jw=Kn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Kn([{name:"triangle",components:3,type:"Uint16"}]),Kn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Kn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Kn([{type:"Float32",name:"offsetX"}]),Kn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var _o=24;const So=128;function I_(s,i){const{expression:a}=i;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new De(s+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:m}=a;let v=0;for(;v<h.length&&h[v]<=s;)v++;v=Math.max(0,v-1);let x=v;for(;x<h.length&&h[x]<s+1;)x++;x=Math.min(h.length-1,x);const T=h[v],P=h[x];return a.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:P,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:P,minSize:a.evaluate(new De(T)),maxSize:a.evaluate(new De(P)),interpolationType:m}}}function ic(s,{uSize:i,uSizeT:a},{lowerSize:h,upperSize:m}){return s.kind==="source"?h/So:s.kind==="composite"?Ri(h/So,m/So,a):i}function Zf(s,i){let a=0,h=0;if(s.kind==="constant")h=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:m,minZoom:v,maxZoom:x}=s,T=m?ie(Ha.interpolationFactor(m,i,v,x),0,1):0;s.kind==="camera"?h=Ri(s.minSize,s.maxSize,T):a=T}return{uSizeT:a,uSize:h}}var Kw=Object.freeze({__proto__:null,getSizeData:I_,evaluateSizeForFeature:ic,evaluateSizeForZoom:Zf,SIZE_PACK_FACTOR:So});function Qw(s,i,a){return s.sections.forEach(h=>{h.text=function(m,v,x){const T=v.layout.get("text-transform").evaluate(x,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),je.applyArabicShaping&&(m=je.applyArabicShaping(m)),m}(h.text,i,a)}),s}const Jd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function tb(s){return s==="︶"||s==="﹈"||s==="︸"||s==="﹄"||s==="﹂"||s==="︾"||s==="︼"||s==="︺"||s==="︘"||s==="﹀"||s==="︐"||s==="︓"||s==="︔"||s==="｀"||s==="￣"||s==="︑"||s==="︒"}function C_(s){return s==="︵"||s==="﹇"||s==="︷"||s==="﹃"||s==="﹁"||s==="︽"||s==="︻"||s==="︹"||s==="︗"||s==="︿"}var Kd=$r,Ac=function(s,i,a,h,m){var v,x,T=8*m-h-1,P=(1<<T)-1,O=P>>1,V=-7,$=a?m-1:0,tt=a?-1:1,ot=s[i+$];for($+=tt,v=ot&(1<<-V)-1,ot>>=-V,V+=T;V>0;v=256*v+s[i+$],$+=tt,V-=8);for(x=v&(1<<-V)-1,v>>=-V,V+=h;V>0;x=256*x+s[i+$],$+=tt,V-=8);if(v===0)v=1-O;else{if(v===P)return x?NaN:1/0*(ot?-1:1);x+=Math.pow(2,h),v-=O}return(ot?-1:1)*x*Math.pow(2,v-h)},A_=function(s,i,a,h,m,v){var x,T,P,O=8*v-m-1,V=(1<<O)-1,$=V>>1,tt=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,ot=h?0:v-1,ct=h?1:-1,bt=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(T=isNaN(i)?1:0,x=V):(x=Math.floor(Math.log(i)/Math.LN2),i*(P=Math.pow(2,-x))<1&&(x--,P*=2),(i+=x+$>=1?tt/P:tt*Math.pow(2,1-$))*P>=2&&(x++,P/=2),x+$>=V?(T=0,x=V):x+$>=1?(T=(i*P-1)*Math.pow(2,m),x+=$):(T=i*Math.pow(2,$-1)*Math.pow(2,m),x=0));m>=8;s[a+ot]=255&T,ot+=ct,T/=256,m-=8);for(x=x<<m|T,O+=m;O>0;s[a+ot]=255&x,ot+=ct,x/=256,O-=8);s[a+ot-ct]|=128*bt};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function $r(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}$r.Varint=0,$r.Fixed64=1,$r.Bytes=2,$r.Fixed32=5;var $o=4294967296,fs=1/$o,T_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $c(s){return s.type===$r.Bytes?s.readVarint()+s.pos:s.pos+1}function Vf(s,i,a){return a?4294967296*i+(s>>>0):4294967296*(i>>>0)+(s>>>0)}function t0(s,i,a){var h=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));a.realloc(h);for(var m=a.pos-1;m>=s;m--)a.buf[m+h]=a.buf[m]}function eb(s,i){for(var a=0;a<s.length;a++)i.writeVarint(s[a])}function nb(s,i){for(var a=0;a<s.length;a++)i.writeSVarint(s[a])}function ib(s,i){for(var a=0;a<s.length;a++)i.writeFloat(s[a])}function e0(s,i){for(var a=0;a<s.length;a++)i.writeDouble(s[a])}function Qd(s,i){for(var a=0;a<s.length;a++)i.writeBoolean(s[a])}function S_(s,i){for(var a=0;a<s.length;a++)i.writeFixed32(s[a])}function rb(s,i){for(var a=0;a<s.length;a++)i.writeSFixed32(s[a])}function n0(s,i){for(var a=0;a<s.length;a++)i.writeFixed64(s[a])}function Im(s,i){for(var a=0;a<s.length;a++)i.writeSFixed64(s[a])}function nl(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+16777216*s[i+3]}function rc(s,i,a){s[a]=i,s[a+1]=i>>>8,s[a+2]=i>>>16,s[a+3]=i>>>24}function i0(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+(s[i+3]<<24)}function ob(s,i,a){i.glyphs=[],s===1&&a.readMessage(sb,i)}function sb(s,i,a){if(s===3){const{id:h,bitmap:m,width:v,height:x,left:T,top:P,advance:O}=a.readMessage(ab,{});i.glyphs.push({id:h,bitmap:new Hc({width:v+6,height:x+6},m),metrics:{width:v,height:x,left:T,top:P,advance:O}})}else s===4?i.ascender=a.readSVarint():s===5&&(i.descender=a.readSVarint())}function ab(s,i,a){s===1?i.id=a.readVarint():s===2?i.bitmap=a.readBytes():s===3?i.width=a.readVarint():s===4?i.height=a.readVarint():s===5?i.left=a.readSVarint():s===6?i.top=a.readSVarint():s===7&&(i.advance=a.readVarint())}function E_(s){let i=0,a=0;for(const x of s)i+=x.w*x.h,a=Math.max(a,x.w);s.sort((x,T)=>T.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),a),h:1/0}];let m=0,v=0;for(const x of s)for(let T=h.length-1;T>=0;T--){const P=h[T];if(!(x.w>P.w||x.h>P.h)){if(x.x=P.x,x.y=P.y,v=Math.max(v,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===P.w&&x.h===P.h){const O=h.pop();T<h.length&&(h[T]=O)}else x.h===P.h?(P.x+=x.w,P.w-=x.w):x.w===P.w?(P.y+=x.h,P.h-=x.h):(h.push({x:P.x+x.w,y:P.y,w:P.w-x.w,h:x.h}),P.y+=x.h,P.h-=x.h);break}}return{w:m,h:v,fill:i/(m*v)||0}}$r.prototype={destroy:function(){this.buf=null},readFields:function(s,i,a){for(a=a||this.length;this.pos<a;){var h=this.readVarint(),m=h>>3,v=this.pos;this.type=7&h,s(m,i,this),this.pos===v&&this.skip(h)}return i},readMessage:function(s,i){return this.readFields(s,i,this.readVarint()+this.pos)},readFixed32:function(){var s=nl(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=i0(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=nl(this.buf,this.pos)+nl(this.buf,this.pos+4)*$o;return this.pos+=8,s},readSFixed64:function(){var s=nl(this.buf,this.pos)+i0(this.buf,this.pos+4)*$o;return this.pos+=8,s},readFloat:function(){var s=Ac(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Ac(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var i,a,h=this.buf;return i=127&(a=h[this.pos++]),a<128?i:(i|=(127&(a=h[this.pos++]))<<7,a<128?i:(i|=(127&(a=h[this.pos++]))<<14,a<128?i:(i|=(127&(a=h[this.pos++]))<<21,a<128?i:function(m,v,x){var T,P,O=x.buf;if(T=(112&(P=O[x.pos++]))>>4,P<128||(T|=(127&(P=O[x.pos++]))<<3,P<128)||(T|=(127&(P=O[x.pos++]))<<10,P<128)||(T|=(127&(P=O[x.pos++]))<<17,P<128)||(T|=(127&(P=O[x.pos++]))<<24,P<128)||(T|=(1&(P=O[x.pos++]))<<31,P<128))return Vf(m,T,v);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(a=h[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var s=this.readVarint()+this.pos,i=this.pos;return this.pos=s,s-i>=12&&T_?function(a,h,m){return T_.decode(a.subarray(h,m))}(this.buf,i,s):function(a,h,m){for(var v="",x=h;x<m;){var T,P,O,V=a[x],$=null,tt=V>239?4:V>223?3:V>191?2:1;if(x+tt>m)break;tt===1?V<128&&($=V):tt===2?(192&(T=a[x+1]))==128&&($=(31&V)<<6|63&T)<=127&&($=null):tt===3?(P=a[x+2],(192&(T=a[x+1]))==128&&(192&P)==128&&(($=(15&V)<<12|(63&T)<<6|63&P)<=2047||$>=55296&&$<=57343)&&($=null)):tt===4&&(P=a[x+2],O=a[x+3],(192&(T=a[x+1]))==128&&(192&P)==128&&(192&O)==128&&(($=(15&V)<<18|(63&T)<<12|(63&P)<<6|63&O)<=65535||$>=1114112)&&($=null)),$===null?($=65533,tt=1):$>65535&&($-=65536,v+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),v+=String.fromCharCode($),x+=tt}return v}(this.buf,i,s)},readBytes:function(){var s=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,s);return this.pos=s,i},readPackedVarint:function(s,i){if(this.type!==$r.Bytes)return s.push(this.readVarint(i));var a=$c(this);for(s=s||[];this.pos<a;)s.push(this.readVarint(i));return s},readPackedSVarint:function(s){if(this.type!==$r.Bytes)return s.push(this.readSVarint());var i=$c(this);for(s=s||[];this.pos<i;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==$r.Bytes)return s.push(this.readBoolean());var i=$c(this);for(s=s||[];this.pos<i;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==$r.Bytes)return s.push(this.readFloat());var i=$c(this);for(s=s||[];this.pos<i;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==$r.Bytes)return s.push(this.readDouble());var i=$c(this);for(s=s||[];this.pos<i;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==$r.Bytes)return s.push(this.readFixed32());var i=$c(this);for(s=s||[];this.pos<i;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==$r.Bytes)return s.push(this.readSFixed32());var i=$c(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==$r.Bytes)return s.push(this.readFixed64());var i=$c(this);for(s=s||[];this.pos<i;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==$r.Bytes)return s.push(this.readSFixed64());var i=$c(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed64());return s},skip:function(s){var i=7&s;if(i===$r.Varint)for(;this.buf[this.pos++]>127;);else if(i===$r.Bytes)this.pos=this.readVarint()+this.pos;else if(i===$r.Fixed32)this.pos+=4;else{if(i!==$r.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(s,i){this.writeVarint(s<<3|i)},realloc:function(s){for(var i=this.length||16;i<this.pos+s;)i*=2;if(i!==this.length){var a=new Uint8Array(i);a.set(this.buf),this.buf=a,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),rc(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),rc(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),rc(this.buf,-1&s,this.pos),rc(this.buf,Math.floor(s*fs),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),rc(this.buf,-1&s,this.pos),rc(this.buf,Math.floor(s*fs),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(i,a){var h,m;if(i>=0?(h=i%4294967296|0,m=i/4294967296|0):(m=~(-i/4294967296),4294967295^(h=~(-i%4294967296))?h=h+1|0:(h=0,m=m+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(v,x,T){T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,T.buf[T.pos]=127&(v>>>=7)}(h,0,a),function(v,x){var T=(7&v)<<4;x.buf[x.pos++]|=T|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(m,a)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(Boolean(s))},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var i=this.pos;this.pos=function(h,m,v){for(var x,T,P=0;P<m.length;P++){if((x=m.charCodeAt(P))>55295&&x<57344){if(!T){x>56319||P+1===m.length?(h[v++]=239,h[v++]=191,h[v++]=189):T=x;continue}if(x<56320){h[v++]=239,h[v++]=191,h[v++]=189,T=x;continue}x=T-55296<<10|x-56320|65536,T=null}else T&&(h[v++]=239,h[v++]=191,h[v++]=189,T=null);x<128?h[v++]=x:(x<2048?h[v++]=x>>6|192:(x<65536?h[v++]=x>>12|224:(h[v++]=x>>18|240,h[v++]=x>>12&63|128),h[v++]=x>>6&63|128),h[v++]=63&x|128)}return v}(this.buf,s,this.pos);var a=this.pos-i;a>=128&&t0(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeFloat:function(s){this.realloc(4),A_(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),A_(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var i=s.length;this.writeVarint(i),this.realloc(i);for(var a=0;a<i;a++)this.buf[this.pos++]=s[a]},writeRawMessage:function(s,i){this.pos++;var a=this.pos;s(i,this);var h=this.pos-a;h>=128&&t0(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeMessage:function(s,i,a){this.writeTag(s,$r.Bytes),this.writeRawMessage(i,a)},writePackedVarint:function(s,i){i.length&&this.writeMessage(s,eb,i)},writePackedSVarint:function(s,i){i.length&&this.writeMessage(s,nb,i)},writePackedBoolean:function(s,i){i.length&&this.writeMessage(s,Qd,i)},writePackedFloat:function(s,i){i.length&&this.writeMessage(s,ib,i)},writePackedDouble:function(s,i){i.length&&this.writeMessage(s,e0,i)},writePackedFixed32:function(s,i){i.length&&this.writeMessage(s,S_,i)},writePackedSFixed32:function(s,i){i.length&&this.writeMessage(s,rb,i)},writePackedFixed64:function(s,i){i.length&&this.writeMessage(s,n0,i)},writePackedSFixed64:function(s,i){i.length&&this.writeMessage(s,Im,i)},writeBytesField:function(s,i){this.writeTag(s,$r.Bytes),this.writeBytes(i)},writeFixed32Field:function(s,i){this.writeTag(s,$r.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(s,i){this.writeTag(s,$r.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(s,i){this.writeTag(s,$r.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(s,i){this.writeTag(s,$r.Fixed64),this.writeSFixed64(i)},writeVarintField:function(s,i){this.writeTag(s,$r.Varint),this.writeVarint(i)},writeSVarintField:function(s,i){this.writeTag(s,$r.Varint),this.writeSVarint(i)},writeStringField:function(s,i){this.writeTag(s,$r.Bytes),this.writeString(i)},writeFloatField:function(s,i){this.writeTag(s,$r.Fixed32),this.writeFloat(i)},writeDoubleField:function(s,i){this.writeTag(s,$r.Fixed64),this.writeDouble(i)},writeBooleanField:function(s,i){this.writeVarintField(s,Boolean(i))}};class Cm{constructor(i,{pixelRatio:a,version:h,stretchX:m,stretchY:v,content:x}){this.paddedRect=i,this.pixelRatio=a,this.stretchX=m,this.stretchY=v,this.content=x,this.version=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Tc{constructor(i,a){const h={},m={};this.haveRenderCallbacks=[];const v=[];this.addImages(i,h,v),this.addImages(a,m,v);const{w:x,h:T}=E_(v),P=new Fl({width:x||1,height:T||1});for(const O in i){const V=i[O],$=h[O].paddedRect;Fl.copy(V.data,P,{x:0,y:0},{x:$.x+1,y:$.y+1},V.data)}for(const O in a){const V=a[O],$=m[O].paddedRect,tt=$.x+1,ot=$.y+1,ct=V.data.width,bt=V.data.height;Fl.copy(V.data,P,{x:0,y:0},{x:tt,y:ot},V.data),Fl.copy(V.data,P,{x:0,y:bt-1},{x:tt,y:ot-1},{width:ct,height:1}),Fl.copy(V.data,P,{x:0,y:0},{x:tt,y:ot+bt},{width:ct,height:1}),Fl.copy(V.data,P,{x:ct-1,y:0},{x:tt-1,y:ot},{width:1,height:bt}),Fl.copy(V.data,P,{x:0,y:0},{x:tt+ct,y:ot},{width:1,height:bt})}this.image=P,this.iconPositions=h,this.patternPositions=m}addImages(i,a,h){for(const m in i){const v=i[m],x={x:0,y:0,w:v.data.width+2,h:v.data.height+2};h.push(x),a[m]=new Cm(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(i,a){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(h=>i.hasImage(h)),i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in i.updatedImages)this.patchUpdatedImage(this.iconPositions[h],i.getImage(h),a),this.patchUpdatedImage(this.patternPositions[h],i.getImage(h),a)}patchUpdatedImage(i,a,h){if(!i||!a||i.version===a.version)return;i.version=a.version;const[m,v]=i.tl;h.update(a.data,void 0,{x:m,y:v})}}Xn(Cm,"ImagePosition"),Xn(Tc,"ImageAtlas");const Vi={horizontal:1,vertical:2,horizontalOnly:3};class Wf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,a){const h=new Wf;return h.scale=i||1,h.fontStack=a,h}static forImage(i){const a=new Wf;return a.imageName=i,a}}class Ba{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,a){const h=new Ba;for(let m=0;m<i.sections.length;m++){const v=i.sections[m];v.image?h.addImageSection(v):h.addTextSection(v,a)}return h}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(i){this.text=function(a,h){let m="";for(let v=0;v<a.length;v++){const x=a.charCodeAt(v+1)||null,T=a.charCodeAt(v-1)||null;m+=!h&&(x&&et(x)&&!Jd[a[v+1]]||T&&et(T)&&!Jd[a[v-1]])||!Jd[a[v]]?a[v]:Jd[a[v]]}return m}(this.text,i)}trim(){let i=0;for(let h=0;h<this.text.length&&Tm[this.text.charCodeAt(h)];h++)i++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=i&&Tm[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(i,a),this.sectionIndex=this.sectionIndex.slice(i,a)}substring(i,a){const h=new Ba;return h.text=this.text.substring(i,a),h.sectionIndex=this.sectionIndex.slice(i,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,a)=>Math.max(i,this.sections[a].scale),0)}addTextSection(i,a){this.text+=i.text,this.sections.push(Wf.forText(i.scale,i.fontStack||a));const h=this.sections.length-1;for(let m=0;m<i.text.length;++m)this.sectionIndex.push(h)}addImageSection(i){const a=i.image?i.image.name:"";if(a.length===0)return void cn("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(Wf.forImage(a)),this.sectionIndex.push(this.sections.length-1)):cn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Am(s,i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct){const bt=Ba.fromFeature(s,m);$===Vi.vertical&&bt.verticalizePunctuation(tt);let zt=[];const Jt=function(he,Xe,Ze,dn,Dn,en){if(!he)return[];const _n=[],wn=function(Vn,Ai,qn,li,Wn,ki){let mr=0;for(let pr=0;pr<Vn.length();pr++){const fr=Vn.getSection(pr);mr+=r0(Vn.getCharCode(pr),fr,li,Wn,Ai,ki)}return mr/Math.max(1,Math.ceil(mr/qn))}(he,Xe,Ze,dn,Dn,en),En=he.text.indexOf("​")>=0;let Nn=0;for(let Vn=0;Vn<he.length();Vn++){const Ai=he.getSection(Vn),qn=he.getCharCode(Vn);if(Tm[qn]||(Nn+=r0(qn,Ai,dn,Dn,Xe,en)),Vn<he.length()-1){const li=!((nn=qn)<11904||!(vl(nn)||Wp(nn)||f(nn)||Gc(nn)||$p(nn)||Ld(nn)||Yp(nn)||ph(nn)||qp(nn)||Ef(nn)||Hp(nn)||S(nn)||iu(nn)||Pd(nn)||kd(nn)||Xp(nn)||Sf(nn)||u(nn)||Jp(nn)||zd(nn)));(Eo[qn]||li||Ai.imageName)&&_n.push(o0(Vn+1,Nn,wn,_n,Sm(qn,he.getCharCode(Vn+1),li&&En),!1))}}var nn;return s0(o0(he.length(),Nn,wn,_n,0,!0))}(bt,O,v,i,h,ot),{processBidirectionalText:le,processStyledBidirectionalText:Xt}=je;if(le&&bt.sections.length===1){const he=le(bt.toString(),Jt);for(const Xe of he){const Ze=new Ba;Ze.text=Xe,Ze.sections=bt.sections;for(let dn=0;dn<Xe.length;dn++)Ze.sectionIndex.push(0);zt.push(Ze)}}else if(Xt){const he=Xt(bt.text,bt.sectionIndex,Jt);for(const Xe of he){const Ze=new Ba;Ze.text=Xe[0],Ze.sectionIndex=Xe[1],Ze.sections=bt.sections,zt.push(Ze)}}else zt=function(he,Xe){const Ze=[],dn=he.text;let Dn=0;for(const en of Xe)Ze.push(he.substring(Dn,en)),Dn=en;return Dn<dn.length&&Ze.push(he.substring(Dn,dn.length)),Ze}(bt,Jt);const Qt=[],ge={positionedLines:Qt,text:bt.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:$,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(he,Xe,Ze,dn,Dn,en,_n,wn,En,Nn,nn,Vn){let Ai=0,qn=0,li=0;const Wn=wn==="right"?1:wn==="left"?0:.5;let ki=!1;for(const Xi of Dn){const gr=Xi.getSections();for(const vo of gr){if(vo.imageName)continue;const No=Xe[vo.fontStack];if(No&&(ki=No.ascender!==void 0&&No.descender!==void 0,!ki))break}if(!ki)break}let mr=0;for(const Xi of Dn){Xi.trim();const gr=Xi.getMaxScale(),vo=(gr-1)*_o,No={positionedGlyphs:[],lineOffset:0};he.positionedLines[mr]=No;const ko=No.positionedGlyphs;let Oo=0;if(!Xi.length()){qn+=en,++mr;continue}let Fo=0,ps=0;for(let ao=0;ao<Xi.length();ao++){const Hs=Xi.getSection(ao),Ns=Xi.getSectionIndex(ao),Fr=Xi.getCharCode(ao);let qo=Hs.scale,ua=null,yo=null,Cs=null,bl=_o,ja=0;const Ua=!(En===Vi.horizontal||!nn&&!it(Fr)||nn&&(Tm[Fr]||(pr=Fr,Ed(pr)||Cu(pr)||Md(pr)||_(pr)||A(pr))));if(Hs.imageName){const Gl=dn[Hs.imageName];if(!Gl)continue;Cs=Hs.imageName,he.iconsInText=he.iconsInText||!0,yo=Gl.paddedRect;const Ga=Gl.displaySize;qo=qo*_o/Vn,ua={width:Ga[0],height:Ga[1],left:1,top:-3,advance:Ua?Ga[1]:Ga[0],localGlyph:!1},ja=ki?-ua.height*qo:gr*_o-17-Ga[1]*qo,bl=ua.advance;const lf=(Ua?Ga[0]:Ga[1])*qo-_o*gr;lf>0&&lf>Oo&&(Oo=lf)}else{const Gl=Ze[Hs.fontStack];if(!Gl)continue;Gl[Fr]&&(yo=Gl[Fr]);const Ga=Xe[Hs.fontStack];if(!Ga)continue;const lf=Ga.glyphs[Fr];if(!lf)continue;if(ua=lf.metrics,bl=Fr!==8203?_o:0,ki){const Gm=Ga.ascender!==void 0?Math.abs(Ga.ascender):0,tv=Ga.descender!==void 0?Math.abs(Ga.descender):0,ev=(Gm+tv)*qo;Fo<ev&&(Fo=ev,ps=(Gm-tv)/2*qo),ja=-Gm*qo}else ja=(gr-qo)*_o-17}Ua?(he.verticalizable=!0,ko.push({glyph:Fr,imageName:Cs,x:Ai,y:qn+ja,vertical:Ua,scale:qo,localGlyph:ua.localGlyph,fontStack:Hs.fontStack,sectionIndex:Ns,metrics:ua,rect:yo}),Ai+=bl*qo+Nn):(ko.push({glyph:Fr,imageName:Cs,x:Ai,y:qn+ja,vertical:Ua,scale:qo,localGlyph:ua.localGlyph,fontStack:Hs.fontStack,sectionIndex:Ns,metrics:ua,rect:yo}),Ai+=ua.advance*qo+Nn)}ko.length!==0&&(li=Math.max(Ai-Nn,li),ki?a0(ko,Wn,Oo,ps,en*gr/2):a0(ko,Wn,Oo,0,en/2)),Ai=0;const Fa=en*gr+Oo;No.lineOffset=Math.max(Oo,vo),qn+=Fa,++mr}var pr;const fr=qn,{horizontalAlign:Pi,verticalAlign:so}=L_(_n);(function(Xi,gr,vo,No,ko,Oo){const Fo=(gr-vo)*ko,ps=-Oo*No;for(const Fa of Xi)for(const ao of Fa.positionedGlyphs)ao.x+=Fo,ao.y+=ps})(he.positionedLines,Wn,Pi,so,li,fr),he.top+=-so*fr,he.bottom=he.top+fr,he.left+=-Pi*li,he.right=he.left+li,he.hasBaseline=ki}(ge,i,a,h,zt,x,T,P,$,O,tt,ct),!function(he){for(const Xe of he)if(Xe.positionedGlyphs.length!==0)return!1;return!0}(Qt)&&ge}const Tm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Eo={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function r0(s,i,a,h,m,v){if(i.imageName){const x=h[i.imageName];return x?x.displaySize[0]*i.scale*_o/v+m:0}{const x=a[i.fontStack],T=x&&x.glyphs[s];return T?T.metrics.advance*i.scale+m:0}}function M_(s,i,a,h){const m=Math.pow(s-i,2);return h?s<i?m/2:2*m:m+Math.abs(a)*a}function Sm(s,i,a){let h=0;return s===10&&(h-=1e4),a&&(h+=150),s!==40&&s!==65288||(h+=50),i!==41&&i!==65289||(h+=50),h}function o0(s,i,a,h,m,v){let x=null,T=M_(i,a,m,v);for(const P of h){const O=M_(i-P.x,a,m,v)+P.badness;O<=T&&(x=P,T=O)}return{index:s,x:i,priorBreak:x,badness:T}}function s0(s){return s?s0(s.priorBreak).concat(s.index):[]}function L_(s){let i=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:i,verticalAlign:a}}function a0(s,i,a,h,m){if(!(i||a||h||m))return;const v=s.length-1,x=s[v],T=(x.x+x.metrics.advance*x.scale)*i;for(let P=0;P<=v;P++)s[P].x-=T,s[P].y+=a+h+m}function lb(s,i,a){const{horizontalAlign:h,verticalAlign:m}=L_(a),v=i[0]-s.displaySize[0]*h,x=i[1]-s.displaySize[1]*m;return{image:s,top:x,bottom:x+s.displaySize[1],left:v,right:v+s.displaySize[0]}}function l0(s,i,a,h,m,v){const x=s.image;let T;if(x.content){const zt=x.content,Jt=x.pixelRatio||1;T=[zt[0]/Jt,zt[1]/Jt,x.displaySize[0]-zt[2]/Jt,x.displaySize[1]-zt[3]/Jt]}const P=i.left*v,O=i.right*v;let V,$,tt,ot;a==="width"||a==="both"?(ot=m[0]+P-h[3],$=m[0]+O+h[1]):(ot=m[0]+(P+O-x.displaySize[0])/2,$=ot+x.displaySize[0]);const ct=i.top*v,bt=i.bottom*v;return a==="height"||a==="both"?(V=m[1]+ct-h[0],tt=m[1]+bt+h[2]):(V=m[1]+(ct+bt-x.displaySize[1])/2,tt=V+x.displaySize[1]),{image:x,top:V,right:$,bottom:tt,left:ot,collisionPadding:T}}class qc extends j{constructor(i,a,h,m,v){super(i,a),this.angle=m,this.z=h,v!==void 0&&(this.segment=v)}clone(){return new qc(this.x,this.y,this.z,this.angle,this.segment)}}function u0(s,i,a,h,m){if(i.segment===void 0)return!0;let v=i,x=i.segment+1,T=0;for(;T>-a/2;){if(x--,x<0)return!1;T-=s[x].dist(v),v=s[x]}T+=s[x].dist(s[x+1]),x++;const P=[];let O=0;for(;T<a/2;){const V=s[x],$=s[x+1];if(!$)return!1;let tt=s[x-1].angleTo(V)-V.angleTo($);for(tt=Math.abs((tt+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:T,angleDelta:tt}),O+=tt;T-P[0].distance>h;)O-=P.shift().angleDelta;if(O>m)return!1;x++,T+=V.dist($)}return!0}function c0(s){let i=0;for(let a=0;a<s.length-1;a++)i+=s[a].dist(s[a+1]);return i}function h0(s,i,a){return s?.6*i*a:0}function f0(s,i){return Math.max(s?s.right-s.left:0,i?i.right-i.left:0)}function ub(s,i,a,h,m,v){const x=h0(a,m,v),T=f0(a,h)*v;let P=0;const O=c0(s)/2;for(let V=0;V<s.length-1;V++){const $=s[V],tt=s[V+1],ot=$.dist(tt);if(P+ot>O){const ct=(O-P)/ot,bt=Ri($.x,tt.x,ct),zt=Ri($.y,tt.y,ct),Jt=new qc(bt,zt,0,tt.angleTo($),V);return!x||u0(s,Jt,T,x,i)?Jt:void 0}P+=ot}}function cb(s,i,a,h,m,v,x,T,P){const O=h0(h,v,x),V=f0(h,m),$=V*x,tt=s[0].x===0||s[0].x===P||s[0].y===0||s[0].y===P;return i-$<i/4&&(i=$+i/4),Em(s,tt?i/2*T%i:(V/2+2*v)*x*T%i,i,O,a,$,tt,!1,P)}function Em(s,i,a,h,m,v,x,T,P){const O=v/2,V=c0(s);let $=0,tt=i-a,ot=[];for(let ct=0;ct<s.length-1;ct++){const bt=s[ct],zt=s[ct+1],Jt=bt.dist(zt),le=zt.angleTo(bt);for(;tt+a<$+Jt;){tt+=a;const Xt=(tt-$)/Jt,Qt=Ri(bt.x,zt.x,Xt),ge=Ri(bt.y,zt.y,Xt);if(Qt>=0&&Qt<P&&ge>=0&&ge<P&&tt-O>=0&&tt+O<=V){const he=new qc(Qt,ge,0,le,ct);he._round(),h&&!u0(s,he,v,h,m)||ot.push(he)}}$+=Jt}return T||ot.length||x||(ot=Em(s,$/2,a,h,m,v,x,!0,P)),ot}function d0(s,i,a,h,m){const v=[];for(let x=0;x<s.length;x++){const T=s[x];let P;for(let O=0;O<T.length-1;O++){let V=T[O],$=T[O+1];V.x<i&&$.x<i||(V.x<i?V=new j(i,V.y+(i-V.x)/($.x-V.x)*($.y-V.y))._round():$.x<i&&($=new j(i,V.y+(i-V.x)/($.x-V.x)*($.y-V.y))._round()),V.y<a&&$.y<a||(V.y<a?V=new j(V.x+(a-V.y)/($.y-V.y)*($.x-V.x),a)._round():$.y<a&&($=new j(V.x+(a-V.y)/($.y-V.y)*($.x-V.x),a)._round()),V.x>=h&&$.x>=h||(V.x>=h?V=new j(h,V.y+(h-V.x)/($.x-V.x)*($.y-V.y))._round():$.x>=h&&($=new j(h,V.y+(h-V.x)/($.x-V.x)*($.y-V.y))._round()),V.y>=m&&$.y>=m||(V.y>=m?V=new j(V.x+(m-V.y)/($.y-V.y)*($.x-V.x),m)._round():$.y>=m&&($=new j(V.x+(m-V.y)/($.y-V.y)*($.x-V.x),m)._round()),P&&V.equals(P[P.length-1])||(P=[V],v.push(P)),P.push($)))))}}return v}Xn(qc,"Anchor");const nf=1e20;function p0(s,i,a,h,m,v,x,T,P){for(let O=i;O<i+h;O++)m0(s,a*v+O,v,m,x,T,P);for(let O=a;O<a+m;O++)m0(s,O*v+i,1,h,x,T,P)}function m0(s,i,a,h,m,v,x){v[0]=0,x[0]=-nf,x[1]=nf,m[0]=s[i];for(let T=1,P=0,O=0;T<h;T++){m[T]=s[i+T*a];const V=T*T;do{const $=v[P];O=(m[T]-m[$]+V-$*$)/(T-$)/2}while(O<=x[P]&&--P>-1);P++,v[P]=T,x[P]=O,x[P+1]=nf}for(let T=0,P=0;T<h;T++){for(;x[P+1]<T;)P++;const O=v[P],V=T-O;s[i+T*a]=m[O]+V*V}}const k_={none:0,ideographs:1,all:2};class ds{constructor(i,a,h){this.requestManager=i,this.localGlyphMode=a,this.localFontFamily=h,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,a){const h=[];for(const m in i)for(const v of i[m])h.push({stack:m,id:v});_e(h,({stack:m,id:v},x)=>{let T=this.entries[m];T||(T=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let P=T.glyphs[v];if(P!==void 0)return void x(null,{stack:m,id:v,glyph:P});if(P=this._tinySDF(T,m,v),P)return T.glyphs[v]=P,void x(null,{stack:m,id:v,glyph:P});const O=Math.floor(v/256);if(256*O>65535)return void x(new Error("glyphs > 65535 not supported"));if(T.ranges[O])return void x(null,{stack:m,id:v,glyph:P});let V=T.requests[O];V||(V=T.requests[O]=[],ds.loadGlyphRange(m,O,this.url,this.requestManager,($,tt)=>{if(tt){T.ascender=tt.ascender,T.descender=tt.descender;for(const ot in tt.glyphs)this._doesCharSupportLocalGlyph(+ot)||(T.glyphs[+ot]=tt.glyphs[+ot]);T.ranges[O]=!0}for(const ot of V)ot($,tt);delete T.requests[O]})),V.push(($,tt)=>{$?x($):tt&&x(null,{stack:m,id:v,glyph:tt.glyphs[v]||null})})},(m,v)=>{if(m)a(m);else if(v){const x={};for(const{stack:T,id:P,glyph:O}of v)x[T]===void 0&&(x[T]={}),x[T].glyphs===void 0&&(x[T].glyphs={}),x[T].glyphs[P]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics},x[T].ascender=this.entries[T].ascender,x[T].descender=this.entries[T].descender;a(null,x)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==k_.none&&(this.localGlyphMode===k_.all?!!this.localFontFamily:!!this.localFontFamily&&(Ef(i)||Dd(i)||iu(i)||Sf(i)||ph(i)))}_tinySDF(i,a,h){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(h))return;let v=i.tinySDF;if(!v){let bt="400";/bold/i.test(a)?bt="900":/medium/i.test(a)?bt="500":/light/i.test(a)&&(bt="200"),v=i.tinySDF=new ds.TinySDF({fontFamily:m,fontWeight:bt,fontSize:48,buffer:6,radius:16}),v.fontWeight=bt}if(this.localGlyphs[v.fontWeight][h])return this.localGlyphs[v.fontWeight][h];const x=String.fromCharCode(h),{data:T,width:P,height:O,glyphWidth:V,glyphHeight:$,glyphLeft:tt,glyphTop:ot,glyphAdvance:ct}=v.draw(x);return this.localGlyphs[v.fontWeight][h]={id:h,bitmap:new Hc({width:P,height:O},T),metrics:{width:V/2,height:$/2,left:tt/2,top:ot/2-27,advance:ct/2,localGlyph:!0}}}}function wl(s,i,a,h){const m=[],v=s.image,x=v.pixelRatio,T=v.paddedRect.w-2,P=v.paddedRect.h-2,O=s.right-s.left,V=s.bottom-s.top,$=v.stretchX||[[0,T]],tt=v.stretchY||[[0,P]],ot=(en,_n)=>en+_n[1]-_n[0],ct=$.reduce(ot,0),bt=tt.reduce(ot,0),zt=T-ct,Jt=P-bt;let le=0,Xt=ct,Qt=0,ge=bt,he=0,Xe=zt,Ze=0,dn=Jt;if(v.content&&h){const en=v.content;le=Mm($,0,en[0]),Qt=Mm(tt,0,en[1]),Xt=Mm($,en[0],en[2]),ge=Mm(tt,en[1],en[3]),he=en[0]-le,Ze=en[1]-Qt,Xe=en[2]-en[0]-Xt,dn=en[3]-en[1]-ge}const Dn=(en,_n,wn,En)=>{const Nn=Lm(en.stretch-le,Xt,O,s.left),nn=tp(en.fixed-he,Xe,en.stretch,ct),Vn=Lm(_n.stretch-Qt,ge,V,s.top),Ai=tp(_n.fixed-Ze,dn,_n.stretch,bt),qn=Lm(wn.stretch-le,Xt,O,s.left),li=tp(wn.fixed-he,Xe,wn.stretch,ct),Wn=Lm(En.stretch-Qt,ge,V,s.top),ki=tp(En.fixed-Ze,dn,En.stretch,bt),mr=new j(Nn,Vn),pr=new j(qn,Vn),fr=new j(qn,Wn),Pi=new j(Nn,Wn),so=new j(nn/x,Ai/x),Xi=new j(li/x,ki/x),gr=i*Math.PI/180;if(gr){const ko=Math.sin(gr),Oo=Math.cos(gr),Fo=[Oo,-ko,ko,Oo];mr._matMult(Fo),pr._matMult(Fo),Pi._matMult(Fo),fr._matMult(Fo)}const vo=en.stretch+en.fixed,No=_n.stretch+_n.fixed;return{tl:mr,tr:pr,bl:Pi,br:fr,tex:{x:v.paddedRect.x+1+vo,y:v.paddedRect.y+1+No,w:wn.stretch+wn.fixed-vo,h:En.stretch+En.fixed-No},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:so,pixelOffsetBR:Xi,minFontScaleX:Xe/x/O,minFontScaleY:dn/x/V,isSDF:a}};if(h&&(v.stretchX||v.stretchY)){const en=g0($,zt,ct),_n=g0(tt,Jt,bt);for(let wn=0;wn<en.length-1;wn++){const En=en[wn],Nn=en[wn+1];for(let nn=0;nn<_n.length-1;nn++)m.push(Dn(En,_n[nn],Nn,_n[nn+1]))}}else m.push(Dn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:P+1}));return m}function Mm(s,i,a){let h=0;for(const m of s)h+=Math.max(i,Math.min(a,m[1]))-Math.max(i,Math.min(a,m[0]));return h}function g0(s,i,a){const h=[{fixed:-1,stretch:0}];for(const[m,v]of s){const x=h[h.length-1];h.push({fixed:m-x.stretch,stretch:x.stretch}),h.push({fixed:m-x.stretch,stretch:x.stretch+(v-m)})}return h.push({fixed:i+1,stretch:a}),h}function Lm(s,i,a,h){return s/i*a+h}function tp(s,i,a,h){return s-i*a/h}function hb(s,i,a,h){const m=i+s.positionedLines[h].lineOffset;return h===0?a+m/2:a+(m+(i+s.positionedLines[h-1].lineOffset))/2}ds.loadGlyphRange=function(s,i,a,h,m){const v=256*i,x=v+255,T=h.transformRequest(h.normalizeGlyphsURL(a).replace("{fontstack}",s).replace("{range}",`${v}-${x}`),Hi.Glyphs);uo(T,(P,O)=>{if(P)m(P);else if(O){const V={},$=function(tt){return new Kd(tt).readFields(ob,{})}(O);for(const tt of $.glyphs)V[tt.id]=tt;m(null,{glyphs:V,ascender:$.ascender,descender:$.descender})}})},ds.TinySDF=class{constructor({fontSize:s=24,buffer:i=3,radius:a=8,cutoff:h=.25,fontFamily:m="sans-serif",fontWeight:v="normal",fontStyle:x="normal"}={}){this.buffer=i,this.cutoff=h,this.radius=a;const T=this.size=s+4*i,P=this._createCanvas(T),O=this.ctx=P.getContext("2d",{willReadFrequently:!0});O.font=`${x} ${v} ${s}px ${m}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(s){const i=document.createElement("canvas");return i.width=i.height=s,i}draw(s){const{width:i,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:m,actualBoundingBoxRight:v}=this.ctx.measureText(s),x=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-m))),P=Math.min(this.size-this.buffer,x+Math.ceil(h)),O=T+2*this.buffer,V=P+2*this.buffer,$=Math.max(O*V,0),tt=new Uint8ClampedArray($),ot={data:tt,width:O,height:V,glyphWidth:T,glyphHeight:P,glyphTop:x,glyphLeft:0,glyphAdvance:i};if(T===0||P===0)return ot;const{ctx:ct,buffer:bt,gridInner:zt,gridOuter:Jt}=this;ct.clearRect(bt,bt,T,P),ct.fillText(s,bt,bt+x);const le=ct.getImageData(bt,bt,T,P);Jt.fill(nf,0,$),zt.fill(0,0,$);for(let Xt=0;Xt<P;Xt++)for(let Qt=0;Qt<T;Qt++){const ge=le.data[4*(Xt*T+Qt)+3]/255;if(ge===0)continue;const he=(Xt+bt)*O+Qt+bt;if(ge===1)Jt[he]=0,zt[he]=nf;else{const Xe=.5-ge;Jt[he]=Xe>0?Xe*Xe:0,zt[he]=Xe<0?Xe*Xe:0}}p0(Jt,0,0,O,V,O,this.f,this.v,this.z),p0(zt,bt,bt,T,P,O,this.f,this.v,this.z);for(let Xt=0;Xt<$;Xt++){const Qt=Math.sqrt(Jt[Xt])-Math.sqrt(zt[Xt]);tt[Xt]=Math.round(255-255*(Qt/this.radius+this.cutoff))}return ot}};class fb{constructor(i=[],a=db){if(this.data=i,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:a,compare:h}=this,m=a[i];for(;i>0;){const v=i-1>>1,x=a[v];if(h(m,x)>=0)break;a[i]=x,i=v}a[i]=m}_down(i){const{data:a,compare:h}=this,m=this.length>>1,v=a[i];for(;i<m;){let x=1+(i<<1),T=a[x];const P=x+1;if(P<this.length&&h(a[P],T)<0&&(x=P,T=a[P]),h(T,v)>=0)break;a[i]=T,i=x}a[i]=v}}function db(s,i){return s<i?-1:s>i?1:0}function _0(s,i=1,a=!1){let h=1/0,m=1/0,v=-1/0,x=-1/0;const T=s[0];for(let ot=0;ot<T.length;ot++){const ct=T[ot];(!ot||ct.x<h)&&(h=ct.x),(!ot||ct.y<m)&&(m=ct.y),(!ot||ct.x>v)&&(v=ct.x),(!ot||ct.y>x)&&(x=ct.y)}const P=Math.min(v-h,x-m);let O=P/2;const V=new fb([],pb);if(P===0)return new j(h,m);for(let ot=h;ot<v;ot+=P)for(let ct=m;ct<x;ct+=P)V.push(new Yf(ot+O,ct+O,O,s));let $=function(ot){let ct=0,bt=0,zt=0;const Jt=ot[0];for(let le=0,Xt=Jt.length,Qt=Xt-1;le<Xt;Qt=le++){const ge=Jt[le],he=Jt[Qt],Xe=ge.x*he.y-he.x*ge.y;bt+=(ge.x+he.x)*Xe,zt+=(ge.y+he.y)*Xe,ct+=3*Xe}return new Yf(bt/ct,zt/ct,0,ot)}(s),tt=V.length;for(;V.length;){const ot=V.pop();(ot.d>$.d||!$.d)&&($=ot,a&&console.log("found best %d after %d probes",Math.round(1e4*ot.d)/1e4,tt)),ot.max-$.d<=i||(O=ot.h/2,V.push(new Yf(ot.p.x-O,ot.p.y-O,O,s)),V.push(new Yf(ot.p.x+O,ot.p.y-O,O,s)),V.push(new Yf(ot.p.x-O,ot.p.y+O,O,s)),V.push(new Yf(ot.p.x+O,ot.p.y+O,O,s)),tt+=4)}return a&&(console.log(`num probes: ${tt}`),console.log(`best distance: ${$.d}`)),$.p}function pb(s,i){return i.max-s.max}function Yf(s,i,a,h){this.p=new j(s,i),this.h=a,this.d=function(m,v){let x=!1,T=1/0;for(let P=0;P<v.length;P++){const O=v[P];for(let V=0,$=O.length,tt=$-1;V<$;tt=V++){const ot=O[V],ct=O[tt];ot.y>m.y!=ct.y>m.y&&m.x<(ct.x-ot.x)*(m.y-ot.y)/(ct.y-ot.y)+ot.x&&(x=!x),T=Math.min(T,by(m,ot,ct))}}return(x?1:-1)*Math.sqrt(T)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const P_=Number.POSITIVE_INFINITY,v0=Math.sqrt(2);function z_(s,[i,a]){let h=0,m=0;if(a===P_){i<0&&(i=0);const v=i/v0;switch(s){case"top-right":case"top-left":m=v-7;break;case"bottom-right":case"bottom-left":m=7-v;break;case"bottom":m=7-i;break;case"top":m=i-7}switch(s){case"top-right":case"bottom-right":h=-v;break;case"top-left":case"bottom-left":h=v;break;case"left":h=i;break;case"right":h=-i}}else{switch(i=Math.abs(i),a=Math.abs(a),s){case"top-right":case"top-left":case"top":m=a-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-a}switch(s){case"top-right":case"bottom-right":case"right":h=-i;break;case"top-left":case"bottom-left":case"left":h=i}}return[h,m]}function mb(s,i,a,h,m,v,x,T,P,O){s.createArrays(),s.tilePixelRatio=xi/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const V=s.layers[0].layout,$=s.layers[0]._unevaluatedLayout._values,tt={};if(s.textSizeData.kind==="composite"){const{minZoom:bt,maxZoom:zt}=s.textSizeData;tt.compositeTextSizes=[$["text-size"].possiblyEvaluate(new De(bt),T),$["text-size"].possiblyEvaluate(new De(zt),T)]}if(s.iconSizeData.kind==="composite"){const{minZoom:bt,maxZoom:zt}=s.iconSizeData;tt.compositeIconSizes=[$["icon-size"].possiblyEvaluate(new De(bt),T),$["icon-size"].possiblyEvaluate(new De(zt),T)]}tt.layoutTextSize=$["text-size"].possiblyEvaluate(new De(P+1),T),tt.layoutIconSize=$["icon-size"].possiblyEvaluate(new De(P+1),T),tt.textMaxSize=$["text-size"].possiblyEvaluate(new De(18),T);const ot=V.get("text-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",ct=V.get("text-size");for(const bt of s.features){const zt=V.get("text-font").evaluate(bt,{},T).join(","),Jt=ct.evaluate(bt,{},T),le=tt.layoutTextSize.evaluate(bt,{},T),Xt=(tt.layoutIconSize.evaluate(bt,{},T),{horizontal:{},vertical:void 0}),Qt=bt.text;let ge,he=[0,0];if(Qt){const dn=Qt.toString(),Dn=V.get("text-letter-spacing").evaluate(bt,{},T)*_o,en=V.get("text-line-height").evaluate(bt,{},T)*_o,_n=G(dn)?Dn:0,wn=V.get("text-anchor").evaluate(bt,{},T),En=V.get("text-variable-anchor");if(!En){const qn=V.get("text-radial-offset").evaluate(bt,{},T);he=qn?z_(wn,[qn*_o,P_]):V.get("text-offset").evaluate(bt,{},T).map(li=>li*_o)}let Nn=ot?"center":V.get("text-justify").evaluate(bt,{},T);const nn=V.get("symbol-placement")==="point",Vn=nn?V.get("text-max-width").evaluate(bt,{},T)*_o:1/0,Ai=qn=>{s.allowVerticalPlacement&&B(dn)&&(Xt.vertical=Am(Qt,i,a,m,zt,Vn,en,wn,qn,_n,he,Vi.vertical,!0,le,Jt))};if(!ot&&En){const qn=Nn==="auto"?En.map(Wn=>D_(Wn)):[Nn];let li=!1;for(let Wn=0;Wn<qn.length;Wn++){const ki=qn[Wn];if(!Xt.horizontal[ki])if(li)Xt.horizontal[ki]=Xt.horizontal[0];else{const mr=Am(Qt,i,a,m,zt,Vn,en,"center",ki,_n,he,Vi.horizontal,!1,le,Jt);mr&&(Xt.horizontal[ki]=mr,li=mr.positionedLines.length===1)}}Ai("left")}else{if(Nn==="auto"&&(Nn=D_(wn)),nn||V.get("text-writing-mode").indexOf("horizontal")>=0||!B(dn)){const qn=Am(Qt,i,a,m,zt,Vn,en,wn,Nn,_n,he,Vi.horizontal,!1,le,Jt);qn&&(Xt.horizontal[Nn]=qn)}Ai(nn?"left":Nn)}}let Xe=!1;if(bt.icon&&bt.icon.name){const dn=h[bt.icon.name];dn&&(ge=lb(m[bt.icon.name],V.get("icon-offset").evaluate(bt,{},T),V.get("icon-anchor").evaluate(bt,{},T)),Xe=dn.sdf,s.sdfIcons===void 0?s.sdfIcons=dn.sdf:s.sdfIcons!==dn.sdf&&cn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(dn.pixelRatio!==s.pixelRatio||V.get("icon-rotate").constantOr(1)!==0)&&(s.iconsNeedLinear=!0))}const Ze=y0(Xt.horizontal)||Xt.vertical;s.iconsInText||(s.iconsInText=!!Ze&&Ze.iconsInText),(Ze||ge)&&gb(s,bt,Xt,ge,h,tt,le,0,he,Xe,x,T,O)}v&&s.generateCollisionDebugBuffers(P,s.collisionBoxArray)}function D_(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function gb(s,i,a,h,m,v,x,T,P,O,V,$,tt){let ot=v.textMaxSize.evaluate(i,{},$);ot===void 0&&(ot=x);const ct=s.layers[0].layout,bt=ct.get("icon-offset").evaluate(i,{},$),zt=y0(a.horizontal)||a.vertical,Jt=tt.name==="globe",le=x/24,Xt=s.tilePixelRatio*ot/24,Qt=(_n=s.overscaling,s.zoom>18&&_n>2&&(_n>>=1),Math.max(xi/(512*_n),1)*ct.get("symbol-spacing")),ge=ct.get("text-padding")*s.tilePixelRatio,he=ct.get("icon-padding")*s.tilePixelRatio,Xe=xt(ct.get("text-max-angle")),Ze=ct.get("text-rotation-alignment")==="map"&&ct.get("symbol-placement")!=="point",dn=ct.get("icon-rotation-alignment")==="map"&&ct.get("symbol-placement")!=="point",Dn=ct.get("symbol-placement"),en=Qt/2;var _n;const wn=ct.get("icon-text-fit");let En;h&&wn!=="none"&&(s.allowVerticalPlacement&&a.vertical&&(En=l0(h,a.vertical,wn,ct.get("icon-text-fit-padding"),bt,le)),zt&&(h=l0(h,zt,wn,ct.get("icon-text-fit-padding"),bt,le)));const Nn=(nn,Vn,Ai)=>{if(Vn.x<0||Vn.x>=xi||Vn.y<0||Vn.y>=xi)return;let qn=null;if(Jt){const{x:li,y:Wn,z:ki}=tt.projectTilePoint(Vn.x,Vn.y,Ai);qn={anchor:new qc(li,Wn,ki,0,void 0),up:tt.upVector(Ai,Vn.x,Vn.y)}}(function(li,Wn,ki,mr,pr,fr,Pi,so,Xi,gr,vo,No,ko,Oo,Fo,ps,Fa,ao,Hs,Ns,Fr,qo,ua,yo,Cs){const bl=li.addToLineVertexArray(Wn,mr);let ja,Ua,Gl,Ga,lf,Gm,tv,ev=0,NA=0,OA=0,RA=0,Gb=-1,Zb=-1;const Ch={};let BA=Vh.exports("");const fp=ki?ki.anchor:Wn;let Vb=0,Wb=0;if(Xi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Vb,Wb]=Xi.layout.get("text-offset").evaluate(Fr,{},Cs).map(Pu=>Pu*_o):(Vb=Xi.layout.get("text-radial-offset").evaluate(Fr,{},Cs)*_o,Wb=P_),li.allowVerticalPlacement&&pr.vertical){const Pu=pr.vertical;if(Fo)Gm=N_(Pu),so&&(tv=N_(so));else{const zu=Xi.layout.get("text-rotate").evaluate(Fr,{},Cs)+90;Gl=km(gr,fp,Wn,vo,No,ko,Pu,Oo,zu,ps),so&&(Ga=km(gr,fp,Wn,vo,No,ko,so,ao,zu))}}if(fr){const Pu=Xi.layout.get("icon-rotate").evaluate(Fr,{},Cs),zu=Xi.layout.get("icon-text-fit")!=="none",nv=wl(fr,Pu,ua,zu),Xb=so?wl(so,Pu,ua,zu):void 0;Ua=km(gr,fp,Wn,vo,No,ko,fr,ao,Pu),ev=4*nv.length;const FA=li.iconSizeData;let dp=null;FA.kind==="source"?(dp=[So*Xi.layout.get("icon-size").evaluate(Fr,{},Cs)],dp[0]>wh&&cn(`${li.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):FA.kind==="composite"&&(dp=[So*qo.compositeIconSizes[0].evaluate(Fr,{},Cs),So*qo.compositeIconSizes[1].evaluate(Fr,{},Cs)],(dp[0]>wh||dp[1]>wh)&&cn(`${li.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),li.addSymbols(li.icon,nv,dp,Ns,Hs,Fr,!1,ki,Wn,bl.lineStartIndex,bl.lineLength,-1,yo,Cs),Gb=li.icon.placedSymbolArray.length-1,Xb&&(NA=4*Xb.length,li.addSymbols(li.icon,Xb,dp,Ns,Hs,Fr,Vi.vertical,ki,Wn,bl.lineStartIndex,bl.lineLength,-1,yo,Cs),Zb=li.icon.placedSymbolArray.length-1)}for(const Pu in pr.horizontal){const zu=pr.horizontal[Pu];ja||(BA=Vh.exports(zu.text),Fo?lf=N_(zu):ja=km(gr,fp,Wn,vo,No,ko,zu,Oo,Xi.layout.get("text-rotate").evaluate(Fr,{},Cs),ps));const nv=zu.positionedLines.length===1;if(OA+=rf(li,ki,Wn,zu,Pi,Xi,Fo,Fr,ps,bl,pr.vertical?Vi.horizontal:Vi.horizontalOnly,nv?Object.keys(pr.horizontal):[Pu],Ch,Gb,qo,yo,Cs),nv)break}pr.vertical&&(RA+=rf(li,ki,Wn,pr.vertical,Pi,Xi,Fo,Fr,ps,bl,Vi.vertical,["vertical"],Ch,Zb,qo,yo,Cs));let Kf=-1;const Yb=(Pu,zu)=>Pu?Math.max(Pu,zu):zu;Kf=Yb(lf,Kf),Kf=Yb(Gm,Kf),Kf=Yb(tv,Kf);const $k=Kf>-1?1:0;li.glyphOffsetArray.length>=bh.MAX_GLYPHS&&cn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fr.sortKey!==void 0&&li.addToSortKeyRanges(li.symbolInstances.length,Fr.sortKey),li.symbolInstances.emplaceBack(fp.x,fp.y,fp.z,Wn.x,Wn.y,Ch.right>=0?Ch.right:-1,Ch.center>=0?Ch.center:-1,Ch.left>=0?Ch.left:-1,Ch.vertical>=0?Ch.vertical:-1,Gb,Zb,BA,ja!==void 0?ja:li.collisionBoxArray.length,ja!==void 0?ja+1:li.collisionBoxArray.length,Gl!==void 0?Gl:li.collisionBoxArray.length,Gl!==void 0?Gl+1:li.collisionBoxArray.length,Ua!==void 0?Ua:li.collisionBoxArray.length,Ua!==void 0?Ua+1:li.collisionBoxArray.length,Ga||li.collisionBoxArray.length,Ga?Ga+1:li.collisionBoxArray.length,vo,OA,RA,ev,NA,$k,0,Vb,Wb,Kf)})(s,Vn,qn,nn,a,h,m,En,s.layers[0],s.collisionBoxArray,i.index,i.sourceLayerIndex,s.index,ge,Ze,P,0,he,dn,bt,i,v,O,V,$)};if(Dn==="line")for(const nn of d0(i.geometry,0,0,xi,xi)){const Vn=cb(nn,Qt,Xe,a.vertical||zt,h,24,Xt,s.overscaling,xi);for(const Ai of Vn){const qn=zt;qn&&_b(s,qn.text,en,Ai)||Nn(nn,Ai,$)}}else if(Dn==="line-center"){for(const nn of i.geometry)if(nn.length>1){const Vn=ub(nn,Xe,a.vertical||zt,h,24,Xt);Vn&&Nn(nn,Vn,$)}}else if(i.type==="Polygon")for(const nn of p_(i.geometry,0)){const Vn=_0(nn,16);Nn(nn[0],new qc(Vn.x,Vn.y,0,0,void 0),$)}else if(i.type==="LineString")for(const nn of i.geometry)Nn(nn,new qc(nn[0].x,nn[0].y,0,0,void 0),$);else if(i.type==="Point")for(const nn of i.geometry)for(const Vn of nn)Nn([Vn],new qc(Vn.x,Vn.y,0,0,void 0),$)}const wh=32640;function rf(s,i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct,bt,zt){const Jt=function(Qt,ge,he,Xe,Ze,dn,Dn,en){const _n=[];if(ge.positionedLines.length===0)return _n;const wn=Xe.layout.get("text-rotate").evaluate(dn,{})*Math.PI/180,En=function(qn){const li=qn[0],Wn=qn[1],ki=li*Wn;return ki>0?[li,-Wn]:ki<0?[-li,Wn]:li===0?[Wn,li]:[Wn,-li]}(he);let Nn=Math.abs(ge.top-ge.bottom);for(const qn of ge.positionedLines)Nn-=qn.lineOffset;const nn=ge.positionedLines.length,Vn=Nn/nn;let Ai=ge.top-he[1];for(let qn=0;qn<nn;++qn){const li=ge.positionedLines[qn];Ai=hb(ge,Vn,Ai,qn);for(const Wn of li.positionedGlyphs){if(!Wn.rect)continue;const ki=Wn.rect||{};let mr=4,pr=!0,fr=1,Pi=0;if(Wn.imageName){const yo=Dn[Wn.imageName];if(!yo)continue;if(yo.sdf){cn("SDF images are not supported in formatted text and will be ignored.");continue}pr=!1,fr=yo.pixelRatio,mr=1/fr}const so=(Ze||en)&&Wn.vertical,Xi=Wn.metrics.advance*Wn.scale/2,gr=Wn.metrics,vo=Wn.rect;if(vo===null)continue;en&&ge.verticalizable&&(Pi=Wn.imageName?Xi-Wn.metrics.width*Wn.scale/2:0);const No=Ze?[Wn.x+Xi,Wn.y]:[0,0];let ko=[0,0],Oo=[0,0],Fo=!1;Ze||(so?(Oo=[Wn.x+Xi+En[0],Wn.y+En[1]-Pi],Fo=!0):ko=[Wn.x+Xi+he[0],Wn.y+he[1]-Pi]);const ps=vo.w*Wn.scale/(fr*(Wn.localGlyph?2:1)),Fa=vo.h*Wn.scale/(fr*(Wn.localGlyph?2:1));let ao,Hs,Ns,Fr;if(so){const yo=Wn.y-Ai,Cs=new j(-Xi,Xi-yo),bl=-Math.PI/2,ja=new j(...Oo);ao=new j(-Xi+ko[0],ko[1]),ao._rotateAround(bl,Cs)._add(ja),ao.x+=-yo+Xi,ao.y-=(gr.left-mr)*Wn.scale;const Ua=Wn.imageName?gr.advance*Wn.scale:_o*Wn.scale,Gl=String.fromCharCode(Wn.glyph);tb(Gl)?ao.x+=(1-mr)*Wn.scale:C_(Gl)?ao.x+=Ua-gr.height*Wn.scale+(-mr-1)*Wn.scale:ao.x+=Wn.imageName||gr.width+2*mr===vo.w&&gr.height+2*mr===vo.h?(Ua-Fa)/2:(Ua-(gr.height+2*mr)*Wn.scale)/2,Hs=new j(ao.x,ao.y-ps),Ns=new j(ao.x+Fa,ao.y),Fr=new j(ao.x+Fa,ao.y-ps)}else{const yo=(gr.left-mr)*Wn.scale-Xi+ko[0],Cs=(-gr.top-mr)*Wn.scale+ko[1],bl=yo+ps,ja=Cs+Fa;ao=new j(yo,Cs),Hs=new j(bl,Cs),Ns=new j(yo,ja),Fr=new j(bl,ja)}if(wn){let yo;yo=Ze?new j(0,0):Fo?new j(En[0],En[1]):new j(he[0],he[1]),ao._rotateAround(wn,yo),Hs._rotateAround(wn,yo),Ns._rotateAround(wn,yo),Fr._rotateAround(wn,yo)}const qo=new j(0,0),ua=new j(0,0);_n.push({tl:ao,tr:Hs,bl:Ns,br:Fr,tex:ki,writingMode:ge.writingMode,glyphOffset:No,sectionIndex:Wn.sectionIndex,isSDF:pr,pixelOffsetTL:qo,pixelOffsetBR:ua,minFontScaleX:0,minFontScaleY:0})}}return _n}(0,h,P,v,x,T,m,s.allowVerticalPlacement),le=s.textSizeData;let Xt=null;le.kind==="source"?(Xt=[So*v.layout.get("text-size").evaluate(T,{},zt)],Xt[0]>wh&&cn(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):le.kind==="composite"&&(Xt=[So*ct.compositeTextSizes[0].evaluate(T,{},zt),So*ct.compositeTextSizes[1].evaluate(T,{},zt)],(Xt[0]>wh||Xt[1]>wh)&&cn(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,Jt,Xt,P,x,T,V,i,a,O.lineStartIndex,O.lineLength,ot,bt,zt);for(const Qt of $)tt[Qt]=s.text.placedSymbolArray.length-1;return 4*Jt.length}function y0(s){for(const i in s)return s[i];return null}function km(s,i,a,h,m,v,x,T,P,O){let V=x.top,$=x.bottom,tt=x.left,ot=x.right;const ct=x.collisionPadding;if(ct&&(tt-=ct[0],V-=ct[1],ot+=ct[2],$+=ct[3]),P){const bt=new j(tt,V),zt=new j(ot,V),Jt=new j(tt,$),le=new j(ot,$),Xt=xt(P);let Qt=new j(0,0);O&&(Qt=new j(O[0],O[1])),bt._rotateAround(Xt,Qt),zt._rotateAround(Xt,Qt),Jt._rotateAround(Xt,Qt),le._rotateAround(Xt,Qt),tt=Math.min(bt.x,zt.x,Jt.x,le.x),ot=Math.max(bt.x,zt.x,Jt.x,le.x),V=Math.min(bt.y,zt.y,Jt.y,le.y),$=Math.max(bt.y,zt.y,Jt.y,le.y)}return s.emplaceBack(i.x,i.y,i.z,a.x,a.y,tt,V,ot,$,T,h,m,v),s.length-1}function N_(s){s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const i=s.bottom-s.top;return i>0?Math.max(10,i):null}function _b(s,i,a,h){const m=s.compareText;if(i in m){const v=m[i];for(let x=v.length-1;x>=0;x--)if(h.dist(v[x])<a)return!0}else m[i]=[];return m[i].push(h),!1}const vb=Kn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:O_}=vb,R_=Kn([{name:"a_pos_3",components:3,type:"Int16"}]);var ep=Kn([{name:"a_pos",type:"Int16",components:2}]);const Jc=xi/Math.PI/2,B_=2*lu(1,0)*Jc*Math.PI,Xf=64,Hf=[Xf,32,16],Lu=-Jc,ku=Jc,yb=[new el([Lu,Lu,Lu],[ku,ku,ku]),new el([Lu,Lu,Lu],[0,0,ku]),new el([0,Lu,Lu],[ku,0,ku]),new el([Lu,0,Lu],[0,ku,ku]),new el([0,0,Lu],[ku,ku,ku])];function x0(s,i,a,h=!0){const m=uu([],s._camera.position,s.worldSize),v=[i,a,1,1];vh(v,v,s.pixelMatrixInverse),Ty(v,v,1/v[3]);const x=tl([],ec([],v,m)),T=s.globeMatrix,P=[T[12],T[13],T[14]],O=ec([],P,m),V=Kh(O),$=tl([],O),tt=s.worldSize/(2*Math.PI),ot=Eu($,x),ct=Math.asin(tt/V);if(ct<Math.acos(ot)){if(!h)return null;const Dn=[],en=[];uu(Dn,x,V/ot),tl(en,ec(en,Dn,O)),tl(x,Cc(x,O,uu(x,en,Math.tan(ct)*V)))}const bt=[];new um(m,x).closestPointOnSphere(P,tt,bt);const zt=tl([],we(T,0)),Jt=tl([],we(T,1)),le=tl([],we(T,2)),Xt=Eu(zt,bt),Qt=Eu(Jt,bt),ge=Eu(le,bt),he=kt(Math.asin(-Qt/tt));let Xe=kt(Math.atan2(Xt,ge));Xe=s.center.lng+function(Dn,en){const _n=(en-Dn+180)%360-180;return _n<-180?_n+360:_n}(s.center.lng,Xe);const Ze=Ju(Xe),dn=ie(au(he),0,1);return new Xh(Ze,dn)}class xb{constructor(i,a,h){this.a=ec([],i,h),this.b=ec([],a,h),this.center=h;const m=tl([],this.a),v=tl([],this.b);this.angle=Math.acos(Eu(m,v))}}function F_(s,i){if(s.angle===0)return null;let a;return a=s.a[i]===0?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[i]/s.a[i]/Math.sin(s.angle)-1/Math.tan(s.angle)),a<0||a>1?null:function(h,m,v,x){const T=Math.sin(v);return h*(Math.sin((1-x)*v)/T)+m*(Math.sin(x*v)/T)}(s.a[i],s.b[i],s.angle,ie(a,0,1))+s.center[i]}function Sc(s){if(s.z<=1)return yb[s.z+2*s.y+s.x];const i=j_(Pm(s));return el.fromPoints(i)}function of(s,i,a){return uu(s,s,1-a),Bf(s,s,i,a)}function w0(s,i){const a=sf(i.zoom);if(a===0)return Sc(s);const h=Pm(s),m=j_(h),v=Ju(h.getWest())*i.worldSize,x=Ju(h.getEast())*i.worldSize,T=au(h.getNorth())*i.worldSize,P=au(h.getSouth())*i.worldSize,O=[v,T,0],V=[x,T,0],$=[v,P,0],tt=[x,P,0],ot=am([],i.globeMatrix);return os(O,O,ot),os(V,V,ot),os($,$,ot),os(tt,tt,ot),m[0]=of(m[0],$,a),m[1]=of(m[1],tt,a),m[2]=of(m[2],V,a),m[3]=of(m[3],O,a),el.fromPoints(m)}function b0(s,i,a){for(const h of s)os(h,h,i),uu(h,h,a)}function wb(s,i,a){const h=i/s.worldSize,m=s.globeMatrix;if(a.z<=1){const Ze=Sc(a).getCorners();return b0(Ze,m,h),el.fromPoints(Ze)}const v=Pm(a),x=j_(v);b0(x,m,h);const T=Number.MAX_VALUE,P=[-T,-T,-T],O=[T,T,T];if(v.contains(s.center)){for(const Dn of x)Bl(O,O,Dn),tc(P,P,Dn);P[2]=0;const Ze=s.point,dn=[Ze.x*h,Ze.y*h,0];return Bl(O,O,dn),tc(P,P,dn),new el(O,P)}const V=[m[12]*h,m[13]*h,m[14]*h],$=v.getCenter(),tt=ie(s.center.lat,-85.051129,wa),ot=ie($.lat,-85.051129,wa),ct=Ju(s.center.lng),bt=au(tt);let zt=ct-Ju($.lng);const Jt=bt-au(ot);zt>.5?zt-=1:zt<-.5&&(zt+=1);let le=0;Math.abs(zt)>Math.abs(Jt)?le=zt>=0?1:3:(le=Jt>=0?0:2,Bf(V,V,[m[4]*h,m[5]*h,m[6]*h],-Math.sin(xt(Jt>=0?v.getSouth():v.getNorth()))*Jc));const Xt=x[le],Qt=x[(le+1)%4],ge=new xb(Xt,Qt,V),he=[F_(ge,0)||Xt[0],F_(ge,1)||Xt[1],F_(ge,2)||Xt[2]],Xe=sf(s.zoom);if(Xe>0){const Ze=function({x:Dn,y:en,z:_n},wn,En,Nn,nn){const Vn=1/(1<<_n);let Ai=Dn*Vn,qn=Ai+Vn,li=en*Vn,Wn=li+Vn,ki=0;const mr=(Ai+qn)/2-Nn;return mr>.5?ki=-1:mr<-.5&&(ki=1),Ai=((Ai+ki)*wn-(Nn*=wn))*En+Nn,qn=((qn+ki)*wn-Nn)*En+Nn,li=(li*wn-(nn*=wn))*En+nn,Wn=(Wn*wn-nn)*En+nn,[[Ai,Wn,0],[qn,Wn,0],[qn,li,0],[Ai,li,0]]}(a,i,s._pixelsPerMercatorPixel,ct,bt);for(let Dn=0;Dn<x.length;Dn++)of(x[Dn],Ze[Dn],Xe);const dn=Cc([],Ze[le],Ze[(le+1)%4]);uu(dn,dn,.5),of(he,dn,Xe)}for(const Ze of x)Bl(O,O,Ze),tc(P,P,Ze);return O[2]=Math.min(Xt[2],Qt[2]),Bl(O,O,he),tc(P,P,he),new el(O,P)}function Pm({x:s,y:i,z:a}){const h=1/(1<<a),m=new br(xl(s*h),xa((i+1)*h)),v=new br(xl((s+1)*h),xa(i*h));return new Yc(m,v)}function j_(s){const i=xt(s.getNorth()),a=xt(s.getSouth()),h=Math.cos(i),m=Math.cos(a),v=Math.sin(i),x=Math.sin(a),T=s.getWest(),P=s.getEast();return[$f(m,x,T),$f(m,x,P),$f(h,v,P),$f(h,v,T)]}function $f(s,i,a,h=Jc){return a=xt(a),[s*Math.sin(a)*h,-i*h,s*Math.cos(a)*h]}function np(s,i,a){return $f(Math.cos(xt(s)),Math.sin(xt(s)),i,a)}function ip(s,i,a,h){const m=1<<a.z,v=(s/xi+a.x)/m;return np(xa((i/xi+a.y)/m),xl(v),h)}function zm({min:s,max:i}){return 16383/Math.max(i[0]-s[0],i[1]-s[1],i[2]-s[2])}const I0=new Float64Array(16);function rp(s){const i=zm(s),a=t_(I0,[i,i,i]);return Fd(a,a,((h=[])[0]=-(m=s.min)[0],h[1]=-m[1],h[2]=-m[2],h));var h,m}function U_(s){const i=(h=s.min,(a=I0)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=h[0],a[13]=h[1],a[14]=h[2],a[15]=1,a);var a,h;const m=1/zm(s);return Jh(i,i,[m,m,m])}function Dm(s,i,a,h,m){const v=function(P){const O=xi/(2*Math.PI);return P/(2*Math.PI)/O}(a),x=[s,i,-a/(2*Math.PI)],T=Su(new Float64Array(16));return Fd(T,T,x),Jh(T,T,[v,v,v]),Qg(T,T,xt(-m)),jd(T,T,xt(-h)),T}function sf(s){return ln(5,6,s)}function G_(s,i){const a=np(i.lat,i.lng),h=function(ct){const bt=np(ct._center.lat,ct._center.lng);let zt=i_([],Qh(0,1,0),bt);const Jt=Cy([],-ct.angle,bt);zt=os(zt,zt,Jt),Cy(Jt,-ct._pitch,zt);const le=tl([],bt);return uu(le,le,ct.cameraToCenterDistance/ct.pixelsPerMeter*B_),os(le,le,Jt),Cc([],bt,le)}(s);return x=(m=Rf([],h,a))[0],T=m[1],P=m[2],O=(v=a)[0],V=v[1],$=v[2],ot=(tt=Math.sqrt(x*x+T*T+P*P)*Math.sqrt(O*O+V*V+$*$))&&Eu(m,v)/tt,Math.acos(Math.min(Math.max(ot,-1),1));var m,v,x,T,P,O,V,$,tt,ot}function Z_(s,i){return G_(s,i)>Math.PI/2*1.01}const C0=xt(85),bb=Math.cos(C0),V_=Math.sin(C0);function A0(s,i){const a=s.fovAboveCenter,h=s.elevation?s.elevation.getMinElevationBelowMSL()*i:0,m=(s._camera.position[2]*s.worldSize-h)/Math.cos(s._pitch),v=Math.sin(a)*m/Math.sin(Math.max(Math.PI/2-s._pitch-a,.01)),x=Math.sin(s._pitch)*v+m;return Math.min(1.01*x,m*(1/s._horizonShift))}function af(s,i){if(!i.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:i};const a=Math.pow(2,-s.z),h=s.x*a,m=(s.x+1)*a,v=s.y*a,x=(s.y+1)*a,T=xl(h),P=xl(m),O=xa(v),V=xa(x),$=i.project(T,O),tt=i.project(P,O),ot=i.project(P,V),ct=i.project(T,V);let bt=Math.min($.x,tt.x,ot.x,ct.x),zt=Math.min($.y,tt.y,ot.y,ct.y),Jt=Math.max($.x,tt.x,ot.x,ct.x),le=Math.max($.y,tt.y,ot.y,ct.y);const Xt=a/16;function Qt(he,Xe,Ze,dn,Dn,en){const _n=(Ze+Dn)/2,wn=(dn+en)/2,En=i.project(xl(_n),xa(wn)),Nn=Math.max(0,bt-En.x,zt-En.y,En.x-Jt,En.y-le);bt=Math.min(bt,En.x),Jt=Math.max(Jt,En.x),zt=Math.min(zt,En.y),le=Math.max(le,En.y),Nn>Xt&&(Qt(he,En,Ze,dn,_n,wn),Qt(En,Xe,_n,wn,Dn,en))}Qt($,tt,h,v,m,v),Qt(tt,ot,m,v,m,x),Qt(ot,ct,m,x,h,x),Qt(ct,$,h,x,h,v),bt-=Xt,zt-=Xt,Jt+=Xt,le+=Xt;const ge=1/Math.max(Jt-bt,le-zt);return{scale:ge,x:bt*ge,y:zt*ge,x2:Jt*ge,y2:le*ge,projection:i}}const Ib=Su(new Float32Array(16));class Ds{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,a){return{x:0,y:0,z:0}}unproject(i,a){return new br(0,0)}projectTilePoint(i,a,h){return{x:i,y:a,z:0}}locationPoint(i,a,h=!0){return i._coordinatePoint(i.locationCoordinate(a),h)}pixelsPerMeter(i,a){return lu(1,i)*a}pixelSpaceConversion(i,a,h){return 1}farthestPixelDistance(i){return A0(i,i.pixelsPerMeter)}pointCoordinate(i,a,h,m){const v=i.horizonLineFromTop(!1),x=new j(a,Math.max(v,h));return i.rayIntersectionCoordinate(i.pointRayIntersection(x,m))}pointCoordinate3D(i,a,h){const m=new j(a,h);if(i.elevation)return i.elevation.pointCoordinate(m);{const v=this.pointCoordinate(i,m.x,m.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(i,a){if(i.elevation)return!this.pointCoordinate3D(i,a.x,a.y);const h=i.horizonLineFromTop();return a.y<h}createInversionMatrix(i,a){return Ib}createTileMatrix(i,a,h){let m,v,x;const T=h.canonical,P=Su(new Float64Array(16));if(this.isReprojectedInTileSpace){const O=af(T,this);m=1,v=O.x+h.wrap*O.scale,x=O.y,Jh(P,P,[m/O.scale,m/O.scale,i.pixelsPerMeter/a])}else m=a/i.zoomScale(T.z),v=(T.x+Math.pow(2,T.z)*h.wrap)*m,x=T.y*m;return Fd(P,P,[v,x,0]),Jh(P,P,[m/xi,m/xi,1]),P}upVector(i,a,h){return[0,0,1]}upVectorScale(i,a,h){return{metersToTile:1}}}class W_ extends Ds{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[a,h]=this.parallels=i.parallels||[29.5,45.5],m=Math.sin(xt(a));this.n=(m+Math.sin(xt(h)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(i,a){const{n:h,c:m,r0:v}=this,x=xt(i-this.center[0]),T=xt(a),P=Math.sqrt(m-2*h*Math.sin(T))/h;return{x:P*Math.sin(x*h),y:P*Math.cos(x*h)-v,z:0}}unproject(i,a){const{n:h,c:m,r0:v}=this,x=v+a;let T=Math.atan2(i,Math.abs(x))*Math.sign(x);x*h<0&&(T-=Math.PI*Math.sign(i)*Math.sign(x));const P=xt(this.center[0])*h;T=Le(T,-Math.PI-P,Math.PI-P);const O=ie(kt(T/h)+this.center[0],-180,180),V=Math.asin(ie((m-(i*i+x*x)*h*h)/(2*h),-1,1)),$=ie(kt(V),-85.051129,wa);return new br(O,$)}}const op=1.340264,sp=-.081106,ap=893e-6,lp=.003796,qf=Math.sqrt(3)/2;class Cb extends Ds{project(i,a){a=a/180*Math.PI,i=i/180*Math.PI;const h=Math.asin(qf*Math.sin(a)),m=h*h,v=m*m*m;return{x:.5*(i*Math.cos(h)/(qf*(op+3*sp*m+v*(7*ap+9*lp*m)))/Math.PI+.5),y:1-.5*(h*(op+sp*m+v*(ap+lp*m))/Math.PI+1),z:0}}unproject(i,a){i=(2*i-.5)*Math.PI;let h=a=(2*(1-a)-1)*Math.PI,m=h*h,v=m*m*m;for(let V,$,tt,ot=0;ot<12&&($=h*(op+sp*m+v*(ap+lp*m))-a,tt=op+3*sp*m+v*(7*ap+9*lp*m),V=$/tt,h=ie(h-V,-Math.PI/3,Math.PI/3),m=h*h,v=m*m*m,!(Math.abs(V)<1e-12));++ot);const x=qf*i*(op+3*sp*m+v*(7*ap+9*lp*m))/Math.cos(h),T=Math.asin(Math.sin(h)/qf),P=ie(180*x/Math.PI,-180,180),O=ie(180*T/Math.PI,-85.051129,wa);return new br(P,O)}}class Y_ extends Ds{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,a){return{x:.5+i/360,y:.5-a/360,z:0}}unproject(i,a){const h=360*(i-.5),m=ie(360*(.5-a),-85.051129,wa);return new br(h,m)}}const Jf=Math.PI/2;function Nm(s){return Math.tan((Jf+s)/2)}class Ab extends Ds{constructor(i){super(i),this.center=i.center||[0,30];const[a,h]=this.parallels=i.parallels||[30,30];let m=xt(a),v=xt(h);this.southernCenter=m+v<0,this.southernCenter&&(m=-m,v=-v);const x=Math.cos(m),T=Nm(m);this.n=m===v?Math.sin(m):Math.log(x/Math.cos(v))/Math.log(Nm(v)/T),this.f=x*Math.pow(Nm(m),this.n)/this.n}project(i,a){a=xt(a),this.southernCenter&&(a=-a),i=xt(i-this.center[0]);const h=1e-6,{n:m,f:v}=this;v>0?a<-Jf+h&&(a=-Jf+h):a>Jf-h&&(a=Jf-h);const x=v/Math.pow(Nm(a),m);let T=x*Math.sin(m*i),P=v-x*Math.cos(m*i);return T=.5*(T/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:T,y:this.southernCenter?P:1-P,z:0}}unproject(i,a){i=(2*i-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:h,f:m}=this,v=m-a,x=Math.sign(v),T=Math.sign(h)*Math.sqrt(i*i+v*v);let P=Math.atan2(i,Math.abs(v))*x;v*h<0&&(P-=Math.PI*Math.sign(i)*x);const O=ie(kt(P/h)+this.center[0],-180,180),V=ie(kt(2*Math.atan(Math.pow(m/T,1/h))-Jf),-85.051129,wa);return new br(O,this.southernCenter?-V:V)}}class T0 extends Ds{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,a){return{x:Ju(i),y:au(a),z:0}}unproject(i,a){const h=xl(i),m=xa(a);return new br(h,m)}}const X_=xt(wa);class Tb extends Ds{project(i,a){const h=(a=xt(a))*a,m=h*h;return{x:.5*((i=xt(i))*(.8707-.131979*h+m*(m*(.003971*h-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+h*(.015085+m*(.028874*h-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(i,a){i=(2*i-.5)*Math.PI;let h=a=(2*(1-a)-1)*Math.PI,m=25,v=0,x=h*h;do{x=h*h;const O=x*x;v=(h*(1.007226+x*(.015085+O*(.028874*x-.044475-.005916*O)))-a)/(1.007226+x*(.045255+O*(.259866*x-.311325-.005916*11*O))),h=ie(h-v,-X_,X_)}while(Math.abs(v)>1e-6&&--m>0);x=h*h;const T=ie(kt(i/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),P=kt(h);return new br(T,P)}}const S0=xt(wa);class Sb extends Ds{project(i,a){a=xt(a),i=xt(i);const h=Math.cos(a),m=2/Math.PI,v=Math.acos(h*Math.cos(i/2)),x=Math.sin(v)/v,T=.5*(i*m+2*h*Math.sin(i/2)/x)||0,P=.5*(a+Math.sin(a)/x)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(i,a){let h=i=(2*i-.5)*Math.PI,m=a=(2*(1-a)-1)*Math.PI,v=25;const x=1e-6;let T=0,P=0;do{const O=Math.cos(m),V=Math.sin(m),$=2*V*O,tt=V*V,ot=O*O,ct=Math.cos(h/2),bt=Math.sin(h/2),zt=2*ct*bt,Jt=bt*bt,le=1-ot*ct*ct,Xt=le?1/le:0,Qt=le?Math.acos(O*ct)*Math.sqrt(1/le):0,ge=.5*(2*Qt*O*bt+2*h/Math.PI)-i,he=.5*(Qt*V+m)-a,Xe=.5*Xt*(ot*Jt+Qt*O*ct*tt)+1/Math.PI,Ze=Xt*(zt*$/4-Qt*V*bt),dn=.125*Xt*($*bt-Qt*V*ot*zt),Dn=.5*Xt*(tt*ct+Qt*Jt*O)+.5,en=Ze*dn-Dn*Xe;T=(he*Ze-ge*Dn)/en,P=(ge*dn-he*Xe)/en,h=ie(h-T,-Math.PI,Math.PI),m=ie(m-P,-S0,S0)}while((Math.abs(T)>x||Math.abs(P)>x)&&--v>0);return new br(kt(h),kt(m))}}class Om extends Ds{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(xt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,a){const{scale:h,cosPhi:m}=this;return{x:xt(i)*m*h+.5,y:-Math.sin(xt(a))/m*h+.5,z:0}}unproject(i,a){const{scale:h,cosPhi:m}=this,v=-(a-.5)/h,x=ie(kt((i-.5)/h)/m,-180,180),T=Math.asin(ie(v*m,-1,1)),P=ie(kt(T),-85.051129,wa);return new br(x,P)}}class H_ extends T0{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(i,a,h){const m=ip(i,a,h);return os(m,m,rp(Sc(h))),{x:m[0],y:m[1],z:m[2]}}locationPoint(i,a){const h=np(a.lat,a.lng),m=tl([],h),v=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(a),i._centerAltitude):i._centerAltitude;Bf(h,h,m,lu(1,0)*xi*v);const x=Su(new Float64Array(16));return qh(x,i.pixelMatrix,i.globeMatrix),os(h,h,x),new j(h[0],h[1])}pixelsPerMeter(i,a){return lu(1,0)*a}pixelSpaceConversion(i,a,h){const m=lu(1,i)*a,v=Ri(lu(1,45)*a,m,h);return this.pixelsPerMeter(i,a)/v}createTileMatrix(i,a,h){const m=U_(Sc(h.canonical));return qh(new Float64Array(16),i.globeMatrix,m)}createInversionMatrix(i,a){const{center:h}=i,m=rp(Sc(a));return jd(m,m,xt(h.lng)),Qg(m,m,xt(h.lat)),Jh(m,m,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(i,a,h,m){return x0(i,a,h,!0)||new Xh(0,0)}pointCoordinate3D(i,a,h){const m=this.pointCoordinate(i,a,h,0);return[m.x,m.y,m.z]}isPointAboveHorizon(i,a){return!x0(i,a.x,a.y,!1)}farthestPixelDistance(i){const a=function(m,v){const x=m.cameraToCenterDistance,T=m._centerAltitude*v,P=m._camera,O=m._camera.forward(),V=Cc([],uu([],O,-x),[0,0,T]),$=m.worldSize/(2*Math.PI),tt=[0,0,-$],ot=m.width/m.height,ct=Math.tan(m.fovAboveCenter),bt=uu([],P.up(),ct),zt=uu([],P.right(),ct*ot),Jt=tl([],Cc([],Cc([],O,bt),zt)),le=[];let Xt;if(new um(V,Jt).closestPointOnSphere(tt,$,le)){const Qt=Cc([],le,tt),ge=ec([],Qt,V);Xt=Math.cos(m.fovAboveCenter)*Kh(ge)}else{const Qt=ec([],V,tt),ge=ec([],tt,V);tl(ge,ge);const he=Kh(Qt)-$;Xt=Math.sqrt(he*(he+2*$));const Xe=Math.acos(Xt/($+he))-Math.acos(Eu(O,ge));Xt*=Math.cos(Xe)}return 1.01*Xt}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),h=sf(i.zoom);if(h>0){const m=A0(i,lu(1,i.center.lat)*i.worldSize),v=i.worldSize/(2*Math.PI),x=Math.max(i.width,i.height)/i.worldSize*Math.PI;return Ri(a,m+v*(1-Math.cos(x)),Math.pow(h,10))}return a}upVector(i,a,h){return ip(a,h,i,1)}upVectorScale(i){return{metersToTile:B_*zm(Sc(i))}}}function E0(s){const i=s.parallels,a=!!i&&Math.abs(i[0]+i[1])<.01;switch(s.name){case"mercator":return new T0(s);case"equirectangular":return new Y_(s);case"naturalEarth":return new Tb(s);case"equalEarth":return new Cb(s);case"winkelTripel":return new Sb(s);case"albers":return a?new Om(s):new W_(s);case"lambertConformalConic":return a?new Om(s):new Ab(s);case"globe":return new H_(s)}throw new Error(`Invalid projection name: ${s.name}`)}const Eb=gm.types,Mb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Rm(s,i,a,h,m,v,x,T,P,O,V,$,tt){const ot=T?Math.min(wh,Math.round(T[0])):0,ct=T?Math.min(wh,Math.round(T[1])):0;s.emplaceBack(i,a,Math.round(32*h),Math.round(32*m),v,x,(ot<<1)+(P?1:0),ct,16*O,16*V,256*$,256*tt)}function Bm(s,i,a,h,m,v,x){s.emplaceBack(i,a,h,m,v,x)}function Fm(s,i,a,h,m){s.emplaceBack(i,a,h,m),s.emplaceBack(i,a,h,m),s.emplaceBack(i,a,h,m),s.emplaceBack(i,a,h,m)}function Lb(s){for(const i of s.sections)if(Bt(i.text))return!0;return!1}class $_{constructor(i){this.layoutVertexArray=new Yr,this.indexArray=new aa,this.programConfigurations=i,this.segments=new cs,this.dynamicLayoutVertexArray=new Ra,this.opacityVertexArray=new Ho,this.placedSymbolArray=new hy,this.globeExtVertexArray=new kr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,a,h,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Hw.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,$w.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Mb,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,nc.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Xn($_,"SymbolBuffers");class q_{constructor(i,a,h){this.layoutVertexArray=new i,this.layoutAttributes=a,this.indexArray=new h,this.segments=new cs,this.collisionVertexArray=new Zh,this.collisionVertexArrayExt=new ou}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,qw.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,ef.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Xn(q_,"CollisionBuffers");class bh{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(x=>x.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Su([]),this.placementViewportMatrix=Su([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=I_(this.zoom,a["text-size"]),this.iconSizeData=I_(this.zoom,a["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),v=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(x=>Vi[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=i.sourceID,this.projection=i.projection}createArrays(){this.text=new $_(new wc(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new $_(new wc(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Ng,this.lineVertexArray=new Og,this.symbolInstances=new Kp}calculateGlyphDependencies(i,a,h,m,v){for(let x=0;x<i.length;x++)if(a[i.charCodeAt(x)]=!0,m&&v){const T=Jd[i.charAt(x)];T&&(a[T.charCodeAt(0)]=!0)}}populate(i,a,h,m){const v=this.layers[0],x=v.layout,T=this.projection.name==="globe",P=x.get("text-font"),O=x.get("text-field"),V=x.get("icon-image"),$=(O.value.kind!=="constant"||O.value.value instanceof Vo&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),tt=V.value.kind!=="constant"||!!V.value.value||Object.keys(V.parameters).length>0,ot=x.get("symbol-sort-key");if(this.features=[],!$&&!tt)return;const ct=a.iconDependencies,bt=a.glyphDependencies,zt=a.availableImages,Jt=new De(this.zoom);for(const{feature:le,id:Xt,index:Qt,sourceLayerIndex:ge}of i){const he=v._featureFilter.needGeometry,Xe=bc(le,he);if(!v._featureFilter.filter(Jt,Xe,h))continue;if(he||(Xe.geometry=Qu(le,h,m)),T&&le.type!==1&&h.z<=5){const en=Xe.geometry,_n=.98078528056,wn=(En,Nn)=>Eu(ip(En.x,En.y,h,1),ip(Nn.x,Nn.y,h,1))<_n;for(let En=0;En<en.length;En++)en[En]=sw(en[En],wn)}let Ze,dn;if($){const en=v.getValueAndResolveTokens("text-field",Xe,h,zt),_n=Vo.factory(en);Lb(_n)&&(this.hasRTLText=!0),(!this.hasRTLText||Ae()==="unavailable"||this.hasRTLText&&je.isParsed())&&(Ze=Qw(_n,v,Xe))}if(tt){const en=v.getValueAndResolveTokens("icon-image",Xe,h,zt);dn=en instanceof wi?en:wi.fromString(en)}if(!Ze&&!dn)continue;const Dn=this.sortFeaturesByKey?ot.evaluate(Xe,{},h):void 0;if(this.features.push({id:Xt,text:Ze,icon:dn,index:Qt,sourceLayerIndex:ge,geometry:Xe.geometry,properties:le.properties,type:Eb[le.type],sortKey:Dn}),dn&&(ct[dn.name]=!0),Ze){const en=P.evaluate(Xe,{},h).join(","),_n=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Vi.vertical)>=0;for(const wn of Ze.sections)if(wn.image)ct[wn.image.name]=!0;else{const En=B(Ze.toString()),Nn=wn.fontStack||en,nn=bt[Nn]=bt[Nn]||{};this.calculateGlyphDependencies(wn.text,nn,_n,this.allowVerticalPlacement,En)}}}x.get("symbol-placement")==="line"&&(this.features=function(le){const Xt={},Qt={},ge=[];let he=0;function Xe(en){ge.push(le[en]),he++}function Ze(en,_n,wn){const En=Qt[en];return delete Qt[en],Qt[_n]=En,ge[En].geometry[0].pop(),ge[En].geometry[0]=ge[En].geometry[0].concat(wn[0]),En}function dn(en,_n,wn){const En=Xt[_n];return delete Xt[_n],Xt[en]=En,ge[En].geometry[0].shift(),ge[En].geometry[0]=wn[0].concat(ge[En].geometry[0]),En}function Dn(en,_n,wn){const En=wn?_n[0][_n[0].length-1]:_n[0][0];return`${en}:${En.x}:${En.y}`}for(let en=0;en<le.length;en++){const _n=le[en],wn=_n.geometry,En=_n.text?_n.text.toString():null;if(!En){Xe(en);continue}const Nn=Dn(En,wn),nn=Dn(En,wn,!0);if(Nn in Qt&&nn in Xt&&Qt[Nn]!==Xt[nn]){const Vn=dn(Nn,nn,wn),Ai=Ze(Nn,nn,ge[Vn].geometry);delete Xt[Nn],delete Qt[nn],Qt[Dn(En,ge[Ai].geometry,!0)]=Ai,ge[Vn].geometry=null}else Nn in Qt?Ze(Nn,nn,wn):nn in Xt?dn(Nn,nn,wn):(Xe(en),Xt[Nn]=he-1,Qt[nn]=he-1)}return ge.filter(en=>en.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,Xt)=>le.sortKey-Xt.sortKey)}update(i,a,h,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,a,this.layers,h,m),this.icon.programConfigurations.updatePaintArrays(i,a,this.layers,h,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=E0(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,a){const h=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:m,y:v}of a)this.lineVertexArray.emplaceBack(m,v);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(i,a,h,m,v,x,T,P,O,V,$,tt,ot,ct){const bt=i.indexArray,zt=i.layoutVertexArray,Jt=i.globeExtVertexArray,le=i.segments.prepareSegment(4*a.length,zt,bt,this.canOverlap?x.sortKey:void 0),Xt=this.glyphOffsetArray.length,Qt=le.vertexLength,ge=this.allowVerticalPlacement&&T===Vi.vertical?Math.PI/2:0,he=x.text&&x.text.sections;for(let Ze=0;Ze<a.length;Ze++){const{tl:dn,tr:Dn,bl:en,br:_n,tex:wn,pixelOffsetTL:En,pixelOffsetBR:Nn,minFontScaleX:nn,minFontScaleY:Vn,glyphOffset:Ai,isSDF:qn,sectionIndex:li}=a[Ze],Wn=le.vertexLength,ki=Ai[1];if(Rm(zt,O.x,O.y,dn.x,ki+dn.y,wn.x,wn.y,h,qn,En.x,En.y,nn,Vn),Rm(zt,O.x,O.y,Dn.x,ki+Dn.y,wn.x+wn.w,wn.y,h,qn,Nn.x,En.y,nn,Vn),Rm(zt,O.x,O.y,en.x,ki+en.y,wn.x,wn.y+wn.h,h,qn,En.x,Nn.y,nn,Vn),Rm(zt,O.x,O.y,_n.x,ki+_n.y,wn.x+wn.w,wn.y+wn.h,h,qn,Nn.x,Nn.y,nn,Vn),P){const{x:mr,y:pr,z:fr}=P.anchor,[Pi,so,Xi]=P.up;Bm(Jt,mr,pr,fr,Pi,so,Xi),Bm(Jt,mr,pr,fr,Pi,so,Xi),Bm(Jt,mr,pr,fr,Pi,so,Xi),Bm(Jt,mr,pr,fr,Pi,so,Xi),Fm(i.dynamicLayoutVertexArray,mr,pr,fr,ge)}else Fm(i.dynamicLayoutVertexArray,O.x,O.y,O.z,ge);bt.emplaceBack(Wn,Wn+1,Wn+2),bt.emplaceBack(Wn+1,Wn+2,Wn+3),le.vertexLength+=4,le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ai[0]),Ze!==a.length-1&&li===a[Ze+1].sectionIndex||i.programConfigurations.populatePaintArrays(zt.length,x,x.index,{},ot,ct,he&&he[li])}const Xe=P?P.anchor:O;i.placedSymbolArray.emplaceBack(Xe.x,Xe.y,Xe.z,O.x,O.y,Xt,this.glyphOffsetArray.length-Xt,Qt,V,$,O.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],T,0,!1,0,tt,0)}_commitLayoutVertex(i,a,h,m,v,x,T){i.emplaceBack(a,h,m,v,x,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(i,a,h,m,v,x,T){const P=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),O=P.vertexLength,V=T.tileAnchorX,$=T.tileAnchorY;for(let ot=0;ot<4;ot++)h.collisionVertexArray.emplaceBack(0,0,0,0);h.collisionVertexArrayExt.emplaceBack(a,-i.padding,-i.padding),h.collisionVertexArrayExt.emplaceBack(a,i.padding,-i.padding),h.collisionVertexArrayExt.emplaceBack(a,i.padding,i.padding),h.collisionVertexArrayExt.emplaceBack(a,-i.padding,i.padding),this._commitLayoutVertex(h.layoutVertexArray,m,v,x,V,$,new j(i.x1,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,m,v,x,V,$,new j(i.x2,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,m,v,x,V,$,new j(i.x2,i.y2)),this._commitLayoutVertex(h.layoutVertexArray,m,v,x,V,$,new j(i.x1,i.y2)),P.vertexLength+=4;const tt=h.indexArray;tt.emplaceBack(O,O+1),tt.emplaceBack(O+1,O+2),tt.emplaceBack(O+2,O+3),tt.emplaceBack(O+3,O),P.primitiveLength+=4}_addTextDebugCollisionBoxes(i,a,h,m,v,x){for(let T=m;T<v;T++){const P=h.get(T),O=this.getSymbolInstanceTextSize(i,x,a,T);this._addCollisionDebugVertices(P,O,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(i,a,h,m,v,x){for(let T=m;T<v;T++){const P=h.get(T),O=this.getSymbolInstanceIconSize(i,a,x.placedIconSymbolIndex);this._addCollisionDebugVertices(P,O,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,x)}}generateCollisionDebugBuffers(i,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new q_(go,hr.members,Tu),this.iconCollisionBox=new q_(go,hr.members,Tu);const h=Zf(this.iconSizeData,i),m=Zf(this.textSizeData,i);for(let v=0;v<this.symbolInstances.length;v++){const x=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(m,i,a,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(m,i,a,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(h,i,a,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(h,i,a,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(i,a,h,m){const v=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:m),x=ic(this.textSizeData,i,v)/_o;return this.tilePixelRatio*x}getSymbolInstanceIconSize(i,a,h){const m=this.icon.placedSymbolArray.get(h),v=ic(this.iconSizeData,i,m);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(i,a,h){i.emplaceBack(a,-h,-h),i.emplaceBack(a,h,-h),i.emplaceBack(a,h,h),i.emplaceBack(a,-h,h)}_updateTextDebugCollisionBoxes(i,a,h,m,v,x){for(let T=m;T<v;T++){const P=h.get(T),O=this.getSymbolInstanceTextSize(i,x,a,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,O,P.padding)}}_updateIconDebugCollisionBoxes(i,a,h,m,v,x){for(let T=m;T<v;T++){const P=h.get(T),O=this.getSymbolInstanceIconSize(i,a,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,O,P.padding)}}updateCollisionDebugBuffers(i,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=Zf(this.iconSizeData,i),m=Zf(this.textSizeData,i);for(let v=0;v<this.symbolInstances.length;v++){const x=this.symbolInstances.get(v);this._updateTextDebugCollisionBoxes(m,i,a,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(m,i,a,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(h,i,a,x.iconBoxStartIndex,x.iconBoxEndIndex,x.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(h,i,a,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,a,h,m,v,x,T,P,O){const V={};if(a<h){const{x1:$,y1:tt,x2:ot,y2:ct,padding:bt,projectedAnchorX:zt,projectedAnchorY:Jt,projectedAnchorZ:le,tileAnchorX:Xt,tileAnchorY:Qt,featureIndex:ge}=i.get(a);V.textBox={x1:$,y1:tt,x2:ot,y2:ct,padding:bt,projectedAnchorX:zt,projectedAnchorY:Jt,projectedAnchorZ:le,tileAnchorX:Xt,tileAnchorY:Qt},V.textFeatureIndex=ge}if(m<v){const{x1:$,y1:tt,x2:ot,y2:ct,padding:bt,projectedAnchorX:zt,projectedAnchorY:Jt,projectedAnchorZ:le,tileAnchorX:Xt,tileAnchorY:Qt,featureIndex:ge}=i.get(m);V.verticalTextBox={x1:$,y1:tt,x2:ot,y2:ct,padding:bt,projectedAnchorX:zt,projectedAnchorY:Jt,projectedAnchorZ:le,tileAnchorX:Xt,tileAnchorY:Qt},V.verticalTextFeatureIndex=ge}if(x<T){const{x1:$,y1:tt,x2:ot,y2:ct,padding:bt,projectedAnchorX:zt,projectedAnchorY:Jt,projectedAnchorZ:le,tileAnchorX:Xt,tileAnchorY:Qt,featureIndex:ge}=i.get(x);V.iconBox={x1:$,y1:tt,x2:ot,y2:ct,padding:bt,projectedAnchorX:zt,projectedAnchorY:Jt,projectedAnchorZ:le,tileAnchorX:Xt,tileAnchorY:Qt},V.iconFeatureIndex=ge}if(P<O){const{x1:$,y1:tt,x2:ot,y2:ct,padding:bt,projectedAnchorX:zt,projectedAnchorY:Jt,projectedAnchorZ:le,tileAnchorX:Xt,tileAnchorY:Qt,featureIndex:ge}=i.get(P);V.verticalIconBox={x1:$,y1:tt,x2:ot,y2:ct,padding:bt,projectedAnchorX:zt,projectedAnchorY:Jt,projectedAnchorZ:le,tileAnchorX:Xt,tileAnchorY:Qt},V.verticalIconFeatureIndex=ge}return V}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,a){const h=i.placedSymbolArray.get(a),m=h.vertexStartIndex+4*h.numGlyphs;for(let v=h.vertexStartIndex;v<m;v+=4)i.indexArray.emplaceBack(v,v+1,v+2),i.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(i),h=Math.cos(i),m=[],v=[],x=[];for(let T=0;T<this.symbolInstances.length;++T){x.push(T);const P=this.symbolInstances.get(T);m.push(0|Math.round(a*P.tileAnchorX+h*P.tileAnchorY)),v.push(P.featureIndex)}return x.sort((T,P)=>m[T]-m[P]||v[P]-v[T]),x}addToSortKeyRanges(i,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:O}=h;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),x>=0&&x!==v&&x!==m&&this.addIndicesForPlacedSymbol(this.text,x),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Xn(bh,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),bh.MAX_GLYPHS=65535,bh.addDynamicAttributes=Fm;const kb=new fi({"symbol-placement":new Ne(Ke.layout_symbol["symbol-placement"]),"symbol-spacing":new Ne(Ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ne(Ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new $e(Ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ne(Ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ne(Ke.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ne(Ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ne(Ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ne(Ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new $e(Ke.layout_symbol["icon-size"]),"icon-text-fit":new Ne(Ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ne(Ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new $e(Ke.layout_symbol["icon-image"]),"icon-rotate":new $e(Ke.layout_symbol["icon-rotate"]),"icon-padding":new Ne(Ke.layout_symbol["icon-padding"]),"icon-keep-upright":new Ne(Ke.layout_symbol["icon-keep-upright"]),"icon-offset":new $e(Ke.layout_symbol["icon-offset"]),"icon-anchor":new $e(Ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ne(Ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ne(Ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ne(Ke.layout_symbol["text-rotation-alignment"]),"text-field":new $e(Ke.layout_symbol["text-field"]),"text-font":new $e(Ke.layout_symbol["text-font"]),"text-size":new $e(Ke.layout_symbol["text-size"]),"text-max-width":new $e(Ke.layout_symbol["text-max-width"]),"text-line-height":new $e(Ke.layout_symbol["text-line-height"]),"text-letter-spacing":new $e(Ke.layout_symbol["text-letter-spacing"]),"text-justify":new $e(Ke.layout_symbol["text-justify"]),"text-radial-offset":new $e(Ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ne(Ke.layout_symbol["text-variable-anchor"]),"text-anchor":new $e(Ke.layout_symbol["text-anchor"]),"text-max-angle":new Ne(Ke.layout_symbol["text-max-angle"]),"text-writing-mode":new Ne(Ke.layout_symbol["text-writing-mode"]),"text-rotate":new $e(Ke.layout_symbol["text-rotate"]),"text-padding":new Ne(Ke.layout_symbol["text-padding"]),"text-keep-upright":new Ne(Ke.layout_symbol["text-keep-upright"]),"text-transform":new $e(Ke.layout_symbol["text-transform"]),"text-offset":new $e(Ke.layout_symbol["text-offset"]),"text-allow-overlap":new Ne(Ke.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ne(Ke.layout_symbol["text-ignore-placement"]),"text-optional":new Ne(Ke.layout_symbol["text-optional"])});var J_={paint:new fi({"icon-opacity":new $e(Ke.paint_symbol["icon-opacity"]),"icon-color":new $e(Ke.paint_symbol["icon-color"]),"icon-halo-color":new $e(Ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new $e(Ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new $e(Ke.paint_symbol["icon-halo-blur"]),"icon-translate":new Ne(Ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ne(Ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new $e(Ke.paint_symbol["text-opacity"]),"text-color":new $e(Ke.paint_symbol["text-color"],{runtimeType:Si,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new $e(Ke.paint_symbol["text-halo-color"]),"text-halo-width":new $e(Ke.paint_symbol["text-halo-width"]),"text-halo-blur":new $e(Ke.paint_symbol["text-halo-blur"]),"text-translate":new Ne(Ke.paint_symbol["text-translate"]),"text-translate-anchor":new Ne(Ke.paint_symbol["text-translate-anchor"])}),layout:kb};class M0{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:Co,this.defaultValue=i}evaluate(i){if(i.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(i.formattedSection))return a.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Xn(M0,"FormatSectionOverride",{omit:["defaultValue"]});class jm extends yl{constructor(i){super(i,J_)}recalculate(i,a){super.recalculate(i,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const v of h)m.indexOf(v)<0&&m.push(v);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,a,h,m){const v=this.layout.get(i).evaluate(a,{},h,m),x=this._unevaluatedLayout._values[i];return x.isDataDriven()||Rr(x.value)||!v?v:function(T,P){return P.replace(/{([^{}]+)}/g,(O,V)=>V in T?String(T[V]):"")}(a.properties,v)}createBucket(i){return new bh(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of J_.paint.overridableProperties){if(!jm.hasPaintOverride(this.layout,i))continue;const a=this.paint.get(i),h=new M0(a),m=new rs(h,a.property.specification);let v=null;v=a.value.kind==="constant"||a.value.kind==="source"?new Ws("source",m):new Bo("composite",m,a.value.zoomStops,a.value._interpolationType),this.paint._values[i]=new xn(a.property,v,a.parameters)}}_handleOverridablePaintPropertyUpdate(i,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&jm.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,a){const h=i.get("text-field"),m=J_.paint.properties[a];let v=!1;const x=T=>{for(const P of T)if(m.overrides&&m.overrides.hasOverride(P))return void(v=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Vo)x(h.value.value.sections);else if(h.value.kind==="source"){const T=O=>{v||(O instanceof ea&&Ao(O.value)===oo?x(O.value.sections):O instanceof rr?x(O.sections):O.eachChild(T))},P=h.value;P._styleExpression&&T(P._styleExpression.expression)}return v}getProgramConfiguration(i){return new _h(this,i)}}var Pb={paint:new fi({"background-color":new Ne(Ke.paint_background["background-color"]),"background-pattern":new Ne(Ke.paint_background["background-pattern"]),"background-opacity":new Ne(Ke.paint_background["background-opacity"])})},zb={paint:new fi({"raster-opacity":new Ne(Ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ne(Ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ne(Ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ne(Ke.paint_raster["raster-brightness-max"]),"raster-saturation":new Ne(Ke.paint_raster["raster-saturation"]),"raster-contrast":new Ne(Ke.paint_raster["raster-contrast"]),"raster-resampling":new Ne(Ke.paint_raster["raster-resampling"]),"raster-fade-duration":new Ne(Ke.paint_raster["raster-fade-duration"])})};class Db extends yl{constructor(i){super(i,{}),this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}var Nb={paint:new fi({"sky-type":new Ne(Ke.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ne(Ke.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ne(Ke.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ne(Ke.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ne(Ke.paint_sky["sky-gradient-radius"]),"sky-gradient":new ri(Ke.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ne(Ke.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ne(Ke.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ne(Ke.paint_sky["sky-opacity"])})};function K_(s,i,a){const h=[0,0,1],m=o_([]);return My(m,m,a?-xt(s)+Math.PI:xt(s)),Ey(m,m,-xt(i)),Ay(h,h,m),tl(h,h)}const Ob={circle:class extends yl{constructor(s){super(s,lw)}createBucket(s){return new Pf(s)}queryRadius(s){const i=s;return zf("circle-radius",this,i)+zf("circle-stroke-width",this,i)+sm(this.paint.get("circle-translate"))}queryIntersectsFeature(s,i,a,h,m,v,x,T){const P=Qa(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,s.pixelToTileUnitsFactor),O=this.paint.get("circle-radius").evaluate(i,a)+this.paint.get("circle-stroke-width").evaluate(i,a);return Ly(s,h,v,x,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,O)}getProgramIds(){return["circle"]}getProgramConfiguration(s){return new _h(this,s)}},heatmap:class extends yl{createBucket(s){return new Py(s)}constructor(s){super(s,pw),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Gd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(s){return zf("heatmap-radius",this,s)}queryIntersectsFeature(s,i,a,h,m,v,x,T){const P=this.paint.get("heatmap-radius").evaluate(i,a);return Ly(s,h,v,x,T,!0,!0,new j(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(s){return new _h(this,s)}},hillshade:class extends yl{constructor(s){super(s,mw)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends yl{constructor(s){super(s,Lw)}getProgramIds(){const s=this.paint.get("fill-pattern"),i=s&&s.constantOr(1),a=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getProgramConfiguration(s){return new _h(this,s)}recalculate(s,i){super.recalculate(s,i);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new dm(s)}queryRadius(){return sm(this.paint.get("fill-translate"))}queryIntersectsFeature(s,i,a,h,m,v){return!s.queryGeometry.isAboveHorizon&&wy(Ic(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,s.pixelToTileUnitsFactor),h)}isTileClipped(){return!0}},"fill-extrusion":class extends yl{constructor(s){super(s,Hy)}createBucket(s){return new $d(s)}queryRadius(){return sm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(s){return new _h(this,s)}queryIntersectsFeature(s,i,a,h,m,v,x,T,P){const O=Qa(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,s.pixelToTileUnitsFactor),V=this.paint.get("fill-extrusion-height").evaluate(i,a),$=this.paint.get("fill-extrusion-base").evaluate(i,a),tt=[0,0],ot=T&&v.elevation,ct=v.elevation?v.elevation.exaggeration():1,bt=s.tile.getBucket(this);if(ot&&bt instanceof $d){const Qt=bt.centroidVertexArray,ge=P+1;ge<Qt.length&&(tt[0]=Qt.geta_centroid_pos0(ge),tt[1]=Qt.geta_centroid_pos1(ge))}if(tt[0]===0&&tt[1]===1)return!1;v.projection.name==="globe"&&(h=w_([h],[new j(0,0),new j(xi,xi)],s.tileID.canonical).map(Qt=>Qt.polygon).flat());const zt=ot?T:null,[Jt,le]=function(Qt,ge,he,Xe,Ze,dn,Dn,en,_n,wn,En){return Qt.projection.name==="globe"?function(Nn,nn,Vn,Ai,qn,li,Wn,ki,mr,pr,fr){const Pi=[],so=[],Xi=Nn.projection.upVectorScale(fr,Nn.center.lat,Nn.worldSize).metersToTile,gr=[0,0,0,1],vo=[0,0,0,1],No=(Oo,Fo,ps,Fa)=>{Oo[0]=Fo,Oo[1]=ps,Oo[2]=Fa,Oo[3]=1},ko=x_();Vn>0&&(Vn+=ko),Ai+=ko;for(const Oo of nn){const Fo=[],ps=[];for(const Fa of Oo){const ao=Fa.x+qn.x,Hs=Fa.y+qn.y,Ns=Nn.projection.projectTilePoint(ao,Hs,fr),Fr=Nn.projection.upVector(fr,Fa.x,Fa.y);let qo=Vn,ua=Ai;if(Wn){const yo=b_(ao,Hs,Vn,Ai,Wn,ki,mr,pr);qo+=yo.base,ua+=yo.top}Vn!==0?No(gr,Ns.x+Fr[0]*Xi*qo,Ns.y+Fr[1]*Xi*qo,Ns.z+Fr[2]*Xi*qo):No(gr,Ns.x,Ns.y,Ns.z),No(vo,Ns.x+Fr[0]*Xi*ua,Ns.y+Fr[1]*Xi*ua,Ns.z+Fr[2]*Xi*ua),os(gr,gr,li),os(vo,vo,li),Fo.push(new Gf(gr[0],gr[1],gr[2])),ps.push(new Gf(vo[0],vo[1],vo[2]))}Pi.push(Fo),so.push(ps)}return[Pi,so]}(Qt,ge,he,Xe,Ze,dn,Dn,en,_n,wn,En):Dn?function(Nn,nn,Vn,Ai,qn,li,Wn,ki,mr){const pr=[],fr=[],Pi=[0,0,0,1];for(const so of Nn){const Xi=[],gr=[];for(const vo of so){const No=vo.x+Ai.x,ko=vo.y+Ai.y,Oo=b_(No,ko,nn,Vn,li,Wn,ki,mr);Pi[0]=No,Pi[1]=ko,Pi[2]=Oo.base,Pi[3]=1,vh(Pi,Pi,qn),Pi[3]=Math.max(Pi[3],1e-5);const Fo=new Gf(Pi[0]/Pi[3],Pi[1]/Pi[3],Pi[2]/Pi[3]);Pi[0]=No,Pi[1]=ko,Pi[2]=Oo.top,Pi[3]=1,vh(Pi,Pi,qn),Pi[3]=Math.max(Pi[3],1e-5);const ps=new Gf(Pi[0]/Pi[3],Pi[1]/Pi[3],Pi[2]/Pi[3]);Xi.push(Fo),gr.push(ps)}pr.push(Xi),fr.push(gr)}return[pr,fr]}(ge,he,Xe,Ze,dn,Dn,en,_n,wn):function(Nn,nn,Vn,Ai,qn){const li=[],Wn=[],ki=qn[8]*nn,mr=qn[9]*nn,pr=qn[10]*nn,fr=qn[11]*nn,Pi=qn[8]*Vn,so=qn[9]*Vn,Xi=qn[10]*Vn,gr=qn[11]*Vn;for(const vo of Nn){const No=[],ko=[];for(const Oo of vo){const Fo=Oo.x+Ai.x,ps=Oo.y+Ai.y,Fa=qn[0]*Fo+qn[4]*ps+qn[12],ao=qn[1]*Fo+qn[5]*ps+qn[13],Hs=qn[2]*Fo+qn[6]*ps+qn[14],Ns=qn[3]*Fo+qn[7]*ps+qn[15],Fr=Fa+ki,qo=ao+mr,ua=Hs+pr,yo=Math.max(Ns+fr,1e-5),Cs=Fa+Pi,bl=ao+so,ja=Hs+Xi,Ua=Math.max(Ns+gr,1e-5);No.push(new Gf(Fr/yo,qo/yo,ua/yo)),ko.push(new Gf(Cs/Ua,bl/Ua,ja/Ua))}li.push(No),Wn.push(ko)}return[li,Wn]}(ge,he,Xe,Ze,dn)}(v,h,$,V,O,x,zt,tt,ct,v.center.lat,s.tileID.canonical),Xt=s.queryGeometry;return function(Qt,ge,he){let Xe=1/0;wy(he,ge)&&(Xe=wm(he,ge[0]));for(let Ze=0;Ze<ge.length;Ze++){const dn=ge[Ze],Dn=Qt[Ze];for(let en=0;en<dn.length-1;en++){const _n=dn[en],wn=[_n,dn[en+1],Dn[en+1],Dn[en],_n];rm(he,wn)&&(Xe=Math.min(Xe,wm(he,wn)))}}return Xe!==1/0&&Xe}(Jt,le,Xt.isPointQuery()?Xt.screenBounds:Xt.screenGeometry)}},line:class extends yl{constructor(s){super(s,Jy),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof Gs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,i){super.recalculate(s,i),this.paint._values["line-floorwidth"]=Ky.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new bm(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(s){return new _h(this,s)}queryRadius(s){const i=s,a=Qy(zf("line-width",this,i),zf("line-gap-width",this,i)),h=zf("line-offset",this,i);return a/2+Math.abs(h)+sm(this.paint.get("line-translate"))}queryIntersectsFeature(s,i,a,h,m,v){if(s.queryGeometry.isAboveHorizon)return!1;const x=Ic(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,s.pixelToTileUnitsFactor),T=s.pixelToTileUnitsFactor/2*Qy(this.paint.get("line-width").evaluate(i,a),this.paint.get("line-gap-width").evaluate(i,a)),P=this.paint.get("line-offset").evaluate(i,a);return P&&(h=function(O,V){const $=[],tt=new j(0,0);for(let ot=0;ot<O.length;ot++){const ct=O[ot],bt=[];for(let zt=0;zt<ct.length;zt++){const Jt=ct[zt-1],le=ct[zt],Xt=ct[zt+1],Qt=zt===0?tt:le.sub(Jt)._unit()._perp(),ge=zt===ct.length-1?tt:Xt.sub(le)._unit()._perp(),he=Qt._add(ge)._unit();he._mult(1/(he.x*ge.x+he.y*ge.y)),bt.push(he._mult(V)._add(le))}$.push(bt)}return $}(h,P*s.pixelToTileUnitsFactor)),function(O,V,$){for(let tt=0;tt<V.length;tt++){const ot=V[tt];if(O.length>=3){for(let ct=0;ct<ot.length;ct++)if($h(O,ot[ct]))return!0}if(Hg(O,ot,$))return!0}return!1}(x,h,T)}isTileClipped(){return!0}},symbol:jm,background:class extends yl{constructor(s){super(s,Pb)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends yl{constructor(s){super(s,zb)}getProgramIds(){return["raster"]}},sky:class extends yl{constructor(s){super(s,Nb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="sky-gradient"?this._updateColorRamp():s!=="sky-atmosphere-sun"&&s!=="sky-atmosphere-halo-color"&&s!=="sky-atmosphere-color"&&s!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Gd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(s,i){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),m=!h,v=s.style.light,x=v.properties.get("position");return m&&v.properties.get("anchor")==="viewport"&&cn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?K_(x.azimuthal,90-x.polar,i):K_(h[0],90-h[1],i)}const a=this.paint.get("sky-gradient-center");return K_(a[0],90-a[1],i)}is3D(){return!1}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return s==="atmosphere"?["skyboxCapture","skybox"]:s==="gradient"?["skyboxGradient"]:null}}};class up{constructor(i,a,h,m){this.context=i,this.format=h,this.texture=i.gl.createTexture(),this.update(a,m)}update(i,a,h){const{width:m,height:v}=i,{context:x}=this,{gl:T}=x,{HTMLImageElement:P,HTMLCanvasElement:O,HTMLVideoElement:V,ImageData:$,ImageBitmap:tt}=w;if(T.bindTexture(T.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!a||a.premultiply!==!1)),h||this.size&&this.size[0]===m&&this.size[1]===v){const{x:ot,y:ct}=h||{x:0,y:0};i instanceof P||i instanceof O||i instanceof V||i instanceof $||tt&&i instanceof tt?T.texSubImage2D(T.TEXTURE_2D,0,ot,ct,T.RGBA,T.UNSIGNED_BYTE,i):T.texSubImage2D(T.TEXTURE_2D,0,ot,ct,m,v,T.RGBA,T.UNSIGNED_BYTE,i.data)}else this.size=[m,v],i instanceof P||i instanceof O||i instanceof V||i instanceof $||tt&&i instanceof tt?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,i):T.texImage2D(T.TEXTURE_2D,0,this.format,m,v,0,this.format,T.UNSIGNED_BYTE,i.data);this.useMipmap=Boolean(a&&a.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(i,a){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),i!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,i),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?i===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:i),this.filter=i),a!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,a),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class g{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class I{constructor(){this.tasks={},this.taskQueue=[],fe(["process"],this),this.invoker=new g(this.process),this.nextId=0}add(i,a){const h=this.nextId++,m=function({type:v,isSymbolTile:x,zoom:T}){return T=T||0,v==="message"?0:v!=="maybePrepare"||x?v!=="parseTile"||x?v==="parseTile"&&x?300-T:v==="maybePrepare"&&x?400-T:500:200-T:100-T}(a);if(m===0){st();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[h]={fn:i,metadata:a,priority:m,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){st();try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const a=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let i=null,a=1/0;for(let m=0;m<this.taskQueue.length;m++){const v=this.tasks[this.taskQueue[m]];v.priority<a&&(a=v.priority,i=m)}if(i===null)return null;const h=this.taskQueue[i];return this.taskQueue.splice(i,1),h}remove(){this.invoker.remove()}}class F{constructor(i){this._stringToNumber={},this._numberToString=[];for(let a=0;a<i.length;a++){const h=i[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const nt=["tile","layer","source","sourceLayer","state"];class At{constructor(i,a,h,m,v){this.type="Feature",this._vectorTileFeature=i,this._z=a,this._x=h,this._y=m,this.properties=i.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(i.id=this.id);for(const a of nt)this[a]!==void 0&&(i[a]=this[a]);return i}}const Rt=32,se=33,Ie=new Uint16Array(8184);for(let s=0;s<2046;s++){let i=s+2,a=0,h=0,m=0,v=0,x=0,T=0;for(1&i?m=v=x=Rt:a=h=T=Rt;(i>>=1)>1;){const O=a+m>>1,V=h+v>>1;1&i?(m=a,v=h,a=x,h=T):(a=m,h=v,m=x,v=T),x=O,T=V}const P=4*s;Ie[P+0]=a,Ie[P+1]=h,Ie[P+2]=m,Ie[P+3]=v}const Be=new Uint16Array(2178),Tn=new Uint8Array(1089),kn=new Uint16Array(1089);function Rn(s){return s===0?-.03125:s===32?.03125:0}var si=Kn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Ci={type:2,extent:xi,loadGeometry:()=>[[new j(0,0),new j(8193,0),new j(8193,8193),new j(0,8193),new j(0,0)]]};class Yi{constructor(i,a,h,m,v){this.tileID=i,this.uid=Yt(),this.uses=0,this.tileSize=a,this.tileZoom=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(i){const a=i+this.timeAdded;a<ti.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=af(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,a,h){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(m,v){const x={};if(!v)return x;for(const T of m){const P=T.layerIds.map(O=>v.getLayer(O)).filter(Boolean);if(P.length!==0){T.layers=P,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(O=>P.filter(V=>V.id===O)[0]));for(const O of P)x[O.id]=T}}return x}(i.buckets,a.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const v=this.buckets[m];if(v instanceof bh){if(this.hasSymbolBuckets=!0,!h)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const v=this.buckets[m];if(v instanceof bh&&v.hasRTLText){this.hasRTLText=!0,je.isLoading()||je.isLoaded()||Ae()!=="deferred"||He();break}}this.queryPadding=0;for(const m in this.buckets){const v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(m).queryRadius(v))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas)}else this.collisionBoxArray=new Dg}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(i){return this.buckets[i.id]}upload(i){for(const h in this.buckets){const m=this.buckets[h];m.uploadPending()&&m.upload(i)}const a=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new up(i,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new up(i,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new up(i,this.lineAtlas.image,a.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,a,h,m,v,x,T,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:T,transform:x,params:v,tileTransform:this.tileTransform},i,a,h):{}}querySourceFeatures(i,a){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const m=h.loadVTLayers(),v=a?a.sourceLayer:"",x=m._geojsonTileLayer||m[v];if(!x)return;const T=St(a&&a.filter),{z:P,x:O,y:V}=this.tileID.canonical,$={z:P,x:O,y:V};for(let tt=0;tt<x.length;tt++){const ot=x.feature(tt);if(T.needGeometry){const zt=bc(ot,!0);if(!T.filter(new De(this.tileID.overscaledZ),zt,this.tileID.canonical))continue}else if(!T.filter(new De(this.tileID.overscaledZ),ot))continue;const ct=h.getId(ot,v),bt=new At(ot,P,O,V,ct);bt.tile=$,i.push(bt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const a=this.expirationTime;if(i.cacheControl){const h=gt(i.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const h=Date.now();let m=!1;if(this.expirationTime>h)m=!1;else if(a)if(this.expirationTime<a)m=!0;else{const v=this.expirationTime-a;v?this.expirationTime=h+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0||!a)return;const h=this.latestFeatureIndex.loadVTLayers(),m=a.style.listImages();for(const v in this.buckets){if(!a.style.hasLayer(v))continue;const x=this.buckets[v],T=x.layers[0].sourceLayer||"_geojsonTileLayer",P=h[T],O=i[T];if(!P||!O||Object.keys(O).length===0)continue;if(x.update(O,P,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),x instanceof bm||x instanceof dm){const $=a.style._getSourceCache(x.layers[0].source);a._terrain&&a._terrain.enabled&&$&&x.programConfigurations.needsUpload&&a._terrain._clearRenderCacheForTile($.id,this.tileID)}const V=a&&a.style&&a.style.getLayer(v);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ti.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=ti.now()+i}setTexture(i,a){const h=a.context,m=h.gl;this.texture=this.texture||a.getTileTexture(i.width),this.texture?this.texture.update(i,{useMipmap:!0}):(this.texture=new up(h,i,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),h.extTextureFilterAnisotropic&&m.texParameterf(m.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax))}setDependencies(i,a){const h={};for(const m of a)h[m]=!0;this.dependencies[i]=h}hasDependency(i,a){for(const h of i){const m=this.dependencies[h];if(m){for(const v of a)if(m[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,a){if(!a||a.name==="mercator"||this._tileDebugBuffer)return;const h=Qu(Ci,this.tileID.canonical,this.tileTransform)[0],m=new Dr,v=new Zc;for(let x=0;x<h.length;x++){const{x:T,y:P}=h[x];m.emplaceBack(T,P),v.emplaceBack(x)}v.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(v),this._tileDebugBuffer=i.createVertexBuffer(m,ep.members),this._tileDebugSegments=cs.simpleSegment(0,0,m.length,v.length)}_makeTileBoundsBuffers(i,a){if(this._tileBoundsBuffer||!a||a.name==="mercator")return;const h=Qu(Ci,this.tileID.canonical,this.tileTransform)[0];let m,v;if(this.isRaster){const x=function(T,P){const O=af(T,P),V=Math.pow(2,T.z);for(let zt=0;zt<se;zt++)for(let Jt=0;Jt<se;Jt++){const le=xl((T.x+(Jt+Rn(Jt))/Rt)/V),Xt=xa((T.y+(zt+Rn(zt))/Rt)/V),Qt=P.project(le,Xt),ge=zt*se+Jt;Be[2*ge+0]=Math.round((Qt.x*O.scale-O.x)*xi),Be[2*ge+1]=Math.round((Qt.y*O.scale-O.y)*xi)}Tn.fill(0),kn.fill(0);for(let zt=2045;zt>=0;zt--){const Jt=4*zt,le=Ie[Jt+0],Xt=Ie[Jt+1],Qt=Ie[Jt+2],ge=Ie[Jt+3],he=le+Qt>>1,Xe=Xt+ge>>1,Ze=he+Xe-Xt,dn=Xe+le-he,Dn=Xt*se+le,en=ge*se+Qt,_n=Xe*se+he,wn=Math.hypot((Be[2*Dn+0]+Be[2*en+0])/2-Be[2*_n+0],(Be[2*Dn+1]+Be[2*en+1])/2-Be[2*_n+1])>=16;if(Tn[_n]=Tn[_n]||(wn?1:0),zt<1022){const En=(Xt+dn>>1)*se+(le+Ze>>1),Nn=(ge+dn>>1)*se+(Qt+Ze>>1);Tn[_n]=Tn[_n]||Tn[En]||Tn[Nn]}}const $=new Wr,tt=new aa;let ot=0;function ct(zt,Jt){const le=Jt*se+zt;return kn[le]===0&&($.emplaceBack(Be[2*le+0],Be[2*le+1],zt*xi/Rt,Jt*xi/Rt),kn[le]=++ot),kn[le]-1}function bt(zt,Jt,le,Xt,Qt,ge){const he=zt+le>>1,Xe=Jt+Xt>>1;if(Math.abs(zt-Qt)+Math.abs(Jt-ge)>1&&Tn[Xe*se+he])bt(Qt,ge,zt,Jt,he,Xe),bt(le,Xt,Qt,ge,he,Xe);else{const Ze=ct(zt,Jt),dn=ct(le,Xt),Dn=ct(Qt,ge);tt.emplaceBack(Ze,dn,Dn)}}return bt(0,0,Rt,Rt,Rt,0),bt(Rt,Rt,0,0,0,Rt),{vertices:$,indices:tt}}(this.tileID.canonical,a);m=x.vertices,v=x.indices}else{m=new Wr,v=new aa;for(const{x:T,y:P}of h)m.emplaceBack(T,P,0,0);const x=Zd.exports(m.int16,void 0,4);for(let T=0;T<x.length;T+=3)v.emplaceBack(x[T],x[T+1],x[T+2])}this._tileBoundsBuffer=i.createVertexBuffer(m,si.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(v),this._tileBoundsSegments=cs.simpleSegment(0,0,m.length,v.length)}_makeGlobeTileDebugBuffers(i,a){const h=a.projection;if(!h||h.name!=="globe"||a.freezeTileCoverage)return;const m=this.tileID.canonical,v=rp(w0(m,a)),x=sf(a.zoom);let T;x>0&&(T=am(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(i,m,a,v,T,x),this._makeGlobeTileDebugTextBuffer(i,m,a,v,T,x)}_globePoint(i,a,h,m,v,x,T){let P=ip(i,a,h);if(x){const O=1<<h.z,V=Ju(m.center.lng),$=au(m.center.lat),tt=(h.x+.5)/O-V;let ot=0;tt>.5?ot=-1:tt<-.5&&(ot=1);let ct=(i/xi+h.x)/O+ot,bt=(a/xi+h.y)/O;ct=(ct-V)*m._pixelsPerMercatorPixel+V,bt=(bt-$)*m._pixelsPerMercatorPixel+$;const zt=[ct*m.worldSize,bt*m.worldSize,0];os(zt,zt,x),P=of(P,zt,T)}return os(P,P,v)}_makeGlobeTileDebugBorderBuffer(i,a,h,m,v,x){const T=new Dr,P=new Zc,O=new to,V=(tt,ot,ct,bt,zt)=>{const Jt=(ct-tt)/(zt-1),le=(bt-ot)/(zt-1),Xt=T.length;for(let Qt=0;Qt<zt;Qt++){const ge=tt+Qt*Jt,he=ot+Qt*le;T.emplaceBack(ge,he);const Xe=this._globePoint(ge,he,a,h,m,v,x);O.emplaceBack(Xe[0],Xe[1],Xe[2]),P.emplaceBack(Xt+Qt)}},$=xi;V(0,0,$,0,16),V($,0,$,$,16),V($,$,0,$,16),V(0,$,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(P),this._tileDebugBuffer=i.createVertexBuffer(T,ep.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(O,R_.members),this._tileDebugSegments=cs.simpleSegment(0,0,T.length,P.length)}_makeGlobeTileDebugTextBuffer(i,a,h,m,v,x){const T=new Dr,P=new aa,O=new to,V=25;P.reserve(32),T.reserve(V),O.reserve(V);const $=(tt,ot)=>V*tt+ot;for(let tt=0;tt<V;tt++){const ot=2048*tt;for(let ct=0;ct<V;ct++){const bt=2048*ct;T.emplaceBack(bt,ot);const zt=this._globePoint(bt,ot,a,h,m,v,x);O.emplaceBack(zt[0],zt[1],zt[2])}}for(let tt=0;tt<4;tt++)for(let ot=0;ot<4;ot++){const ct=$(tt,ot),bt=$(tt,ot+1),zt=$(tt+1,ot),Jt=$(tt+1,ot+1);P.emplaceBack(ct,bt,zt),P.emplaceBack(zt,bt,Jt)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(P),this._tileDebugTextBuffer=i.createVertexBuffer(T,ep.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(O,R_.members),this._tileDebugTextSegments=cs.simpleSegment(0,0,V,32)}}class Cr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,a,h){const m=String(a);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][m]=this.stateChanges[i][m]||{},be(this.stateChanges[i][m],h),this.deletedStates[i]===null){this.deletedStates[i]={};for(const v in this.state[i])v!==m&&(this.deletedStates[i][v]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][m]===null){this.deletedStates[i][m]={};for(const v in this.state[i][m])h[v]||(this.deletedStates[i][m][v]=null)}else for(const v in h)this.deletedStates[i]&&this.deletedStates[i][m]&&this.deletedStates[i][m][v]===null&&delete this.deletedStates[i][m][v]}removeFeatureState(i,a,h){if(this.deletedStates[i]===null)return;const m=String(a);if(this.deletedStates[i]=this.deletedStates[i]||{},h&&a!==void 0)this.deletedStates[i][m]!==null&&(this.deletedStates[i][m]=this.deletedStates[i][m]||{},this.deletedStates[i][m][h]=null);else if(a!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][m])for(h in this.deletedStates[i][m]={},this.stateChanges[i][m])this.deletedStates[i][m][h]=null;else this.deletedStates[i][m]=null;else this.deletedStates[i]=null}getState(i,a){const h=String(a),m=be({},(this.state[i]||{})[h],(this.stateChanges[i]||{})[h]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const v=this.deletedStates[i][a];if(v===null)return{};for(const x in v)delete m[x]}return m}initializeTileState(i,a){i.setFeatureState(this.state,a)}coalesceChanges(i,a){const h={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const v={};for(const x in this.stateChanges[m])this.state[m][x]||(this.state[m][x]={}),be(this.state[m][x],this.stateChanges[m][x]),v[x]=this.state[m][x];h[m]=v}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const v={};if(this.deletedStates[m]===null)for(const x in this.state[m])v[x]={},this.state[m][x]={};else for(const x in this.deletedStates[m]){if(this.deletedStates[m][x]===null)this.state[m][x]={};else for(const T of Object.keys(this.deletedStates[m][x]))delete this.state[m][x][T];v[x]=this.state[m][x]}h[m]=h[m]||{},be(h[m],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const m in i)i[m].setFeatureState(h,a)}}class Ji{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,a){const h=this.toIdx(i,a);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(i,a){return this.leaves[this.toIdx(i,a)]}toIdx(i,a){return a*this.size+i}}function Pr(s,i,a,h){let m=0,v=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(h[x])<1e-15){if(a[x]<s[x]||a[x]>i[x])return null}else{const T=1/h[x];let P=(s[x]-a[x])*T,O=(i[x]-a[x])*T;if(P>O){const V=P;P=O,O=V}if(P>m&&(m=P),O<v&&(v=O),m>v)return null}return m}function Br(s,i,a,h,m,v,x,T,P,O,V){const $=h-s,tt=m-i,ot=v-a,ct=x-s,bt=T-i,zt=P-a,Jt=V[1]*zt-V[2]*bt,le=V[2]*ct-V[0]*zt,Xt=V[0]*bt-V[1]*ct,Qt=$*Jt+tt*le+ot*Xt;if(Math.abs(Qt)<1e-15)return null;const ge=1/Qt,he=O[0]-s,Xe=O[1]-i,Ze=O[2]-a,dn=(he*Jt+Xe*le+Ze*Xt)*ge;if(dn<0||dn>1)return null;const Dn=Xe*ot-Ze*tt,en=Ze*$-he*ot,_n=he*tt-Xe*$,wn=(V[0]*Dn+V[1]*en+V[2]*_n)*ge;return wn<0||dn+wn>1?null:(ct*Dn+bt*en+zt*_n)*ge}function jl(s,i,a){return(s-i)/(a-i)}function il(s,i,a,h,m,v,x,T,P){const O=1<<a,V=v-h,$=x-m,tt=(s+1)/O*V+h,ot=(i+0)/O*$+m,ct=(i+1)/O*$+m;T[0]=(s+0)/O*V+h,T[1]=ot,P[0]=tt,P[1]=ct}class Ul{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(v){const x=Math.ceil(Math.log2(v.dim/8)),T=[];let P=Math.ceil(Math.pow(2,x));const O=1/P,V=(ot,ct,bt,zt,Jt)=>{const le=zt?1:0,Xt=(ot+1)*bt-le,Qt=ct*bt,ge=(ct+1)*bt-le;Jt[0]=ot*bt,Jt[1]=Qt,Jt[2]=Xt,Jt[3]=ge};let $=new Ji(P);const tt=[];for(let ot=0;ot<P*P;ot++){V(ot%P,Math.floor(ot/P),O,!1,tt);const ct=ba(tt[0],tt[1],v),bt=ba(tt[2],tt[1],v),zt=ba(tt[2],tt[3],v),Jt=ba(tt[0],tt[3],v);$.minimums.push(Math.min(ct,bt,zt,Jt)),$.maximums.push(Math.max(ct,bt,zt,Jt)),$.leaves.push(1)}for(T.push($),P/=2;P>=1;P/=2){const ot=T[T.length-1];$=new Ji(P);for(let ct=0;ct<P*P;ct++){V(ct%P,Math.floor(ct/P),2,!0,tt);const bt=ot.getElevation(tt[0],tt[1]),zt=ot.getElevation(tt[2],tt[1]),Jt=ot.getElevation(tt[2],tt[3]),le=ot.getElevation(tt[0],tt[3]),Xt=ot.isLeaf(tt[0],tt[1]),Qt=ot.isLeaf(tt[2],tt[1]),ge=ot.isLeaf(tt[2],tt[3]),he=ot.isLeaf(tt[0],tt[3]),Xe=Math.min(bt.min,zt.min,Jt.min,le.min),Ze=Math.max(bt.max,zt.max,Jt.max,le.max),dn=Xt&&Qt&&ge&&he;$.maximums.push(Ze),$.minimums.push(Xe),$.leaves.push(Ze-Xe<=5&&dn?1:0)}T.push($)}return T}(this.dem),h=a.length-1,m=a[h];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(a,0,0,h,0)}raycastRoot(i,a,h,m,v,x,T=1){return Pr([i,a,-100],[h,m,this.maximums[0]*T],v,x)}raycast(i,a,h,m,v,x,T=1){if(!this.nodeCount)return null;const P=this.raycastRoot(i,a,h,m,v,x,T);if(P==null)return null;const O=[],V=[],$=[],tt=[],ot=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;ot.length>0;){const{idx:ct,t:bt,nodex:zt,nodey:Jt,depth:le}=ot.pop();if(this.leaves[ct]){il(zt,Jt,le,i,a,h,m,$,tt);const Qt=1<<le,ge=(zt+0)/Qt,he=(zt+1)/Qt,Xe=(Jt+0)/Qt,Ze=(Jt+1)/Qt,dn=ba(ge,Xe,this.dem)*T,Dn=ba(he,Xe,this.dem)*T,en=ba(he,Ze,this.dem)*T,_n=ba(ge,Ze,this.dem)*T,wn=Br($[0],$[1],dn,tt[0],$[1],Dn,tt[0],tt[1],en,v,x),En=Br(tt[0],tt[1],en,$[0],tt[1],_n,$[0],$[1],dn,v,x),Nn=Math.min(wn!==null?wn:Number.MAX_VALUE,En!==null?En:Number.MAX_VALUE);if(Nn!==Number.MAX_VALUE)return Nn;{const nn=Bf([],v,x,bt);if(Is(dn,Dn,_n,en,jl(nn[0],$[0],tt[0]),jl(nn[1],$[1],tt[1]))>=nn[2])return bt}continue}let Xt=0;for(let Qt=0;Qt<this._siblingOffset.length;Qt++){il((zt<<1)+this._siblingOffset[Qt][0],(Jt<<1)+this._siblingOffset[Qt][1],le+1,i,a,h,m,$,tt),$[2]=-100,tt[2]=this.maximums[this.childOffsets[ct]+Qt]*T;const ge=Pr($,tt,v,x);if(ge!=null){const he=ge;O[Qt]=he;let Xe=!1;for(let Ze=0;Ze<Xt&&!Xe;Ze++)he>=O[V[Ze]]&&(V.splice(Ze,0,Qt),Xe=!0);Xe||(V[Xt]=Qt),Xt++}}for(let Qt=0;Qt<Xt;Qt++){const ge=V[Qt];ot.push({idx:this.childOffsets[ct]+ge,t:O[ge],nodex:(zt<<1)+this._siblingOffset[ge][0],nodey:(Jt<<1)+this._siblingOffset[ge][1],depth:le+1})}}return null}_addNode(i,a,h){return this.minimums.push(i),this.maximums.push(a),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(i,a,h,m,v){if(i[m].isLeaf(a,h)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const x=m-1,T=i[x];let P=0,O=0;for(let V=0;V<this._siblingOffset.length;V++){const $=2*a+this._siblingOffset[V][0],tt=2*h+this._siblingOffset[V][1],ot=T.getElevation($,tt),ct=T.isLeaf($,tt),bt=this._addNode(ot.min,ot.max,ct);ct&&(P|=1<<V),O||(O=bt)}for(let V=0;V<this._siblingOffset.length;V++)P&1<<V||this._construct(i,2*a+this._siblingOffset[V][0],2*h+this._siblingOffset[V][1],x,O+V)}}function Is(s,i,a,h,m,v){return Ri(Ri(s,a,v),Ri(i,h,v),m)}function ba(s,i,a){const h=a.dim,m=ie(s*h-.5,0,h-1),v=ie(i*h-.5,0,h-1),x=Math.floor(m),T=Math.floor(v),P=Math.min(x+1,h-1),O=Math.min(T+1,h-1);return Is(a.get(x,T),a.get(P,T),a.get(x,O),a.get(P,O),m-x,v-T)}const Ec={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class cp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,a,h,m=!1,v=!1){if(this.uid=i,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return cn(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const x=this.dim=a.height-2,T=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.encoding=h||"mapbox",this.borderReady=m,!m){for(let P=0;P<x;P++)T[this._idx(-1,P)]=T[this._idx(0,P)],T[this._idx(x,P)]=T[this._idx(x-1,P)],T[this._idx(P,-1)]=T[this._idx(P,0)],T[this._idx(P,x)]=T[this._idx(P,x-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(x,-1)]=T[this._idx(x-1,0)],T[this._idx(-1,x)]=T[this._idx(0,x-1)],T[this._idx(x,x)]=T[this._idx(x-1,x-1)],v&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Ul(this)}get(i,a,h=!1){h&&(i=ie(i,-1,this.dim),a=ie(a,-1,this.dim));const m=4*this._idx(i,a);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(i){return Ec[i]}get unpackVector(){return Ec[this.encoding]}_idx(i,a){if(i<-1||i>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(i+1)}_unpackMapbox(i,a,h){return(256*i*256+256*a+h)/10-1e4}_unpackTerrarium(i,a,h){return 256*i+a+h/256-32768}static pack(i,a){const h=[0,0,0,0],m=cp.getUnpackVector(a);let v=Math.floor((i+m[3])/m[2]);return h[2]=v%256,v=Math.floor(v/256),h[1]=v%256,v=Math.floor(v/256),h[0]=v,h}getPixels(){return new Fl({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,a,h){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let m=a*this.dim,v=a*this.dim+this.dim,x=h*this.dim,T=h*this.dim+this.dim;switch(a){case-1:m=v-1;break;case 1:v=m+1}switch(h){case-1:x=T-1;break;case 1:T=x+1}const P=-a*this.dim,O=-h*this.dim;for(let V=x;V<T;V++)for(let $=m;$<v;$++){const tt=4*this._idx($,V),ot=4*this._idx($+P,V+O);this.pixels[tt+0]=i.pixels[ot+0],this.pixels[tt+1]=i.pixels[ot+1],this.pixels[tt+2]=i.pixels[ot+2],this.pixels[tt+3]=i.pixels[ot+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Xn(cp,"DEMData"),Xn(Ul,"DemMinMaxQuadTree",{omit:["dem"]});class Yk{constructor(i,a){this.max=i,this.onRemove=a,this.reset()}reset(){for(const i in this.data)for(const a of this.data[i])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(i,a,h){const m=i.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const v={value:a,timeout:void 0};if(h!==void 0&&(v.timeout=setTimeout(()=>{this.remove(i,v)},h)),this.data[m].push(v),this.order.push(m),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const a=this.data[i].shift();return a.timeout&&clearTimeout(a.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),a.value}getByKey(i){const a=this.data[i];return a?a[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,a){if(!this.has(i))return this;const h=i.wrapped().key,m=a===void 0?0:this.data[h].indexOf(a),v=this.data[h][m];return this.data[h].splice(m,1),v.timeout&&clearTimeout(v.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(v.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(i){const a=[];for(const h in this.data)for(const m of this.data[h])i(m.value)||a.push(m);for(const h of a)this.remove(h.value.tileID,h)}}class Um{constructor(i,a,h){this.func=i,this.mask=a,this.range=h}}Um.ReadOnly=!1,Um.ReadWrite=!0,Um.disabled=new Um(519,Um.ReadOnly,[0,1]);const Rb=7680;class Bb{constructor(i,a,h,m,v,x){this.test=i,this.ref=a,this.mask=h,this.fail=m,this.depthFail=v,this.pass=x}}Bb.disabled=new Bb({func:519,mask:0},0,0,Rb,Rb,Rb);class Ih{constructor(i,a,h){this.blendFunction=i,this.blendColor=a,this.mask=h}}Ih.Replace=[1,0],Ih.disabled=new Ih(Ih.Replace,Zr.transparent,[!1,!1,!1,!1]),Ih.unblended=new Ih(Ih.Replace,Zr.transparent,[!0,!0,!0,!0]),Ih.alphaBlended=new Ih([1,771],Zr.transparent,[!0,!0,!0,!0]);const Fb=1029,jb=2305;class Kc{constructor(i,a,h){this.enable=i,this.mode=a,this.frontFace=h}}Kc.disabled=new Kc(!1,Fb,jb),Kc.backCCW=new Kc(!0,Fb,jb),Kc.backCW=new Kc(!0,Fb,2304),Kc.frontCW=new Kc(!0,1028,2304),Kc.frontCCW=new Kc(!0,1028,jb);class hp extends vs{constructor(i,a,h){super(),this.id=i,this._onlySymbols=h,a.on("data",m=>{m.dataType==="source"&&m.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&m.dataType==="source"&&m.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),a.on("error",()=>{this._sourceErrored=!0}),this._source=a,this._tiles={},this._cache=new Yk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Cr,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(i){this.map=i,this._minTileCacheSize=this._minTileCacheSize===void 0&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const a=this._tiles[i];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,a){return i.isSymbolTile=this._onlySymbols,this._source.loadTile(i,a)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const h=this._tiles[a];h.upload(i),h.prepare(this.map.style.imageManager)}}getIds(){return Me(this._tiles).map(i=>i.tileID).sort(SA).map(i=>i.key)}getRenderableIds(i){const a=[];for(const h in this._tiles)this._isIdRenderable(+h,i)&&a.push(this._tiles[h]);return i?a.sort((h,m)=>{const v=h.tileID,x=m.tileID,T=new j(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),P=new j(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-x.overscaledZ||P.y-T.y||P.x-T.x}).map(h=>h.tileID.key):a.map(h=>h.tileID).sort(SA).map(h=>h.key)}hasRenderableParent(i){const a=this.findLoadedParent(i,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(i,a){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(a||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(+i,"reloading")}}_reloadTile(i,a){const h=this._tiles[i];h&&(h.state!=="loading"&&(h.state=a),this._loadTile(h,this._tileLoaded.bind(this,h,i,a)))}_tileLoaded(i,a,h,m){if(m)if(i.state="errored",m.status!==404)this._source.fire(new Ss(m,{tile:i}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform);else i.timeAdded=ti.now(),h==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(a,i),this._source.type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new Js("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const a=this.getRenderableIds();for(let m=0;m<a.length;m++){const v=a[m];if(i.neighboringTiles&&i.neighboringTiles[v]){const x=this.getTileByID(v);h(i,x),h(x,i)}}function h(m,v){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let x=v.tileID.canonical.x-m.tileID.canonical.x;const T=v.tileID.canonical.y-m.tileID.canonical.y,P=Math.pow(2,m.tileID.canonical.z),O=v.tileID.key;x===0&&T===0||Math.abs(T)>1||(Math.abs(x)>1&&(Math.abs(x+P)===1?x+=P:Math.abs(x-P)===1&&(x-=P)),v.dem&&m.dem&&(m.dem.backfillBorder(v.dem,x,T),m.neighboringTiles&&m.neighboringTiles[O]&&(m.neighboringTiles[O].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,a,h,m){for(const v in this._tiles){let x=this._tiles[v];if(m[v]||!x.hasData()||x.tileID.overscaledZ<=a||x.tileID.overscaledZ>h)continue;let T=x.tileID;for(;x&&x.tileID.overscaledZ>a+1;){const O=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[O.key],x&&x.hasData()&&(T=O)}let P=T;for(;P.overscaledZ>a;)if(P=P.scaledTo(P.overscaledZ-1),i[P.key]){m[T.key]=T;break}}}findLoadedParent(i,a){if(i.key in this._loadedParentTiles){const h=this._loadedParentTiles[i.key];return h&&h.tileID.overscaledZ>=a?h:null}for(let h=i.overscaledZ-1;h>=a;h--){const m=i.scaledTo(h),v=this._getLoadedTile(m);if(v)return v}}_getLoadedTile(i){const a=this._tiles[i.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,a){a=a||this._source.tileSize;const h=Math.ceil(i.width/a)+1,m=Math.ceil(i.height/a)+1,v=Math.floor(h*m*5),x=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(T)}handleWrapJump(i){const a=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,a){const h={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+a),h[v.tileID.key]=v}this._tiles=h;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(i,a,h){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!h)return;let m;this.updateCacheSize(i,a),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new la(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(m=i.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter(T=>this._source.hasTile(T)))):m=[];const v=this._updateRetainedTiles(m);if(EA(this._source.type)&&m.length!==0){const T={},P={},O=Object.keys(v);for(const $ of O){const tt=v[$],ot=this._tiles[$];if(!ot||ot.fadeEndTime&&ot.fadeEndTime<=ti.now())continue;const ct=this.findLoadedParent(tt,Math.max(tt.overscaledZ-hp.maxOverzooming,this._source.minzoom));ct&&(this._addTile(ct.tileID),T[ct.tileID.key]=ct.tileID),P[$]=tt}const V=m[m.length-1].overscaledZ;for(const $ in this._tiles){const tt=this._tiles[$];if(v[$]||!tt.hasData())continue;let ot=tt.tileID;for(;ot.overscaledZ>V;){ot=ot.scaledTo(ot.overscaledZ-1);const ct=this._tiles[ot.key];if(ct&&ct.hasData()&&P[ot.key]){v[$]=tt.tileID;break}}}for(const $ in T)v[$]||(this._coveredTiles[$]=!0,v[$]=T[$])}for(const T in v)this._tiles[T].clearFadeHold();const x=function(T,P){const O=[];for(const V in T)V in P||O.push(V);return O}(this._tiles,v);for(const T of x){const P=this._tiles[T];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(+T)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const a={};if(i.length===0)return a;const h={},m=i.reduce((O,V)=>Math.min(O,V.overscaledZ),1/0),v=i[0].overscaledZ,x=Math.max(v-hp.maxOverzooming,this._source.minzoom),T=Math.max(v+hp.maxUnderzooming,this._source.minzoom),P={};for(const O of i){const V=this._addTile(O);a[O.key]=O,V.hasData()||m<this._source.maxzoom&&(P[O.key]=O)}this._retainLoadedChildren(P,m,T,a);for(const O of i){let V=this._tiles[O.key];if(V.hasData())continue;if(O.canonical.z>=this._source.maxzoom){const tt=O.children(this._source.maxzoom)[0],ot=this.getTile(tt);if(ot&&ot.hasData()){a[tt.key]=tt;continue}}else{const tt=O.children(this._source.maxzoom);if(a[tt[0].key]&&a[tt[1].key]&&a[tt[2].key]&&a[tt[3].key])continue}let $=V.wasRequested();for(let tt=O.overscaledZ-1;tt>=x;--tt){const ot=O.scaledTo(tt);if(h[ot.key]||(h[ot.key]=!0,V=this.getTile(ot),!V&&$&&(V=this._addTile(ot)),V&&(a[ot.key]=ot,$=V.wasRequested(),V.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const a=[];let h,m=this._tiles[i].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){h=this._loadedParentTiles[m.key];break}a.push(m.key);const v=m.scaledTo(m.overscaledZ-1);if(h=this._getLoadedTile(v),h)break;m=v}for(const v of a)this._loadedParentTiles[v]=h}}_addTile(i){let a=this._tiles[i.key];if(a)return a;a=this._cache.getAndRemove(i),a&&(this._setTileReloadTimer(i.key,a),a.tileID=i,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,a)));const h=Boolean(a);if(!h){const m=this.map?this.map.painter:null;a=new Yi(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,i.key,a.state))}return a?(a.uses++,this._tiles[i.key]=a,h||this._source.fire(new Js("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(i,a){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const h=a.getExpiryTimeout();h&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},h))}_removeTile(i){const a=this._tiles[i];a&&(a.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,a,h){const m=[],v=this.transform;if(!v)return m;const x=v.projection.name==="globe",T=Ju(v.center.lng);for(const P in this._tiles){const O=this._tiles[P];if(h&&O.clearQueryDebugViz(),O.holdingForFade())continue;let V;if(x){const $=O.tileID.canonical;if($.z===0){const tt=[Math.abs(ie(T,...Q_($,-1))-T),Math.abs(ie(T,...Q_($,1))-T)];V=[0,2*tt.indexOf(Math.min(...tt))-1]}else{const tt=[Math.abs(ie(T,...Q_($,-1))-T),Math.abs(ie(T,...Q_($,0))-T),Math.abs(ie(T,...Q_($,1))-T)];V=[tt.indexOf(Math.min(...tt))-1]}}else V=[0];for(const $ of V){const tt=i.containsTile(O,v,a,$);tt&&m.push(tt)}}return m}getVisibleCoordinates(i){const a=this.getRenderableIds(i).map(h=>this._tiles[h].tileID);for(const h of a)h.projMatrix=this.transform.calculateProjMatrix(h.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(EA(this._source.type))for(const i in this._tiles){const a=this._tiles[i];if(a.fadeEndTime!==void 0&&a.fadeEndTime>=ti.now())return!0}return!1}setFeatureState(i,a,h){this._state.updateState(i=i||"_geojsonTileLayer",a,h)}removeFeatureState(i,a,h){this._state.removeFeatureState(i=i||"_geojsonTileLayer",a,h)}getFeatureState(i,a){return this._state.getState(i=i||"_geojsonTileLayer",a)}setDependencies(i,a,h){const m=this._tiles[i];m&&m.setDependencies(a,h)}reloadTilesForDependencies(i,a){for(const h in this._tiles)this._tiles[h].hasDependency(i,a)&&this._reloadTile(+h,"reloading");this._cache.filter(h=>!h.hasDependency(i,a))}_preloadTiles(i,a){const h=new Map,m=Array.isArray(i)?i:[i],v=this.map.painter.terrain,x=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const T of m){const P=T.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const O of P)h.set(O.key,O);this.usedForTerrain&&T.updateElevation(!1)}_e(Array.from(h.values()),(T,P)=>{const O=new Yi(T,this._source.tileSize*T.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(O,V=>{this._source.type==="raster-dem"&&O.dem&&this._backfillDEM(O),P(V,O)})},a)}}function SA(s,i){const a=Math.abs(2*s.wrap)-+(s.wrap<0),h=Math.abs(2*i.wrap)-+(i.wrap<0);return s.overscaledZ-i.overscaledZ||h-a||i.canonical.y-s.canonical.y||i.canonical.x-s.canonical.x}function EA(s){return s==="raster"||s==="image"||s==="video"||s==="custom"}function Q_(s,i){const a=1<<s.z;return[s.x/a+i,(s.x+1)/a+i]}hp.maxOverzooming=10,hp.maxUnderzooming=3;class L0{constructor(i,a,h){this._demTile=i,this._dem=this._demTile.dem,this._scale=a,this._offset=h}static create(i,a,h){const m=h||i.findDEMTileFor(a);if(!m||!m.dem)return;const v=m.dem,x=m.tileID,T=1<<a.canonical.z-x.canonical.z;return new L0(m,m.tileSize/xi/T,[(a.canonical.x/T-x.canonical.x)*v.dim,(a.canonical.y/T-x.canonical.y)*v.dim])}tileCoordToPixel(i,a){const h=a*this._scale+this._offset[1],m=Math.floor(i*this._scale+this._offset[0]),v=Math.floor(h);return new j(m,v)}getElevationAt(i,a,h,m){const v=i*this._scale+this._offset[0],x=a*this._scale+this._offset[1],T=Math.floor(v),P=Math.floor(x),O=this._dem;return m=!!m,h?Ri(Ri(O.get(T,P,m),O.get(T,P+1,m),x-P),Ri(O.get(T+1,P,m),O.get(T+1,P+1,m),x-P),v-T):O.get(T,P,m)}getElevationAtPixel(i,a,h){return this._dem.get(i,a,!!h)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*lu(1,i)*this._dem.stride}}class MA{constructor(i,a){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new dh(xi,16,0),this.featureIndexArray=new Vc,this.promoteId=a}insert(i,a,h,m,v,x=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,v,x);const P=this.grid;for(let O=0;O<a.length;O++){const V=a[O],$=[1/0,1/0,-1/0,-1/0];for(let tt=0;tt<V.length;tt++){const ot=V[tt];$[0]=Math.min($[0],ot.x),$[1]=Math.min($[1],ot.y),$[2]=Math.max($[2],ot.x),$[3]=Math.max($[3],ot.y)}$[0]<xi&&$[1]<xi&&$[2]>=0&&$[3]>=0&&P.insert(T,$[0],$[1],$[2],$[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new __(new Kd(this.rawTileData)).layers,this.sourceLayerCoder=new F(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,a,h,m){this.loadVTLayers();const v=i.params||{},x=St(v.filter),T=i.tileResult,P=i.transform,O=T.bufferedTilespaceBounds,V=this.grid.query(O.min.x,O.min.y,O.max.x,O.max.y,(ct,bt,zt,Jt)=>Jg(T.bufferedTilespaceGeometry,ct,bt,zt,Jt));V.sort(Xk);let $=null;P.elevation&&V.length>0&&($=L0.create(P.elevation,this.tileID));const tt={};let ot;for(let ct=0;ct<V.length;ct++){const bt=V[ct];if(bt===ot)continue;ot=bt;const zt=this.featureIndexArray.get(bt);let Jt=null;this.loadMatchingFeature(tt,zt,x,v.layers,v.availableImages,a,h,m,(le,Xt,Qt,ge=0)=>(Jt||(Jt=Qu(le,this.tileID.canonical,i.tileTransform)),Xt.queryIntersectsFeature(T,le,Qt,Jt,this.z,i.transform,i.pixelPosMatrix,$,ge)))}return tt}loadMatchingFeature(i,a,h,m,v,x,T,P,O){const{featureIndex:V,bucketIndex:$,sourceLayerIndex:tt,layoutVertexArrayOffset:ot}=a,ct=this.bucketLayerIDs[$];if(m&&!function(le,Xt){for(let Qt=0;Qt<le.length;Qt++)if(Xt.indexOf(le[Qt])>=0)return!0;return!1}(m,ct))return;const bt=this.sourceLayerCoder.decode(tt),zt=this.vtLayers[bt].feature(V);if(h.needGeometry){const le=bc(zt,!0);if(!h.filter(new De(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!h.filter(new De(this.tileID.overscaledZ),zt))return;const Jt=this.getId(zt,bt);for(let le=0;le<ct.length;le++){const Xt=ct[le];if(m&&m.indexOf(Xt)<0)continue;const Qt=x[Xt];if(!Qt)continue;let ge={};Jt!==void 0&&P&&(ge=P.getState(Qt.sourceLayer||"_geojsonTileLayer",Jt));const he=be({},T[Xt]);he.paint=LA(he.paint,Qt.paint,zt,ge,v),he.layout=LA(he.layout,Qt.layout,zt,ge,v);const Xe=!O||O(zt,Qt,ge,ot);if(!Xe)continue;const Ze=new At(zt,this.z,this.x,this.y,Jt);Ze.layer=he;let dn=i[Xt];dn===void 0&&(dn=i[Xt]=[]),dn.push({featureIndex:V,feature:Ze,intersectionZ:Xe})}}lookupSymbolFeatures(i,a,h,m,v,x,T,P){const O={};this.loadVTLayers();const V=St(v);for(const $ of i)this.loadMatchingFeature(O,{bucketIndex:h,sourceLayerIndex:m,featureIndex:$,layoutVertexArrayOffset:0},V,x,T,P,a);return O}loadFeature(i){const{featureIndex:a,sourceLayerIndex:h}=i;this.loadVTLayers();const m=this.sourceLayerCoder.decode(h),v=this.vtFeatures[m];if(v[a])return v[a];const x=this.vtLayers[m].feature(a);return v[a]=x,x}hasLayer(i){for(const a of this.bucketLayerIDs)for(const h of a)if(i===h)return!0;return!1}getId(i,a){let h=i.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[a];m!=null&&(h=i.properties[m]),typeof h=="boolean"&&(h=Number(h))}return h}}function LA(s,i,a,h,m){return Ue(s,(v,x)=>{const T=i instanceof zn?i.get(x):null;return T&&T.evaluate?T.evaluate(a,h,m):T})}function Xk(s,i){return i-s}Xn(MA,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class kA{constructor(i,a){this.width=i,this.height=a,this.nextRow=0,this.image=new Hc({width:i,height:a}),this.positions={},this.uploaded=!1}getDash(i,a){const h=this.getKey(i,a);return this.positions[h]}trim(){const i=this.width,a=this.height=ve(this.nextRow);this.image.resize({width:i,height:a})}getKey(i,a){return i.join(",")+a}getDashRanges(i,a,h){const m=[];let v=i.length%2==1?-i[i.length-1]*h:0,x=i[0]*h,T=!0;m.push({left:v,right:x,isDash:T,zeroLength:i[0]===0});let P=i[0];for(let O=1;O<i.length;O++){T=!T;const V=i[O];v=P*h,P+=V,x=P*h,m.push({left:v,right:x,isDash:T,zeroLength:V===0})}return m}addRoundDash(i,a,h){const m=a/2;for(let v=-h;v<=h;v++){const x=this.width*(this.nextRow+h+v);let T=0,P=i[T];for(let O=0;O<this.width;O++){O/P.right>1&&(P=i[++T]);const V=Math.abs(O-P.left),$=Math.abs(O-P.right),tt=Math.min(V,$);let ot;const ct=v/h*(m+1);if(P.isDash){const bt=m-Math.abs(ct);ot=Math.sqrt(tt*tt+bt*bt)}else ot=m-Math.sqrt(tt*tt+ct*ct);this.image.data[x+O]=Math.max(0,Math.min(255,ot+128))}}}addRegularDash(i,a){for(let P=i.length-1;P>=0;--P){const O=i[P],V=i[P+1];O.zeroLength?i.splice(P,1):V&&V.isDash===O.isDash&&(V.left=O.left,i.splice(P,1))}const h=i[0],m=i[i.length-1];h.isDash===m.isDash&&(h.left=m.left-this.width,m.right=h.right+this.width);const v=this.width*this.nextRow;let x=0,T=i[x];for(let P=0;P<this.width;P++){P/T.right>1&&(T=i[++x]);const O=Math.abs(P-T.left),V=Math.abs(P-T.right),$=Math.min(O,V);this.image.data[v+P]=Math.max(0,Math.min(255,(T.isDash?$:-$)+a+128))}}addDash(i,a){const h=this.getKey(i,a);if(this.positions[h])return this.positions[h];const m=a==="round",v=m?7:0,x=2*v+1;if(this.nextRow+x>this.height)return cn("LineAtlas out of space"),null;i.length===0&&i.push(1);let T=0;for(let V=0;V<i.length;V++)i[V]<0&&(cn("Negative value is found in line dasharray, replacing values with 0"),i[V]=0),T+=i[V];if(T!==0){const V=this.width/T,$=this.getDashRanges(i,this.width,V);m?this.addRoundDash($,V,v):this.addRegularDash($,a==="square"?.5*V:0)}const P=this.nextRow+v;this.nextRow+=x;const O={tl:[P,v],br:[T,0]};return this.positions[h]=O,O}}Xn(kA,"LineAtlas");class PA{constructor(i){const a={},h=[];for(const T in i){const P=i[T],O=a[T]={};for(const V in P.glyphs){const $=P.glyphs[+V];if(!$||$.bitmap.width===0||$.bitmap.height===0)continue;const tt=$.metrics.localGlyph?2:1,ot={x:0,y:0,w:$.bitmap.width+2*tt,h:$.bitmap.height+2*tt};h.push(ot),O[V]=ot}}const{w:m,h:v}=E_(h),x=new Hc({width:m||1,height:v||1});for(const T in i){const P=i[T];for(const O in P.glyphs){const V=P.glyphs[+O];if(!V||V.bitmap.width===0||V.bitmap.height===0)continue;const $=a[T][O],tt=V.metrics.localGlyph?2:1;Hc.copy(V.bitmap,x,{x:0,y:0},{x:$.x+tt,y:$.y+tt},V.bitmap)}}this.image=x,this.positions=a}}Xn(PA,"GlyphAtlas");class Hk{constructor(i){this.tileID=new la(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.canonical=i.tileID.canonical,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.returnDependencies=!!i.returnDependencies,this.promoteId=i.promoteId,this.enableTerrain=!!i.enableTerrain,this.isSymbolTile=i.isSymbolTile,this.tileTransform=af(i.tileID.canonical,i.projection),this.projection=i.projection}parse(i,a,h,m,v){this.status="parsing",this.data=i,this.collisionBoxArray=new Dg;const x=new F(Object.keys(i.layers).sort()),T=new MA(this.tileID,this.promoteId);T.bucketLayerIDs=[];const P={},O=new kA(256,256),V={featureIndex:T,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:O,availableImages:h},$=a.familiesBySource[this.source];for(const ge in $){const he=i.layers[ge];if(!he)continue;let Xe=!1,Ze=!1;for(const en of $[ge])en[0].type==="symbol"?Xe=!0:Ze=!0;if(this.isSymbolTile===!0&&!Xe||this.isSymbolTile===!1&&!Ze)continue;he.version===1&&cn(`Vector tile source "${this.source}" layer "${ge}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const dn=x.encode(ge),Dn=[];for(let en=0;en<he.length;en++){const _n=he.feature(en),wn=T.getId(_n,ge);Dn.push({feature:_n,id:wn,index:en,sourceLayerIndex:dn})}for(const en of $[ge]){const _n=en[0];this.isSymbolTile!==void 0&&_n.type==="symbol"!==this.isSymbolTile||_n.minzoom&&this.zoom<Math.floor(_n.minzoom)||_n.maxzoom&&this.zoom>=_n.maxzoom||_n.visibility!=="none"&&(Ub(en,this.zoom,h),(P[_n.id]=_n.createBucket({index:T.bucketLayerIDs.length,layers:en,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:dn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:h})).populate(Dn,V,this.tileID.canonical,this.tileTransform),T.bucketLayerIDs.push(en.map(wn=>wn.id)))}}let tt,ot,ct,bt;O.trim();const zt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Jt=Ue(V.glyphDependencies,ge=>Object.keys(ge).map(Number));Object.keys(Jt).length?m.send("getGlyphs",{uid:this.uid,stacks:Jt},(ge,he)=>{tt||(tt=ge,ot=he,Qt.call(this))},void 0,!1,zt):ot={};const le=Object.keys(V.iconDependencies);le.length?m.send("getImages",{icons:le,source:this.source,tileID:this.tileID,type:"icons"},(ge,he)=>{tt||(tt=ge,ct=he,Qt.call(this))},void 0,!1,zt):ct={};const Xt=Object.keys(V.patternDependencies);function Qt(){if(tt)return v(tt);if(ot&&ct&&bt){const ge=new PA(ot),he=new Tc(ct,bt);for(const Xe in P){const Ze=P[Xe];Ze instanceof bh?(Ub(Ze.layers,this.zoom,h),mb(Ze,ot,ge.positions,ct,he.iconPositions,this.showCollisionBoxes,h,this.tileID.canonical,this.tileZoom,this.projection)):Ze.hasPattern&&(Ze instanceof bm||Ze instanceof dm||Ze instanceof $d)&&(Ub(Ze.layers,this.zoom,h),Ze.addFeatures(V,this.tileID.canonical,he.patternPositions,h,this.tileTransform))}this.status="done",v(null,{buckets:Me(P).filter(Xe=>!Xe.isEmpty()),featureIndex:T,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ge.image,lineAtlas:O,imageAtlas:he,glyphMap:this.returnDependencies?ot:null,iconMap:this.returnDependencies?ct:null,glyphPositions:this.returnDependencies?ge.positions:null})}}Xt.length?m.send("getImages",{icons:Xt,source:this.source,tileID:this.tileID,type:"patterns"},(ge,he)=>{tt||(tt=ge,bt=he,Qt.call(this))},void 0,!1,zt):bt={},Qt.call(this)}}function Ub(s,i,a){const h=new De(i);for(const m of s)m.recalculate(h,a)}class zA{constructor(i){this.entries={},this.scheduler=i}request(i,a,h,m){const v=this.entries[i]=this.entries[i]||{callbacks:[]};if(v.result){const[x,T]=v.result;return this.scheduler?this.scheduler.add(()=>{m(x,T)},a):m(x,T),()=>{}}return v.callbacks.push(m),v.cancel||(v.cancel=h((x,T)=>{v.result=[x,T];for(const P of v.callbacks)this.scheduler?this.scheduler.add(()=>{P(x,T)},a):P(x,T);setTimeout(()=>delete this.entries[i],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(x=>x!==m),v.callbacks.length||(v.cancel(),delete this.entries[i]))}}}function DA(s,i,a){const h=JSON.stringify(s.request);return s.data&&(this.deduped.entries[h]={result:[null,s.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},m=>{const v=uo(s.request,(x,T,P,O)=>{x?m(x):T&&m(null,{vectorTile:a?void 0:new __(new Kd(T)),rawData:T,cacheControl:P,expires:O})});return()=>{v.cancel(),m()}},i)}r.ARRAY_TYPE=Rl,r.AUTH_ERR_MSG=_s,r.Aabb=el,r.Actor=class{constructor(s,i,a){this.target=s,this.parent=i,this.mapId=a,this.callbacks={},this.cancelCallbacks={},fe(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=st()?s:w,this.scheduler=new I}send(s,i,a,h,m=!1,v){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(a.metadata=v,this.callbacks[x]=a);const T=wt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:s,hasCallback:!!a,targetMapId:h,mustQueue:m,sourceMapId:this.mapId,data:vc(i,T)},T),{cancel:()=>{a&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(s){const i=s.data,a=i.id;if(a&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const h=this.cancelCallbacks[a];delete this.cancelCallbacks[a],h&&h.cancel()}else if(i.mustQueue||st()){const h=this.callbacks[a];this.cancelCallbacks[a]=this.scheduler.add(()=>this.processTask(a,i),h&&h.metadata||{type:"message"})}else this.processTask(a,i)}processTask(s,i){if(i.type==="<response>"){const a=this.callbacks[s];delete this.callbacks[s],a&&(i.error?a(Gh(i.error)):a(null,Gh(i.data)))}else{const a=wt(this.globalScope)?void 0:[],h=i.hasCallback?(v,x)=>{delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:v?vc(v):null,data:vc(x,a)},a)}:v=>{},m=Gh(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,m,h);else if(this.parent.getWorkerSource){const v=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,v[0],m.source)[v[1]](m,h)}else h(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},r.CanonicalTileID=xm,r.Color=Zr,r.ColorMode=Ih,r.CullFaceMode=Kc,r.DEMData=cp,r.DataConstantProperty=Ne,r.DedupedRequest=zA,r.DepthMode=Um,r.EXTENT=xi,r.Elevation=class{isDataAvailableAtPoint(s){const i=this._source();if(this.isUsingMockSource()||!i||s.y<0||s.y>1)return!1;const a=i.getSource().maxzoom,h=1<<a,m=Math.floor(s.x),v=Math.floor((s.x-m)*h),x=Math.floor(s.y*h),T=this.findDEMTileFor(new la(a,m,a,v,x));return!(!T||!T.dem)}getAtPointOrZero(s,i=0){return this.getAtPoint(s,i)||0}getAtPoint(s,i,a=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const h=this._source();if(!h||s.y<0||s.y>1)return i;const m=h.getSource().maxzoom,v=1<<m,x=Math.floor(s.x),T=s.x-x,P=new la(m,x,m,Math.floor(T*v),Math.floor(s.y*v)),O=this.findDEMTileFor(P);if(!O||!O.dem)return i;const V=O.dem,$=1<<O.tileID.canonical.z,tt=(T*$-O.tileID.canonical.x)*V.dim,ot=(s.y*$-O.tileID.canonical.y)*V.dim,ct=Math.floor(tt),bt=Math.floor(ot);return(a?this.exaggeration():1)*Ri(Ri(V.get(ct,bt),V.get(ct,bt+1),ot-bt),Ri(V.get(ct+1,bt),V.get(ct+1,bt+1),ot-bt),tt-ct)}getAtTileOffset(s,i,a){const h=1<<s.canonical.z;return this.getAtPointOrZero(new Xh(s.wrap+(s.canonical.x+i/xi)/h,(s.canonical.y+a/xi)/h))}getAtTileOffsetFunc(s,i,a,h){return m=>{const v=this.getAtTileOffset(s,m.x,m.y),x=h.upVector(s.canonical,m.x,m.y);return uu(x,x,v*h.upVectorScale(s.canonical,i,a).metersToTile),x}}getForTilePoints(s,i,a,h){if(this.isUsingMockSource())return!1;const m=L0.create(this,s,h);return!!m&&(i.forEach(v=>{v[2]=this.exaggeration()*m.getElevationAt(v[0],v[1],a)}),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(s);if(!i||!i.dem)return null;const a=i.dem.tree,h=i.tileID,m=1<<s.canonical.z-h.canonical.z;let v=s.canonical.x/m-h.canonical.x,x=s.canonical.y/m-h.canonical.y,T=0;for(let P=0;P<s.canonical.z-h.canonical.z&&!a.leaves[T];P++){v*=2,x*=2;const O=2*Math.floor(x)+Math.floor(v);T=a.childOffsets[T]+O,v%=1,x%=1}return{min:this.exaggeration()*a.minimums[T],max:this.exaggeration()*a.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,i,a){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},r.ErrorEvent=Ss,r.EvaluationParameters=De,r.Event=Js,r.Evented=vs,r.FillExtrusionBucket=$d,r.Frustum=a_,r.FrustumCorners=s_,r.GLOBE_METERS_TO_ECEF=B_,r.GLOBE_RADIUS=Jc,r.GLOBE_SCALE_MATCH_LATITUDE=45,r.GLOBE_ZOOM_THRESHOLD_MAX=6,r.GLOBE_ZOOM_THRESHOLD_MIN=5,r.GlobeSharedBuffers=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const s of this._wireframeSegments)s.destroy()}}_createGrid(s){const i=new Dr,a=new aa,h=65;for(let m=0;m<h;m++)for(let v=0;v<h;v++)i.emplaceBack(v,m);this._gridSegments=[];for(let m=0,v=0;m<Hf.length;m++){const x=Hf[m];for(let P=0;P<x;P++)for(let O=0;O<64;O++){const V=P*h+O;a.emplaceBack(V+1,V,V+h),a.emplaceBack(V+h,V+h+1,V+1)}const T=64*x*2;this._gridSegments.push(cs.simpleSegment(0,v,(x+1)*h,T)),v+=T}this._gridBuffer=s.createVertexBuffer(i,ep.members),this._gridIndexBuffer=s.createIndexBuffer(a,!0)}_createPoles(s){const i=new aa;for(let m=0;m<=Xf;m++)i.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=s.createIndexBuffer(i,!0);const a=new ar,h=new ar;this._poleSegments=[];for(let m=0,v=0;m<5;m++){const x=360/(1<<m);a.emplaceBack(0,-Jc,0,.5,0),h.emplaceBack(0,-Jc,0,.5,1);for(let T=0;T<=Xf;T++){const P=T/Xf,O=Ri(0,x,P),[V,$,tt]=$f(bb,V_,O,Jc);a.emplaceBack(V,$,tt,P,0),h.emplaceBack(V,$,tt,P,1)}this._poleSegments.push(cs.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(a,O_,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(h,O_,!1)}getGridBuffers(s){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[s]]}getPoleBuffers(s){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}getWirefameBuffers(s,i){if(!this._wireframeSegments){const a=new Tu,h=Xf,m=h+1;this._wireframeSegments=[];for(let v=0,x=0;v<Hf.length;v++){const T=Hf[v];for(let O=0;O<T;O++)for(let V=0;V<h;V++){const $=O*m+V;a.emplaceBack($,$+1),a.emplaceBack($,$+m),a.emplaceBack($,$+m+1)}const P=T*h*3;this._wireframeSegments.push(cs.simpleSegment(0,x,(T+1)*m,P)),x+=P}this._wireframeIndexBuffer=s.createIndexBuffer(a)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[i]]}},r.GlyphManager=ds,r.ImagePosition=Cm,r.LivePerformanceUtils=Zn,r.LngLat=br,r.LngLatBounds=Yc,r.LocalGlyphMode=k_,r.MAX_MERCATOR_LATITUDE=wa,r.MercatorCoordinate=Xh,r.ONE_EM=_o,r.OverscaledTileID=la,r.PerformanceMarkers=hn,r.Properties=fi,r.RGBAImage=Fl,r.Ray=um,r.RequestManager=class{constructor(s,i,a){this._transformRequestFn=s,this._customAccessToken=i,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){const s=function(){let i="";for(let a=0;a<10;a++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Q,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeStyleURL(s,i){if(!bo(s))return s;const a=ts(s);return a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||i)}normalizeGlyphsURL(s,i){if(!bo(s))return s;const a=ts(s);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||i)}normalizeSourceURL(s,i,a,h){if(!bo(s))return s;const m=ts(s);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),a&&m.params.push(`language=${a}`),h&&m.params.push(`worldview=${h}`),this._makeAPIURL(m,this._customAccessToken||i)}normalizeSpriteURL(s,i,a,h){const m=ts(s);return bo(s)?(m.path=`/styles/v1${m.path}/sprite${i}${a}`,this._makeAPIURL(m,this._customAccessToken||h)):(m.path+=`${i}${a}`,js(m))}normalizeTileURL(s,i,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!bo(s))return s;const h=ts(s);h.path=h.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||a&&h.authority!=="raster"&&a===512?"@2x":""}${Z.supported?".webp":"$1"}`),h.authority==="raster"?h.path=`/${E.RASTER_URL_PREFIX}${h.path}`:(h.path=h.path.replace(/^.+\/v4\//,"/"),h.path=`/${E.TILE_URL_VERSION}${h.path}`);const m=this._customAccessToken||function(v){for(const x of v){const T=x.match(/^access_token=(.*)$/);if(T)return T[1]}return null}(h.params)||E.ACCESS_TOKEN;return E.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&h.params.push(`sku=${this._skuToken}`),this._makeAPIURL(h,m)}canonicalizeTileURL(s,i){const a=ts(s);if(!a.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!a.path.match(/\.[\w]+$/))return s;let h="mapbox://";a.path.match(/^\/raster\/v1\//)?h+=`raster/${a.path.replace(`/${E.RASTER_URL_PREFIX}/`,"")}`:h+=`tiles/${a.path.replace(`/${E.TILE_URL_VERSION}/`,"")}`;let m=a.params;return i&&(m=m.filter(v=>!v.match(/^access_token=/))),m.length&&(h+=`?${m.join("&")}`),h}canonicalizeTileset(s,i){const a=!!i&&bo(i),h=[];for(const m of s.tiles||[])co(m)?h.push(this.canonicalizeTileURL(m,a)):h.push(m);return h}_makeAPIURL(s,i){const a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",h=ts(E.API_URL);if(s.protocol=h.protocol,s.authority=h.authority,s.protocol==="http"){const m=s.params.indexOf("secure");m>=0&&s.params.splice(m,1)}if(h.path!=="/"&&(s.path=`${h.path}${s.path}`),!E.REQUIRE_ACCESS_TOKEN)return js(s);if(i=i||E.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if(i[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return s.params=s.params.filter(m=>m.indexOf("access_token")===-1),s.params.push(`access_token=${i||""}`),js(s)}},r.ResourceType=Hi,r.SegmentVector=cs,r.SourceCache=hp,r.StencilMode=Bb,r.StructArrayLayout1ui2=Zc,r.StructArrayLayout2f1f2i16=ya,r.StructArrayLayout2i4=Dr,r.StructArrayLayout2ui4=Tu,r.StructArrayLayout3f12=ou,r.StructArrayLayout3ui6=aa,r.StructArrayLayout4i8=Wr,r.StructArrayLayout5f20=ar,r.Texture=up,r.Tile=Yi,r.Transitionable=fn,r.Uniform1f=Mf,r.Uniform1i=class extends xc{constructor(s){super(s),this.current=0}set(s,i,a){this.fetchUniformLocation(s,i)&&this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},r.Uniform2f=class extends xc{constructor(s){super(s),this.current=[0,0]}set(s,i,a){this.fetchUniformLocation(s,i)&&(a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1])))}},r.Uniform3f=class extends xc{constructor(s){super(s),this.current=[0,0,0]}set(s,i,a){this.fetchUniformLocation(s,i)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2])))}},r.Uniform4f=py,r.UniformColor=my,r.UniformMatrix2f=class extends xc{constructor(s){super(s),this.current=_y}set(s,i,a){if(this.fetchUniformLocation(s,i)){for(let h=0;h<4;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}}},r.UniformMatrix3f=class extends xc{constructor(s){super(s),this.current=gy}set(s,i,a){if(this.fetchUniformLocation(s,i)){for(let h=0;h<9;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},r.UniformMatrix4f=class extends xc{constructor(s){super(s),this.current=iw}set(s,i,a){if(this.fetchUniformLocation(s,i)){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let h=1;h<16;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}}},r.UnwrappedTileID=qy,r.ValidationError=$n,r.VectorTileFeature=gm,r.VectorTileWorkerSource=class extends vs{constructor(s,i,a,h,m){super(),this.actor=s,this.layerIndex=i,this.availableImages=a,this.loadVectorData=m||DA,this.loading={},this.loaded={},this.deduped=new zA(s.scheduler),this.isSpriteLoaded=h,this.scheduler=s.scheduler}loadTile(s,i){const a=s.uid,h=s&&s.request,m=h&&h.collectResourceTiming,v=this.loading[a]=new Hk(s);v.abort=this.loadVectorData(s,(x,T)=>{const P=!this.loading[a];if(delete this.loading[a],P||x||!T)return v.status="done",P||(this.loaded[a]=v),i(x);const O=T.rawData,V={};T.expires&&(V.expires=T.expires),T.cacheControl&&(V.cacheControl=T.cacheControl),v.vectorTile=T.vectorTile||new __(new Kd(O));const $=()=>{v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,(tt,ot)=>{if(tt||!ot)return i(tt);const ct={};if(m){const bt=hi(h);bt.length>0&&(ct.resourceTiming=JSON.parse(JSON.stringify(bt)))}i(null,be({rawTileData:O.slice(0)},ot,V,ct))})};this.isSpriteLoaded?$():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add($,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom}):$()}),this.loaded=this.loaded||{},this.loaded[a]=v})}reloadTile(s,i){const a=this.loaded,h=s.uid,m=this;if(a&&a[h]){const v=a[h];v.showCollisionBoxes=s.showCollisionBoxes,v.enableTerrain=!!s.enableTerrain,v.projection=s.projection,v.tileTransform=af(s.tileID.canonical,s.projection);const x=(T,P)=>{const O=v.reloadCallback;O&&(delete v.reloadCallback,v.parse(v.vectorTile,m.layerIndex,this.availableImages,m.actor,O)),i(T,P)};v.status==="parsing"?v.reloadCallback=x:v.status==="done"&&(v.vectorTile?v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(s,i){const a=s.uid,h=this.loading[a];h&&(h.abort&&h.abort(),delete this.loading[a]),i()}removeTile(s,i){const a=this.loaded,h=s.uid;a&&a[h]&&delete a[h],i()}},r.WritingMode=Vi,r.add=Cc,r.addDynamicAttributes=Fm,r.adjoint=function(s,i){var a=i[0],h=i[1],m=i[2],v=i[3],x=i[4],T=i[5],P=i[6],O=i[7],V=i[8];return s[0]=x*V-T*O,s[1]=m*O-h*V,s[2]=h*T-m*x,s[3]=T*P-v*V,s[4]=a*V-m*P,s[5]=m*v-a*T,s[6]=v*O-x*P,s[7]=h*P-a*O,s[8]=a*x-h*v,s},r.asyncAll=_e,r.bezier=te,r.bindAll=fe,r.boundsAttributes=si,r.bufferConvexPolygon=function(s,i){const a=[];for(let h=0;h<s.length;h++){const m=Le(h-1,-1,s.length-1),v=Le(h+1,-1,s.length-1),x=s[h],T=s[v],P=s[m].sub(x).unit(),O=T.sub(x).unit(),V=O.angleWithSep(P.x,P.y),$=P.add(O).unit().mult(-1*i/Math.sin(V/2));a.push(x.add($))}return a},r.cacheEntryPossiblyAdded=function(s){ji++,ji>Ge&&(s.getActor().send("enforceCacheSizeLimit",Ye),ji=0)},r.calculateGlobeLabelMatrix=function(s,i){const{x:a,y:h}=s.point,m=Dm(a,h,s.worldSize/s._pixelsPerMercatorPixel,0,0);return qh(m,m,U_(Sc(i)))},r.calculateGlobeMatrix=function(s){const{x:i,y:a}=s.point,{lng:h,lat:m}=s._center;return Dm(i,a,s.worldSize,h,m)},r.calculateGlobeMercatorMatrix=function(s){const i=s.pixelsPerMeter,a=i/lu(1,s.center.lat),h=Su(new Float64Array(16));return Fd(h,h,[s.point.x,s.point.y,0]),Jh(h,h,[a,a,i]),Float32Array.from(h)},r.circumferenceAtLatitude=Ug,r.clamp=ie,r.clearTileCache=function(s){if(!Gn())return;const i=w.caches.delete(We);s&&i.catch(s).then(()=>s())},r.clipLine=d0,r.clone=function(s){var i=new Rl(16);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i},r.clone$1=Bn,r.collisionCircleLayout=Jw,r.config=E,r.conjugate=function(s,i){return s[0]=-i[0],s[1]=-i[1],s[2]=-i[2],s[3]=i[3],s},r.create=function(){var s=new Rl(16);return Rl!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},r.create$1=Iy,r.createExpression=zs,r.createLayout=Kn,r.createStyleLayer=function(s){return s.type==="custom"?new Db(s):new Ob[s.type](s)},r.cross=i_,r.degToRad=xt,r.distance=function(s,i){return Math.hypot(i[0]-s[0],i[1]-s[1],i[2]-s[2])},r.div=function(s,i,a){return s[0]=i[0]/a[0],s[1]=i[1]/a[1],s[2]=i[2]/a[2],s},r.dot=Eu,r.earthRadius=Yh,r.ease=ht,r.easeCubicInOut=Et,r.ecefToLatLng=function([s,i,a]){const h=Math.hypot(s,i,a),m=Math.atan2(s,a),v=.5*Math.PI-Math.acos(-i/h);return new br(kt(m),kt(v))},r.emitValidationErrors=Gp,r.endsWith=mn,r.enforceCacheSizeLimit=function(s){_i(),pe&&pe.then(i=>{i.keys().then(a=>{for(let h=0;h<a.length-s;h++)i.delete(a[h])})})},r.evaluateSizeForFeature=ic,r.evaluateSizeForZoom=Zf,r.evaluateVariableOffset=z_,r.evented=re,r.exactEquals=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]&&s[3]===i[3]},r.exactEquals$1=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]},r.exported=ti,r.exported$1=Z,r.extend=be,r.extend$1=Po,r.fillExtrusionHeightLift=x_,r.filterObject=Cn,r.fromMat4=function(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[4],s[4]=i[5],s[5]=i[6],s[6]=i[8],s[7]=i[9],s[8]=i[10],s},r.fromQuat=function(s,i){var a=i[0],h=i[1],m=i[2],v=i[3],x=a+a,T=h+h,P=m+m,O=a*x,V=h*x,$=h*T,tt=m*x,ot=m*T,ct=m*P,bt=v*x,zt=v*T,Jt=v*P;return s[0]=1-$-ct,s[1]=V+Jt,s[2]=tt-zt,s[3]=0,s[4]=V-Jt,s[5]=1-O-ct,s[6]=ot+bt,s[7]=0,s[8]=tt+zt,s[9]=ot-bt,s[10]=1-O-$,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},r.fromRotation=function(s,i){var a=Math.sin(i),h=Math.cos(i);return s[0]=h,s[1]=a,s[2]=0,s[3]=-a,s[4]=h,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},r.fromScaling=t_,r.furthestTileCorner=function(s){const i=Math.round((s+45+360)%360/90)%4;return de[i]},r.getAABBPointSquareDist=function(s,i,a){let h=0;for(let m=0;m<2;++m){const v=a?a[m]:0;s[m]>v&&(h+=(s[m]-v)*(s[m]-v)),i[m]<v&&(h+=(v-i[m])*(v-i[m]))}return h},r.getAnchorAlignment=L_,r.getAnchorJustification=D_,r.getBounds=function(s){let i=1/0,a=1/0,h=-1/0,m=-1/0;for(const v of s)i=Math.min(i,v.x),a=Math.min(a,v.y),h=Math.max(h,v.x),m=Math.max(m,v.y);return{min:new j(i,a),max:new j(h,m)}},r.getColumn=we,r.getGridMatrix=function(s,i,a,h){const m=i.getNorth(),v=i.getSouth(),x=i.getWest(),T=i.getEast(),P=1<<s.z,O=T-x,V=m-v,$=O/Xf,tt=-V/Hf[a],ot=[0,$,0,tt,0,0,m,x,0];if(s.z>0){const ct=180/h;Nf(ot,ot,[ct/O+1,0,0,0,ct/V+1,0,-.5*ct/$,.5*ct/tt,1])}return ot[2]=P,ot[5]=s.x,ot[8]=s.y,ot},r.getImage=Qo,r.getJSON=function(s,i){return $i(be(s,{type:"json"}),i)},r.getLatitudinalLod=function(s){const i=80.051129;s=ie(s,-80.051129,i)/i*90;const a=Math.pow(Math.abs(Math.sin(xt(s))),3);return Math.round(a*(Hf.length-1))},r.getMapSessionAPI=xe,r.getPerformanceMeasurement=hi,r.getProjection=E0,r.getRTLTextPluginStatus=Ae,r.getReferrer=Jr,r.getTilePoint=function(s,{x:i,y:a},h=0){return new j(((i-h)*s.scale-s.x)*xi,(a*s.scale-s.y)*xi)},r.getTileVec3=function(s,i,a=0){return Qh(((i.x-a)*s.scale-s.x)*xi,(i.y*s.scale-s.y)*xi,Gg(i.z,i.y))},r.getVideo=function(s,i){const a=w.document.createElement("video");a.muted=!0,a.onloadstart=function(){i(null,a)};for(let h=0;h<s.length;h++){const m=w.document.createElement("source");Go(s[h])||(a.crossOrigin="Anonymous"),m.src=s[h],a.appendChild(m)}return{cancel:()=>{}}},r.globeCenterToScreenPoint=function(s){const i=[0,0,0],a=Su(new Float64Array(16));return qh(a,s.pixelMatrix,s.globeMatrix),os(i,i,a),new j(i[0],i[1])},r.globeDenormalizeECEF=U_,r.globeECEFOrigin=function(s,i){const a=[0,0,0];return os(a,a,rp(Sc(i.canonical))),os(a,a,s),a},r.globeNormalizeECEF=rp,r.globePixelsToTileUnits=function(s,i){return xi/(512*Math.pow(2,s))*zm(Sc(i))},r.globePoleMatrixForTile=function(s,i,a){const h=Su(new Float64Array(16)),m=(i/(1<<s)-.5)*Math.PI*2;return jd(h,a.globeMatrix,m),Float32Array.from(h)},r.globeTileBounds=Sc,r.globeTiltAtLngLat=G_,r.globeToMercatorTransition=sf,r.globeUseCustomAntiAliasing=function(s,i,a){const h=sf(a.zoom),m=s.style.map._antialias,v=!!i.extStandardDerivatives,x=i.extStandardDerivativesForceOff||s.terrain&&s.terrain.exaggeration()>0;return h===0&&!m&&!x&&v},r.identity=Su,r.identity$1=o_,r.invert=am,r.isFullscreen=function(){return!!w.document.fullscreenElement||!!w.document.webkitFullscreenElement},r.isLngLatBehindGlobe=Z_,r.isMapAuthenticated=function(s){return Re.has(s)},r.isMapboxURL=bo,r.isSafariWithAntialiasingBug=function(s){const i=s.navigator?s.navigator.userAgent:null;return!!wt(s)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.latFromMercatorY=xa,r.latLngToECEF=np,r.len=cw,r.length=Kh,r.length$1=function(s){return Math.hypot(s[0],s[1],s[2],s[3])},r.lngFromMercatorX=xl,r.loadVectorTile=DA,r.makeRequest=$i,r.mapValue=function(s,i,a,h,m){return ie((s-i)/(a-i)*(m-h)+h,h,m)},r.mercatorScale=Zg,r.mercatorXfromLng=Ju,r.mercatorYfromLat=au,r.mercatorZfromAltitude=lu,r.mul=e_,r.mul$1=uw,r.multiply=qh,r.multiply$1=Nf,r.multiply$2=n_,r.nextPowerOfTwo=ve,r.normalize=tl,r.normalize$1=hw,r.normalize$2=Sy,r.number=Ri,r.ortho=function(s,i,a,h,m,v,x){var T=1/(i-a),P=1/(h-m),O=1/(v-x);return s[0]=-2*T,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*P,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*O,s[11]=0,s[12]=(i+a)*T,s[13]=(m+h)*P,s[14]=(x+v)*O,s[15]=1,s},r.pbf=Kd,r.perspective=function(s,i,a,h,m){var v,x=1/Math.tan(i/2);return s[0]=x/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,m!=null&&m!==1/0?(s[10]=(m+h)*(v=1/(h-m)),s[14]=2*m*h*v):(s[10]=-1,s[14]=-2*h),s},r.pick=function(s,i){const a={};for(let h=0;h<i.length;h++){const m=i[h];m in s&&(a[m]=s[m])}return a},r.plugin=je,r.pointGeometry=j,r.polesInViewport=function(s){const i=Su(new Float64Array(16));qh(i,s.pixelMatrix,s.globeMatrix);const a=[0,Lu,0],h=[0,ku,0];return os(a,a,i),os(h,h,i),[a[0]>0&&a[0]<=s.width&&a[1]>0&&a[1]<=s.height&&!Z_(s,new br(s.center.lat,90)),h[0]>0&&h[0]<=s.width&&h[1]>0&&h[1]<=s.height&&!Z_(s,new br(s.center.lat,-90))]},r.polygonContainsPoint=$h,r.polygonIntersectsBox=Jg,r.polygonIntersectsPolygon=rm,r.polygonizeBounds=function(s,i,a=0,h=!0){const m=new j(a,a),v=s.sub(m),x=i.add(m),T=[v,new j(x.x,v.y),x,new j(v.x,x.y)];return h&&T.push(v.clone()),T},r.posAttributes=ep,r.postMapLoadEvent=qt,r.postPerformanceEvent=Pe,r.postTurnstileEvent=It,r.potpack=E_,r.prevPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log(s)/Math.LN2))},r.radToDeg=kt,r.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.registerForPluginStateChange=function(s){return s({pluginStatus:Wt,pluginURL:jt}),re.on("pluginStateChange",s),s},r.removeAuthState=function(s){Re.delete(s)},r.renderColorRamp=Gd,r.resample=Wg,r.rotateX=Qg,r.rotateX$1=Ey,r.rotateY=jd,r.rotateY$1=My,r.rotateZ=function(s,i,a){var h=Math.sin(a),m=Math.cos(a),v=i[0],x=i[1],T=i[2],P=i[3],O=i[4],V=i[5],$=i[6],tt=i[7];return i!==s&&(s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=v*m+O*h,s[1]=x*m+V*h,s[2]=T*m+$*h,s[3]=P*m+tt*h,s[4]=O*m-v*h,s[5]=V*m-x*h,s[6]=$*m-T*h,s[7]=tt*m-P*h,s},r.rotateZ$1=function(s,i,a){a*=.5;var h=i[0],m=i[1],v=i[2],x=i[3],T=Math.sin(a),P=Math.cos(a);return s[0]=h*P+m*T,s[1]=m*P-h*T,s[2]=v*P+x*T,s[3]=x*P-v*T,s},r.scale=Jh,r.scale$1=Ty,r.scale$2=uu,r.scaleAndAdd=Bf,r.set=function(s,i,a,h){return s[0]=i,s[1]=a,s[2]=h,s},r.setCacheLimits=function(s,i){Ye=s,Ge=i},r.setColumn=function(s,i,a){s[4*i+0]=a[0],s[4*i+1]=a[1],s[4*i+2]=a[2],s[4*i+3]=a[3]},r.setRTLTextPlugin=function(s,i,a=!1){if(Wt===Ft||Wt===Gt||Wt===Pt)throw new Error("setRTLTextPlugin cannot be called multiple times.");jt=ti.resolveURL(s),Wt=Ft,Ot=i,me(),a||He()},r.smoothstep=ln,r.spec=Ke,r.squaredLength=function(s){var i=s[0],a=s[1],h=s[2];return i*i+a*a+h*h},r.storeAuthState=function(s,i){i?Re.add(s):Re.delete(s)},r.sub=ec,r.subtract=Rf,r.symbolSize=Kw,r.tileAABB=function(s,i,a,h,m,v,x,T,P){if(P.name==="globe")return wb(s,i,new xm(a,h,m));const O=af({z:a,x:h,y:m},P);return new el([(v+O.x/O.scale)*i,i*(O.y/O.scale),x],[(v+O.x2/O.scale)*i,i*(O.y2/O.scale),T])},r.tileCornersToBounds=Pm,r.tileTransform=af,r.transformMat3=function(s,i,a){var h=i[0],m=i[1],v=i[2];return s[0]=h*a[0]+m*a[3]+v*a[6],s[1]=h*a[1]+m*a[4]+v*a[7],s[2]=h*a[2]+m*a[5]+v*a[8],s},r.transformMat4=os,r.transformMat4$1=vh,r.transformQuat=Ay,r.transitionTileAABBinECEF=w0,r.translate=Fd,r.transpose=function(s,i){if(s===i){var a=i[1],h=i[2],m=i[5];s[1]=i[3],s[2]=i[6],s[3]=a,s[5]=i[7],s[6]=h,s[7]=m}else s[0]=i[0],s[1]=i[3],s[2]=i[6],s[3]=i[1],s[4]=i[4],s[5]=i[7],s[6]=i[2],s[7]=i[5],s[8]=i[8];return s},r.triggerPluginCompletionEvent=Kt,r.uniqueId=Yt,r.updateGlobeVertexNormal=function(s,i,a,h,m){const v=5*i+2;s.float32[v+0]=a,s.float32[v+1]=h,s.float32[v+2]=m},r.validateCustomStyleLayer=function(s){const i=[],a=s.id;return a===void 0&&i.push({message:`layers.${a}: missing required property "id"`}),s.render===void 0&&i.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&i.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),i},r.validateFilter=s=>$u(zl(s)),r.validateFog=s=>$u(Hu(s)),r.validateLayer=s=>$u(fh(s)),r.validateLight=s=>$u(Dt(s)),r.validateSource=s=>$u(eu(s)),r.validateStyle=Sd,r.validateTerrain=s=>$u(nu(s)),r.values=Me,r.vectorTile=pm,r.version=M,r.warnOnce=cn,r.window=w,r.wrap=Le}),c(["./shared"],function(r){function w(Vt){if(typeof Vt=="number"||typeof Vt=="boolean"||typeof Vt=="string"||Vt==null)return JSON.stringify(Vt);if(Array.isArray(Vt)){let It="[";for(const Ut of Vt)It+=`${w(Ut)},`;return`${It}]`}let pt="{";for(const It of Object.keys(Vt).sort())pt+=`${It}:${w(Vt[It])},`;return`${pt}}`}function M(Vt){let pt="";for(const It of r.refProperties)pt+=`/${w(Vt[It])}`;return pt}class N{constructor(pt){this.keyCache={},pt&&this.replace(pt)}replace(pt){this._layerConfigs={},this._layers={},this.update(pt,[])}update(pt,It){for(const qt of pt)this._layerConfigs[qt.id]=qt,(this._layers[qt.id]=r.createStyleLayer(qt)).compileFilter(),this.keyCache[qt.id]&&delete this.keyCache[qt.id];for(const qt of It)delete this.keyCache[qt],delete this._layerConfigs[qt],delete this._layers[qt];this.familiesBySource={};const Ut=function(qt,Ht){const Pe={};for(let xe=0;xe<qt.length;xe++){const Re=Ht&&Ht[qt[xe].id]||M(qt[xe]);Ht&&(Ht[qt[xe].id]=Re);let hn=Pe[Re];hn||(hn=Pe[Re]=[]),hn.push(qt[xe])}const Se=[];for(const xe in Pe)Se.push(Pe[xe]);return Se}(r.values(this._layerConfigs),this.keyCache);for(const qt of Ut){const Ht=qt.map(Zn=>this._layers[Zn.id]),Pe=Ht[0];if(Pe.visibility==="none")continue;const Se=Pe.source||"";let xe=this.familiesBySource[Se];xe||(xe=this.familiesBySource[Se]={});const Re=Pe.sourceLayer||"_geojsonTileLayer";let hn=xe[Re];hn||(hn=xe[Re]=[]),hn.push(Ht)}}}class E{loadTile(pt,It){const{uid:Ut,encoding:qt,rawImageData:Ht,padding:Pe,buildQuadTree:Se}=pt,xe=r.window.ImageBitmap&&Ht instanceof r.window.ImageBitmap?this.getImageData(Ht,Pe):Ht;It(null,new r.DEMData(Ut,xe,qt,Pe<1,Se))}getImageData(pt,It){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(pt.width,pt.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=pt.width,this.offscreenCanvas.height=pt.height,this.offscreenCanvasContext.drawImage(pt,0,0,pt.width,pt.height);const Ut=this.offscreenCanvasContext.getImageData(-It,-It,pt.width+2*It,pt.height+2*It);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ut}}var Z=function Vt(pt,It){var Ut,qt=pt&&pt.type;if(qt==="FeatureCollection")for(Ut=0;Ut<pt.features.length;Ut++)Vt(pt.features[Ut],It);else if(qt==="GeometryCollection")for(Ut=0;Ut<pt.geometries.length;Ut++)Vt(pt.geometries[Ut],It);else if(qt==="Feature")Vt(pt.geometry,It);else if(qt==="Polygon")Y(pt.coordinates,It);else if(qt==="MultiPolygon")for(Ut=0;Ut<pt.coordinates.length;Ut++)Y(pt.coordinates[Ut],It);return pt};function Y(Vt,pt){if(Vt.length!==0){K(Vt[0],pt);for(var It=1;It<Vt.length;It++)K(Vt[It],!pt)}}function K(Vt,pt){for(var It=0,Ut=0,qt=0,Ht=Vt.length,Pe=Ht-1;qt<Ht;Pe=qt++){var Se=(Vt[qt][0]-Vt[Pe][0])*(Vt[Pe][1]+Vt[qt][1]),xe=It+Se;Ut+=Math.abs(It)>=Math.abs(Se)?It-xe+Se:Se-xe+It,It=xe}It+Ut>=0!=!!pt&&Vt.reverse()}const q=r.VectorTileFeature.prototype.toGeoJSON;class at{constructor(pt){this._feature=pt,this.extent=r.EXTENT,this.type=pt.type,this.properties=pt.tags,"id"in pt&&!isNaN(pt.id)&&(this.id=parseInt(pt.id,10))}loadGeometry(){if(this._feature.type===1){const pt=[];for(const It of this._feature.geometry)pt.push([new r.pointGeometry(It[0],It[1])]);return pt}{const pt=[];for(const It of this._feature.geometry){const Ut=[];for(const qt of It)Ut.push(new r.pointGeometry(qt[0],qt[1]));pt.push(Ut)}return pt}}toGeoJSON(pt,It,Ut){return q.call(this,pt,It,Ut)}}class J{constructor(pt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.EXTENT,this.length=pt.length,this._features=pt}feature(pt){return new at(this._features[pt])}}var Q={exports:{}},lt=r.pointGeometry,Ct=r.vectorTile.VectorTileFeature,j=k;function k(Vt,pt){this.options=pt||{},this.features=Vt,this.length=Vt.length}function rt(Vt,pt){this.id=typeof Vt.id=="number"?Vt.id:void 0,this.type=Vt.type,this.rawGeometry=Vt.type===1?[Vt.geometry]:Vt.geometry,this.properties=Vt.tags,this.extent=pt||4096}k.prototype.feature=function(Vt){return new rt(this.features[Vt],this.options.extent)},rt.prototype.loadGeometry=function(){var Vt=this.rawGeometry;this.geometry=[];for(var pt=0;pt<Vt.length;pt++){for(var It=Vt[pt],Ut=[],qt=0;qt<It.length;qt++)Ut.push(new lt(It[qt][0],It[qt][1]));this.geometry.push(Ut)}return this.geometry},rt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Vt=this.geometry,pt=1/0,It=-1/0,Ut=1/0,qt=-1/0,Ht=0;Ht<Vt.length;Ht++)for(var Pe=Vt[Ht],Se=0;Se<Pe.length;Se++){var xe=Pe[Se];pt=Math.min(pt,xe.x),It=Math.max(It,xe.x),Ut=Math.min(Ut,xe.y),qt=Math.max(qt,xe.y)}return[pt,Ut,It,qt]},rt.prototype.toGeoJSON=Ct.prototype.toGeoJSON;var yt=r.pbf,xt=j;function kt(Vt){var pt=new yt;return function(It,Ut){for(var qt in It.layers)Ut.writeMessage(3,de,It.layers[qt])}(Vt,pt),pt.finish()}function de(Vt,pt){var It;pt.writeVarintField(15,Vt.version||1),pt.writeStringField(1,Vt.name||""),pt.writeVarintField(5,Vt.extent||4096);var Ut={keys:[],values:[],keycache:{},valuecache:{}};for(It=0;It<Vt.length;It++)Ut.feature=Vt.feature(It),pt.writeMessage(2,Et,Ut);var qt=Ut.keys;for(It=0;It<qt.length;It++)pt.writeStringField(3,qt[It]);var Ht=Ut.values;for(It=0;It<Ht.length;It++)pt.writeMessage(4,Le,Ht[It])}function Et(Vt,pt){var It=Vt.feature;It.id!==void 0&&pt.writeVarintField(1,It.id),pt.writeMessage(2,te,Vt),pt.writeVarintField(3,It.type),pt.writeMessage(4,ln,It)}function te(Vt,pt){var It=Vt.feature,Ut=Vt.keys,qt=Vt.values,Ht=Vt.keycache,Pe=Vt.valuecache;for(var Se in It.properties){var xe=It.properties[Se],Re=Ht[Se];if(xe!==null){Re===void 0&&(Ut.push(Se),Ht[Se]=Re=Ut.length-1),pt.writeVarint(Re);var hn=typeof xe;hn!=="string"&&hn!=="boolean"&&hn!=="number"&&(xe=JSON.stringify(xe));var Zn=hn+":"+xe,bn=Pe[Zn];bn===void 0&&(qt.push(xe),Pe[Zn]=bn=qt.length-1),pt.writeVarint(bn)}}}function ht(Vt,pt){return(pt<<3)+(7&Vt)}function ie(Vt){return Vt<<1^Vt>>31}function ln(Vt,pt){for(var It=Vt.loadGeometry(),Ut=Vt.type,qt=0,Ht=0,Pe=It.length,Se=0;Se<Pe;Se++){var xe=It[Se],Re=1;Ut===1&&(Re=xe.length),pt.writeVarint(ht(1,Re));for(var hn=Ut===3?xe.length-1:xe.length,Zn=0;Zn<hn;Zn++){Zn===1&&Ut!==1&&pt.writeVarint(ht(2,hn-1));var bn=xe[Zn].x-qt,ci=xe[Zn].y-Ht;pt.writeVarint(ie(bn)),pt.writeVarint(ie(ci)),qt+=bn,Ht+=ci}Ut===3&&pt.writeVarint(ht(7,1))}}function Le(Vt,pt){var It=typeof Vt;It==="string"?pt.writeStringField(1,Vt):It==="boolean"?pt.writeBooleanField(7,Vt):It==="number"&&(Vt%1!=0?pt.writeDoubleField(3,Vt):Vt<0?pt.writeSVarintField(6,Vt):pt.writeVarintField(5,Vt))}function _e(Vt,pt,It,Ut,qt,Ht){if(qt-Ut<=It)return;const Pe=Ut+qt>>1;Me(Vt,pt,Pe,Ut,qt,Ht%2),_e(Vt,pt,It,Ut,Pe-1,Ht+1),_e(Vt,pt,It,Pe+1,qt,Ht+1)}function Me(Vt,pt,It,Ut,qt,Ht){for(;qt>Ut;){if(qt-Ut>600){const Re=qt-Ut+1,hn=It-Ut+1,Zn=Math.log(Re),bn=.5*Math.exp(2*Zn/3),ci=.5*Math.sqrt(Zn*bn*(Re-bn)/Re)*(hn-Re/2<0?-1:1);Me(Vt,pt,It,Math.max(Ut,Math.floor(It-hn*bn/Re+ci)),Math.min(qt,Math.floor(It+(Re-hn)*bn/Re+ci)),Ht)}const Pe=pt[2*It+Ht];let Se=Ut,xe=qt;for(be(Vt,pt,Ut,It),pt[2*qt+Ht]>Pe&&be(Vt,pt,Ut,qt);Se<xe;){for(be(Vt,pt,Se,xe),Se++,xe--;pt[2*Se+Ht]<Pe;)Se++;for(;pt[2*xe+Ht]>Pe;)xe--}pt[2*Ut+Ht]===Pe?be(Vt,pt,Ut,xe):(xe++,be(Vt,pt,xe,qt)),xe<=It&&(Ut=xe+1),It<=xe&&(qt=xe-1)}}function be(Vt,pt,It,Ut){ue(Vt,It,Ut),ue(pt,2*It,2*Ut),ue(pt,2*It+1,2*Ut+1)}function ue(Vt,pt,It){const Ut=Vt[pt];Vt[pt]=Vt[It],Vt[It]=Ut}function Yt(Vt,pt,It,Ut){const qt=Vt-It,Ht=pt-Ut;return qt*qt+Ht*Ht}Q.exports=kt,Q.exports.fromVectorTileJs=kt,Q.exports.fromGeojsonVt=function(Vt,pt){pt=pt||{};var It={};for(var Ut in Vt)It[Ut]=new xt(Vt[Ut].features,pt),It[Ut].name=Ut,It[Ut].version=pt.version,It[Ut].extent=pt.extent;return kt({layers:It})},Q.exports.GeoJSONWrapper=xt;const Ee=Vt=>Vt[0],ve=Vt=>Vt[1];class ye{constructor(pt,It=Ee,Ut=ve,qt=64,Ht=Float64Array){this.nodeSize=qt,this.points=pt;const Pe=pt.length<65536?Uint16Array:Uint32Array,Se=this.ids=new Pe(pt.length),xe=this.coords=new Ht(2*pt.length);for(let Re=0;Re<pt.length;Re++)Se[Re]=Re,xe[2*Re]=It(pt[Re]),xe[2*Re+1]=Ut(pt[Re]);_e(Se,xe,qt,0,Se.length-1,0)}range(pt,It,Ut,qt){return function(Ht,Pe,Se,xe,Re,hn,Zn){const bn=[0,Ht.length-1,0],ci=[];let hi,Qn;for(;bn.length;){const pi=bn.pop(),qi=bn.pop(),ur=bn.pop();if(qi-ur<=Zn){for(let xr=ur;xr<=qi;xr++)hi=Pe[2*xr],Qn=Pe[2*xr+1],hi>=Se&&hi<=Re&&Qn>=xe&&Qn<=hn&&ci.push(Ht[xr]);continue}const ti=Math.floor((ur+qi)/2);hi=Pe[2*ti],Qn=Pe[2*ti+1],hi>=Se&&hi<=Re&&Qn>=xe&&Qn<=hn&&ci.push(Ht[ti]);const yr=(pi+1)%2;(pi===0?Se<=hi:xe<=Qn)&&(bn.push(ur),bn.push(ti-1),bn.push(yr)),(pi===0?Re>=hi:hn>=Qn)&&(bn.push(ti+1),bn.push(qi),bn.push(yr))}return ci}(this.ids,this.coords,pt,It,Ut,qt,this.nodeSize)}within(pt,It,Ut){return function(qt,Ht,Pe,Se,xe,Re){const hn=[0,qt.length-1,0],Zn=[],bn=xe*xe;for(;hn.length;){const ci=hn.pop(),hi=hn.pop(),Qn=hn.pop();if(hi-Qn<=Re){for(let yr=Qn;yr<=hi;yr++)Yt(Ht[2*yr],Ht[2*yr+1],Pe,Se)<=bn&&Zn.push(qt[yr]);continue}const pi=Math.floor((Qn+hi)/2),qi=Ht[2*pi],ur=Ht[2*pi+1];Yt(qi,ur,Pe,Se)<=bn&&Zn.push(qt[pi]);const ti=(ci+1)%2;(ci===0?Pe-xe<=qi:Se-xe<=ur)&&(hn.push(Qn),hn.push(pi-1),hn.push(ti)),(ci===0?Pe+xe>=qi:Se+xe>=ur)&&(hn.push(pi+1),hn.push(hi),hn.push(ti))}return Zn}(this.ids,this.coords,pt,It,Ut,this.nodeSize)}}const fe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Vt=>Vt},mn=Math.fround||(Ue=new Float32Array(1),Vt=>(Ue[0]=+Vt,Ue[0]));var Ue;class Cn{constructor(pt){this.options=dt(Object.create(fe),pt),this.trees=new Array(this.options.maxZoom+1)}load(pt){const{log:It,minZoom:Ut,maxZoom:qt,nodeSize:Ht}=this.options;It&&console.time("total time");const Pe=`prepare ${pt.length} points`;It&&console.time(Pe),this.points=pt;let Se=[];for(let xe=0;xe<pt.length;xe++)pt[xe].geometry&&Se.push(Pn(pt[xe],xe));this.trees[qt+1]=new ye(Se,wt,Zt,Ht,Float32Array),It&&console.timeEnd(Pe);for(let xe=qt;xe>=Ut;xe--){const Re=+Date.now();Se=this._cluster(Se,xe),this.trees[xe]=new ye(Se,wt,Zt,Ht,Float32Array),It&&console.log("z%d: %d clusters in %dms",xe,Se.length,+Date.now()-Re)}return It&&console.timeEnd("total time"),this}getClusters(pt,It){let Ut=((pt[0]+180)%360+360)%360-180;const qt=Math.max(-90,Math.min(90,pt[1]));let Ht=pt[2]===180?180:((pt[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,pt[3]));if(pt[2]-pt[0]>=360)Ut=-180,Ht=180;else if(Ut>Ht){const hn=this.getClusters([Ut,qt,180,Pe],It),Zn=this.getClusters([-180,qt,Ht,Pe],It);return hn.concat(Zn)}const Se=this.trees[this._limitZoom(It)],xe=Se.range(R(Ut),st(Pe),R(Ht),st(qt)),Re=[];for(const hn of xe){const Zn=Se.points[hn];Re.push(Zn.numPoints?cn(Zn):this.points[Zn.index])}return Re}getChildren(pt){const It=this._getOriginId(pt),Ut=this._getOriginZoom(pt),qt="No cluster with the specified id.",Ht=this.trees[Ut];if(!Ht)throw new Error(qt);const Pe=Ht.points[It];if(!Pe)throw new Error(qt);const Se=this.options.radius/(this.options.extent*Math.pow(2,Ut-1)),xe=Ht.within(Pe.x,Pe.y,Se),Re=[];for(const hn of xe){const Zn=Ht.points[hn];Zn.parentId===pt&&Re.push(Zn.numPoints?cn(Zn):this.points[Zn.index])}if(Re.length===0)throw new Error(qt);return Re}getLeaves(pt,It,Ut){const qt=[];return this._appendLeaves(qt,pt,It=It||10,Ut=Ut||0,0),qt}getTile(pt,It,Ut){const qt=this.trees[this._limitZoom(pt)],Ht=Math.pow(2,pt),{extent:Pe,radius:Se}=this.options,xe=Se/Pe,Re=(Ut-xe)/Ht,hn=(Ut+1+xe)/Ht,Zn={features:[]};return this._addTileFeatures(qt.range((It-xe)/Ht,Re,(It+1+xe)/Ht,hn),qt.points,It,Ut,Ht,Zn),It===0&&this._addTileFeatures(qt.range(1-xe/Ht,Re,1,hn),qt.points,Ht,Ut,Ht,Zn),It===Ht-1&&this._addTileFeatures(qt.range(0,Re,xe/Ht,hn),qt.points,-1,Ut,Ht,Zn),Zn.features.length?Zn:null}getClusterExpansionZoom(pt){let It=this._getOriginZoom(pt)-1;for(;It<=this.options.maxZoom;){const Ut=this.getChildren(pt);if(It++,Ut.length!==1)break;pt=Ut[0].properties.cluster_id}return It}_appendLeaves(pt,It,Ut,qt,Ht){const Pe=this.getChildren(It);for(const Se of Pe){const xe=Se.properties;if(xe&&xe.cluster?Ht+xe.point_count<=qt?Ht+=xe.point_count:Ht=this._appendLeaves(pt,xe.cluster_id,Ut,qt,Ht):Ht<qt?Ht++:pt.push(Se),pt.length===Ut)break}return Ht}_addTileFeatures(pt,It,Ut,qt,Ht,Pe){for(const Se of pt){const xe=It[Se],Re=xe.numPoints;let hn,Zn,bn;if(Re)hn=Un(xe),Zn=xe.x,bn=xe.y;else{const Qn=this.points[xe.index];hn=Qn.properties,Zn=R(Qn.geometry.coordinates[0]),bn=st(Qn.geometry.coordinates[1])}const ci={type:1,geometry:[[Math.round(this.options.extent*(Zn*Ht-Ut)),Math.round(this.options.extent*(bn*Ht-qt))]],tags:hn};let hi;Re?hi=xe.id:this.options.generateId?hi=xe.index:this.points[xe.index].id&&(hi=this.points[xe.index].id),hi!==void 0&&(ci.id=hi),Pe.features.push(ci)}}_limitZoom(pt){return Math.max(this.options.minZoom,Math.min(Math.floor(+pt),this.options.maxZoom+1))}_cluster(pt,It){const Ut=[],{radius:qt,extent:Ht,reduce:Pe,minPoints:Se}=this.options,xe=qt/(Ht*Math.pow(2,It));for(let Re=0;Re<pt.length;Re++){const hn=pt[Re];if(hn.zoom<=It)continue;hn.zoom=It;const Zn=this.trees[It+1],bn=Zn.within(hn.x,hn.y,xe),ci=hn.numPoints||1;let hi=ci;for(const Qn of bn){const pi=Zn.points[Qn];pi.zoom>It&&(hi+=pi.numPoints||1)}if(hi>ci&&hi>=Se){let Qn=hn.x*ci,pi=hn.y*ci,qi=Pe&&ci>1?this._map(hn,!0):null;const ur=(Re<<5)+(It+1)+this.points.length;for(const ti of bn){const yr=Zn.points[ti];if(yr.zoom<=It)continue;yr.zoom=It;const xr=yr.numPoints||1;Qn+=yr.x*xr,pi+=yr.y*xr,yr.parentId=ur,Pe&&(qi||(qi=this._map(hn,!0)),Pe(qi,this._map(yr)))}hn.parentId=ur,Ut.push(Bn(Qn/hi,pi/hi,ur,hi,qi))}else if(Ut.push(hn),hi>1)for(const Qn of bn){const pi=Zn.points[Qn];pi.zoom<=It||(pi.zoom=It,Ut.push(pi))}}return Ut}_getOriginId(pt){return pt-this.points.length>>5}_getOriginZoom(pt){return(pt-this.points.length)%32}_map(pt,It){if(pt.numPoints)return It?dt({},pt.properties):pt.properties;const Ut=this.points[pt.index].properties,qt=this.options.map(Ut);return It&&qt===Ut?dt({},qt):qt}}function Bn(Vt,pt,It,Ut,qt){return{x:mn(Vt),y:mn(pt),zoom:1/0,id:It,parentId:-1,numPoints:Ut,properties:qt}}function Pn(Vt,pt){const[It,Ut]=Vt.geometry.coordinates;return{x:mn(R(It)),y:mn(st(Ut)),zoom:1/0,index:pt,parentId:-1}}function cn(Vt){return{type:"Feature",id:Vt.id,properties:Un(Vt),geometry:{type:"Point",coordinates:[(pt=Vt.x,360*(pt-.5)),gt(Vt.y)]}};var pt}function Un(Vt){const pt=Vt.numPoints,It=pt>=1e4?`${Math.round(pt/1e3)}k`:pt>=1e3?Math.round(pt/100)/10+"k":pt;return dt(dt({},Vt.properties),{cluster:!0,cluster_id:Vt.id,point_count:pt,point_count_abbreviated:It})}function R(Vt){return Vt/360+.5}function st(Vt){const pt=Math.sin(Vt*Math.PI/180),It=.5-.25*Math.log((1+pt)/(1-pt))/Math.PI;return It<0?0:It>1?1:It}function gt(Vt){const pt=(180-360*Vt)*Math.PI/180;return 360*Math.atan(Math.exp(pt))/Math.PI-90}function dt(Vt,pt){for(const It in pt)Vt[It]=pt[It];return Vt}function wt(Vt){return Vt.x}function Zt(Vt){return Vt.y}function we(Vt,pt,It,Ut){for(var qt,Ht=Ut,Pe=It-pt>>1,Se=It-pt,xe=Vt[pt],Re=Vt[pt+1],hn=Vt[It],Zn=Vt[It+1],bn=pt+3;bn<It;bn+=3){var ci=We(Vt[bn],Vt[bn+1],xe,Re,hn,Zn);if(ci>Ht)qt=bn,Ht=ci;else if(ci===Ht){var hi=Math.abs(bn-Pe);hi<Se&&(qt=bn,Se=hi)}}Ht>Ut&&(qt-pt>3&&we(Vt,pt,qt,Ut),Vt[qt+2]=Ht,It-qt>3&&we(Vt,qt,It,Ut))}function We(Vt,pt,It,Ut,qt,Ht){var Pe=qt-It,Se=Ht-Ut;if(Pe!==0||Se!==0){var xe=((Vt-It)*Pe+(pt-Ut)*Se)/(Pe*Pe+Se*Se);xe>1?(It=qt,Ut=Ht):xe>0&&(It+=Pe*xe,Ut+=Se*xe)}return(Pe=Vt-It)*Pe+(Se=pt-Ut)*Se}function pe(Vt,pt,It,Ut){var qt={id:Vt===void 0?null:Vt,type:pt,geometry:It,tags:Ut,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ht){var Pe=Ht.geometry,Se=Ht.type;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")un(Ht,Pe);else if(Se==="Polygon"||Se==="MultiLineString")for(var xe=0;xe<Pe.length;xe++)un(Ht,Pe[xe]);else if(Se==="MultiPolygon")for(xe=0;xe<Pe.length;xe++)for(var Re=0;Re<Pe[xe].length;Re++)un(Ht,Pe[xe][Re])}(qt),qt}function un(Vt,pt){for(var It=0;It<pt.length;It+=3)Vt.minX=Math.min(Vt.minX,pt[It]),Vt.minY=Math.min(Vt.minY,pt[It+1]),Vt.maxX=Math.max(Vt.maxX,pt[It]),Vt.maxY=Math.max(Vt.maxY,pt[It+1])}function Ye(Vt,pt,It,Ut){if(pt.geometry){var qt=pt.geometry.coordinates,Ht=pt.geometry.type,Pe=Math.pow(It.tolerance/((1<<It.maxZoom)*It.extent),2),Se=[],xe=pt.id;if(It.promoteId?xe=pt.properties[It.promoteId]:It.generateId&&(xe=Ut||0),Ht==="Point")Ge(qt,Se);else if(Ht==="MultiPoint")for(var Re=0;Re<qt.length;Re++)Ge(qt[Re],Se);else if(Ht==="LineString")Gn(qt,Se,Pe,!1);else if(Ht==="MultiLineString"){if(It.lineMetrics){for(Re=0;Re<qt.length;Re++)Gn(qt[Re],Se=[],Pe,!1),Vt.push(pe(xe,"LineString",Se,pt.properties));return}_i(qt,Se,Pe,!1)}else if(Ht==="Polygon")_i(qt,Se,Pe,!0);else{if(Ht!=="MultiPolygon"){if(Ht==="GeometryCollection"){for(Re=0;Re<pt.geometry.geometries.length;Re++)Ye(Vt,{id:xe,geometry:pt.geometry.geometries[Re],properties:pt.properties},It,Ut);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Re=0;Re<qt.length;Re++){var hn=[];_i(qt[Re],hn,Pe,!0),Se.push(hn)}}Vt.push(pe(xe,Ht,Se,pt.properties))}}function Ge(Vt,pt){pt.push(ui(Vt[0])),pt.push(ji(Vt[1])),pt.push(0)}function Gn(Vt,pt,It,Ut){for(var qt,Ht,Pe=0,Se=0;Se<Vt.length;Se++){var xe=ui(Vt[Se][0]),Re=ji(Vt[Se][1]);pt.push(xe),pt.push(Re),pt.push(0),Se>0&&(Pe+=Ut?(qt*Re-xe*Ht)/2:Math.sqrt(Math.pow(xe-qt,2)+Math.pow(Re-Ht,2))),qt=xe,Ht=Re}var hn=pt.length-3;pt[2]=1,we(pt,0,hn,It),pt[hn+2]=1,pt.size=Math.abs(Pe),pt.start=0,pt.end=pt.size}function _i(Vt,pt,It,Ut){for(var qt=0;qt<Vt.length;qt++){var Ht=[];Gn(Vt[qt],Ht,It,Ut),pt.push(Ht)}}function ui(Vt){return Vt/360+.5}function ji(Vt){var pt=Math.sin(Vt*Math.PI/180),It=.5-.25*Math.log((1+pt)/(1-pt))/Math.PI;return It<0?0:It>1?1:It}function Hi(Vt,pt,It,Ut,qt,Ht,Pe,Se){if(Ut/=pt,Ht>=(It/=pt)&&Pe<Ut)return Vt;if(Pe<It||Ht>=Ut)return null;for(var xe=[],Re=0;Re<Vt.length;Re++){var hn=Vt[Re],Zn=hn.geometry,bn=hn.type,ci=qt===0?hn.minX:hn.minY,hi=qt===0?hn.maxX:hn.maxY;if(ci>=It&&hi<Ut)xe.push(hn);else if(!(hi<It||ci>=Ut)){var Qn=[];if(bn==="Point"||bn==="MultiPoint")vr(Zn,Qn,It,Ut,qt);else if(bn==="LineString")Jr(Zn,Qn,It,Ut,qt,!1,Se.lineMetrics);else if(bn==="MultiLineString")uo(Zn,Qn,It,Ut,qt,!1);else if(bn==="Polygon")uo(Zn,Qn,It,Ut,qt,!0);else if(bn==="MultiPolygon")for(var pi=0;pi<Zn.length;pi++){var qi=[];uo(Zn[pi],qi,It,Ut,qt,!0),qi.length&&Qn.push(qi)}if(Qn.length){if(Se.lineMetrics&&bn==="LineString"){for(pi=0;pi<Qn.length;pi++)xe.push(pe(hn.id,bn,Qn[pi],hn.tags));continue}bn!=="LineString"&&bn!=="MultiLineString"||(Qn.length===1?(bn="LineString",Qn=Qn[0]):bn="MultiLineString"),bn!=="Point"&&bn!=="MultiPoint"||(bn=Qn.length===3?"Point":"MultiPoint"),xe.push(pe(hn.id,bn,Qn,hn.tags))}}}return xe.length?xe:null}function vr(Vt,pt,It,Ut,qt){for(var Ht=0;Ht<Vt.length;Ht+=3){var Pe=Vt[Ht+qt];Pe>=It&&Pe<=Ut&&(pt.push(Vt[Ht]),pt.push(Vt[Ht+1]),pt.push(Vt[Ht+2]))}}function Jr(Vt,pt,It,Ut,qt,Ht,Pe){for(var Se,xe,Re=$i(Vt),hn=qt===0?Ir:Ar,Zn=Vt.start,bn=0;bn<Vt.length-3;bn+=3){var ci=Vt[bn],hi=Vt[bn+1],Qn=Vt[bn+2],pi=Vt[bn+3],qi=Vt[bn+4],ur=qt===0?ci:hi,ti=qt===0?pi:qi,yr=!1;Pe&&(Se=Math.sqrt(Math.pow(ci-pi,2)+Math.pow(hi-qi,2))),ur<It?ti>It&&(xe=hn(Re,ci,hi,pi,qi,It),Pe&&(Re.start=Zn+Se*xe)):ur>Ut?ti<Ut&&(xe=hn(Re,ci,hi,pi,qi,Ut),Pe&&(Re.start=Zn+Se*xe)):Go(Re,ci,hi,Qn),ti<It&&ur>=It&&(xe=hn(Re,ci,hi,pi,qi,It),yr=!0),ti>Ut&&ur<=Ut&&(xe=hn(Re,ci,hi,pi,qi,Ut),yr=!0),!Ht&&yr&&(Pe&&(Re.end=Zn+Se*xe),pt.push(Re),Re=$i(Vt)),Pe&&(Zn+=Se)}var xr=Vt.length-3;ci=Vt[xr],hi=Vt[xr+1],Qn=Vt[xr+2],(ur=qt===0?ci:hi)>=It&&ur<=Ut&&Go(Re,ci,hi,Qn),xr=Re.length-3,Ht&&xr>=3&&(Re[xr]!==Re[0]||Re[xr+1]!==Re[1])&&Go(Re,Re[0],Re[1],Re[2]),Re.length&&pt.push(Re)}function $i(Vt){var pt=[];return pt.size=Vt.size,pt.start=Vt.start,pt.end=Vt.end,pt}function uo(Vt,pt,It,Ut,qt,Ht){for(var Pe=0;Pe<Vt.length;Pe++)Jr(Vt[Pe],pt,It,Ut,qt,Ht,!1)}function Go(Vt,pt,It,Ut){Vt.push(pt),Vt.push(It),Vt.push(Ut)}function Ir(Vt,pt,It,Ut,qt,Ht){var Pe=(Ht-pt)/(Ut-pt);return Vt.push(Ht),Vt.push(It+(qt-It)*Pe),Vt.push(1),Pe}function Ar(Vt,pt,It,Ut,qt,Ht){var Pe=(Ht-It)/(qt-It);return Vt.push(pt+(Ut-pt)*Pe),Vt.push(Ht),Vt.push(1),Pe}function Ro(Vt,pt){for(var It=[],Ut=0;Ut<Vt.length;Ut++){var qt,Ht=Vt[Ut],Pe=Ht.type;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")qt=Qo(Ht.geometry,pt);else if(Pe==="MultiLineString"||Pe==="Polygon"){qt=[];for(var Se=0;Se<Ht.geometry.length;Se++)qt.push(Qo(Ht.geometry[Se],pt))}else if(Pe==="MultiPolygon")for(qt=[],Se=0;Se<Ht.geometry.length;Se++){for(var xe=[],Re=0;Re<Ht.geometry[Se].length;Re++)xe.push(Qo(Ht.geometry[Se][Re],pt));qt.push(xe)}It.push(pe(Ht.id,Pe,qt,Ht.tags))}return It}function Qo(Vt,pt){var It=[];It.size=Vt.size,Vt.start!==void 0&&(It.start=Vt.start,It.end=Vt.end);for(var Ut=0;Ut<Vt.length;Ut+=3)It.push(Vt[Ut]+pt,Vt[Ut+1],Vt[Ut+2]);return It}function _s(Vt,pt){if(Vt.transformed)return Vt;var It,Ut,qt,Ht=1<<Vt.z,Pe=Vt.x,Se=Vt.y;for(It=0;It<Vt.features.length;It++){var xe=Vt.features[It],Re=xe.geometry,hn=xe.type;if(xe.geometry=[],hn===1)for(Ut=0;Ut<Re.length;Ut+=2)xe.geometry.push(bo(Re[Ut],Re[Ut+1],pt,Ht,Pe,Se));else for(Ut=0;Ut<Re.length;Ut++){var Zn=[];for(qt=0;qt<Re[Ut].length;qt+=2)Zn.push(bo(Re[Ut][qt],Re[Ut][qt+1],pt,Ht,Pe,Se));xe.geometry.push(Zn)}}return Vt.transformed=!0,Vt}function bo(Vt,pt,It,Ut,qt,Ht){return[Math.round(It*(Vt*Ut-qt)),Math.round(It*(pt*Ut-Ht))]}function co(Vt,pt,It,Ut,qt){for(var Ht=pt===qt.maxZoom?0:qt.tolerance/((1<<pt)*qt.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:It,y:Ut,z:pt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Se=0;Se<Vt.length;Se++){Pe.numFeatures++,io(Pe,Vt[Se],Ht,qt);var xe=Vt[Se].minX,Re=Vt[Se].minY,hn=Vt[Se].maxX,Zn=Vt[Se].maxY;xe<Pe.minX&&(Pe.minX=xe),Re<Pe.minY&&(Pe.minY=Re),hn>Pe.maxX&&(Pe.maxX=hn),Zn>Pe.maxY&&(Pe.maxY=Zn)}return Pe}function io(Vt,pt,It,Ut){var qt=pt.geometry,Ht=pt.type,Pe=[];if(Ht==="Point"||Ht==="MultiPoint")for(var Se=0;Se<qt.length;Se+=3)Pe.push(qt[Se]),Pe.push(qt[Se+1]),Vt.numPoints++,Vt.numSimplified++;else if(Ht==="LineString")Ta(Pe,qt,Vt,It,!1,!1);else if(Ht==="MultiLineString"||Ht==="Polygon")for(Se=0;Se<qt.length;Se++)Ta(Pe,qt[Se],Vt,It,Ht==="Polygon",Se===0);else if(Ht==="MultiPolygon")for(var xe=0;xe<qt.length;xe++){var Re=qt[xe];for(Se=0;Se<Re.length;Se++)Ta(Pe,Re[Se],Vt,It,!0,Se===0)}if(Pe.length){var hn=pt.tags||null;if(Ht==="LineString"&&Ut.lineMetrics){for(var Zn in hn={},pt.tags)hn[Zn]=pt.tags[Zn];hn.mapbox_clip_start=qt.start/qt.size,hn.mapbox_clip_end=qt.end/qt.size}var bn={geometry:Pe,type:Ht==="Polygon"||Ht==="MultiPolygon"?3:Ht==="LineString"||Ht==="MultiLineString"?2:1,tags:hn};pt.id!==null&&(bn.id=pt.id),Vt.features.push(bn)}}function Ta(Vt,pt,It,Ut,qt,Ht){var Pe=Ut*Ut;if(Ut>0&&pt.size<(qt?Pe:Ut))It.numPoints+=pt.length/3;else{for(var Se=[],xe=0;xe<pt.length;xe+=3)(Ut===0||pt[xe+2]>Pe)&&(It.numSimplified++,Se.push(pt[xe]),Se.push(pt[xe+1])),It.numPoints++;qt&&function(Re,hn){for(var Zn=0,bn=0,ci=Re.length,hi=ci-2;bn<ci;hi=bn,bn+=2)Zn+=(Re[bn]-Re[hi])*(Re[bn+1]+Re[hi+1]);if(Zn>0===hn)for(bn=0,ci=Re.length;bn<ci/2;bn+=2){var Qn=Re[bn],pi=Re[bn+1];Re[bn]=Re[ci-2-bn],Re[bn+1]=Re[ci-1-bn],Re[ci-2-bn]=Qn,Re[ci-1-bn]=pi}}(Se,Ht),Vt.push(Se)}}function Wa(Vt,pt){var It=(pt=this.options=function(qt,Ht){for(var Pe in Ht)qt[Pe]=Ht[Pe];return qt}(Object.create(this.options),pt)).debug;if(It&&console.time("preprocess data"),pt.maxZoom<0||pt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pt.promoteId&&pt.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ut=function(qt,Ht){var Pe=[];if(qt.type==="FeatureCollection")for(var Se=0;Se<qt.features.length;Se++)Ye(Pe,qt.features[Se],Ht,Se);else Ye(Pe,qt.type==="Feature"?qt:{geometry:qt},Ht);return Pe}(Vt,pt);this.tiles={},this.tileCoords=[],It&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pt.indexMaxZoom,pt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ut=function(qt,Ht){var Pe=Ht.buffer/Ht.extent,Se=qt,xe=Hi(qt,1,-1-Pe,Pe,0,-1,2,Ht),Re=Hi(qt,1,1-Pe,2+Pe,0,-1,2,Ht);return(xe||Re)&&(Se=Hi(qt,1,-Pe,1+Pe,0,-1,2,Ht)||[],xe&&(Se=Ro(xe,1).concat(Se)),Re&&(Se=Se.concat(Ro(Re,-1)))),Se}(Ut,pt),Ut.length&&this.splitTile(Ut,0,0,0),It&&(Ut.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Sa(Vt,pt,It){return 32*((1<<Vt)*It+pt)+Vt}function ts(Vt,pt){const It=Vt.tileID.canonical;if(!this._geoJSONIndex)return pt(null,null);const Ut=this._geoJSONIndex.getTile(It.z,It.x,It.y);if(!Ut)return pt(null,null);const qt=new J(Ut.features);let Ht=Q.exports(qt);Ht.byteOffset===0&&Ht.byteLength===Ht.buffer.byteLength||(Ht=new Uint8Array(Ht)),pt(null,{vectorTile:qt,rawData:Ht.buffer})}Wa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Wa.prototype.splitTile=function(Vt,pt,It,Ut,qt,Ht,Pe){for(var Se=[Vt,pt,It,Ut],xe=this.options,Re=xe.debug;Se.length;){Ut=Se.pop(),It=Se.pop(),pt=Se.pop(),Vt=Se.pop();var hn=1<<pt,Zn=Sa(pt,It,Ut),bn=this.tiles[Zn];if(!bn&&(Re>1&&console.time("creation"),bn=this.tiles[Zn]=co(Vt,pt,It,Ut,xe),this.tileCoords.push({z:pt,x:It,y:Ut}),Re)){Re>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pt,It,Ut,bn.numFeatures,bn.numPoints,bn.numSimplified),console.timeEnd("creation"));var ci="z"+pt;this.stats[ci]=(this.stats[ci]||0)+1,this.total++}if(bn.source=Vt,qt){if(pt===xe.maxZoom||pt===qt)continue;var hi=1<<qt-pt;if(It!==Math.floor(Ht/hi)||Ut!==Math.floor(Pe/hi))continue}else if(pt===xe.indexMaxZoom||bn.numPoints<=xe.indexMaxPoints)continue;if(bn.source=null,Vt.length!==0){Re>1&&console.time("clipping");var Qn,pi,qi,ur,ti,yr,xr=.5*xe.buffer/xe.extent,Js=.5-xr,Ss=.5+xr,vs=1+xr;Qn=pi=qi=ur=null,ti=Hi(Vt,hn,It-xr,It+Ss,0,bn.minX,bn.maxX,xe),yr=Hi(Vt,hn,It+Js,It+vs,0,bn.minX,bn.maxX,xe),Vt=null,ti&&(Qn=Hi(ti,hn,Ut-xr,Ut+Ss,1,bn.minY,bn.maxY,xe),pi=Hi(ti,hn,Ut+Js,Ut+vs,1,bn.minY,bn.maxY,xe),ti=null),yr&&(qi=Hi(yr,hn,Ut-xr,Ut+Ss,1,bn.minY,bn.maxY,xe),ur=Hi(yr,hn,Ut+Js,Ut+vs,1,bn.minY,bn.maxY,xe),yr=null),Re>1&&console.timeEnd("clipping"),Se.push(Qn||[],pt+1,2*It,2*Ut),Se.push(pi||[],pt+1,2*It,2*Ut+1),Se.push(qi||[],pt+1,2*It+1,2*Ut),Se.push(ur||[],pt+1,2*It+1,2*Ut+1)}}},Wa.prototype.getTile=function(Vt,pt,It){var Ut=this.options,qt=Ut.extent,Ht=Ut.debug;if(Vt<0||Vt>24)return null;var Pe=1<<Vt,Se=Sa(Vt,pt=(pt%Pe+Pe)%Pe,It);if(this.tiles[Se])return _s(this.tiles[Se],qt);Ht>1&&console.log("drilling down to z%d-%d-%d",Vt,pt,It);for(var xe,Re=Vt,hn=pt,Zn=It;!xe&&Re>0;)Re--,hn=Math.floor(hn/2),Zn=Math.floor(Zn/2),xe=this.tiles[Sa(Re,hn,Zn)];return xe&&xe.source?(Ht>1&&console.log("found parent tile z%d-%d-%d",Re,hn,Zn),Ht>1&&console.time("drilling down"),this.splitTile(xe.source,Re,hn,Zn,Vt,pt,It),Ht>1&&console.timeEnd("drilling down"),this.tiles[Se]?_s(this.tiles[Se],qt):null):null};class js extends r.VectorTileWorkerSource{constructor(pt,It,Ut,qt,Ht){super(pt,It,Ut,qt,ts),Ht&&(this.loadGeoJSON=Ht)}loadData(pt,It){const Ut=pt&&pt.request,qt=Ut&&Ut.collectResourceTiming;this.loadGeoJSON(pt,(Ht,Pe)=>{if(Ht||!Pe)return It(Ht);if(typeof Pe!="object")return It(new Error(`Input data given to '${pt.source}' is not a valid GeoJSON object.`));{Z(Pe,!0);try{if(pt.filter){const xe=r.createExpression(pt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(xe.result==="error")throw new Error(xe.value.map(hn=>`${hn.key}: ${hn.message}`).join(", "));Pe={type:"FeatureCollection",features:Pe.features.filter(hn=>xe.value.evaluate({zoom:0},hn))}}this._geoJSONIndex=pt.cluster?new Cn(function({superclusterOptions:xe,clusterProperties:Re}){if(!Re||!xe)return xe;const hn={},Zn={},bn={accumulated:null,zoom:0},ci={properties:null},hi=Object.keys(Re);for(const Qn of hi){const[pi,qi]=Re[Qn],ur=r.createExpression(qi),ti=r.createExpression(typeof pi=="string"?[pi,["accumulated"],["get",Qn]]:pi);hn[Qn]=ur.value,Zn[Qn]=ti.value}return xe.map=Qn=>{ci.properties=Qn;const pi={};for(const qi of hi)pi[qi]=hn[qi].evaluate(bn,ci);return pi},xe.reduce=(Qn,pi)=>{ci.properties=pi;for(const qi of hi)bn.accumulated=Qn[qi],Qn[qi]=Zn[qi].evaluate(bn,ci)},xe}(pt)).load(Pe.features):function(xe,Re){return new Wa(xe,Re)}(Pe,pt.geojsonVtOptions)}catch(xe){return It(xe)}this.loaded={};const Se={};if(qt){const xe=r.getPerformanceMeasurement(Ut);xe&&(Se.resourceTiming={},Se.resourceTiming[pt.source]=JSON.parse(JSON.stringify(xe)))}It(null,Se)}})}reloadTile(pt,It){const Ut=this.loaded;return Ut&&Ut[pt.uid]?super.reloadTile(pt,It):this.loadTile(pt,It)}loadGeoJSON(pt,It){if(pt.request)r.getJSON(pt.request,It);else{if(typeof pt.data!="string")return It(new Error(`Input data given to '${pt.source}' is not a valid GeoJSON object.`));try{return It(null,JSON.parse(pt.data))}catch{return It(new Error(`Input data given to '${pt.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(pt,It){try{It(null,this._geoJSONIndex.getClusterExpansionZoom(pt.clusterId))}catch(Ut){It(Ut)}}getClusterChildren(pt,It){try{It(null,this._geoJSONIndex.getChildren(pt.clusterId))}catch(Ut){It(Ut)}}getClusterLeaves(pt,It){try{It(null,this._geoJSONIndex.getLeaves(pt.clusterId,pt.limit,pt.offset))}catch(Ut){It(Ut)}}}class Ea{constructor(pt){this.self=pt,this.actor=new r.Actor(pt,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=r.getProjection({name:"mercator"}),this.workerSourceTypes={vector:r.VectorTileWorkerSource,geojson:js},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(It,Ut)=>{if(this.workerSourceTypes[It])throw new Error(`Worker source with name "${It}" already registered.`);this.workerSourceTypes[It]=Ut},this.self.registerRTLTextPlugin=It=>{if(r.plugin.isParsed())throw new Error("RTL text plugin already registered.");r.plugin.applyArabicShaping=It.applyArabicShaping,r.plugin.processBidirectionalText=It.processBidirectionalText,r.plugin.processStyledBidirectionalText=It.processStyledBidirectionalText}}clearCaches(pt,It,Ut){delete this.layerIndexes[pt],delete this.availableImages[pt],delete this.workerSources[pt],delete this.demWorkerSources[pt],Ut()}checkIfReady(pt,It,Ut){Ut()}setReferrer(pt,It){this.referrer=It}spriteLoaded(pt,It){this.isSpriteLoaded[pt]=It;for(const Ut in this.workerSources[pt]){const qt=this.workerSources[pt][Ut];for(const Ht in qt)qt[Ht]instanceof r.VectorTileWorkerSource&&(qt[Ht].isSpriteLoaded=It,qt[Ht].fire(new r.Event("isSpriteLoaded")))}}setImages(pt,It,Ut){this.availableImages[pt]=It;for(const qt in this.workerSources[pt]){const Ht=this.workerSources[pt][qt];for(const Pe in Ht)Ht[Pe].availableImages=It}Ut()}enableTerrain(pt,It,Ut){this.terrain=It,Ut()}setProjection(pt,It){this.projections[pt]=r.getProjection(It)}setLayers(pt,It,Ut){this.getLayerIndex(pt).replace(It),Ut()}updateLayers(pt,It,Ut){this.getLayerIndex(pt).update(It.layers,It.removedIds),Ut()}loadTile(pt,It,Ut){const qt=this.enableTerrain?r.extend({enableTerrain:this.terrain},It):It;qt.projection=this.projections[pt]||this.defaultProjection,this.getWorkerSource(pt,It.type,It.source).loadTile(qt,Ut)}loadDEMTile(pt,It,Ut){const qt=this.enableTerrain?r.extend({buildQuadTree:this.terrain},It):It;this.getDEMWorkerSource(pt,It.source).loadTile(qt,Ut)}reloadTile(pt,It,Ut){const qt=this.enableTerrain?r.extend({enableTerrain:this.terrain},It):It;qt.projection=this.projections[pt]||this.defaultProjection,this.getWorkerSource(pt,It.type,It.source).reloadTile(qt,Ut)}abortTile(pt,It,Ut){this.getWorkerSource(pt,It.type,It.source).abortTile(It,Ut)}removeTile(pt,It,Ut){this.getWorkerSource(pt,It.type,It.source).removeTile(It,Ut)}removeSource(pt,It,Ut){if(!this.workerSources[pt]||!this.workerSources[pt][It.type]||!this.workerSources[pt][It.type][It.source])return;const qt=this.workerSources[pt][It.type][It.source];delete this.workerSources[pt][It.type][It.source],qt.removeSource!==void 0?qt.removeSource(It,Ut):Ut()}loadWorkerSource(pt,It,Ut){try{this.self.importScripts(It.url),Ut()}catch(qt){Ut(qt.toString())}}syncRTLPluginState(pt,It,Ut){try{r.plugin.setState(It);const qt=r.plugin.getPluginURL();if(r.plugin.isLoaded()&&!r.plugin.isParsed()&&qt!=null){this.self.importScripts(qt);const Ht=r.plugin.isParsed();Ut(Ht?void 0:new Error(`RTL Text Plugin failed to import scripts from ${qt}`),Ht)}}catch(qt){Ut(qt.toString())}}getAvailableImages(pt){let It=this.availableImages[pt];return It||(It=[]),It}getLayerIndex(pt){let It=this.layerIndexes[pt];return It||(It=this.layerIndexes[pt]=new N),It}getWorkerSource(pt,It,Ut){if(this.workerSources[pt]||(this.workerSources[pt]={}),this.workerSources[pt][It]||(this.workerSources[pt][It]={}),!this.workerSources[pt][It][Ut]){const qt={send:(Ht,Pe,Se,xe,Re,hn)=>{this.actor.send(Ht,Pe,Se,pt,Re,hn)},scheduler:this.actor.scheduler};this.workerSources[pt][It][Ut]=new this.workerSourceTypes[It](qt,this.getLayerIndex(pt),this.getAvailableImages(pt),this.isSpriteLoaded[pt])}return this.workerSources[pt][It][Ut]}getDEMWorkerSource(pt,It){return this.demWorkerSources[pt]||(this.demWorkerSources[pt]={}),this.demWorkerSources[pt][It]||(this.demWorkerSources[pt][It]=new E),this.demWorkerSources[pt][It]}enforceCacheSizeLimit(pt,It){r.enforceCacheSizeLimit(It)}getWorkerPerformanceMetrics(pt,It,Ut){Ut(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ea(self)),Ea}),c(["./shared"],function(r){function w(_,u){if(Array.isArray(_)){if(!Array.isArray(u)||_.length!==u.length)return!1;for(let f=0;f<_.length;f++)if(!w(_[f],u[f]))return!1;return!0}if(typeof _=="object"&&_!==null&&u!==null){if(typeof u!="object"||Object.keys(_).length!==Object.keys(u).length)return!1;for(const f in _)if(!w(_[f],u[f]))return!1;return!0}return _===u}var M=N;function N(_){return!function(u){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,A,S=new Blob([""],{type:"text/javascript"}),B=URL.createObjectURL(S);try{A=new Worker(B),y=!0}catch{y=!1}return A&&A.terminate(),URL.revokeObjectURL(B),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var A=y.getContext("2d");if(!A)return!1;var S=A.getImageData(0,0,1,1);return S&&S.width===y.width}()?(E[f=u&&u.failIfMajorPerformanceCaveat]===void 0&&(E[f]=function(y){var A,S=function(B){var G=document.createElement("canvas"),W=Object.create(N.webGLContextAttributes);return W.failIfMajorPerformanceCaveat=B,G.getContext("webgl",W)||G.getContext("experimental-webgl",W)}(y);if(!S)return!1;try{A=S.createShader(S.VERTEX_SHADER)}catch{return!1}return!(!A||S.isContextLost())&&(S.shaderSource(A,"void main() {}"),S.compileShader(A),S.getShaderParameter(A,S.COMPILE_STATUS)===!0)}(f)),E[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}(_)}var E={};function Z(_,u,f){const y=r.window.document.createElement(_);return u!==void 0&&(y.className=u),f&&f.appendChild(y),y}function Y(_,u,f){const y=r.window.document.createElementNS("http://www.w3.org/2000/svg",_);for(const A of Object.keys(u))y.setAttributeNS(null,A,u[A]);return f&&f.appendChild(y),y}N.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const K=r.window.document&&r.window.document.documentElement.style,q=K&&K.userSelect!==void 0?"userSelect":"WebkitUserSelect";let at;function J(){K&&q&&(at=K[q],K[q]="none")}function Q(){K&&q&&(K[q]=at)}function lt(_){_.preventDefault(),_.stopPropagation(),r.window.removeEventListener("click",lt,!0)}function Ct(){r.window.addEventListener("click",lt,!0),r.window.setTimeout(()=>{r.window.removeEventListener("click",lt,!0)},0)}function j(_,u){const f=_.getBoundingClientRect();return yt(_,f,u)}function k(_,u){const f=_.getBoundingClientRect(),y=[];for(let A=0;A<u.length;A++)y.push(yt(_,f,u[A]));return y}function rt(_){return r.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&r.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function yt(_,u,f){const y=_.offsetWidth===u.width?1:_.offsetWidth/u.width;return new r.pointGeometry((f.clientX-u.left)*y,(f.clientY-u.top)*y)}function xt(_,u){var f=u[0],y=u[1],A=u[2],S=u[3],B=f*S-A*y;return B?(_[0]=S*(B=1/B),_[1]=-y*B,_[2]=-A*B,_[3]=f*B,_):null}function kt(_){const{userImage:u}=_;return!!(u&&u.render&&u.render())&&(_.data.replace(new Uint8Array(u.data.buffer)),!0)}class de extends r.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(u){if(this.loaded!==u&&(this.loaded=u,u)){for(const{ids:f,callback:y}of this.requestors)this._notify(f,y);this.requestors=[]}}hasImage(u){return!!this.getImage(u)}getImage(u){return this.images[u]}addImage(u,f){this._validate(u,f)&&(this.images[u]=f)}_validate(u,f){let y=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new r.ErrorEvent(new Error(`Image "${u}" has invalid "stretchX" value`))),y=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new r.ErrorEvent(new Error(`Image "${u}" has invalid "stretchY" value`))),y=!1),this._validateContent(f.content,f)||(this.fire(new r.ErrorEvent(new Error(`Image "${u}" has invalid "content" value`))),y=!1),y}_validateStretch(u,f){if(!u)return!0;let y=0;for(const A of u){if(A[0]<y||A[1]<A[0]||f<A[1])return!1;y=A[1]}return!0}_validateContent(u,f){return!(u&&(u.length!==4||u[0]<0||f.data.width<u[0]||u[1]<0||f.data.height<u[1]||u[2]<0||f.data.width<u[2]||u[3]<0||f.data.height<u[3]||u[2]<u[0]||u[3]<u[1]))}updateImage(u,f){f.version=this.images[u].version+1,this.images[u]=f,this.updatedImages[u]=!0}removeImage(u){const f=this.images[u];delete this.images[u],delete this.patterns[u],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(u,f){let y=!0;if(!this.isLoaded())for(const A of u)this.images[A]||(y=!1);this.isLoaded()||y?this._notify(u,f):this.requestors.push({ids:u,callback:f})}_notify(u,f){const y={};for(const A of u){this.images[A]||this.fire(new r.Event("styleimagemissing",{id:A}));const S=this.images[A];S?y[A]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:Boolean(S.userImage&&S.userImage.render)}:r.warnOnce(`Image "${A}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,y)}getPixelSize(){const{width:u,height:f}=this.atlasImage;return{width:u,height:f}}getPattern(u){const f=this.patterns[u],y=this.getImage(u);if(!y)return null;if(f&&f.position.version===y.version)return f.position;if(f)f.position.version=y.version;else{const A={w:y.data.width+2,h:y.data.height+2,x:0,y:0},S=new r.ImagePosition(A,y);this.patterns[u]={bin:A,position:S}}return this._updatePatternAtlas(),this.patterns[u].position}bind(u){const f=u.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new r.Texture(u,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const u=[];for(const S in this.patterns)u.push(this.patterns[S].bin);const{w:f,h:y}=r.potpack(u),A=this.atlasImage;A.resize({width:f||1,height:y||1});for(const S in this.patterns){const{bin:B}=this.patterns[S],G=B.x+1,W=B.y+1,it=this.images[S].data,et=it.width,_t=it.height;r.RGBAImage.copy(it,A,{x:0,y:0},{x:G,y:W},{width:et,height:_t}),r.RGBAImage.copy(it,A,{x:0,y:_t-1},{x:G,y:W-1},{width:et,height:1}),r.RGBAImage.copy(it,A,{x:0,y:0},{x:G,y:W+_t},{width:et,height:1}),r.RGBAImage.copy(it,A,{x:et-1,y:0},{x:G-1,y:W},{width:1,height:_t}),r.RGBAImage.copy(it,A,{x:0,y:0},{x:G+et,y:W},{width:1,height:_t})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(u){for(const f of u){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const y=this.images[f];kt(y)&&this.updateImage(f,y)}}}const Et=new r.Properties({anchor:new r.DataConstantProperty(r.spec.light.anchor),position:new class{constructor(){this.specification=r.spec.light.position}possiblyEvaluate(_,u){return function([f,y,A]){const S=r.degToRad(y+90),B=r.degToRad(A);return{x:f*Math.cos(S)*Math.sin(B),y:f*Math.sin(S)*Math.sin(B),z:f*Math.cos(B),azimuthal:y,polar:A}}(_.expression.evaluate(u))}interpolate(_,u,f){return{x:r.number(_.x,u.x,f),y:r.number(_.y,u.y,f),z:r.number(_.z,u.z,f),azimuthal:r.number(_.azimuthal,u.azimuthal,f),polar:r.number(_.polar,u.polar,f)}}},color:new r.DataConstantProperty(r.spec.light.color),intensity:new r.DataConstantProperty(r.spec.light.intensity)}),te="-transition";class ht extends r.Evented{constructor(u){super(),this._transitionable=new r.Transitionable(Et),this.setLight(u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,f={}){if(!this._validate(r.validateLight,u,f))for(const y in u){const A=u[y];r.endsWith(y,te)?this._transitionable.setTransition(y.slice(0,-te.length),A):this._transitionable.setValue(y,A)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,f,y){return(!y||y.validate!==!1)&&r.emitValidationErrors(this,u.call(r.validateStyle,r.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}const ie=new r.Properties({source:new r.DataConstantProperty(r.spec.terrain.source),exaggeration:new r.DataConstantProperty(r.spec.terrain.exaggeration)}),ln="-transition";class Le extends r.Evented{constructor(u,f){super(),this._transitionable=new r.Transitionable(ie),this.set(u),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=f}get(){return this._transitionable.serialize()}set(u){for(const f in u){const y=u[f];r.endsWith(f,ln)?this._transitionable.setTransition(f.slice(0,-ln.length),y):this._transitionable.setValue(f,y)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}}function _e(_,u,f,y){const A=r.smoothstep(45,65,f),[S,B]=Me(_,y),G=r.length(u);let W=1-Math.min(1,Math.exp((G-S)/(B-S)*-6));return W*=W*W,W=Math.min(1,1.00747*W),W*A*_.alpha}function Me(_,u){const f=.5/Math.tan(.5*u);return[_.range[0]+f,_.range[1]+f]}const be=new r.Properties({range:new r.DataConstantProperty(r.spec.fog.range),color:new r.DataConstantProperty(r.spec.fog.color),"high-color":new r.DataConstantProperty(r.spec.fog["high-color"]),"space-color":new r.DataConstantProperty(r.spec.fog["space-color"]),"horizon-blend":new r.DataConstantProperty(r.spec.fog["horizon-blend"]),"star-intensity":new r.DataConstantProperty(r.spec.fog["star-intensity"])}),ue="-transition";class Yt extends r.Evented{constructor(u,f){super(),this._transitionable=new r.Transitionable(be),this.set(u),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const u=this._transform,f=u.projection.name==="globe",y=r.globeToMercatorTransition(u.zoom),A=this.properties.get("range"),S=[.5,3];return{range:f?[r.number(S[0],A[0],y),r.number(S[1],A[1],y)]:A,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(u,f={}){if(!this._validate(r.validateFog,u,f)){for(const y of Object.keys(r.spec.fog))u&&u[y]===void 0&&(u[y]=r.spec.fog[y].default);for(const y in u){const A=u[y];r.endsWith(y,ue)?this._transitionable.setTransition(y.slice(0,-ue.length),A):this._transitionable.setValue(y,A)}}}getOpacity(u){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.smoothstep(45,65,u))*f.a}getOpacityAtLatLng(u,f){return this._transform.projection.supportsFog?function(y,A,S){const B=r.MercatorCoordinate.fromLngLat(A),G=S.elevation?S.elevation.getAtPointOrZero(B):0,W=[B.x,B.y,G];return r.transformMat4(W,W,S.mercatorFogMatrix),_e(y,W,S.pitch,S._fov)}(this.state,u,f):0}getFovAdjustedRange(u){return this._transform.projection.supportsFog?Me(this.state,u):[0,1]}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,f,y){return(!y||y.validate!==!1)&&r.emitValidationErrors(this,u.call(r.validateStyle,r.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}class Ee{constructor(u,f){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=r.uniqueId();const y=this.workerPool.acquire(this.id);for(let A=0;A<y.length;A++){const S=new Ee.Actor(y[A],f,this.id);S.name=`Worker ${A}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(u,f,y){r.asyncAll(this.actors,(A,S)=>{A.send(u,f,S)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(u=>{u.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ve(_,u,f){return u*(r.EXTENT/(_.tileSize*Math.pow(2,f-_.tileID.overscaledZ)))}Ee.Actor=r.Actor;class ye{constructor(u,f,y,A){this.screenBounds=u,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,A)}static createFromScreenPoints(u,f){let y,A;if(u instanceof r.pointGeometry||typeof u[0]=="number"){const S=r.pointGeometry.convert(u);y=[S],A=f.isPointAboveHorizon(S)}else{const S=r.pointGeometry.convert(u[0]),B=r.pointGeometry.convert(u[1]);y=[S,B],A=r.polygonizeBounds(S,B).every(G=>f.isPointAboveHorizon(G))}return new ye(y,f.getCameraPoint(),A,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(u){return r.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],u)}bufferedCameraGeometry(u){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new r.pointGeometry(1,1)):this.screenBounds[1],A=r.polygonizeBounds(f,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<y.x?A.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?A[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(A[3]=this.cameraPoint)),r.bufferConvexPolygon(A,u)}bufferedCameraGeometryGlobe(u){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new r.pointGeometry(1,1)):this.screenBounds[1],A=r.polygonizeBounds(f,y,u),S=this.cameraPoint.clone();switch(3*((S.y>f.y)+(S.y>y.y))+((S.x>f.x)+(S.x>y.x))){case 0:A[0]=S,A[4]=S.clone();break;case 1:A.splice(1,0,S);break;case 2:A[1]=S;break;case 3:A.splice(4,0,S);break;case 5:A.splice(2,0,S);break;case 6:A[3]=S;break;case 7:A.splice(3,0,S);break;case 8:A[2]=S}return A}containsTile(u,f,y,A=0){const S=u.queryPadding/f._pixelsPerMercatorPixel+1,B=y?this._bufferedCameraMercator(S,f):this._bufferedScreenMercator(S,f);let G=u.tileID.wrap+(B.unwrapped?A:0);const W=B.polygon.map(Pt=>r.getTilePoint(u.tileTransform,Pt,G));if(!r.polygonIntersectsBox(W,0,0,r.EXTENT,r.EXTENT))return;G=u.tileID.wrap+(this.screenGeometryMercator.unwrapped?A:0);const it=this.screenGeometryMercator.polygon.map(Pt=>r.getTileVec3(u.tileTransform,Pt,G)),et=it.map(Pt=>new r.pointGeometry(Pt[0],Pt[1])),_t=f.getFreeCameraOptions().position||new r.MercatorCoordinate(0,0,0),Mt=r.getTileVec3(u.tileTransform,_t,G),Bt=it.map(Pt=>{const Ot=r.sub(Pt,Pt,Mt);return r.normalize(Ot,Ot),new r.Ray(Mt,Ot)}),Ft=ve(u,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:et,tilespaceRays:Bt,bufferedTilespaceGeometry:W,bufferedTilespaceBounds:(Gt=r.getBounds(W),Gt.min.x=r.clamp(Gt.min.x,0,r.EXTENT),Gt.min.y=r.clamp(Gt.min.y,0,r.EXTENT),Gt.max.x=r.clamp(Gt.max.x,0,r.EXTENT),Gt.max.y=r.clamp(Gt.max.y,0,r.EXTENT),Gt),tile:u,tileID:u.tileID,pixelToTileUnitsFactor:Ft};var Gt}_bufferedScreenMercator(u,f){const y=Ue(u);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let A;return A=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(u),f):{polygon:this.bufferedScreenGeometry(u).map(S=>f.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[y]=A,A}}_bufferedCameraMercator(u,f){const y=Ue(u);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let A;return A=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(u),f):{polygon:this.bufferedCameraGeometry(u).map(S=>f.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[y]=A,A}}_projectAndResample(u,f){const y=function(S,B){const G=r.multiply([],B.pixelMatrix,B.globeMatrix),W=[0,-r.GLOBE_RADIUS,0,1],it=[0,r.GLOBE_RADIUS,0,1],et=[0,0,0,1];r.transformMat4$1(W,W,G),r.transformMat4$1(it,it,G),r.transformMat4$1(et,et,G);const _t=new r.pointGeometry(W[0]/W[3],W[1]/W[3]),Mt=new r.pointGeometry(it[0]/it[3],it[1]/it[3]),Bt=r.polygonContainsPoint(S,_t)&&W[3]<et[3],Ft=r.polygonContainsPoint(S,Mt)&&it[3]<et[3];if(!Bt&&!Ft)return null;const Gt=function(Ae,He,je){for(let De=1;De<Ae.length;De++){const An=mn(He.pointCoordinate3D(Ae[De-1]).x),Fe=mn(He.pointCoordinate3D(Ae[De]).x);if(je<0){if(An<Fe)return{idx:De,t:-An/(Fe-1-An)}}else if(Fe<An)return{idx:De,t:(1-An)/(Fe+1-An)}}return null}(S,B,Bt?-1:1);if(!Gt)return null;const{idx:Pt,t:Ot}=Gt;let Wt=Pt>1?fe(S.slice(0,Pt),B):[],jt=Pt<S.length?fe(S.slice(Pt),B):[];Wt=Wt.map(Ae=>new r.pointGeometry(mn(Ae.x),Ae.y)),jt=jt.map(Ae=>new r.pointGeometry(mn(Ae.x),Ae.y));const Kt=[...Wt];Kt.length===0&&Kt.push(jt[jt.length-1]);const me=r.number(Kt[Kt.length-1].y,(jt.length===0?Wt[0]:jt[0]).y,Ot);let re;return re=Bt?[new r.pointGeometry(0,me),new r.pointGeometry(0,0),new r.pointGeometry(1,0),new r.pointGeometry(1,me)]:[new r.pointGeometry(1,me),new r.pointGeometry(1,1),new r.pointGeometry(0,1),new r.pointGeometry(0,me)],Kt.push(...re),jt.length===0?Kt.push(Wt[0]):Kt.push(...jt),{polygon:Kt.map(Ae=>new r.MercatorCoordinate(Ae.x,Ae.y)),unwrapped:!1}}(u,f);if(y)return y;const A=function(S,B){let G=!1,W=-1/0,it=0;for(let _t=0;_t<S.length-1;_t++)S[_t].x>W&&(W=S[_t].x,it=_t);for(let _t=0;_t<S.length-1;_t++){const Mt=(it+_t)%(S.length-1),Bt=S[Mt],Ft=S[Mt+1];Math.abs(Bt.x-Ft.x)>.5&&(Bt.x<Ft.x?(Bt.x+=1,Mt===0&&(S[S.length-1].x+=1)):(Ft.x+=1,Mt+1===S.length-1&&(S[0].x+=1)),G=!0)}const et=r.mercatorXfromLng(B.center.lng);return G&&et<Math.abs(et-1)&&S.forEach(_t=>{_t.x-=1}),{polygon:S,unwrapped:G}}(fe(u,f).map(S=>new r.pointGeometry(mn(S.x),S.y)),f);return{polygon:A.polygon.map(S=>new r.MercatorCoordinate(S.x,S.y)),unwrapped:A.unwrapped}}}function fe(_,u){return r.resample(_,f=>{const y=u.pointCoordinate3D(f);f.x=y.x,f.y=y.y},1/256)}function mn(_){return _<0?1+_%1:_%1}function Ue(_){return 100*_|0}function Cn(_,u,f,y,A){const S=function(B,G){if(B)return A(B);if(G){_.url&&G.tiles&&_.tiles&&delete _.tiles;const W=r.pick(r.extend(G,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);G.vector_layers&&(W.vectorLayers=G.vector_layers,W.vectorLayerIds=W.vectorLayers.map(it=>it.id)),W.tiles=u.canonicalizeTileset(W,_.url),A(null,W)}};return _.url?r.getJSON(u.transformRequest(u.normalizeSourceURL(_.url,null,f,y),r.ResourceType.Source),S):r.exported.frame(()=>S(null,_))}class Bn{constructor(u,f,y){this.bounds=r.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=f||0,this.maxzoom=y||24}validateBounds(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const f=Math.pow(2,u.z),y=Math.floor(r.mercatorXfromLng(this.bounds.getWest())*f),A=Math.floor(r.mercatorYfromLat(this.bounds.getNorth())*f),S=Math.ceil(r.mercatorXfromLng(this.bounds.getEast())*f),B=Math.ceil(r.mercatorYfromLat(this.bounds.getSouth())*f);return u.x>=y&&u.x<S&&u.y>=A&&u.y<B}}class Pn{constructor(u,f,y){this.context=u;const A=u.gl;this.buffer=A.createBuffer(),this.dynamicDraw=Boolean(y),this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const cn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Un{constructor(u,f,y,A){this.length=f.length,this.attributes=y,this.itemSize=f.bytesPerElement,this.dynamicDraw=A,this.context=u;const S=u.gl;this.buffer=S.createBuffer(),u.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,f){for(let y=0;y<this.attributes.length;y++){const A=f.attributes[this.attributes[y].name];A!==void 0&&u.enableVertexAttribArray(A)}}setVertexAttribPointers(u,f,y){for(let A=0;A<this.attributes.length;A++){const S=this.attributes[A],B=f.attributes[S.name];B!==void 0&&u.vertexAttribPointer(B,S.components,u[cn[S.type]],!1,this.itemSize,S.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class R{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class st extends R{getDefault(){return r.Color.transparent}set(u){const f=this.current;(u.r!==f.r||u.g!==f.g||u.b!==f.b||u.a!==f.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class gt extends R{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class dt extends R{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class wt extends R{getDefault(){return[!0,!0,!0,!0]}set(u){const f=this.current;(u[0]!==f[0]||u[1]!==f[1]||u[2]!==f[2]||u[3]!==f[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Zt extends R{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class we extends R{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class We extends R{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const f=this.current;(u.func!==f.func||u.ref!==f.ref||u.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class pe extends R{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const f=this.current;(u[0]!==f[0]||u[1]!==f[1]||u[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class un extends R{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;u?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=u,this.dirty=!1}}class Ye extends R{getDefault(){return[0,1]}set(u){const f=this.current;(u[0]!==f[0]||u[1]!==f[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class Ge extends R{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;u?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=u,this.dirty=!1}}class Gn extends R{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class _i extends R{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;u?f.enable(f.BLEND):f.disable(f.BLEND),this.current=u,this.dirty=!1}}class ui extends R{getDefault(){const u=this.gl;return[u.ONE,u.ZERO]}set(u){const f=this.current;(u[0]!==f[0]||u[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(u[0],u[1]),this.current=u,this.dirty=!1)}}class ji extends R{getDefault(){return r.Color.transparent}set(u){const f=this.current;(u.r!==f.r||u.g!==f.g||u.b!==f.b||u.a!==f.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class Hi extends R{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquation(u),this.current=u,this.dirty=!1)}}class vr extends R{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;u?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=u,this.dirty=!1}}class Jr extends R{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class $i extends R{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}class uo extends R{getDefault(){return null}set(u){(u!==this.current||this.dirty)&&(this.gl.useProgram(u),this.current=u,this.dirty=!1)}}class Go extends R{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class Ir extends R{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const f=this.current;(u[0]!==f[0]||u[1]!==f[1]||u[2]!==f[2]||u[3]!==f[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Ar extends R{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class Ro extends R{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Qo extends R{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class _s extends R{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class bo extends R{getDefault(){return null}set(u){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class co extends R{constructor(u){super(u),this.vao=u.extVertexArrayObject}getDefault(){return null}set(u){this.vao&&(u!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(u),this.current=u,this.dirty=!1)}}class io extends R{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class Ta extends R{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class Wa extends R{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class Sa extends R{constructor(u,f){super(u),this.context=u,this.parent=f}getDefault(){return null}}class ts extends Sa{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class js extends Sa{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Ea extends js{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Vt{constructor(u,f,y,A){this.context=u,this.width=f,this.height=y;const S=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new ts(u,S),A&&(this.depthAttachment=new js(u,S))}destroy(){const u=this.context.gl,f=this.colorAttachment.get();if(f&&u.deleteTexture(f),this.depthAttachment){const y=this.depthAttachment.get();y&&u.deleteRenderbuffer(y)}u.deleteFramebuffer(this.framebuffer)}}class pt{constructor(u){this.gl=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new st(this),this.clearDepth=new gt(this),this.clearStencil=new dt(this),this.colorMask=new wt(this),this.depthMask=new Zt(this),this.stencilMask=new we(this),this.stencilFunc=new We(this),this.stencilOp=new pe(this),this.stencilTest=new un(this),this.depthRange=new Ye(this),this.depthTest=new Ge(this),this.depthFunc=new Gn(this),this.blend=new _i(this),this.blendFunc=new ui(this),this.blendColor=new ji(this),this.blendEquation=new Hi(this),this.cullFace=new vr(this),this.cullFaceSide=new Jr(this),this.frontFace=new $i(this),this.program=new uo(this),this.activeTexture=new Go(this),this.viewport=new Ir(this),this.bindFramebuffer=new Ar(this),this.bindRenderbuffer=new Ro(this),this.bindTexture=new Qo(this),this.bindVertexBuffer=new _s(this),this.bindElementBuffer=new bo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new co(this),this.pixelStoreUnpack=new io(this),this.pixelStoreUnpackPremultiplyAlpha=new Ta(this),this.pixelStoreUnpackFlipY=new Wa(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=u.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=u.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=u.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=u.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(u.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=u.getExtension("OES_standard_derivatives"),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,f){return new Pn(this,u,f)}createVertexBuffer(u,f,y){return new Un(this,u,f,y)}createRenderbuffer(u,f,y){const A=this.gl,S=A.createRenderbuffer();return this.bindRenderbuffer.set(S),A.renderbufferStorage(A.RENDERBUFFER,u,f,y),this.bindRenderbuffer.set(null),S}createFramebuffer(u,f,y){return new Vt(this,u,f,y)}clear({color:u,depth:f,stencil:y}){const A=this.gl;let S=0;u&&(S|=A.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(S|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),y!==void 0&&(S|=A.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),A.clear(S)}setCullFace(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){w(u.blendFunction,r.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class It extends r.Evented{constructor(u,f,y,A){super(),this.id=u,this.dispatcher=y,this.setEventedParent(A),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.extend({type:"raster"},f),r.extend(this,r.pick(f,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Cn(this._options,this.map._requestManager,null,null,(u,f)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new r.ErrorEvent(u)):f&&(r.extend(this,f),f.bounds&&(this.tileBounds=new Bn(f.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(f.tiles),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return r.extend({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,f){const y=r.exported.devicePixelRatio>=2,A=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);u.request=r.getImage(this.map._requestManager.transformRequest(A,r.ResourceType.Tile),(S,B,G,W)=>(delete u.request,u.aborted?(u.state="unloaded",f(null)):S?(u.state="errored",f(S)):B?(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:G,expires:W}),u.setTexture(B,this.map.painter),u.state="loaded",r.cacheEntryPossiblyAdded(this.dispatcher),void f(null)):f(null)))}static loadTileData(u,f,y){u.setTexture(f,y)}static unloadTileData(u,f){u.texture&&f.saveTileTexture(u.texture)}abortTile(u,f){u.request&&(u.request.cancel(),delete u.request),f()}unloadTile(u,f){u.texture&&this.map.painter.saveTileTexture(u.texture),f()}hasTransition(){return!1}}let Ut;function qt(_,u,f,y,A,S,B,G){const W=[_,f,A,u,y,S,1,1,1],it=[B,G,1],et=r.adjoint([],W),[_t,Mt,Bt]=r.transformMat3(it,it,r.transpose(et,et));return r.multiply$1(W,[_t,0,0,0,Mt,0,0,0,Bt],W)}class Ht extends r.Evented{constructor(u,f,y,A){super(),this.id=u,this.dispatcher=y,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(A),this.options=f,this._dirty=!1}load(u,f){this._loaded=f||!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=r.getImage(this.map._requestManager.transformRequest(this.url,r.ResourceType.Image),(y,A)=>{if(this._imageRequest=null,this._loaded=!0,y)this.fire(new r.ErrorEvent(y));else if(A){const{HTMLImageElement:S}=r.window;this.image=A instanceof S?r.exported.getImageData(A):A,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,u&&(this.coordinates=u),this._finishLoading()}})}loaded(){return this._loaded}updateImage(u){return this.image&&u.url?(this._imageRequest&&u.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=u.url,this.load(u.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(u){this.coordinates=u,this._boundsArray=void 0;const f=u.map(r.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let A=1/0,S=1/0,B=-1/0,G=-1/0;for(const _t of y)A=Math.min(A,_t.x),S=Math.min(S,_t.y),B=Math.max(B,_t.x),G=Math.max(G,_t.y);const W=Math.max(B-A,G-S),it=Math.max(0,Math.floor(-Math.log(W)/Math.LN2)),et=Math.pow(2,it);return new r.CanonicalTileID(it,Math.floor((A+B)/2*et),Math.floor((S+G)/2*et))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(u){for(const W in this.tiles){const it=this.tiles[W];it.state!=="loaded"&&(it.state="loaded",it.texture=this.texture)}if(this._boundsArray)return;const f=r.tileTransform(this.tileID,this.map.transform.projection),[y,A,S,B]=this.coordinates.map(W=>{const it=f.projection.project(W[0],W[1]);return r.getTilePoint(f,it)._round()});this.perspectiveTransform=function(W,it,et,_t,Mt,Bt,Ft,Gt,Pt,Ot){const Wt=qt(0,0,W,0,0,it,W,it),jt=qt(et,_t,Mt,Bt,Ft,Gt,Pt,Ot);return r.multiply$1(jt,r.adjoint(Wt,Wt),jt),[jt[6]/jt[8]*W/r.EXTENT,jt[7]/jt[8]*it/r.EXTENT]}(this.width,this.height,y.x,y.y,A.x,A.y,B.x,B.y,S.x,S.y);const G=this._boundsArray=new r.StructArrayLayout4i8;G.emplaceBack(y.x,y.y,0,0),G.emplaceBack(A.x,A.y,r.EXTENT,0),G.emplaceBack(B.x,B.y,0,r.EXTENT),G.emplaceBack(S.x,S.y,r.EXTENT,r.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=u.createVertexBuffer(G,r.boundsAttributes.members),this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const u=this.map.painter.context,f=u.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new r.Texture(u,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(u)}loadTile(u,f){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={},f(null)):(u.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Pe={vector:class extends r.Evented{constructor(_,u,f,y){if(super(),this.id=_,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.extend(this,r.pick(u,["url","scheme","tileSize","promoteId"])),this._options=r.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new r.DedupedRequest}load(_){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map._worldview;this._tileJSONRequest=Cn(this._options,this.map._requestManager,u,f,(y,A)=>{this._tileJSONRequest=null,this._loaded=!0,y?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),f&&f.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new r.ErrorEvent(y))):A&&(r.extend(this,A),A.bounds&&(this.tileBounds=new Bn(A.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(A.tiles,this.map._requestManager._customAccessToken),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))),_&&_(y)})}loaded(){return this._loaded}hasTile(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)}onAdd(_){this.map=_,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>{const _=this.map.style._getSourceCaches(this.id);for(const u of _)u.clearTiles()})}setSourceProperty(_){_(),this.reload()}setTiles(_){return this._options.tiles=_,this.reload(),this}setUrl(_){return this.url=_,this._options.url=_,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return r.extend({},this._options)}loadTile(_,u){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(f,r.ResourceType.Tile),data:void 0,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:_.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,_.actor&&_.state!=="expired")_.state==="loading"?_.reloadCallback=u:_.request=_.actor.send("reloadTile",y,A.bind(this));else if(_.actor=this._tileWorkers[f]=this._tileWorkers[f]||this.dispatcher.getActor(),this.dispatcher.ready)_.request=_.actor.send("loadTile",y,A.bind(this),void 0,!0);else{const S=r.loadVectorTile.call({deduped:this._deduped},y,(B,G)=>{B||!G?A.call(this,B):(y.data={cacheControl:G.cacheControl,expires:G.expires,rawData:G.rawData.slice(0)},_.actor&&_.actor.send("loadTile",y,A.bind(this),void 0,!0))},!0);_.request={cancel:S}}function A(S,B){return delete _.request,_.aborted?u(null):S&&S.status!==404?u(S):(B&&B.resourceTiming&&(_.resourceTiming=B.resourceTiming),this.map._refreshExpiredTiles&&B&&_.setExpiryData(B),_.loadVectorData(B,this.map.painter),r.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(_.reloadCallback&&(this.loadTile(_,_.reloadCallback),_.reloadCallback=null)))}}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.actor&&_.actor.send("abortTile",{uid:_.uid,type:this.type,source:this.id})}unloadTile(_){_.unloadVectorData(),_.actor&&_.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:It,"raster-dem":class extends It{constructor(_,u,f,y){super(_,u,f,y),this.type="raster-dem",this.maxzoom=22,this._options=r.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(_,u){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(A,S){A&&(_.state="errored",u(A)),S&&(_.dem=S,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",u(null))}_.request=r.getImage(this.map._requestManager.transformRequest(f,r.ResourceType.Tile),function(A,S,B,G){if(delete _.request,_.aborted)_.state="unloaded",u(null);else if(A)_.state="errored",u(A);else if(S){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:B,expires:G});const W=r.window.ImageBitmap&&S instanceof r.window.ImageBitmap&&(Ut==null&&(Ut=r.window.OffscreenCanvas&&new r.window.OffscreenCanvas(1,1).getContext("2d")&&typeof r.window.createImageBitmap=="function"),Ut),it=1-(S.width-r.prevPowerOfTwo(S.width))/2;it<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const et=W?S:r.exported.getImageData(S,it),_t={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:et,encoding:this.encoding,padding:it};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",_t,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(_){const u=_.canonical,f=Math.pow(2,u.z),y=(u.x-1+f)%f,A=u.x===0?_.wrap-1:_.wrap,S=(u.x+1+f)%f,B=u.x+1===f?_.wrap+1:_.wrap,G={};return G[new r.OverscaledTileID(_.overscaledZ,A,u.z,y,u.y).key]={backfilled:!1},G[new r.OverscaledTileID(_.overscaledZ,B,u.z,S,u.y).key]={backfilled:!1},u.y>0&&(G[new r.OverscaledTileID(_.overscaledZ,A,u.z,y,u.y-1).key]={backfilled:!1},G[new r.OverscaledTileID(_.overscaledZ,_.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},G[new r.OverscaledTileID(_.overscaledZ,B,u.z,S,u.y-1).key]={backfilled:!1}),u.y+1<f&&(G[new r.OverscaledTileID(_.overscaledZ,A,u.z,y,u.y+1).key]={backfilled:!1},G[new r.OverscaledTileID(_.overscaledZ,_.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},G[new r.OverscaledTileID(_.overscaledZ,B,u.z,S,u.y+1).key]={backfilled:!1}),G}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends r.Evented{constructor(_,u,f,y){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(y),this._data=u.data,this._options=r.extend({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const A=r.EXTENT/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*A,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*A,extent:r.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:r.EXTENT,radius:(u.clusterRadius!==void 0?u.clusterRadius:50)*A,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},u),this}getClusterChildren(_,u){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},u),this}getClusterLeaves(_,u,f,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:u,offset:f},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=r.extend({},this.workerOptions),u=this._data;typeof u=="string"?(_.request=this.map._requestManager.transformRequest(r.exported.resolveURL(u),r.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(f,y)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new r.ErrorEvent(f));else{const A={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(A.resourceTiming=y.resourceTiming[this.id]),this.fire(new r.Event("data",A)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,u){const f=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(f,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,A)=>(delete _.request,_.unloadVectorData(),_.aborted?u(null):y?u(y):(_.loadVectorData(A,this.map.painter,f==="reloadTile"),u(null))),void 0,f==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ht{constructor(_,u,f,y){super(_,u,f,y),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const u of _.urls)this.urls.push(this.map._requestManager.transformRequest(u,r.ResourceType.Source).url);r.getVideo(this.urls,(u,f)=>{this._loaded=!0,u?this.fire(new r.ErrorEvent(u)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const u=this.video.seekable;_<u.start(0)||_>u.end(0)?this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,u=_.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new r.Texture(_,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ht,canvas:class extends Ht{constructor(_,u,f,y){super(_,u,f,y),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(A=>!Array.isArray(A)||A.length!==2||A.some(S=>typeof S!="number"))||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof r.window.HTMLCanvasElement||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof r.window.HTMLCanvasElement?this.options.canvas:r.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context;this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.Texture(u,this.canvas,u.gl.RGBA,{premultiply:!0}),this._prepareData(u)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends r.Evented{constructor(_,u,f,y){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=u,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Bn(this._implementation.bounds,this.minzoom,this.maxzoom)),u.update=this._update.bind(this),u.clearTiles=this._clearTiles.bind(this),u.coveringTiles=this._coveringTiles.bind(this),r.extend(this,r.pick(u,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:u,y:f,z:y}=_.canonical;return this._implementation.hasTile({x:u,y:f,z:y})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,u){const{x:f,y,z:A}=_.tileID.canonical,S=new r.window.AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:f,y,z:A},{signal:S.signal})).then(function(B){return delete _.request,_.aborted?(_.state="unloaded",u(null)):B===void 0?(_.state="errored",u(null)):B===null?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",u(null)):function(G){return G instanceof r.window.ImageData||G instanceof r.window.HTMLCanvasElement||G instanceof r.window.ImageBitmap||G instanceof r.window.HTMLImageElement}(B)?(this.loadTileData(_,B),_.state="loaded",void u(null)):(_.state="errored",u(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(B=>{B.code!==20&&(_.state="errored",u(B))}),_.request.cancel=()=>S.abort()}loadTileData(_,u){It.loadTileData(_,u,this._map.painter)}unloadTileData(_){It.unloadTileData(_,this._map.painter)}unloadTile(_,u){if(this.unloadTileData(_),this._implementation.unloadTile){const{x:f,y,z:A}=_.tileID.canonical;this._implementation.unloadTile({x:f,y,z:A})}u()}abortTile(_,u){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),u()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Se=function(_,u,f,y){const A=new Pe[u.type](_,u,f,y);if(A.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${A.id}`);return r.bindAll(["load","abort","unload","serialize","prepare"],A),A};function xe(_,u){const f=r.identity([]);return r.scale(f,f,[.5*_.width,.5*-_.height,1]),r.translate(f,f,[1,-1,0]),r.multiply(f,f,_.calculateProjMatrix(u.toUnwrapped())),Float32Array.from(f)}function Re(_,u,f,y,A,S,B,G=!1){const W=_.tilesIn(y,B,G);W.sort(Zn);const it=[];for(const _t of W)it.push({wrappedTileID:_t.tile.tileID.wrapped().key,queryResults:_t.tile.queryRenderedFeatures(u,f,_._state,_t,A,S,xe(_.transform,_t.tile.tileID),G)});const et=function(_t){const Mt={},Bt={};for(const Ft of _t){const Gt=Ft.queryResults,Pt=Ft.wrappedTileID,Ot=Bt[Pt]=Bt[Pt]||{};for(const Wt in Gt){const jt=Gt[Wt],Kt=Ot[Wt]=Ot[Wt]||{},me=Mt[Wt]=Mt[Wt]||[];for(const re of jt)Kt[re.featureIndex]||(Kt[re.featureIndex]=!0,me.push(re))}}return Mt}(it);for(const _t in et)et[_t].forEach(Mt=>{const Bt=Mt.feature,Ft=Bt.layer;Ft&&Ft.type!=="background"&&Ft.type!=="sky"&&(Bt.source=Ft.source,Ft["source-layer"]&&(Bt.sourceLayer=Ft["source-layer"]),Bt.state=Bt.id!==void 0?_.getFeatureState(Ft["source-layer"],Bt.id):{})});return et}function hn(_,u){const f=_.getRenderableIds().map(S=>_.getTileByID(S)),y=[],A={};for(let S=0;S<f.length;S++){const B=f[S],G=B.tileID.canonical.key;A[G]||(A[G]=!0,B.querySourceFeatures(y,u))}return y}function Zn(_,u){const f=_.tileID,y=u.tileID;return f.overscaledZ-y.overscaledZ||f.canonical.y-y.canonical.y||f.wrap-y.wrap||f.canonical.x-y.canonical.x}function bn(){return Gc.workerClass!=null?new Gc.workerClass:new r.window.Worker(Gc.workerUrl)}const ci="mapboxgl_preloaded_worker_pool";class hi{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<hi.workerCount;)this.workers.push(new bn);return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ci]}numActive(){return Object.keys(this.active).length}}let Qn;function pi(){return Qn||(Qn=new hi),Qn}function qi(_,u){const f={};for(const y in _)y!=="ref"&&(f[y]=_[y]);return r.refProperties.forEach(y=>{y in u&&(f[y]=u[y])}),f}function ur(_){_=_.slice();const u=Object.create(null);for(let f=0;f<_.length;f++)u[_[f].id]=_[f];for(let f=0;f<_.length;f++)"ref"in _[f]&&(_[f]=qi(_[f],u[_[f].ref]));return _}hi.workerCount=2;const ti={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function yr(_,u,f){f.push({command:ti.addSource,args:[_,u[_]]})}function xr(_,u,f){u.push({command:ti.removeSource,args:[_]}),f[_]=!0}function Js(_,u,f,y){xr(_,f,y),yr(_,u,f)}function Ss(_,u,f){let y;for(y in _[f])if(_[f].hasOwnProperty(y)&&y!=="data"&&!w(_[f][y],u[f][y]))return!1;for(y in u[f])if(u[f].hasOwnProperty(y)&&y!=="data"&&!w(_[f][y],u[f][y]))return!1;return!0}function vs(_,u,f,y,A,S){let B;for(B in u=u||{},_=_||{})_.hasOwnProperty(B)&&(w(_[B],u[B])||f.push({command:S,args:[y,B,u[B],A]}));for(B in u)u.hasOwnProperty(B)&&!_.hasOwnProperty(B)&&(w(_[B],u[B])||f.push({command:S,args:[y,B,u[B],A]}))}function Ke(_){return _.id}function Po(_,u){return _[u.id]=u,_}class Xr{constructor(u,f){this.reset(u,f)}reset(u,f){this.points=u||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(this.points.length===1)return this.points[0];u=r.clamp(u,0,1);let f=1,y=this._distances[f];const A=u*this.paddedLength+this.padding;for(;y<A&&f<this._distances.length;)y=this._distances[++f];const S=f-1,B=this._distances[S],G=y-B,W=G>0?(A-B)/G:0;return this.points[S].mult(1-W).add(this.points[f].mult(W))}}class ro{constructor(u,f,y){const A=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(u/y),this.yCellCount=Math.ceil(f/y);for(let B=0;B<this.xCellCount*this.yCellCount;B++)A.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=f,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,f,y,A,S){this._forEachCell(f,y,A,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(A),this.bboxes.push(S)}insertCircle(u,f,y,A){this._forEachCell(f-A,y-A,f+A,y+A,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(f),this.circles.push(y),this.circles.push(A)}_insertBoxCell(u,f,y,A,S,B){this.boxCells[S].push(B)}_insertCircleCell(u,f,y,A,S,B){this.circleCells[S].push(B)}_query(u,f,y,A,S,B){if(y<0||u>this.width||A<0||f>this.height)return!S&&[];const G=[];if(u<=0&&f<=0&&this.width<=y&&this.height<=A){if(S)return!0;for(let W=0;W<this.boxKeys.length;W++)G.push({key:this.boxKeys[W],x1:this.bboxes[4*W],y1:this.bboxes[4*W+1],x2:this.bboxes[4*W+2],y2:this.bboxes[4*W+3]});for(let W=0;W<this.circleKeys.length;W++){const it=this.circles[3*W],et=this.circles[3*W+1],_t=this.circles[3*W+2];G.push({key:this.circleKeys[W],x1:it-_t,y1:et-_t,x2:it+_t,y2:et+_t})}return B?G.filter(B):G}return this._forEachCell(u,f,y,A,this._queryCell,G,{hitTest:S,seenUids:{box:{},circle:{}}},B),S?G.length>0:G}_queryCircle(u,f,y,A,S){const B=u-y,G=u+y,W=f-y,it=f+y;if(G<0||B>this.width||it<0||W>this.height)return!A&&[];const et=[];return this._forEachCell(B,W,G,it,this._queryCellCircle,et,{hitTest:A,circle:{x:u,y:f,radius:y},seenUids:{box:{},circle:{}}},S),A?et.length>0:et}query(u,f,y,A,S){return this._query(u,f,y,A,!1,S)}hitTest(u,f,y,A,S){return this._query(u,f,y,A,!0,S)}hitTestCircle(u,f,y,A){return this._queryCircle(u,f,y,!0,A)}_queryCell(u,f,y,A,S,B,G,W){const it=G.seenUids,et=this.boxCells[S];if(et!==null){const Mt=this.bboxes;for(const Bt of et)if(!it.box[Bt]){it.box[Bt]=!0;const Ft=4*Bt;if(u<=Mt[Ft+2]&&f<=Mt[Ft+3]&&y>=Mt[Ft+0]&&A>=Mt[Ft+1]&&(!W||W(this.boxKeys[Bt]))){if(G.hitTest)return B.push(!0),!0;B.push({key:this.boxKeys[Bt],x1:Mt[Ft],y1:Mt[Ft+1],x2:Mt[Ft+2],y2:Mt[Ft+3]})}}}const _t=this.circleCells[S];if(_t!==null){const Mt=this.circles;for(const Bt of _t)if(!it.circle[Bt]){it.circle[Bt]=!0;const Ft=3*Bt;if(this._circleAndRectCollide(Mt[Ft],Mt[Ft+1],Mt[Ft+2],u,f,y,A)&&(!W||W(this.circleKeys[Bt]))){if(G.hitTest)return B.push(!0),!0;{const Gt=Mt[Ft],Pt=Mt[Ft+1],Ot=Mt[Ft+2];B.push({key:this.circleKeys[Bt],x1:Gt-Ot,y1:Pt-Ot,x2:Gt+Ot,y2:Pt+Ot})}}}}}_queryCellCircle(u,f,y,A,S,B,G,W){const it=G.circle,et=G.seenUids,_t=this.boxCells[S];if(_t!==null){const Bt=this.bboxes;for(const Ft of _t)if(!et.box[Ft]){et.box[Ft]=!0;const Gt=4*Ft;if(this._circleAndRectCollide(it.x,it.y,it.radius,Bt[Gt+0],Bt[Gt+1],Bt[Gt+2],Bt[Gt+3])&&(!W||W(this.boxKeys[Ft])))return B.push(!0),!0}}const Mt=this.circleCells[S];if(Mt!==null){const Bt=this.circles;for(const Ft of Mt)if(!et.circle[Ft]){et.circle[Ft]=!0;const Gt=3*Ft;if(this._circlesCollide(Bt[Gt],Bt[Gt+1],Bt[Gt+2],it.x,it.y,it.radius)&&(!W||W(this.circleKeys[Ft])))return B.push(!0),!0}}}_forEachCell(u,f,y,A,S,B,G,W){const it=this._convertToXCellCoord(u),et=this._convertToYCellCoord(f),_t=this._convertToXCellCoord(y),Mt=this._convertToYCellCoord(A);for(let Bt=it;Bt<=_t;Bt++)for(let Ft=et;Ft<=Mt;Ft++)if(S.call(this,u,f,y,A,this.xCellCount*Ft+Bt,B,G,W))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,f,y,A,S,B){const G=A-u,W=S-f,it=y+B;return it*it>G*G+W*W}_circleAndRectCollide(u,f,y,A,S,B,G){const W=(B-A)/2,it=Math.abs(u-(A+W));if(it>W+y)return!1;const et=(G-S)/2,_t=Math.abs(f-(S+et));if(_t>et+y)return!1;if(it<=W||_t<=et)return!0;const Mt=it-W,Bt=_t-et;return Mt*Mt+Bt*Bt<=y*y}}const hl=Math.tan(85*Math.PI/180);function Io(_,u,f,y,A,S,B){const G=r.create();if(f)if(S.name==="globe"){const W=r.calculateGlobeLabelMatrix(A,u);r.multiply(G,G,W)}else{const W=xt([],B);G[0]=W[0],G[1]=W[1],G[4]=W[2],G[5]=W[3],y||r.rotateZ(G,G,A.angle)}else r.multiply(G,A.labelPlaneMatrix,_);return G}function cr(_,u,f,y,A,S,B){const G=Io(_,u,f,y,A,S,B);return S.name==="globe"&&f||(G[2]=G[6]=G[10]=G[14]=0),G}function Kr(_,u,f,y,A,S,B){if(f){if(S.name==="globe"){const G=Io(_,u,f,y,A,S,B);return r.invert(G,G),r.multiply(G,_,G),G}{const G=r.clone(_),W=r.identity([]);return W[0]=B[0],W[1]=B[1],W[4]=B[2],W[5]=B[3],r.multiply(G,G,W),y||r.rotateZ(G,G,-A.angle),G}}return A.glCoordMatrix}function Co(_,u,f,y){const A=[_,u,f,1];f?r.transformMat4$1(A,A,y):nr(A,A,y);const S=A[3];return A[0]/=S,A[1]/=S,A[2]/=S,A}function jn(_,u){return Math.min(.5+_/u*.5,1.5)}function Ti(_,u){const f=_[0]/_[3],y=_[1]/_[3];return f>=-u[0]&&f<=u[0]&&y>=-u[1]&&y<=u[1]}function Oi(_,u,f,y,A,S,B,G,W,it){const et=f.transform,_t=y?_.textSizeData:_.iconSizeData,Mt=r.evaluateSizeForZoom(_t,f.transform.zoom),Bt=et.projection.name==="globe",Ft=[256/f.width*2+1,256/f.height*2+1],Gt=y?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;Gt.clear();let Pt=null;Bt&&(Pt=y?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const Ot=_.lineVertexArray,Wt=y?_.text.placedSymbolArray:_.icon.placedSymbolArray,jt=f.transform.width/f.transform.height;let Kt,me=!1;for(let re=0;re<Wt.length;re++){const Ae=Wt.get(re),{numGlyphs:He,writingMode:je}=Ae;if(je!==r.WritingMode.vertical||me||Kt===r.WritingMode.horizontal||(me=!0),Kt=je,(Ae.hidden||je===r.WritingMode.vertical)&&!me){Nr(He,Gt);continue}me=!1;const De=new r.pointGeometry(Ae.tileAnchorX,Ae.tileAnchorY);let{x:An,y:Fe,z:fn}=et.projection.projectTilePoint(De.x,De.y,it.canonical);if(W){const[fi,oi,Li]=W(De);An+=fi,Fe+=oi,fn+=Li}const Je=[An,Fe,fn,1];if(r.transformMat4$1(Je,Je,u),!Ti(Je,Ft)){Nr(He,Gt);continue}const Ln=jn(f.transform.cameraToCenterDistance,Je[3]),tn=r.evaluateSizeForFeature(_t,Mt,Ae),xn=B?tn/Ln:tn*Ln,zn=Co(An,Fe,fn,A);if(zn[3]<=0){Nr(He,Gt);continue}let Ne={};const $e=B?null:W,ri=vi(Ae,xn,!1,G,u,A,S,_.glyphOffsetArray,Ot,Gt,Pt,zn,De,Ne,jt,$e,et.projection,it,B);me=ri.useVertical,$e&&ri.needsFlipping&&(Ne={}),(ri.notEnoughRoom||me||ri.needsFlipping&&vi(Ae,xn,!0,G,u,A,S,_.glyphOffsetArray,Ot,Gt,Pt,zn,De,Ne,jt,$e,et.projection,it,B).notEnoughRoom)&&Nr(He,Gt)}y?(_.text.dynamicLayoutVertexBuffer.updateData(Gt),Pt&&_.text.globeExtVertexBuffer.updateData(Pt)):(_.icon.dynamicLayoutVertexBuffer.updateData(Gt),Pt&&_.icon.globeExtVertexBuffer.updateData(Pt))}function Si(_,u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt){const{lineStartIndex:Pt,glyphStartIndex:Ot,segment:Wt}=G,jt=Ot+G.numGlyphs,Kt=Pt+G.lineLength,me=u.getoffsetX(Ot),re=u.getoffsetX(jt-1),Ae=Yo(_*me,f,y,A,S,B,Wt,Pt,Kt,W,it,et,_t,Mt,!0,Bt,Ft,Gt);if(!Ae)return null;const He=Yo(_*re,f,y,A,S,B,Wt,Pt,Kt,W,it,et,_t,Mt,!0,Bt,Ft,Gt);return He?{first:Ae,last:He}:null}function Tr(_,u,f,y){return _===r.WritingMode.horizontal&&Math.abs(y)>Math.abs(f)?{useVertical:!0}:_===r.WritingMode.vertical?y>0?{needsFlipping:!0}:null:u!==0&&function(A,S){return A===0||Math.abs(S/A)>hl}(f,y)?u===1?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null}function vi(_,u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt,Pt,Ot,Wt){const jt=u/24,Kt=_.lineOffsetX*jt,me=_.lineOffsetY*jt,{lineStartIndex:re,glyphStartIndex:Ae,numGlyphs:He,segment:je,writingMode:De,flipState:An}=_,Fe=re+_.lineLength,fn=Je=>{if(et){const[zn,Ne,$e]=Je.up,ri=it.length;r.updateGlobeVertexNormal(et,ri+0,zn,Ne,$e),r.updateGlobeVertexNormal(et,ri+1,zn,Ne,$e),r.updateGlobeVertexNormal(et,ri+2,zn,Ne,$e),r.updateGlobeVertexNormal(et,ri+3,zn,Ne,$e)}const[Ln,tn,xn]=Je.point;r.addDynamicAttributes(it,Ln,tn,xn,Je.angle)};if(He>1){const Je=Si(jt,G,Kt,me,f,_t,Mt,_,W,S,Bt,Gt,!1,Pt,Ot,Wt);if(!Je)return{notEnoughRoom:!0};if(y&&!f){let[Ln,tn,xn]=Je.first.point,[zn,Ne,$e]=Je.last.point;[Ln,tn]=Co(Ln,tn,xn,B),[zn,Ne]=Co(zn,Ne,$e,B);const ri=Tr(De,An,(zn-Ln)*Ft,Ne-tn);if(_.flipState=ri&&ri.needsFlipping?1:2,ri)return ri}fn(Je.first);for(let Ln=Ae+1;Ln<Ae+He-1;Ln++){const tn=Yo(jt*G.getoffsetX(Ln),Kt,me,f,_t,Mt,je,re,Fe,W,S,Bt,Gt,!1,!1,Pt,Ot,Wt);if(!tn)return it.length-=4*(Ln-Ae),{notEnoughRoom:!0};fn(tn)}fn(Je.last)}else{if(y&&!f){const Ln=Co(Mt.x,Mt.y,0,A),tn=re+je+1,xn=new r.pointGeometry(W.getx(tn),W.gety(tn)),zn=Co(xn.x,xn.y,0,A),Ne=zn[3]>0?zn:oo(Mt,xn,Ln,1,A,void 0,Pt,Ot.canonical),$e=Tr(De,An,(Ne[0]-Ln[0])*Ft,Ne[1]-Ln[1]);if(_.flipState=$e&&$e.needsFlipping?1:2,$e)return $e}const Je=Yo(jt*G.getoffsetX(Ae),Kt,me,f,_t,Mt,je,re,Fe,W,S,Bt,Gt,!1,!1,Pt,Ot,Wt);if(!Je)return{notEnoughRoom:!0};fn(Je)}return{}}function Ma(_,u,f,y,A){const{x:S,y:B,z:G}=y.projectTilePoint(_.x,_.y,u);if(!A)return Co(S,B,G,f);const[W,it,et]=A(_);return Co(S+W,B+it,G+et,f)}function oo(_,u,f,y,A,S,B,G){const W=Ma(_.sub(u)._unit()._add(_),G,A,B,S);return r.sub(W,f,W),r.normalize(W,W),r.scaleAndAdd(W,f,W,y)}function Yo(_,u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt,Pt,Ot){const Wt=y?_-u:_+u;let jt=Wt>0?1:-1,Kt=0;y&&(jt*=-1,Kt=Math.PI),jt<0&&(Kt+=Math.PI);let me=G+B+(jt>0?0:1)|0,re=A,Ae=A,He=0,je=0;const De=Math.abs(Wt),An=[],Fe=[];let fn=S,Je=fn;const Ln=()=>oo(Je,fn,Ae,De-He+1,et,Mt,Gt,Pt.canonical);for(;He+je<=De;){if(me+=jt,me<G||me>=W)return null;if(Ae=re,Je=fn,An.push(Ae),Bt&&Fe.push(Je),fn=new r.pointGeometry(it.getx(me),it.gety(me)),re=_t[me],!re){const Li=Ma(fn,Pt.canonical,et,Gt,Mt);re=Li[3]>0?_t[me]=Li:Ln()}He+=je,je=r.distance(Ae,re)}Ft&&Mt&&(_t[me]&&(re=Ln(),je=r.distance(Ae,re)),_t[me]=re);const tn=(De-He)/je,xn=fn.sub(Je)._mult(tn)._add(Je),zn=r.sub([],re,Ae),Ne=r.scaleAndAdd([],Ae,zn,tn);let $e=[0,0,1],ri=zn[0],fi=zn[1];if(Ot&&($e=Gt.upVector(Pt.canonical,xn.x,xn.y),$e[0]!==0||$e[1]!==0||$e[2]!==1)){const Li=[$e[2],0,-$e[0]],Ki=r.cross([],$e,Li);r.normalize(Li,Li),r.normalize(Ki,Ki),ri=r.dot(zn,Li),fi=r.dot(zn,Ki)}if(f){const Li=r.cross([],$e,zn);r.normalize(Li,Li),r.scaleAndAdd(Ne,Ne,Li,f*jt)}const oi=Kt+Math.atan2(fi,ri);return An.push(Ne),Bt&&Fe.push(xn),{point:Ne,angle:oi,path:An,tilePath:Fe,up:$e}}function Nr(_,u){const f=u.length,y=f+4*_;u.resize(y),u.float32.fill(-1/0,4*f,4*y)}function nr(_,u,f){const y=u[0],A=u[1];return _[0]=f[0]*y+f[4]*A+f[12],_[1]=f[1]*y+f[5]*A+f[13],_[3]=f[3]*y+f[7]*A+f[15],_}const ir=100;class es{constructor(u,f,y=new ro(u.width+200,u.height+200,25),A=new ro(u.width+200,u.height+200,25)){this.transform=u,this.grid=y,this.ignoredGrid=A,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+ir,this.screenBottomBoundary=u.height+ir,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.fogState=f}placeCollisionBox(u,f,y,A,S,B,G,W){let it=y.projectedAnchorX,et=y.projectedAnchorY,_t=y.projectedAnchorZ;const Mt=y.elevation,Bt=y.tileID,Ft=u.getProjection();if(Mt&&Bt){const[re,Ae,He]=Ft.upVector(Bt.canonical,y.tileAnchorX,y.tileAnchorY),je=Ft.upVectorScale(Bt.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;it+=re*Mt*je,et+=Ae*Mt*je,_t+=He*Mt*je}const Gt=this.projectAndGetPerspectiveRatio(G,it,et,_t,y.tileID,Ft.name==="globe"||!!Mt||this.transform.pitch>0,Ft),Pt=B*Gt.perspectiveRatio,Ot=(y.x1*f+A.x-y.padding)*Pt+Gt.point.x,Wt=(y.y1*f+A.y-y.padding)*Pt+Gt.point.y,jt=(y.x2*f+A.x+y.padding)*Pt+Gt.point.x,Kt=(y.y2*f+A.y+y.padding)*Pt+Gt.point.y,me=Gt.perspectiveRatio<=.55||Gt.occluded;return!this.isInsideGrid(Ot,Wt,jt,Kt)||!S&&this.grid.hitTest(Ot,Wt,jt,Kt,W)||me?{box:[],offscreen:!1,occluded:Gt.occluded}:{box:[Ot,Wt,jt,Kt],offscreen:this.isOffscreen(Ot,Wt,jt,Kt),occluded:!1}}placeCollisionCircles(u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt){const Pt=[],Ot=this.transform.elevation,Wt=u.getProjection(),jt=Ot?Ot.getAtTileOffsetFunc(Gt,this.transform.center.lat,this.transform.worldSize,Wt):null,Kt=new r.pointGeometry(y.tileAnchorX,y.tileAnchorY);let{x:me,y:re,z:Ae}=Wt.projectTilePoint(Kt.x,Kt.y,Gt.canonical);if(jt){const[xn,zn,Ne]=jt(Kt);me+=xn,re+=zn,Ae+=Ne}const He=Wt.name==="globe",je=this.projectAndGetPerspectiveRatio(G,me,re,Ae,Gt,He||!!Ot||this.transform.pitch>0,Wt),{perspectiveRatio:De}=je,An=(_t?B/De:B*De)/r.ONE_EM,Fe=Co(me,re,Ae,W),fn=je.signedDistanceFromCamera>0?Si(An,S,y.lineOffsetX*An,y.lineOffsetY*An,!1,Fe,Kt,y,A,W,{},Ot&&!_t?jt:null,_t&&!!Ot,Wt,Gt,_t):null;let Je=!1,Ln=!1,tn=!0;if(fn&&!je.occluded){const xn=.5*Bt*De+Ft,zn=new r.pointGeometry(-100,-100),Ne=new r.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),$e=new Xr,{first:ri,last:fi}=fn,oi=ri.path.length;let Li=[];for(let Kn=oi-1;Kn>=1;Kn--)Li.push(ri.path[Kn]);for(let Kn=1;Kn<fi.path.length;Kn++)Li.push(fi.path[Kn]);const Ki=2.5*xn;it&&(Li=Li.map(([Kn,Hr,Dr],to)=>(jt&&!He&&(Dr=jt(to<oi-1?ri.tilePath[oi-1-to]:fi.tilePath[to-oi+2])[2]),Co(Kn,Hr,Dr,it))),Li.some(Kn=>Kn[3]<=0)&&(Li=[]));let gi=[];if(Li.length>0){let Kn=1/0,Hr=-1/0,Dr=1/0,to=-1/0;for(const Wr of Li)Kn=Math.min(Kn,Wr[0]),Dr=Math.min(Dr,Wr[1]),Hr=Math.max(Hr,Wr[0]),to=Math.max(to,Wr[1]);Hr>=zn.x&&Kn<=Ne.x&&to>=zn.y&&Dr<=Ne.y&&(gi=[Li.map(Wr=>new r.pointGeometry(Wr[0],Wr[1]))],(Kn<zn.x||Hr>Ne.x||Dr<zn.y||to>Ne.y)&&(gi=r.clipLine(gi,zn.x,zn.y,Ne.x,Ne.y)))}for(const Kn of gi){$e.reset(Kn,.25*xn);let Hr=0;Hr=$e.length<=.5*xn?1:Math.ceil($e.paddedLength/Ki)+1;for(let Dr=0;Dr<Hr;Dr++){const to=Dr/Math.max(Hr-1,1),Wr=$e.lerp(to),qa=Wr.x+ir,Ra=Wr.y+ir;Pt.push(qa,Ra,xn,0);const va=qa-xn,ru=Ra-xn,mo=qa+xn,Yr=Ra+xn;if(tn=tn&&this.isOffscreen(va,ru,mo,Yr),Ln=Ln||this.isInsideGrid(va,ru,mo,Yr),!f&&this.grid.hitTestCircle(qa,Ra,xn,Mt)&&(Je=!0,!et))return{circles:[],offscreen:!1,collisionDetected:Je,occluded:!1}}}}return{circles:!et&&Je||!Ln?[]:Pt,offscreen:tn,collisionDetected:Je,occluded:je.occluded}}queryRenderedSymbols(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let y=1/0,A=1/0,S=-1/0,B=-1/0;for(const et of u){const _t=new r.pointGeometry(et.x+ir,et.y+ir);y=Math.min(y,_t.x),A=Math.min(A,_t.y),S=Math.max(S,_t.x),B=Math.max(B,_t.y),f.push(_t)}const G=this.grid.query(y,A,S,B).concat(this.ignoredGrid.query(y,A,S,B)),W={},it={};for(const et of G){const _t=et.key;if(W[_t.bucketInstanceId]===void 0&&(W[_t.bucketInstanceId]={}),W[_t.bucketInstanceId][_t.featureIndex])continue;const Mt=[new r.pointGeometry(et.x1,et.y1),new r.pointGeometry(et.x2,et.y1),new r.pointGeometry(et.x2,et.y2),new r.pointGeometry(et.x1,et.y2)];r.polygonIntersectsPolygon(f,Mt)&&(W[_t.bucketInstanceId][_t.featureIndex]=!0,it[_t.bucketInstanceId]===void 0&&(it[_t.bucketInstanceId]=[]),it[_t.bucketInstanceId].push(_t.featureIndex))}return it}insertCollisionBox(u,f,y,A,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:A,collisionGroupID:S},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,f,y,A,S){const B=f?this.ignoredGrid:this.grid,G={bucketInstanceId:y,featureIndex:A,collisionGroupID:S};for(let W=0;W<u.length;W+=4)B.insertCircle(G,u[W],u[W+1],u[W+2])}projectAndGetPerspectiveRatio(u,f,y,A,S,B,G){const W=[f,y,A,1];let it=!1;if(A||this.transform.pitch>0){r.transformMat4$1(W,W,u);const _t=G.name==="globe";this.fogState&&S&&!_t&&(it=function(Bt,Ft,Gt,Pt,Ot,Wt){const jt=Wt.calculateFogTileMatrix(Ot),Kt=[Ft,Gt,Pt];return r.transformMat4(Kt,Kt,jt),_e(Bt,Kt,Wt.pitch,Wt._fov)}(this.fogState,f,y,A,S.toUnwrapped(),this.transform)>.9)}else nr(W,W,u);const et=W[3];return{point:new r.pointGeometry((W[0]/et+1)/2*this.transform.width+ir,(-W[1]/et+1)/2*this.transform.height+ir),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(G)/et*.5,1.5),signedDistanceFromCamera:et,occluded:B&&W[2]>et||it}}isOffscreen(u,f,y,A){return y<ir||u>=this.screenRightBoundary||A<ir||f>this.screenBottomBoundary}isInsideGrid(u,f,y,A){return y>=0&&u<this.gridRightBoundary&&A>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const u=r.identity([]);return r.translate(u,u,[-100,-100,0]),u}}function ns(_,u,f){const y=u.createTileMatrix(_,_.worldSize,f.toUnwrapped());return r.multiply(new Float32Array(16),_.projMatrix,y)}function is(_,u,f){if(u.projection.name===f.projection.name)return _.projMatrix;const y=f.clone();return y.setProjection(u.projection),ns(y,u.getProjection(),_)}function da(_,u,f){return u.name===f.projection.name?_.projMatrix:ns(f,u,_)}class zo{constructor(u,f,y,A){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?f:-f))):A&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Ks{constructor(u,f,y,A,S,B=!1){this.text=new zo(u?u.text:null,f,y,S),this.icon=new zo(u?u.icon:null,f,A,S),this.clipped=B}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Us{constructor(u,f,y,A=!1){this.text=u,this.icon=f,this.skipFade=y,this.clipped=A}}class La{constructor(){this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.circles=[]}}class fl{constructor(u,f,y,A,S){this.bucketInstanceId=u,this.featureIndex=f,this.sourceLayerIndex=y,this.bucketIndex=A,this.tileID=S}}class Zo{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const f=++this.maxGroupID;this.collisionGroups[u]={ID:f,predicate:y=>y.collisionGroupID===f}}return this.collisionGroups[u]}}function Zr(_,u,f,y,A){const{horizontalAlign:S,verticalAlign:B}=r.getAnchorAlignment(_),G=-(S-.5)*u,W=-(B-.5)*f,it=r.evaluateVariableOffset(_,y);return new r.pointGeometry(G+it[0]*A,W+it[1]*A)}function Qs(_,u,f,y,A){const S=new r.pointGeometry(_,u);return f&&S._rotate(y?A:-A),S}class Hl{constructor(u,f,y,A,S){this.transform=u.clone(),this.projection=u.projection.name,this.collisionIndex=new es(this.transform,S),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Zo(y),this.collisionCircleArrays={},this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(u,f,y,A){const S=y.getBucket(f),B=y.latestFeatureIndex;if(!S||!B||f.id!==S.layerIds[0])return;const G=S.layers[0].layout,W=y.collisionBoxArray,it=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),et=y.tileSize/r.EXTENT,_t=y.tileID.toUnwrapped();this.transform.setProjection(S.projection);const Mt=(Bt=y.tileID,Ft=S.getProjection(),Gt=this.transform,Ft.name===this.projection?Gt.calculateProjMatrix(Bt.toUnwrapped()):ns(Gt,Ft,Bt));var Bt,Ft,Gt;const Pt=G.get("text-pitch-alignment")==="map",Ot=G.get("text-rotation-alignment")==="map";f.compileFilter();const Wt=f.dynamicFilter(),jt=f.dynamicFilterNeedsFeature(),Kt=this.transform.calculatePixelsToTileUnitsMatrix(y),me=cr(Mt,y.tileID.canonical,Pt,Ot,this.transform,S.getProjection(),Kt);let re=null;if(Pt){const je=Kr(Mt,y.tileID.canonical,Pt,Ot,this.transform,S.getProjection(),Kt);re=r.multiply([],this.transform.labelPlaneMatrix,je)}let Ae=null;Wt&&y.latestFeatureIndex&&(Ae={unwrappedTileID:_t,dynamicFilter:Wt,dynamicFilterNeedsFeature:jt,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[S.bucketInstanceId]=new fl(S.bucketInstanceId,B,S.sourceLayerIndex,S.index,y.tileID);const He={bucket:S,layout:G,posMatrix:Mt,textLabelPlaneMatrix:me,labelToScreenMatrix:re,clippingData:Ae,scale:it,textPixelRatio:et,holdingForFade:y.holdingForFade(),collisionBoxArray:W,partiallyEvaluatedTextSize:r.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:r.evaluateSizeForZoom(S.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(A)for(const je of S.sortKeyRanges){const{sortKey:De,symbolInstanceStart:An,symbolInstanceEnd:Fe}=je;u.push({sortKey:De,symbolInstanceStart:An,symbolInstanceEnd:Fe,parameters:He})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:He})}attemptAnchorPlacement(u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt,Pt,Ot,Wt){const{textOffset0:jt,textOffset1:Kt,crossTileID:me}=Mt,re=[jt,Kt],Ae=Zr(u,y,A,re,S),He=this.collisionIndex.placeCollisionBox(Ft,S,f,Qs(Ae.x,Ae.y,B,G,this.transform.angle),_t,W,it,et.predicate);if(Pt){const je=Ft.getSymbolInstanceIconSize(Wt,this.transform.zoom,Mt.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Ft,je,Pt,Qs(Ae.x,Ae.y,B,G,this.transform.angle),_t,W,it,et.predicate).box.length===0)return}if(He.box.length>0){let je;return this.prevPlacement&&this.prevPlacement.variableOffsets[me]&&this.prevPlacement.placements[me]&&this.prevPlacement.placements[me].text&&(je=this.prevPlacement.variableOffsets[me].anchor),this.variableOffsets[me]={textOffset:re,width:y,height:A,anchor:u,textScale:S,prevAnchor:je},this.markUsedJustification(Ft,u,Mt,Gt),Ft.allowVerticalPlacement&&(this.markUsedOrientation(Ft,Gt,Mt),this.placedOrientations[me]=Gt),{shift:Ae,placedGlyphBoxes:He}}}placeLayerBucketPart(u,f,y,A){const{bucket:S,layout:B,posMatrix:G,textLabelPlaneMatrix:W,labelToScreenMatrix:it,clippingData:et,textPixelRatio:_t,holdingForFade:Mt,collisionBoxArray:Bt,partiallyEvaluatedTextSize:Ft,partiallyEvaluatedIconSize:Gt,collisionGroup:Pt}=u.parameters,Ot=B.get("text-optional"),Wt=B.get("icon-optional"),jt=B.get("text-allow-overlap"),Kt=B.get("icon-allow-overlap"),me=B.get("text-rotation-alignment")==="map",re=B.get("text-pitch-alignment")==="map",Ae=B.get("icon-text-fit")!=="none",He=B.get("symbol-z-order")==="viewport-y";this.transform.setProjection(S.projection);let je=jt&&(Kt||!S.hasIconData()||Wt),De=Kt&&(jt||!S.hasTextData()||Ot);!S.collisionArrays&&Bt&&S.deserializeCollisionBoxes(Bt),y&&A&&S.updateCollisionDebugBuffers(this.transform.zoom,Bt);const An=(Fe,fn,Je)=>{const{crossTileID:Ln,numVerticalGlyphVertices:tn}=Fe;if(et){const mo={zoom:this.transform.zoom,pitch:this.transform.pitch};let Yr=null;if(et.dynamicFilterNeedsFeature){const kr=this.retainedQueryData[S.bucketInstanceId];Yr=et.featureIndex.loadFeature({featureIndex:Fe.featureIndex,bucketIndex:kr.bucketIndex,sourceLayerIndex:kr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,et.dynamicFilter)(mo,Yr,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new r.pointGeometry(Fe.tileAnchorX,Fe.tileAnchorY),this.transform.calculateDistanceTileData(et.unwrappedTileID)))return this.placements[Ln]=new Us(!1,!1,!1,!0),void(f[Ln]=!0)}if(f[Ln])return;if(Mt)return void(this.placements[Ln]=new Us(!1,!1,!1));let xn=!1,zn=!1,Ne=!0,$e=!1,ri=!1,fi=null,oi={box:null,offscreen:null,occluded:null},Li={box:null,offscreen:null,occluded:null},Ki=null,gi=null,Kn=null,Hr=0,Dr=0,to=0;Je.textFeatureIndex?Hr=Je.textFeatureIndex:Fe.useRuntimeCollisionCircles&&(Hr=Fe.featureIndex),Je.verticalTextFeatureIndex&&(Dr=Je.verticalTextFeatureIndex);const Wr=mo=>{mo.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const Yr=this.transform.elevation;(Yr||mo.elevation)&&(mo.elevation=Yr?Yr.getAtTileOffset(mo.tileID,mo.tileAnchorX,mo.tileAnchorY):0)},qa=Je.textBox;if(qa){Wr(qa);const mo=kr=>{let Ho=r.WritingMode.horizontal;if(S.allowVerticalPlacement&&!kr&&this.prevPlacement){const sa=this.prevPlacement.placedOrientations[Ln];sa&&(this.placedOrientations[Ln]=sa,Ho=sa,this.markUsedOrientation(S,Ho,Fe))}return Ho},Yr=(kr,Ho)=>{if(S.allowVerticalPlacement&&tn>0&&Je.verticalTextBox){for(const sa of S.writingModes)if(sa===r.WritingMode.vertical?(oi=Ho(),Li=oi):oi=kr(),oi&&oi.box&&oi.box.length)break}else oi=kr()};if(B.get("text-variable-anchor")){let kr=B.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ln]){const go=this.prevPlacement.variableOffsets[Ln];kr.indexOf(go.anchor)>0&&(kr=kr.filter(ya=>ya!==go.anchor),kr.unshift(go.anchor))}const Ho=(go,ya,Zh)=>{const ou=S.getSymbolInstanceTextSize(Ft,Fe,this.transform.zoom,fn),aa=(go.x2-go.x1)*ou+2*go.padding,Ja=(go.y2-go.y1)*ou+2*go.padding,Au=Ae&&!Kt?ya:null;Au&&Wr(Au);let Nl={box:[],offscreen:!1,occluded:!1};const ar=jt?2*kr.length:kr.length;for(let mh=0;mh<ar;++mh){const Tu=this.attemptAnchorPlacement(kr[mh%kr.length],go,aa,Ja,ou,me,re,_t,G,Pt,mh>=kr.length,Fe,fn,S,Zh,Au,Ft,Gt);if(Tu&&(Nl=Tu.placedGlyphBoxes,Nl&&Nl.box&&Nl.box.length)){xn=!0,fi=Tu.shift;break}}return Nl};Yr(()=>Ho(qa,Je.iconBox,r.WritingMode.horizontal),()=>{const go=Je.verticalTextBox;return go&&Wr(go),S.allowVerticalPlacement&&!(oi&&oi.box&&oi.box.length)&&tn>0&&go?Ho(go,Je.verticalIconBox,r.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),oi&&(xn=oi.box,Ne=oi.offscreen,$e=oi.occluded);const sa=mo(oi&&oi.box);if(!xn&&this.prevPlacement){const go=this.prevPlacement.variableOffsets[Ln];go&&(this.variableOffsets[Ln]=go,this.markUsedJustification(S,go.anchor,Fe,sa))}}else{const kr=(Ho,sa)=>{const go=S.getSymbolInstanceTextSize(Ft,Fe,this.transform.zoom,fn),ya=this.collisionIndex.placeCollisionBox(S,go,Ho,new r.pointGeometry(0,0),jt,_t,G,Pt.predicate);return ya&&ya.box&&ya.box.length&&(this.markUsedOrientation(S,sa,Fe),this.placedOrientations[Ln]=sa),ya};Yr(()=>kr(qa,r.WritingMode.horizontal),()=>{const Ho=Je.verticalTextBox;return S.allowVerticalPlacement&&tn>0&&Ho?(Wr(Ho),kr(Ho,r.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),mo(oi&&oi.box&&oi.box.length)}}if(Ki=oi,xn=Ki&&Ki.box&&Ki.box.length>0,Ne=Ki&&Ki.offscreen,$e=Ki&&Ki.occluded,Fe.useRuntimeCollisionCircles){const mo=S.text.placedSymbolArray.get(Fe.centerJustifiedTextSymbolIndex>=0?Fe.centerJustifiedTextSymbolIndex:Fe.verticalPlacedTextSymbolIndex),Yr=r.evaluateSizeForFeature(S.textSizeData,Ft,mo),kr=B.get("text-padding");gi=this.collisionIndex.placeCollisionCircles(S,jt,mo,S.lineVertexArray,S.glyphOffsetArray,Yr,G,W,it,y,re,Pt.predicate,Fe.collisionCircleDiameter*Yr/r.ONE_EM,kr,this.retainedQueryData[S.bucketInstanceId].tileID),xn=jt||gi.circles.length>0&&!gi.collisionDetected,Ne=Ne&&gi.offscreen,$e=gi.occluded}if(Je.iconFeatureIndex&&(to=Je.iconFeatureIndex),Je.iconBox){const mo=Yr=>{Wr(Yr);const kr=Ae&&fi?Qs(fi.x,fi.y,me,re,this.transform.angle):new r.pointGeometry(0,0),Ho=S.getSymbolInstanceIconSize(Gt,this.transform.zoom,Fe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,Ho,Yr,kr,Kt,_t,G,Pt.predicate)};Li&&Li.box&&Li.box.length&&Je.verticalIconBox?(Kn=mo(Je.verticalIconBox),zn=Kn.box.length>0):(Kn=mo(Je.iconBox),zn=Kn.box.length>0),Ne=Ne&&Kn.offscreen,ri=Kn.occluded}const Ra=Ot||Fe.numHorizontalGlyphVertices===0&&tn===0,va=Wt||Fe.numIconVertices===0;if(Ra||va?va?Ra||(zn=zn&&xn):xn=zn&&xn:zn=xn=zn&&xn,xn&&Ki&&Ki.box&&this.collisionIndex.insertCollisionBox(Ki.box,B.get("text-ignore-placement"),S.bucketInstanceId,Li&&Li.box&&Dr?Dr:Hr,Pt.ID),zn&&Kn&&this.collisionIndex.insertCollisionBox(Kn.box,B.get("icon-ignore-placement"),S.bucketInstanceId,to,Pt.ID),gi&&(xn&&this.collisionIndex.insertCollisionCircles(gi.circles,B.get("text-ignore-placement"),S.bucketInstanceId,Hr,Pt.ID),y)){const mo=S.bucketInstanceId;let Yr=this.collisionCircleArrays[mo];Yr===void 0&&(Yr=this.collisionCircleArrays[mo]=new La);for(let kr=0;kr<gi.circles.length;kr+=4)Yr.circles.push(gi.circles[kr+0]),Yr.circles.push(gi.circles[kr+1]),Yr.circles.push(gi.circles[kr+2]),Yr.circles.push(gi.collisionDetected?1:0)}const ru=S.projection.name!=="globe";je=je&&(ru||!$e),De=De&&(ru||!ri),this.placements[Ln]=new Us(xn||je,zn||De,Ne||S.justReloaded),f[Ln]=!0};if(He){const Fe=S.getSortedSymbolIndexes(this.transform.angle);for(let fn=Fe.length-1;fn>=0;--fn){const Je=Fe[fn];An(S.symbolInstances.get(Je),Je,S.collisionArrays[Je])}}else for(let Fe=u.symbolInstanceStart;Fe<u.symbolInstanceEnd;Fe++)An(S.symbolInstances.get(Fe),Fe,S.collisionArrays[Fe]);if(y&&S.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[S.bucketInstanceId];r.invert(Fe.invProjMatrix,G),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(u,f,y,A){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:B,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:W,crossTileID:it}=y,et=r.getAnchorJustification(f),_t=A===r.WritingMode.vertical?W:et==="left"?S:et==="center"?B:et==="right"?G:-1;S>=0&&(u.text.placedSymbolArray.get(S).crossTileID=_t>=0&&S!==_t?0:it),B>=0&&(u.text.placedSymbolArray.get(B).crossTileID=_t>=0&&B!==_t?0:it),G>=0&&(u.text.placedSymbolArray.get(G).crossTileID=_t>=0&&G!==_t?0:it),W>=0&&(u.text.placedSymbolArray.get(W).crossTileID=_t>=0&&W!==_t?0:it)}markUsedOrientation(u,f,y){const A=f===r.WritingMode.horizontal||f===r.WritingMode.horizontalOnly?f:0,S=f===r.WritingMode.vertical?f:0,{leftJustifiedTextSymbolIndex:B,centerJustifiedTextSymbolIndex:G,rightJustifiedTextSymbolIndex:W,verticalPlacedTextSymbolIndex:it}=y,et=u.text.placedSymbolArray;B>=0&&(et.get(B).placedOrientation=A),G>=0&&(et.get(G).placedOrientation=A),W>=0&&(et.get(W).placedOrientation=A),it>=0&&(et.get(it).placedOrientation=S)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let y=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const A=f?f.symbolFadeChange(u):1,S=f?f.opacities:{},B=f?f.variableOffsets:{},G=f?f.placedOrientations:{};for(const W in this.placements){const it=this.placements[W],et=S[W];et?(this.opacities[W]=new Ks(et,A,it.text,it.icon,null,it.clipped),y=y||it.text!==et.text.placed||it.icon!==et.icon.placed):(this.opacities[W]=new Ks(null,A,it.text,it.icon,it.skipFade,it.clipped),y=y||it.text||it.icon)}for(const W in S){const it=S[W];if(!this.opacities[W]){const et=new Ks(it,A,!1,!1);et.isHidden()||(this.opacities[W]=et,y=y||it.text.placed||it.icon.placed)}}for(const W in B)this.variableOffsets[W]||!this.opacities[W]||this.opacities[W].isHidden()||(this.variableOffsets[W]=B[W]);for(const W in G)this.placedOrientations[W]||!this.opacities[W]||this.opacities[W].isHidden()||(this.placedOrientations[W]=G[W]);y?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:u)}updateLayerOpacities(u,f){const y={};for(const A of f){const S=A.getBucket(u);S&&A.latestFeatureIndex&&u.id===S.layerIds[0]&&this.updateBucketOpacities(S,y,A.collisionBoxArray)}}updateBucketOpacities(u,f,y){u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const A=u.layers[0].layout,S=!!u.layers[0].dynamicFilter(),B=new Ks(null,0,!1,!1,!0),G=A.get("text-allow-overlap"),W=A.get("icon-allow-overlap"),it=A.get("text-variable-anchor"),et=A.get("text-rotation-alignment")==="map",_t=A.get("text-pitch-alignment")==="map",Mt=A.get("icon-text-fit")!=="none",Bt=new Ks(null,0,G&&(W||!u.hasIconData()||A.get("icon-optional")),W&&(G||!u.hasTextData()||A.get("text-optional")),!0);!u.collisionArrays&&y&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(y);const Ft=(Pt,Ot,Wt)=>{for(let jt=0;jt<Ot/4;jt++)Pt.opacityVertexArray.emplaceBack(Wt)};let Gt=0;for(let Pt=0;Pt<u.symbolInstances.length;Pt++){const Ot=u.symbolInstances.get(Pt),{numHorizontalGlyphVertices:Wt,numVerticalGlyphVertices:jt,crossTileID:Kt,numIconVertices:me}=Ot;let re=this.opacities[Kt];f[Kt]?re=B:re||(re=Bt,this.opacities[Kt]=re),f[Kt]=!0;const Ae=Wt>0||jt>0,He=me>0,je=this.placedOrientations[Kt],De=je===r.WritingMode.vertical,An=je===r.WritingMode.horizontal||je===r.WritingMode.horizontalOnly;if(!Ae&&!He||re.isHidden()||Gt++,Ae){const Fe=Or(re.text);Ft(u.text,Wt,De?na:Fe),Ft(u.text,jt,An?na:Fe);const fn=re.text.isHidden(),{leftJustifiedTextSymbolIndex:Je,centerJustifiedTextSymbolIndex:Ln,rightJustifiedTextSymbolIndex:tn,verticalPlacedTextSymbolIndex:xn}=Ot,zn=u.text.placedSymbolArray,Ne=fn||De?1:0;Je>=0&&(zn.get(Je).hidden=Ne),Ln>=0&&(zn.get(Ln).hidden=Ne),tn>=0&&(zn.get(tn).hidden=Ne),xn>=0&&(zn.get(xn).hidden=fn||An?1:0);const $e=this.variableOffsets[Kt];$e&&this.markUsedJustification(u,$e.anchor,Ot,je);const ri=this.placedOrientations[Kt];ri&&(this.markUsedJustification(u,"left",Ot,ri),this.markUsedOrientation(u,ri,Ot))}if(He){const Fe=Or(re.icon),{placedIconSymbolIndex:fn,verticalPlacedIconSymbolIndex:Je}=Ot,Ln=u.icon.placedSymbolArray,tn=re.icon.isHidden()?1:0;fn>=0&&(Ft(u.icon,me,De?na:Fe),Ln.get(fn).hidden=tn),Je>=0&&(Ft(u.icon,Ot.numVerticalIconVertices,An?na:Fe),Ln.get(Je).hidden=tn)}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const Fe=u.collisionArrays[Pt];if(Fe){let fn=new r.pointGeometry(0,0),Je=!0;if(Fe.textBox||Fe.verticalTextBox){if(it){const tn=this.variableOffsets[Kt];tn?(fn=Zr(tn.anchor,tn.width,tn.height,tn.textOffset,tn.textScale),et&&fn._rotate(_t?this.transform.angle:-this.transform.angle)):Je=!1}S&&(Je=!re.clipped),Fe.textBox&&Vo(u.textCollisionBox.collisionVertexArray,re.text.placed,!Je||De,fn.x,fn.y),Fe.verticalTextBox&&Vo(u.textCollisionBox.collisionVertexArray,re.text.placed,!Je||An,fn.x,fn.y)}const Ln=Je&&Boolean(!An&&Fe.verticalIconBox);Fe.iconBox&&Vo(u.iconCollisionBox.collisionVertexArray,re.icon.placed,Ln,Mt?fn.x:0,Mt?fn.y:0),Fe.verticalIconBox&&Vo(u.iconCollisionBox.collisionVertexArray,re.icon.placed,!Ln,Mt?fn.x:0,Mt?fn.y:0)}}}if(u.fullyClipped=Gt===0,u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){const Pt=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=Pt.invProjMatrix,u.placementViewportMatrix=Pt.viewportMatrix,u.collisionCircleArray=Pt.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}}symbolFadeChange(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,f){const y=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*y>u}setStale(){this.stale=!0}}function Vo(_,u,f,y,A){_.emplaceBack(u?1:0,f?1:0,y||0,A||0),_.emplaceBack(u?1:0,f?1:0,y||0,A||0),_.emplaceBack(u?1:0,f?1:0,y||0,A||0),_.emplaceBack(u?1:0,f?1:0,y||0,A||0)}const wi=Math.pow(2,25),ta=Math.pow(2,24),zr=Math.pow(2,17),Ao=Math.pow(2,16),ka=Math.pow(2,9),dl=Math.pow(2,8),ea=Math.pow(2,1);function Or(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const u=_.placed?1:0,f=Math.floor(127*_.opacity);return f*wi+u*ta+f*zr+u*Ao+f*ka+u*dl+f*ea+u}const na=0;class Ya{constructor(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&u.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(u,f,y,A,S){const B=this._bucketParts;for(;this._currentTileIndex<u.length;)if(f.getBucketParts(B,A,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,B.sort((G,W)=>G.sortKey-W.sortKey));this._currentPartIndex<B.length;){const G=B[this._currentPartIndex];if(f.placeLayerBucketPart(G,this._seenCrossTileIDs,y,G.symbolInstanceStart===0),this._currentPartIndex++,S())return!0}return!1}}class Ei{constructor(u,f,y,A,S,B,G,W){this.placement=new Hl(u,S,B,G,W),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=A,this._done=!1}isDone(){return this._done}continuePlacement(u,f,y){const A=r.exported.now(),S=()=>{const B=r.exported.now()-A;return!this._forceFullPlacement&&B>2};for(;this._currentPlacementIndex>=0;){const B=f[u[this._currentPlacementIndex]],G=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=G)&&(!B.maxzoom||B.maxzoom>G)){if(this._inProgressLayer||(this._inProgressLayer=new Ya(B)),this._inProgressLayer.continuePlacement(y[B.source],this.placement,this._showCollisionBoxes,B,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const rr=512/r.EXTENT/2;class pl{constructor(u,f,y){this.tileID=u,this.indexedSymbolInstances={},this.bucketInstanceId=y;for(let A=0;A<f.length;A++){const S=f.get(A),B=S.key;this.indexedSymbolInstances[B]||(this.indexedSymbolInstances[B]=[]),this.indexedSymbolInstances[B].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,u)})}}getScaledCoordinates(u,f){const y=rr/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*r.EXTENT+u.tileAnchorX)*y),y:Math.floor((f.canonical.y*r.EXTENT+u.tileAnchorY)*y)}}findMatches(u,f,y){const A=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let S=0;S<u.length;S++){const B=u.get(S);if(B.crossTileID)continue;const G=this.indexedSymbolInstances[B.key];if(!G)continue;const W=this.getScaledCoordinates(B,f);for(const it of G)if(Math.abs(it.coord.x-W.x)<=A&&Math.abs(it.coord.y-W.y)<=A&&!y[it.crossTileID]){y[it.crossTileID]=!0,B.crossTileID=it.crossTileID;break}}}}class pc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $l{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const f=Math.round((u-this.lng)/360);if(f!==0)for(const y in this.indexes){const A=this.indexes[y],S={};for(const B in A){const G=A[B];G.tileID=G.tileID.unwrapTo(G.tileID.wrap+f),S[G.tileID.key]=G}this.indexes[y]=S}this.lng=u}addBucket(u,f,y){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let S=0;S<f.symbolInstances.length;S++)f.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});const A=this.usedCrossTileIDs[u.overscaledZ];for(const S in this.indexes){const B=this.indexes[S];if(Number(S)>u.overscaledZ)for(const G in B){const W=B[G];W.tileID.isChildOf(u)&&W.findMatches(f.symbolInstances,u,A)}else{const G=B[u.scaledTo(Number(S)).key];G&&G.findMatches(f.symbolInstances,u,A)}}for(let S=0;S<f.symbolInstances.length;S++){const B=f.symbolInstances.get(S);B.crossTileID||(B.crossTileID=y.generate(),A[B.crossTileID]=!0)}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new pl(u,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(u,f){for(const y in f.indexedSymbolInstances)for(const A of f.indexedSymbolInstances[y])delete this.usedCrossTileIDs[u][A.crossTileID]}removeStaleBuckets(u){let f=!1;for(const y in this.indexes){const A=this.indexes[y];for(const S in A)u[A[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,A[S]),delete A[S],f=!0)}return f}}class Es{constructor(){this.layerIndexes={},this.crossTileIDs=new pc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,f,y,A){let S=this.layerIndexes[u.id];S===void 0&&(S=this.layerIndexes[u.id]=new $l);let B=!1;const G={};A.name!=="globe"&&S.handleWrapJump(y);for(const W of f){const it=W.getBucket(u);it&&u.id===it.layerIds[0]&&(it.bucketInstanceId||(it.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(W.tileID,it,this.crossTileIDs)&&(B=!0),G[it.bucketInstanceId]=!0)}return S.removeStaleBuckets(G)&&(B=!0),B}pruneUnusedLayers(u){const f={};u.forEach(y=>{f[y]=!0});for(const y in this.layerIndexes)f[y]||delete this.layerIndexes[y]}}const Pa=(_,u)=>r.emitValidationErrors(_,u&&u.filter(f=>f.identifier!=="source.canvas")),vt=r.pick(ti,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Lt=r.pick(ti,["setCenter","setZoom","setBearing","setPitch"]),$t={version:8,layers:[],sources:{}},oe={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class C extends r.Evented{constructor(u,f={}){super(),this.map=u,this.dispatcher=new Ee(pi(),this),this.imageManager=new de,this.imageManager.setEventedParent(this),this.glyphManager=new r.GlyphManager(u._requestManager,f.localFontFamily?r.LocalGlyphMode.all:f.localIdeographFontFamily?r.LocalGlyphMode.ideographs:r.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.crossTileSymbolIndex=new Es,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.getReferrer());const y=this;this._rtlTextPluginCallback=C.registerForPluginStateChange(A=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:A.pluginStatus,pluginURL:A.pluginURL},(S,B)=>{if(r.triggerPluginCompletionEvent(S),B&&B.every(G=>G))for(const G in y._sourceCaches){const W=y._sourceCaches[G],it=W.getSource().type;it!=="vector"&&it!=="geojson"||W.reload()}})}),this.on("data",A=>{if(A.dataType!=="source"||A.sourceDataType!=="metadata")return;const S=this.getSource(A.sourceId);if(S&&S.vectorLayerIds)for(const B in this._layers){const G=this._layers[B];G.source===S.id&&this._validateLayer(G)}})}loadURL(u,f={}){this.fire(new r.Event("dataloading",{dataType:"style"}));const y=typeof f.validate=="boolean"?f.validate:!r.isMapboxURL(u);u=this.map._requestManager.normalizeStyleURL(u,f.accessToken);const A=this.map._requestManager.transformRequest(u,r.ResourceType.Style);this._request=r.getJSON(A,(S,B)=>{this._request=null,S?this.fire(new r.ErrorEvent(S)):B&&this._load(B,y)})}loadJSON(u,f={}){this.fire(new r.Event("dataloading",{dataType:"style"})),this._request=r.exported.frame(()=>{this._request=null,this._load(u,f.validate!==!1)})}loadEmpty(){this.fire(new r.Event("dataloading",{dataType:"style"})),this._load($t,!1)}_updateLayerCount(u,f){const y=f?1:-1;u.is3D()&&(this._num3DLayers+=y),u.type==="circle"&&(this._numCircleLayers+=y),u.type==="symbol"&&(this._numSymbolLayers+=y)}_load(u,f){if(f&&Pa(this,r.validateStyle(u)))return;this._loaded=!0,this.stylesheet=r.clone$1(u),this._updateMapProjection();for(const A in u.sources)this.addSource(A,u.sources[A],{validate:!1});this._changed=!1,u.sprite?this._loadSprite(u.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(u.glyphs);const y=ur(this.stylesheet.layers);this._order=y.map(A=>A.id),this._layers={},this._serializedLayers={};for(let A of y)A=r.createStyleLayer(A),A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ht(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new r.Event("data",{dataType:"style"})),this.fire(new r.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(u){u?this.stylesheet.projection=u:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(u){this._spriteRequest=function(f,y,A){let S,B,G;const W=r.exported.devicePixelRatio>1?"@2x":"";let it=r.getJSON(y.transformRequest(y.normalizeSpriteURL(f,W,".json"),r.ResourceType.SpriteJSON),(Mt,Bt)=>{it=null,G||(G=Mt,S=Bt,_t())}),et=r.getImage(y.transformRequest(y.normalizeSpriteURL(f,W,".png"),r.ResourceType.SpriteImage),(Mt,Bt)=>{et=null,G||(G=Mt,B=Bt,_t())});function _t(){if(G)A(G);else if(S&&B){const Mt=r.exported.getImageData(B),Bt={};for(const Ft in S){const{width:Gt,height:Pt,x:Ot,y:Wt,sdf:jt,pixelRatio:Kt,stretchX:me,stretchY:re,content:Ae}=S[Ft],He=new r.RGBAImage({width:Gt,height:Pt});r.RGBAImage.copy(Mt,He,{x:Ot,y:Wt},{x:0,y:0},{width:Gt,height:Pt}),Bt[Ft]={data:He,pixelRatio:Kt,sdf:jt,stretchX:me,stretchY:re,content:Ae}}A(null,Bt)}}return{cancel(){it&&(it.cancel(),it=null),et&&(et.cancel(),et=null)}}}(u,this.map._requestManager,(f,y)=>{if(this._spriteRequest=null,f)this.fire(new r.ErrorEvent(f));else if(y)for(const A in y)this.imageManager.addImage(A,y[A]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new r.Event("data",{dataType:"style"}))})}_validateLayer(u){const f=this.getSource(u.source);if(!f)return;const y=u.sourceLayer;y&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(y)===-1)&&this.fire(new r.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${f.id}" as specified by style layer "${u.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const u in this._sourceCaches)if(!this._sourceCaches[u].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(u){const f=[];for(const y of u){const A=this._layers[y];A.type!=="custom"&&f.push(A.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const u in this._sourceCaches)if(this._sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(u){return!!this.terrain&&oe[u.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(u){if(!this._loaded)return;const f=this._changed;if(this._changed){const A=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(A.length||S.length)&&this._updateWorkerLayers(A,S);for(const B in this._updatedSources){const G=this._updatedSources[B];G==="reload"?this._reloadSource(B):G==="clear"&&this._clearSource(B)}this._updateTilesForChangedImages();for(const B in this._updatedPaintProps)this._layers[B].updateTransitions(u);this.light.updateTransitions(u),this.fog&&this.fog.updateTransitions(u),this._resetUpdates()}const y={};for(const A in this._sourceCaches){const S=this._sourceCaches[A];y[A]=S.used,S.used=!1}for(const A of this._order){const S=this._layers[A];if(S.recalculate(u,this._availableImages),!S.isHidden(u.zoom)){const G=this._getLayerSourceCache(S);G&&(G.used=!0)}const B=this.map.painter;if(B){const G=S.getProgramIds();if(!G)continue;const W=S.getProgramConfiguration(u.zoom);for(const it of G)B.useProgram(it,W)}}for(const A in y){const S=this._sourceCaches[A];y[A]!==S.used&&S.getSource().fire(new r.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:S.getSource().id}))}this.light.recalculate(u),this.terrain&&this.terrain.recalculate(u),this.fog&&this.fog.recalculate(u),this.z=u.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new r.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=Object.keys(this._changedImages);if(u.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],u);this._changedImages={}}}_updateWorkerLayers(u,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(u),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(u){if(this._checkLoaded(),Pa(this,r.validateStyle(u)))return!1;(u=r.clone$1(u)).layers=ur(u.layers);const f=function(A,S){if(!A)return[{command:ti.setStyle,args:[S]}];let B=[];try{if(!w(A.version,S.version))return[{command:ti.setStyle,args:[S]}];w(A.center,S.center)||B.push({command:ti.setCenter,args:[S.center]}),w(A.zoom,S.zoom)||B.push({command:ti.setZoom,args:[S.zoom]}),w(A.bearing,S.bearing)||B.push({command:ti.setBearing,args:[S.bearing]}),w(A.pitch,S.pitch)||B.push({command:ti.setPitch,args:[S.pitch]}),w(A.sprite,S.sprite)||B.push({command:ti.setSprite,args:[S.sprite]}),w(A.glyphs,S.glyphs)||B.push({command:ti.setGlyphs,args:[S.glyphs]}),w(A.transition,S.transition)||B.push({command:ti.setTransition,args:[S.transition]}),w(A.light,S.light)||B.push({command:ti.setLight,args:[S.light]}),w(A.fog,S.fog)||B.push({command:ti.setFog,args:[S.fog]}),w(A.projection,S.projection)||B.push({command:ti.setProjection,args:[S.projection]});const G={},W=[];(function(_t,Mt,Bt,Ft){let Gt;for(Gt in Mt=Mt||{},_t=_t||{})_t.hasOwnProperty(Gt)&&(Mt.hasOwnProperty(Gt)||xr(Gt,Bt,Ft));for(Gt in Mt)Mt.hasOwnProperty(Gt)&&(_t.hasOwnProperty(Gt)?w(_t[Gt],Mt[Gt])||(_t[Gt].type==="geojson"&&Mt[Gt].type==="geojson"&&Ss(_t,Mt,Gt)?Bt.push({command:ti.setGeoJSONSourceData,args:[Gt,Mt[Gt].data]}):Js(Gt,Mt,Bt,Ft)):yr(Gt,Mt,Bt))})(A.sources,S.sources,W,G);const it=[];A.layers&&A.layers.forEach(_t=>{_t.source&&G[_t.source]?B.push({command:ti.removeLayer,args:[_t.id]}):it.push(_t)});let et=A.terrain;et&&G[et.source]&&(B.push({command:ti.setTerrain,args:[void 0]}),et=void 0),B=B.concat(W),w(et,S.terrain)||B.push({command:ti.setTerrain,args:[S.terrain]}),function(_t,Mt,Bt){Mt=Mt||[];const Ft=(_t=_t||[]).map(Ke),Gt=Mt.map(Ke),Pt=_t.reduce(Po,{}),Ot=Mt.reduce(Po,{}),Wt=Ft.slice(),jt=Object.create(null);let Kt,me,re,Ae,He,je,De;for(Kt=0,me=0;Kt<Ft.length;Kt++)re=Ft[Kt],Ot.hasOwnProperty(re)?me++:(Bt.push({command:ti.removeLayer,args:[re]}),Wt.splice(Wt.indexOf(re,me),1));for(Kt=0,me=0;Kt<Gt.length;Kt++)re=Gt[Gt.length-1-Kt],Wt[Wt.length-1-Kt]!==re&&(Pt.hasOwnProperty(re)?(Bt.push({command:ti.removeLayer,args:[re]}),Wt.splice(Wt.lastIndexOf(re,Wt.length-me),1)):me++,je=Wt[Wt.length-Kt],Bt.push({command:ti.addLayer,args:[Ot[re],je]}),Wt.splice(Wt.length-Kt,0,re),jt[re]=!0);for(Kt=0;Kt<Gt.length;Kt++)if(re=Gt[Kt],Ae=Pt[re],He=Ot[re],!jt[re]&&!w(Ae,He))if(w(Ae.source,He.source)&&w(Ae["source-layer"],He["source-layer"])&&w(Ae.type,He.type)){for(De in vs(Ae.layout,He.layout,Bt,re,null,ti.setLayoutProperty),vs(Ae.paint,He.paint,Bt,re,null,ti.setPaintProperty),w(Ae.filter,He.filter)||Bt.push({command:ti.setFilter,args:[re,He.filter]}),w(Ae.minzoom,He.minzoom)&&w(Ae.maxzoom,He.maxzoom)||Bt.push({command:ti.setLayerZoomRange,args:[re,He.minzoom,He.maxzoom]}),Ae)Ae.hasOwnProperty(De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?vs(Ae[De],He[De],Bt,re,De.slice(6),ti.setPaintProperty):w(Ae[De],He[De])||Bt.push({command:ti.setLayerProperty,args:[re,De,He[De]]}));for(De in He)He.hasOwnProperty(De)&&!Ae.hasOwnProperty(De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?vs(Ae[De],He[De],Bt,re,De.slice(6),ti.setPaintProperty):w(Ae[De],He[De])||Bt.push({command:ti.setLayerProperty,args:[re,De,He[De]]}))}else Bt.push({command:ti.removeLayer,args:[re]}),je=Wt[Wt.lastIndexOf(re)+1],Bt.push({command:ti.addLayer,args:[He,je]})}(it,S.layers,B)}catch(G){console.warn("Unable to compute style diff:",G),B=[{command:ti.setStyle,args:[S]}]}return B}(this.serialize(),u).filter(A=>!(A.command in Lt));if(f.length===0)return!1;const y=f.filter(A=>!(A.command in vt));if(y.length>0)throw new Error(`Unimplemented: ${y.map(A=>A.command).join(", ")}.`);return f.forEach(A=>{A.command!=="setTransition"&&A.command!=="setProjection"&&this[A.command].apply(this,A.args)}),this.stylesheet=u,this._updateMapProjection(),!0}addImage(u,f){return this.getImage(u)?this.fire(new r.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(u,f),this._afterImageUpdated(u),this)}updateImage(u,f){this.imageManager.updateImage(u,f)}getImage(u){return this.imageManager.getImage(u)}removeImage(u){return this.getImage(u)?(this.imageManager.removeImage(u),this._afterImageUpdated(u),this):this.fire(new r.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(),this._changedImages[u]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(u,f,y={}){if(this._checkLoaded(),this.getSource(u)!==void 0)throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(r.validateSource,`sources.${u}`,f,null,y))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const A=Se(u,f,this.dispatcher,this);A.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u),source:A.serialize(),sourceId:u}));const S=B=>{const G=(B?"symbol:":"other:")+u,W=this._sourceCaches[G]=new r.SourceCache(G,A,B);(B?this._symbolSourceCaches:this._otherSourceCaches)[u]=W,W.style=this,W.onAdd(this.map)};S(!1),f.type!=="vector"&&f.type!=="geojson"||S(!0),A.onAdd&&A.onAdd(this.map),this._changed=!0}removeSource(u){this._checkLoaded();const f=this.getSource(u);if(!f)throw new Error("There is no source with this ID");for(const A in this._layers)if(this._layers[A].source===u)return this.fire(new r.ErrorEvent(new Error(`Source "${u}" cannot be removed while layer "${A}" is using it.`)));if(this.terrain&&this.terrain.get().source===u)return this.fire(new r.ErrorEvent(new Error(`Source "${u}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(u);for(const A of y)delete this._sourceCaches[A.id],delete this._updatedSources[A.id],A.fire(new r.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:A.getSource().id})),A.setEventedParent(null),A.clearTiles();return delete this._otherSourceCaches[u],delete this._symbolSourceCaches[u],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(u,f){this._checkLoaded(),this.getSource(u).setData(f),this._changed=!0}getSource(u){const f=this._getSourceCache(u);return f&&f.getSource()}_getSources(){const u=[];for(const f in this._otherSourceCaches){const y=this._getSourceCache(f);y&&u.push(y.getSource())}return u}addLayer(u,f,y={}){this._checkLoaded();const A=u.id;if(this.getLayer(A))return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${A}" already exists on this map`)));let S;if(u.type==="custom"){if(Pa(this,r.validateCustomStyleLayer(u)))return;S=r.createStyleLayer(u)}else{if(typeof u.source=="object"&&(this.addSource(A,u.source),u=r.clone$1(u),u=r.extend(u,{source:A})),this._validate(r.validateLayer,`layers.${A}`,u,{arrayIndex:-1},y))return;S=r.createStyleLayer(u),this._validateLayer(S),S.setEventedParent(this,{layer:{id:A}}),this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0)}const B=f?this._order.indexOf(f):this._order.length;if(f&&B===-1)return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(B,0,A),this._layerOrderChanged=!0,this._layers[A]=S;const G=this._getLayerSourceCache(S);if(this._removedLayers[A]&&S.source&&G&&S.type!=="custom"){const W=this._removedLayers[A];delete this._removedLayers[A],W.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",G.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(u,f){if(this._checkLoaded(),this._changed=!0,!this._layers[u])return void this.fire(new r.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be moved.`)));if(u===f)return;const y=this._order.indexOf(u);this._order.splice(y,1);const A=f?this._order.indexOf(f):this._order.length;f&&A===-1?this.fire(new r.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(A,0,u),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(u){this._checkLoaded();const f=this._layers[u];if(!f)return void this.fire(new r.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const y=this._order.indexOf(u);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[u]=f,delete this._layers[u],delete this._serializedLayers[u],delete this._updatedLayers[u],delete this._updatedPaintProps[u],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(u){return this._layers[u]}hasLayer(u){return u in this._layers}hasLayerType(u){for(const f in this._layers)if(this._layers[f].type===u)return!0;return!1}setLayerZoomRange(u,f,y){this._checkLoaded();const A=this.getLayer(u);A?A.minzoom===f&&A.maxzoom===y||(f!=null&&(A.minzoom=f),y!=null&&(A.maxzoom=y),this._updateLayer(A)):this.fire(new r.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(u,f,y={}){this._checkLoaded();const A=this.getLayer(u);if(A){if(!w(A.filter,f))return f==null?(A.filter=void 0,void this._updateLayer(A)):void(this._validate(r.validateFilter,`layers.${A.id}.filter`,f,{layerType:A.type},y)||(A.filter=r.clone$1(f),this._updateLayer(A)))}else this.fire(new r.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be filtered.`)))}getFilter(u){const f=this.getLayer(u);return f&&r.clone$1(f.filter)}setLayoutProperty(u,f,y,A={}){this._checkLoaded();const S=this.getLayer(u);S?w(S.getLayoutProperty(f),y)||(S.setLayoutProperty(f,y,A),this._updateLayer(S)):this.fire(new r.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(u,f){const y=this.getLayer(u);if(y)return y.getLayoutProperty(f);this.fire(new r.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style.`)))}setPaintProperty(u,f,y,A={}){this._checkLoaded();const S=this.getLayer(u);S?w(S.getPaintProperty(f),y)||(S.setPaintProperty(f,y,A)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[u]=!0):this.fire(new r.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(u,f){const y=this.getLayer(u);return y&&y.getPaintProperty(f)}setFeatureState(u,f){this._checkLoaded();const y=u.source,A=u.sourceLayer,S=this.getSource(y);if(!S)return void this.fire(new r.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const B=S.type;if(B==="geojson"&&A)return void this.fire(new r.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(B==="vector"&&!A)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));u.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided.")));const G=this._getSourceCaches(y);for(const W of G)W.setFeatureState(A,u.id,f)}removeFeatureState(u,f){this._checkLoaded();const y=u.source,A=this.getSource(y);if(!A)return void this.fire(new r.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const S=A.type,B=S==="vector"?u.sourceLayer:void 0;if(S==="vector"&&!B)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof u.id!="string"&&typeof u.id!="number")return void this.fire(new r.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const G=this._getSourceCaches(y);for(const W of G)W.removeFeatureState(B,u.id,f)}getFeatureState(u){this._checkLoaded();const f=u.source,y=u.sourceLayer,A=this.getSource(f);if(A){if(A.type!=="vector"||y)return u.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(y,u.id);this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return r.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const u={};for(const f in this._sourceCaches){const y=this._sourceCaches[f].getSource();u[y.id]||(u[y.id]=y.serialize())}return r.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:u,layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateLayer(u){this._updatedLayers[u.id]=!0;const f=this._getLayerSourceCache(u);u.source&&!this._updatedSources[u.source]&&f&&f.getSource().type!=="raster"&&(this._updatedSources[u.source]="reload",f.pause()),this._changed=!0,u.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(u){const f=B=>this._layers[B].type==="fill-extrusion",y={},A=[];for(let B=this._order.length-1;B>=0;B--){const G=this._order[B];if(f(G)){y[G]=B;for(const W of u){const it=W[G];if(it)for(const et of it)A.push(et)}}}A.sort((B,G)=>G.intersectionZ-B.intersectionZ);const S=[];for(let B=this._order.length-1;B>=0;B--){const G=this._order[B];if(f(G))for(let W=A.length-1;W>=0;W--){const it=A[W].feature;if(y[it.layer.id]<B)break;S.push(it),A.pop()}else for(const W of u){const it=W[G];if(it)for(const et of it)S.push(et.feature)}}return S}queryRenderedFeatures(u,f,y){f&&f.filter&&this._validate(r.validateFilter,"queryRenderedFeatures.filter",f.filter,null,f);const A={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new r.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const W of f.layers){const it=this._layers[W];if(!it)return this.fire(new r.ErrorEvent(new Error(`The layer '${W}' does not exist in the map's style and cannot be queried for features.`))),[];A[it.source]=!0}}const S=[];f.availableImages=this._availableImages;const B=f&&f.layers?f.layers.some(W=>{const it=this.getLayer(W);return it&&it.is3D()}):this.has3DLayers(),G=ye.createFromScreenPoints(u,y);for(const W in this._sourceCaches){const it=this._sourceCaches[W].getSource().id;f.layers&&!A[it]||S.push(Re(this._sourceCaches[W],this._layers,this._serializedLayers,G,f,y,B,!!this.map._showQueryGeometry))}return this.placement&&S.push(function(W,it,et,_t,Mt,Bt,Ft){const Gt={},Pt=Bt.queryRenderedSymbols(_t),Ot=[];for(const Wt of Object.keys(Pt).map(Number))Ot.push(Ft[Wt]);Ot.sort(Zn);for(const Wt of Ot){const jt=Wt.featureIndex.lookupSymbolFeatures(Pt[Wt.bucketInstanceId],it,Wt.bucketIndex,Wt.sourceLayerIndex,Mt.filter,Mt.layers,Mt.availableImages,W);for(const Kt in jt){const me=Gt[Kt]=Gt[Kt]||[],re=jt[Kt];re.sort((Ae,He)=>{const je=Wt.featureSortOrder;if(je){const De=je.indexOf(Ae.featureIndex);return je.indexOf(He.featureIndex)-De}return He.featureIndex-Ae.featureIndex});for(const Ae of re)me.push(Ae)}}for(const Wt in Gt)Gt[Wt].forEach(jt=>{const Kt=jt.feature,me=et(W[Wt]).getFeatureState(Kt.layer["source-layer"],Kt.id);Kt.source=Kt.layer.source,Kt.layer["source-layer"]&&(Kt.sourceLayer=Kt.layer["source-layer"]),Kt.state=me});return Gt}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),G.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(u,f){f&&f.filter&&this._validate(r.validateFilter,"querySourceFeatures.filter",f.filter,null,f);const y=this._getSourceCaches(u);let A=[];for(const S of y)A=A.concat(hn(S,f));return A}addSourceType(u,f,y){return C.getSourceType(u)?y(new Error(`A source type called "${u}" already exists.`)):(C.setSourceType(u,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:u,url:f.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(u,f={}){this._checkLoaded();const y=this.light.getLight();let A=!1;for(const B in u)if(!w(u[B],y[B])){A=!0;break}if(!A)return;const S=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(u,f),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(u,f=1){if(this._checkLoaded(),!u)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(f===1){if(typeof u.source=="object"){const y="terrain-dem-src";this.addSource(y,u.source),u=r.clone$1(u),u=r.extend(u,{source:y})}if(this._validate(r.validateTerrain,"terrain",u))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode)this._createTerrain(u,f);else{const y=this.terrain,A=y.get();for(const S of Object.keys(r.spec.terrain))!u.hasOwnProperty(S)&&r.spec.terrain[S].default&&(u[S]=r.spec.terrain[S].default);for(const S in u)if(!w(u[S],A[S])){y.set(u),this.stylesheet.terrain=u;const B=this._setTransitionParameters({duration:0});y.updateTransitions(B);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(u){const f=this.fog=new Yt(u,this.map.transform);this.stylesheet.fog=u;const y=this._setTransitionParameters({duration:0});f.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const u of this.map._markers)u._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(u){if(this._checkLoaded(),!u)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,y=f.get();Object.keys(u).length===0&&f.set(u);for(const A in u)if(!w(u[A],y[A])){f.set(u),this.stylesheet.fog=u;const S=this._setTransitionParameters({duration:0});f.updateTransitions(S);break}}else this._createFog(u);this._markersNeedUpdate=!0}_setTransitionParameters(u){return{now:r.exported.now(),transition:r.extend(u,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const u=this._order.filter(y=>this.isLayerDraped(this._layers[y])),f=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...u),this._drapedFirstOrder.push(...f)}_createTerrain(u,f){const y=this.terrain=new Le(u,f);this.stylesheet.terrain=u,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const A=this._setTransitionParameters({duration:0});y.updateTransitions(A)}_force3DLayerUpdate(){for(const u in this._layers){const f=this._layers[u];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const u in this._layers){const f=this._layers[u];f.type==="symbol"&&this._updateLayer(f)}}_validate(u,f,y,A,S={}){return(!S||S.validate!==!1)&&Pa(this,u.call(r.validateStyle,r.extend({key:f,style:this.serialize(),value:y,styleSpec:r.spec},A)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this._sourceCaches)this._sourceCaches[u].clearTiles(),this._sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(u){const f=this._getSourceCaches(u);for(const y of f)y.clearTiles()}_reloadSource(u){const f=this._getSourceCaches(u);for(const y of f)y.resume(),y.reload()}_reloadSources(){for(const u of this._getSources())u.reload&&u.reload()}_updateSources(u){for(const f in this._sourceCaches)this._sourceCaches[f].update(u)}_generateCollisionBoxes(){for(const u in this._sourceCaches){const f=this._sourceCaches[u];f.resume(),f.reload()}}_updatePlacement(u,f,y,A,S=!1){let B=!1,G=!1;const W={};for(const it of this._order){const et=this._layers[it];if(et.type!=="symbol")continue;if(!W[et.source]){const Mt=this._getLayerSourceCache(et);if(!Mt)continue;W[et.source]=Mt.getRenderableIds(!0).map(Bt=>Mt.getTileByID(Bt)).sort((Bt,Ft)=>Ft.tileID.overscaledZ-Bt.tileID.overscaledZ||(Bt.tileID.isLessThan(Ft.tileID)?-1:1))}const _t=this.crossTileSymbolIndex.addLayer(et,W[et.source],u.center.lng,u.projection);B=B||_t}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),S=S||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new r.Event("neworder")),(S||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.exported.now(),u.zoom))&&(this.pauseablePlacement=new Ei(u,this._order,S,f,y,A,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,W),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.exported.now()),G=!0),B&&this.pauseablePlacement.placement.setStale()),G||B)for(const it of this._order){const et=this._layers[it];et.type==="symbol"&&this.placement.updateLayerOpacities(et,W[et.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.exported.now())}_releaseSymbolFadeTiles(){for(const u in this._sourceCaches)this._sourceCaches[u].releaseSymbolFadeTiles()}getImages(u,f,y){this.imageManager.getImages(f.icons,y),this._updateTilesForChangedImages();const A=S=>{S&&S.setDependencies(f.tileID.key,f.type,f.icons)};A(this._otherSourceCaches[f.source]),A(this._symbolSourceCaches[f.source])}getGlyphs(u,f,y){this.glyphManager.getGlyphs(f.stacks,y)}getResource(u,f,y){return r.makeRequest(f,y)}_getSourceCache(u){return this._otherSourceCaches[u]}_getLayerSourceCache(u){return u.type==="symbol"?this._symbolSourceCaches[u.source]:this._otherSourceCaches[u.source]}_getSourceCaches(u){const f=[];return this._otherSourceCaches[u]&&f.push(this._otherSourceCaches[u]),this._symbolSourceCaches[u]&&f.push(this._symbolSourceCaches[u]),f}_isSourceCacheLoaded(u){const f=this._getSourceCaches(u);return f.length===0?(this.fire(new r.ErrorEvent(new Error(`There is no source with ID '${u}'`))),!1):f.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}C.getSourceType=function(_){return Pe[_]},C.setSourceType=function(_,u){Pe[_]=u},C.registerForPluginStateChange=r.registerForPluginStateChange;var z=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,U="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",X=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,ft=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,mt=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Tt={},ce={};const ee=[];an(z,ee),an(X,ee),an(ft,ee),an(mt,ee),Tt=Fn("",X),ce=Fn(mt,ft);const Oe=Fn(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Qe=z,pn=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var qe={background:Fn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Fn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Fn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Fn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Fn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Fn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Fn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Fn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Fn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Fn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Fn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Fn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Fn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Fn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Fn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Fn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Fn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Fn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Fn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Fn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Fn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Fn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Fn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Fn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Fn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Fn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,U),skyboxGradient:Fn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,U),skyboxCapture:Fn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Fn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;
#ifdef GLOBE_POLES
vec3 up_vector=normalize(globe_pos)*u_tile_up_scale;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Fn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function an(_,u){const f=_.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of f)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const A=y.split(" ");for(const S of A)u.includes(S)||u.push(S)}}function Fn(_,u){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=u.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),A={},S=[...ee];return an(_,S),an(u,S),{fragmentSource:_=_.replace(f,(B,G,W,it,et)=>(A[et]=!0,G==="define"?`
#ifndef HAS_UNIFORM_u_${et}
varying ${W} ${it} ${et};
#else
uniform ${W} ${it} u_${et};
#endif
`:`
#ifdef HAS_UNIFORM_u_${et}
    ${W} ${it} ${et} = u_${et};
#endif
`)),vertexSource:u=u.replace(f,(B,G,W,it,et)=>{const _t=it==="float"?"vec2":"vec4",Mt=et.match(/color/)?"color":_t;return A[et]?G==="define"?`
#ifndef HAS_UNIFORM_u_${et}
uniform lowp float u_${et}_t;
attribute ${W} ${_t} a_${et};
varying ${W} ${it} ${et};
#else
uniform ${W} ${it} u_${et};
#endif
`:Mt==="vec4"?`
#ifndef HAS_UNIFORM_u_${et}
    ${et} = a_${et};
#else
    ${W} ${it} ${et} = u_${et};
#endif
`:`
#ifndef HAS_UNIFORM_u_${et}
    ${et} = unpack_mix_${Mt}(a_${et}, u_${et}_t);
#else
    ${W} ${it} ${et} = u_${et};
#endif
`:G==="define"?`
#ifndef HAS_UNIFORM_u_${et}
uniform lowp float u_${et}_t;
attribute ${W} ${_t} a_${et};
#else
uniform ${W} ${it} u_${et};
#endif
`:Mt==="vec4"?`
#ifndef HAS_UNIFORM_u_${et}
    ${W} ${it} ${et} = a_${et};
#else
    ${W} ${it} ${et} = u_${et};
#endif
`:`
#ifndef HAS_UNIFORM_u_${et}
    ${W} ${it} ${et} = unpack_mix_${Mt}(a_${et}, u_${et}_t);
#else
    ${W} ${it} ${et} = u_${et};
#endif
`}),staticAttributes:y,usedDefines:S}}class Ui{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(u,f,y,A,S,B,G){this.context=u;let W=this.boundPaintVertexBuffers.length!==A.length;for(let et=0;!W&&et<A.length;et++)this.boundPaintVertexBuffers[et]!==A[et]&&(W=!0);let it=this.boundDynamicVertexBuffers.length!==G.length;for(let et=0;!it&&et<G.length;et++)this.boundDynamicVertexBuffers[et]!==G[et]&&(it=!0);if(!u.extVertexArrayObject||!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==y||W||it||this.boundIndexBuffer!==S||this.boundVertexOffset!==B)this.freshBind(f,y,A,S,B,G);else{u.bindVertexArrayOES.set(this.vao);for(const et of G)et&&et.bind();S&&S.dynamicDraw&&S.bind()}}freshBind(u,f,y,A,S,B){let G;const W=u.numAttributes,it=this.context,et=it.gl;if(it.extVertexArrayObject)this.vao&&this.destroy(),this.vao=it.extVertexArrayObject.createVertexArrayOES(),it.bindVertexArrayOES.set(this.vao),G=0,this.boundProgram=u,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=A,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=B;else{G=it.currentNumAttributes||0;for(let _t=W;_t<G;_t++)et.disableVertexAttribArray(_t)}f.enableAttributes(et,u),f.bind(),f.setVertexAttribPointers(et,u,S);for(const _t of y)_t.enableAttributes(et,u),_t.bind(),_t.setVertexAttribPointers(et,u,S);for(const _t of B)_t&&(_t.enableAttributes(et,u),_t.bind(),_t.setVertexAttribPointers(et,u,S));A&&A.bind(),it.currentNumAttributes=W}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ei(_,u){const f=Math.pow(2,u.canonical.z),y=u.canonical.y;return[new r.MercatorCoordinate(0,y/f).toLngLat().lat,new r.MercatorCoordinate(0,(y+1)/f).toLngLat().lat]}function To(_,u,f,y,A,S,B){const G=_.context,W=G.gl,it=f.fbo;if(!it)return;_.prepareDrawTile();const et=_.useProgram("hillshade");G.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,it.colorAttachment.get());const _t=((Gt,Pt,Ot,Wt)=>{const jt=Ot.paint.get("hillshade-shadow-color"),Kt=Ot.paint.get("hillshade-highlight-color"),me=Ot.paint.get("hillshade-accent-color");let re=Ot.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ot.paint.get("hillshade-illumination-anchor")==="viewport"&&(re-=Gt.transform.angle);const Ae=!Gt.options.moving;return{u_matrix:Wt||Gt.transform.calculateProjMatrix(Pt.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:ei(0,Pt.tileID),u_light:[Ot.paint.get("hillshade-exaggeration"),re],u_shadow:jt,u_highlight:Kt,u_accent:me}})(_,f,y,_.terrain?u.projMatrix:null);_.prepareDrawProgram(G,et,u.toUnwrapped());const{tileBoundsBuffer:Mt,tileBoundsIndexBuffer:Bt,tileBoundsSegments:Ft}=_.getTileBoundsBuffers(f);et.draw(G,W.TRIANGLES,A,S,B,r.CullFaceMode.disabled,_t,y.id,Mt,Bt,Ft)}function Qr(_,u,f){if(!u.needsDEMTextureUpload)return;const y=_.context,A=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||_.getTileTexture(f.stride);const S=f.getPixels();u.demTexture?u.demTexture.update(S,{premultiply:!1}):u.demTexture=new r.Texture(y,S,A.RGBA,{premultiply:!1}),u.needsDEMTextureUpload=!1}function tr(_,u,f,y,A,S){const B=_.context,G=B.gl;if(!u.dem)return;const W=u.dem;if(B.activeTexture.set(G.TEXTURE1),Qr(_,u,W),!u.demTexture)return;u.demTexture.bind(G.NEAREST,G.CLAMP_TO_EDGE);const it=W.dim;B.activeTexture.set(G.TEXTURE0);let et=u.fbo;if(!et){const Ft=new r.Texture(B,{width:it,height:it,data:null},G.RGBA);Ft.bind(G.LINEAR,G.CLAMP_TO_EDGE),et=u.fbo=B.createFramebuffer(it,it,!0),et.colorAttachment.set(Ft.texture)}B.bindFramebuffer.set(et.framebuffer),B.viewport.set([0,0,it,it]);const{tileBoundsBuffer:_t,tileBoundsIndexBuffer:Mt,tileBoundsSegments:Bt}=_.getMercatorTileBoundsBuffers();_.useProgram("hillshadePrepare").draw(B,G.TRIANGLES,y,A,S,r.CullFaceMode.disabled,((Ft,Gt)=>{const Pt=Gt.stride,Ot=r.create();return r.ortho(Ot,0,r.EXTENT,-r.EXTENT,0,0,1),r.translate(Ot,Ot,[0,-r.EXTENT,0]),{u_matrix:Ot,u_image:1,u_dimension:[Pt,Pt],u_zoom:Ft.overscaledZ,u_unpack:Gt.unpackVector}})(u.tileID,W),f.id,_t,Mt,Bt),u.needsHillshadePrepare=!1}const sr=_=>({u_matrix:new r.UniformMatrix4f(_),u_image0:new r.Uniform1i(_),u_skirt_height:new r.Uniform1f(_)}),Di=(_,u)=>({u_matrix:_,u_image0:0,u_skirt_height:u}),ls=(_,u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:u,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:f,u_zoom_transition:A,u_merc_center:S,u_image0:0,u_frustum_tl:B,u_frustum_tr:G,u_frustum_br:W,u_frustum_bl:it,u_globe_pos:et,u_globe_radius:_t,u_viewport:Mt,u_grid_matrix:Bt?Float32Array.from(Bt):new Float32Array(9)});function er(_,u){return _!=null&&u!=null&&!(!_.hasData()||!u.hasData())&&_.demTexture!=null&&u.demTexture!=null&&_.tileID.key!==u.tileID.key}const wr=new class{constructor(){this.operations={}}newMorphing(_,u,f,y,A){if(_ in this.operations){const S=this.operations[_];S.to.tileID.key!==f.tileID.key&&(S.queued=f)}else this.operations[_]={startTime:y,phase:0,duration:A,from:u,to:f,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const u=this.operations[_];return{from:u.from,to:u.to,phase:u.phase}}update(_){for(const u in this.operations){const f=this.operations[u];for(f.phase=(_-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,_)){delete this.operations[u];break}}}_nextOp(_,u){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=u,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},Xa={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function za(_,u){const f=1<<_.z;return!u&&(_.x===0||_.x===f-1)||_.y===0||_.y===f-1}const Vr=_=>({u_matrix:_});function Gs(_,u,f,y,A){if(A>0){const S=r.exported.now(),B=(S-_.timeAdded)/A,G=u?(S-u.timeAdded)/A:-1,W=f.getSource(),it=y.coveringZoomLevel({tileSize:W.tileSize,roundZoom:W.roundZoom}),et=!u||Math.abs(u.tileID.overscaledZ-it)>Math.abs(_.tileID.overscaledZ-it),_t=et&&_.refreshedUponExpiration?1:r.clamp(et?B:1-G,0,1);return _.refreshedUponExpiration&&B>=1&&(_.refreshedUponExpiration=!1),u?{opacity:1,mix:1-_t}:{opacity:_t,mix:0}}return{opacity:1,mix:0}}class Ri extends r.SourceCache{constructor(u){const f={type:"raster-dem",maxzoom:u.transform.maxZoom},y=new Ee(pi(),null),A=Se("mock-dem",f,y,u.style);super("mock-dem",A,!1),A.setEventedParent(this),this._sourceLoaded=!0}_loadTile(u,f){u.state="loaded",f(null)}}class us extends r.SourceCache{constructor(u){const f=Se("proxy",{type:"geojson",maxzoom:u.transform.maxZoom},new Ee(pi(),null),u.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=u,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(u,f,y){if(u.freezeTileCoverage)return;this.transform=u;const A=u.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,B)=>{if(S[B.key]="",!this._tiles[B.key]){const G=new r.Tile(B,this._source.tileSize*B.overscaleFactor(),u.tileZoom);G.state="loaded",this._tiles[B.key]=G}return S},{});for(const S in this._tiles)S in A||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(u){const f=this.proxyCachedFBO[u];if(f!==void 0){const y=Object.values(f);this.renderCachePool.push(...y),delete this.proxyCachedFBO[u]}}deallocRenderCache(){this.renderCache.forEach(u=>u.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class pa extends r.OverscaledTileID{constructor(u,f,y){super(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y),this.proxyTileKey=f,this.projMatrix=y}}class Ms extends r.Elevation{constructor(u,f){super(),this.painter=u,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,A,S]=function(W){const it=new r.StructArrayLayout4i8,et=new r.StructArrayLayout3ui6,_t=131;it.reserve(17161),et.reserve(33800);const Mt=r.EXTENT/128,Bt=r.EXTENT+Mt/2,Ft=Bt+Mt;for(let Pt=-Mt;Pt<Ft;Pt+=Mt)for(let Ot=-Mt;Ot<Ft;Ot+=Mt){const Wt=Ot<0||Ot>Bt||Pt<0||Pt>Bt?24575:0,jt=r.clamp(Math.round(Ot),0,r.EXTENT),Kt=r.clamp(Math.round(Pt),0,r.EXTENT);it.emplaceBack(jt+Wt,Kt,jt,Kt)}const Gt=(Pt,Ot)=>{const Wt=Ot*_t+Pt;et.emplaceBack(Wt+1,Wt,Wt+_t),et.emplaceBack(Wt+_t,Wt+_t+1,Wt+1)};for(let Pt=1;Pt<129;Pt++)for(let Ot=1;Ot<129;Ot++)Gt(Ot,Pt);return[0,129].forEach(Pt=>{for(let Ot=0;Ot<130;Ot++)Gt(Ot,Pt),Gt(Pt,Ot)}),[it,et,32768]}(),B=u.context;this.gridBuffer=B.createVertexBuffer(y,r.boundsAttributes.members),this.gridIndexBuffer=B.createIndexBuffer(A),this.gridSegments=r.SegmentVector.simpleSegment(0,0,y.length,A.length),this.gridNoSkirtSegments=r.SegmentVector.simpleSegment(0,0,y.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new us(f.map),this.orthoMatrix=r.create(),r.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.EXTENT,0,r.EXTENT,0,1);const G=B.gl;this._overlapStencilMode=new r.StencilMode({func:G.GEQUAL,mask:255},0,255,G.KEEP,G.KEEP,G.REPLACE),this._previousZoom=u.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ri(f.map)}set style(u){u.on("data",this._onStyleDataEvent.bind(this)),u.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=u,this._checkRenderCacheEfficiency()}update(u,f,y){if(u&&u.terrain){this._style!==u&&(this.style=u),this.enabled=!0;const A=u.terrain.properties;this.sourceCache=u.terrain.drapeRenderMode===0?this._mockSourceCache:u._getSourceCache(A.get("source")),this._exaggeration=A.get("exaggeration");const S=()=>{this.sourceCache.used&&r.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const B=this.getScaledDemTileSize();this.sourceCache.update(f,B,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,S(),this._initializing=!0),S(),f.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(u){this._findCoveringTileCache[u]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const u=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||u.efficiency!==100&&r.warnOnce(`Terrain render cache efficiency is not optimal (${u.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${u.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(u){u.coord&&u.dataType==="source"?this._clearRenderCacheForTile(u.sourceCacheId,u.coord):u.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const u in this._style._sourceCaches)this._style._sourceCaches[u].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(u=>u.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const u=2*this.proxySourceCache.getSource().tileSize;return[u,u]}set useVertexMorphing(u){this._useVertexMorphing=u}updateTileBinding(u){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const A=this.proxyCoords=f.getIds().map(W=>{const it=f.getTileByID(W).tileID;return it.projMatrix=y.calculateProjMatrix(it.toUnwrapped()),it});(function(W,it){const et=it.transform.pointCoordinate(it.transform.getCameraPoint()),_t=new r.pointGeometry(et.x,et.y);W.sort((Mt,Bt)=>{if(Bt.overscaledZ-Mt.overscaledZ)return Bt.overscaledZ-Mt.overscaledZ;const Ft=new r.pointGeometry(Mt.canonical.x+(1<<Mt.canonical.z)*Mt.wrap,Mt.canonical.y),Gt=new r.pointGeometry(Bt.canonical.x+(1<<Bt.canonical.z)*Bt.wrap,Bt.canonical.y),Pt=_t.mult(1<<Mt.canonical.z);return Pt.x-=.5,Pt.y-=.5,Pt.distSqr(Ft)-Pt.distSqr(Gt)})})(A,this.painter),this._previousZoom=y.zoom;const S=this.proxyToSource||{};this.proxyToSource={},A.forEach(W=>{this.proxyToSource[W.key]={}}),this.terrainTileForTile={};const B=this._style._sourceCaches;for(const W in B){const it=B[W];if(!it.used||(it!==this.sourceCache&&this.resetTileLookupCache(it.id),this._setupProxiedCoordsForOrtho(it,u[W],S),it.usedForTerrain))continue;const et=u[W];it.getSource().reparseOverscaled&&this._assignTerrainTiles(et)}this.proxiedCoords[f.id]=A.map(W=>new pa(W,W.key,this.orthoMatrix)),this._assignTerrainTiles(A),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1,this._updateTimestamp=r.exported.now();const G={};this._visibleDemTiles=[];for(const W of this.proxyCoords){const it=this.terrainTileForTile[W.key];if(!it)continue;const et=it.tileID.key;et in G||(this._visibleDemTiles.push(it),G[et]=et)}}_assignTerrainTiles(u){this._initializing||u.forEach(f=>{if(this.terrainTileForTile[f.key])return;const y=this._findTileCoveringTileID(f,this.sourceCache);y&&(this.terrainTileForTile[f.key]=y)})}_prepareDEMTextures(){const u=this.painter.context,f=u.gl;for(const y in this.terrainTileForTile){const A=this.terrainTileForTile[y],S=A.dem;!S||A.demTexture&&!A.needsDEMTextureUpload||(u.activeTexture.set(f.TEXTURE1),Qr(this.painter,A,S))}}_prepareDemTileUniforms(u,f,y,A){if(!f||f.demTexture==null)return!1;const S=u.tileID.canonical,B=Math.pow(2,f.tileID.canonical.z-S.z),G=A||"";return y[`u_dem_tl${G}`]=[S.x*B%1,S.y*B%1],y[`u_dem_scale${G}`]=B,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const u=this.painter.context,f=u.gl;if(!this._emptyDepthBufferTexture){const y=new r.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new r.Texture(u,y,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let u=0;const f=this._visibleDemTiles.reduce((y,A)=>{if(!A.dem)return y;const S=A.dem.tree.minimums[0];return S>0&&u++,y+S},0);return u?f/u:0}_updateEmptyDEMTexture(){const u=this.painter.context,f=u.gl;u.activeTexture.set(f.TEXTURE2);const y=this._getLoadedAreaMinimum(),A=new r.RGBAImage({width:1,height:1},new Uint8Array(r.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(A,{premultiply:!1}):S=this._emptyDEMTexture=new r.Texture(u,A,f.RGBA,{premultiply:!1}),S}setupElevationDraw(u,f,y){const A=this.painter.context,S=A.gl,B=(G=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:r.DEMData.getUnpackVector(G),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var G;B.u_dem_size=this.sourceCache.getSource().tileSize,B.u_exaggeration=this.exaggeration();let W=null,it=null,et=1;if(y&&y.morphing&&this._useVertexMorphing){const _t=y.morphing.srcDemTile,Mt=y.morphing.dstDemTile;et=y.morphing.phase,_t&&Mt&&(this._prepareDemTileUniforms(u,_t,B,"_prev")&&(it=_t),this._prepareDemTileUniforms(u,Mt,B)&&(W=Mt))}if(it&&W?(A.activeTexture.set(S.TEXTURE2),W.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),A.activeTexture.set(S.TEXTURE4),it.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),B.u_dem_lerp=et):(W=this.terrainTileForTile[u.tileID.key],A.activeTexture.set(S.TEXTURE2),(this._prepareDemTileUniforms(u,W,B)?W.demTexture:this.emptyDEMTexture).bind(S.NEAREST,S.CLAMP_TO_EDGE)),A.activeTexture.set(S.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),this._depthFBO&&(B.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),B.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&W){const _t=(1<<W.tileID.canonical.z)*r.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;B.u_meter_to_dem=_t}if(y&&y.labelPlaneMatrixInv&&(B.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),f.setTerrainUniformValues(A,B),this.painter.transform.projection.name==="globe"){const _t=this.globeUniformValues(this.painter.transform,u.tileID.canonical,y&&y.useDenormalizedUpVectorScale);f.setGlobeUniformValues(A,_t)}}globeUniformValues(u,f,y){const A=u.projection;return{u_tile_tl_up:A.upVector(f,0,0),u_tile_tr_up:A.upVector(f,r.EXTENT,0),u_tile_br_up:A.upVector(f,r.EXTENT,r.EXTENT),u_tile_bl_up:A.upVector(f,0,r.EXTENT),u_tile_up_scale:y?r.GLOBE_METERS_TO_ECEF:A.upVectorScale(f,u.center.lat,u.worldSize).metersToTile}}renderToBackBuffer(u){const f=this.painter,y=this.painter.context;u.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(A,S,B,G,W){if(A.transform.projection.name==="globe")(function(it,et,_t,Mt,Bt){const Ft=it.context,Gt=Ft.gl;let Pt,Ot;const Wt=it.options.showTerrainWireframe?2:0,jt=it.transform,Kt=r.globeUseCustomAntiAliasing(it,Ft,jt),me=(Ln,tn)=>{if(Ot===Ln)return;const xn=[Xa[Ln],"PROJECTION_GLOBE_VIEW"];Kt&&xn.push("CUSTOM_ANTIALIASING"),tn&&xn.push(Xa[Wt]),Pt=it.useProgram("globeRaster",null,xn),Ot=Ln},re=it.colorModeForRenderPass(),Ae=new r.DepthMode(Gt.LEQUAL,r.DepthMode.ReadWrite,it.depthRangeFor3D);wr.update(Bt);const He=r.calculateGlobeMercatorMatrix(jt),je=[r.mercatorXfromLng(jt.center.lng),r.mercatorYfromLat(jt.center.lat)],De=Wt?[!1,!0]:[!1],An=it.globeSharedBuffers,Fe=[jt.width*r.exported.devicePixelRatio,jt.height*r.exported.devicePixelRatio],fn=Float32Array.from(jt.globeMatrix),Je={useDenormalizedUpVectorScale:!0};if(De.forEach(Ln=>{Ot=-1;const tn=Ln?Gt.LINES:Gt.TRIANGLES;for(const xn of Mt){const zn=_t.getTile(xn),Ne=r.StencilMode.disabled,$e=et.prevTerrainTileForTile[xn.key],ri=et.terrainTileForTile[xn.key];er($e,ri)&&wr.newMorphing(xn.key,$e,ri,Bt,250),Ft.activeTexture.set(Gt.TEXTURE0),zn.texture.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE);const fi=wr.getMorphValuesForProxy(xn.key),oi=fi?1:0;fi&&r.extend$1(Je,{morphing:{srcDemTile:fi.from,dstDemTile:fi.to,phase:r.easeCubicInOut(fi.phase)}});const Li=r.tileCornersToBounds(xn.canonical),Ki=r.getLatitudinalLod(Li.getCenter().lat),gi=r.getGridMatrix(xn.canonical,Li,Ki,jt.worldSize/jt._pixelsPerMercatorPixel),Kn=r.globeNormalizeECEF(r.globeTileBounds(xn.canonical)),Hr=ls(jt.projMatrix,fn,He,Kn,r.globeToMercatorTransition(jt.zoom),je,jt.frustumCorners.TL,jt.frustumCorners.TR,jt.frustumCorners.BR,jt.frustumCorners.BL,jt.globeCenterInViewSpace,jt.globeRadius,Fe,gi);if(me(oi,Ln),et.setupElevationDraw(zn,Pt,Je),it.prepareDrawProgram(Ft,Pt,xn.toUnwrapped()),An){const[Dr,to,Wr]=Ln?An.getWirefameBuffers(it.context,Ki):An.getGridBuffers(Ki);Pt.draw(Ft,tn,Ae,Ne,re,r.CullFaceMode.backCCW,Hr,"globe_raster",Dr,to,Wr)}}}),An){const Ln=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Kt&&Ln.push("CUSTOM_ANTIALIASING"),Pt=it.useProgram("globeRaster",null,Ln);for(const tn of Mt){const{x:xn,y:zn,z:Ne}=tn.canonical,$e=zn===0,ri=zn===(1<<Ne)-1,[fi,oi,Li,Ki]=An.getPoleBuffers(Ne);if(Ki&&($e||ri)){const gi=_t.getTile(tn);Ft.activeTexture.set(Gt.TEXTURE0),gi.texture.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE);let Kn=r.globePoleMatrixForTile(Ne,xn,jt);const Hr=r.globeNormalizeECEF(r.globeTileBounds(tn.canonical)),Dr=(to,Wr)=>to.draw(Ft,Gt.TRIANGLES,Ae,r.StencilMode.disabled,re,r.CullFaceMode.disabled,ls(jt.projMatrix,Kn,Kn,Hr,0,je,jt.frustumCorners.TL,jt.frustumCorners.TR,jt.frustumCorners.BR,jt.frustumCorners.BL,jt.globeCenterInViewSpace,jt.globeRadius,Fe),"globe_pole_raster",Wr,Li,Ki);et.setupElevationDraw(gi,Pt,Je),it.prepareDrawProgram(Ft,Pt,tn.toUnwrapped()),$e&&Dr(Pt,fi),ri&&(Kn=r.scale(r.create(),Kn,[1,-1,1]),Dr(Pt,oi))}}}})(A,S,B,G,W);else{const it=A.context,et=it.gl;let _t,Mt;const Bt=A.options.showTerrainWireframe?2:0,Ft=(jt,Kt)=>{if(Mt===jt)return;const me=[Xa[jt]];Kt&&me.push(Xa[Bt]),_t=A.useProgram("terrainRaster",null,me),Mt=jt},Gt=A.colorModeForRenderPass(),Pt=new r.DepthMode(et.LEQUAL,r.DepthMode.ReadWrite,A.depthRangeFor3D);wr.update(W);const Ot=A.transform,Wt=6*Math.pow(1.5,22-Ot.zoom)*S.exaggeration();(Bt?[!1,!0]:[!1]).forEach(jt=>{Mt=-1;const Kt=jt?et.LINES:et.TRIANGLES,[me,re]=jt?S.getWirefameBuffer():[S.gridIndexBuffer,S.gridSegments];for(const Ae of G){const He=B.getTile(Ae),je=r.StencilMode.disabled,De=S.prevTerrainTileForTile[Ae.key],An=S.terrainTileForTile[Ae.key];er(De,An)&&wr.newMorphing(Ae.key,De,An,W,250),it.activeTexture.set(et.TEXTURE0),He.texture.bind(et.LINEAR,et.CLAMP_TO_EDGE,et.LINEAR_MIPMAP_NEAREST);const Fe=wr.getMorphValuesForProxy(Ae.key),fn=Fe?1:0;let Je;Fe&&(Je={morphing:{srcDemTile:Fe.from,dstDemTile:Fe.to,phase:r.easeCubicInOut(Fe.phase)}});const Ln=Di(Ae.projMatrix,za(Ae.canonical,Ot.renderWorldCopies)?Wt/10:Wt);Ft(fn,jt),S.setupElevationDraw(He,_t,Je),A.prepareDrawProgram(it,_t,Ae.toUnwrapped()),_t.draw(it,Kt,Pt,je,Gt,r.CullFaceMode.backCCW,Ln,"terrain_raster",S.gridBuffer,me,re)}})}}(f,this,this.proxySourceCache,u,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),u.splice(0,u.length))}renderBatch(u){if(this._drapedRenderBatches.length===0)return u+1;this.renderingToTexture=!0;const f=this.painter,y=this.painter.context,A=this.proxySourceCache,S=this.proxiedCoords[A.id],B=this._drapedRenderBatches.shift(),G=[],W=f.style.order;let it=0;for(const et of S){const _t=A.getTileByID(et.proxyTileKey),Mt=A.proxyCachedFBO[et.key]?A.proxyCachedFBO[et.key][u]:void 0,Bt=Mt!==void 0?A.renderCache[Mt]:this.pool[it++],Ft=Mt!==void 0;if(_t.texture=Bt.tex,Ft&&!Bt.dirty){G.push(_t.tileID);continue}let Gt;y.bindFramebuffer.set(Bt.fb.framebuffer),this.renderedToTile=!1,Bt.dirty&&(y.clear({color:r.Color.transparent,stencil:0}),Bt.dirty=!1);for(let Pt=B.start;Pt<=B.end;++Pt){const Ot=f.style._layers[W[Pt]];if(Ot.isHidden(f.transform.zoom))continue;const Wt=f.style._getLayerSourceCache(Ot),jt=Wt?this.proxyToSource[et.key][Wt.id]:[et];if(!jt)continue;const Kt=jt;y.viewport.set([0,0,Bt.fb.width,Bt.fb.height]),Gt!==(Wt?Wt.id:null)&&(this._setupStencil(Bt,jt,Ot,Wt),Gt=Wt?Wt.id:null),f.renderLayer(f,Wt,Ot,Kt)}this.renderedToTile?(Bt.dirty=!0,G.push(_t.tileID)):Ft||--it,it===5&&(it=0,this.renderToBackBuffer(G))}return this.renderToBackBuffer(G),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),B.end+1}postRender(){}renderCacheEfficiency(u){const f=u.order.length;if(f===0)return{efficiency:100};let y,A=0,S=0,B=!1;for(let G=0;G<f;++G){const W=u._layers[u.order[G]];this._style.isLayerDraped(W)?(B&&++A,++S):B||(B=!0,y=W.id)}return S===0?{efficiency:100}:{efficiency:100*(1-A/S),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let u=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{u=Math.min(u,f.dem.tree.minimums[0])}),u===0?u:(u-30)*this._exaggeration}raycast(u,f,y){if(!this._visibleDemTiles)return null;const A=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const B=S.tileID,G=1<<B.overscaledZ,{x:W,y:it}=B.canonical,et=W/G,_t=(W+1)/G,Mt=it/G,Bt=(it+1)/G;return{minx:et,miny:Mt,maxx:_t,maxy:Bt,t:S.dem.tree.raycastRoot(et,Mt,_t,Bt,u,f,y),tile:S}});A.sort((S,B)=>(S.t!==null?S.t:Number.MAX_VALUE)-(B.t!==null?B.t:Number.MAX_VALUE));for(const S of A){if(S.t==null)return null;const B=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,u,f,y);if(B!=null)return B}return null}_createFBO(){const u=this.painter.context,f=u.gl,y=this.drapeBufferSize;u.activeTexture.set(f.TEXTURE0);const A=new r.Texture(u,{width:y[0],height:y[1],data:null},f.RGBA);A.bind(f.LINEAR,f.CLAMP_TO_EDGE);const S=u.createFramebuffer(y[0],y[1],!1);return S.colorAttachment.set(A.texture),S.depthAttachment=new Ea(u,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=u.createRenderbuffer(u.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),u.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),u.extTextureFilterAnisotropic&&!u.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax),{fb:S,tex:A,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u].hasTransition())return!0;return this._style.order.some(u=>{const f=this._style._layers[u],y=f.isHidden(this.painter.transform.zoom);return f.type!=="custom"&&!y&&f.hasTransition()})}_clearRasterFadeFromRenderCache(){let u=!1;for(const f in this._style._sourceCaches)if(this._style._sourceCaches[f]._source instanceof It){u=!0;break}if(u)for(let f=0;f<this._style.order.length;++f){const y=this._style._layers[this._style.order[f]],A=y.isHidden(this.painter.transform.zoom),S=this._style._getLayerSourceCache(y);if(y.type!=="raster"||A||!S)continue;const B=y.paint.get("raster-fade-duration");for(const G of this.proxyCoords){const W=this.proxyToSource[G.key][S.id];if(W)for(const it of W){const et=Gs(S.getTile(it),S.findLoadedParent(it,0),S,this.painter.transform,B);(et.opacity!==1||et.mix!==0)&&this._clearRenderCacheForTile(S.id,it)}}}}_setupDrapedRenderBatches(){const u=this._style.order,f=u.length;if(f===0)return;const y=[];let A,S=0,B=this._style._layers[u[S]];for(;!this._style.isLayerDraped(B)&&B.isHidden(this.painter.transform.zoom)&&++S<f;)B=this._style._layers[u[S]];for(;S<f;++S){const G=this._style._layers[u[S]];G.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(G)?A===void 0&&(A=S):A!==void 0&&(y.push({start:A,end:S-1}),A=void 0))}A!==void 0&&y.push({start:A,end:S-1}),this._drapedRenderBatches=y}_setupRenderCache(u){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const B=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let G=0;G<B.length;++G){const W=Object.values(B[G]);f.renderCachePool.push(...W)}}return}this._clearRasterFadeFromRenderCache();const y=this.proxyCoords,A=this._tilesDirty;for(let B=y.length-1;B>=0;B--){const G=y[B];if(f.getTileByID(G.key),f.proxyCachedFBO[G.key]!==void 0){const W=u[G.key],it=this.proxyToSource[G.key];let et=0;for(const _t in it){const Mt=it[_t],Bt=W[_t];if(!Bt||Bt.length!==Mt.length||Mt.some((Ft,Gt)=>Ft!==Bt[Gt]||A[_t]&&A[_t].hasOwnProperty(Ft.key))){et=-1;break}++et}for(const _t in f.proxyCachedFBO[G.key])f.renderCache[f.proxyCachedFBO[G.key][_t]].dirty=et<0||et!==Object.values(W).length}}const S=[...this._drapedRenderBatches];S.sort((B,G)=>G.end-G.start-(B.end-B.start));for(const B of S)for(const G of y){if(f.proxyCachedFBO[G.key])continue;let W=f.renderCachePool.pop();W===void 0&&f.renderCache.length<50&&(W=f.renderCache.length,f.renderCache.push(this._createFBO())),W!==void 0&&(f.proxyCachedFBO[G.key]={},f.proxyCachedFBO[G.key][B.start]=W,f.renderCache[W].dirty=!0)}this._tilesDirty={}}_setupStencil(u,f,y,A){if(!A||!this._sourceTilesOverlap[A.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,B=S.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let G;if(y.isTileClipped())G=f.length,this._overlapStencilMode.test={func:B.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);G=1,this._overlapStencilMode.test={func:B.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+G>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=G,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(u){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[u.key]),this._overlapStencilMode):r.StencilMode.disabled}_renderTileClippingMasks(u,f){const y=this.painter,A=this.painter.context,S=A.gl;y._tileClippingMaskIDs={},A.setColorMode(r.ColorMode.disabled),A.setDepthMode(r.DepthMode.disabled);const B=y.useProgram("clippingMask");for(const G of u){const W=y._tileClippingMaskIDs[G.key]=--f;B.draw(A,S.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:S.ALWAYS,mask:0},W,255,S.KEEP,S.KEEP,S.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,Vr(G.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(u){const f=this.painter.transform;if(u.x<0||u.x>f.width||u.y<0||u.y>f.height)return null;const y=[u.x,u.y,1,1];r.transformMat4$1(y,y,f.pixelMatrixInverse),r.scale$1(y,y,1/y[3]),y[0]/=f.worldSize,y[1]/=f.worldSize;const A=f._camera.position,S=r.mercatorZfromAltitude(1,f.center.lat),B=[A[0],A[1],A[2]/S,0],G=r.subtract([],y.slice(0,3),B);r.normalize(G,G);const W=this.raycast(B,G,this._exaggeration);return W!==null&&W?(r.scaleAndAdd(B,B,G,W),B[3]=B[2],B[2]*=S,B):null}drawDepth(){const u=this.painter,f=u.context,y=this.proxySourceCache,A=Math.ceil(u.width),S=Math.ceil(u.height);if(!this._depthFBO||this._depthFBO.width===A&&this._depthFBO.height===S||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const B=f.gl,G=f.createFramebuffer(A,S,!0);f.activeTexture.set(B.TEXTURE0);const W=new r.Texture(f,{width:A,height:S,data:null},B.RGBA);W.bind(B.NEAREST,B.CLAMP_TO_EDGE),G.colorAttachment.set(W.texture);const it=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,A,S);G.depthAttachment.set(it),this._depthFBO=G,this._depthTexture=W}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,A,S]),function(B,G,W,it){if(B.transform.projection.name==="globe")return;const et=B.context,_t=et.gl;et.clear({depth:1});const Mt=B.useProgram("terrainDepth"),Bt=new r.DepthMode(_t.LESS,r.DepthMode.ReadWrite,B.depthRangeFor3D);for(const Ft of it){const Gt=W.getTile(Ft),Pt=Di(Ft.projMatrix,0);G.setupElevationDraw(Gt,Mt),Mt.draw(et,_t.TRIANGLES,Bt,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.backCCW,Pt,"terrain_depth",G.gridBuffer,G.gridIndexBuffer,G.gridNoSkirtSegments)}}(u,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(u,f,y){if(u.getSource()instanceof Ht)return this._setupProxiedCoordsForImageSource(u,f,y);this._findCoveringTileCache[u.id]=this._findCoveringTileCache[u.id]||{};const A=this.proxiedCoords[u.id]=[],S=this.proxyCoords;for(let G=0;G<S.length;G++){const W=S[G],it=this._findTileCoveringTileID(W,u);if(it){const et=this._createProxiedId(W,it,y[W.key]&&y[W.key][u.id]);A.push(et),this.proxyToSource[W.key][u.id]=[et]}}let B=!1;for(let G=0;G<f.length;G++){const W=u.getTile(f[G]);if(!W||!W.hasData())continue;const it=this._findTileCoveringTileID(W.tileID,this.proxySourceCache);if(it&&it.tileID.canonical.z!==W.tileID.canonical.z){const et=this.proxyToSource[it.tileID.key][u.id],_t=this._createProxiedId(it.tileID,W,y[it.tileID.key]&&y[it.tileID.key][u.id]);et?et.splice(et.length-1,0,_t):this.proxyToSource[it.tileID.key][u.id]=[_t],A.push(_t),B=!0}}this._sourceTilesOverlap[u.id]=B}_setupProxiedCoordsForImageSource(u,f,y){if(!u.getSource().loaded())return;const A=this.proxiedCoords[u.id]=[],S=this.proxyCoords,B=u.getSource(),G=new r.pointGeometry(B.tileID.x,B.tileID.y)._div(1<<B.tileID.z),W=B.coordinates.map(r.MercatorCoordinate.fromLngLat).reduce((et,_t)=>(et.min.x=Math.min(et.min.x,_t.x-G.x),et.min.y=Math.min(et.min.y,_t.y-G.y),et.max.x=Math.max(et.max.x,_t.x-G.x),et.max.y=Math.max(et.max.y,_t.y-G.y),et),{min:new r.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),it=(et,_t)=>{const Mt=et.wrap+et.canonical.x/(1<<et.canonical.z),Bt=et.canonical.y/(1<<et.canonical.z),Ft=r.EXTENT/(1<<et.canonical.z),Gt=_t.wrap+_t.canonical.x/(1<<_t.canonical.z),Pt=_t.canonical.y/(1<<_t.canonical.z);return Mt+Ft<Gt+W.min.x||Mt>Gt+W.max.x||Bt+Ft<Pt+W.min.y||Bt>Pt+W.max.y};for(let et=0;et<S.length;et++){const _t=S[et];for(let Mt=0;Mt<f.length;Mt++){const Bt=u.getTile(f[Mt]);if(!Bt||!Bt.hasData()||it(_t,Bt.tileID))continue;const Ft=this._createProxiedId(_t,Bt,y[_t.key]&&y[_t.key][u.id]),Gt=this.proxyToSource[_t.key][u.id];Gt?Gt.push(Ft):this.proxyToSource[_t.key][u.id]=[Ft],A.push(Ft)}}}_createProxiedId(u,f,y){let A=this.orthoMatrix;if(y){const S=y.find(B=>B.key===f.tileID.key);if(S)return S}if(f.tileID.key!==u.key){const S=u.canonical.z-f.tileID.canonical.z;let B,G,W;A=r.create();const it=f.tileID.wrap-u.wrap<<u.overscaledZ;S>0?(B=r.EXTENT>>S,G=B*((f.tileID.canonical.x<<S)-u.canonical.x+it),W=B*((f.tileID.canonical.y<<S)-u.canonical.y)):(B=r.EXTENT<<-S,G=r.EXTENT*(f.tileID.canonical.x-(u.canonical.x+it<<-S)),W=r.EXTENT*(f.tileID.canonical.y-(u.canonical.y<<-S))),r.ortho(A,0,B,0,B,0,1),r.translate(A,A,[G,W,0])}return new pa(f.tileID,u.key,A)}_findTileCoveringTileID(u,f){let y=f.getTile(u);if(y&&y.hasData())return y;const A=this._findCoveringTileCache[f.id],S=A[u.key];if(y=S?f.getTileByID(S):null,y&&y.hasData()||S===null)return y;let B=y?y.tileID:u,G=B.overscaledZ;const W=f.getSource().minzoom,it=[];if(!S){const _t=f.getSource().maxzoom;if(u.canonical.z>=_t){const Mt=u.canonical.z-_t;f.getSource().reparseOverscaled?(G=Math.max(u.canonical.z+2,f.transform.tileZoom),B=new r.OverscaledTileID(G,u.wrap,_t,u.canonical.x>>Mt,u.canonical.y>>Mt)):Mt!==0&&(G=_t,B=new r.OverscaledTileID(G,u.wrap,_t,u.canonical.x>>Mt,u.canonical.y>>Mt))}B.key!==u.key&&(it.push(B.key),y=f.getTile(B))}const et=_t=>{it.forEach(Mt=>{A[Mt]=_t}),it.length=0};for(G-=1;G>=W&&(!y||!y.hasData());G--){y&&et(y.tileID.key);const _t=B.calculateScaledKey(G);if(y=f.getTileByID(_t),y&&y.hasData())break;const Mt=A[_t];if(Mt===null)break;Mt===void 0?it.push(_t):y=f.getTileByID(Mt)}return et(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(u){return this.enabled?this._findTileCoveringTileID(u,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(u,f){let y=this._tilesDirty[u];y||(y=this._tilesDirty[u]={}),y[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const u=function(f){let y=0;const A=new r.StructArrayLayout2ui4,S=131;for(let B=1;B<129;B++){for(let G=1;G<129;G++)y=B*S+G,A.emplaceBack(y,y+1),A.emplaceBack(y,y+S),A.emplaceBack(y+1,y+S),B===128&&A.emplaceBack(y+S,y+S+1);A.emplaceBack(y+1,y+1+S)}return A}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(u),this.wireframeSegments=r.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,u.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class ma{static cacheKey(u,f,y,A){let S=`${f}${A?A.cacheKey:""}`;for(const B of y)u.usedDefines.includes(B)&&(S+=`/${B}`);return S}constructor(u,f,y,A,S,B){const G=u.gl;this.program=G.createProgram();const W=function(Pt){const Ot=[];for(let Wt=0;Wt<Pt.length;Wt++){if(Pt[Wt]===null)continue;const jt=Pt[Wt].split(" ");Ot.push(jt.pop())}return Ot}(y.staticAttributes),it=A?A.getBinderAttributes():[],et=W.concat(it);let _t=A?A.defines():[];_t=_t.concat(B.map(Pt=>`#define ${Pt}`));const Mt=_t.concat(u.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(pn):pn,pn,Qe,Oe.fragmentSource,ce.fragmentSource,y.fragmentSource).join(`
`),Bt=_t.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Qe,Oe.vertexSource,ce.vertexSource,Tt.vertexSource,y.vertexSource).join(`
`),Ft=G.createShader(G.FRAGMENT_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);G.shaderSource(Ft,Mt),G.compileShader(Ft),G.attachShader(this.program,Ft);const Gt=G.createShader(G.VERTEX_SHADER);if(G.isContextLost())this.failedToCreate=!0;else{G.shaderSource(Gt,Bt),G.compileShader(Gt),G.attachShader(this.program,Gt),this.attributes={},this.numAttributes=et.length;for(let Pt=0;Pt<this.numAttributes;Pt++)et[Pt]&&(G.bindAttribLocation(this.program,Pt,et[Pt]),this.attributes[et[Pt]]=Pt);G.linkProgram(this.program),G.deleteShader(Gt),G.deleteShader(Ft),this.fixedUniforms=S(u),this.binderUniforms=A?A.getUniforms(u):[],B.includes("TERRAIN")&&(this.terrainUniforms=(Pt=>({u_dem:new r.Uniform1i(Pt),u_dem_prev:new r.Uniform1i(Pt),u_dem_unpack:new r.Uniform4f(Pt),u_dem_tl:new r.Uniform2f(Pt),u_dem_scale:new r.Uniform1f(Pt),u_dem_tl_prev:new r.Uniform2f(Pt),u_dem_scale_prev:new r.Uniform1f(Pt),u_dem_size:new r.Uniform1f(Pt),u_dem_lerp:new r.Uniform1f(Pt),u_exaggeration:new r.Uniform1f(Pt),u_depth:new r.Uniform1i(Pt),u_depth_size_inv:new r.Uniform2f(Pt),u_meter_to_dem:new r.Uniform1f(Pt),u_label_plane_matrix_inv:new r.UniformMatrix4f(Pt)}))(u)),B.includes("GLOBE")&&(this.globeUniforms=(Pt=>({u_tile_tl_up:new r.Uniform3f(Pt),u_tile_tr_up:new r.Uniform3f(Pt),u_tile_br_up:new r.Uniform3f(Pt),u_tile_bl_up:new r.Uniform3f(Pt),u_tile_up_scale:new r.Uniform1f(Pt)}))(u)),B.includes("FOG")&&(this.fogUniforms=(Pt=>({u_fog_matrix:new r.UniformMatrix4f(Pt),u_fog_range:new r.Uniform2f(Pt),u_fog_color:new r.Uniform4f(Pt),u_fog_horizon_blend:new r.Uniform1f(Pt),u_fog_temporal_offset:new r.Uniform1f(Pt),u_frustum_tl:new r.Uniform3f(Pt),u_frustum_tr:new r.Uniform3f(Pt),u_frustum_br:new r.Uniform3f(Pt),u_frustum_bl:new r.Uniform3f(Pt),u_globe_pos:new r.Uniform3f(Pt),u_globe_radius:new r.Uniform1f(Pt),u_globe_transition:new r.Uniform1f(Pt),u_is_globe:new r.Uniform1i(Pt),u_viewport:new r.Uniform2f(Pt)}))(u))}}setTerrainUniformValues(u,f){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const A in f)y[A]&&y[A].set(this.program,A,f[A])}}setGlobeUniformValues(u,f){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const A in f)y[A]&&y[A].set(this.program,A,f[A])}}setFogUniformValues(u,f){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const A in f)y[A].set(this.program,A,f[A])}}draw(u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt){const Pt=u.gl;if(this.failedToCreate)return;u.program.set(this.program),u.setDepthMode(y),u.setStencilMode(A),u.setColorMode(S),u.setCullFace(B);for(const Wt of Object.keys(this.fixedUniforms))this.fixedUniforms[Wt].set(this.program,Wt,G[Wt]);Ft&&Ft.setUniforms(this.program,u,this.binderUniforms,Mt,{zoom:Bt});const Ot={[Pt.LINES]:2,[Pt.TRIANGLES]:3,[Pt.LINE_STRIP]:1}[f];for(const Wt of _t.get()){const jt=Wt.vaos||(Wt.vaos={});(jt[W]||(jt[W]=new Ui)).bind(u,this,it,Ft?Ft.getPaintVertexBuffers():[],et,Wt.vertexOffset,Gt||[]),Pt.drawElements(f,Wt.primitiveLength*Ot,Pt.UNSIGNED_SHORT,Wt.primitiveOffset*Ot*2)}}}function ml(_,u){const f=Math.pow(2,u.tileID.overscaledZ),y=u.tileSize*Math.pow(2,_.transform.tileZoom)/f,A=y*(u.tileID.canonical.x+u.tileID.wrap*f),S=y*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_tile_units_to_pixels:1/ve(u,1,_.transform.tileZoom),u_pixel_coord_upper:[A>>16,S>>16],u_pixel_coord_lower:[65535&A,65535&S]}}const Da=r.create(),mc=(_,u,f,y,A,S,B,G,W,it,et)=>{const _t=u.style.light,Mt=_t.properties.get("position"),Bt=[Mt.x,Mt.y,Mt.z],Ft=r.create$1();_t.properties.get("anchor")==="viewport"&&(r.fromRotation(Ft,-u.transform.angle),r.transformMat3(Bt,Bt,Ft));const Gt=_t.properties.get("color"),Pt=u.transform,Ot={u_matrix:_,u_lightpos:Bt,u_lightintensity:_t.properties.get("intensity"),u_lightcolor:[Gt.r,Gt.g,Gt.b],u_vertical_gradient:+f,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Da,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:A,u_edge_radius:S};return Pt.projection.name==="globe"&&(Ot.u_tile_id=[B.canonical.x,B.canonical.y,1<<B.canonical.z],Ot.u_zoom_transition=W,Ot.u_inv_rot_matrix=et,Ot.u_merc_center=it,Ot.u_up_dir=Pt.projection.upVector(new r.CanonicalTileID(0,0,0),it[0]*r.EXTENT,it[1]*r.EXTENT),Ot.u_height_lift=G),Ot},Mr=(_,u,f,y,A,S,B,G,W,it,et,_t)=>{const Mt=mc(_,u,f,y,A,S,B,W,it,et,_t),Bt={u_height_factor:-Math.pow(2,B.overscaledZ)/G.tileSize/8};return r.extend(Mt,ml(u,G),Bt)},ia=_=>({u_matrix:_}),Zu=(_,u,f)=>r.extend(ia(_),ml(u,f)),ys=(_,u)=>({u_matrix:_,u_world:u}),Wo=(_,u,f,y)=>r.extend(Zu(_,u,f),{u_world:y}),ql=r.create(),Zs=(_,u,f,y,A,S)=>{const B=_.transform,G=B.projection.name==="globe";let W;if(S.paint.get("circle-pitch-alignment")==="map")if(G){const et=r.globePixelsToTileUnits(B.zoom,u.canonical)*B._pixelsPerMercatorPixel;W=Float32Array.from([et,0,0,et])}else W=B.calculatePixelsToTileUnitsMatrix(f);else W=new Float32Array([B.pixelsToGLUnits[0],0,0,B.pixelsToGLUnits[1]]);const it={u_camera_to_center_distance:B.cameraToCenterDistance,u_matrix:_.translatePosMatrix(u.projMatrix,f,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_device_pixel_ratio:r.exported.devicePixelRatio,u_extrude_scale:W,u_inv_rot_matrix:ql,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){it.u_inv_rot_matrix=y,it.u_merc_center=A,it.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],it.u_zoom_transition=r.globeToMercatorTransition(B.zoom);const et=A[0]*r.EXTENT,_t=A[1]*r.EXTENT;it.u_up_dir=B.projection.upVector(new r.CanonicalTileID(0,0,0),et,_t)}return it},Fc=_=>{const u=[];return _.paint.get("circle-pitch-alignment")==="map"&&u.push("PITCH_WITH_MAP"),_.paint.get("circle-pitch-scale")==="map"&&u.push("SCALE_WITH_MAP"),u},Na=(_,u,f,y)=>{const A=r.EXTENT/f.tileSize;return{u_matrix:_,u_camera_to_center_distance:u.getCameraToCenterDistance(y),u_extrude_scale:[u.pixelsToGLUnits[0]/A,u.pixelsToGLUnits[1]/A]}},xu=(_,u,f=1)=>({u_matrix:_,u_color:u,u_overlay:0,u_overlay_scale:f}),wu=r.create(),Sl=(_,u,f,y,A,S,B)=>{const G=_.transform,W=G.projection.name==="globe",it=W?r.globePixelsToTileUnits(G.zoom,u.canonical)*G._pixelsPerMercatorPixel:ve(f,1,S),et={u_matrix:u.projMatrix,u_extrude_scale:it,u_intensity:B,u_inv_rot_matrix:wu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(W){et.u_inv_rot_matrix=y,et.u_merc_center=A,et.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],et.u_zoom_transition=r.globeToMercatorTransition(G.zoom);const _t=A[0]*r.EXTENT,Mt=A[1]*r.EXTENT;et.u_up_dir=G.projection.upVector(new r.CanonicalTileID(0,0,0),_t,Mt)}return et},bu=(_,u,f,y,A,S,B)=>{const G=_.transform,W=G.calculatePixelsToTileUnitsMatrix(u);return{u_matrix:$a(_,u,f,y),u_pixels_to_tile_units:W,u_device_pixel_ratio:S,u_units_to_pixels:[1/G.pixelsToGLUnits[0],1/G.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:A,u_texsize:gc(f)?u.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:xs(u,_.transform),u_alpha_discard_threshold:0,u_trim_offset:B}},Ha=(_,u,f,y,A)=>{const S=_.transform;return{u_matrix:$a(_,u,f,y),u_texsize:u.imageAtlasTexture.size,u_pixels_to_tile_units:S.calculatePixelsToTileUnitsMatrix(u),u_device_pixel_ratio:A,u_image:0,u_tile_units_to_pixels:xs(u,S),u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function xs(_,u){return 1/ve(_,1,u.tileZoom)}function $a(_,u,f,y){return _.translatePosMatrix(y||u.tileID.projMatrix,u,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function gc(_){const u=_.paint.get("line-dasharray").value;return u.value||u.kind!=="constant"}const El=(_,u,f,y,A,S)=>{return{u_matrix:_,u_tl_parent:u,u_scale_parent:f,u_fade_t:y.mix,u_opacity:y.opacity*A.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:A.paint.get("raster-brightness-min"),u_brightness_high:A.paint.get("raster-brightness-max"),u_saturation_factor:(G=A.paint.get("raster-saturation"),G>0?1-1/(1.001-G):-G),u_contrast_factor:(B=A.paint.get("raster-contrast"),B>0?1/(1-B):1+B),u_spin_weights:ga(A.paint.get("raster-hue-rotate")),u_perspective_transform:S};var B,G};function ga(_){_*=Math.PI/180;const u=Math.sin(_),f=Math.cos(_);return[(2*f+1)/3,(-Math.sqrt(3)*u-f+1)/3,(Math.sqrt(3)*u-f+1)/3]}const ho=r.create(),Ml=(_,u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt)=>{const Pt=A.transform,Ot={u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:Pt.cameraToCenterDistance,u_rotate_symbol:+f,u_aspect_ratio:Pt.width/Pt.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:B,u_coord_matrix:G,u_is_text:+W,u_pitch_with_map:+y,u_texsize:it,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ho,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ho,u_up_vector:[0,-1,0]};return Gt.name==="globe"&&(Ot.u_tile_id=[et.canonical.x,et.canonical.y,1<<et.canonical.z],Ot.u_zoom_transition=_t,Ot.u_inv_rot_matrix=Bt,Ot.u_merc_center=Mt,Ot.u_camera_forward=Pt._camera.forward(),Ot.u_ecef_origin=r.globeECEFOrigin(Pt.globeMatrix,et.toUnwrapped()),Ot.u_tile_matrix=Float32Array.from(Pt.globeMatrix),Ot.u_up_vector=Ft),Ot},Ll=(_,u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt,Pt)=>r.extend(Ml(_,u,f,y,A,S,B,G,W,it,_t,Mt,Bt,Ft,Gt,Pt),{u_gamma_scale:y?A.transform.cameraToCenterDistance*Math.cos(A.terrain?0:A.transform._pitch):1,u_device_pixel_ratio:r.exported.devicePixelRatio,u_is_halo:+et}),Vu=(_,u,f,y,A,S,B,G,W,it,et,_t,Mt,Bt,Ft,Gt)=>r.extend(Ll(_,u,f,y,A,S,B,G,!0,W,!0,et,_t,Mt,Bt,Ft,Gt),{u_texsize_icon:it,u_texture_icon:1}),gl=(_,u,f)=>({u_matrix:_,u_opacity:u,u_color:f}),dr=(_,u,f,y,A)=>r.extend(function(S,B,G){const W=B.imageManager.getPattern(S.toString()),{width:it,height:et}=B.imageManager.getPixelSize(),_t=Math.pow(2,G.tileID.overscaledZ),Mt=G.tileSize*Math.pow(2,B.transform.tileZoom)/_t,Bt=Mt*(G.tileID.canonical.x+G.tileID.wrap*_t),Ft=Mt*G.tileID.canonical.y;return{u_image:0,u_pattern_tl:W.tl,u_pattern_br:W.br,u_texsize:[it,et],u_pattern_size:W.displaySize,u_tile_units_to_pixels:1/ve(G,1,B.transform.tileZoom),u_pixel_coord_upper:[Bt>>16,Ft>>16],u_pixel_coord_lower:[65535&Bt,65535&Ft]}}(y,f,A),{u_matrix:_,u_opacity:u}),Ls={fillExtrusion:_=>({u_matrix:new r.UniformMatrix4f(_),u_lightpos:new r.Uniform3f(_),u_lightintensity:new r.Uniform1f(_),u_lightcolor:new r.Uniform3f(_),u_vertical_gradient:new r.Uniform1f(_),u_opacity:new r.Uniform1f(_),u_edge_radius:new r.Uniform1f(_),u_ao:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_up_dir:new r.Uniform3f(_),u_height_lift:new r.Uniform1f(_)}),fillExtrusionPattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_lightpos:new r.Uniform3f(_),u_lightintensity:new r.Uniform1f(_),u_lightcolor:new r.Uniform3f(_),u_vertical_gradient:new r.Uniform1f(_),u_height_factor:new r.Uniform1f(_),u_edge_radius:new r.Uniform1f(_),u_ao:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_up_dir:new r.Uniform3f(_),u_height_lift:new r.Uniform1f(_),u_image:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_pixel_coord_upper:new r.Uniform2f(_),u_pixel_coord_lower:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_),u_opacity:new r.Uniform1f(_)}),fill:_=>({u_matrix:new r.UniformMatrix4f(_)}),fillPattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_image:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_pixel_coord_upper:new r.Uniform2f(_),u_pixel_coord_lower:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_)}),fillOutline:_=>({u_matrix:new r.UniformMatrix4f(_),u_world:new r.Uniform2f(_)}),fillOutlinePattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_world:new r.Uniform2f(_),u_image:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_pixel_coord_upper:new r.Uniform2f(_),u_pixel_coord_lower:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_)}),circle:_=>({u_camera_to_center_distance:new r.Uniform1f(_),u_extrude_scale:new r.UniformMatrix2f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_up_dir:new r.Uniform3f(_)}),collisionBox:_=>({u_matrix:new r.UniformMatrix4f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_extrude_scale:new r.Uniform2f(_)}),collisionCircle:_=>({u_matrix:new r.UniformMatrix4f(_),u_inv_matrix:new r.UniformMatrix4f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_viewport_size:new r.Uniform2f(_)}),debug:_=>({u_color:new r.UniformColor(_),u_matrix:new r.UniformMatrix4f(_),u_overlay:new r.Uniform1i(_),u_overlay_scale:new r.Uniform1f(_)}),clippingMask:_=>({u_matrix:new r.UniformMatrix4f(_)}),heatmap:_=>({u_extrude_scale:new r.Uniform1f(_),u_intensity:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_up_dir:new r.Uniform3f(_)}),heatmapTexture:_=>({u_image:new r.Uniform1i(_),u_color_ramp:new r.Uniform1i(_),u_opacity:new r.Uniform1f(_)}),hillshade:_=>({u_matrix:new r.UniformMatrix4f(_),u_image:new r.Uniform1i(_),u_latrange:new r.Uniform2f(_),u_light:new r.Uniform2f(_),u_shadow:new r.UniformColor(_),u_highlight:new r.UniformColor(_),u_accent:new r.UniformColor(_)}),hillshadePrepare:_=>({u_matrix:new r.UniformMatrix4f(_),u_image:new r.Uniform1i(_),u_dimension:new r.Uniform2f(_),u_zoom:new r.Uniform1f(_),u_unpack:new r.Uniform4f(_)}),line:_=>({u_matrix:new r.UniformMatrix4f(_),u_pixels_to_tile_units:new r.UniformMatrix2f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_units_to_pixels:new r.Uniform2f(_),u_dash_image:new r.Uniform1i(_),u_gradient_image:new r.Uniform1i(_),u_image_height:new r.Uniform1f(_),u_texsize:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_),u_alpha_discard_threshold:new r.Uniform1f(_),u_trim_offset:new r.Uniform2f(_)}),linePattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_texsize:new r.Uniform2f(_),u_pixels_to_tile_units:new r.UniformMatrix2f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_image:new r.Uniform1i(_),u_units_to_pixels:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_),u_alpha_discard_threshold:new r.Uniform1f(_)}),raster:_=>({u_matrix:new r.UniformMatrix4f(_),u_tl_parent:new r.Uniform2f(_),u_scale_parent:new r.Uniform1f(_),u_fade_t:new r.Uniform1f(_),u_opacity:new r.Uniform1f(_),u_image0:new r.Uniform1i(_),u_image1:new r.Uniform1i(_),u_brightness_low:new r.Uniform1f(_),u_brightness_high:new r.Uniform1f(_),u_saturation_factor:new r.Uniform1f(_),u_contrast_factor:new r.Uniform1f(_),u_spin_weights:new r.Uniform3f(_),u_perspective_transform:new r.Uniform2f(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new r.Uniform1i(_),u_is_size_feature_constant:new r.Uniform1i(_),u_size_t:new r.Uniform1f(_),u_size:new r.Uniform1f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_rotate_symbol:new r.Uniform1i(_),u_aspect_ratio:new r.Uniform1f(_),u_fade_change:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_label_plane_matrix:new r.UniformMatrix4f(_),u_coord_matrix:new r.UniformMatrix4f(_),u_is_text:new r.Uniform1i(_),u_pitch_with_map:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_camera_forward:new r.Uniform3f(_),u_tile_matrix:new r.UniformMatrix4f(_),u_up_vector:new r.Uniform3f(_),u_ecef_origin:new r.Uniform3f(_),u_texture:new r.Uniform1i(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new r.Uniform1i(_),u_is_size_feature_constant:new r.Uniform1i(_),u_size_t:new r.Uniform1f(_),u_size:new r.Uniform1f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_rotate_symbol:new r.Uniform1i(_),u_aspect_ratio:new r.Uniform1f(_),u_fade_change:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_label_plane_matrix:new r.UniformMatrix4f(_),u_coord_matrix:new r.UniformMatrix4f(_),u_is_text:new r.Uniform1i(_),u_pitch_with_map:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_texture:new r.Uniform1i(_),u_gamma_scale:new r.Uniform1f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_tile_id:new r.Uniform3f(_),u_zoom_transition:new r.Uniform1f(_),u_inv_rot_matrix:new r.UniformMatrix4f(_),u_merc_center:new r.Uniform2f(_),u_camera_forward:new r.Uniform3f(_),u_tile_matrix:new r.UniformMatrix4f(_),u_up_vector:new r.Uniform3f(_),u_ecef_origin:new r.Uniform3f(_),u_is_halo:new r.Uniform1i(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new r.Uniform1i(_),u_is_size_feature_constant:new r.Uniform1i(_),u_size_t:new r.Uniform1f(_),u_size:new r.Uniform1f(_),u_camera_to_center_distance:new r.Uniform1f(_),u_rotate_symbol:new r.Uniform1i(_),u_aspect_ratio:new r.Uniform1f(_),u_fade_change:new r.Uniform1f(_),u_matrix:new r.UniformMatrix4f(_),u_label_plane_matrix:new r.UniformMatrix4f(_),u_coord_matrix:new r.UniformMatrix4f(_),u_is_text:new r.Uniform1i(_),u_pitch_with_map:new r.Uniform1i(_),u_texsize:new r.Uniform2f(_),u_texsize_icon:new r.Uniform2f(_),u_texture:new r.Uniform1i(_),u_texture_icon:new r.Uniform1i(_),u_gamma_scale:new r.Uniform1f(_),u_device_pixel_ratio:new r.Uniform1f(_),u_is_halo:new r.Uniform1i(_)}),background:_=>({u_matrix:new r.UniformMatrix4f(_),u_opacity:new r.Uniform1f(_),u_color:new r.UniformColor(_)}),backgroundPattern:_=>({u_matrix:new r.UniformMatrix4f(_),u_opacity:new r.Uniform1f(_),u_image:new r.Uniform1i(_),u_pattern_tl:new r.Uniform2f(_),u_pattern_br:new r.Uniform2f(_),u_texsize:new r.Uniform2f(_),u_pattern_size:new r.Uniform2f(_),u_pixel_coord_upper:new r.Uniform2f(_),u_pixel_coord_lower:new r.Uniform2f(_),u_tile_units_to_pixels:new r.Uniform1f(_)}),terrainRaster:sr,terrainDepth:sr,skybox:_=>({u_matrix:new r.UniformMatrix4f(_),u_sun_direction:new r.Uniform3f(_),u_cubemap:new r.Uniform1i(_),u_opacity:new r.Uniform1f(_),u_temporal_offset:new r.Uniform1f(_)}),skyboxGradient:_=>({u_matrix:new r.UniformMatrix4f(_),u_color_ramp:new r.Uniform1i(_),u_center_direction:new r.Uniform3f(_),u_radius:new r.Uniform1f(_),u_opacity:new r.Uniform1f(_),u_temporal_offset:new r.Uniform1f(_)}),skyboxCapture:_=>({u_matrix_3f:new r.UniformMatrix3f(_),u_sun_direction:new r.Uniform3f(_),u_sun_intensity:new r.Uniform1f(_),u_color_tint_r:new r.Uniform4f(_),u_color_tint_m:new r.Uniform4f(_),u_luminance:new r.Uniform1f(_)}),globeRaster:_=>({u_proj_matrix:new r.UniformMatrix4f(_),u_globe_matrix:new r.UniformMatrix4f(_),u_normalize_matrix:new r.UniformMatrix4f(_),u_merc_matrix:new r.UniformMatrix4f(_),u_zoom_transition:new r.Uniform1f(_),u_merc_center:new r.Uniform2f(_),u_image0:new r.Uniform1i(_),u_grid_matrix:new r.UniformMatrix3f(_),u_frustum_tl:new r.Uniform3f(_),u_frustum_tr:new r.Uniform3f(_),u_frustum_br:new r.Uniform3f(_),u_frustum_bl:new r.Uniform3f(_),u_globe_pos:new r.Uniform3f(_),u_globe_radius:new r.Uniform1f(_),u_viewport:new r.Uniform2f(_)}),globeAtmosphere:_=>({u_frustum_tl:new r.Uniform3f(_),u_frustum_tr:new r.Uniform3f(_),u_frustum_br:new r.Uniform3f(_),u_frustum_bl:new r.Uniform3f(_),u_horizon:new r.Uniform1f(_),u_transition:new r.Uniform1f(_),u_fadeout_range:new r.Uniform1f(_),u_color:new r.Uniform4f(_),u_high_color:new r.Uniform4f(_),u_space_color:new r.Uniform4f(_),u_star_intensity:new r.Uniform1f(_),u_star_density:new r.Uniform1f(_),u_star_size:new r.Uniform1f(_),u_temporal_offset:new r.Uniform1f(_),u_horizon_angle:new r.Uniform1f(_),u_rotation_matrix:new r.UniformMatrix4f(_)})};let Xo;function ws(_,u,f,y,A,S,B){const G=_.context,W=G.gl,it=_.transform,et=_.useProgram("collisionBox"),_t=[];let Mt=0,Bt=0;for(let Kt=0;Kt<y.length;Kt++){const me=y[Kt],re=u.getTile(me),Ae=re.getBucket(f);if(!Ae)continue;const He=is(me,Ae,it);let je=He;A[0]===0&&A[1]===0||(je=_.translatePosMatrix(He,re,A,S));const De=B?Ae.textCollisionBox:Ae.iconCollisionBox,An=Ae.collisionCircleArray;if(An.length>0){const Fe=r.create(),fn=je;r.mul(Fe,Ae.placementInvProjMatrix,it.glCoordMatrix),r.mul(Fe,Fe,Ae.placementViewportMatrix),_t.push({circleArray:An,circleOffset:Bt,transform:fn,invTransform:Fe,projection:Ae.getProjection()}),Mt+=An.length/4,Bt=Mt}De&&(_.terrain&&_.terrain.setupElevationDraw(re,et),et.draw(G,W.LINES,r.DepthMode.disabled,r.StencilMode.disabled,_.colorModeForRenderPass(),r.CullFaceMode.disabled,Na(je,it,re,Ae.getProjection()),f.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,null,it.zoom,null,[De.collisionVertexBuffer,De.collisionVertexBufferExt]))}if(!B||!_t.length)return;const Ft=_.useProgram("collisionCircle"),Gt=new r.StructArrayLayout2f1f2i16;Gt.resize(4*Mt),Gt._trim();let Pt=0;for(const Kt of _t)for(let me=0;me<Kt.circleArray.length/4;me++){const re=4*me,Ae=Kt.circleArray[re+0],He=Kt.circleArray[re+1],je=Kt.circleArray[re+2],De=Kt.circleArray[re+3];Gt.emplace(Pt++,Ae,He,je,De,0),Gt.emplace(Pt++,Ae,He,je,De,1),Gt.emplace(Pt++,Ae,He,je,De,2),Gt.emplace(Pt++,Ae,He,je,De,3)}(!Xo||Xo.length<2*Mt)&&(Xo=function(Kt){const me=2*Kt,re=new r.StructArrayLayout3ui6;re.resize(me),re._trim();for(let Ae=0;Ae<me;Ae++){const He=6*Ae;re.uint16[He+0]=4*Ae+0,re.uint16[He+1]=4*Ae+1,re.uint16[He+2]=4*Ae+2,re.uint16[He+3]=4*Ae+2,re.uint16[He+4]=4*Ae+3,re.uint16[He+5]=4*Ae+0}return re}(Mt));const Ot=G.createIndexBuffer(Xo,!0),Wt=G.createVertexBuffer(Gt,r.collisionCircleLayout.members,!0);for(const Kt of _t){const me={u_matrix:Kt.transform,u_inv_matrix:Kt.invTransform,u_camera_to_center_distance:(jt=it).getCameraToCenterDistance(Kt.projection),u_viewport_size:[jt.width,jt.height]};Ft.draw(G,W.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,_.colorModeForRenderPass(),r.CullFaceMode.disabled,me,f.id,Wt,Ot,r.SegmentVector.simpleSegment(0,2*Kt.circleOffset,Kt.circleArray.length,Kt.circleArray.length/2),null,it.zoom)}var jt;Wt.destroy(),Ot.destroy()}const _l=r.create();function Wu({width:_,height:u,anchor:f,textOffset:y,textScale:A},S){const{horizontalAlign:B,verticalAlign:G}=r.getAnchorAlignment(f),W=-(B-.5)*_,it=-(G-.5)*u,et=r.evaluateVariableOffset(f,y);return new r.pointGeometry((W/A+et[0])*S,(it/A+et[1])*S)}function Jl(_,u,f,y,A,S,B,G,W,it,et){const _t=_.text.placedSymbolArray,Mt=_.text.dynamicLayoutVertexArray,Bt=_.icon.dynamicLayoutVertexArray,Ft={},Gt=_.getProjection(),Pt=da(G,Gt,S),Ot=S.elevation,Wt=Gt.upVectorScale(G.canonical,S.center.lat,S.worldSize).metersToTile;Mt.clear();for(let jt=0;jt<_t.length;jt++){const Kt=_t.get(jt),{tileAnchorX:me,tileAnchorY:re,numGlyphs:Ae}=Kt,He=_.allowVerticalPlacement&&!Kt.placedOrientation,je=Kt.hidden||!Kt.crossTileID||He?null:y[Kt.crossTileID];if(je){let De=0,An=0,Fe=0;if(Ot){const ri=Ot?Ot.getAtTileOffset(G,me,re):0,[fi,oi,Li]=Gt.upVector(G.canonical,me,re);De=ri*fi*Wt,An=ri*oi*Wt,Fe=ri*Li*Wt}let[fn,Je,Ln,tn]=Co(Kt.projectedAnchorX+De,Kt.projectedAnchorY+An,Kt.projectedAnchorZ+Fe,f?Pt:B);const xn=jn(S.getCameraToCenterDistance(Gt),tn);let zn=A.evaluateSizeForFeature(_.textSizeData,it,Kt)*xn/r.ONE_EM;f&&(zn*=_.tilePixelRatio/W);const Ne=Wu(je,zn);f?({x:fn,y:Je,z:Ln}=Gt.projectTilePoint(me+Ne.x,re+Ne.y,G.canonical),[fn,Je,Ln]=Co(fn+De,Je+An,Ln+Fe,B)):(u&&Ne._rotate(-S.angle),fn+=Ne.x,Je+=Ne.y,Ln=0);const $e=_.allowVerticalPlacement&&Kt.placedOrientation===r.WritingMode.vertical?Math.PI/2:0;for(let ri=0;ri<Ae;ri++)r.addDynamicAttributes(Mt,fn,Je,Ln,$e);et&&Kt.associatedIconIndex>=0&&(Ft[Kt.associatedIconIndex]={x:fn,y:Je,z:Ln,angle:$e})}else Nr(Ae,Mt)}if(et){Bt.clear();const jt=_.icon.placedSymbolArray;for(let Kt=0;Kt<jt.length;Kt++){const me=jt.get(Kt),{numGlyphs:re}=me,Ae=Ft[Kt];if(me.hidden||!Ae)Nr(re,Bt);else{const{x:He,y:je,z:De,angle:An}=Ae;for(let Fe=0;Fe<re;Fe++)r.addDynamicAttributes(Bt,He,je,De,An)}}_.icon.dynamicLayoutVertexBuffer.updateData(Bt)}_.text.dynamicLayoutVertexBuffer.updateData(Mt)}function Yu(_,u,f){return f.iconsInText&&u?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function ks(_,u,f,y,A,S,B,G,W,it,et,_t){const Mt=_.context,Bt=Mt.gl,Ft=_.transform,Gt=G==="map",Pt=W==="map",Ot=Gt&&f.layout.get("symbol-placement")!=="point",Wt=Gt&&!Pt&&!Ot,jt=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Kt=!1;const me=_.depthModeForSublayer(0,r.DepthMode.ReadOnly),re=[r.mercatorXfromLng(Ft.center.lng),r.mercatorYfromLat(Ft.center.lat)],Ae=f.layout.get("text-variable-anchor"),He=Ft.projection.name==="globe",je=[],De=[0,-1,0];let An=De;!He&&!Ft.mercatorFromTransition||Gt||(An=function(Fe){const fn=Fe._camera.getWorldToCamera(Fe.worldSize,1),Je=r.multiply([],fn,Fe.globeMatrix);r.invert(Je,Je);const Ln=[0,0,0],tn=[0,1,0,0];return r.transformMat4$1(tn,tn,Je),Ln[0]=tn[0],Ln[1]=tn[1],Ln[2]=tn[2],r.normalize(Ln,Ln),Ln}(Ft));for(const Fe of y){const fn=u.getTile(Fe),Je=fn.getBucket(f);if(!Je||Je.projection.name==="mercator"&&He)continue;const Ln=A?Je.text:Je.icon;if(!Ln||Je.fullyClipped||!Ln.segments.get().length)continue;const tn=Ln.programConfigurations.get(f.id),xn=A||Je.sdfIcons,zn=A?Je.textSizeData:Je.iconSizeData,Ne=Pt||Ft.pitch!==0,$e=r.evaluateSizeForZoom(zn,Ft.zoom);let ri,fi,oi,Li,Ki=[0,0],gi=null;if(A){if(fi=fn.glyphAtlasTexture,oi=Bt.LINEAR,ri=fn.glyphAtlasTexture.size,Je.iconsInText){Ki=fn.imageAtlasTexture.size,gi=fn.imageAtlasTexture;const Ja=zn.kind==="composite"||zn.kind==="camera";Li=Ne||_.options.rotating||_.options.zooming||Ja?Bt.LINEAR:Bt.NEAREST}}else{const Ja=f.layout.get("icon-size").constantOr(0)!==1||Je.iconsNeedLinear;fi=fn.imageAtlasTexture,oi=xn||_.options.rotating||_.options.zooming||Ja||Ne?Bt.LINEAR:Bt.NEAREST,ri=fn.imageAtlasTexture.size}const Kn=Je.projection.name==="globe",Hr=Kn?An:De,Dr=Kn?r.globeToMercatorTransition(Ft.zoom):0,to=da(Fe,Je.getProjection(),Ft),Wr=Ft.calculatePixelsToTileUnitsMatrix(fn),qa=Io(to,fn.tileID.canonical,Pt,Gt,Ft,Je.getProjection(),Wr),Ra=_.terrain&&Pt&&Ot?r.invert(r.create(),qa):_l,va=Kr(to,fn.tileID.canonical,Pt,Gt,Ft,Je.getProjection(),Wr),ru=Ae&&Je.hasTextData(),mo=f.layout.get("icon-text-fit")!=="none"&&ru&&Je.hasIconData();if(Ot){const Ja=Ft.elevation,Au=Ja?Ja.getAtTileOffsetFunc(Fe,Ft.center.lat,Ft.worldSize,Je.getProjection()):null,Nl=cr(to,fn.tileID.canonical,Pt,Gt,Ft,Je.getProjection(),Wr);Oi(Je,to,_,A,Nl,va,Pt,it,Au,Fe)}const Yr=Ot||A&&Ae||mo,kr=_.translatePosMatrix(to,fn,S,B),Ho=Yr?_l:qa,sa=_.translatePosMatrix(va,fn,S,B,!0),go=Je.getProjection().createInversionMatrix(Ft,Fe.canonical),ya=[];_.terrainRenderModeElevated()&&Pt&&ya.push("PITCH_WITH_MAP_TERRAIN"),Kn&&ya.push("PROJECTION_GLOBE_VIEW"),Yr&&ya.push("PROJECTED_POS_ON_VIEWPORT");const Zh=xn&&f.paint.get(A?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ou;ou=xn?Je.iconsInText?Vu(zn.kind,$e,Wt,Pt,_,kr,Ho,sa,ri,Ki,Fe,Dr,re,go,Hr,Je.getProjection()):Ll(zn.kind,$e,Wt,Pt,_,kr,Ho,sa,A,ri,!0,Fe,Dr,re,go,Hr,Je.getProjection()):Ml(zn.kind,$e,Wt,Pt,_,kr,Ho,sa,A,ri,Fe,Dr,re,go,Hr,Je.getProjection());const aa={program:_.useProgram(Yu(xn,A,Je),tn,ya),buffers:Ln,uniformValues:ou,atlasTexture:fi,atlasTextureIcon:gi,atlasInterpolation:oi,atlasInterpolationIcon:Li,isSDF:xn,hasHalo:Zh,tile:fn,labelPlaneMatrixInv:Ra};if(jt&&Je.canOverlap){Kt=!0;const Ja=Ln.segments.get();for(const Au of Ja)je.push({segments:new r.SegmentVector([Au]),sortKey:Au.sortKey,state:aa})}else je.push({segments:Ln.segments,sortKey:0,state:aa})}Kt&&je.sort((Fe,fn)=>Fe.sortKey-fn.sortKey);for(const Fe of je){const fn=Fe.state;if(_.terrain&&_.terrain.setupElevationDraw(fn.tile,fn.program,{useDepthForOcclusion:!He,labelPlaneMatrixInv:fn.labelPlaneMatrixInv}),Mt.activeTexture.set(Bt.TEXTURE0),fn.atlasTexture.bind(fn.atlasInterpolation,Bt.CLAMP_TO_EDGE),fn.atlasTextureIcon&&(Mt.activeTexture.set(Bt.TEXTURE1),fn.atlasTextureIcon&&fn.atlasTextureIcon.bind(fn.atlasInterpolationIcon,Bt.CLAMP_TO_EDGE)),fn.isSDF){const Je=fn.uniformValues;fn.hasHalo&&(Je.u_is_halo=1,ze(fn.buffers,Fe.segments,f,_,fn.program,me,et,_t,Je)),Je.u_is_halo=0}ze(fn.buffers,Fe.segments,f,_,fn.program,me,et,_t,fn.uniformValues)}}function ze(_,u,f,y,A,S,B,G,W){const it=y.context,et=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.globeExtVertexBuffer];A.draw(it,it.gl.TRIANGLES,S,B,G,r.CullFaceMode.disabled,W,f.id,_.layoutVertexBuffer,_.indexBuffer,u,f.paint,y.transform.zoom,_.programConfigurations.get(f.id),et)}function gn(_,u,f,y,A,S,B){const G=_.context.gl,W=f.paint.get("fill-pattern"),it=W&&W.constantOr(1);let et,_t,Mt,Bt,Ft;B?(_t=it&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",et=G.LINES):(_t=it?"fillPattern":"fill",et=G.TRIANGLES);for(const Gt of y){const Pt=u.getTile(Gt);if(it&&!Pt.patternsLoaded())continue;const Ot=Pt.getBucket(f);if(!Ot)continue;_.prepareDrawTile();const Wt=Ot.programConfigurations.get(f.id),jt=_.useProgram(_t,Wt);it&&(_.context.activeTexture.set(G.TEXTURE0),Pt.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),Wt.updatePaintBuffers());const Kt=W.constantOr(null);if(Kt&&Pt.imageAtlas){const re=Pt.imageAtlas.patternPositions[Kt.toString()];re&&Wt.setConstantPatternPositions(re)}const me=_.translatePosMatrix(Gt.projMatrix,Pt,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(B){Bt=Ot.indexBuffer2,Ft=Ot.segments2;const re=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[G.drawingBufferWidth,G.drawingBufferHeight];Mt=_t==="fillOutlinePattern"&&it?Wo(me,_,Pt,re):ys(me,re)}else Bt=Ot.indexBuffer,Ft=Ot.segments,Mt=it?Zu(me,_,Pt):ia(me);_.prepareDrawProgram(_.context,jt,Gt.toUnwrapped()),jt.draw(_.context,et,A,_.stencilModeForClipping(Gt),S,r.CullFaceMode.disabled,Mt,f.id,Ot.layoutVertexBuffer,Bt,Ft,f.paint,_.transform.zoom,Wt)}}function on(_,u,f,y,A,S,B){const G=_.context,W=G.gl,it=_.transform,et=f.paint.get("fill-extrusion-pattern"),_t=et.constantOr(1),Mt=f.paint.get("fill-extrusion-opacity"),Bt=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),f.paint.get("fill-extrusion-ambient-occlusion-radius")],Ft=f.layout.get("fill-extrusion-edge-radius"),Gt=it.projection.name==="globe"?r.fillExtrusionHeightLift():0,Pt=it.projection.name==="globe",Ot=Pt?r.globeToMercatorTransition(it.zoom):0,Wt=[r.mercatorXfromLng(it.center.lng),r.mercatorYfromLat(it.center.lat)],jt=[];Pt&&(jt.push("PROJECTION_GLOBE_VIEW"),_.style.terrainSetForDrapingOnly()&&jt.push("TERRAIN")),Bt[0]>0&&jt.push("FAUX_AO");for(const Kt of y){const me=u.getTile(Kt),re=me.getBucket(f);if(!re||re.projection.name!==it.projection.name)continue;const Ae=re.programConfigurations.get(f.id),He=_.useProgram(_t?"fillExtrusionPattern":"fillExtrusion",Ae,jt);if(_.terrain){const Ln=_.terrain;if(_.style.terrainSetForDrapingOnly())Ln.setupElevationDraw(me,He,{useMeterToDem:!0});else{if(!re.enableTerrain)continue;if(Ln.setupElevationDraw(me,He,{useMeterToDem:!0}),ni(G,u,Kt,re,f,Ln),!re.centroidVertexBuffer){const tn=He.attributes.a_centroid_pos;tn!==void 0&&W.vertexAttrib2f(tn,0,0)}}}_t&&(_.context.activeTexture.set(W.TEXTURE0),me.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Ae.updatePaintBuffers());const je=et.constantOr(null);if(je&&me.imageAtlas){const Ln=me.imageAtlas.patternPositions[je.toString()];Ln&&Ae.setConstantPatternPositions(Ln)}const De=_.translatePosMatrix(Kt.projMatrix,me,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),An=it.projection.createInversionMatrix(it,Kt.canonical),Fe=f.paint.get("fill-extrusion-vertical-gradient"),fn=_t?Mr(De,_,Fe,Mt,Bt,Ft,Kt,me,Gt,Ot,Wt,An):mc(De,_,Fe,Mt,Bt,Ft,Kt,Gt,Ot,Wt,An);_.prepareDrawProgram(G,He,Kt.toUnwrapped());const Je=[];_.terrain&&Je.push(re.centroidVertexBuffer),Pt&&Je.push(re.layoutVertexExtBuffer),He.draw(G,G.gl.TRIANGLES,A,S,B,r.CullFaceMode.backCCW,fn,f.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,f.paint,_.transform.zoom,Ae,Je)}}function ni(_,u,f,y,A,S){const B=[Ot=>{let Wt=Ot.canonical.x-1,jt=Ot.wrap;return Wt<0&&(Wt=(1<<Ot.canonical.z)-1,jt--),new r.OverscaledTileID(Ot.overscaledZ,jt,Ot.canonical.z,Wt,Ot.canonical.y)},Ot=>{let Wt=Ot.canonical.x+1,jt=Ot.wrap;return Wt===1<<Ot.canonical.z&&(Wt=0,jt++),new r.OverscaledTileID(Ot.overscaledZ,jt,Ot.canonical.z,Wt,Ot.canonical.y)},Ot=>new r.OverscaledTileID(Ot.overscaledZ,Ot.wrap,Ot.canonical.z,Ot.canonical.x,(Ot.canonical.y===0?1<<Ot.canonical.z:Ot.canonical.y)-1),Ot=>new r.OverscaledTileID(Ot.overscaledZ,Ot.wrap,Ot.canonical.z,Ot.canonical.x,Ot.canonical.y===(1<<Ot.canonical.z)-1?0:Ot.canonical.y+1)],G=Ot=>{const Wt=u.getSource().minzoom,jt=me=>{const re=u.getTileByID(me);if(re&&re.hasData())return re.getBucket(A)},Kt=[0,-1,1];for(const me of Kt){if(Ot.overscaledZ+me<Wt)continue;const re=jt(Ot.calculateScaledKey(Ot.overscaledZ+me));if(re)return re}},W=[0,0,0],it=(Ot,Wt)=>(W[0]=Math.min(Ot.min.y,Wt.min.y),W[1]=Math.max(Ot.max.y,Wt.max.y),W[2]=r.EXTENT-Wt.min.x>Ot.max.x?Wt.min.x-r.EXTENT:Ot.max.x,W),et=(Ot,Wt)=>(W[0]=Math.min(Ot.min.x,Wt.min.x),W[1]=Math.max(Ot.max.x,Wt.max.x),W[2]=r.EXTENT-Wt.min.y>Ot.max.y?Wt.min.y-r.EXTENT:Ot.max.y,W),_t=[(Ot,Wt)=>it(Ot,Wt),(Ot,Wt)=>it(Wt,Ot),(Ot,Wt)=>et(Ot,Wt),(Ot,Wt)=>et(Wt,Ot)],Mt=new r.pointGeometry(0,0);let Bt,Ft,Gt;const Pt=(Ot,Wt,jt,Kt,me)=>{const re=[[Kt?jt:Ot,Kt?Ot:jt,0],[Kt?jt:Wt,Kt?Wt:jt,0]],Ae=me<0?r.EXTENT+me:me,He=[Kt?Ae:(Ot+Wt)/2,Kt?(Ot+Wt)/2:Ae,0];return jt===0&&me<0||jt!==0&&me>0?S.getForTilePoints(Gt,[He],!0,Ft):re.push(He),S.getForTilePoints(f,re,!0,Bt),Math.max(re[0][2],re[1][2],He[2])/S.exaggeration()};for(let Ot=0;Ot<4;Ot++){const Wt=(Ot<2?1:5)-Ot,jt=y.borders[Ot];if(jt.length===0)continue;const Kt=Gt=B[Ot](f),me=G(Kt);if(!(me&&me instanceof r.FillExtrusionBucket&&me.enableTerrain)||y.borderDoneWithNeighborZ[Ot]===me.canonical.z&&me.borderDoneWithNeighborZ[Wt]===y.canonical.z||(Ft=S.findDEMTileFor(Kt),!Ft||!Ft.dem))continue;if(!Bt){const je=S.findDEMTileFor(f);if(!je||!je.dem)return;Bt=je}const re=me.borders[Wt];let Ae=0;const He=me.borderDoneWithNeighborZ[Wt]!==y.canonical.z;if(y.canonical.z===me.canonical.z){for(let je=0;je<jt.length;je++){const De=y.featuresOnBorder[jt[je]],An=De.borders[Ot];let Fe;for(;Ae<re.length&&(Fe=me.featuresOnBorder[re[Ae]],!(Fe.borders[Wt][1]>An[0]+3));)He&&me.encodeCentroid(void 0,Fe,!1),Ae++;if(Fe&&Ae<re.length){const fn=Ae;let Je=0;for(;!(Fe.borders[Wt][0]>An[1]-3)&&(Je++,++Ae!==re.length);)Fe=me.featuresOnBorder[re[Ae]];if(Fe=me.featuresOnBorder[re[fn]],De.intersectsCount()>1||Fe.intersectsCount()>1||Je!==1){Je!==1&&(Ae=fn),y.encodeCentroid(void 0,De,!1),He&&me.encodeCentroid(void 0,Fe,!1);continue}const Ln=_t[Ot](De,Fe),tn=Ot%2?r.EXTENT-1:0;Mt.x=Pt(Ln[0],Math.min(r.EXTENT-1,Ln[1]),tn,Ot<2,Ln[2]),Mt.y=0,y.encodeCentroid(Mt,De,!1),He&&me.encodeCentroid(Mt,Fe,!1)}else y.encodeCentroid(void 0,De,!1)}y.borderDoneWithNeighborZ[Ot]=me.canonical.z,y.needsCentroidUpdate=!0,He&&(me.borderDoneWithNeighborZ[Wt]=y.canonical.z,me.needsCentroidUpdate=!0)}else{for(const je of jt)y.encodeCentroid(void 0,y.featuresOnBorder[je],!1);if(He){for(const je of re)me.encodeCentroid(void 0,me.featuresOnBorder[je],!1);me.borderDoneWithNeighborZ[Wt]=y.canonical.z,me.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[Ot]=me.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(_)}const Bi=new r.Color(1,0,0,1),Sr=new r.Color(0,1,0,1),Do=new r.Color(0,0,1,1),Lr=new r.Color(1,0,1,1),Ps=new r.Color(0,1,1,1);function Kl(_,u,f){const y=_.context,A=_.transform,S=y.gl,B=A.projection.name==="globe",G=B?["PROJECTION_GLOBE_VIEW"]:null;let W=f.projMatrix;if(B&&r.globeToMercatorTransition(A.zoom)>0){const De=r.transitionTileAABBinECEF(f.canonical,A),An=r.globeDenormalizeECEF(De);W=r.multiply(new Float32Array(16),A.globeMatrix,An),r.multiply(W,A.projMatrix,W)}const it=_.useProgram("debug",null,G),et=u.getTileByID(f.key);_.terrain&&_.terrain.setupElevationDraw(et,it);const _t=r.DepthMode.disabled,Mt=r.StencilMode.disabled,Bt=_.colorModeForRenderPass(),Ft="$debug";y.activeTexture.set(S.TEXTURE0),_.emptyTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),B?et._makeGlobeTileDebugBuffers(_.context,A):et._makeDebugTileBoundsBuffers(_.context,A.projection);const Gt=et._tileDebugBuffer||_.debugBuffer,Pt=et._tileDebugIndexBuffer||_.debugIndexBuffer,Ot=et._tileDebugSegments||_.debugSegments;it.draw(y,S.LINE_STRIP,_t,Mt,Bt,r.CullFaceMode.disabled,xu(W,r.Color.red),Ft,Gt,Pt,Ot,null,null,null,[et._globeTileDebugBorderBuffer]);const Wt=et.latestRawTileData,jt=Math.floor((Wt&&Wt.byteLength||0)/1024),Kt=u.getTile(f).tileSize,me=512/Math.min(Kt,512)*(f.overscaledZ/A.zoom)*.5;let re=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(re+=` => ${f.overscaledZ}`),re+=` ${jt}kb`,function(De,An){De.initDebugOverlayCanvas();const Fe=De.debugOverlayCanvas,fn=De.context.gl,Je=De.debugOverlayCanvas.getContext("2d");Je.clearRect(0,0,Fe.width,Fe.height),Je.shadowColor="white",Je.shadowBlur=2,Je.lineWidth=1.5,Je.strokeStyle="white",Je.textBaseline="top",Je.font="bold 36px Open Sans, sans-serif",Je.fillText(An,5,5),Je.strokeText(An,5,5),De.debugOverlayTexture.update(Fe),De.debugOverlayTexture.bind(fn.LINEAR,fn.CLAMP_TO_EDGE)}(_,re);const Ae=et._tileDebugTextBuffer||_.debugBuffer,He=et._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,je=et._tileDebugTextSegments||_.debugSegments;it.draw(y,S.TRIANGLES,_t,Mt,r.ColorMode.alphaBlended,r.CullFaceMode.disabled,xu(W,r.Color.transparent,me),Ft,Ae,He,je,null,null,null,[et._globeTileDebugTextBuffer])}function Vs(_,u,f,y){ae(_,0,u+f/2,_.transform.width,f,y)}function Nt(_,u,f,y){ae(_,u-f/2,0,f,_.transform.height,y)}function ae(_,u,f,y,A,S){const B=_.context,G=B.gl;G.enable(G.SCISSOR_TEST),G.scissor(u*r.exported.devicePixelRatio,f*r.exported.devicePixelRatio,y*r.exported.devicePixelRatio,A*r.exported.devicePixelRatio),B.clear({color:S}),G.disable(G.SCISSOR_TEST)}const Ce=r.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:vn}=Ce;function ke(_,u,f,y){_.emplaceBack(u,f,y)}class rn{constructor(u){this.vertexArray=new r.StructArrayLayout3f12,this.indices=new r.StructArrayLayout3ui6,ke(this.vertexArray,-1,-1,1),ke(this.vertexArray,1,-1,1),ke(this.vertexArray,-1,1,1),ke(this.vertexArray,1,1,1),ke(this.vertexArray,-1,-1,-1),ke(this.vertexArray,1,-1,-1),ke(this.vertexArray,-1,1,-1),ke(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=u.createVertexBuffer(this.vertexArray,vn),this.indexBuffer=u.createIndexBuffer(this.indices),this.segment=r.SegmentVector.simpleSegment(0,0,36,12)}}function Sn(_,u,f,y,A,S){const B=_.gl,G=u.paint.get("sky-atmosphere-color"),W=u.paint.get("sky-atmosphere-halo-color"),it=u.paint.get("sky-atmosphere-sun-intensity"),et=((_t,Mt,Bt,Ft,Gt)=>({u_matrix_3f:_t,u_sun_direction:Mt,u_sun_intensity:Bt,u_color_tint_r:[Ft.r,Ft.g,Ft.b,Ft.a],u_color_tint_m:[Gt.r,Gt.g,Gt.b,Gt.a],u_luminance:5e-5}))(r.fromMat4(r.create$1(),y),A,it,G,W);B.framebufferTexture2D(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_CUBE_MAP_POSITIVE_X+S,u.skyboxTexture,0),f.draw(_,B.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.frontCW,et,"skyboxCapture",u.skyboxGeometry.vertexBuffer,u.skyboxGeometry.indexBuffer,u.skyboxGeometry.segment)}const Yn=r.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Mn{constructor(u){const f=new r.StructArrayLayout5f20;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const y=new r.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=u.createVertexBuffer(f,Yn.members),this.indexBuffer=u.createIndexBuffer(y),this.segments=r.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const bi={symbol:function(_,u,f,y,A){if(_.renderPass!=="translucent")return;const S=r.StencilMode.disabled,B=_.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(G,W,it,et,_t,Mt,Bt){const Ft=W.transform,Gt=_t==="map",Pt=Mt==="map";for(const Ot of G){const Wt=et.getTile(Ot),jt=Wt.getBucket(it);if(!jt||!jt.text||!jt.text.segments.get().length)continue;const Kt=r.evaluateSizeForZoom(jt.textSizeData,Ft.zoom),me=da(Ot,jt.getProjection(),Ft),re=Ft.calculatePixelsToTileUnitsMatrix(Wt),Ae=Io(me,Wt.tileID.canonical,Pt,Gt,Ft,jt.getProjection(),re),He=it.layout.get("icon-text-fit")!=="none"&&jt.hasIconData();if(Kt){const je=Math.pow(2,Ft.zoom-Wt.tileID.overscaledZ);Jl(jt,Gt,Pt,Bt,r.symbolSize,Ft,Ae,Ot,je,Kt,He)}}}(y,_,f,u,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),A),f.paint.get("icon-opacity").constantOr(1)!==0&&ks(_,u,f,y,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),S,B),f.paint.get("text-opacity").constantOr(1)!==0&&ks(_,u,f,y,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),S,B),u.map.showCollisionBoxes&&(ws(_,u,f,y,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),ws(_,u,f,y,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(_,u,f,y){if(_.renderPass!=="translucent")return;const A=f.paint.get("circle-opacity"),S=f.paint.get("circle-stroke-width"),B=f.paint.get("circle-stroke-opacity"),G=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(A.constantOr(1)===0&&(S.constantOr(1)===0||B.constantOr(1)===0))return;const W=_.context,it=W.gl,et=_.transform,_t=_.depthModeForSublayer(0,r.DepthMode.ReadOnly),Mt=r.StencilMode.disabled,Bt=_.colorModeForRenderPass(),Ft=et.projection.name==="globe",Gt=[r.mercatorXfromLng(et.center.lng),r.mercatorYfromLat(et.center.lat)],Pt=[];for(let Wt=0;Wt<y.length;Wt++){const jt=y[Wt],Kt=u.getTile(jt),me=Kt.getBucket(f);if(!me||me.projection.name!==et.projection.name)continue;const re=me.programConfigurations.get(f.id),Ae=Fc(f);Ft&&Ae.push("PROJECTION_GLOBE_VIEW");const He=_.useProgram("circle",re,Ae),je=me.layoutVertexBuffer,De=me.globeExtVertexBuffer,An=me.indexBuffer,Fe=et.projection.createInversionMatrix(et,jt.canonical),fn={programConfiguration:re,program:He,layoutVertexBuffer:je,globeExtVertexBuffer:De,indexBuffer:An,uniformValues:Zs(_,jt,Kt,Fe,Gt,f),tile:Kt};if(G){const Je=me.segments.get();for(const Ln of Je)Pt.push({segments:new r.SegmentVector([Ln]),sortKey:Ln.sortKey,state:fn})}else Pt.push({segments:me.segments,sortKey:0,state:fn})}G&&Pt.sort((Wt,jt)=>Wt.sortKey-jt.sortKey);const Ot={useDepthForOcclusion:!Ft};for(const Wt of Pt){const{programConfiguration:jt,program:Kt,layoutVertexBuffer:me,globeExtVertexBuffer:re,indexBuffer:Ae,uniformValues:He,tile:je}=Wt.state,De=Wt.segments;_.terrain&&_.terrain.setupElevationDraw(je,Kt,Ot),_.prepareDrawProgram(W,Kt,je.tileID.toUnwrapped()),Kt.draw(W,it.TRIANGLES,_t,Mt,Bt,r.CullFaceMode.disabled,He,f.id,me,Ae,De,f.paint,et.zoom,jt,[re])}},heatmap:function(_,u,f,y){if(f.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const A=_.context,S=A.gl,B=r.StencilMode.disabled,G=new r.ColorMode([S.ONE,S.ONE],r.Color.transparent,[!0,!0,!0,!0]);(function(Bt,Ft,Gt,Pt){const Ot=Bt.gl,Wt=Ft.width*Pt,jt=Ft.height*Pt;Bt.activeTexture.set(Ot.TEXTURE1),Bt.viewport.set([0,0,Wt,jt]);let Kt=Gt.heatmapFbo;if(!Kt||Kt&&(Kt.width!==Wt||Kt.height!==jt)){Kt&&Kt.destroy();const me=Ot.createTexture();Ot.bindTexture(Ot.TEXTURE_2D,me),Ot.texParameteri(Ot.TEXTURE_2D,Ot.TEXTURE_WRAP_S,Ot.CLAMP_TO_EDGE),Ot.texParameteri(Ot.TEXTURE_2D,Ot.TEXTURE_WRAP_T,Ot.CLAMP_TO_EDGE),Ot.texParameteri(Ot.TEXTURE_2D,Ot.TEXTURE_MIN_FILTER,Ot.LINEAR),Ot.texParameteri(Ot.TEXTURE_2D,Ot.TEXTURE_MAG_FILTER,Ot.LINEAR),Kt=Gt.heatmapFbo=Bt.createFramebuffer(Wt,jt,!1),function(re,Ae,He,je,De,An){const Fe=re.gl;Fe.texImage2D(Fe.TEXTURE_2D,0,Fe.RGBA,De,An,0,Fe.RGBA,re.extRenderToTextureHalfFloat?re.extTextureHalfFloat.HALF_FLOAT_OES:Fe.UNSIGNED_BYTE,null),je.colorAttachment.set(He)}(Bt,0,me,Kt,Wt,jt)}else Ot.bindTexture(Ot.TEXTURE_2D,Kt.colorAttachment.get()),Bt.bindFramebuffer.set(Kt.framebuffer)})(A,_,f,_.transform.projection.name==="globe"?.5:.25),A.clear({color:r.Color.transparent});const W=_.transform,it=W.projection.name==="globe",et=it?["PROJECTION_GLOBE_VIEW"]:null,_t=it?r.CullFaceMode.frontCCW:r.CullFaceMode.disabled,Mt=[r.mercatorXfromLng(W.center.lng),r.mercatorYfromLat(W.center.lat)];for(let Bt=0;Bt<y.length;Bt++){const Ft=y[Bt];if(u.hasRenderableParent(Ft))continue;const Gt=u.getTile(Ft),Pt=Gt.getBucket(f);if(!Pt||Pt.projection.name!==W.projection.name)continue;const Ot=Pt.programConfigurations.get(f.id),Wt=_.useProgram("heatmap",Ot,et),{zoom:jt}=_.transform;_.terrain&&_.terrain.setupElevationDraw(Gt,Wt),_.prepareDrawProgram(A,Wt,Ft.toUnwrapped());const Kt=W.projection.createInversionMatrix(W,Ft.canonical);Wt.draw(A,S.TRIANGLES,r.DepthMode.disabled,B,G,_t,Sl(_,Ft,Gt,Kt,Mt,jt,f.paint.get("heatmap-intensity")),f.id,Pt.layoutVertexBuffer,Pt.indexBuffer,Pt.segments,f.paint,_.transform.zoom,Ot,it?[Pt.globeExtVertexBuffer]:null)}A.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(A,S){const B=A.context,G=B.gl,W=S.heatmapFbo;if(!W)return;B.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,W.colorAttachment.get()),B.activeTexture.set(G.TEXTURE1);let it=S.colorRampTexture;it||(it=S.colorRampTexture=new r.Texture(B,S.colorRamp,G.RGBA)),it.bind(G.LINEAR,G.CLAMP_TO_EDGE),A.useProgram("heatmapTexture").draw(B,G.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,A.colorModeForRenderPass(),r.CullFaceMode.disabled,((et,_t,Mt,Bt)=>({u_image:0,u_color_ramp:1,u_opacity:_t.paint.get("heatmap-opacity")}))(0,S),S.id,A.viewportBuffer,A.quadTriangleIndexBuffer,A.viewportSegments,S.paint,A.transform.zoom)}(_,f))},line:function(_,u,f,y){if(_.renderPass!=="translucent")return;const A=f.paint.get("line-opacity"),S=f.paint.get("line-width");if(A.constantOr(1)===0||S.constantOr(1)===0)return;const B=_.depthModeForSublayer(0,r.DepthMode.ReadOnly),G=_.colorModeForRenderPass(),W=_.terrain&&_.terrain.renderingToTexture?1:r.exported.devicePixelRatio,it=f.paint.get("line-dasharray"),et=it.constantOr(1),_t=f.layout.get("line-cap"),Mt=f.paint.get("line-pattern"),Bt=Mt.constantOr(1),Ft=f.paint.get("line-gradient"),Gt=Bt?"linePattern":"line",Pt=_.context,Ot=Pt.gl,Wt=(Kt=>{const me=[];gc(Kt)&&me.push("RENDER_LINE_DASH"),Kt.paint.get("line-gradient")&&me.push("RENDER_LINE_GRADIENT");const re=Kt.paint.get("line-trim-offset");re[0]===0&&re[1]===0||me.push("RENDER_LINE_TRIM_OFFSET");const Ae=Kt.paint.get("line-pattern").constantOr(1),He=Kt.paint.get("line-opacity").constantOr(1)!==1;return!Ae&&He&&me.push("RENDER_LINE_ALPHA_DISCARD"),me})(f);let jt=Wt.includes("RENDER_LINE_ALPHA_DISCARD");_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(jt=!1);for(const Kt of y){const me=u.getTile(Kt);if(Bt&&!me.patternsLoaded())continue;const re=me.getBucket(f);if(!re)continue;_.prepareDrawTile();const Ae=re.programConfigurations.get(f.id),He=_.useProgram(Gt,Ae,Wt),je=Mt.constantOr(null);if(je&&me.imageAtlas){const xn=me.imageAtlas.patternPositions[je.toString()];xn&&Ae.setConstantPatternPositions(xn)}const De=it.constantOr(null),An=_t.constantOr(null);if(!Bt&&De&&An&&me.lineAtlas){const xn=me.lineAtlas.getDash(De,An);xn&&Ae.setConstantPatternPositions(xn)}let[Fe,fn]=f.paint.get("line-trim-offset");(An==="round"||An==="square")&&Fe!==fn&&(Fe===0&&(Fe-=1),fn===1&&(fn+=1));const Je=_.terrain?Kt.projMatrix:null,Ln=Bt?Ha(_,me,f,Je,W):bu(_,me,f,Je,re.lineClipsArray.length,W,[Fe,fn]);if(Ft){const xn=re.gradients[f.id];let zn=xn.texture;if(f.gradientVersion!==xn.version){let Ne=256;if(f.stepInterpolant){const $e=u.getSource().maxzoom,ri=Kt.canonical.z===$e?Math.ceil(1<<_.transform.maxZoom-Kt.canonical.z):1;Ne=r.clamp(r.nextPowerOfTwo(re.maxLineLength/r.EXTENT*1024*ri),256,Pt.maxTextureSize)}xn.gradient=r.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:Ne,image:xn.gradient||void 0,clips:re.lineClipsArray}),xn.texture?xn.texture.update(xn.gradient):xn.texture=new r.Texture(Pt,xn.gradient,Ot.RGBA),xn.version=f.gradientVersion,zn=xn.texture}Pt.activeTexture.set(Ot.TEXTURE1),zn.bind(f.stepInterpolant?Ot.NEAREST:Ot.LINEAR,Ot.CLAMP_TO_EDGE)}et&&(Pt.activeTexture.set(Ot.TEXTURE0),me.lineAtlasTexture.bind(Ot.LINEAR,Ot.REPEAT),Ae.updatePaintBuffers()),Bt&&(Pt.activeTexture.set(Ot.TEXTURE0),me.imageAtlasTexture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE),Ae.updatePaintBuffers()),_.prepareDrawProgram(Pt,He,Kt.toUnwrapped());const tn=xn=>{He.draw(Pt,Ot.TRIANGLES,B,xn,G,r.CullFaceMode.disabled,Ln,f.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,f.paint,_.transform.zoom,Ae,[re.layoutVertexBuffer2])};if(jt){const xn=_.stencilModeForClipping(Kt).ref;xn===0&&_.terrain&&Pt.clear({stencil:0});const zn={func:Ot.EQUAL,mask:255};Ln.u_alpha_discard_threshold=.8,tn(new r.StencilMode(zn,xn,255,Ot.KEEP,Ot.KEEP,Ot.INVERT)),Ln.u_alpha_discard_threshold=0,tn(new r.StencilMode(zn,xn,255,Ot.KEEP,Ot.KEEP,Ot.KEEP))}else tn(_.stencilModeForClipping(Kt))}jt&&(_.resetStencilClippingMasks(),_.terrain&&Pt.clear({stencil:0}))},fill:function(_,u,f,y){const A=f.paint.get("fill-color"),S=f.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const B=_.colorModeForRenderPass(),G=f.paint.get("fill-pattern"),W=_.opaquePassEnabledForLayer()&&!G.constantOr(1)&&A.constantOr(r.Color.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===W){const it=_.depthModeForSublayer(1,_.renderPass==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly);gn(_,u,f,y,it,B,!1)}if(_.renderPass==="translucent"&&f.paint.get("fill-antialias")){const it=_.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,r.DepthMode.ReadOnly);gn(_,u,f,y,it,B,!0)}},"fill-extrusion":function(_,u,f,y){const A=f.paint.get("fill-extrusion-opacity");if(A!==0&&_.renderPass==="translucent"){const S=new r.DepthMode(_.context.gl.LEQUAL,r.DepthMode.ReadWrite,_.depthRangeFor3D);if(A!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))on(_,u,f,y,S,r.StencilMode.disabled,r.ColorMode.disabled),on(_,u,f,y,S,_.stencilModeFor3D(),_.colorModeForRenderPass()),_.resetStencilClippingMasks();else{const B=_.colorModeForRenderPass();on(_,u,f,y,S,r.StencilMode.disabled,B)}}},hillshade:function(_,u,f,y){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const A=_.context,S=_.depthModeForSublayer(0,r.DepthMode.ReadOnly),B=_.colorModeForRenderPass(),G=_.terrain&&_.terrain.renderingToTexture,[W,it]=_.renderPass!=="translucent"||G?[{},y]:_.stencilConfigForOverlap(y);for(const et of it){const _t=u.getTile(et);if(_t.needsHillshadePrepare&&_.renderPass==="offscreen")tr(_,_t,f,S,r.StencilMode.disabled,B);else if(_.renderPass==="translucent"){const Mt=G&&_.terrain?_.terrain.stencilModeForRTTOverlap(et):W[et.overscaledZ];To(_,et,_t,f,S,Mt,B)}}A.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,u,f,y,A,S){if(_.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!y.length)return;const B=_.context,G=B.gl,W=u.getSource(),it=_.useProgram("raster"),et=_.colorModeForRenderPass(),_t=_.terrain&&_.terrain.renderingToTexture,[Mt,Bt]=W instanceof Ht||_t?[{},y]:_.stencilConfigForOverlap(y),Ft=Bt[Bt.length-1].overscaledZ,Gt=!_.options.moving;for(const Pt of Bt){const Ot=_t?r.DepthMode.disabled:_.depthModeForSublayer(Pt.overscaledZ-Ft,f.paint.get("raster-opacity")===1?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly,G.LESS),Wt=Pt.toUnwrapped(),jt=u.getTile(Pt);if(_t&&(!jt||!jt.hasData()))continue;const Kt=_t?Pt.projMatrix:_.transform.calculateProjMatrix(Wt,Gt),me=_.terrain&&_t?_.terrain.stencilModeForRTTOverlap(Pt):Mt[Pt.overscaledZ],re=S?0:f.paint.get("raster-fade-duration");jt.registerFadeDuration(re);const Ae=u.findLoadedParent(Pt,0),He=Gs(jt,Ae,u,_.transform,re);let je,De;_.terrain&&_.terrain.prepareDrawTile();const An=f.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;B.activeTexture.set(G.TEXTURE0),jt.texture.bind(An,G.CLAMP_TO_EDGE),B.activeTexture.set(G.TEXTURE1),Ae?(Ae.texture.bind(An,G.CLAMP_TO_EDGE),je=Math.pow(2,Ae.tileID.overscaledZ-jt.tileID.overscaledZ),De=[jt.tileID.canonical.x*je%1,jt.tileID.canonical.y*je%1]):jt.texture.bind(An,G.CLAMP_TO_EDGE);const Fe=El(Kt,De||[0,0],je||1,He,f,W instanceof Ht?W.perspectiveTransform:[0,0]);if(_.prepareDrawProgram(B,it,Wt),W instanceof Ht)W.boundsBuffer&&W.boundsSegments&&it.draw(B,G.TRIANGLES,Ot,r.StencilMode.disabled,et,r.CullFaceMode.disabled,Fe,f.id,W.boundsBuffer,_.quadTriangleIndexBuffer,W.boundsSegments);else{const{tileBoundsBuffer:fn,tileBoundsIndexBuffer:Je,tileBoundsSegments:Ln}=_.getTileBoundsBuffers(jt);it.draw(B,G.TRIANGLES,Ot,me,et,r.CullFaceMode.disabled,Fe,f.id,fn,Je,Ln)}}_.resetStencilClippingMasks()},background:function(_,u,f,y){const A=f.paint.get("background-color"),S=f.paint.get("background-opacity");if(S===0)return;const B=_.context,G=B.gl,W=_.transform,it=W.tileSize,et=f.paint.get("background-pattern");if(_.isPatternMissing(et))return;const _t=!et&&A.a===1&&S===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==_t)return;const Mt=r.StencilMode.disabled,Bt=_.depthModeForSublayer(0,_t==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly),Ft=_.colorModeForRenderPass(),Gt=_.useProgram(et?"backgroundPattern":"background");let Pt,Ot=y;Ot||(Pt=_.getBackgroundTiles(),Ot=Object.values(Pt).map(Wt=>Wt.tileID)),et&&(B.activeTexture.set(G.TEXTURE0),_.imageManager.bind(_.context));for(const Wt of Ot){const jt=Wt.toUnwrapped(),Kt=y?Wt.projMatrix:_.transform.calculateProjMatrix(jt);_.prepareDrawTile();const me=u?u.getTile(Wt):Pt?Pt[Wt.key]:new r.Tile(Wt,it,W.zoom,_),re=et?dr(Kt,S,_,et,{tileID:Wt,tileSize:it}):gl(Kt,S,A);_.prepareDrawProgram(B,Gt,jt);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:He,tileBoundsSegments:je}=_.getTileBoundsBuffers(me);Gt.draw(B,G.TRIANGLES,Bt,Mt,Ft,r.CullFaceMode.disabled,re,f.id,Ae,He,je)}},sky:function(_,u,f){const y=_.transform,A=y.projection.name==="mercator"||y.projection.name==="globe"?1:r.smoothstep(7,8,y.zoom),S=f.paint.get("sky-opacity")*A;if(S===0)return;const B=_.context,G=f.paint.get("sky-type"),W=new r.DepthMode(B.gl.LEQUAL,r.DepthMode.ReadOnly,[0,1]),it=_.frameCounter/1e3%1;G==="atmosphere"?_.renderPass==="offscreen"?f.needsSkyboxCapture(_)&&(function(et,_t,Mt,Bt){const Ft=et.context,Gt=Ft.gl;let Pt=_t.skyboxFbo;if(!Pt){Pt=_t.skyboxFbo=Ft.createFramebuffer(32,32,!1),_t.skyboxGeometry=new rn(Ft),_t.skyboxTexture=Ft.gl.createTexture(),Gt.bindTexture(Gt.TEXTURE_CUBE_MAP,_t.skyboxTexture),Gt.texParameteri(Gt.TEXTURE_CUBE_MAP,Gt.TEXTURE_WRAP_S,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_CUBE_MAP,Gt.TEXTURE_WRAP_T,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_CUBE_MAP,Gt.TEXTURE_MIN_FILTER,Gt.LINEAR),Gt.texParameteri(Gt.TEXTURE_CUBE_MAP,Gt.TEXTURE_MAG_FILTER,Gt.LINEAR);for(let Kt=0;Kt<6;++Kt)Gt.texImage2D(Gt.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,0,Gt.RGBA,32,32,0,Gt.RGBA,Gt.UNSIGNED_BYTE,null)}Ft.bindFramebuffer.set(Pt.framebuffer),Ft.viewport.set([0,0,32,32]);const Ot=_t.getCenter(et,!0),Wt=et.useProgram("skyboxCapture"),jt=new Float64Array(16);r.identity(jt),r.rotateY(jt,jt,.5*-Math.PI),Sn(Ft,_t,Wt,jt,Ot,0),r.identity(jt),r.rotateY(jt,jt,.5*Math.PI),Sn(Ft,_t,Wt,jt,Ot,1),r.identity(jt),r.rotateX(jt,jt,.5*-Math.PI),Sn(Ft,_t,Wt,jt,Ot,2),r.identity(jt),r.rotateX(jt,jt,.5*Math.PI),Sn(Ft,_t,Wt,jt,Ot,3),r.identity(jt),Sn(Ft,_t,Wt,jt,Ot,4),r.identity(jt),r.rotateY(jt,jt,Math.PI),Sn(Ft,_t,Wt,jt,Ot,5),Ft.viewport.set([0,0,et.width,et.height])}(_,f),f.markSkyboxValid(_)):_.renderPass==="sky"&&function(et,_t,Mt,Bt,Ft){const Gt=et.context,Pt=Gt.gl,Ot=et.transform,Wt=et.useProgram("skybox");Gt.activeTexture.set(Pt.TEXTURE0),Pt.bindTexture(Pt.TEXTURE_CUBE_MAP,_t.skyboxTexture);const jt=((Kt,me,re,Ae,He)=>({u_matrix:Kt,u_sun_direction:me,u_cubemap:0,u_opacity:Ae,u_temporal_offset:He}))(Ot.skyboxMatrix,_t.getCenter(et,!1),0,Bt,Ft);et.prepareDrawProgram(Gt,Wt),Wt.draw(Gt,Pt.TRIANGLES,Mt,r.StencilMode.disabled,et.colorModeForRenderPass(),r.CullFaceMode.backCW,jt,"skybox",_t.skyboxGeometry.vertexBuffer,_t.skyboxGeometry.indexBuffer,_t.skyboxGeometry.segment)}(_,f,W,S,it):G==="gradient"&&_.renderPass==="sky"&&function(et,_t,Mt,Bt,Ft){const Gt=et.context,Pt=Gt.gl,Ot=et.transform,Wt=et.useProgram("skyboxGradient");_t.skyboxGeometry||(_t.skyboxGeometry=new rn(Gt)),Gt.activeTexture.set(Pt.TEXTURE0);let jt=_t.colorRampTexture;jt||(jt=_t.colorRampTexture=new r.Texture(Gt,_t.colorRamp,Pt.RGBA)),jt.bind(Pt.LINEAR,Pt.CLAMP_TO_EDGE);const Kt=((me,re,Ae,He,je)=>({u_matrix:me,u_color_ramp:0,u_center_direction:re,u_radius:r.degToRad(Ae),u_opacity:He,u_temporal_offset:je}))(Ot.skyboxMatrix,_t.getCenter(et,!1),_t.paint.get("sky-gradient-radius"),Bt,Ft);et.prepareDrawProgram(Gt,Wt),Wt.draw(Gt,Pt.TRIANGLES,Mt,r.StencilMode.disabled,et.colorModeForRenderPass(),r.CullFaceMode.backCW,Kt,"skyboxGradient",_t.skyboxGeometry.vertexBuffer,_t.skyboxGeometry.indexBuffer,_t.skyboxGeometry.segment)}(_,f,W,S,it)},debug:function(_,u,f){for(let y=0;y<f.length;y++)Kl(_,u,f[y])},custom:function(_,u,f){const y=_.context,A=f.implementation;if(_.transform.projection.unsupportedLayers&&_.transform.projection.unsupportedLayers.includes("custom"))r.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(_.renderPass==="offscreen"){const S=A.prerender;S&&(_.setCustomLayerDefaults(),y.setColorMode(_.colorModeForRenderPass()),S.call(A,y.gl,_.transform.customLayerMatrix()),y.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),y.setColorMode(_.colorModeForRenderPass()),y.setStencilMode(r.StencilMode.disabled);const S=A.renderingMode==="3d"?new r.DepthMode(_.context.gl.LEQUAL,r.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,r.DepthMode.ReadOnly);y.setDepthMode(S),A.render(y.gl,_.transform.customLayerMatrix()),y.setDirty(),_.setBaseState(),y.bindFramebuffer.set(null)}}};class mi{constructor(u,f){this.context=new pt(u),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=r.SourceCache.maxUnderzooming+r.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Es,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(u,f){const y=!!u&&!!u.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ms(this,u));const A=this._terrain;this.transform.elevation=y?A:null,A.update(u,this.transform,f)}_updateFog(u){const f=u.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,A]=f.getFovAdjustedRange(this.transform._fov);if(y>A)return void(this.transform.fogCullDistSq=null);const S=y+.78*(A-y);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(u,f){if(this.width=u*r.exported.devicePixelRatio,this.height=f*r.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const u=this.context,f=new r.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(r.EXTENT,0),f.emplaceBack(0,r.EXTENT),f.emplaceBack(r.EXTENT,r.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(f,r.posAttributes.members),this.tileExtentSegments=r.SegmentVector.simpleSegment(0,0,4,2);const y=new r.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(r.EXTENT,0),y.emplaceBack(0,r.EXTENT),y.emplaceBack(r.EXTENT,r.EXTENT),this.debugBuffer=u.createVertexBuffer(y,r.posAttributes.members),this.debugSegments=r.SegmentVector.simpleSegment(0,0,4,5);const A=new r.StructArrayLayout2i4;A.emplaceBack(-1,-1),A.emplaceBack(1,-1),A.emplaceBack(-1,1),A.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(A,r.posAttributes.members),this.viewportSegments=r.SegmentVector.simpleSegment(0,0,4,2);const S=new r.StructArrayLayout4i8;S.emplaceBack(0,0,0,0),S.emplaceBack(r.EXTENT,0,r.EXTENT,0),S.emplaceBack(0,r.EXTENT,0,r.EXTENT),S.emplaceBack(r.EXTENT,r.EXTENT,r.EXTENT,r.EXTENT),this.mercatorBoundsBuffer=u.createVertexBuffer(S,r.boundsAttributes.members),this.mercatorBoundsSegments=r.SegmentVector.simpleSegment(0,0,4,2);const B=new r.StructArrayLayout3ui6;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(B);const G=new r.StructArrayLayout1ui2;for(const it of[0,1,3,2,0])G.emplaceBack(it);this.debugIndexBuffer=u.createIndexBuffer(G),this.emptyTexture=new r.Texture(u,new r.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),u.gl.RGBA),this.identityMat=r.create();const W=this.context.gl;this.stencilClearMode=new r.StencilMode({func:W.ALWAYS,mask:0},0,255,W.ZERO,W.ZERO,W.ZERO),this.loadTimeStamps.push(r.window.performance.now()),this.atmosphereBuffer=new Mn(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(u){return u._makeTileBoundsBuffers(this.context,this.transform.projection),u._tileBoundsBuffer?{tileBoundsBuffer:u._tileBoundsBuffer,tileBoundsIndexBuffer:u._tileBoundsIndexBuffer,tileBoundsSegments:u._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const u=this.context,f=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(u,f.TRIANGLES,r.DepthMode.disabled,this.stencilClearMode,r.ColorMode.disabled,r.CullFaceMode.disabled,Vr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(u,f,y){if(!f||this.currentStencilSource===f.id||!u.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let G=!1;for(const W of y)if(this._tileClippingMaskIDs[W.key]===void 0){G=!0;break}if(!G)return}this.currentStencilSource=f.id;const A=this.context,S=A.gl;this.nextStencilID+y.length>256&&this.clearStencil(),A.setColorMode(r.ColorMode.disabled),A.setDepthMode(r.DepthMode.disabled);const B=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const G of y){const W=f.getTile(G),it=this._tileClippingMaskIDs[G.key]=this.nextStencilID++,{tileBoundsBuffer:et,tileBoundsIndexBuffer:_t,tileBoundsSegments:Mt}=this.getTileBoundsBuffers(W);B.draw(A,S.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:S.ALWAYS,mask:0},it,255,S.KEEP,S.KEEP,S.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,Vr(G.projMatrix),"$clipping",et,_t,Mt)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,f=this.context.gl;return new r.StencilMode({func:f.NOTEQUAL,mask:255},u,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(u){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(u);const f=this.context.gl;return new r.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(u){const f=this.context.gl,y=u.sort((B,G)=>G.overscaledZ-B.overscaledZ),A=y[y.length-1].overscaledZ,S=y[0].overscaledZ-A+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const B={};for(let G=0;G<S;G++)B[G+A]=new r.StencilMode({func:f.GEQUAL,mask:255},G+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=S,[B,y]}return[{[A]:r.StencilMode.disabled},y]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new r.ColorMode([u.CONSTANT_COLOR,u.ONE],new r.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?r.ColorMode.unblended:r.ColorMode.alphaBlended}depthModeForSublayer(u,f,y){if(!this.opaquePassEnabledForLayer())return r.DepthMode.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new r.DepthMode(y||this.context.gl.LEQUAL,f,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,f){this.style=u,this.options=f,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(r.exported.now()),this.imageManager.beginFrame();const y=this.style.order,A=this.style._sourceCaches;for(const W in A){const it=A[W];it.used&&it.prepare(this.context)}const S={},B={},G={};for(const W in A){const it=A[W];S[W]=it.getVisibleCoordinates(),B[W]=S[W].slice().reverse(),G[W]=it.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let W=0;W<y.length;W++)if(this.style._layers[y[W]].is3D()){this.opaquePassCutoff=W;break}if(this.terrain&&(this.terrain.updateTileBinding(G),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.GlobeSharedBuffers(this.context)),r.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const W of y){const it=this.style._layers[W],et=u._getLayerSourceCache(it);if(!it.hasOffscreenPass()||it.isHidden(this.transform.zoom))continue;const _t=et?B[et.id]:void 0;(it.type==="custom"||it.isSky()||_t&&_t.length)&&this.renderLayer(this,et,it,_t)}if(this.depthRangeFor3D=[0,1-(u.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:f.showOverdrawInspector?r.Color.black:r.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const W=this.style._layers[y[this.currentLayer]],it=u._getLayerSourceCache(W);if(W.isSky())continue;const et=it?B[it.id]:void 0;this._renderTileClippingMasks(W,it,et),this.renderLayer(this,it,W,et)}if(this.style.fog&&this.transform.projection.supportsFog&&function(W,it){const et=W.context,_t=et.gl,Mt=W.transform,Bt=new r.DepthMode(_t.LEQUAL,r.DepthMode.ReadOnly,[0,1]),Ft=W.useProgram("globeAtmosphere",null,Mt.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Gt=r.globeToMercatorTransition(Mt.zoom),Pt=it.properties.get("color").toArray01(),Ot=it.properties.get("high-color").toArray01(),Wt=it.properties.get("space-color").toArray01PremultipliedAlpha(),jt=r.identity$1([]);r.rotateY$1(jt,jt,-r.degToRad(Mt._center.lng)),r.rotateX$1(jt,jt,r.degToRad(Mt._center.lat)),r.rotateZ$1(jt,jt,Mt.angle),r.rotateX$1(jt,jt,-Mt._pitch);const Kt=r.fromQuat(new Float32Array(16),jt),me=r.mapValue(it.properties.get("star-intensity"),0,1,0,.25),re=5e-4,Ae=r.mapValue(it.properties.get("horizon-blend"),0,1,re,.25),He=r.globeUseCustomAntiAliasing(W,et,Mt)&&Ae===re?Mt.worldSize/(2*Math.PI*1.025)-1:Mt.globeRadius,je=W.frameCounter/1e3%1,De=r.length(Mt.globeCenterInViewSpace),An=Math.sqrt(Math.pow(De,2)-Math.pow(He,2)),Fe=Math.acos(An/De),fn=((Ln,tn,xn,zn,Ne,$e,ri,fi,oi,Li,Ki,gi,Kn,Hr)=>({u_frustum_tl:Ln,u_frustum_tr:tn,u_frustum_br:xn,u_frustum_bl:zn,u_horizon:Ne,u_transition:$e,u_fadeout_range:ri,u_color:fi,u_high_color:oi,u_space_color:Li,u_star_intensity:Ki,u_star_size:5*r.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:gi,u_horizon_angle:Kn,u_rotation_matrix:Hr}))(Mt.frustumCorners.TL,Mt.frustumCorners.TR,Mt.frustumCorners.BR,Mt.frustumCorners.BL,Mt.frustumCorners.horizon,Gt,Ae,Pt,Ot,Wt,me,je,Fe,Kt);W.prepareDrawProgram(et,Ft);const Je=W.atmosphereBuffer;Je&&Ft.draw(et,_t.TRIANGLES,Bt,r.StencilMode.disabled,r.ColorMode.alphaBlended,r.CullFaceMode.backCW,fn,"skybox",Je.vertexBuffer,Je.indexBuffer,Je.segments)}(this,this.style.fog),this.renderPass="sky",(r.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const W=this.style._layers[y[this.currentLayer]],it=u._getLayerSourceCache(W);W.isSky()&&this.renderLayer(this,it,W,it?B[it.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const W=this.style._layers[y[this.currentLayer]],it=u._getLayerSourceCache(W);if(W.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(W)){if(W.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const et=it?(W.type==="symbol"?G:B)[it.id]:void 0;this._renderTileClippingMasks(W,it,it?S[it.id]:void 0),this.renderLayer(this,it,W,et),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let W=null;r.values(this.style._layers).forEach(it=>{const et=u._getLayerSourceCache(it);et&&!it.isHidden(this.transform.zoom)&&(!W||W.getSource().maxzoom<et.getSource().maxzoom)&&(W=et)}),W&&this.options.showTileBoundaries&&bi.debug(this,W,W.getVisibleCoordinates())}this.options.showPadding&&function(W){const it=W.transform.padding;Vs(W,W.transform.height-(it.top||0),3,Bi),Vs(W,it.bottom||0,3,Sr),Nt(W,it.left||0,3,Do),Nt(W,W.transform.width-(it.right||0),3,Lr);const et=W.transform.centerPoint;(function(_t,Mt,Bt,Ft){ae(_t,Mt-1,Bt-10,2,20,Ft),ae(_t,Mt-10,Bt-1,20,2,Ft)})(W,et.x,W.transform.height-et.y,Ps)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(r.window.performance.now()),this.saveCanvasCopy())}}renderLayer(u,f,y,A){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||A&&A.length)&&(this.id=y.id,this.gpuTimingStart(y),u.transform.projection.unsupportedLayers&&u.transform.projection.unsupportedLayers.includes(y.type)||bi[y.type](u,f,y,A,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(u){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let y=this.gpuTimers[u.id];y||(y=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),y.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const u=this.context.extTimerQuery,f=u.createQueryEXT();this.deferredRenderGpuTimeQueries.push(f),u.beginQueryEXT(u.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}collectGpuTimers(){const u=this.gpuTimers;return this.gpuTimers={},u}collectDeferredRenderGpuQueries(){const u=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],u}queryGpuTimers(u){const f={};for(const y in u){const A=u[y],S=this.context.extTimerQuery,B=S.getQueryObjectEXT(A.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(A.query),f[y]=B}return f}queryGpuTimeDeferredRender(u){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery;let y=0;for(const A of u)y+=f.getQueryObjectEXT(A,f.QUERY_RESULT_EXT)/1e6,f.deleteQueryEXT(A);return y}translatePosMatrix(u,f,y,A,S){if(!y[0]&&!y[1])return u;const B=S?A==="map"?this.transform.angle:0:A==="viewport"?-this.transform.angle:0;if(B){const it=Math.sin(B),et=Math.cos(B);y=[y[0]*et-y[1]*it,y[0]*it+y[1]*et]}const G=[S?y[0]:ve(f,y[0],this.transform.zoom),S?y[1]:ve(f,y[1],this.transform.zoom),0],W=new Float32Array(16);return r.translate(W,u,G),W}saveTileTexture(u){const f=this._tileTextures[u.size[0]];f?f.push(u):this._tileTextures[u.size[0]]=[u]}getTileTexture(u){const f=this._tileTextures[u];return f&&f.length>0?f.pop():null}isPatternMissing(u){return u===null||u!==void 0&&!this.imageManager.getPattern(u.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const u=this.terrain&&this.terrain.renderingToTexture,f=this.terrain&&this.terrain.exaggeration()===0,y=this.style&&this.style.fog,A=[];return this.terrainRenderModeElevated()&&A.push("TERRAIN"),this.transform.projection.name==="globe"&&A.push("GLOBE"),f&&A.push("ZERO_EXAGGERATION"),y&&!u&&y.getOpacity(this.transform.pitch)!==0&&A.push("FOG"),u&&A.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&A.push("OVERDRAW_INSPECTOR"),A}useProgram(u,f,y){this.cache=this.cache||{};const A=y||[],S=this.currentGlobalDefines().concat(A),B=ma.cacheKey(qe[u],u,S,f);return this.cache[B]||(this.cache[B]=new ma(this.context,u,qe[u],f,Ls[u],S)),this.cache[B]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=r.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(u,f,y){if(this.terrain&&this.terrain.renderingToTexture)return;const A=this.style.fog;if(A){const S=A.getOpacity(this.transform.pitch),B=((G,W,it,et,_t,Mt,Bt,Ft,Gt,Pt,Ot)=>{const Wt=G.transform,jt=W.properties.get("color").toArray01();jt[3]=et;const Kt=G.frameCounter/1e3%1;return{u_fog_matrix:it?Wt.calculateFogTileMatrix(it):G.identityMat,u_fog_range:W.getFovAdjustedRange(Wt._fov),u_fog_color:jt,u_fog_horizon_blend:W.properties.get("horizon-blend"),u_fog_temporal_offset:Kt,u_frustum_tl:_t,u_frustum_tr:Mt,u_frustum_br:Bt,u_frustum_bl:Ft,u_globe_pos:Gt,u_globe_radius:Pt,u_viewport:Ot,u_globe_transition:r.globeToMercatorTransition(Wt.zoom),u_is_globe:+(Wt.projection.name==="globe")}})(this,A,y,S,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.exported.devicePixelRatio,this.transform.height*r.exported.devicePixelRatio]);f.setFogUniformValues(u,B)}}setTileLoadedFlag(u){this.tileLoaded=u}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const u=this.context.gl,f=u.createTexture();return u.bindTexture(u.TEXTURE_2D,f),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,u.drawingBufferWidth,u.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const u=this.style&&this.style.fog;return!!u&&u.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const u=this._backgroundTiles,f=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const A of y)f[A.key]=u[A.key]||new r.Tile(A,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class Mi{constructor(u=0,f=0,y=0,A=0){if(isNaN(u)||u<0||isNaN(f)||f<0||isNaN(y)||y<0||isNaN(A)||A<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=f,this.left=y,this.right=A}interpolate(u,f,y){return f.top!=null&&u.top!=null&&(this.top=r.number(u.top,f.top,y)),f.bottom!=null&&u.bottom!=null&&(this.bottom=r.number(u.bottom,f.bottom,y)),f.left!=null&&u.left!=null&&(this.left=r.number(u.left,f.left,y)),f.right!=null&&u.right!=null&&(this.right=r.number(u.right,f.right,y)),this}getCenter(u,f){const y=r.clamp((this.left+u-this.right)/2,0,u),A=r.clamp((this.top+f-this.bottom)/2,0,f);return new r.pointGeometry(y,A)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new Mi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Gi(_,u){const f=r.getColumn(_,3);r.fromQuat(_,u),r.setColumn(_,3,f)}function or(_,u){const f=r.identity$1([]);return r.rotateZ$1(f,f,-u),r.rotateX$1(f,f,-_),f}function Ii(_,u){const f=[_[0],_[1],0],y=[u[0],u[1],0];if(r.length(f)>=1e-15){const B=r.normalize([],f);r.scale$2(y,B,r.dot(y,B)),u[0]=y[0],u[1]=y[1]}const A=r.cross([],u,_);if(r.len(A)<1e-15)return null;const S=Math.atan2(-A[1],A[0]);return or(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),S)}class fo{constructor(u,f){this.position=u,this.orientation=f}get position(){return this._position}set position(u){if(u){const f=u instanceof r.MercatorCoordinate?u:new r.MercatorCoordinate(u[0],u[1],u[2]);this._renderWorldCopies&&(f.x=r.wrap(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(u,f){if(this.orientation=null,!this.position)return;const y=this._elevation?this._elevation.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(u)):0,A=this.position,S=r.MercatorCoordinate.fromLngLat(u,y),B=[S.x-A.x,S.y-A.y,S.z-A.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=Ii(B,f)}setPitchBearing(u,f){this.orientation=or(r.degToRad(u),r.degToRad(-f))}}class po{constructor(u,f){this._transform=r.identity([]),this.orientation=f,this.position=u}get mercatorPosition(){const u=this.position;return new r.MercatorCoordinate(u[0],u[1],u[2])}get position(){const u=r.getColumn(this._transform,3);return[u[0],u[1],u[2]]}set position(u){var f;u&&r.setColumn(this._transform,3,[(f=u)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(u){this._orientation=u||r.identity$1([]),u&&Gi(this._transform,this._orientation)}getPitchBearing(){const u=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2])}}setPitchBearing(u,f){this._orientation=or(u,f),Gi(this._transform,this._orientation)}forward(){const u=r.getColumn(this._transform,2);return[-u[0],-u[1],-u[2]]}up(){const u=r.getColumn(this._transform,1);return[-u[0],-u[1],-u[2]]}right(){const u=r.getColumn(this._transform,0);return[u[0],u[1],u[2]]}getCameraToWorld(u,f){const y=new Float64Array(16);return r.invert(y,this.getWorldToCamera(u,f)),y}getWorldToCameraPosition(u,f,y){const A=this.position;r.scale$2(A,A,-u);const S=new Float64Array(16);return r.fromScaling(S,[y,y,y]),r.translate(S,S,A),S[10]*=f,S}getWorldToCamera(u,f){const y=new Float64Array(16),A=new Float64Array(4),S=this.position;return r.conjugate(A,this._orientation),r.scale$2(S,S,-u),r.fromQuat(y,A),r.translate(y,y,S),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=f,y[9]*=f,y[10]*=f,y[11]*=f,y}getCameraToClipPerspective(u,f,y,A){const S=new Float64Array(16);return r.perspective(S,u,f,y,A),S}getDistanceToElevation(u,f=!1){const y=u===0?0:r.mercatorZfromAltitude(u,f?r.latFromMercatorY(this.position[1]):this.position[1]),A=this.forward();return(y-this.position[2])/A[2]}clone(){return new po([...this.position],[...this.orientation])}}function rs(_,u){const f=zs(_.projection,_.zoom,_.width,_.height),y=function(S,B,G,W,it){const et=new r.LngLat(G.lng-180*Ws,G.lat),_t=new r.LngLat(G.lng+180*Ws,G.lat),Mt=S.project(et.lng,et.lat),Bt=S.project(_t.lng,_t.lat),Ft=-Math.atan2(Bt.y-Mt.y,Bt.x-Mt.x),Gt=r.MercatorCoordinate.fromLngLat(G);Gt.y=r.clamp(Gt.y,-.999975,.999975);const Pt=Gt.toLngLat(),Ot=S.project(Pt.lng,Pt.lat),Wt=r.MercatorCoordinate.fromLngLat(Pt);Wt.x+=Ws;const jt=Wt.toLngLat(),Kt=S.project(jt.lng,jt.lat),me=kl(Kt.x-Ot.x,Kt.y-Ot.y,Ft),re=r.MercatorCoordinate.fromLngLat(Pt);re.y+=Ws;const Ae=re.toLngLat(),He=S.project(Ae.lng,Ae.lat),je=kl(He.x-Ot.x,He.y-Ot.y,Ft),De=Math.abs(me.x)/Math.abs(je.y),An=r.identity([]);r.rotateZ(An,An,-Ft*(1-(it?0:W)));const Fe=r.identity([]);return r.scale(Fe,Fe,[1,1-(1-De)*W,1]),Fe[4]=-je.x/je.y*W,r.rotateZ(Fe,Fe,Ft),r.multiply(Fe,An,Fe),Fe}(_.projection,0,_.center,f,u),A=Rr(_);return r.scale(y,y,[A,A,1]),y}function Rr(_){const u=_.projection,f=zs(_.projection,_.zoom,_.width,_.height),y=Bo(u,_.center),A=Bo(u,r.LngLat.convert(u.center));return Math.pow(2,y*f+(1-f)*A)}function zs(_,u,f,y,A=1/0){const S=_.range;if(!S)return 0;const B=Math.min(A,Math.max(f,y)),G=Math.log(B/1024)/Math.LN2;return r.smoothstep(S[0]+G,S[1]+G,u)}const Ws=1/4e4;function Bo(_,u){const f=r.clamp(u.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),y=new r.LngLat(u.lng-180*Ws,f),A=new r.LngLat(u.lng+180*Ws,f),S=_.project(y.lng,f),B=_.project(A.lng,f),G=r.MercatorCoordinate.fromLngLat(y),W=r.MercatorCoordinate.fromLngLat(A),it=B.x-S.x,et=B.y-S.y,_t=W.x-G.x,Mt=W.y-G.y,Bt=Math.sqrt((_t*_t+Mt*Mt)/(it*it+et*et));return Math.log(Bt)/Math.LN2}function kl(_,u,f){const y=Math.cos(f),A=Math.sin(f);return{x:_*y-u*A,y:_*A+u*y}}class Pl{constructor(u,f,y,A,S,B,G){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=u||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=A??60,this.setProjection(B),this.setMaxBounds(G),this.width=0,this.height=0,this._center=new r.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Mi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new po,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const u=new Pl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return u._elevation=this._elevation,u._centerAltitude=this._centerAltitude,u._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,u.tileSize=this.tileSize,u.mercatorFromTransition=this.mercatorFromTransition,u.width=this.width,u.height=this.height,u.cameraElevationReference=this.cameraElevationReference,u._center=this._center,u._setZoom(this.zoom),u._seaLevelZoom=this._seaLevelZoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._nearZ=this._nearZ,u._farZ=this._farZ,u._averageElevation=this._averageElevation,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._camera=this._camera.clone(),u._calcMatrices(),u.freezeTileCoverage=this.freezeTileCoverage,u.frustumCorners=this.frustumCorners,u}get elevation(){return this._elevation}set elevation(u){this._elevation!==u&&(this._elevation=u,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(u,f=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(u||y)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return r.pick(this.projection,["name","center","parallels"])}setProjection(u){this.projectionOptions=u||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=r.getProjection(this.projectionOptions);const y=!w(f,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setMercatorFromTransition(){const u=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.getProjection({name:"mercator"});const f=u!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}get maxZoom(){return this._maxZoom}set maxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}get minPitch(){return this._minPitch}set minPitch(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))}get maxPitch(){return this._maxPitch}set maxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get cameraWorldSize(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.pointGeometry(this.width,this.height)}get bearing(){return r.wrap(this.rotation,-180,180)}set bearing(u){this.rotation=u}get rotation(){return-this.angle/Math.PI*180}set rotation(u){const f=-u*Math.PI/180;var y;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(y=new r.ARRAY_TYPE(4),r.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(A,S,B){var G=S[0],W=S[1],it=S[2],et=S[3],_t=Math.sin(B),Mt=Math.cos(B);A[0]=G*Mt+it*_t,A[1]=W*Mt+et*_t,A[2]=G*-_t+it*Mt,A[3]=W*-_t+et*Mt}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(u){const f=r.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const u=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/u)}set fov(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=r.degToRad(u),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(u){this._averageElevation=u,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(u){const f=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(u){this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const u=this._elevation;this._centerAltitude=u.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=u.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const u=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let A=0,S=0;for(let B=0;B<f.length;B++){const G=new r.pointGeometry(f[B][0]*this.width,y+f[B][1]*(this.height-y)),W=u.pointCoordinate(G);if(!W)continue;const it=1/Math.hypot(W[0]-this._camera.position[0],W[1]-this._camera.position[1]);A+=W[3]*it,S+=it}return S===0?NaN:A/S}get center(){return this._center}set center(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const u=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*f,A=this._mercatorZfromZoom(u),S=this._mercatorZfromZoom(this._maxZoom),B=Math.max(A-y,S);this._setZoom(this._zoomFromMercatorZ(B))}get padding(){return this._edgeInsets.toJSON()}set padding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}computeZoomRelativeTo(u){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,u.toAltitude()));let y;y=u.z<this._camera.position[2]?[f.x,f.y,f.z]:[u.x,u.y,u.z];const A=r.length(r.sub([],this._camera.position,y));return r.clamp(this._zoomFromMercatorZ(A),this._minZoom,this._maxZoom)}setFreeCameraOptions(u){if(!this.height||!u.position&&!u.orientation)return;this._updateCameraState();let f=!1;if(u.orientation&&!r.exactEquals(u.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(u.orientation)),u.position){const y=[u.position.x,u.position.y,u.position.z];r.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const u=this._camera.position,f=new fo;return f.position=new r.MercatorCoordinate(u[0],u[1],u[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(u){if(!r.length$1(u))return!1;r.normalize$1(u,u);const f=r.transformQuat([],[0,0,-1],u),y=r.transformQuat([],[0,-1,0],u);if(y[2]<0)return!1;const A=Ii(f,y);return!!A&&(this._camera.orientation=A,!0)}_setCameraPosition(u){const f=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,A=this.cameraToCenterDistance;u[2]=r.clamp(u[2],A/y,A/f),this._camera.position=u}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,f,y){this._unmodified=!1,this._edgeInsets.interpolate(u,f,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(u){const f=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(u){const f=[new r.UnwrappedTileID(0,u)];if(this.renderWorldCopies){const y=this.pointCoordinate(new r.pointGeometry(0,0)),A=this.pointCoordinate(new r.pointGeometry(this.width,0)),S=this.pointCoordinate(new r.pointGeometry(this.width,this.height)),B=this.pointCoordinate(new r.pointGeometry(0,this.height)),G=Math.floor(Math.min(y.x,A.x,S.x,B.x)),W=Math.floor(Math.max(y.x,A.x,S.x,B.x)),it=1;for(let et=G-it;et<=W+it;et++)et!==0&&f.push(new r.UnwrappedTileID(et,u))}return f}coveringTiles(u){let f=this.coveringZoomLevel(u);const y=f,A=this.elevation&&!u.isTerrainDEM,S=this.projection.name==="mercator";if(u.minzoom!==void 0&&f<u.minzoom)return[];u.maxzoom!==void 0&&f>u.maxzoom&&(f=u.maxzoom);const B=this.locationCoordinate(this.center),G=this.center.lat,W=1<<f,it=[W*B.x,W*B.y,0],et=this.projection.name==="globe",_t=!et,Mt=r.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,_t),Bt=et?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ft=W*r.mercatorZfromAltitude(1,this.center.lat),Gt=this._camera.position[2]/r.mercatorZfromAltitude(1,this.center.lat),Pt=[W*Bt.x,W*Bt.y,Gt*(_t?1:Ft)],Ot=this.cameraToCenterDistance/u.tileSize*(u.roundZoom?1:.502),Wt=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,jt=u.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Kt=u.isTerrainDEM?-jt:this._elevation?this._elevation.getMinElevationBelowMSL():0,me=this.projection.isReprojectedInTileSpace?Rr(this):1,re=tn=>{const zn=new r.MercatorCoordinate(tn.x+25e-6,tn.y,tn.z),Ne=new r.MercatorCoordinate(tn.x,tn.y+25e-6,tn.z),$e=tn.toLngLat(),ri=zn.toLngLat(),fi=Ne.toLngLat(),oi=this.locationCoordinate($e),Li=this.locationCoordinate(ri),Ki=this.locationCoordinate(fi),gi=Math.hypot(Li.x-oi.x,Li.y-oi.y),Kn=Math.hypot(Ki.x-oi.x,Ki.y-oi.y);return Math.sqrt(gi*Kn)*me/25e-6},Ae=tn=>{const xn=jt,zn=Kt;return{aabb:r.tileAABB(this,W,0,0,0,tn,zn,xn,this.projection),zoom:0,x:0,y:0,minZ:zn,maxZ:xn,wrap:tn,fullyVisible:!1}},He=[];let je=[];const De=f,An=u.reparseOverscaled?y:f,Fe=tn=>tn*tn,fn=Fe((Gt-this._centerAltitude)*Ft),Je=tn=>{if(!this._elevation||!tn.tileID||!S)return;const xn=this._elevation.getMinMaxForTile(tn.tileID),zn=tn.aabb;xn?(zn.min[2]=xn.min,zn.max[2]=xn.max,zn.center[2]=(zn.min[2]+zn.max[2])/2):(tn.shouldSplit=Ln(tn),tn.shouldSplit||(zn.min[2]=zn.max[2]=zn.center[2]=this._centerAltitude))},Ln=tn=>{if(tn.zoom<Wt)return!0;if(tn.zoom===De)return!1;if(tn.shouldSplit!=null)return tn.shouldSplit;const xn=tn.aabb.distanceX(Pt),zn=tn.aabb.distanceY(Pt);let Ne=fn,$e=1;if(et){Ne=Fe(tn.aabb.distanceZ(Pt));const oi=Math.pow(2,tn.zoom),Li=r.latFromMercatorY((tn.y+1)/oi),Ki=r.latFromMercatorY(tn.y/oi),gi=Math.min(Math.max(G,Li),Ki),Kn=r.circumferenceAtLatitude(gi)/r.circumferenceAtLatitude(G);if($e=gi===G?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Kn/this._mercatorScaleRatio),this.zoom<=r.GLOBE_ZOOM_THRESHOLD_MIN&&tn.zoom===De-1&&Kn>=.9)return!0}else if(A&&(Ne=Fe(tn.aabb.distanceZ(Pt)*Ft)),this.projection.isReprojectedInTileSpace&&y<=5){const oi=Math.pow(2,tn.zoom),Li=re(new r.MercatorCoordinate((tn.x+.5)/oi,(tn.y+.5)/oi));$e=Li>.85?1:Li}const ri=xn*xn+zn*zn+Ne,fi=Fe((1<<De-tn.zoom)*Ot*$e*((oi,Li)=>{if(Li*Fe(.707)<oi)return 1;const Ki=Math.sqrt(Li/oi);return Ki/(1.4144271570014144+(Math.pow(1.1,Ki-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ne,fn),ri));return ri<fi};if(this.renderWorldCopies)for(let tn=1;tn<=3;tn++)He.push(Ae(-tn)),He.push(Ae(tn));for(He.push(Ae(0));He.length>0;){const tn=He.pop(),xn=tn.x,zn=tn.y;let Ne=tn.fullyVisible;if(!Ne){const $e=tn.aabb.intersects(Mt);if($e===0)continue;Ne=$e===2}if(tn.zoom!==De&&Ln(tn))for(let $e=0;$e<4;$e++){const ri=(xn<<1)+$e%2,fi=(zn<<1)+($e>>1),oi={aabb:S?tn.aabb.quadrant($e):r.tileAABB(this,W,tn.zoom+1,ri,fi,tn.wrap,tn.minZ,tn.maxZ,this.projection),zoom:tn.zoom+1,x:ri,y:fi,wrap:tn.wrap,fullyVisible:Ne,tileID:void 0,shouldSplit:void 0,minZ:tn.minZ,maxZ:tn.maxZ};A&&!et&&(oi.tileID=new r.OverscaledTileID(tn.zoom+1===De?An:tn.zoom+1,tn.wrap,tn.zoom+1,ri,fi),Je(oi)),He.push(oi)}else{const $e=tn.zoom===De?An:tn.zoom;if(u.minzoom&&u.minzoom>$e)continue;const ri=it[0]-(.5+xn+(tn.wrap<<tn.zoom))*(1<<f-tn.zoom),fi=it[1]-.5-zn,oi=tn.tileID?tn.tileID:new r.OverscaledTileID($e,tn.wrap,tn.zoom,xn,zn);je.push({tileID:oi,distanceSq:ri*ri+fi*fi})}}if(this.fogCullDistSq){const tn=this.fogCullDistSq,xn=this.horizonLineFromTop();je=je.filter(zn=>{const Ne=[0,0,0,1],$e=[r.EXTENT,r.EXTENT,0,1],ri=this.calculateFogTileMatrix(zn.tileID.toUnwrapped());r.transformMat4$1(Ne,Ne,ri),r.transformMat4$1($e,$e,ri);const fi=r.getAABBPointSquareDist(Ne,$e);if(fi===0)return!0;let oi=!1;const Li=this._elevation;if(Li&&fi>tn&&xn!==0){const Ki=this.calculateProjMatrix(zn.tileID.toUnwrapped());let gi;u.isTerrainDEM||(gi=Li.getMinMaxForTile(zn.tileID)),gi||(gi={min:Kt,max:jt});const Kn=r.furthestTileCorner(this.rotation),Hr=[Kn[0]*r.EXTENT,Kn[1]*r.EXTENT,gi.max];r.transformMat4(Hr,Hr,Ki),oi=(1-Hr[1])*this.height*.5<xn}return fi<tn||oi})}return je.sort((tn,xn)=>tn.distanceSq-xn.distanceSq).map(tn=>tn.tileID)}resize(u,f){this.width=u,this.height=f,this.pixelsToGLUnits=[2/u,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(u){return Math.pow(2,u)}scaleZoom(u){return Math.log(u)/Math.LN2}project(u){const f=r.clamp(u.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),y=this.projection.project(u.lng,f);return new r.pointGeometry(y.x*this.worldSize,y.y*this.worldSize)}unproject(u){return this.projection.unproject(u.x/this.worldSize,u.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(u,f){let y,A;const S=this.centerPoint;if(this.projection.name==="globe"){const G=this.worldSize;y=(f.x-S.x)/G,A=(f.y-S.y)/G}else{const G=this.pointCoordinate(f),W=this.pointCoordinate(S);y=G.x-W.x,A=G.y-W.y}const B=this.locationCoordinate(u);this.setLocation(new r.MercatorCoordinate(B.x-y,B.y-A))}setLocation(u){this.center=this.coordinateLocation(u),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(u){return this.projection.locationPoint(this,u)}locationPoint3D(u){return this.projection.locationPoint(this,u,!0)}pointLocation(u){return this.coordinateLocation(this.pointCoordinate(u))}pointLocation3D(u){return this.coordinateLocation(this.pointCoordinate3D(u))}locationCoordinate(u,f){const y=f?r.mercatorZfromAltitude(f,u.lat):void 0,A=this.projection.project(u.lng,u.lat);return new r.MercatorCoordinate(A.x,A.y,y)}coordinateLocation(u){return this.projection.unproject(u.x,u.y)}pointRayIntersection(u,f){const y=f??this._centerAltitude,A=[u.x,u.y,0,1],S=[u.x,u.y,1,1];r.transformMat4$1(A,A,this.pixelMatrixInverse),r.transformMat4$1(S,S,this.pixelMatrixInverse);const B=S[3];r.scale$1(A,A,1/A[3]),r.scale$1(S,S,1/B);const G=A[2],W=S[2];return{p0:A,p1:S,t:G===W?0:(y-G)/(W-G)}}screenPointToMercatorRay(u){const f=[u.x,u.y,0,1],y=[u.x,u.y,1,1];return r.transformMat4$1(f,f,this.pixelMatrixInverse),r.transformMat4$1(y,y,this.pixelMatrixInverse),r.scale$1(f,f,1/f[3]),r.scale$1(y,y,1/y[3]),f[2]=r.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,y[2]=r.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,r.scale$1(f,f,1/this.worldSize),r.scale$1(y,y,1/this.worldSize),new r.Ray([f[0],f[1],f[2]],r.normalize([],r.sub([],y,f)))}rayIntersectionCoordinate(u){const{p0:f,p1:y,t:A}=u,S=r.mercatorZfromAltitude(f[2],this._center.lat),B=r.mercatorZfromAltitude(y[2],this._center.lat);return new r.MercatorCoordinate(r.number(f[0],y[0],A)/this.worldSize,r.number(f[1],y[1],A)/this.worldSize,r.number(S,B,A))}pointCoordinate(u,f=this._centerAltitude){return this.projection.pointCoordinate(this,u.x,u.y,f)}pointCoordinate3D(u){if(!this.elevation)return this.pointCoordinate(u);let f=this.projection.pointCoordinate3D(this,u.x,u.y);if(f)return new r.MercatorCoordinate(f[0],f[1],f[2]);let y=0,A=this.horizonLineFromTop();if(u.y>A)return this.pointCoordinate(u);const S=.02*A,B=u.clone();for(let G=0;G<10&&A-y>S;G++){B.y=r.number(y,A,.66);const W=this.projection.pointCoordinate3D(this,B.x,B.y);W?(A=B.y,f=W):y=B.y}return f?new r.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(u)}isPointAboveHorizon(u){return this.projection.isPointAboveHorizon(this,u)}_coordinatePoint(u,f){const y=f&&this.elevation?this.elevation.getAtPointOrZero(u,this._centerAltitude):this._centerAltitude,A=[u.x*this.worldSize,u.y*this.worldSize,y+u.toAltitude(),1];return r.transformMat4$1(A,A,this.pixelMatrix),A[3]>0?new r.pointGeometry(A[0]/A[3],A[1]/A[3]):new r.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:u,left:f}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,S=this.pointCoordinate3D(new r.pointGeometry(f,u)),B=this.pointCoordinate3D(new r.pointGeometry(A,u)),G=this.pointCoordinate3D(new r.pointGeometry(A,y)),W=this.pointCoordinate3D(new r.pointGeometry(f,y));let it=Math.min(S.x,W.x),et=Math.max(B.x,G.x),_t=Math.min(S.y,B.y),Mt=Math.max(W.y,G.y);const Bt=Math.pow(2,-this.zoom)/16,Ft=(re,Ae,He,je)=>{const De=(re+He)/2,An=(Ae+je)/2,Fe=new r.pointGeometry(De,An),fn=this.pointCoordinate3D(Fe),Je=Math.max(0,it-fn.x,_t-fn.y,fn.x-et,fn.y-Mt);it=Math.min(it,fn.x),et=Math.max(et,fn.x),_t=Math.min(_t,fn.y),Mt=Math.max(Mt,fn.y),Je>Bt&&(Ft(re,Ae,De,An),Ft(De,An,He,je))};Ft(f,u,A,u),Ft(A,u,A,y),Ft(A,y,f,y),Ft(f,y,f,u);const[Gt,Pt]=r.polesInViewport(this),Ot=Gt||Pt,Wt=Gt?90:r.latFromMercatorY(_t),jt=Ot?180:r.lngFromMercatorX(et),Kt=Pt?-90:r.latFromMercatorY(Mt),me=Ot?-180:r.lngFromMercatorX(it);return new r.LngLatBounds(new r.LngLat(me,Kt),new r.LngLat(jt,Wt))}_getBounds(u,f){if(this.projection.name==="globe")return this._getGlobeBounds();const y=new r.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),A=new r.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),S=new r.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),B=new r.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let G=this.pointCoordinate(y,u),W=this.pointCoordinate(A,u);const it=this.pointCoordinate(S,f),et=this.pointCoordinate(B,f),_t=(Mt,Bt)=>(Bt.y-Mt.y)/(Bt.x-Mt.x);return G.y>1&&W.y>=0?G=new r.MercatorCoordinate((1-et.y)/_t(et,G)+et.x,1):G.y<0&&W.y<=1&&(G=new r.MercatorCoordinate(-et.y/_t(et,G)+et.x,0)),W.y>1&&G.y>=0?W=new r.MercatorCoordinate((1-it.y)/_t(it,W)+it.x,1):W.y<0&&G.y<=1&&(W=new r.MercatorCoordinate(-it.y/_t(it,W)+it.x,0)),new r.LngLatBounds().extend(this.coordinateLocation(G)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(et)).extend(this.coordinateLocation(it))}_getBounds3D(){const u=this.elevation;if(!u.visibleDemTiles.length||u.isUsingMockSource())return this._getBounds(0,0);const f=u.visibleDemTiles.reduce((y,A)=>{if(A.dem){const S=A.dem.tree;y.min=Math.min(y.min,S.minimums[0]),y.max=Math.max(y.max,S.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBounds(f.min*u.exaggeration(),f.max*u.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(u=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-f*(1-this._horizonShift);return u?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(u){this.maxBounds=u,this.minLat=-r.MAX_MERCATOR_LATITUDE,this.maxLat=r.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,u&&(this.minLat=u.getSouth(),this.maxLat=u.getNorth(),this.minLng=u.getWest(),this.maxLng=u.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=r.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=r.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=r.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(u,f){return this.projection.createTileMatrix(this,f,u)}calculateDistanceTileData(u){const f=u.key,y=this._distanceTileDataCache;if(y[f])return y[f];const A=u.canonical,S=1/this.height,B=this.cameraWorldSize,G=B/this.zoomScale(A.z),W=(A.x+Math.pow(2,A.z)*u.wrap)*G,it=A.y*G,et=this.point;et.x*=B/this.worldSize,et.y*=B/this.worldSize;const _t=this.angle,Mt=Math.sin(-_t),Bt=-Math.cos(-_t);return y[f]={bearing:[Mt,Bt],center:[(et.x-W)*S,(et.y-it)*S],scale:G/r.EXTENT*S},y[f]}calculateFogTileMatrix(u){const f=u.key,y=this._fogTileMatrixCache;if(y[f])return y[f];const A=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,u);return r.multiply(A,this.worldToFogMatrix,A),y[f]=new Float32Array(A),y[f]}calculateProjMatrix(u,f=!1){const y=u.key,A=f?this._alignedProjMatrixCache:this._projMatrixCache;if(A[y])return A[y];const S=this.calculatePosMatrix(u,this.worldSize);return r.multiply(S,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,S),A[y]=new Float32Array(S),A[y]}calculatePixelsToTileUnitsMatrix(u){const f=u.tileID.key,y=this._pixelsToTileUnitsCache;if(y[f])return y[f];const A=function(S,B){const{scale:G}=S.tileTransform,W=G*r.EXTENT/(S.tileSize*Math.pow(2,B.zoom-S.tileID.overscaledZ+S.tileID.canonical.z));return it=new Float32Array(4),Mt=(et=B.inverseAdjustmentMatrix)[1],Bt=et[2],Ft=et[3],Pt=(_t=[W,W])[1],it[0]=et[0]*(Gt=_t[0]),it[1]=Mt*Gt,it[2]=Bt*Pt,it[3]=Ft*Pt,it;var it,et,_t,Mt,Bt,Ft,Gt,Pt}(u,this);return y[f]=A,y[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const u=this._elevation;this._updateCameraState();const f=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),A=this._camera.forward(),S=r.mercatorZfromAltitude(1,this._center.lat);y[2]/=S,A[2]/=S,r.normalize(A,A);const B=u.raycast(y,A,u.exaggeration());if(B){const G=r.scaleAndAdd([],y,A,B),W=new r.MercatorCoordinate(G[0],G[1],r.mercatorZfromAltitude(G[2],r.latFromMercatorY(G[1]))),it=(W.z+r.length([W.x-y[0],W.y-y[1],W.z-y[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(it),this._centerAltitude=W.toAltitude(),this._center=this.coordinateLocation(W),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(u=!1){if(!this._elevation)return;const f=this._elevation,y=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,A=this._computeCameraPosition(y),S=f.getAtPointOrZero(new r.MercatorCoordinate(...A)),B=this.pixelsPerMeter/this.worldSize*S,G=this._minimumHeightOverTerrain(),W=A[2]-B;if(W<=G)if(W<0||u){const it=this.locationCoordinate(this._center,this._centerAltitude),et=[A[0],A[1],it.z-A[2]],_t=r.length(et);et[2]-=(G-W)/this._pixelsPerMercatorPixel;const Mt=r.length(et);if(Mt===0)return;r.scale$2(et,et,_t/Mt*this._pixelsPerMercatorPixel),this._camera.position=[A[0],A[1],it.z*this._pixelsPerMercatorPixel-et[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const u=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||u){const Mt=this.center;return Mt.lat=r.clamp(Mt.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!u)&&(Mt.lng=r.clamp(Mt.lng,this.minLng,this.maxLng)),this.center=Mt,void(this._constraining=!1)}const f=this._unmodified,{x:y,y:A}=this.point;let S=0,B=y,G=A;const W=this.width/2,it=this.height/2,et=this.worldMinY*this.scale,_t=this.worldMaxY*this.scale;if(A-it<et&&(G=et+it),A+it>_t&&(G=_t-it),_t-et<this.height&&(S=Math.max(S,this.height/(_t-et)),G=(_t+et)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Mt=this.worldMinX*this.scale,Bt=this.worldMaxX*this.scale,Ft=this.worldSize/2-(Mt+Bt)/2;B=(y+Ft+this.worldSize)%this.worldSize-Ft,B-W<Mt&&(B=Mt+W),B+W>Bt&&(B=Bt-W),Bt-Mt<this.width&&(S=Math.max(S,this.width/(Bt-Mt)),B=(Bt+Mt)/2)}B===y&&G===A||(this.center=this.unproject(new r.pointGeometry(B,G))),S&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let u=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(u=Math.max(u,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),u}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const u=this.centerOffset,f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.mercatorZfromAltitude(1,this.center.lat)/r.mercatorZfromAltitude(1,r.GLOBE_SCALE_MATCH_LATITUDE));const y=zs(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const A=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?f:1),S=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);S[8]=2*-u.x/this.width,S[9]=2*u.y/this.height;let B=r.mul([],S,A);if(this.projection.isReprojectedInTileSpace){const me=this.locationCoordinate(this.center),re=r.identity([]);r.translate(re,re,[me.x*this.worldSize,me.y*this.worldSize,0]),r.multiply(re,re,rs(this)),r.translate(re,re,[-me.x*this.worldSize,-me.y*this.worldSize,0]),r.multiply(B,B,re),this.inverseAdjustmentMatrix=function(Ae){const He=rs(Ae,!0);return xt([],[He[0],He[1],He[4],He[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=r.scale([],B,[this.worldSize,this.worldSize,this.worldSize/f,1]),this.projMatrix=B,this.invProjMatrix=r.invert(new Float64Array(16),this.projMatrix);const G=r.invert([],S);this.frustumCorners=r.FrustumCorners.fromInvProjectionMatrix(G,this.horizonLineFromTop(),this.height);const W=new Float32Array(16);r.identity(W),r.scale(W,W,[1,-1,1]),r.rotateX(W,W,this._pitch),r.rotateZ(W,W,this.angle);const it=r.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),et=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;it[8]=2*-u.x/this.width,it[9]=2*(u.y+et)/this.height,this.skyboxMatrix=r.multiply(W,it,W);const _t=this.point,Mt=_t.x,Bt=_t.y,Ft=this.width%2/2,Gt=this.height%2/2,Pt=Math.cos(this.angle),Ot=Math.sin(this.angle),Wt=Mt-Math.round(Mt)+Pt*Ft+Ot*Gt,jt=Bt-Math.round(Bt)+Pt*Gt+Ot*Ft,Kt=new Float64Array(B);if(r.translate(Kt,Kt,[Wt>.5?Wt-1:Wt,jt>.5?jt-1:jt,0]),this.alignedProjMatrix=Kt,B=r.create(),r.scale(B,B,[this.width/2,-this.height/2,1]),r.translate(B,B,[1,-1,0]),this.labelPlaneMatrix=B,B=r.create(),r.scale(B,B,[1,-1,1]),r.translate(B,B,[-1,-1,0]),r.scale(B,B,[2/this.width,2/this.height,1]),this.glCoordMatrix=B,this.pixelMatrix=r.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},B=r.invert(new Float64Array(16),this.pixelMatrix),!B)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=B,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.calculateGlobeMatrix(this);const me=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.transformMat4(me,me,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=B;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const u=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,y=this._camera.position,A=1/this.height/this._pixelsPerMercatorPixel,S=[u,u,f];r.scale$2(S,S,A),r.scale$2(y,y,-1),r.multiply$2(y,y,S);const B=r.create();r.translate(B,B,y),r.scale(B,B,S),this.mercatorFogMatrix=B,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(u,f,A)}_computeCameraPosition(u){const f=(u=u||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),A=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-u/this.worldSize*this._centerAltitude;return[A.x/this.worldSize-y[0]*S,A.y/this.worldSize-y[1]*S,u/this.worldSize*this._centerAltitude-y[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(u){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],A=u[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),A>0&&(S=Math.min((f-y)/A,1)),this._camera.position=r.scaleAndAdd([],this._camera.position,u,S),this._updateStateFromCamera()}_updateStateFromCamera(){const u=this._camera.position,f=this._camera.forward(),{pitch:y,bearing:A}=this._camera.getPitchBearing(),S=r.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,B=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.degToRad(this._maxPitch)),G=Math.max((u[2]-S)/Math.cos(y),B),W=this._zoomFromMercatorZ(G);r.scaleAndAdd(u,u,f,G),this._pitch=r.clamp(y,r.degToRad(this.minPitch),r.degToRad(this.maxPitch)),this.angle=r.wrap(A,-Math.PI,Math.PI),this._setZoom(r.clamp(W,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.MercatorCoordinate(u[0],u[1],u[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(u){return Math.pow(2,u)*this.tileSize}_mercatorZfromZoom(u){return this.cameraToCenterDistance/this._worldSizeFromZoom(u)}_minimumHeightOverTerrain(){const u=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(u)}_zoomFromMercatorZ(u){return this.scaleZoom(this.cameraToCenterDistance/(u*this.tileSize))}zoomFromMercatorZAdjusted(u){const f=B=>{const G=this.getCameraToCenterDistance(this.projection,B);return this.scaleZoom(G/(u*this.tileSize))};let y,A=f(this.zoom),S=Math.abs(A-f(A));for(;y!==S;)A=f(A),y=S,S=Math.abs(A-f(A));return A}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(u,f){const y=Math.min(u.x,f.x),A=Math.max(u.x,f.x),S=Math.min(u.y,f.y),B=Math.max(u.y,f.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const G=[new r.pointGeometry(y,S),new r.pointGeometry(A,B),new r.pointGeometry(y,B),new r.pointGeometry(A,S)],W=this.renderWorldCopies?-3:0,it=this.renderWorldCopies?4:1;for(const et of G){const _t=this.pointRayIntersection(et);if(_t.t<0)return!0;const Mt=this.rayIntersectionCoordinate(_t);if(Mt.x<W||Mt.y<0||Mt.x>it||Mt.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.pointGeometry(0,0),new r.pointGeometry(this.width,this.height))}zoomDeltaToMovement(u,f){const y=r.length(r.sub([],this._camera.position,u)),A=this._zoomFromMercatorZ(y)+f;return y-this._mercatorZfromZoom(A)}getCameraPoint(){if(this.projection.name==="globe"){const u=function([f,y,A],S){const B=[f,y,A,1];r.transformMat4$1(B,B,S);const G=B[3]=Math.max(B[3],1e-6);return B[0]/=G,B[1]/=G,B[2]/=G,B}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.pointGeometry(u[0],u[1])}{const u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.pointGeometry(0,u))}}getCameraToCenterDistance(u,f=this.zoom){const y=zs(u,f,this.width,this.height,1024),A=u.pixelSpaceConversion(this.center.lat,this.worldSize,y);return .5/Math.tan(.5*this._fov)*this.height*A}getWorldToCameraMatrix(){const u=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.multiply(u,u,this.globeMatrix),u}}function _c(_,u){let f=!1,y=null;const A=()=>{y=null,f&&(_(),y=setTimeout(A,u),f=!1)};return()=>(f=!0,y||A(),y)}class $n{constructor(u){this._hashName=u&&encodeURIComponent(u),r.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=_c(this._updateHashUnthrottled.bind(this),300)}addTo(u){return this._map=u,r.window.addEventListener("hashchange",this._onHashChange,!1),u.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),r.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const u=this._map;if(!u)return"";const f=Oa(u);if(this._hashName){const y=this._hashName;let A=!1;const S=r.window.location.hash.slice(1).split("&").map(B=>{const G=B.split("=")[0];return G===y?(A=!0,`${G}=${f}`):B}).filter(B=>B);return A||S.push(`${y}=${f}`),`#${S.join("&")}`}return`#${f}`}_getCurrentHash(){const u=r.window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return u.split("/")}_onHashChange(){const u=this._map;if(!u)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(y=>isNaN(y))){const y=u.dragRotate.isEnabled()&&u.touchZoomRotate.isEnabled()?+(f[3]||0):u.getBearing();return u.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:y,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){const u=r.window.location.href.replace(/(#.+)?$/,this.getHashString());r.window.history.replaceState(r.window.history.state,null,u)}}function Oa(_,u){const f=_.getCenter(),y=Math.round(100*_.getZoom())/100,A=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,A),B=Math.round(f.lng*S)/S,G=Math.round(f.lat*S)/S,W=_.getBearing(),it=_.getPitch();let et=u?`/${B}/${G}/${y}`:`${y}/${G}/${B}`;return(W||it)&&(et+="/"+Math.round(10*W)/10),it&&(et+=`/${Math.round(it)}`),et}const Ql={linearity:.3,easing:r.bezier(0,0,.3,1)},jc=r.extend({deceleration:2500,maxSpeed:1400},Ql),d=r.extend({deceleration:20,maxSpeed:1400},Ql),b=r.extend({deceleration:1e3,maxSpeed:360},Ql),D=r.extend({deceleration:1e3,maxSpeed:90},Ql);class H{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.exported.now(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,f=r.exported.now();for(;u.length>0&&f-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,pan:new r.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)f.zoom+=S.zoomDelta||0,f.bearing+=S.bearingDelta||0,f.pitch+=S.pitchDelta||0,S.panDelta&&f.pan._add(S.panDelta),S.around&&(f.around=S.around),S.pinchAround&&(f.pinchAround=S.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,A={};if(f.pan.mag()){const S=St(f.pan.mag(),y,r.extend({},jc,u||{}));A.offset=f.pan.mult(S.amount/f.pan.mag()),A.center=this._map.transform.center,ut(A,S)}if(f.zoom){const S=St(f.zoom,y,d);A.zoom=this._map.transform.zoom+S.amount,ut(A,S)}if(f.bearing){const S=St(f.bearing,y,b);A.bearing=this._map.transform.bearing+r.clamp(S.amount,-179,179),ut(A,S)}if(f.pitch){const S=St(f.pitch,y,D);A.pitch=this._map.transform.pitch+S.amount,ut(A,S)}if(A.zoom||A.bearing){const S=f.pinchAround===void 0?f.around:f.pinchAround;A.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),A.noMoveStart=!0,A}}function ut(_,u){(!_.duration||_.duration<u.duration)&&(_.duration=u.duration,_.easing=u.easing)}function St(_,u,f){const{maxSpeed:y,linearity:A,deceleration:S}=f,B=r.clamp(_*A/(u/1e3),-y,y),G=Math.abs(B)/(S*A);return{easing:f.easing,duration:1e3*G,amount:B*(G/2)}}class ne extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,f,y,A={}){const S=j(f.getCanvasContainer(),y),B=f.unproject(S);super(u,r.extend({point:S,lngLat:B,originalEvent:y},A)),this._defaultPrevented=!1,this.target=f}}class Ve extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,f,y){const A=u==="touchend"?y.changedTouches:y.touches,S=k(f.getCanvasContainer(),A),B=S.map(W=>f.unproject(W)),G=S.reduce((W,it,et,_t)=>W.add(it.div(_t.length)),new r.pointGeometry(0,0));super(u,{points:S,point:G,lngLats:B,lngLat:f.unproject(G),originalEvent:y}),this._defaultPrevented=!1}}class sn extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,f,y){super(u,{originalEvent:y}),this._defaultPrevented=!1}}class On{constructor(u,f){this._map=u,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(u){return this._firePreventable(new sn(u.type,this._map,u))}mousedown(u,f){return this._mousedownPos=f,this._firePreventable(new ne(u.type,this._map,u))}mouseup(u){this._map.fire(new ne(u.type,this._map,u))}preclick(u){const f=r.extend({},u);f.type="preclick",this._map.fire(new ne(f.type,this._map,f))}click(u,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(u),this._map.fire(new ne(u.type,this._map,u)))}dblclick(u){return this._firePreventable(new ne(u.type,this._map,u))}mouseover(u){this._map.fire(new ne(u.type,this._map,u))}mouseout(u){this._map.fire(new ne(u.type,this._map,u))}touchstart(u){return this._firePreventable(new Ve(u.type,this._map,u))}touchmove(u){this._map.fire(new Ve(u.type,this._map,u))}touchend(u){this._map.fire(new Ve(u.type,this._map,u))}touchcancel(u){this._map.fire(new Ve(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ii{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(u){this._map.fire(new ne(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ne("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new ne(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zi{constructor(u,f){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,f){this.isEnabled()&&u.shiftKey&&u.button===0&&(J(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(u,f){if(!this._active)return;const y=f,A=this._startPos,S=this._lastPos;if(!A||!S||S.equals(y)||!this._box&&y.dist(A)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=Z("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));const B=Math.min(A.x,y.x),G=Math.max(A.x,y.x),W=Math.min(A.y,y.y),it=Math.max(A.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${B}px,${W}px)`,this._box.style.width=G-B+"px",this._box.style.height=it-W+"px")})}mouseupWindow(u,f){if(!this._active)return;const y=this._startPos,A=f;if(y&&u.button===0){if(this.reset(),Ct(),y.x!==A.x||y.y!==A.y)return this._map.fire(new r.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:S=>S.fitScreenCoordinates(y,A,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",u)}}keydown(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Q(),delete this._startPos,delete this._lastPos}_fireEvent(u,f){return this._map.fire(new r.Event(u,{originalEvent:f}))}}function Qi(_,u){const f={};for(let y=0;y<_.length;y++)f[_[y].identifier]=u[y];return f}class Ys{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(u,f,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=u.timeStamp),y.length===this.numTouches&&(this.centroid=function(A){const S=new r.pointGeometry(0,0);for(const B of A)S._add(B);return S.div(A.length)}(f),this.touches=Qi(y,f)))}touchmove(u,f,y){if(this.aborted||!this.centroid)return;const A=Qi(y,f);for(const S in this.touches){const B=this.touches[S],G=A[S];(!G||G.dist(B)>30)&&(this.aborted=!0)}}touchend(u,f,y){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const A=!this.aborted&&this.centroid;if(this.reset(),A)return A}}}class ra{constructor(u){this.singleTap=new Ys(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(u,f,y){this.singleTap.touchstart(u,f,y)}touchmove(u,f,y){this.singleTap.touchmove(u,f,y)}touchend(u,f,y){const A=this.singleTap.touchend(u,f,y);if(A){const S=u.timeStamp-this.lastTime<500,B=!this.lastTap||this.lastTap.dist(A)<30;if(S&&B||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=A,this.count===this.numTaps)return this.reset(),A}}}class tu{constructor(){this._zoomIn=new ra({numTouches:1,numTaps:2}),this._zoomOut=new ra({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,f,y){this._zoomIn.touchstart(u,f,y),this._zoomOut.touchstart(u,f,y)}touchmove(u,f,y){this._zoomIn.touchmove(u,f,y),this._zoomOut.touchmove(u,f,y)}touchend(u,f,y){const A=this._zoomIn.touchend(u,f,y),S=this._zoomOut.touchend(u,f,y);return A?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:B.getZoom()+1,around:B.unproject(A)},{originalEvent:u})}):S?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:B.getZoom()-1,around:B.unproject(S)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const oa={0:1,2:2};class zl{constructor(u){this.reset(),this._clickTolerance=u.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(u,f){return!1}_move(u,f){return{}}mousedown(u,f){if(this._lastPoint)return;const y=rt(u);this._correctButton(u,y)&&(this._lastPoint=f,this._eventButton=y)}mousemoveWindow(u,f){const y=this._lastPoint;if(y){if(u.preventDefault(),this._eventButton!=null&&function(A,S){const B=oa[S];return A.buttons===void 0||(A.buttons&B)!==B}(u,this._eventButton))this.reset();else if(this._moved||!(f.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(y,f)}}mouseupWindow(u){this._lastPoint&&rt(u)===this._eventButton&&(this._moved&&Ct(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xu extends zl{mousedown(u,f){super.mousedown(u,f),this._lastPoint&&(this._active=!0)}_correctButton(u,f){return f===0&&!u.ctrlKey}_move(u,f){return{around:f,panDelta:f.sub(u)}}}class Bh extends zl{_correctButton(u,f){return f===0&&u.ctrlKey||f===2}_move(u,f){const y=.8*(f.x-u.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(u){u.preventDefault()}}class Fh extends zl{_correctButton(u,f){return f===0&&u.ctrlKey||f===2}_move(u,f){const y=-.5*(f.y-u.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(u){u.preventDefault()}}class jh{constructor(u,f){this._map=u,this._el=u.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),r.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.pointGeometry(0,0)}touchstart(u,f,y){return this._calculateTransform(u,f,y)}touchmove(u,f,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!r.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return u.cancelable&&u.preventDefault(),this._calculateTransform(u,f,y)}}touchend(u,f,y){this._calculateTransform(u,f,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,f,y){y.length>0&&(this._active=!0);const A=Qi(y,f),S=new r.pointGeometry(0,0),B=new r.pointGeometry(0,0);let G=0;for(const it in A){const et=A[it],_t=this._touches[it];_t&&(S._add(et),B._add(et.sub(_t)),G++,A[it]=et)}if(this._touches=A,G<this._minTouches||!B.mag())return;const W=B.div(G);return this._sum._add(W),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(G),panDelta:W}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class fh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(u){}_move(u,f,y){return{}}touchstart(u,f,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([f[0],f[1]]))}touchmove(u,f,y){const A=this._firstTwoTouches;if(!A)return;u.preventDefault();const[S,B]=A,G=Dl(y,f,S),W=Dl(y,f,B);if(!G||!W)return;const it=this._aroundCenter?null:G.add(W).div(2);return this._move([G,W],it,u)}touchend(u,f,y){if(!this._firstTwoTouches)return;const[A,S]=this._firstTwoTouches,B=Dl(y,f,A),G=Dl(y,f,S);B&&G||(this._active&&Ct(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Dl(_,u,f){for(let y=0;y<_.length;y++)if(_[y].identifier===f)return u[y]}function Lo(_,u){return Math.log(_/u)/Math.LN2}class eu extends fh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,f){const y=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(Lo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Lo(this._distance,y),pinchAround:f}}}function Uh(_,u){return 180*_.angleWith(u)/Math.PI}class Dt extends fh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,f){const y=this._vector;if(this._vector=u[0].sub(u[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Uh(this._vector,y),pinchAround:f}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const f=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const A=Uh(u,y);return Math.abs(A)<f}}function nu(_){return Math.abs(_.y)>Math.abs(_.x)}class Hu extends fh{constructor(u){super(),this._map=u}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(u){this._lastPoints=u,nu(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,f,y){const A=this._lastPoints;if(!A)return;const S=u[0].sub(A[0]),B=u[1].sub(A[1]);return this._map._cooperativeGestures&&!r.isFullscreen()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(S,B,y.timeStamp),!this._valid)?void 0:(this._lastPoints=u,this._active=!0,{pitchDelta:(S.y+B.y)/2*-.5})}gestureBeginsVertically(u,f,y){if(this._valid!==void 0)return this._valid;const A=u.mag()>=2,S=f.mag()>=2;if(!A&&!S)return;if(!A||!S)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const B=u.y>0==f.y>0;return nu(u)&&nu(f)&&B}}const _a={panStep:100,bearingStep:15,pitchStep:10};class Ni{constructor(){const u=_a;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let f=0,y=0,A=0,S=0,B=0;switch(u.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:u.shiftKey?y=-1:(u.preventDefault(),S=-1);break;case 39:u.shiftKey?y=1:(u.preventDefault(),S=1);break;case 38:u.shiftKey?A=1:(u.preventDefault(),B=-1);break;case 40:u.shiftKey?A=-1:(u.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(y=0,A=0),{cameraAnimation:G=>{const W=G.getZoom();G.easeTo({duration:300,easeId:"keyboardHandler",easing:Pg,zoom:f?Math.round(W)+f*(u.shiftKey?2:1):W,bearing:G.getBearing()+y*this._bearingStep,pitch:G.getPitch()+A*this._pitchStep,offset:[-S*this._panStep,-B*this._panStep],center:G.getCenter()},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Pg(_){return _*(2-_)}const Sd=4.000244140625;class zg{constructor(u,f){this._map=u,this._el=u.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,r.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&u.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(u){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(u.ctrlKey||u.metaKey||this.isZooming()||r.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=u.deltaMode===r.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const y=r.exported.now(),A=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,f!==0&&f%Sd==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":A>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(A*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),u.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=u,this._delta-=f,this._active||this._start(u)),u.preventDefault()}_onTimeout(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=j(this._el,u);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._map.transform;this._type==="wheel"&&u.projection.wrap&&(u._center.lng>=180||u._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>u._terrainEnabled()&&this._aroundCoord?u.computeZoomRelativeTo(this._aroundCoord):u.zoom;if(this._delta!==0){const W=this._type==="wheel"&&Math.abs(this._delta)>Sd?this._wheelZoomRate:this._defaultZoomRate;let it=2/(1+Math.exp(-Math.abs(this._delta*W)));this._delta<0&&it!==0&&(it=1/it);const et=f(),_t=Math.pow(2,et),Mt=typeof this._targetZoom=="number"?u.zoomScale(this._targetZoom):_t;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(Mt*it))),this._type==="wheel"&&(this._startZoom=et,this._easing=this._smoothOutEasing(200)),this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:f(),A=this._startZoom,S=this._easing;let B,G=!1;if(this._type==="wheel"&&A&&S){const W=Math.min((r.exported.now()-this._lastWheelEventTime)/200,1),it=S(W);B=r.number(A,y,it),W<1?this._frameId||(this._frameId=!0):G=!0}else B=y,G=!0;return this._active=!0,G&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!G,zoomDelta:B-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let f=r.ease;if(this._prevEase){const y=this._prevEase,A=(r.exported.now()-y.start)/y.duration,S=y.easing(A+.01)-y.easing(A),B=.27/Math.sqrt(S*S+1e-4)*.01,G=Math.sqrt(.0729-B*B);f=r.bezier(B,G,.25,1)}return this._prevEase={start:r.exported.now(),duration:u,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(r.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Uc{constructor(u,f){this._clickZoom=u,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class $u{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(u,f){return u.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(u.shiftKey?-1:1),around:y.unproject(f)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gp{constructor(){this._tap=new ra({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(u,f,y){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=f[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(u,f,y))}touchmove(u,f,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const A=f[0],S=A.y-this._swipePoint.y;return this._swipePoint=A,u.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(u,f,y)}touchend(u,f,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(u,f,y)&&(this._tapTime=u.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dh{constructor(u,f,y){this._el=u,this._mousePan=f,this._touchPan=y}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Iu{constructor(u,f,y){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=f,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Tf{constructor(u,f,y,A){this._el=u,this._touchZoom=f,this._touchRotate=y,this._tapDragZoom=A,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Xn=_=>_.zoom||_.drag||_.pitch||_.rotate;class Zp extends r.Event{}class Vp{constructor(){this.constants=[1,1,.01],this.radius=0}setup(u,f){const y=r.sub([],f,u);this.radius=r.length(y[2]<0?r.div([],y,this.constants):[y[0],y[1],0])}projectRay(u){r.div(u,u,this.constants),r.normalize(u,u),r.mul$1(u,u,this.constants);const f=r.scale$2([],u,this.radius);if(f[2]>0){const y=r.scale$2([],[0,0,1],r.dot(f,[0,0,1])),A=r.scale$2([],r.normalize([],[f[0],f[1],0]),this.radius),S=r.add([],f,r.scale$2([],r.sub([],r.add([],A,y),f),2));f[0]=S[0],f[1]=S[1]}return f}}function vc(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Gh{constructor(u,f){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new H(u),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Vp,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),r.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[r.window.document,"mousemove",{capture:!0}],[r.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[r.window,"blur",void 0]];for(const[A,S,B]of this._listeners)A.addEventListener(S,A===r.window.document?this.handleWindowEvent:this.handleEvent,B)}destroy(){for(const[u,f,y]of this._listeners)u.removeEventListener(f,u===r.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(u){const f=this._map,y=f.getCanvasContainer();this._add("mapEvent",new On(f,u));const A=f.boxZoom=new Zi(f,u);this._add("boxZoom",A);const S=new tu,B=new $u;f.doubleClickZoom=new Uc(B,S),this._add("tapZoom",S),this._add("clickZoom",B);const G=new Gp;this._add("tapDragZoom",G);const W=f.touchPitch=new Hu(f);this._add("touchPitch",W);const it=new Bh(u),et=new Fh(u);f.dragRotate=new Iu(u,it,et),this._add("mouseRotate",it,["mousePitch"]),this._add("mousePitch",et,["mouseRotate"]);const _t=new Xu(u),Mt=new jh(f,u);f.dragPan=new dh(y,_t,Mt),this._add("mousePan",_t),this._add("touchPan",Mt,["touchZoom","touchRotate"]);const Bt=new Dt,Ft=new eu;f.touchZoomRotate=new Tf(y,Ft,Bt,G),this._add("touchRotate",Bt,["touchPan","touchZoom"]),this._add("touchZoom",Ft,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ii(f));const Gt=f.scrollZoom=new zg(f,this);this._add("scrollZoom",Gt,["mousePan"]);const Pt=f.keyboard=new Ni;this._add("keyboard",Pt);for(const Ot of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])u.interactive&&u[Ot]&&f[Ot].enable(u[Ot])}_add(u,f,y){this._handlers.push({handlerName:u,handler:f,allowed:y}),this._handlersById[u]=f}stop(u){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Xn(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(u,f,y){for(const A in u)if(A!==y&&(!f||f.indexOf(A)<0))return!0;return!1}handleWindowEvent(u){this.handleEvent(u,`${u.type}Window`)}_getMapTouches(u){const f=[];for(const y of u)this._el.contains(y.target)&&f.push(y);return f}handleEvent(u,f){this._updatingCamera=!0;const y=u.type==="renderFrame",A=y?void 0:u,S={needsRenderFrame:!1},B={},G={},W=u.touches?this._getMapTouches(u.touches):void 0,it=W?k(this._el,W):y?void 0:j(this._el,u);for(const{handlerName:Mt,handler:Bt,allowed:Ft}of this._handlers){if(!Bt.isEnabled())continue;let Gt;this._blockedByActive(G,Ft,Mt)?Bt.reset():Bt[f||u.type]&&(Gt=Bt[f||u.type](u,it,W),this.mergeHandlerResult(S,B,Gt,Mt,A),Gt&&Gt.needsRenderFrame&&this._triggerRenderFrame()),(Gt||Bt.isActive())&&(G[Mt]=Bt)}const et={};for(const Mt in this._previousActiveHandlers)G[Mt]||(et[Mt]=A);this._previousActiveHandlers=G,(Object.keys(et).length||vc(S))&&(this._changes.push([S,B,et]),this._triggerRenderFrame()),(Object.keys(G).length||vc(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:_t}=S;_t&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],_t(this._map))}mergeHandlerResult(u,f,y,A,S){if(!y)return;r.extend(u,y);const B={handlerName:A,originalEvent:y.originalEvent||S};y.zoomDelta!==void 0&&(f.zoom=B),y.panDelta!==void 0&&(f.drag=B),y.pitchDelta!==void 0&&(f.pitch=B),y.bearingDelta!==void 0&&(f.rotate=B)}_applyChanges(){const u={},f={},y={};for(const[A,S,B]of this._changes)A.panDelta&&(u.panDelta=(u.panDelta||new r.pointGeometry(0,0))._add(A.panDelta)),A.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+A.zoomDelta),A.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+A.bearingDelta),A.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+A.pitchDelta),A.around!==void 0&&(u.around=A.around),A.aroundCoord!==void 0&&(u.aroundCoord=A.aroundCoord),A.pinchAround!==void 0&&(u.pinchAround=A.pinchAround),A.noInertia&&(u.noInertia=A.noInertia),r.extend(f,S),r.extend(y,B);this._updateMapTransform(u,f,y),this._changes=[]}_updateMapTransform(u,f,y){const A=this._map,S=A.transform,B=Wt=>[Wt.x,Wt.y,Wt.z];if((Wt=>{const jt=this._eventsInProgress.drag;return jt&&!this._handlersById[jt.handlerName].isActive()})()&&!vc(u)){const Wt=S.zoom;S.cameraElevationReference="sea",S.recenterOnTerrain(),S.cameraElevationReference="ground",Wt!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&A._stop(!0),!vc(u))return void this._fireEvents(f,y,!0);let{panDelta:G,zoomDelta:W,bearingDelta:it,pitchDelta:et,around:_t,aroundCoord:Mt,pinchAround:Bt}=u;S._isCameraConstrained&&(W>0&&(W=0),S._isCameraConstrained=!1),Bt!==void 0&&(_t=Bt),(Wt=>f.drag&&!this._eventsInProgress.drag)()&&_t&&(this._dragOrigin=B(S.pointCoordinate3D(_t)),this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",A._stop(!0),_t=_t||A.transform.centerPoint,it&&(S.bearing+=it),et&&(S.pitch+=et),S._updateCameraState();const Ft=[0,0,0];if(G)if(S.projection.name==="mercator"){const Wt=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(_t).dir),jt=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(_t.sub(G)).dir);Ft[0]=jt[0]-Wt[0],Ft[1]=jt[1]-Wt[1]}else{const Wt=S.pointCoordinate(_t);if(S.projection.name==="globe"){G=G.rotate(-S.angle);const jt=S._pixelsPerMercatorPixel/S.worldSize;Ft[0]=-G.x*r.mercatorScale(r.latFromMercatorY(Wt.y))*jt,Ft[1]=-G.y*r.mercatorScale(S.center.lat)*jt}else{const jt=S.pointCoordinate(_t.sub(G));Wt&&jt&&(Ft[0]=jt.x-Wt.x,Ft[1]=jt.y-Wt.y)}}const Gt=S.zoom,Pt=[0,0,0];if(W){const Wt=B(Mt||S.pointCoordinate3D(_t)),jt={dir:r.normalize([],r.sub([],Wt,S._camera.position))};if(jt.dir[2]<0){const Kt=S.zoomDeltaToMovement(Wt,W);r.scale$2(Pt,jt.dir,Kt)}}const Ot=r.add(Ft,Ft,Pt);S._translateCameraConstrained(Ot),W&&Math.abs(S.zoom-Gt)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(f,y,!0)}_fireEvents(u,f,y){const A=Xn(this._eventsInProgress),S=Xn(u),B={};for(const et in u){const{originalEvent:_t}=u[et];this._eventsInProgress[et]||(B[`${et}start`]=_t),this._eventsInProgress[et]=u[et]}!A&&S&&this._fireEvent("movestart",S.originalEvent);for(const et in B)this._fireEvent(et,B[et]);S&&this._fireEvent("move",S.originalEvent);for(const et in u){const{originalEvent:_t}=u[et];this._fireEvent(et,_t)}const G={};let W;for(const et in this._eventsInProgress){const{handlerName:_t,originalEvent:Mt}=this._eventsInProgress[et];this._handlersById[_t].isActive()||(delete this._eventsInProgress[et],W=f[_t]||Mt,G[`${et}end`]=W)}for(const et in G)this._fireEvent(et,G[et]);const it=Xn(this._eventsInProgress);if(y&&(A||S)&&!it){this._updatingCamera=!0;const et=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_t=Mt=>Mt!==0&&-this._bearingSnap<Mt&&Mt<this._bearingSnap;et?(_t(et.bearing||this._map.getBearing())&&(et.bearing=0),this._map.easeTo(et,{originalEvent:W})):(this._map.fire(new r.Event("moveend",{originalEvent:W})),_t(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(u,f){this._map.fire(new r.Event(u,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(u=>{this._frameId=void 0,this.handleEvent(new Zp("renderFrame",{timeStamp:u})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ed="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Cu extends r.Evented{constructor(u,f){super(),this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=f.bearingSnap,r.bindAll(["_renderFrameCallback"],this)}getCenter(){return new r.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(u,f){return this.jumpTo({center:u},f)}panBy(u,f,y){return u=r.pointGeometry.convert(u).mult(-1),this.panTo(this.transform.center,r.extend({offset:u},f),y)}panTo(u,f,y){return this.easeTo(r.extend({center:u},f),y)}getZoom(){return this.transform.zoom}setZoom(u,f){return this.jumpTo({zoom:u},f),this}zoomTo(u,f,y){return this.easeTo(r.extend({zoom:u},f),y)}zoomIn(u,f){return this.zoomTo(this.getZoom()+1,u,f),this}zoomOut(u,f){return this.zoomTo(this.getZoom()-1,u,f),this}getBearing(){return this.transform.bearing}setBearing(u,f){return this.jumpTo({bearing:u},f),this}getPadding(){return this.transform.padding}setPadding(u,f){return this.jumpTo({padding:u},f),this}rotateTo(u,f,y){return this.easeTo(r.extend({bearing:u},f),y)}resetNorth(u,f){return this.rotateTo(0,r.extend({duration:1e3},u),f),this}resetNorthPitch(u,f){return this.easeTo(r.extend({bearing:0,pitch:0,duration:1e3},u),f),this}snapToNorth(u,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,f):this}getPitch(){return this.transform.pitch}setPitch(u,f){return this.jumpTo({pitch:u},f),this}cameraForBounds(u,f){u=r.LngLatBounds.convert(u);const y=f&&f.bearing||0,A=f&&f.pitch||0,S=u.getNorthWest(),B=u.getSouthEast();return this._cameraForBounds(this.transform,S,B,y,A,f)}_extendCameraOptions(u){const f={top:0,bottom:0,right:0,left:0};if(typeof(u=r.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const y=u.padding;u.padding={top:y,bottom:y,right:y,left:y}}return u.padding=r.extend(f,u.padding),u}_minimumAABBFrustumDistance(u,f){const y=f.max[0]-f.min[0],A=f.max[1]-f.min[1];return y/A>u.aspect?y/(2*Math.tan(.5*u.fovX)*u.aspect):A/(2*Math.tan(.5*u.fovY)*u.aspect)}_cameraForBoundsOnGlobe(u,f,y,A,S,B){const G=u.clone(),W=this._extendCameraOptions(B);G.bearing=A,G.pitch=S;const it=r.LngLat.convert(f),et=r.LngLat.convert(y),_t=.5*(it.lat+et.lat),Mt=.5*(it.lng+et.lng),Bt=r.latLngToECEF(_t,Mt),Ft=r.normalize([],Bt),Gt=r.normalize([],r.cross([],Ft,[0,1,0])),Pt=r.cross([],Gt,Ft),Ot=[Gt[0],Gt[1],Gt[2],0,Pt[0],Pt[1],Pt[2],0,Ft[0],Ft[1],Ft[2],0,0,0,0,1],Wt=[Bt,r.latLngToECEF(it.lat,it.lng),r.latLngToECEF(et.lat,it.lng),r.latLngToECEF(et.lat,et.lng),r.latLngToECEF(it.lat,et.lng),r.latLngToECEF(_t,it.lng),r.latLngToECEF(_t,et.lng),r.latLngToECEF(it.lat,Mt),r.latLngToECEF(et.lat,Mt)];let jt=r.Aabb.fromPoints(Wt.map(Ne=>[r.dot(Gt,Ne),r.dot(Pt,Ne),r.dot(Ft,Ne)]));const Kt=r.transformMat4([],jt.center,Ot);r.squaredLength(Kt)===0&&r.set(Kt,0,0,1),r.normalize(Kt,Kt),r.scale$2(Kt,Kt,r.GLOBE_RADIUS),G.center=r.ecefToLatLng(Kt);const me=G.getWorldToCameraMatrix(),re=r.invert(new Float64Array(16),me);jt=r.Aabb.applyTransform(jt,r.multiply([],me,Ot)),r.transformMat4(Kt,Kt,me);const Ae=.5*(jt.max[2]-jt.min[2]),He=this._minimumAABBFrustumDistance(G,jt),je=r.scale$2([],[0,0,1],Ae),De=r.add(je,Kt,je),An=He+(G.pitch===0?0:r.distance(Kt,De)),Fe=G.globeCenterInViewSpace,fn=r.sub([],Kt,[Fe[0],Fe[1],Fe[2]]);r.normalize(fn,fn),r.scale$2(fn,fn,An);const Je=r.add([],Kt,fn);r.transformMat4(Je,Je,re);const Ln=r.earthRadius/r.GLOBE_RADIUS,tn=r.length(Je),xn=r.mercatorZfromAltitude(tn*Ln-r.earthRadius,0),zn=Math.min(G.zoomFromMercatorZAdjusted(xn),W.maxZoom);return zn>.5*(r.GLOBE_ZOOM_THRESHOLD_MIN+r.GLOBE_ZOOM_THRESHOLD_MAX)?(G.setProjection({name:"mercator"}),G.zoom=zn,this._cameraForBounds(G,f,y,A,S,B)):{center:G.center,zoom:zn,bearing:A,pitch:S}}queryTerrainElevation(u,f){const y=this.transform.elevation;return y?(f=r.extend({},{exaggerated:!0},f),y.getAtPoint(r.MercatorCoordinate.fromLngLat(u),null,f.exaggerated)):null}_cameraForBounds(u,f,y,A,S,B){if(u.projection.name==="globe")return this._cameraForBoundsOnGlobe(u,f,y,A,S,B);const G=u.clone(),W=this._extendCameraOptions(B),it=G.padding;G.bearing=A,G.pitch=S;const et=r.LngLat.convert(f),_t=r.LngLat.convert(y),Mt=new r.LngLat(et.lng,_t.lat),Bt=new r.LngLat(_t.lng,et.lat),Ft=G.project(et),Gt=G.project(_t),Pt=this.queryTerrainElevation(et),Ot=this.queryTerrainElevation(_t),Wt=this.queryTerrainElevation(Mt),jt=this.queryTerrainElevation(Bt),Kt=[[Ft.x,Ft.y,Math.min(Pt||0,Ot||0,Wt||0,jt||0)],[Gt.x,Gt.y,Math.max(Pt||0,Ot||0,Wt||0,jt||0)]];let me=r.Aabb.fromPoints(Kt);const re=G.getWorldToCameraMatrix(),Ae=r.invert(new Float64Array(16),re);me=r.Aabb.applyTransform(me,re);const He=r.sub([],me.max,me.min),je=it.left||0,De=it.right||0,An=it.bottom||0,Fe=it.top||0,{left:fn,right:Je,top:Ln,bottom:tn}=W.padding,xn=.5*(je+De),zn=.5*(Fe+An),Ne=Math.min(G.scaleZoom(G.scale*Math.min((G.width-(je+De+fn+Je))/He[0],(G.height-(An+Fe+tn+Ln))/He[1])),W.maxZoom),$e=G.scale/G.zoomScale(Ne);me=new r.Aabb([me.min[0]-(fn+xn)*$e,me.min[1]-(tn+zn)*$e,me.min[2]],[me.max[0]+(Je+xn)*$e,me.max[1]+(Ln+zn)*$e,me.max[2]]);const ri=.5*He[2],fi=this._minimumAABBFrustumDistance(G,me),oi=[0,0,1,0];r.transformMat4$1(oi,oi,re),r.normalize$2(oi,oi);const Li=r.scale$2([],oi,fi+ri),Ki=r.add([],me.center,Li),gi=(typeof W.offset.x=="number"&&typeof W.offset.y=="number"?new r.pointGeometry(W.offset.x,W.offset.y):r.pointGeometry.convert(W.offset)).rotate(-r.degToRad(A));me.center[0]-=gi.x*$e,me.center[1]+=gi.y*$e,r.transformMat4(me.center,me.center,Ae),r.transformMat4(Ki,Ki,Ae);const Kn=[me.center[0],me.center[1],Ki[2]*G.pixelsPerMeter];r.scale$2(Kn,Kn,1/G.worldSize);const Hr=r.lngFromMercatorX(Kn[0]),Dr=r.latFromMercatorY(Kn[1]),to=Math.min(G._zoomFromMercatorZ(Kn[2]),W.maxZoom),Wr=new r.LngLat(Hr,Dr);return G.mercatorFromTransition&&to<.5*(r.GLOBE_ZOOM_THRESHOLD_MIN+r.GLOBE_ZOOM_THRESHOLD_MAX)?(G.setProjection({name:"globe"}),G.zoom=to,this._cameraForBounds(G,f,y,A,S,B)):{center:Wr,zoom:to,bearing:A,pitch:S}}fitBounds(u,f,y){const A=this.cameraForBounds(u,f);return this._fitInternal(A,f,y)}fitScreenCoordinates(u,f,y,A,S){const B=r.pointGeometry.convert(u),G=r.pointGeometry.convert(f),W=new r.pointGeometry(Math.min(B.x,G.x),Math.min(B.y,G.y)),it=new r.pointGeometry(Math.max(B.x,G.x),Math.max(B.y,G.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(B,G))return this;const et=this.transform.pointLocation3D(W),_t=this.transform.pointLocation3D(it),Mt=this.transform.pointLocation3D(new r.pointGeometry(W.x,it.y)),Bt=this.transform.pointLocation3D(new r.pointGeometry(it.x,W.y)),Ft=[Math.min(et.lng,_t.lng,Mt.lng,Bt.lng),Math.min(et.lat,_t.lat,Mt.lat,Bt.lat)],Gt=[Math.max(et.lng,_t.lng,Mt.lng,Bt.lng),Math.max(et.lat,_t.lat,Mt.lat,Bt.lat)],Pt=A&&A.pitch?A.pitch:this.getPitch(),Ot=this._cameraForBounds(this.transform,Ft,Gt,y,Pt,A);return this._fitInternal(Ot,A,S)}_fitInternal(u,f,y){return u?(delete(f=r.extend(u,f)).padding,f.linear?this.easeTo(f,y):this.flyTo(f,y)):this}jumpTo(u,f){this.stop();const y=u.preloadOnly?this.transform.clone():this.transform;let A=!1,S=!1,B=!1;return"zoom"in u&&y.zoom!==+u.zoom&&(A=!0,y.zoom=+u.zoom),u.center!==void 0&&(y.center=r.LngLat.convert(u.center)),"bearing"in u&&y.bearing!==+u.bearing&&(S=!0,y.bearing=+u.bearing),"pitch"in u&&y.pitch!==+u.pitch&&(B=!0,y.pitch=+u.pitch),u.padding==null||y.isPaddingEqual(u.padding)||(y.padding=u.padding),u.preloadOnly?(this._preloadTiles(y),this):(this.fire(new r.Event("movestart",f)).fire(new r.Event("move",f)),A&&this.fire(new r.Event("zoomstart",f)).fire(new r.Event("zoom",f)).fire(new r.Event("zoomend",f)),S&&this.fire(new r.Event("rotatestart",f)).fire(new r.Event("rotate",f)).fire(new r.Event("rotateend",f)),B&&this.fire(new r.Event("pitchstart",f)).fire(new r.Event("pitch",f)).fire(new r.Event("pitchend",f)),this.fire(new r.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.warnOnce(Ed),this.transform.getFreeCameraOptions()}setFreeCameraOptions(u,f){const y=this.transform;if(!y.projection.supportsFreeCamera)return r.warnOnce(Ed),this;this.stop();const A=y.zoom,S=y.pitch,B=y.bearing;y.setFreeCameraOptions(u);const G=A!==y.zoom,W=S!==y.pitch,it=B!==y.bearing;return this.fire(new r.Event("movestart",f)).fire(new r.Event("move",f)),G&&this.fire(new r.Event("zoomstart",f)).fire(new r.Event("zoom",f)).fire(new r.Event("zoomend",f)),it&&this.fire(new r.Event("rotatestart",f)).fire(new r.Event("rotate",f)).fire(new r.Event("rotateend",f)),W&&this.fire(new r.Event("pitchstart",f)).fire(new r.Event("pitch",f)).fire(new r.Event("pitchend",f)),this.fire(new r.Event("moveend",f)),this}easeTo(u,f){this._stop(!1,u.easeId),((u=r.extend({offset:[0,0],duration:500,easing:r.ease},u)).animate===!1||!u.essential&&r.exported.prefersReducedMotion)&&(u.duration=0);const y=this.transform,A=this.getZoom(),S=this.getBearing(),B=this.getPitch(),G=this.getPadding(),W="zoom"in u?+u.zoom:A,it="bearing"in u?this._normalizeBearing(u.bearing,S):S,et="pitch"in u?+u.pitch:B,_t="padding"in u?u.padding:y.padding,Mt=r.pointGeometry.convert(u.offset);let Bt,Ft,Gt;if(y.projection.name==="globe"){const je=r.MercatorCoordinate.fromLngLat(y.center),De=Mt.rotate(-y.angle);je.x+=De.x/y.worldSize,je.y+=De.y/y.worldSize;const An=je.toLngLat(),Fe=r.LngLat.convert(u.center||An);this._normalizeCenter(Fe),Bt=y.centerPoint.add(De),Ft=new r.pointGeometry(je.x,je.y).mult(y.worldSize),Gt=new r.pointGeometry(r.mercatorXfromLng(Fe.lng),r.mercatorYfromLat(Fe.lat)).mult(y.worldSize).sub(Ft)}else{Bt=y.centerPoint.add(Mt);const je=y.pointLocation(Bt),De=r.LngLat.convert(u.center||je);this._normalizeCenter(De),Ft=y.project(je),Gt=y.project(De).sub(Ft)}const Pt=y.zoomScale(W-A);let Ot,Wt;u.around&&(Ot=r.LngLat.convert(u.around),Wt=y.locationPoint(Ot));const jt=this._zooming||W!==A,Kt=this._rotating||S!==it,me=this._pitching||et!==B,re=!y.isPaddingEqual(_t),Ae=je=>De=>{if(jt&&(je.zoom=r.number(A,W,De)),Kt&&(je.bearing=r.number(S,it,De)),me&&(je.pitch=r.number(B,et,De)),re&&(je.interpolatePadding(G,_t,De),Bt=je.centerPoint.add(Mt)),Ot)je.setLocationAtPoint(Ot,Wt);else{const An=je.zoomScale(je.zoom-A),Fe=W>A?Math.min(2,Pt):Math.max(.5,Pt),fn=Math.pow(Fe,1-De),Je=je.unproject(Ft.add(Gt.mult(De*fn)).mult(An));je.setLocationAtPoint(je.renderWorldCopies?Je.wrap():Je,Bt)}return u.preloadOnly||this._fireMoveEvents(f),je};if(u.preloadOnly){const je=this._emulate(Ae,u.duration,y);return this._preloadTiles(je),this}const He={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=jt,this._rotating=Kt,this._pitching=me,this._padding=re,this._easeId=u.easeId,this._prepareEase(f,u.noMoveStart,He),this._ease(Ae(y),je=>{y.recenterOnTerrain(),this._afterEase(f,je)},u),this}_prepareEase(u,f,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||y.moving||this.fire(new r.Event("movestart",u)),this._zooming&&!y.zooming&&this.fire(new r.Event("zoomstart",u)),this._rotating&&!y.rotating&&this.fire(new r.Event("rotatestart",u)),this._pitching&&!y.pitching&&this.fire(new r.Event("pitchstart",u))}_fireMoveEvents(u){this.fire(new r.Event("move",u)),this._zooming&&this.fire(new r.Event("zoom",u)),this._rotating&&this.fire(new r.Event("rotate",u)),this._pitching&&this.fire(new r.Event("pitch",u))}_afterEase(u,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,A=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new r.Event("zoomend",u)),A&&this.fire(new r.Event("rotateend",u)),S&&this.fire(new r.Event("pitchend",u)),this.fire(new r.Event("moveend",u))}flyTo(u,f){if(!u.essential&&r.exported.prefersReducedMotion){const Ne=r.pick(u,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ne,f)}this.stop(),u=r.extend({offset:[0,0],speed:1.2,curve:1.42,easing:r.ease},u);const y=this.transform,A=this.getZoom(),S=this.getBearing(),B=this.getPitch(),G=this.getPadding(),W="zoom"in u?r.clamp(+u.zoom,y.minZoom,y.maxZoom):A,it="bearing"in u?this._normalizeBearing(u.bearing,S):S,et="pitch"in u?+u.pitch:B,_t="padding"in u?u.padding:y.padding,Mt=y.zoomScale(W-A),Bt=r.pointGeometry.convert(u.offset);let Ft=y.centerPoint.add(Bt);const Gt=y.pointLocation(Ft),Pt=r.LngLat.convert(u.center||Gt);this._normalizeCenter(Pt);const Ot=y.project(Gt),Wt=y.project(Pt).sub(Ot);let jt=u.curve;const Kt=Math.max(y.width,y.height),me=Kt/Mt,re=Wt.mag();if("minZoom"in u){const Ne=r.clamp(Math.min(u.minZoom,A,W),y.minZoom,y.maxZoom),$e=Kt/y.zoomScale(Ne-A);jt=Math.sqrt($e/re*2)}const Ae=jt*jt;function He(Ne){const $e=(me*me-Kt*Kt+(Ne?-1:1)*Ae*Ae*re*re)/(2*(Ne?me:Kt)*Ae*re);return Math.log(Math.sqrt($e*$e+1)-$e)}function je(Ne){return(Math.exp(Ne)-Math.exp(-Ne))/2}function De(Ne){return(Math.exp(Ne)+Math.exp(-Ne))/2}const An=He(0);let Fe=function(Ne){return De(An)/De(An+jt*Ne)},fn=function(Ne){return Kt*((De(An)*(je($e=An+jt*Ne)/De($e))-je(An))/Ae)/re;var $e},Je=(He(1)-An)/jt;if(Math.abs(re)<1e-6||!isFinite(Je)){if(Math.abs(Kt-me)<1e-6)return this.easeTo(u,f);const Ne=me<Kt?-1:1;Je=Math.abs(Math.log(me/Kt))/jt,fn=function(){return 0},Fe=function($e){return Math.exp(Ne*jt*$e)}}u.duration="duration"in u?+u.duration:1e3*Je/("screenSpeed"in u?+u.screenSpeed/jt:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0);const Ln=S!==it,tn=et!==B,xn=!y.isPaddingEqual(_t),zn=Ne=>$e=>{const ri=$e*Je,fi=1/Fe(ri);Ne.zoom=$e===1?W:A+Ne.scaleZoom(fi),Ln&&(Ne.bearing=r.number(S,it,$e)),tn&&(Ne.pitch=r.number(B,et,$e)),xn&&(Ne.interpolatePadding(G,_t,$e),Ft=Ne.centerPoint.add(Bt));const oi=$e===1?Pt:Ne.unproject(Ot.add(Wt.mult(fn(ri))).mult(fi));return Ne.setLocationAtPoint(Ne.renderWorldCopies?oi.wrap():oi,Ft),Ne._updateCameraOnTerrain(),u.preloadOnly||this._fireMoveEvents(f),Ne};if(u.preloadOnly){const Ne=this._emulate(zn,u.duration,y);return this._preloadTiles(Ne),this}return this._zooming=!0,this._rotating=Ln,this._pitching=tn,this._padding=xn,this._prepareEase(f,!1),this._ease(zn(y),()=>this._afterEase(f),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,f)}if(!u){const y=this.handlers;y&&y.stop(!1)}return this}_ease(u,f,y){y.animate===!1||y.duration===0?(u(1),f()):(this._easeStart=r.exported.now(),this._easeOptions=y,this._onEaseFrame=u,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const u=Math.min((r.exported.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(u)),u<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(u,f){u=r.wrap(u,-180,180);const y=Math.abs(u-f);return Math.abs(u-360-f)<y&&(u-=360),Math.abs(u+360-f)<y&&(u+=360),u}_normalizeCenter(u){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const y=u.lng-f.center.lng;u.lng+=y>180?-360:y<-180?360:0}_emulate(u,f,y){const A=Math.ceil(15*f/1e3),S=[],B=u(y.clone());for(let G=0;G<=A;G++){const W=B(G/A);S.push(W.clone())}return S}}class Md{constructor(u={}){this.options=u,r.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(u){const f=this.options&&this.options.compact;return this._map=u,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Z("button","mapboxgl-ctrl-attrib-button",this._container),Z("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Z("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(u,f){const y=this._map._getUIString(`AttributionControl.${f}`);u.setAttribute("aria-label",y),u.removeAttribute("title"),u.firstElementChild&&u.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.config.ACCESS_TOKEN}];if(u){const y=f.reduce((A,S,B)=>(S.value&&(A+=`${S.key}=${S.value}${B<f.length-1?"&":""}`),A),"?");u.href=`${r.config.FEEDBACK_URL}/${y}#${Oa(this._map,!0)}`,u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}}_updateData(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let u=[];if(this._map.style.stylesheet){const A=this._map.style.stylesheet;this.styleOwner=A.owner,this.styleId=A.id}const f=this._map.style._sourceCaches;for(const A in f){const S=f[A];if(S.used){const B=S.getSource();B.attribution&&u.indexOf(B.attribution)<0&&u.push(B.attribution)}}u.sort((A,S)=>A.length-S.length),u=u.filter((A,S)=>{for(let B=S+1;B<u.length;B++)if(u[B].indexOf(A)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=[...this.options.customAttribution,...u]:u.unshift(this.options.customAttribution));const y=u.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,u.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ld{constructor(){r.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(u){this._map=u,this._container=Z("div","mapboxgl-ctrl");const f=Z("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const u=this._map.style._sourceCaches;if(Object.entries(u).length===0)return!0;for(const f in u){const y=u[f].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class kd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const f=++this._id;return this._queue.push({callback:u,id:f,cancelled:!1}),f}remove(u){const f=this._currentlyRunning,y=f?this._queue.concat(f):this._queue;for(const A of y)if(A.id===u)return void(A.cancelled=!0)}run(u=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const y of f)if(!y.cancelled&&(y.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Pd(_,u,f){if(_=new r.LngLat(_.lng,_.lat),u){const y=new r.LngLat(_.lng-360,_.lat),A=new r.LngLat(_.lng+360,_.lat),S=360*Math.ceil(Math.abs(_.lng-f.center.lng)/360),B=f.locationPoint(_).distSqr(u),G=u.x<0||u.y<0||u.x>f.width||u.y>f.height;f.locationPoint(y).distSqr(u)<B&&(G||Math.abs(y.lng-f.center.lng)<S)?_=y:f.locationPoint(A).distSqr(u)<B&&(G||Math.abs(A.lng-f.center.lng)<S)&&(_=A)}for(;Math.abs(_.lng-f.center.lng)>180;){const y=f.locationPoint(_);if(y.x>=0&&y.y>=0&&y.x<=f.width&&y.y<=f.height)break;_.lng>f.center.lng?_.lng-=360:_.lng+=360}return _}const ph={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class iu extends r.Evented{constructor(u,f){if(super(),(u instanceof r.window.HTMLElement||f)&&(u=r.extend({element:u},f)),r.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=u&&u.occludedOpacity||.2,u&&u.element)this._element=u.element,this._offset=r.pointGeometry.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=Z("div");const A=41,S=27,B=Y("svg",{display:"block",height:A*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${A}`},this._element),G=Y("radialGradient",{id:"shadowGradient"},Y("defs",{},B));Y("stop",{offset:"10%","stop-opacity":.4},G),Y("stop",{offset:"100%","stop-opacity":.05},G),Y("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},B),Y("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},B),Y("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},B),Y("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},B),this._offset=r.pointGeometry.convert(u&&u.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",A=>{A.preventDefault()}),this._element.addEventListener("mousedown",A=>{A.preventDefault()});const y=this._element.classList;for(const A in ph)y.remove(`mapboxgl-marker-anchor-${A}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(u){return u===this._map||(this.remove(),this._map=u,u.getCanvasContainer().appendChild(this._element),u.on("move",this._updateMoving),u.on("moveend",this._update),u.on("remove",this._clearFadeTimer),u._addMarker(this),this.setDraggable(this._draggable),this._update(),u.on("click",this._onMapClick)),this}remove(){const u=this._map;return u&&(u.off("click",this._onMapClick),u.off("move",this._updateMoving),u.off("moveend",this._update),u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler),u.off("mouseup",this._onUp),u.off("touchend",this._onUp),u.off("mousemove",this._onMove),u.off("touchmove",this._onMove),u.off("remove",this._clearFadeTimer),u._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=r.LngLat.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const A=Math.sqrt(Math.pow(13.5,2)/2);u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[A,-1*(38.1-13.5+A)],"bottom-right":[-A,-1*(38.1-13.5+A)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=u,u._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(u){const f=u.code,y=u.charCode||u.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(u){const f=u.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const u=this._popup;return u?(u.isOpen()?(u.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(u.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const u=this._map,f=this._pos;if(!u||!f)return!1;const y=u.unproject(f),A=u.getFreeCameraOptions();if(!A.position)return!1;const S=A.position.toLngLat();return S.distanceTo(y)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const u=this._map;if(!u)return;const f=this._pos;if(!f||f.x<0||f.x>u.transform.width||f.y<0||f.y>u.transform.height)return void this._clearFadeTimer();const y=u.unproject(f);let A;u._showingGlobe()&&r.isLngLatBehindGlobe(u.transform,this._lngLat)?A=0:(A=1-u._queryFogOpacity(y),u.transform._terrainEnabled()&&u.getTerrain()&&this._behindTerrain()&&(A*=this._occludedOpacity)),this._element.style.opacity=`${A}`,this._element.style.pointerEvents=A>0?"auto":"none",this._popup&&this._popup._setOpacity(A),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const u=this._pos;if(!u||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${u.x}px,${u.y}px)
            ${ph[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${f.x}px,${f.y}px)
        `}_calculateXYTransform(){const u=this._pos,f=this._map,y=this.getPitchAlignment();if(!f||!u||y!=="map")return"";if(!f._showingGlobe()){const W=f.getPitch();return W?`rotateX(${W}deg)`:""}const A=r.radToDeg(r.globeTiltAtLngLat(f.transform,this._lngLat)),S=u.sub(r.globeCenterToScreenPoint(f.transform)),B=Math.abs(S.x)+Math.abs(S.y);if(B===0)return"";const G=A/B;return`rotateX(${-S.y*G}deg) rotateY(${S.x*G}deg)`}_calculateZTransform(){const u=this._pos,f=this._map;if(!f||!u)return"";let y=0;const A=this.getRotationAlignment();if(A==="map")if(f._showingGlobe()){const S=f.project(new r.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),B=f.project(new r.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(S);y=r.radToDeg(Math.atan2(B.y,B.x))-90}else y=-f.getBearing();else if(A==="horizon"){const S=r.smoothstep(4,6,f.getZoom()),B=r.globeCenterToScreenPoint(f.transform);B.y+=S*f.transform.height;const G=u.sub(B),W=r.radToDeg(Math.atan2(G.y,G.x));y=(W>90?W-270:W+90)*(1-S)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(u){r.window.cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=Pd(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),u===!0?this._updateFrameId=r.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(u){return this._offset=r.pointGeometry.convert(u),this._update(),this}_onMove(u){const f=this._map;if(!f)return;const y=this._pointerdownPos,A=this._positionDelta;if(y&&A){if(!this._isDragging){const S=this._clickTolerance||f._clickTolerance;if(u.point.dist(y)<S)return;this._isDragging=!0}this._pos=u.point.sub(A),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.Event("dragstart"))),this.fire(new r.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const u=this._map;u&&(u.off("mousemove",this._onMove),u.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.Event("dragend")),this._state="inactive"}_addDragHandler(u){const f=this._map,y=this._pos;f&&y&&this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(y),this._pointerdownPos=u.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(u){this._draggable=!!u;const f=this._map;return f&&(u?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(u){return this._occludedOpacity=u||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Sf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Wp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function vl(_=new r.pointGeometry(0,0),u="bottom"){if(typeof _=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(u){case"top":return new r.pointGeometry(0,_);case"top-left":return new r.pointGeometry(f,f);case"top-right":return new r.pointGeometry(-f,f);case"bottom":return new r.pointGeometry(0,-_);case"bottom-left":return new r.pointGeometry(f,-f);case"bottom-right":return new r.pointGeometry(-f,-f);case"left":return new r.pointGeometry(_,0);case"right":return new r.pointGeometry(-_,0)}return new r.pointGeometry(0,0)}return _ instanceof r.pointGeometry||Array.isArray(_)?r.pointGeometry.convert(_):r.pointGeometry.convert(_[u]||[0,0])}class Yp{constructor(u){this.jumpTo(u)}getValue(u){if(u<=this._startTime)return this._start;if(u>=this._endTime)return this._end;const f=r.easeCubicInOut((u-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(u){return u>=this._startTime&&u<=this._endTime}jumpTo(u){this._startTime=-1/0,this._endTime=-1/0,this._start=u,this._end=u}easeTo(u,f,y){this._start=this.getValue(f),this._end=u,this._startTime=f,this._endTime=f+y}}const Xp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Hp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},$p={showCompass:!0,showZoom:!0,visualizePitch:!1};class qp{constructor(u,f,y=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new Bh({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,y&&(this.mousePitch=new Fh({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),r.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(u,f){this.mouseRotate.mousedown(u,f),this.mousePitch&&this.mousePitch.mousedown(u,f),J()}move(u,f){const y=this.map,A=this.mouseRotate.mousemoveWindow(u,f),S=A&&A.bearingDelta;if(S&&y.setBearing(y.getBearing()+S),this.mousePitch){const B=this.mousePitch.mousemoveWindow(u,f),G=B&&B.pitchDelta;G&&y.setPitch(y.getPitch()+G)}}off(){const u=this.element;u.removeEventListener("mousedown",this.mousedown),u.removeEventListener("touchstart",this.touchstart,{passive:!1}),u.removeEventListener("touchmove",this.touchmove),u.removeEventListener("touchend",this.touchend),u.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Q(),r.window.removeEventListener("mousemove",this.mousemove),r.window.removeEventListener("mouseup",this.mouseup)}mousedown(u){this.down(r.extend({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),j(this.element,u)),r.window.addEventListener("mousemove",this.mousemove),r.window.addEventListener("mouseup",this.mouseup)}mousemove(u){this.move(u,j(this.element,u))}mouseup(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()}touchstart(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>u.preventDefault()},this._startPos))}touchmove(u){u.targetTouches.length!==1?this.reset():(this._lastPos=k(this.element,u.targetTouches)[0],this.move({preventDefault:()=>u.preventDefault()},this._lastPos))}touchend(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ef={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},zd={maxWidth:100,unit:"metric"};function Jp(_,u,f){const y=Dd(u),A=y/u,S={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[f];this._map._requestDomTask(()=>{this._container.style.width=_*A+"px",this._container.innerHTML=`${y}&nbsp;${S}`})}function Dd(_){const u=Math.pow(10,`${Math.floor(_)}`.length-1);let f=_/u;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:f>=1?1:function(y){const A=Math.pow(10,Math.ceil(-Math.log(y)/Math.LN10));return Math.round(y*A)/A}(f),u*f}const Gc={version:r.version,supported:M,setRTLTextPlugin:r.setRTLTextPlugin,getRTLTextPluginStatus:r.getRTLTextPluginStatus,Map:class extends Cu{constructor(_){if(r.LivePerformanceUtils.mark(r.PerformanceMarkers.create),(_=r.extend({},Hp,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&r.isSafariWithAntialiasingBug(r.window)&&(_.antialias=!1,r.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Pl(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new kd,this._domRenderTaskQueue=new kd,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.uniqueId(),this._locale=r.extend({},Xp,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Yp(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new r.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,typeof _.container=="string"){if(this._container=r.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof r.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&r.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),r.window!==void 0&&(r.window.addEventListener("online",this._onWindowOnline,!1),r.window.addEventListener("resize",this._onWindowResize,!1),r.window.addEventListener("orientationchange",this._onWindowResize,!1),r.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Gh(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this._hash=_.hash&&new $n(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,r.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),_.attributionControl&&this.addControl(new Md({customAttribution:_.customAttribution})),this._logoControl=new Ld,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new r.Event(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new r.Event(`${u.dataType}dataloading`,u))})}_getMapId(){return this._mapId}addControl(_,u){if(u===void 0&&(u=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=_.onAdd(this);this._controls.push(_);const y=this._controlPositions[u];return u.indexOf("bottom")!==-1?y.insertBefore(f,y.firstChild):y.appendChild(f),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(_);return u>-1&&this._controls.splice(u,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const u=!this._moving;return u&&this.fire(new r.Event("movestart",_)).fire(new r.Event("move",_)),this.fire(new r.Event("resize",_)),u&&this.fire(new r.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(r.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return _==="auto"?r.window.navigator.language:Array.isArray(_)?_.length===0?void 0:_.map(u=>u==="auto"?r.window.navigator.language:u):_}setLanguage(_){const u=this._parseLanguage(_);if(!this.style||u===this._language)return this;this._language=u,this.style._reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(_){return this._lazyInitEmptyStyle(),_?typeof _=="string"&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const _=this.transform,u=_.projection.name;let f;u==="globe"&&_.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX?(_.setMercatorFromTransition(),f=!0):u==="mercator"&&_.zoom<r.GLOBE_ZOOM_THRESHOLD_MAX&&(_.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,u){return this._updateProjection(_||u||{name:"mercator"})}_updateProjection(_){let u;if(u=_.name==="globe"&&this.transform.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),u){this.painter.clearBackgroundTiles();for(const f in this.style._sourceCaches)this.style._sourceCaches[f].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(_){return this.transform.locationPoint3D(r.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(r.pointGeometry.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,u,f){if(_==="mouseenter"||_==="mouseover"){let y=!1;const A=B=>{const G=u.filter(it=>this.getLayer(it)),W=G.length?this.queryRenderedFeatures(B.point,{layers:G}):[];W.length?y||(y=!0,f.call(this,new ne(_,this,B.originalEvent,{features:W}))):y=!1},S=()=>{y=!1};return{layers:new Set(u),listener:f,delegates:{mousemove:A,mouseout:S}}}if(_==="mouseleave"||_==="mouseout"){let y=!1;const A=B=>{const G=u.filter(W=>this.getLayer(W));(G.length?this.queryRenderedFeatures(B.point,{layers:G}):[]).length?y=!0:y&&(y=!1,f.call(this,new ne(_,this,B.originalEvent)))},S=B=>{y&&(y=!1,f.call(this,new ne(_,this,B.originalEvent)))};return{layers:new Set(u),listener:f,delegates:{mousemove:A,mouseout:S}}}{const y=A=>{const S=u.filter(G=>this.getLayer(G)),B=S.length?this.queryRenderedFeatures(A.point,{layers:S}):[];B.length&&(A.features=B,f.call(this,A),delete A.features)};return{layers:new Set(u),listener:f,delegates:{[_]:y}}}}on(_,u,f){if(f===void 0)return super.on(_,u);Array.isArray(u)||(u=[u]);const y=this._createDelegatedListener(_,u,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(y);for(const A in y.delegates)this.on(A,y.delegates[A]);return this}once(_,u,f){if(f===void 0)return super.once(_,u);Array.isArray(u)||(u=[u]);const y=this._createDelegatedListener(_,u,f);for(const A in y.delegates)this.once(A,y.delegates[A]);return this}off(_,u,f){if(f===void 0)return super.off(_,u);u=new Set(Array.isArray(u)?u:[u]);const y=(S,B)=>{if(S.size!==B.size)return!1;for(const G of S)if(!B.has(G))return!1;return!0},A=this._delegatedListeners?this._delegatedListeners[_]:void 0;return A&&(S=>{for(let B=0;B<S.length;B++){const G=S[B];if(G.listener===f&&y(G.layers,u)){for(const W in G.delegates)this.off(W,G.delegates[W]);return S.splice(B,1),this}}})(A),this}queryRenderedFeatures(_,u){return this.style?(u!==void 0||_===void 0||_ instanceof r.pointGeometry||Array.isArray(_)||(u=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],u=u||{},this.transform)):[]}querySourceFeatures(_,u){return this.style.querySourceFeatures(_,u)}setStyle(_,u){return(u=r.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},u)).diff!==!1&&u.localIdeographFontFamily===this._localIdeographFontFamily&&u.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._localFontFamily=u.localFontFamily,this._updateStyle(_,u))}_getUIString(_){const u=this._locale[_];if(u==null)throw new Error(`Missing UI string '${_}'`);return u}_updateStyle(_,u){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new C(this,u||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new C(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,u){if(typeof _=="string"){const f=this._requestManager.normalizeStyleURL(_),y=this._requestManager.transformRequest(f,r.ResourceType.Style);r.getJSON(y,(A,S)=>{A?this.fire(new r.ErrorEvent(A)):S&&this._updateDiff(S,u)})}else typeof _=="object"&&this._updateDiff(_,u)}_updateDiff(_,u){try{this.style.setState(_)&&this._update(!0)}catch(f){r.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(_,u)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.warnOnce("There is no style added to the map."),!1)}addSource(_,u){return this._lazyInitEmptyStyle(),this.style.addSource(_,u),this._update(!0)}isSourceLoaded(_){return!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const u in _){const f=_[u]._tiles;for(const y in f){const A=f[y];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}addSourceType(_,u,f){this._lazyInitEmptyStyle(),this.style.addSourceType(_,u,f)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,u,{pixelRatio:f=1,sdf:y=!1,stretchX:A,stretchY:S,content:B}={}){if(this._lazyInitEmptyStyle(),u instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&u instanceof r.window.ImageBitmap){const{width:G,height:W,data:it}=r.exported.getImageData(u);this.style.addImage(_,{data:new r.RGBAImage({width:G,height:W},it),pixelRatio:f,stretchX:A,stretchY:S,content:B,sdf:y,version:0})}else if(u.width===void 0||u.height===void 0)this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:G,height:W}=u,it=u;this.style.addImage(_,{data:new r.RGBAImage({width:G,height:W},new Uint8Array(it.data)),pixelRatio:f,stretchX:A,stretchY:S,content:B,sdf:y,version:0,userImage:it}),it.onAdd&&it.onAdd(this,_)}}updateImage(_,u){const f=this.style.getImage(_);if(!f)return void this.fire(new r.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=u instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&u instanceof r.window.ImageBitmap?r.exported.getImageData(u):u,{width:A,height:S}=y;A!==void 0&&S!==void 0?A===f.data.width&&S===f.data.height?(f.data.replace(y.data,!(u instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&u instanceof r.window.ImageBitmap)),this.style.updateImage(_,f)):this.fire(new r.ErrorEvent(new Error(`The width and height of the updated image (${A}, ${S})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`))):this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new r.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,u){r.getImage(this._requestManager.transformRequest(_,r.ResourceType.Image),(f,y)=>{u(f,y instanceof r.window.HTMLImageElement?r.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(_,u){return this._lazyInitEmptyStyle(),this.style.addLayer(_,u),this._update(!0)}moveLayer(_,u){return this.style.moveLayer(_,u),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,u,f){return this.style.setLayerZoomRange(_,u,f),this._update(!0)}setFilter(_,u,f={}){return this.style.setFilter(_,u,f),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,u,f,y={}){return this.style.setPaintProperty(_,u,f,y),this._update(!0)}getPaintProperty(_,u){return this.style.getPaintProperty(_,u)}setLayoutProperty(_,u,f,y={}){return this.style.setLayoutProperty(_,u,f,y),this._update(!0)}getLayoutProperty(_,u){return this.style.getLayoutProperty(_,u)}setLight(_,u={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,u),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.LngLat.convert(_),this.transform):0}setFeatureState(_,u){return this.style.setFeatureState(_,u),this._update()}removeFeatureState(_,u){return this.style.removeFeatureState(_,u),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,u=this._container.getBoundingClientRect().height||300;let f,y,A,S=this._container;for(;S&&(!y||!A);){const B=r.window.getComputedStyle(S).transform;B&&B!=="none"&&(f=B.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(y=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(A=f[3])),S=S.parentElement}this._containerWidth=y?Math.abs(_/y):_,this._containerHeight=A?Math.abs(u/A):u}_detectMissingCSS(){r.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=Z("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const u=this._canvasContainer=Z("div","mapboxgl-canvas-container",_);this._interactive&&u.classList.add("mapboxgl-interactive"),this._canvas=Z("canvas","mapboxgl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=Z("div","mapboxgl-control-container",_),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(A=>{y[A]=Z("div",`mapboxgl-ctrl-${A}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,u){const f=r.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(_),this._canvas.height=f*Math.ceil(u),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${u}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const u=this._markers.indexOf(_);u!==-1&&this._markers.splice(u,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const u=this._popups.indexOf(_);u!==-1&&this._popups.splice(u,1)}_setupPainter(){const _=r.extend({},M.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);u?(r.storeAuthState(u,!0),this.painter=new mi(u,this.transform),this.on("data",f=>{f.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.exported$1.testSupport(u)):this.fire(new r.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new r.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let u;const f=this.painter.context.extTimerQuery,y=r.exported.now();if(this.listens("gpu-timing-frame")&&(u=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,u)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],r.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],r.window.performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const A=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const G=this.transform.zoom,W=this.transform.pitch,it=r.exported.now(),et=new r.EvaluationParameters(G,{now:it,fadeDuration:A,pitch:W,transition:this.style.getTransition()});this.style.update(et)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new r.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),u){const G=r.exported.now()-y;f.endQueryEXT(f.TIME_ELAPSED_EXT,u),setTimeout(()=>{const W=f.getQueryObjectEXT(u,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(u),this.fire(new r.Event("gpu-timing-frame",{cpuTime:G,gpuTime:W})),r.window.performance.mark("frame-gpu",{startTime:y,detail:{gpuTime:W}})},50)}if(this.listens("gpu-timing-layer")){const G=this.painter.collectGpuTimers();setTimeout(()=>{const W=this.painter.queryGpuTimers(G);this.fire(new r.Event("gpu-timing-layer",{layerTimes:W}))},50)}if(this.listens("gpu-timing-deferred-render")){const G=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const W=this.painter.queryGpuTimeDeferredRender(G);this.fire(new r.Event("gpu-timing-deferred-render",{gpuTime:W}))},50)}const B=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(B||this._repaint)this.triggerRepaint();else{const G=!this.isMoving()&&this.loaded();if(G&&(S=this._updateAverageElevation(y,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),G&&(this.fire(new r.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const W=this._calculateSpeedIndex();this.fire(new r.Event("speedindexcompleted",{speedIndex:W})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,r.LivePerformanceUtils.mark(r.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&r.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const u of this._markers)_&&!this.getRenderWorldCopies()&&(u._lngLat=u._lngLat.wrap()),u._update();for(const u of this._popups)!_||this.getRenderWorldCopies()||u._trackPointer||(u._lngLat=u._lngLat.wrap()),u._update()}_updateAverageElevation(_,u=!1){const f=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);if((u||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const y=this.transform.averageElevation;let A=this.transform.sampleAverageElevation(),S=!1;this.transform.elevation&&(S=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(A)?A=0:this._averageElevationLastSampledAt=_;const B=Math.abs(y-A);if(B>1){if(this._isInitialLoad||S)return this._averageElevation.jumpTo(A),f(A);this._averageElevation.easeTo(A,_,300)}else if(B>1e-4)return this._averageElevation.jumpTo(A),f(A)}return!!this._averageElevation.isEasing(_)&&f(this._averageElevation.getValue(_))}_authenticate(){r.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===r.AUTH_ERR_MSG||_.status===401)){const u=this.painter.context.gl;r.storeAuthState(u,!1),this._logoControl instanceof Ld&&this._logoControl._updateLogo(),u&&u.clear(u.DEPTH_BUFFER_BIT|u.COLOR_BUFFER_BIT|u.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),r.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),u=this.painter.getCanvasCopiesAndTimestamps();u.timeStamps.push(performance.now());const f=this.painter.context.gl,y=f.createFramebuffer();function A(S){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,S,0);const B=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,B),B}return f.bindFramebuffer(f.FRAMEBUFFER,y),this._canvasPixelComparison(A(_),u.canvasCopies.map(A),u.timeStamps)}_canvasPixelComparison(_,u,f){let y=f[1]-f[0];const A=_.length/4;for(let S=0;S<u.length;S++){const B=u[S];let G=0;for(let W=0;W<B.length;W+=4)B[W]===_[W]&&B[W+1]===_[W+1]&&B[W+2]===_[W+2]&&B[W+3]===_[W+3]&&(G+=1);y+=(f[S+2]-f[S+1])*(1-G/A)}return y}remove(){this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),r.window!==void 0&&(r.window.removeEventListener("resize",this._onWindowResize,!1),r.window.removeEventListener("orientationchange",this._onWindowResize,!1),r.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.removeEventListener("online",this._onWindowOnline,!1),r.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),r.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new r.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=r.exported.frame(u=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(u)}))}_preloadTiles(_){const u=this.style?Object.values(this.style._sourceCaches):[];return r.asyncAll(u,(f,y)=>f._preloadTiles(_,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){r.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,u){r.setCacheLimits(_,u)}get version(){return r.version}},NavigationControl:class{constructor(_){this.options=r.extend({},$p,_),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",u=>u.preventDefault()),this.options.showZoom&&(r.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",u=>{this._map&&this._map.zoomIn({},{originalEvent:u})}),Z("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",u=>{this._map&&this._map.zoomOut({},{originalEvent:u})}),Z("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",u=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:u}):f.resetNorth({},{originalEvent:u}))}),this._compassIcon=Z("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const u=_.getZoom(),f=u===_.getMaxZoom(),y=u===_.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const u=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=u)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qp(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,u){const f=Z("button",_,this._container);return f.type="button",f.addEventListener("click",u),f}_setButtonTitle(_,u){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${u}`);_.setAttribute("aria-label",f),_.firstElementChild&&_.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends r.Evented{constructor(_){super(),this.options=r.extend({geolocation:r.window.navigator.geolocation},Ef,_),r.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=_c(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const u=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,_(f)};this._supportsGeolocation!==void 0?_(this._supportsGeolocation):r.window.navigator.permissions!==void 0?r.window.navigator.permissions.query({name:"geolocation"}).then(f=>u(f.state!=="denied")).catch(()=>u()):u()}_isOutOfMapMaxBounds(_){const u=this._map.getMaxBounds(),f=_.coords;return!!u&&(f.longitude<u.getWest()||f.longitude>u.getEast()||f.latitude<u.getSouth()||f.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new r.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("geolocate",_)),this._finish()}}_updateCamera(_){const u=new r.LngLat(_.coords.longitude,_.coords.latitude),f=_.coords.accuracy,y=this._map.getBearing(),A=r.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(f),A,{geolocateSource:!0})}_updateMarker(_){if(_){const u=new r.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,u=r.mercatorZfromAltitude(1,_._center.lat)*_.worldSize,f=Math.ceil(2*this._accuracy*u);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=Z("button","mapboxgl-ctrl-geolocate",this._container),Z("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",_===!1){r.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z("div","mapboxgl-user-location"),this._dotElement.appendChild(Z("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Z("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new iu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Z("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new iu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.Event("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{r.window.addEventListener("ondeviceorientationabsolute"in r.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};r.window.DeviceMotionEvent!==void 0&&typeof r.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(u=>{u==="granted"&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),r.window.removeEventListener("deviceorientation",this._onDeviceOrientation),r.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Md,ScaleControl:class{constructor(_){this.options=r.extend({},zd,_),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Jp.bind(this)),r.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,u=this._map,f=u._containerHeight/2,y=u._containerWidth/2-_/2,A=u.unproject([y,f]),S=u.unproject([y+_,f]),B=A.distanceTo(S);if(this.options.unit==="imperial"){const G=3.2808*B;G>5280?this._setScale(_,G/5280,"mile"):this._setScale(_,G,"foot")}else this.options.unit==="nautical"?this._setScale(_,B/1852,"nautical-mile"):B>=1e3?this._setScale(_,B/1e3,"kilometer"):this._setScale(_,B,"meter")}_setScale(_,u,f){const y=Dd(u),A=y/u;this._map._requestDomTask(()=>{this._container.style.width=_*A+"px",this._container.innerHTML=f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:f}).format(y):`${y}&nbsp;nm`})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof r.window.HTMLElement?this._container=_.container:r.warnOnce("Full screen control 'container' must be a DOM element.")),r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in r.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,r.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!r.window.document.fullscreenEnabled&&!r.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=Z("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Z("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(r.window.document.fullscreenElement||r.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?r.window.document.exitFullscreen?r.window.document.exitFullscreen():r.window.document.webkitCancelFullScreen&&r.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.Evented{constructor(_){super(),this.options=r.extend(Object.create(Sf),_),r.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new r.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new r.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=r.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update();const u=this._map;return u&&(u.on("move",this._update),u.off("mousemove",this._onMouseEvent),u._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(r.window.document.createTextNode(_))}setHTML(_){const u=r.window.document.createDocumentFragment(),f=r.window.document.createElement("body");let y;for(f.innerHTML=_;y=f.firstChild,y;)u.appendChild(y);return this.setDOMContent(u)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let u=this._content;if(u)for(;u.hasChildNodes();)u.firstChild&&u.removeChild(u.firstChild);else u=this._content=Z("div","mapboxgl-popup-content",this._container||void 0);if(u.appendChild(_),this.options.closeButton){const f=this._closeButton=Z("button","mapboxgl-popup-close-button",u);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let u;return this._classList.delete(_)?u=!1:(this._classList.add(_),u=!0),this._updateClassList(),u}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const u=this._map,f=this._container,y=this._pos;if(!u||!f||!y)return"bottom";const A=f.offsetWidth,S=f.offsetHeight,B=y.x<A/2,G=y.x>u.transform.width-A/2;if(y.y+_<S)return B?"top-left":G?"top-right":"top";if(y.y>u.transform.height-S){if(B)return"bottom-left";if(G)return"bottom-right"}return B?"left":G?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const u=[...this._classList];u.push("mapboxgl-popup"),this._anchor&&u.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&u.push("mapboxgl-popup-track-pointer"),_.className=u.join(" ")}_update(_){const u=this._map,f=this._content;if(!u||!this._lngLat&&!this._trackPointer||!f)return;let y=this._container;if(y||(y=this._container=Z("div","mapboxgl-popup",u.getContainer()),this._tip=Z("div","mapboxgl-popup-tip",y),y.appendChild(f)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),u.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Pd(this._lngLat,this._pos,u.transform)),!this._trackPointer||_){const A=this._pos=this._trackPointer&&_?_:u.project(this._lngLat),S=vl(this.options.offset),B=this._anchor=this._getAnchor(S.y),G=vl(this.options.offset,B),W=A.add(G).round();u._requestDomTask(()=>{this._container&&B&&(this._container.style.transform=`${ph[B]} translate(${W.x}px,${W.y}px)`)})}if(!this._marker&&u._showingGlobe()){const A=r.isLngLatBehindGlobe(u.transform,this._lngLat)?0:1;this._setOpacity(A)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Wp);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:iu,Style:C,LngLat:r.LngLat,LngLatBounds:r.LngLatBounds,Point:r.pointGeometry,MercatorCoordinate:r.MercatorCoordinate,FreeCameraOptions:fo,Evented:r.Evented,config:r.config,prewarm:function(){pi().acquire(ci)},clearPrewarmedResources:function(){const _=Qn;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(ci),Qn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return r.config.ACCESS_TOKEN},set accessToken(_){r.config.ACCESS_TOKEN=_},get baseApiUrl(){return r.config.API_URL},set baseApiUrl(_){r.config.API_URL=_},get workerCount(){return hi.workerCount},set workerCount(_){hi.workerCount=_},get maxParallelImageRequests(){return r.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){r.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){r.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:r.exported.setNow,restoreNow:r.exported.restoreNow};return Gc});var p=l;return p})})(Iz);class Cz extends Jn.Component{constructor(){super(...arguments),this.mapContainer=null,this.map=null}componentDidMount(){q1.accessToken="pk.eyJ1IjoiZWRnYXJiYXJyb3NvIiwiYSI6ImNsZGthYm1haDA0cWQzdmxjdnNwcnJoeGoifQ.VWGQI2nHd22h3A54eYWXOQ",this.map=new q1.Map({container:this.mapContainer,style:this.props.theme.mapTheme,center:[-87.62712,41.89033],zoom:16.5,boxZoom:!1,scrollZoom:!1,doubleClickZoom:!1,pitch:45}),this.map.on("load",()=>{this.rotateCamera(0);const e=this.map.getStyle().layers;for(const n of e)n.type==="symbol"&&n.layout["text-field"]&&this.map.removeLayer(n.id);this.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":`${this.props.theme.secondary}`,"fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.7}})})}rotateCamera(e){this.map.rotateTo(e/400%360,{duration:0}),requestAnimationFrame(this.rotateCamera.bind(this))}componentWillUnmount(){this.map.remove()}render(){return In("div",{style:{height:"100vh",width:"100vw",cursor:"initial"},ref:e=>this.mapContainer=e})}}var qv={},Az={get exports(){return qv},set exports(t){qv=t}},Uo={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ul=typeof Symbol=="function"&&Symbol.for,$2=ul?Symbol.for("react.element"):60103,q2=ul?Symbol.for("react.portal"):60106,Mx=ul?Symbol.for("react.fragment"):60107,Lx=ul?Symbol.for("react.strict_mode"):60108,kx=ul?Symbol.for("react.profiler"):60114,Px=ul?Symbol.for("react.provider"):60109,zx=ul?Symbol.for("react.context"):60110,J2=ul?Symbol.for("react.async_mode"):60111,Dx=ul?Symbol.for("react.concurrent_mode"):60111,Nx=ul?Symbol.for("react.forward_ref"):60112,Ox=ul?Symbol.for("react.suspense"):60113,Tz=ul?Symbol.for("react.suspense_list"):60120,Rx=ul?Symbol.for("react.memo"):60115,Bx=ul?Symbol.for("react.lazy"):60116,Sz=ul?Symbol.for("react.block"):60121,Ez=ul?Symbol.for("react.fundamental"):60117,Mz=ul?Symbol.for("react.responder"):60118,Lz=ul?Symbol.for("react.scope"):60119;function dc(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case $2:switch(t=t.type,t){case J2:case Dx:case Mx:case kx:case Lx:case Ox:return t;default:switch(t=t&&t.$$typeof,t){case zx:case Nx:case Bx:case Rx:case Px:return t;default:return e}}case q2:return e}}}function cL(t){return dc(t)===Dx}Uo.AsyncMode=J2;Uo.ConcurrentMode=Dx;Uo.ContextConsumer=zx;Uo.ContextProvider=Px;Uo.Element=$2;Uo.ForwardRef=Nx;Uo.Fragment=Mx;Uo.Lazy=Bx;Uo.Memo=Rx;Uo.Portal=q2;Uo.Profiler=kx;Uo.StrictMode=Lx;Uo.Suspense=Ox;Uo.isAsyncMode=function(t){return cL(t)||dc(t)===J2};Uo.isConcurrentMode=cL;Uo.isContextConsumer=function(t){return dc(t)===zx};Uo.isContextProvider=function(t){return dc(t)===Px};Uo.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===$2};Uo.isForwardRef=function(t){return dc(t)===Nx};Uo.isFragment=function(t){return dc(t)===Mx};Uo.isLazy=function(t){return dc(t)===Bx};Uo.isMemo=function(t){return dc(t)===Rx};Uo.isPortal=function(t){return dc(t)===q2};Uo.isProfiler=function(t){return dc(t)===kx};Uo.isStrictMode=function(t){return dc(t)===Lx};Uo.isSuspense=function(t){return dc(t)===Ox};Uo.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Mx||t===Dx||t===kx||t===Lx||t===Ox||t===Tz||typeof t=="object"&&t!==null&&(t.$$typeof===Bx||t.$$typeof===Rx||t.$$typeof===Px||t.$$typeof===zx||t.$$typeof===Nx||t.$$typeof===Ez||t.$$typeof===Mz||t.$$typeof===Lz||t.$$typeof===Sz)};Uo.typeOf=dc;(function(t){t.exports=Uo})(Az);function kz(t){function e(Yt,Ee,ve,ye,fe){for(var mn=0,Ue=0,Cn=0,Bn=0,Pn,cn,Un=0,R=0,st,gt=st=Pn=0,dt=0,wt=0,Zt=0,we=0,We=ve.length,pe=We-1,un,Ye="",Ge="",Gn="",_i="",ui;dt<We;){if(cn=ve.charCodeAt(dt),dt===pe&&Ue+Bn+Cn+mn!==0&&(Ue!==0&&(cn=Ue===47?10:47),Bn=Cn=mn=0,We++,pe++),Ue+Bn+Cn+mn===0){if(dt===pe&&(0<wt&&(Ye=Ye.replace(Z,"")),0<Ye.trim().length)){switch(cn){case 32:case 9:case 59:case 13:case 10:break;default:Ye+=ve.charAt(dt)}cn=59}switch(cn){case 123:for(Ye=Ye.trim(),Pn=Ye.charCodeAt(0),st=1,we=++dt;dt<We;){switch(cn=ve.charCodeAt(dt)){case 123:st++;break;case 125:st--;break;case 47:switch(cn=ve.charCodeAt(dt+1)){case 42:case 47:t:{for(gt=dt+1;gt<pe;++gt)switch(ve.charCodeAt(gt)){case 47:if(cn===42&&ve.charCodeAt(gt-1)===42&&dt+2!==gt){dt=gt+1;break t}break;case 10:if(cn===47){dt=gt+1;break t}}dt=gt}}break;case 91:cn++;case 40:cn++;case 34:case 39:for(;dt++<pe&&ve.charCodeAt(dt)!==cn;);}if(st===0)break;dt++}switch(st=ve.substring(we,dt),Pn===0&&(Pn=(Ye=Ye.replace(E,"").trim()).charCodeAt(0)),Pn){case 64:switch(0<wt&&(Ye=Ye.replace(Z,"")),cn=Ye.charCodeAt(1),cn){case 100:case 109:case 115:case 45:wt=Ee;break;default:wt=ln}if(st=e(Ee,wt,st,cn,fe+1),we=st.length,0<_e&&(wt=n(ln,Ye,Zt),ui=r(3,st,wt,Ee,te,Et,we,cn,fe,ye),Ye=wt.join(""),ui!==void 0&&(we=(st=ui.trim()).length)===0&&(cn=0,st="")),0<we)switch(cn){case 115:Ye=Ye.replace(k,p);case 100:case 109:case 45:st=Ye+"{"+st+"}";break;case 107:Ye=Ye.replace(Q,"$1 $2"),st=Ye+"{"+st+"}",st=ie===1||ie===2&&c("@"+st,3)?"@-webkit-"+st+"@"+st:"@"+st;break;default:st=Ye+st,ye===112&&(st=(Ge+=st,""))}else st="";break;default:st=e(Ee,n(Ee,Ye,Zt),st,ye,fe+1)}Gn+=st,st=Zt=wt=gt=Pn=0,Ye="",cn=ve.charCodeAt(++dt);break;case 125:case 59:if(Ye=(0<wt?Ye.replace(Z,""):Ye).trim(),1<(we=Ye.length))switch(gt===0&&(Pn=Ye.charCodeAt(0),Pn===45||96<Pn&&123>Pn)&&(we=(Ye=Ye.replace(" ",":")).length),0<_e&&(ui=r(1,Ye,Ee,Yt,te,Et,Ge.length,ye,fe,ye))!==void 0&&(we=(Ye=ui.trim()).length)===0&&(Ye="\0\0"),Pn=Ye.charCodeAt(0),cn=Ye.charCodeAt(1),Pn){case 0:break;case 64:if(cn===105||cn===99){_i+=Ye+ve.charAt(dt);break}default:Ye.charCodeAt(we-1)!==58&&(Ge+=l(Ye,Pn,cn,Ye.charCodeAt(2)))}Zt=wt=gt=Pn=0,Ye="",cn=ve.charCodeAt(++dt)}}switch(cn){case 13:case 10:Ue===47?Ue=0:1+Pn===0&&ye!==107&&0<Ye.length&&(wt=1,Ye+="\0"),0<_e*be&&r(0,Ye,Ee,Yt,te,Et,Ge.length,ye,fe,ye),Et=1,te++;break;case 59:case 125:if(Ue+Bn+Cn+mn===0){Et++;break}default:switch(Et++,un=ve.charAt(dt),cn){case 9:case 32:if(Bn+mn+Ue===0)switch(Un){case 44:case 58:case 9:case 32:un="";break;default:cn!==32&&(un=" ")}break;case 0:un="\\0";break;case 12:un="\\f";break;case 11:un="\\v";break;case 38:Bn+Ue+mn===0&&(wt=Zt=1,un="\f"+un);break;case 108:if(Bn+Ue+mn+ht===0&&0<gt)switch(dt-gt){case 2:Un===112&&ve.charCodeAt(dt-3)===58&&(ht=Un);case 8:R===111&&(ht=R)}break;case 58:Bn+Ue+mn===0&&(gt=dt);break;case 44:Ue+Cn+Bn+mn===0&&(wt=1,un+="\r");break;case 34:case 39:Ue===0&&(Bn=Bn===cn?0:Bn===0?cn:Bn);break;case 91:Bn+Ue+Cn===0&&mn++;break;case 93:Bn+Ue+Cn===0&&mn--;break;case 41:Bn+Ue+mn===0&&Cn--;break;case 40:if(Bn+Ue+mn===0){if(Pn===0)switch(2*Un+3*R){case 533:break;default:Pn=1}Cn++}break;case 64:Ue+Cn+Bn+mn+gt+st===0&&(st=1);break;case 42:case 47:if(!(0<Bn+mn+Cn))switch(Ue){case 0:switch(2*cn+3*ve.charCodeAt(dt+1)){case 235:Ue=47;break;case 220:we=dt,Ue=42}break;case 42:cn===47&&Un===42&&we+2!==dt&&(ve.charCodeAt(we+2)===33&&(Ge+=ve.substring(we,dt+1)),un="",Ue=0)}}Ue===0&&(Ye+=un)}R=Un,Un=cn,dt++}if(we=Ge.length,0<we){if(wt=Ee,0<_e&&(ui=r(2,Ge,wt,Yt,te,Et,we,ye,fe,ye),ui!==void 0&&(Ge=ui).length===0))return _i+Ge+Gn;if(Ge=wt.join(",")+"{"+Ge+"}",ie*ht!==0){switch(ie!==2||c(Ge,2)||(ht=0),ht){case 111:Ge=Ge.replace(Ct,":-moz-$1")+Ge;break;case 112:Ge=Ge.replace(lt,"::-webkit-input-$1")+Ge.replace(lt,"::-moz-$1")+Ge.replace(lt,":-ms-input-$1")+Ge}ht=0}}return _i+Ge+Gn}function n(Yt,Ee,ve){var ye=Ee.trim().split(at);Ee=ye;var fe=ye.length,mn=Yt.length;switch(mn){case 0:case 1:var Ue=0;for(Yt=mn===0?"":Yt[0]+" ";Ue<fe;++Ue)Ee[Ue]=o(Yt,Ee[Ue],ve).trim();break;default:var Cn=Ue=0;for(Ee=[];Ue<fe;++Ue)for(var Bn=0;Bn<mn;++Bn)Ee[Cn++]=o(Yt[Bn]+" ",ye[Ue],ve).trim()}return Ee}function o(Yt,Ee,ve){var ye=Ee.charCodeAt(0);switch(33>ye&&(ye=(Ee=Ee.trim()).charCodeAt(0)),ye){case 38:return Ee.replace(J,"$1"+Yt.trim());case 58:return Yt.trim()+Ee.replace(J,"$1"+Yt.trim());default:if(0<1*ve&&0<Ee.indexOf("\f"))return Ee.replace(J,(Yt.charCodeAt(0)===58?"":"$1")+Yt.trim())}return Yt+Ee}function l(Yt,Ee,ve,ye){var fe=Yt+";",mn=2*Ee+3*ve+4*ye;if(mn===944){Yt=fe.indexOf(":",9)+1;var Ue=fe.substring(Yt,fe.length-1).trim();return Ue=fe.substring(0,Yt).trim()+Ue+";",ie===1||ie===2&&c(Ue,1)?"-webkit-"+Ue+Ue:Ue}if(ie===0||ie===2&&!c(fe,1))return fe;switch(mn){case 1015:return fe.charCodeAt(10)===97?"-webkit-"+fe+fe:fe;case 951:return fe.charCodeAt(3)===116?"-webkit-"+fe+fe:fe;case 963:return fe.charCodeAt(5)===110?"-webkit-"+fe+fe:fe;case 1009:if(fe.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+fe+fe;case 978:return"-webkit-"+fe+"-moz-"+fe+fe;case 1019:case 983:return"-webkit-"+fe+"-moz-"+fe+"-ms-"+fe+fe;case 883:if(fe.charCodeAt(8)===45)return"-webkit-"+fe+fe;if(0<fe.indexOf("image-set(",11))return fe.replace(de,"$1-webkit-$2")+fe;break;case 932:if(fe.charCodeAt(4)===45)switch(fe.charCodeAt(5)){case 103:return"-webkit-box-"+fe.replace("-grow","")+"-webkit-"+fe+"-ms-"+fe.replace("grow","positive")+fe;case 115:return"-webkit-"+fe+"-ms-"+fe.replace("shrink","negative")+fe;case 98:return"-webkit-"+fe+"-ms-"+fe.replace("basis","preferred-size")+fe}return"-webkit-"+fe+"-ms-"+fe+fe;case 964:return"-webkit-"+fe+"-ms-flex-"+fe+fe;case 1023:if(fe.charCodeAt(8)!==99)break;return Ue=fe.substring(fe.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+Ue+"-webkit-"+fe+"-ms-flex-pack"+Ue+fe;case 1005:return K.test(fe)?fe.replace(Y,":-webkit-")+fe.replace(Y,":-moz-")+fe:fe;case 1e3:switch(Ue=fe.substring(13).trim(),Ee=Ue.indexOf("-")+1,Ue.charCodeAt(0)+Ue.charCodeAt(Ee)){case 226:Ue=fe.replace(j,"tb");break;case 232:Ue=fe.replace(j,"tb-rl");break;case 220:Ue=fe.replace(j,"lr");break;default:return fe}return"-webkit-"+fe+"-ms-"+Ue+fe;case 1017:if(fe.indexOf("sticky",9)===-1)break;case 975:switch(Ee=(fe=Yt).length-10,Ue=(fe.charCodeAt(Ee)===33?fe.substring(0,Ee):fe).substring(Yt.indexOf(":",7)+1).trim(),mn=Ue.charCodeAt(0)+(Ue.charCodeAt(7)|0)){case 203:if(111>Ue.charCodeAt(8))break;case 115:fe=fe.replace(Ue,"-webkit-"+Ue)+";"+fe;break;case 207:case 102:fe=fe.replace(Ue,"-webkit-"+(102<mn?"inline-":"")+"box")+";"+fe.replace(Ue,"-webkit-"+Ue)+";"+fe.replace(Ue,"-ms-"+Ue+"box")+";"+fe}return fe+";";case 938:if(fe.charCodeAt(5)===45)switch(fe.charCodeAt(6)){case 105:return Ue=fe.replace("-items",""),"-webkit-"+fe+"-webkit-box-"+Ue+"-ms-flex-"+Ue+fe;case 115:return"-webkit-"+fe+"-ms-flex-item-"+fe.replace(yt,"")+fe;default:return"-webkit-"+fe+"-ms-flex-line-pack"+fe.replace("align-content","").replace(yt,"")+fe}break;case 973:case 989:if(fe.charCodeAt(3)!==45||fe.charCodeAt(4)===122)break;case 931:case 953:if(kt.test(Yt)===!0)return(Ue=Yt.substring(Yt.indexOf(":")+1)).charCodeAt(0)===115?l(Yt.replace("stretch","fill-available"),Ee,ve,ye).replace(":fill-available",":stretch"):fe.replace(Ue,"-webkit-"+Ue)+fe.replace(Ue,"-moz-"+Ue.replace("fill-",""))+fe;break;case 962:if(fe="-webkit-"+fe+(fe.charCodeAt(5)===102?"-ms-"+fe:"")+fe,ve+ye===211&&fe.charCodeAt(13)===105&&0<fe.indexOf("transform",10))return fe.substring(0,fe.indexOf(";",27)+1).replace(q,"$1-webkit-$2")+fe}return fe}function c(Yt,Ee){var ve=Yt.indexOf(Ee===1?":":"{"),ye=Yt.substring(0,Ee!==3?ve:10);return ve=Yt.substring(ve+1,Yt.length-1),Me(Ee!==2?ye:ye.replace(xt,"$1"),ve,Ee)}function p(Yt,Ee){var ve=l(Ee,Ee.charCodeAt(0),Ee.charCodeAt(1),Ee.charCodeAt(2));return ve!==Ee+";"?ve.replace(rt," or ($1)").substring(4):"("+Ee+")"}function r(Yt,Ee,ve,ye,fe,mn,Ue,Cn,Bn,Pn){for(var cn=0,Un=Ee,R;cn<_e;++cn)switch(R=Le[cn].call(N,Yt,Un,ve,ye,fe,mn,Ue,Cn,Bn,Pn)){case void 0:case!1:case!0:case null:break;default:Un=R}if(Un!==Ee)return Un}function w(Yt){switch(Yt){case void 0:case null:_e=Le.length=0;break;default:if(typeof Yt=="function")Le[_e++]=Yt;else if(typeof Yt=="object")for(var Ee=0,ve=Yt.length;Ee<ve;++Ee)w(Yt[Ee]);else be=!!Yt|0}return w}function M(Yt){return Yt=Yt.prefix,Yt!==void 0&&(Me=null,Yt?typeof Yt!="function"?ie=1:(ie=2,Me=Yt):ie=0),M}function N(Yt,Ee){var ve=Yt;if(33>ve.charCodeAt(0)&&(ve=ve.trim()),ue=ve,ve=[ue],0<_e){var ye=r(-1,Ee,ve,ve,te,Et,0,0,0,0);ye!==void 0&&typeof ye=="string"&&(Ee=ye)}var fe=e(ln,ve,Ee,0,0);return 0<_e&&(ye=r(-2,fe,ve,ve,te,Et,fe.length,0,0,0),ye!==void 0&&(fe=ye)),ue="",ht=0,Et=te=1,fe}var E=/^\0+/g,Z=/[\0\r\f]/g,Y=/: */g,K=/zoo|gra/,q=/([,: ])(transform)/g,at=/,\r+?/g,J=/([\t\r\n ])*\f?&/g,Q=/@(k\w+)\s*(\S*)\s*/,lt=/::(place)/g,Ct=/:(read-only)/g,j=/[svh]\w+-[tblr]{2}/,k=/\(\s*(.*)\s*\)/g,rt=/([\s\S]*?);/g,yt=/-self|flex-/g,xt=/[^]*?(:[rp][el]a[\w-]+)[^]*/,kt=/stretch|:\s*\w+\-(?:conte|avail)/,de=/([^-])(image-set\()/,Et=1,te=1,ht=0,ie=1,ln=[],Le=[],_e=0,Me=null,be=0,ue="";return N.use=w,N.set=M,t!==void 0&&M(t),N}var Pz={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function zz(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var Dz=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,qT=zz(function(t){return Dz.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),K2=qv,Nz={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Oz={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Rz={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},hL={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Q2={};Q2[K2.ForwardRef]=Rz;Q2[K2.Memo]=hL;function JT(t){return K2.isMemo(t)?hL:Q2[t.$$typeof]||Nz}var Bz=Object.defineProperty,Fz=Object.getOwnPropertyNames,KT=Object.getOwnPropertySymbols,jz=Object.getOwnPropertyDescriptor,Uz=Object.getPrototypeOf,QT=Object.prototype;function fL(t,e,n){if(typeof e!="string"){if(QT){var o=Uz(e);o&&o!==QT&&fL(t,o,n)}var l=Fz(e);KT&&(l=l.concat(KT(e)));for(var c=JT(t),p=JT(e),r=0;r<l.length;++r){var w=l[r];if(!Oz[w]&&!(n&&n[w])&&!(p&&p[w])&&!(c&&c[w])){var M=jz(e,w);try{Bz(t,w,M)}catch{}}}}return t}var Gz=fL;function sh(){return(sh=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}var tS=function(t,e){for(var n=[t[0]],o=0,l=e.length;o<l;o+=1)n.push(e[o],t[o+1]);return n},DC=function(t){return t!==null&&typeof t=="object"&&(t.toString?t.toString():Object.prototype.toString.call(t))==="[object Object]"&&!qv.typeOf(t)},J1=Object.freeze([]),vd=Object.freeze({});function Ig(t){return typeof t=="function"}function eS(t){return t.displayName||t.name||"Component"}function tA(t){return t&&typeof t.styledComponentId=="string"}var Cg=typeof process<"u"&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",eA=typeof window<"u"&&"HTMLElement"in window,Zz=Boolean(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&{}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""?{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY:!1),Vz={};function kp(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];throw new Error("An error occurred. See https://git.io/JUIaE#"+t+" for more information."+(n.length>0?" Args: "+n.join(", "):""))}var Wz=function(){function t(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}var e=t.prototype;return e.indexOfGroup=function(n){for(var o=0,l=0;l<n;l++)o+=this.groupSizes[l];return o},e.insertRules=function(n,o){if(n>=this.groupSizes.length){for(var l=this.groupSizes,c=l.length,p=c;n>=p;)(p<<=1)<0&&kp(16,""+n);this.groupSizes=new Uint32Array(p),this.groupSizes.set(l),this.length=p;for(var r=c;r<p;r++)this.groupSizes[r]=0}for(var w=this.indexOfGroup(n+1),M=0,N=o.length;M<N;M++)this.tag.insertRule(w,o[M])&&(this.groupSizes[n]++,w++)},e.clearGroup=function(n){if(n<this.length){var o=this.groupSizes[n],l=this.indexOfGroup(n),c=l+o;this.groupSizes[n]=0;for(var p=l;p<c;p++)this.tag.deleteRule(l)}},e.getGroup=function(n){var o="";if(n>=this.length||this.groupSizes[n]===0)return o;for(var l=this.groupSizes[n],c=this.indexOfGroup(n),p=c+l,r=c;r<p;r++)o+=this.tag.getRule(r)+`/*!sc*/
`;return o},t}(),b1=new Map,K1=new Map,Ev=1,$0=function(t){if(b1.has(t))return b1.get(t);for(;K1.has(Ev);)Ev++;var e=Ev++;return b1.set(t,e),K1.set(e,t),e},Yz=function(t){return K1.get(t)},Xz=function(t,e){e>=Ev&&(Ev=e+1),b1.set(t,e),K1.set(e,t)},Hz="style["+Cg+'][data-styled-version="5.3.6"]',$z=new RegExp("^"+Cg+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),qz=function(t,e,n){for(var o,l=n.split(","),c=0,p=l.length;c<p;c++)(o=l[c])&&t.registerName(e,o)},Jz=function(t,e){for(var n=(e.textContent||"").split(`/*!sc*/
`),o=[],l=0,c=n.length;l<c;l++){var p=n[l].trim();if(p){var r=p.match($z);if(r){var w=0|parseInt(r[1],10),M=r[2];w!==0&&(Xz(M,w),qz(t,M,r[3]),t.getTag().insertRules(w,o)),o.length=0}else o.push(p)}}},Kz=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},dL=function(t){var e=document.head,n=t||e,o=document.createElement("style"),l=function(r){for(var w=r.childNodes,M=w.length;M>=0;M--){var N=w[M];if(N&&N.nodeType===1&&N.hasAttribute(Cg))return N}}(n),c=l!==void 0?l.nextSibling:null;o.setAttribute(Cg,"active"),o.setAttribute("data-styled-version","5.3.6");var p=Kz();return p&&o.setAttribute("nonce",p),n.insertBefore(o,c),o},Qz=function(){function t(n){var o=this.element=dL(n);o.appendChild(document.createTextNode("")),this.sheet=function(l){if(l.sheet)return l.sheet;for(var c=document.styleSheets,p=0,r=c.length;p<r;p++){var w=c[p];if(w.ownerNode===l)return w}kp(17)}(o),this.length=0}var e=t.prototype;return e.insertRule=function(n,o){try{return this.sheet.insertRule(o,n),this.length++,!0}catch{return!1}},e.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},e.getRule=function(n){var o=this.sheet.cssRules[n];return o!==void 0&&typeof o.cssText=="string"?o.cssText:""},t}(),tD=function(){function t(n){var o=this.element=dL(n);this.nodes=o.childNodes,this.length=0}var e=t.prototype;return e.insertRule=function(n,o){if(n<=this.length&&n>=0){var l=document.createTextNode(o),c=this.nodes[n];return this.element.insertBefore(l,c||null),this.length++,!0}return!1},e.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},e.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},t}(),eD=function(){function t(n){this.rules=[],this.length=0}var e=t.prototype;return e.insertRule=function(n,o){return n<=this.length&&(this.rules.splice(n,0,o),this.length++,!0)},e.deleteRule=function(n){this.rules.splice(n,1),this.length--},e.getRule=function(n){return n<this.length?this.rules[n]:""},t}(),nS=eA,nD={isServer:!eA,useCSSOMInjection:!Zz},Q1=function(){function t(n,o,l){n===void 0&&(n=vd),o===void 0&&(o={}),this.options=sh({},nD,{},n),this.gs=o,this.names=new Map(l),this.server=!!n.isServer,!this.server&&eA&&nS&&(nS=!1,function(c){for(var p=document.querySelectorAll(Hz),r=0,w=p.length;r<w;r++){var M=p[r];M&&M.getAttribute(Cg)!=="active"&&(Jz(c,M),M.parentNode&&M.parentNode.removeChild(M))}}(this))}t.registerId=function(n){return $0(n)};var e=t.prototype;return e.reconstructWithOptions=function(n,o){return o===void 0&&(o=!0),new t(sh({},this.options,{},n),this.gs,o&&this.names||void 0)},e.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},e.getTag=function(){return this.tag||(this.tag=(l=(o=this.options).isServer,c=o.useCSSOMInjection,p=o.target,n=l?new eD(p):c?new Qz(p):new tD(p),new Wz(n)));var n,o,l,c,p},e.hasNameForId=function(n,o){return this.names.has(n)&&this.names.get(n).has(o)},e.registerName=function(n,o){if($0(n),this.names.has(n))this.names.get(n).add(o);else{var l=new Set;l.add(o),this.names.set(n,l)}},e.insertRules=function(n,o,l){this.registerName(n,o),this.getTag().insertRules($0(n),l)},e.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},e.clearRules=function(n){this.getTag().clearGroup($0(n)),this.clearNames(n)},e.clearTag=function(){this.tag=void 0},e.toString=function(){return function(n){for(var o=n.getTag(),l=o.length,c="",p=0;p<l;p++){var r=Yz(p);if(r!==void 0){var w=n.names.get(r),M=o.getGroup(p);if(w&&M&&w.size){var N=Cg+".g"+p+'[id="'+r+'"]',E="";w!==void 0&&w.forEach(function(Z){Z.length>0&&(E+=Z+",")}),c+=""+M+N+'{content:"'+E+`"}/*!sc*/
`}}}return c}(this)},t}(),iD=/(a)(d)/gi,iS=function(t){return String.fromCharCode(t+(t>25?39:97))};function NC(t){var e,n="";for(e=Math.abs(t);e>52;e=e/52|0)n=iS(e%52)+n;return(iS(e%52)+n).replace(iD,"$1-$2")}var og=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},pL=function(t){return og(5381,t)};function mL(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Ig(n)&&!tA(n))return!1}return!0}var rD=pL("5.3.6"),oD=function(){function t(e,n,o){this.rules=e,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&mL(e),this.componentId=n,this.baseHash=og(rD,n),this.baseStyle=o,Q1.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,o){var l=this.componentId,c=[];if(this.baseStyle&&c.push(this.baseStyle.generateAndInjectStyles(e,n,o)),this.isStatic&&!o.hash)if(this.staticRulesId&&n.hasNameForId(l,this.staticRulesId))c.push(this.staticRulesId);else{var p=Pp(this.rules,e,n,o).join(""),r=NC(og(this.baseHash,p)>>>0);if(!n.hasNameForId(l,r)){var w=o(p,"."+r,void 0,l);n.insertRules(l,r,w)}c.push(r),this.staticRulesId=r}else{for(var M=this.rules.length,N=og(this.baseHash,o.hash),E="",Z=0;Z<M;Z++){var Y=this.rules[Z];if(typeof Y=="string")E+=Y;else if(Y){var K=Pp(Y,e,n,o),q=Array.isArray(K)?K.join(""):K;N=og(N,q+Z),E+=q}}if(E){var at=NC(N>>>0);if(!n.hasNameForId(l,at)){var J=o(E,"."+at,void 0,l);n.insertRules(l,at,J)}c.push(at)}}return c.join(" ")},t}(),sD=/^\s*\/\/.*$/gm,aD=[":","[",".","#"];function lD(t){var e,n,o,l,c=t===void 0?vd:t,p=c.options,r=p===void 0?vd:p,w=c.plugins,M=w===void 0?J1:w,N=new kz(r),E=[],Z=function(q){function at(J){if(J)try{q(J+"}")}catch{}}return function(J,Q,lt,Ct,j,k,rt,yt,xt,kt){switch(J){case 1:if(xt===0&&Q.charCodeAt(0)===64)return q(Q+";"),"";break;case 2:if(yt===0)return Q+"/*|*/";break;case 3:switch(yt){case 102:case 112:return q(lt[0]+Q),"";default:return Q+(kt===0?"/*|*/":"")}case-2:Q.split("/*|*/}").forEach(at)}}}(function(q){E.push(q)}),Y=function(q,at,J){return at===0&&aD.indexOf(J[n.length])!==-1||J.match(l)?q:"."+e};function K(q,at,J,Q){Q===void 0&&(Q="&");var lt=q.replace(sD,""),Ct=at&&J?J+" "+at+" { "+lt+" }":lt;return e=Q,n=at,o=new RegExp("\\"+n+"\\b","g"),l=new RegExp("(\\"+n+"\\b){2,}"),N(J||!at?"":at,Ct)}return N.use([].concat(M,[function(q,at,J){q===2&&J.length&&J[0].lastIndexOf(n)>0&&(J[0]=J[0].replace(o,Y))},Z,function(q){if(q===-2){var at=E;return E=[],at}}])),K.hash=M.length?M.reduce(function(q,at){return at.name||kp(15),og(q,at.name)},5381).toString():"",K}var gL=Aa.createContext();gL.Consumer;var _L=Aa.createContext(),uD=(_L.Consumer,new Q1),OC=lD();function vL(){return Jn.useContext(gL)||uD}function yL(){return Jn.useContext(_L)||OC}var cD=function(){function t(e,n){var o=this;this.inject=function(l,c){c===void 0&&(c=OC);var p=o.name+c.hash;l.hasNameForId(o.id,p)||l.insertRules(o.id,p,c(o.rules,p,"@keyframes"))},this.toString=function(){return kp(12,String(o.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=n}return t.prototype.getName=function(e){return e===void 0&&(e=OC),this.name+e.hash},t}(),hD=/([A-Z])/,fD=/([A-Z])/g,dD=/^ms-/,pD=function(t){return"-"+t.toLowerCase()};function rS(t){return hD.test(t)?t.replace(fD,pD).replace(dD,"-ms-"):t}var oS=function(t){return t==null||t===!1||t===""};function Pp(t,e,n,o){if(Array.isArray(t)){for(var l,c=[],p=0,r=t.length;p<r;p+=1)(l=Pp(t[p],e,n,o))!==""&&(Array.isArray(l)?c.push.apply(c,l):c.push(l));return c}if(oS(t))return"";if(tA(t))return"."+t.styledComponentId;if(Ig(t)){if(typeof(M=t)!="function"||M.prototype&&M.prototype.isReactComponent||!e)return t;var w=t(e);return Pp(w,e,n,o)}var M;return t instanceof cD?n?(t.inject(n,o),t.getName(o)):t:DC(t)?function N(E,Z){var Y,K,q=[];for(var at in E)E.hasOwnProperty(at)&&!oS(E[at])&&(Array.isArray(E[at])&&E[at].isCss||Ig(E[at])?q.push(rS(at)+":",E[at],";"):DC(E[at])?q.push.apply(q,N(E[at],at)):q.push(rS(at)+": "+(Y=at,(K=E[at])==null||typeof K=="boolean"||K===""?"":typeof K!="number"||K===0||Y in Pz?String(K).trim():K+"px")+";"));return Z?[Z+" {"].concat(q,["}"]):q}(t):t.toString()}var sS=function(t){return Array.isArray(t)&&(t.isCss=!0),t};function xL(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Ig(t)||DC(t)?sS(Pp(tS(J1,[t].concat(n)))):n.length===0&&t.length===1&&typeof t[0]=="string"?t:sS(Pp(tS(t,n)))}var wL=function(t,e,n){return n===void 0&&(n=vd),t.theme!==n.theme&&t.theme||e||n.theme},mD=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,gD=/(^-|-$)/g;function wI(t){return t.replace(mD,"-").replace(gD,"")}var bL=function(t){return NC(pL(t)>>>0)};function q0(t){return typeof t=="string"&&!0}var RC=function(t){return typeof t=="function"||typeof t=="object"&&t!==null&&!Array.isArray(t)},_D=function(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"};function vD(t,e,n){var o=t[n];RC(e)&&RC(o)?IL(o,e):t[n]=e}function IL(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];for(var l=0,c=n;l<c.length;l++){var p=c[l];if(RC(p))for(var r in p)_D(r)&&vD(t,p[r],r)}return t}var Jv=Aa.createContext();Jv.Consumer;function yD(t){var e=Jn.useContext(Jv),n=Jn.useMemo(function(){return function(o,l){if(!o)return kp(14);if(Ig(o)){var c=o(l);return c}return Array.isArray(o)||typeof o!="object"?kp(8):l?sh({},l,{},o):o}(t.theme,e)},[t.theme,e]);return t.children?Aa.createElement(Jv.Provider,{value:n},t.children):null}var bI={};function CL(t,e,n){var o=tA(t),l=!q0(t),c=e.attrs,p=c===void 0?J1:c,r=e.componentId,w=r===void 0?function(Q,lt){var Ct=typeof Q!="string"?"sc":wI(Q);bI[Ct]=(bI[Ct]||0)+1;var j=Ct+"-"+bL("5.3.6"+Ct+bI[Ct]);return lt?lt+"-"+j:j}(e.displayName,e.parentComponentId):r,M=e.displayName,N=M===void 0?function(Q){return q0(Q)?"styled."+Q:"Styled("+eS(Q)+")"}(t):M,E=e.displayName&&e.componentId?wI(e.displayName)+"-"+e.componentId:e.componentId||w,Z=o&&t.attrs?Array.prototype.concat(t.attrs,p).filter(Boolean):p,Y=e.shouldForwardProp;o&&t.shouldForwardProp&&(Y=e.shouldForwardProp?function(Q,lt,Ct){return t.shouldForwardProp(Q,lt,Ct)&&e.shouldForwardProp(Q,lt,Ct)}:t.shouldForwardProp);var K,q=new oD(n,E,o?t.componentStyle:void 0),at=q.isStatic&&p.length===0,J=function(Q,lt){return function(Ct,j,k,rt){var yt=Ct.attrs,xt=Ct.componentStyle,kt=Ct.defaultProps,de=Ct.foldedComponentIds,Et=Ct.shouldForwardProp,te=Ct.styledComponentId,ht=Ct.target,ie=function(ye,fe,mn){ye===void 0&&(ye=vd);var Ue=sh({},fe,{theme:ye}),Cn={};return mn.forEach(function(Bn){var Pn,cn,Un,R=Bn;for(Pn in Ig(R)&&(R=R(Ue)),R)Ue[Pn]=Cn[Pn]=Pn==="className"?(cn=Cn[Pn],Un=R[Pn],cn&&Un?cn+" "+Un:cn||Un):R[Pn]}),[Ue,Cn]}(wL(j,Jn.useContext(Jv),kt)||vd,j,yt),ln=ie[0],Le=ie[1],_e=function(ye,fe,mn,Ue){var Cn=vL(),Bn=yL(),Pn=fe?ye.generateAndInjectStyles(vd,Cn,Bn):ye.generateAndInjectStyles(mn,Cn,Bn);return Pn}(xt,rt,ln),Me=k,be=Le.$as||j.$as||Le.as||j.as||ht,ue=q0(be),Yt=Le!==j?sh({},j,{},Le):j,Ee={};for(var ve in Yt)ve[0]!=="$"&&ve!=="as"&&(ve==="forwardedAs"?Ee.as=Yt[ve]:(Et?Et(ve,qT,be):!ue||qT(ve))&&(Ee[ve]=Yt[ve]));return j.style&&Le.style!==j.style&&(Ee.style=sh({},j.style,{},Le.style)),Ee.className=Array.prototype.concat(de,te,_e!==te?_e:null,j.className,Le.className).filter(Boolean).join(" "),Ee.ref=Me,Jn.createElement(be,Ee)}(K,Q,lt,at)};return J.displayName=N,(K=Aa.forwardRef(J)).attrs=Z,K.componentStyle=q,K.displayName=N,K.shouldForwardProp=Y,K.foldedComponentIds=o?Array.prototype.concat(t.foldedComponentIds,t.styledComponentId):J1,K.styledComponentId=E,K.target=o?t.target:t,K.withComponent=function(Q){var lt=e.componentId,Ct=function(k,rt){if(k==null)return{};var yt,xt,kt={},de=Object.keys(k);for(xt=0;xt<de.length;xt++)yt=de[xt],rt.indexOf(yt)>=0||(kt[yt]=k[yt]);return kt}(e,["componentId"]),j=lt&&lt+"-"+(q0(Q)?Q:wI(eS(Q)));return CL(Q,sh({},Ct,{attrs:Z,componentId:j}),n)},Object.defineProperty(K,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(Q){this._foldedDefaultProps=o?IL({},t.defaultProps,Q):Q}}),K.toString=function(){return"."+K.styledComponentId},l&&Gz(K,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),K}var BC=function(t){return function e(n,o,l){if(l===void 0&&(l=vd),!qv.isValidElementType(o))return kp(1,String(o));var c=function(){return n(o,l,xL.apply(void 0,arguments))};return c.withConfig=function(p){return e(n,o,sh({},l,{},p))},c.attrs=function(p){return e(n,o,sh({},l,{attrs:Array.prototype.concat(l.attrs,p).filter(Boolean)}))},c}(CL,t)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(t){BC[t]=BC(t)});var xD=function(){function t(n,o){this.rules=n,this.componentId=o,this.isStatic=mL(n),Q1.registerId(this.componentId+1)}var e=t.prototype;return e.createStyles=function(n,o,l,c){var p=c(Pp(this.rules,o,l,c).join(""),""),r=this.componentId+n;l.insertRules(r,r,p)},e.removeStyles=function(n,o){o.clearRules(this.componentId+n)},e.renderStyles=function(n,o,l,c){n>2&&Q1.registerId(this.componentId+n),this.removeStyles(n,l),this.createStyles(n,o,l,c)},t}();function wD(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];var l=xL.apply(void 0,[t].concat(n)),c="sc-global-"+bL(JSON.stringify(l)),p=new xD(l,c);function r(M){var N=vL(),E=yL(),Z=Jn.useContext(Jv),Y=Jn.useRef(N.allocateGSInstance(c)).current;return N.server&&w(Y,M,N,Z,E),Jn.useLayoutEffect(function(){if(!N.server)return w(Y,M,N,Z,E),function(){return p.removeStyles(Y,N)}},[Y,M,N,Z,E]),null}function w(M,N,E,Z,Y){if(p.isStatic)p.renderStyles(M,Vz,E,Y);else{var K=sh({},N,{theme:wL(N,Z,r.defaultProps)});p.renderStyles(M,K,E,Y)}}return Aa.memo(r)}const ch=BC,bD=ch.div`
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 500px;
    height: 300px;
    border-radius: 20px;
    background-color: ${t=>t.theme.secondary};
    opacity: .8;
    z-index: 1;

    img{
        padding-top:30px;
        padding-bottom: 10px;
        height: 110px;
        opacity: 1;
    }

    label{

    }

    div{
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 20px;

        input::file-selector-button, button{
            border: none;
            background-color: ${t=>t.theme.primary};
            color: ${t=>t.theme.fontColor};
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: .5s;
            width: 150px;
            height: 50px;
            opacity: 1;
        }
        
        section{
            display: flex;
            gap :20%;
        }

        button{
            ${t=>!t.file&&`
                background-color:${t.theme.secondary};
                border:2px solid ${t.theme.primary};
                cursor: initial;
                `}

        }

        
        input::file-selector-button{
            margin-right: 30px;
        }
    }

`;function J0(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var FC={},ID={get exports(){return FC},set exports(t){FC=t}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(o,l,c){function p(M,N){if(!l[M]){if(!o[M]){var E=typeof J0=="function"&&J0;if(!N&&E)return E(M,!0);if(r)return r(M,!0);var Z=new Error("Cannot find module '"+M+"'");throw Z.code="MODULE_NOT_FOUND",Z}var Y=l[M]={exports:{}};o[M][0].call(Y.exports,function(K){var q=o[M][1][K];return p(q||K)},Y,Y.exports,n,o,l,c)}return l[M].exports}for(var r=typeof J0=="function"&&J0,w=0;w<c.length;w++)p(c[w]);return p}({1:[function(n,o,l){var c=n("./utils"),p=n("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(w){for(var M,N,E,Z,Y,K,q,at=[],J=0,Q=w.length,lt=Q,Ct=c.getTypeOf(w)!=="string";J<w.length;)lt=Q-J,E=Ct?(M=w[J++],N=J<Q?w[J++]:0,J<Q?w[J++]:0):(M=w.charCodeAt(J++),N=J<Q?w.charCodeAt(J++):0,J<Q?w.charCodeAt(J++):0),Z=M>>2,Y=(3&M)<<4|N>>4,K=1<lt?(15&N)<<2|E>>6:64,q=2<lt?63&E:64,at.push(r.charAt(Z)+r.charAt(Y)+r.charAt(K)+r.charAt(q));return at.join("")},l.decode=function(w){var M,N,E,Z,Y,K,q=0,at=0,J="data:";if(w.substr(0,J.length)===J)throw new Error("Invalid base64 input, it looks like a data url.");var Q,lt=3*(w=w.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(w.charAt(w.length-1)===r.charAt(64)&&lt--,w.charAt(w.length-2)===r.charAt(64)&&lt--,lt%1!=0)throw new Error("Invalid base64 input, bad content length.");for(Q=p.uint8array?new Uint8Array(0|lt):new Array(0|lt);q<w.length;)M=r.indexOf(w.charAt(q++))<<2|(Z=r.indexOf(w.charAt(q++)))>>4,N=(15&Z)<<4|(Y=r.indexOf(w.charAt(q++)))>>2,E=(3&Y)<<6|(K=r.indexOf(w.charAt(q++))),Q[at++]=M,Y!==64&&(Q[at++]=N),K!==64&&(Q[at++]=E);return Q}},{"./support":30,"./utils":32}],2:[function(n,o,l){var c=n("./external"),p=n("./stream/DataWorker"),r=n("./stream/Crc32Probe"),w=n("./stream/DataLengthProbe");function M(N,E,Z,Y,K){this.compressedSize=N,this.uncompressedSize=E,this.crc32=Z,this.compression=Y,this.compressedContent=K}M.prototype={getContentWorker:function(){var N=new p(c.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new w("data_length")),E=this;return N.on("end",function(){if(this.streamInfo.data_length!==E.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),N},getCompressedWorker:function(){return new p(c.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},M.createWorkerFrom=function(N,E,Z){return N.pipe(new r).pipe(new w("uncompressedSize")).pipe(E.compressWorker(Z)).pipe(new w("compressedSize")).withStreamInfo("compression",E)},o.exports=M},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,o,l){var c=n("./stream/GenericWorker");l.STORE={magic:"\0\0",compressWorker:function(){return new c("STORE compression")},uncompressWorker:function(){return new c("STORE decompression")}},l.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,o,l){var c=n("./utils"),p=function(){for(var r,w=[],M=0;M<256;M++){r=M;for(var N=0;N<8;N++)r=1&r?3988292384^r>>>1:r>>>1;w[M]=r}return w}();o.exports=function(r,w){return r!==void 0&&r.length?c.getTypeOf(r)!=="string"?function(M,N,E,Z){var Y=p,K=Z+E;M^=-1;for(var q=Z;q<K;q++)M=M>>>8^Y[255&(M^N[q])];return-1^M}(0|w,r,r.length,0):function(M,N,E,Z){var Y=p,K=Z+E;M^=-1;for(var q=Z;q<K;q++)M=M>>>8^Y[255&(M^N.charCodeAt(q))];return-1^M}(0|w,r,r.length,0):0}},{"./utils":32}],5:[function(n,o,l){l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},{}],6:[function(n,o,l){var c=null;c=typeof Promise<"u"?Promise:n("lie"),o.exports={Promise:c}},{lie:37}],7:[function(n,o,l){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",p=n("pako"),r=n("./utils"),w=n("./stream/GenericWorker"),M=c?"uint8array":"array";function N(E,Z){w.call(this,"FlateWorker/"+E),this._pako=null,this._pakoAction=E,this._pakoOptions=Z,this.meta={}}l.magic="\b\0",r.inherits(N,w),N.prototype.processChunk=function(E){this.meta=E.meta,this._pako===null&&this._createPako(),this._pako.push(r.transformTo(M,E.data),!1)},N.prototype.flush=function(){w.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},N.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this._pako=null},N.prototype._createPako=function(){this._pako=new p[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var E=this;this._pako.onData=function(Z){E.push({data:Z,meta:E.meta})}},l.compressWorker=function(E){return new N("Deflate",E)},l.uncompressWorker=function(){return new N("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,o,l){function c(Y,K){var q,at="";for(q=0;q<K;q++)at+=String.fromCharCode(255&Y),Y>>>=8;return at}function p(Y,K,q,at,J,Q){var lt,Ct,j=Y.file,k=Y.compression,rt=Q!==M.utf8encode,yt=r.transformTo("string",Q(j.name)),xt=r.transformTo("string",M.utf8encode(j.name)),kt=j.comment,de=r.transformTo("string",Q(kt)),Et=r.transformTo("string",M.utf8encode(kt)),te=xt.length!==j.name.length,ht=Et.length!==kt.length,ie="",ln="",Le="",_e=j.dir,Me=j.date,be={crc32:0,compressedSize:0,uncompressedSize:0};K&&!q||(be.crc32=Y.crc32,be.compressedSize=Y.compressedSize,be.uncompressedSize=Y.uncompressedSize);var ue=0;K&&(ue|=8),rt||!te&&!ht||(ue|=2048);var Yt=0,Ee=0;_e&&(Yt|=16),J==="UNIX"?(Ee=798,Yt|=function(ye,fe){var mn=ye;return ye||(mn=fe?16893:33204),(65535&mn)<<16}(j.unixPermissions,_e)):(Ee=20,Yt|=function(ye){return 63&(ye||0)}(j.dosPermissions)),lt=Me.getUTCHours(),lt<<=6,lt|=Me.getUTCMinutes(),lt<<=5,lt|=Me.getUTCSeconds()/2,Ct=Me.getUTCFullYear()-1980,Ct<<=4,Ct|=Me.getUTCMonth()+1,Ct<<=5,Ct|=Me.getUTCDate(),te&&(ln=c(1,1)+c(N(yt),4)+xt,ie+="up"+c(ln.length,2)+ln),ht&&(Le=c(1,1)+c(N(de),4)+Et,ie+="uc"+c(Le.length,2)+Le);var ve="";return ve+=`
\0`,ve+=c(ue,2),ve+=k.magic,ve+=c(lt,2),ve+=c(Ct,2),ve+=c(be.crc32,4),ve+=c(be.compressedSize,4),ve+=c(be.uncompressedSize,4),ve+=c(yt.length,2),ve+=c(ie.length,2),{fileRecord:E.LOCAL_FILE_HEADER+ve+yt+ie,dirRecord:E.CENTRAL_FILE_HEADER+c(Ee,2)+ve+c(de.length,2)+"\0\0\0\0"+c(Yt,4)+c(at,4)+yt+ie+de}}var r=n("../utils"),w=n("../stream/GenericWorker"),M=n("../utf8"),N=n("../crc32"),E=n("../signature");function Z(Y,K,q,at){w.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=K,this.zipPlatform=q,this.encodeFileName=at,this.streamFiles=Y,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(Z,w),Z.prototype.push=function(Y){var K=Y.meta.percent||0,q=this.entriesCount,at=this._sources.length;this.accumulate?this.contentBuffer.push(Y):(this.bytesWritten+=Y.data.length,w.prototype.push.call(this,{data:Y.data,meta:{currentFile:this.currentFile,percent:q?(K+100*(q-at-1))/q:100}}))},Z.prototype.openedSource=function(Y){this.currentSourceOffset=this.bytesWritten,this.currentFile=Y.file.name;var K=this.streamFiles&&!Y.file.dir;if(K){var q=p(Y,K,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:q.fileRecord,meta:{percent:0}})}else this.accumulate=!0},Z.prototype.closedSource=function(Y){this.accumulate=!1;var K=this.streamFiles&&!Y.file.dir,q=p(Y,K,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(q.dirRecord),K)this.push({data:function(at){return E.DATA_DESCRIPTOR+c(at.crc32,4)+c(at.compressedSize,4)+c(at.uncompressedSize,4)}(Y),meta:{percent:100}});else for(this.push({data:q.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},Z.prototype.flush=function(){for(var Y=this.bytesWritten,K=0;K<this.dirRecords.length;K++)this.push({data:this.dirRecords[K],meta:{percent:100}});var q=this.bytesWritten-Y,at=function(J,Q,lt,Ct,j){var k=r.transformTo("string",j(Ct));return E.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(J,2)+c(J,2)+c(Q,4)+c(lt,4)+c(k.length,2)+k}(this.dirRecords.length,q,Y,this.zipComment,this.encodeFileName);this.push({data:at,meta:{percent:100}})},Z.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},Z.prototype.registerPrevious=function(Y){this._sources.push(Y);var K=this;return Y.on("data",function(q){K.processChunk(q)}),Y.on("end",function(){K.closedSource(K.previous.streamInfo),K._sources.length?K.prepareNextSource():K.end()}),Y.on("error",function(q){K.error(q)}),this},Z.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},Z.prototype.error=function(Y){var K=this._sources;if(!w.prototype.error.call(this,Y))return!1;for(var q=0;q<K.length;q++)try{K[q].error(Y)}catch{}return!0},Z.prototype.lock=function(){w.prototype.lock.call(this);for(var Y=this._sources,K=0;K<Y.length;K++)Y[K].lock()},o.exports=Z},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,o,l){var c=n("../compressions"),p=n("./ZipFileWorker");l.generateWorker=function(r,w,M){var N=new p(w.streamFiles,M,w.platform,w.encodeFileName),E=0;try{r.forEach(function(Z,Y){E++;var K=function(Q,lt){var Ct=Q||lt,j=c[Ct];if(!j)throw new Error(Ct+" is not a valid compression method !");return j}(Y.options.compression,w.compression),q=Y.options.compressionOptions||w.compressionOptions||{},at=Y.dir,J=Y.date;Y._compressWorker(K,q).withStreamInfo("file",{name:Z,dir:at,date:J,comment:Y.comment||"",unixPermissions:Y.unixPermissions,dosPermissions:Y.dosPermissions}).pipe(N)}),N.entriesCount=E}catch(Z){N.error(Z)}return N}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,o,l){function c(){if(!(this instanceof c))return new c;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var p=new c;for(var r in this)typeof this[r]!="function"&&(p[r]=this[r]);return p}}(c.prototype=n("./object")).loadAsync=n("./load"),c.support=n("./support"),c.defaults=n("./defaults"),c.version="3.10.1",c.loadAsync=function(p,r){return new c().loadAsync(p,r)},c.external=n("./external"),o.exports=c},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,o,l){var c=n("./utils"),p=n("./external"),r=n("./utf8"),w=n("./zipEntries"),M=n("./stream/Crc32Probe"),N=n("./nodejsUtils");function E(Z){return new p.Promise(function(Y,K){var q=Z.decompressed.getContentWorker().pipe(new M);q.on("error",function(at){K(at)}).on("end",function(){q.streamInfo.crc32!==Z.decompressed.crc32?K(new Error("Corrupted zip : CRC32 mismatch")):Y()}).resume()})}o.exports=function(Z,Y){var K=this;return Y=c.extend(Y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),N.isNode&&N.isStream(Z)?p.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):c.prepareContent("the loaded zip file",Z,!0,Y.optimizedBinaryString,Y.base64).then(function(q){var at=new w(Y);return at.load(q),at}).then(function(q){var at=[p.Promise.resolve(q)],J=q.files;if(Y.checkCRC32)for(var Q=0;Q<J.length;Q++)at.push(E(J[Q]));return p.Promise.all(at)}).then(function(q){for(var at=q.shift(),J=at.files,Q=0;Q<J.length;Q++){var lt=J[Q],Ct=lt.fileNameStr,j=c.resolve(lt.fileNameStr);K.file(j,lt.decompressed,{binary:!0,optimizedBinaryString:!0,date:lt.date,dir:lt.dir,comment:lt.fileCommentStr.length?lt.fileCommentStr:null,unixPermissions:lt.unixPermissions,dosPermissions:lt.dosPermissions,createFolders:Y.createFolders}),lt.dir||(K.file(j).unsafeOriginalName=Ct)}return at.zipComment.length&&(K.comment=at.zipComment),K})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,o,l){var c=n("../utils"),p=n("../stream/GenericWorker");function r(w,M){p.call(this,"Nodejs stream input adapter for "+w),this._upstreamEnded=!1,this._bindStream(M)}c.inherits(r,p),r.prototype._bindStream=function(w){var M=this;(this._stream=w).pause(),w.on("data",function(N){M.push({data:N,meta:{percent:0}})}).on("error",function(N){M.isPaused?this.generatedError=N:M.error(N)}).on("end",function(){M.isPaused?M._upstreamEnded=!0:M.end()})},r.prototype.pause=function(){return!!p.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},o.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,o,l){var c=n("readable-stream").Readable;function p(r,w,M){c.call(this,w),this._helper=r;var N=this;r.on("data",function(E,Z){N.push(E)||N._helper.pause(),M&&M(Z)}).on("error",function(E){N.emit("error",E)}).on("end",function(){N.push(null)})}n("../utils").inherits(p,c),p.prototype._read=function(){this._helper.resume()},o.exports=p},{"../utils":32,"readable-stream":16}],14:[function(n,o,l){o.exports={isNode:typeof Buffer<"u",newBufferFrom:function(c,p){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(c,p);if(typeof c=="number")throw new Error('The "data" argument must not be a number');return new Buffer(c,p)},allocBuffer:function(c){if(Buffer.alloc)return Buffer.alloc(c);var p=new Buffer(c);return p.fill(0),p},isBuffer:function(c){return Buffer.isBuffer(c)},isStream:function(c){return c&&typeof c.on=="function"&&typeof c.pause=="function"&&typeof c.resume=="function"}}},{}],15:[function(n,o,l){function c(j,k,rt){var yt,xt=r.getTypeOf(k),kt=r.extend(rt||{},N);kt.date=kt.date||new Date,kt.compression!==null&&(kt.compression=kt.compression.toUpperCase()),typeof kt.unixPermissions=="string"&&(kt.unixPermissions=parseInt(kt.unixPermissions,8)),kt.unixPermissions&&16384&kt.unixPermissions&&(kt.dir=!0),kt.dosPermissions&&16&kt.dosPermissions&&(kt.dir=!0),kt.dir&&(j=J(j)),kt.createFolders&&(yt=at(j))&&Q.call(this,yt,!0);var de=xt==="string"&&kt.binary===!1&&kt.base64===!1;rt&&rt.binary!==void 0||(kt.binary=!de),(k instanceof E&&k.uncompressedSize===0||kt.dir||!k||k.length===0)&&(kt.base64=!1,kt.binary=!0,k="",kt.compression="STORE",xt="string");var Et=null;Et=k instanceof E||k instanceof w?k:K.isNode&&K.isStream(k)?new q(j,k):r.prepareContent(j,k,kt.binary,kt.optimizedBinaryString,kt.base64);var te=new Z(j,Et,kt);this.files[j]=te}var p=n("./utf8"),r=n("./utils"),w=n("./stream/GenericWorker"),M=n("./stream/StreamHelper"),N=n("./defaults"),E=n("./compressedObject"),Z=n("./zipObject"),Y=n("./generate"),K=n("./nodejsUtils"),q=n("./nodejs/NodejsStreamInputAdapter"),at=function(j){j.slice(-1)==="/"&&(j=j.substring(0,j.length-1));var k=j.lastIndexOf("/");return 0<k?j.substring(0,k):""},J=function(j){return j.slice(-1)!=="/"&&(j+="/"),j},Q=function(j,k){return k=k!==void 0?k:N.createFolders,j=J(j),this.files[j]||c.call(this,j,null,{dir:!0,createFolders:k}),this.files[j]};function lt(j){return Object.prototype.toString.call(j)==="[object RegExp]"}var Ct={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(j){var k,rt,yt;for(k in this.files)yt=this.files[k],(rt=k.slice(this.root.length,k.length))&&k.slice(0,this.root.length)===this.root&&j(rt,yt)},filter:function(j){var k=[];return this.forEach(function(rt,yt){j(rt,yt)&&k.push(yt)}),k},file:function(j,k,rt){if(arguments.length!==1)return j=this.root+j,c.call(this,j,k,rt),this;if(lt(j)){var yt=j;return this.filter(function(kt,de){return!de.dir&&yt.test(kt)})}var xt=this.files[this.root+j];return xt&&!xt.dir?xt:null},folder:function(j){if(!j)return this;if(lt(j))return this.filter(function(xt,kt){return kt.dir&&j.test(xt)});var k=this.root+j,rt=Q.call(this,k),yt=this.clone();return yt.root=rt.name,yt},remove:function(j){j=this.root+j;var k=this.files[j];if(k||(j.slice(-1)!=="/"&&(j+="/"),k=this.files[j]),k&&!k.dir)delete this.files[j];else for(var rt=this.filter(function(xt,kt){return kt.name.slice(0,j.length)===j}),yt=0;yt<rt.length;yt++)delete this.files[rt[yt].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(j){var k,rt={};try{if((rt=r.extend(j||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:p.utf8encode})).type=rt.type.toLowerCase(),rt.compression=rt.compression.toUpperCase(),rt.type==="binarystring"&&(rt.type="string"),!rt.type)throw new Error("No output type specified.");r.checkSupport(rt.type),rt.platform!=="darwin"&&rt.platform!=="freebsd"&&rt.platform!=="linux"&&rt.platform!=="sunos"||(rt.platform="UNIX"),rt.platform==="win32"&&(rt.platform="DOS");var yt=rt.comment||this.comment||"";k=Y.generateWorker(this,rt,yt)}catch(xt){(k=new w("error")).error(xt)}return new M(k,rt.type||"string",rt.mimeType)},generateAsync:function(j,k){return this.generateInternalStream(j).accumulate(k)},generateNodeStream:function(j,k){return(j=j||{}).type||(j.type="nodebuffer"),this.generateInternalStream(j).toNodejsStream(k)}};o.exports=Ct},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,o,l){o.exports=n("stream")},{stream:void 0}],17:[function(n,o,l){var c=n("./DataReader");function p(r){c.call(this,r);for(var w=0;w<this.data.length;w++)r[w]=255&r[w]}n("../utils").inherits(p,c),p.prototype.byteAt=function(r){return this.data[this.zero+r]},p.prototype.lastIndexOfSignature=function(r){for(var w=r.charCodeAt(0),M=r.charCodeAt(1),N=r.charCodeAt(2),E=r.charCodeAt(3),Z=this.length-4;0<=Z;--Z)if(this.data[Z]===w&&this.data[Z+1]===M&&this.data[Z+2]===N&&this.data[Z+3]===E)return Z-this.zero;return-1},p.prototype.readAndCheckSignature=function(r){var w=r.charCodeAt(0),M=r.charCodeAt(1),N=r.charCodeAt(2),E=r.charCodeAt(3),Z=this.readData(4);return w===Z[0]&&M===Z[1]&&N===Z[2]&&E===Z[3]},p.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var w=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,w},o.exports=p},{"../utils":32,"./DataReader":18}],18:[function(n,o,l){var c=n("../utils");function p(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}p.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var w,M=0;for(this.checkOffset(r),w=this.index+r-1;w>=this.index;w--)M=(M<<8)+this.byteAt(w);return this.index+=r,M},readString:function(r){return c.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC(1980+(r>>25&127),(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(31&r)<<1))}},o.exports=p},{"../utils":32}],19:[function(n,o,l){var c=n("./Uint8ArrayReader");function p(r){c.call(this,r)}n("../utils").inherits(p,c),p.prototype.readData=function(r){this.checkOffset(r);var w=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,w},o.exports=p},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,o,l){var c=n("./DataReader");function p(r){c.call(this,r)}n("../utils").inherits(p,c),p.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},p.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},p.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},p.prototype.readData=function(r){this.checkOffset(r);var w=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,w},o.exports=p},{"../utils":32,"./DataReader":18}],21:[function(n,o,l){var c=n("./ArrayReader");function p(r){c.call(this,r)}n("../utils").inherits(p,c),p.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var w=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,w},o.exports=p},{"../utils":32,"./ArrayReader":17}],22:[function(n,o,l){var c=n("../utils"),p=n("../support"),r=n("./ArrayReader"),w=n("./StringReader"),M=n("./NodeBufferReader"),N=n("./Uint8ArrayReader");o.exports=function(E){var Z=c.getTypeOf(E);return c.checkSupport(Z),Z!=="string"||p.uint8array?Z==="nodebuffer"?new M(E):p.uint8array?new N(c.transformTo("uint8array",E)):new r(c.transformTo("array",E)):new w(E)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,o,l){l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,o,l){var c=n("./GenericWorker"),p=n("../utils");function r(w){c.call(this,"ConvertWorker to "+w),this.destType=w}p.inherits(r,c),r.prototype.processChunk=function(w){this.push({data:p.transformTo(this.destType,w.data),meta:w.meta})},o.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(n,o,l){var c=n("./GenericWorker"),p=n("../crc32");function r(){c.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(r,c),r.prototype.processChunk=function(w){this.streamInfo.crc32=p(w.data,this.streamInfo.crc32||0),this.push(w)},o.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,o,l){var c=n("../utils"),p=n("./GenericWorker");function r(w){p.call(this,"DataLengthProbe for "+w),this.propName=w,this.withStreamInfo(w,0)}c.inherits(r,p),r.prototype.processChunk=function(w){if(w){var M=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=M+w.data.length}p.prototype.processChunk.call(this,w)},o.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(n,o,l){var c=n("../utils"),p=n("./GenericWorker");function r(w){p.call(this,"DataWorker");var M=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,w.then(function(N){M.dataIsReady=!0,M.data=N,M.max=N&&N.length||0,M.type=c.getTypeOf(N),M.isPaused||M._tickAndRepeat()},function(N){M.error(N)})}c.inherits(r,p),r.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,c.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(c.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var w=null,M=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":w=this.data.substring(this.index,M);break;case"uint8array":w=this.data.subarray(this.index,M);break;case"array":case"nodebuffer":w=this.data.slice(this.index,M)}return this.index=M,this.push({data:w,meta:{percent:this.max?this.index/this.max*100:0}})},o.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(n,o,l){function c(p){this.name=p||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}c.prototype={push:function(p){this.emit("data",p)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(p){this.emit("error",p)}return!0},error:function(p){return!this.isFinished&&(this.isPaused?this.generatedError=p:(this.isFinished=!0,this.emit("error",p),this.previous&&this.previous.error(p),this.cleanUp()),!0)},on:function(p,r){return this._listeners[p].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(p,r){if(this._listeners[p])for(var w=0;w<this._listeners[p].length;w++)this._listeners[p][w].call(this,r)},pipe:function(p){return p.registerPrevious(this)},registerPrevious:function(p){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=p.streamInfo,this.mergeStreamInfo(),this.previous=p;var r=this;return p.on("data",function(w){r.processChunk(w)}),p.on("end",function(){r.end()}),p.on("error",function(w){r.error(w)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var p=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),p=!0),this.previous&&this.previous.resume(),!p},flush:function(){},processChunk:function(p){this.push(p)},withStreamInfo:function(p,r){return this.extraStreamInfo[p]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var p in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,p)&&(this.streamInfo[p]=this.extraStreamInfo[p])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var p="Worker "+this.name;return this.previous?this.previous+" -> "+p:p}},o.exports=c},{}],29:[function(n,o,l){var c=n("../utils"),p=n("./ConvertWorker"),r=n("./GenericWorker"),w=n("../base64"),M=n("../support"),N=n("../external"),E=null;if(M.nodestream)try{E=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function Z(K,q){return new N.Promise(function(at,J){var Q=[],lt=K._internalType,Ct=K._outputType,j=K._mimeType;K.on("data",function(k,rt){Q.push(k),q&&q(rt)}).on("error",function(k){Q=[],J(k)}).on("end",function(){try{var k=function(rt,yt,xt){switch(rt){case"blob":return c.newBlob(c.transformTo("arraybuffer",yt),xt);case"base64":return w.encode(yt);default:return c.transformTo(rt,yt)}}(Ct,function(rt,yt){var xt,kt=0,de=null,Et=0;for(xt=0;xt<yt.length;xt++)Et+=yt[xt].length;switch(rt){case"string":return yt.join("");case"array":return Array.prototype.concat.apply([],yt);case"uint8array":for(de=new Uint8Array(Et),xt=0;xt<yt.length;xt++)de.set(yt[xt],kt),kt+=yt[xt].length;return de;case"nodebuffer":return Buffer.concat(yt);default:throw new Error("concat : unsupported type '"+rt+"'")}}(lt,Q),j);at(k)}catch(rt){J(rt)}Q=[]}).resume()})}function Y(K,q,at){var J=q;switch(q){case"blob":case"arraybuffer":J="uint8array";break;case"base64":J="string"}try{this._internalType=J,this._outputType=q,this._mimeType=at,c.checkSupport(J),this._worker=K.pipe(new p(J)),K.lock()}catch(Q){this._worker=new r("error"),this._worker.error(Q)}}Y.prototype={accumulate:function(K){return Z(this,K)},on:function(K,q){var at=this;return K==="data"?this._worker.on(K,function(J){q.call(at,J.data,J.meta)}):this._worker.on(K,function(){c.delay(q,arguments,at)}),this},resume:function(){return c.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(K){if(c.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new E(this,{objectMode:this._outputType!=="nodebuffer"},K)}},o.exports=Y},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,o,l){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=typeof Buffer<"u",l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var c=new ArrayBuffer(0);try{l.blob=new Blob([c],{type:"application/zip"}).size===0}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);p.append(c),l.blob=p.getBlob("application/zip").size===0}catch{l.blob=!1}}}try{l.nodestream=!!n("readable-stream").Readable}catch{l.nodestream=!1}},{"readable-stream":16}],31:[function(n,o,l){for(var c=n("./utils"),p=n("./support"),r=n("./nodejsUtils"),w=n("./stream/GenericWorker"),M=new Array(256),N=0;N<256;N++)M[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;M[254]=M[254]=1;function E(){w.call(this,"utf-8 decode"),this.leftOver=null}function Z(){w.call(this,"utf-8 encode")}l.utf8encode=function(Y){return p.nodebuffer?r.newBufferFrom(Y,"utf-8"):function(K){var q,at,J,Q,lt,Ct=K.length,j=0;for(Q=0;Q<Ct;Q++)(64512&(at=K.charCodeAt(Q)))==55296&&Q+1<Ct&&(64512&(J=K.charCodeAt(Q+1)))==56320&&(at=65536+(at-55296<<10)+(J-56320),Q++),j+=at<128?1:at<2048?2:at<65536?3:4;for(q=p.uint8array?new Uint8Array(j):new Array(j),Q=lt=0;lt<j;Q++)(64512&(at=K.charCodeAt(Q)))==55296&&Q+1<Ct&&(64512&(J=K.charCodeAt(Q+1)))==56320&&(at=65536+(at-55296<<10)+(J-56320),Q++),at<128?q[lt++]=at:(at<2048?q[lt++]=192|at>>>6:(at<65536?q[lt++]=224|at>>>12:(q[lt++]=240|at>>>18,q[lt++]=128|at>>>12&63),q[lt++]=128|at>>>6&63),q[lt++]=128|63&at);return q}(Y)},l.utf8decode=function(Y){return p.nodebuffer?c.transformTo("nodebuffer",Y).toString("utf-8"):function(K){var q,at,J,Q,lt=K.length,Ct=new Array(2*lt);for(q=at=0;q<lt;)if((J=K[q++])<128)Ct[at++]=J;else if(4<(Q=M[J]))Ct[at++]=65533,q+=Q-1;else{for(J&=Q===2?31:Q===3?15:7;1<Q&&q<lt;)J=J<<6|63&K[q++],Q--;1<Q?Ct[at++]=65533:J<65536?Ct[at++]=J:(J-=65536,Ct[at++]=55296|J>>10&1023,Ct[at++]=56320|1023&J)}return Ct.length!==at&&(Ct.subarray?Ct=Ct.subarray(0,at):Ct.length=at),c.applyFromCharCode(Ct)}(Y=c.transformTo(p.uint8array?"uint8array":"array",Y))},c.inherits(E,w),E.prototype.processChunk=function(Y){var K=c.transformTo(p.uint8array?"uint8array":"array",Y.data);if(this.leftOver&&this.leftOver.length){if(p.uint8array){var q=K;(K=new Uint8Array(q.length+this.leftOver.length)).set(this.leftOver,0),K.set(q,this.leftOver.length)}else K=this.leftOver.concat(K);this.leftOver=null}var at=function(Q,lt){var Ct;for((lt=lt||Q.length)>Q.length&&(lt=Q.length),Ct=lt-1;0<=Ct&&(192&Q[Ct])==128;)Ct--;return Ct<0||Ct===0?lt:Ct+M[Q[Ct]]>lt?Ct:lt}(K),J=K;at!==K.length&&(p.uint8array?(J=K.subarray(0,at),this.leftOver=K.subarray(at,K.length)):(J=K.slice(0,at),this.leftOver=K.slice(at,K.length))),this.push({data:l.utf8decode(J),meta:Y.meta})},E.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=E,c.inherits(Z,w),Z.prototype.processChunk=function(Y){this.push({data:l.utf8encode(Y.data),meta:Y.meta})},l.Utf8EncodeWorker=Z},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,o,l){var c=n("./support"),p=n("./base64"),r=n("./nodejsUtils"),w=n("./external");function M(q){return q}function N(q,at){for(var J=0;J<q.length;++J)at[J]=255&q.charCodeAt(J);return at}n("setimmediate"),l.newBlob=function(q,at){l.checkSupport("blob");try{return new Blob([q],{type:at})}catch{try{var J=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return J.append(q),J.getBlob(at)}catch{throw new Error("Bug : can't construct the Blob.")}}};var E={stringifyByChunk:function(q,at,J){var Q=[],lt=0,Ct=q.length;if(Ct<=J)return String.fromCharCode.apply(null,q);for(;lt<Ct;)at==="array"||at==="nodebuffer"?Q.push(String.fromCharCode.apply(null,q.slice(lt,Math.min(lt+J,Ct)))):Q.push(String.fromCharCode.apply(null,q.subarray(lt,Math.min(lt+J,Ct)))),lt+=J;return Q.join("")},stringifyByChar:function(q){for(var at="",J=0;J<q.length;J++)at+=String.fromCharCode(q[J]);return at},applyCanBeUsed:{uint8array:function(){try{return c.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return c.nodebuffer&&String.fromCharCode.apply(null,r.allocBuffer(1)).length===1}catch{return!1}}()}};function Z(q){var at=65536,J=l.getTypeOf(q),Q=!0;if(J==="uint8array"?Q=E.applyCanBeUsed.uint8array:J==="nodebuffer"&&(Q=E.applyCanBeUsed.nodebuffer),Q)for(;1<at;)try{return E.stringifyByChunk(q,J,at)}catch{at=Math.floor(at/2)}return E.stringifyByChar(q)}function Y(q,at){for(var J=0;J<q.length;J++)at[J]=q[J];return at}l.applyFromCharCode=Z;var K={};K.string={string:M,array:function(q){return N(q,new Array(q.length))},arraybuffer:function(q){return K.string.uint8array(q).buffer},uint8array:function(q){return N(q,new Uint8Array(q.length))},nodebuffer:function(q){return N(q,r.allocBuffer(q.length))}},K.array={string:Z,array:M,arraybuffer:function(q){return new Uint8Array(q).buffer},uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return r.newBufferFrom(q)}},K.arraybuffer={string:function(q){return Z(new Uint8Array(q))},array:function(q){return Y(new Uint8Array(q),new Array(q.byteLength))},arraybuffer:M,uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return r.newBufferFrom(new Uint8Array(q))}},K.uint8array={string:Z,array:function(q){return Y(q,new Array(q.length))},arraybuffer:function(q){return q.buffer},uint8array:M,nodebuffer:function(q){return r.newBufferFrom(q)}},K.nodebuffer={string:Z,array:function(q){return Y(q,new Array(q.length))},arraybuffer:function(q){return K.nodebuffer.uint8array(q).buffer},uint8array:function(q){return Y(q,new Uint8Array(q.length))},nodebuffer:M},l.transformTo=function(q,at){if(at=at||"",!q)return at;l.checkSupport(q);var J=l.getTypeOf(at);return K[J][q](at)},l.resolve=function(q){for(var at=q.split("/"),J=[],Q=0;Q<at.length;Q++){var lt=at[Q];lt==="."||lt===""&&Q!==0&&Q!==at.length-1||(lt===".."?J.pop():J.push(lt))}return J.join("/")},l.getTypeOf=function(q){return typeof q=="string"?"string":Object.prototype.toString.call(q)==="[object Array]"?"array":c.nodebuffer&&r.isBuffer(q)?"nodebuffer":c.uint8array&&q instanceof Uint8Array?"uint8array":c.arraybuffer&&q instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(q){if(!c[q.toLowerCase()])throw new Error(q+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(q){var at,J,Q="";for(J=0;J<(q||"").length;J++)Q+="\\x"+((at=q.charCodeAt(J))<16?"0":"")+at.toString(16).toUpperCase();return Q},l.delay=function(q,at,J){setImmediate(function(){q.apply(J||null,at||[])})},l.inherits=function(q,at){function J(){}J.prototype=at.prototype,q.prototype=new J},l.extend=function(){var q,at,J={};for(q=0;q<arguments.length;q++)for(at in arguments[q])Object.prototype.hasOwnProperty.call(arguments[q],at)&&J[at]===void 0&&(J[at]=arguments[q][at]);return J},l.prepareContent=function(q,at,J,Q,lt){return w.Promise.resolve(at).then(function(Ct){return c.blob&&(Ct instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Ct))!==-1)&&typeof FileReader<"u"?new w.Promise(function(j,k){var rt=new FileReader;rt.onload=function(yt){j(yt.target.result)},rt.onerror=function(yt){k(yt.target.error)},rt.readAsArrayBuffer(Ct)}):Ct}).then(function(Ct){var j=l.getTypeOf(Ct);return j?(j==="arraybuffer"?Ct=l.transformTo("uint8array",Ct):j==="string"&&(lt?Ct=p.decode(Ct):J&&Q!==!0&&(Ct=function(k){return N(k,c.uint8array?new Uint8Array(k.length):new Array(k.length))}(Ct))),Ct):w.Promise.reject(new Error("Can't read the data of '"+q+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,o,l){var c=n("./reader/readerFor"),p=n("./utils"),r=n("./signature"),w=n("./zipEntry"),M=n("./support");function N(E){this.files=[],this.loadOptions=E}N.prototype={checkSignature:function(E){if(!this.reader.readAndCheckSignature(E)){this.reader.index-=4;var Z=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+p.pretty(Z)+", expected "+p.pretty(E)+")")}},isSignature:function(E,Z){var Y=this.reader.index;this.reader.setIndex(E);var K=this.reader.readString(4)===Z;return this.reader.setIndex(Y),K},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var E=this.reader.readData(this.zipCommentLength),Z=M.uint8array?"uint8array":"array",Y=p.transformTo(Z,E);this.zipComment=this.loadOptions.decodeFileName(Y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var E,Z,Y,K=this.zip64EndOfCentralSize-44;0<K;)E=this.reader.readInt(2),Z=this.reader.readInt(4),Y=this.reader.readData(Z),this.zip64ExtensibleData[E]={id:E,length:Z,value:Y}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var E,Z;for(E=0;E<this.files.length;E++)Z=this.files[E],this.reader.setIndex(Z.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),Z.readLocalPart(this.reader),Z.handleUTF8(),Z.processAttributes()},readCentralDir:function(){var E;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(E=new w({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(E);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var E=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(E<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(E);var Z=E;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===p.MAX_VALUE_16BITS||this.diskWithCentralDirStart===p.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===p.MAX_VALUE_16BITS||this.centralDirRecords===p.MAX_VALUE_16BITS||this.centralDirSize===p.MAX_VALUE_32BITS||this.centralDirOffset===p.MAX_VALUE_32BITS){if(this.zip64=!0,(E=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(E),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var Y=this.centralDirOffset+this.centralDirSize;this.zip64&&(Y+=20,Y+=12+this.zip64EndOfCentralSize);var K=Z-Y;if(0<K)this.isSignature(Z,r.CENTRAL_FILE_HEADER)||(this.reader.zero=K);else if(K<0)throw new Error("Corrupted zip: missing "+Math.abs(K)+" bytes.")},prepareReader:function(E){this.reader=c(E)},load:function(E){this.prepareReader(E),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},o.exports=N},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,o,l){var c=n("./reader/readerFor"),p=n("./utils"),r=n("./compressedObject"),w=n("./crc32"),M=n("./utf8"),N=n("./compressions"),E=n("./support");function Z(Y,K){this.options=Y,this.loadOptions=K}Z.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(Y){var K,q;if(Y.skip(22),this.fileNameLength=Y.readInt(2),q=Y.readInt(2),this.fileName=Y.readData(this.fileNameLength),Y.skip(q),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((K=function(at){for(var J in N)if(Object.prototype.hasOwnProperty.call(N,J)&&N[J].magic===at)return N[J];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+p.pretty(this.compressionMethod)+" unknown (inner file : "+p.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,K,Y.readData(this.compressedSize))},readCentralPart:function(Y){this.versionMadeBy=Y.readInt(2),Y.skip(2),this.bitFlag=Y.readInt(2),this.compressionMethod=Y.readString(2),this.date=Y.readDate(),this.crc32=Y.readInt(4),this.compressedSize=Y.readInt(4),this.uncompressedSize=Y.readInt(4);var K=Y.readInt(2);if(this.extraFieldsLength=Y.readInt(2),this.fileCommentLength=Y.readInt(2),this.diskNumberStart=Y.readInt(2),this.internalFileAttributes=Y.readInt(2),this.externalFileAttributes=Y.readInt(4),this.localHeaderOffset=Y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");Y.skip(K),this.readExtraFields(Y),this.parseZIP64ExtraField(Y),this.fileComment=Y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var Y=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),Y==0&&(this.dosPermissions=63&this.externalFileAttributes),Y==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var Y=c(this.extraFields[1].value);this.uncompressedSize===p.MAX_VALUE_32BITS&&(this.uncompressedSize=Y.readInt(8)),this.compressedSize===p.MAX_VALUE_32BITS&&(this.compressedSize=Y.readInt(8)),this.localHeaderOffset===p.MAX_VALUE_32BITS&&(this.localHeaderOffset=Y.readInt(8)),this.diskNumberStart===p.MAX_VALUE_32BITS&&(this.diskNumberStart=Y.readInt(4))}},readExtraFields:function(Y){var K,q,at,J=Y.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});Y.index+4<J;)K=Y.readInt(2),q=Y.readInt(2),at=Y.readData(q),this.extraFields[K]={id:K,length:q,value:at};Y.setIndex(J)},handleUTF8:function(){var Y=E.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=M.utf8decode(this.fileName),this.fileCommentStr=M.utf8decode(this.fileComment);else{var K=this.findExtraFieldUnicodePath();if(K!==null)this.fileNameStr=K;else{var q=p.transformTo(Y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(q)}var at=this.findExtraFieldUnicodeComment();if(at!==null)this.fileCommentStr=at;else{var J=p.transformTo(Y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(J)}}},findExtraFieldUnicodePath:function(){var Y=this.extraFields[28789];if(Y){var K=c(Y.value);return K.readInt(1)!==1||w(this.fileName)!==K.readInt(4)?null:M.utf8decode(K.readData(Y.length-5))}return null},findExtraFieldUnicodeComment:function(){var Y=this.extraFields[25461];if(Y){var K=c(Y.value);return K.readInt(1)!==1||w(this.fileComment)!==K.readInt(4)?null:M.utf8decode(K.readData(Y.length-5))}return null}},o.exports=Z},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,o,l){function c(K,q,at){this.name=K,this.dir=at.dir,this.date=at.date,this.comment=at.comment,this.unixPermissions=at.unixPermissions,this.dosPermissions=at.dosPermissions,this._data=q,this._dataBinary=at.binary,this.options={compression:at.compression,compressionOptions:at.compressionOptions}}var p=n("./stream/StreamHelper"),r=n("./stream/DataWorker"),w=n("./utf8"),M=n("./compressedObject"),N=n("./stream/GenericWorker");c.prototype={internalStream:function(K){var q=null,at="string";try{if(!K)throw new Error("No output type specified.");var J=(at=K.toLowerCase())==="string"||at==="text";at!=="binarystring"&&at!=="text"||(at="string"),q=this._decompressWorker();var Q=!this._dataBinary;Q&&!J&&(q=q.pipe(new w.Utf8EncodeWorker)),!Q&&J&&(q=q.pipe(new w.Utf8DecodeWorker))}catch(lt){(q=new N("error")).error(lt)}return new p(q,at,"")},async:function(K,q){return this.internalStream(K).accumulate(q)},nodeStream:function(K,q){return this.internalStream(K||"nodebuffer").toNodejsStream(q)},_compressWorker:function(K,q){if(this._data instanceof M&&this._data.compression.magic===K.magic)return this._data.getCompressedWorker();var at=this._decompressWorker();return this._dataBinary||(at=at.pipe(new w.Utf8EncodeWorker)),M.createWorkerFrom(at,K,q)},_decompressWorker:function(){return this._data instanceof M?this._data.getContentWorker():this._data instanceof N?this._data:new r(this._data)}};for(var E=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],Z=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Y=0;Y<E.length;Y++)c.prototype[E[Y]]=Z;o.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,o,l){(function(c){var p,r,w=c.MutationObserver||c.WebKitMutationObserver;if(w){var M=0,N=new w(K),E=c.document.createTextNode("");N.observe(E,{characterData:!0}),p=function(){E.data=M=++M%2}}else if(c.setImmediate||c.MessageChannel===void 0)p="document"in c&&"onreadystatechange"in c.document.createElement("script")?function(){var q=c.document.createElement("script");q.onreadystatechange=function(){K(),q.onreadystatechange=null,q.parentNode.removeChild(q),q=null},c.document.documentElement.appendChild(q)}:function(){setTimeout(K,0)};else{var Z=new c.MessageChannel;Z.port1.onmessage=K,p=function(){Z.port2.postMessage(0)}}var Y=[];function K(){var q,at;r=!0;for(var J=Y.length;J;){for(at=Y,Y=[],q=-1;++q<J;)at[q]();J=Y.length}r=!1}o.exports=function(q){Y.push(q)!==1||r||p()}}).call(this,typeof fa<"u"?fa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,o,l){var c=n("immediate");function p(){}var r={},w=["REJECTED"],M=["FULFILLED"],N=["PENDING"];function E(J){if(typeof J!="function")throw new TypeError("resolver must be a function");this.state=N,this.queue=[],this.outcome=void 0,J!==p&&q(this,J)}function Z(J,Q,lt){this.promise=J,typeof Q=="function"&&(this.onFulfilled=Q,this.callFulfilled=this.otherCallFulfilled),typeof lt=="function"&&(this.onRejected=lt,this.callRejected=this.otherCallRejected)}function Y(J,Q,lt){c(function(){var Ct;try{Ct=Q(lt)}catch(j){return r.reject(J,j)}Ct===J?r.reject(J,new TypeError("Cannot resolve promise with itself")):r.resolve(J,Ct)})}function K(J){var Q=J&&J.then;if(J&&(typeof J=="object"||typeof J=="function")&&typeof Q=="function")return function(){Q.apply(J,arguments)}}function q(J,Q){var lt=!1;function Ct(rt){lt||(lt=!0,r.reject(J,rt))}function j(rt){lt||(lt=!0,r.resolve(J,rt))}var k=at(function(){Q(j,Ct)});k.status==="error"&&Ct(k.value)}function at(J,Q){var lt={};try{lt.value=J(Q),lt.status="success"}catch(Ct){lt.status="error",lt.value=Ct}return lt}(o.exports=E).prototype.finally=function(J){if(typeof J!="function")return this;var Q=this.constructor;return this.then(function(lt){return Q.resolve(J()).then(function(){return lt})},function(lt){return Q.resolve(J()).then(function(){throw lt})})},E.prototype.catch=function(J){return this.then(null,J)},E.prototype.then=function(J,Q){if(typeof J!="function"&&this.state===M||typeof Q!="function"&&this.state===w)return this;var lt=new this.constructor(p);return this.state!==N?Y(lt,this.state===M?J:Q,this.outcome):this.queue.push(new Z(lt,J,Q)),lt},Z.prototype.callFulfilled=function(J){r.resolve(this.promise,J)},Z.prototype.otherCallFulfilled=function(J){Y(this.promise,this.onFulfilled,J)},Z.prototype.callRejected=function(J){r.reject(this.promise,J)},Z.prototype.otherCallRejected=function(J){Y(this.promise,this.onRejected,J)},r.resolve=function(J,Q){var lt=at(K,Q);if(lt.status==="error")return r.reject(J,lt.value);var Ct=lt.value;if(Ct)q(J,Ct);else{J.state=M,J.outcome=Q;for(var j=-1,k=J.queue.length;++j<k;)J.queue[j].callFulfilled(Q)}return J},r.reject=function(J,Q){J.state=w,J.outcome=Q;for(var lt=-1,Ct=J.queue.length;++lt<Ct;)J.queue[lt].callRejected(Q);return J},E.resolve=function(J){return J instanceof this?J:r.resolve(new this(p),J)},E.reject=function(J){var Q=new this(p);return r.reject(Q,J)},E.all=function(J){var Q=this;if(Object.prototype.toString.call(J)!=="[object Array]")return this.reject(new TypeError("must be an array"));var lt=J.length,Ct=!1;if(!lt)return this.resolve([]);for(var j=new Array(lt),k=0,rt=-1,yt=new this(p);++rt<lt;)xt(J[rt],rt);return yt;function xt(kt,de){Q.resolve(kt).then(function(Et){j[de]=Et,++k!==lt||Ct||(Ct=!0,r.resolve(yt,j))},function(Et){Ct||(Ct=!0,r.reject(yt,Et))})}},E.race=function(J){var Q=this;if(Object.prototype.toString.call(J)!=="[object Array]")return this.reject(new TypeError("must be an array"));var lt=J.length,Ct=!1;if(!lt)return this.resolve([]);for(var j=-1,k=new this(p);++j<lt;)rt=J[j],Q.resolve(rt).then(function(yt){Ct||(Ct=!0,r.resolve(k,yt))},function(yt){Ct||(Ct=!0,r.reject(k,yt))});var rt;return k}},{immediate:36}],38:[function(n,o,l){var c={};(0,n("./lib/utils/common").assign)(c,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),o.exports=c},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,o,l){var c=n("./zlib/deflate"),p=n("./utils/common"),r=n("./utils/strings"),w=n("./zlib/messages"),M=n("./zlib/zstream"),N=Object.prototype.toString,E=0,Z=-1,Y=0,K=8;function q(J){if(!(this instanceof q))return new q(J);this.options=p.assign({level:Z,method:K,chunkSize:16384,windowBits:15,memLevel:8,strategy:Y,to:""},J||{});var Q=this.options;Q.raw&&0<Q.windowBits?Q.windowBits=-Q.windowBits:Q.gzip&&0<Q.windowBits&&Q.windowBits<16&&(Q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var lt=c.deflateInit2(this.strm,Q.level,Q.method,Q.windowBits,Q.memLevel,Q.strategy);if(lt!==E)throw new Error(w[lt]);if(Q.header&&c.deflateSetHeader(this.strm,Q.header),Q.dictionary){var Ct;if(Ct=typeof Q.dictionary=="string"?r.string2buf(Q.dictionary):N.call(Q.dictionary)==="[object ArrayBuffer]"?new Uint8Array(Q.dictionary):Q.dictionary,(lt=c.deflateSetDictionary(this.strm,Ct))!==E)throw new Error(w[lt]);this._dict_set=!0}}function at(J,Q){var lt=new q(Q);if(lt.push(J,!0),lt.err)throw lt.msg||w[lt.err];return lt.result}q.prototype.push=function(J,Q){var lt,Ct,j=this.strm,k=this.options.chunkSize;if(this.ended)return!1;Ct=Q===~~Q?Q:Q===!0?4:0,typeof J=="string"?j.input=r.string2buf(J):N.call(J)==="[object ArrayBuffer]"?j.input=new Uint8Array(J):j.input=J,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new p.Buf8(k),j.next_out=0,j.avail_out=k),(lt=c.deflate(j,Ct))!==1&&lt!==E)return this.onEnd(lt),!(this.ended=!0);j.avail_out!==0&&(j.avail_in!==0||Ct!==4&&Ct!==2)||(this.options.to==="string"?this.onData(r.buf2binstring(p.shrinkBuf(j.output,j.next_out))):this.onData(p.shrinkBuf(j.output,j.next_out)))}while((0<j.avail_in||j.avail_out===0)&&lt!==1);return Ct===4?(lt=c.deflateEnd(this.strm),this.onEnd(lt),this.ended=!0,lt===E):Ct!==2||(this.onEnd(E),!(j.avail_out=0))},q.prototype.onData=function(J){this.chunks.push(J)},q.prototype.onEnd=function(J){J===E&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=p.flattenChunks(this.chunks)),this.chunks=[],this.err=J,this.msg=this.strm.msg},l.Deflate=q,l.deflate=at,l.deflateRaw=function(J,Q){return(Q=Q||{}).raw=!0,at(J,Q)},l.gzip=function(J,Q){return(Q=Q||{}).gzip=!0,at(J,Q)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,o,l){var c=n("./zlib/inflate"),p=n("./utils/common"),r=n("./utils/strings"),w=n("./zlib/constants"),M=n("./zlib/messages"),N=n("./zlib/zstream"),E=n("./zlib/gzheader"),Z=Object.prototype.toString;function Y(q){if(!(this instanceof Y))return new Y(q);this.options=p.assign({chunkSize:16384,windowBits:0,to:""},q||{});var at=this.options;at.raw&&0<=at.windowBits&&at.windowBits<16&&(at.windowBits=-at.windowBits,at.windowBits===0&&(at.windowBits=-15)),!(0<=at.windowBits&&at.windowBits<16)||q&&q.windowBits||(at.windowBits+=32),15<at.windowBits&&at.windowBits<48&&!(15&at.windowBits)&&(at.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var J=c.inflateInit2(this.strm,at.windowBits);if(J!==w.Z_OK)throw new Error(M[J]);this.header=new E,c.inflateGetHeader(this.strm,this.header)}function K(q,at){var J=new Y(at);if(J.push(q,!0),J.err)throw J.msg||M[J.err];return J.result}Y.prototype.push=function(q,at){var J,Q,lt,Ct,j,k,rt=this.strm,yt=this.options.chunkSize,xt=this.options.dictionary,kt=!1;if(this.ended)return!1;Q=at===~~at?at:at===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof q=="string"?rt.input=r.binstring2buf(q):Z.call(q)==="[object ArrayBuffer]"?rt.input=new Uint8Array(q):rt.input=q,rt.next_in=0,rt.avail_in=rt.input.length;do{if(rt.avail_out===0&&(rt.output=new p.Buf8(yt),rt.next_out=0,rt.avail_out=yt),(J=c.inflate(rt,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&xt&&(k=typeof xt=="string"?r.string2buf(xt):Z.call(xt)==="[object ArrayBuffer]"?new Uint8Array(xt):xt,J=c.inflateSetDictionary(this.strm,k)),J===w.Z_BUF_ERROR&&kt===!0&&(J=w.Z_OK,kt=!1),J!==w.Z_STREAM_END&&J!==w.Z_OK)return this.onEnd(J),!(this.ended=!0);rt.next_out&&(rt.avail_out!==0&&J!==w.Z_STREAM_END&&(rt.avail_in!==0||Q!==w.Z_FINISH&&Q!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(lt=r.utf8border(rt.output,rt.next_out),Ct=rt.next_out-lt,j=r.buf2string(rt.output,lt),rt.next_out=Ct,rt.avail_out=yt-Ct,Ct&&p.arraySet(rt.output,rt.output,lt,Ct,0),this.onData(j)):this.onData(p.shrinkBuf(rt.output,rt.next_out)))),rt.avail_in===0&&rt.avail_out===0&&(kt=!0)}while((0<rt.avail_in||rt.avail_out===0)&&J!==w.Z_STREAM_END);return J===w.Z_STREAM_END&&(Q=w.Z_FINISH),Q===w.Z_FINISH?(J=c.inflateEnd(this.strm),this.onEnd(J),this.ended=!0,J===w.Z_OK):Q!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),!(rt.avail_out=0))},Y.prototype.onData=function(q){this.chunks.push(q)},Y.prototype.onEnd=function(q){q===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=p.flattenChunks(this.chunks)),this.chunks=[],this.err=q,this.msg=this.strm.msg},l.Inflate=Y,l.inflate=K,l.inflateRaw=function(q,at){return(at=at||{}).raw=!0,K(q,at)},l.ungzip=K},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,o,l){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(w){for(var M=Array.prototype.slice.call(arguments,1);M.length;){var N=M.shift();if(N){if(typeof N!="object")throw new TypeError(N+"must be non-object");for(var E in N)N.hasOwnProperty(E)&&(w[E]=N[E])}}return w},l.shrinkBuf=function(w,M){return w.length===M?w:w.subarray?w.subarray(0,M):(w.length=M,w)};var p={arraySet:function(w,M,N,E,Z){if(M.subarray&&w.subarray)w.set(M.subarray(N,N+E),Z);else for(var Y=0;Y<E;Y++)w[Z+Y]=M[N+Y]},flattenChunks:function(w){var M,N,E,Z,Y,K;for(M=E=0,N=w.length;M<N;M++)E+=w[M].length;for(K=new Uint8Array(E),M=Z=0,N=w.length;M<N;M++)Y=w[M],K.set(Y,Z),Z+=Y.length;return K}},r={arraySet:function(w,M,N,E,Z){for(var Y=0;Y<E;Y++)w[Z+Y]=M[N+Y]},flattenChunks:function(w){return[].concat.apply([],w)}};l.setTyped=function(w){w?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,p)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,r))},l.setTyped(c)},{}],42:[function(n,o,l){var c=n("./common"),p=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{p=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var w=new c.Buf8(256),M=0;M<256;M++)w[M]=252<=M?6:248<=M?5:240<=M?4:224<=M?3:192<=M?2:1;function N(E,Z){if(Z<65537&&(E.subarray&&r||!E.subarray&&p))return String.fromCharCode.apply(null,c.shrinkBuf(E,Z));for(var Y="",K=0;K<Z;K++)Y+=String.fromCharCode(E[K]);return Y}w[254]=w[254]=1,l.string2buf=function(E){var Z,Y,K,q,at,J=E.length,Q=0;for(q=0;q<J;q++)(64512&(Y=E.charCodeAt(q)))==55296&&q+1<J&&(64512&(K=E.charCodeAt(q+1)))==56320&&(Y=65536+(Y-55296<<10)+(K-56320),q++),Q+=Y<128?1:Y<2048?2:Y<65536?3:4;for(Z=new c.Buf8(Q),q=at=0;at<Q;q++)(64512&(Y=E.charCodeAt(q)))==55296&&q+1<J&&(64512&(K=E.charCodeAt(q+1)))==56320&&(Y=65536+(Y-55296<<10)+(K-56320),q++),Y<128?Z[at++]=Y:(Y<2048?Z[at++]=192|Y>>>6:(Y<65536?Z[at++]=224|Y>>>12:(Z[at++]=240|Y>>>18,Z[at++]=128|Y>>>12&63),Z[at++]=128|Y>>>6&63),Z[at++]=128|63&Y);return Z},l.buf2binstring=function(E){return N(E,E.length)},l.binstring2buf=function(E){for(var Z=new c.Buf8(E.length),Y=0,K=Z.length;Y<K;Y++)Z[Y]=E.charCodeAt(Y);return Z},l.buf2string=function(E,Z){var Y,K,q,at,J=Z||E.length,Q=new Array(2*J);for(Y=K=0;Y<J;)if((q=E[Y++])<128)Q[K++]=q;else if(4<(at=w[q]))Q[K++]=65533,Y+=at-1;else{for(q&=at===2?31:at===3?15:7;1<at&&Y<J;)q=q<<6|63&E[Y++],at--;1<at?Q[K++]=65533:q<65536?Q[K++]=q:(q-=65536,Q[K++]=55296|q>>10&1023,Q[K++]=56320|1023&q)}return N(Q,K)},l.utf8border=function(E,Z){var Y;for((Z=Z||E.length)>E.length&&(Z=E.length),Y=Z-1;0<=Y&&(192&E[Y])==128;)Y--;return Y<0||Y===0?Z:Y+w[E[Y]]>Z?Y:Z}},{"./common":41}],43:[function(n,o,l){o.exports=function(c,p,r,w){for(var M=65535&c|0,N=c>>>16&65535|0,E=0;r!==0;){for(r-=E=2e3<r?2e3:r;N=N+(M=M+p[w++]|0)|0,--E;);M%=65521,N%=65521}return M|N<<16|0}},{}],44:[function(n,o,l){o.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,o,l){var c=function(){for(var p,r=[],w=0;w<256;w++){p=w;for(var M=0;M<8;M++)p=1&p?3988292384^p>>>1:p>>>1;r[w]=p}return r}();o.exports=function(p,r,w,M){var N=c,E=M+w;p^=-1;for(var Z=M;Z<E;Z++)p=p>>>8^N[255&(p^r[Z])];return-1^p}},{}],46:[function(n,o,l){var c,p=n("../utils/common"),r=n("./trees"),w=n("./adler32"),M=n("./crc32"),N=n("./messages"),E=0,Z=4,Y=0,K=-2,q=-1,at=4,J=2,Q=8,lt=9,Ct=286,j=30,k=19,rt=2*Ct+1,yt=15,xt=3,kt=258,de=kt+xt+1,Et=42,te=113,ht=1,ie=2,ln=3,Le=4;function _e(R,st){return R.msg=N[st],st}function Me(R){return(R<<1)-(4<R?9:0)}function be(R){for(var st=R.length;0<=--st;)R[st]=0}function ue(R){var st=R.state,gt=st.pending;gt>R.avail_out&&(gt=R.avail_out),gt!==0&&(p.arraySet(R.output,st.pending_buf,st.pending_out,gt,R.next_out),R.next_out+=gt,st.pending_out+=gt,R.total_out+=gt,R.avail_out-=gt,st.pending-=gt,st.pending===0&&(st.pending_out=0))}function Yt(R,st){r._tr_flush_block(R,0<=R.block_start?R.block_start:-1,R.strstart-R.block_start,st),R.block_start=R.strstart,ue(R.strm)}function Ee(R,st){R.pending_buf[R.pending++]=st}function ve(R,st){R.pending_buf[R.pending++]=st>>>8&255,R.pending_buf[R.pending++]=255&st}function ye(R,st){var gt,dt,wt=R.max_chain_length,Zt=R.strstart,we=R.prev_length,We=R.nice_match,pe=R.strstart>R.w_size-de?R.strstart-(R.w_size-de):0,un=R.window,Ye=R.w_mask,Ge=R.prev,Gn=R.strstart+kt,_i=un[Zt+we-1],ui=un[Zt+we];R.prev_length>=R.good_match&&(wt>>=2),We>R.lookahead&&(We=R.lookahead);do if(un[(gt=st)+we]===ui&&un[gt+we-1]===_i&&un[gt]===un[Zt]&&un[++gt]===un[Zt+1]){Zt+=2,gt++;do;while(un[++Zt]===un[++gt]&&un[++Zt]===un[++gt]&&un[++Zt]===un[++gt]&&un[++Zt]===un[++gt]&&un[++Zt]===un[++gt]&&un[++Zt]===un[++gt]&&un[++Zt]===un[++gt]&&un[++Zt]===un[++gt]&&Zt<Gn);if(dt=kt-(Gn-Zt),Zt=Gn-kt,we<dt){if(R.match_start=st,We<=(we=dt))break;_i=un[Zt+we-1],ui=un[Zt+we]}}while((st=Ge[st&Ye])>pe&&--wt!=0);return we<=R.lookahead?we:R.lookahead}function fe(R){var st,gt,dt,wt,Zt,we,We,pe,un,Ye,Ge=R.w_size;do{if(wt=R.window_size-R.lookahead-R.strstart,R.strstart>=Ge+(Ge-de)){for(p.arraySet(R.window,R.window,Ge,Ge,0),R.match_start-=Ge,R.strstart-=Ge,R.block_start-=Ge,st=gt=R.hash_size;dt=R.head[--st],R.head[st]=Ge<=dt?dt-Ge:0,--gt;);for(st=gt=Ge;dt=R.prev[--st],R.prev[st]=Ge<=dt?dt-Ge:0,--gt;);wt+=Ge}if(R.strm.avail_in===0)break;if(we=R.strm,We=R.window,pe=R.strstart+R.lookahead,un=wt,Ye=void 0,Ye=we.avail_in,un<Ye&&(Ye=un),gt=Ye===0?0:(we.avail_in-=Ye,p.arraySet(We,we.input,we.next_in,Ye,pe),we.state.wrap===1?we.adler=w(we.adler,We,Ye,pe):we.state.wrap===2&&(we.adler=M(we.adler,We,Ye,pe)),we.next_in+=Ye,we.total_in+=Ye,Ye),R.lookahead+=gt,R.lookahead+R.insert>=xt)for(Zt=R.strstart-R.insert,R.ins_h=R.window[Zt],R.ins_h=(R.ins_h<<R.hash_shift^R.window[Zt+1])&R.hash_mask;R.insert&&(R.ins_h=(R.ins_h<<R.hash_shift^R.window[Zt+xt-1])&R.hash_mask,R.prev[Zt&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=Zt,Zt++,R.insert--,!(R.lookahead+R.insert<xt)););}while(R.lookahead<de&&R.strm.avail_in!==0)}function mn(R,st){for(var gt,dt;;){if(R.lookahead<de){if(fe(R),R.lookahead<de&&st===E)return ht;if(R.lookahead===0)break}if(gt=0,R.lookahead>=xt&&(R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+xt-1])&R.hash_mask,gt=R.prev[R.strstart&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=R.strstart),gt!==0&&R.strstart-gt<=R.w_size-de&&(R.match_length=ye(R,gt)),R.match_length>=xt)if(dt=r._tr_tally(R,R.strstart-R.match_start,R.match_length-xt),R.lookahead-=R.match_length,R.match_length<=R.max_lazy_match&&R.lookahead>=xt){for(R.match_length--;R.strstart++,R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+xt-1])&R.hash_mask,gt=R.prev[R.strstart&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=R.strstart,--R.match_length!=0;);R.strstart++}else R.strstart+=R.match_length,R.match_length=0,R.ins_h=R.window[R.strstart],R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+1])&R.hash_mask;else dt=r._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++;if(dt&&(Yt(R,!1),R.strm.avail_out===0))return ht}return R.insert=R.strstart<xt-1?R.strstart:xt-1,st===Z?(Yt(R,!0),R.strm.avail_out===0?ln:Le):R.last_lit&&(Yt(R,!1),R.strm.avail_out===0)?ht:ie}function Ue(R,st){for(var gt,dt,wt;;){if(R.lookahead<de){if(fe(R),R.lookahead<de&&st===E)return ht;if(R.lookahead===0)break}if(gt=0,R.lookahead>=xt&&(R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+xt-1])&R.hash_mask,gt=R.prev[R.strstart&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=R.strstart),R.prev_length=R.match_length,R.prev_match=R.match_start,R.match_length=xt-1,gt!==0&&R.prev_length<R.max_lazy_match&&R.strstart-gt<=R.w_size-de&&(R.match_length=ye(R,gt),R.match_length<=5&&(R.strategy===1||R.match_length===xt&&4096<R.strstart-R.match_start)&&(R.match_length=xt-1)),R.prev_length>=xt&&R.match_length<=R.prev_length){for(wt=R.strstart+R.lookahead-xt,dt=r._tr_tally(R,R.strstart-1-R.prev_match,R.prev_length-xt),R.lookahead-=R.prev_length-1,R.prev_length-=2;++R.strstart<=wt&&(R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+xt-1])&R.hash_mask,gt=R.prev[R.strstart&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=R.strstart),--R.prev_length!=0;);if(R.match_available=0,R.match_length=xt-1,R.strstart++,dt&&(Yt(R,!1),R.strm.avail_out===0))return ht}else if(R.match_available){if((dt=r._tr_tally(R,0,R.window[R.strstart-1]))&&Yt(R,!1),R.strstart++,R.lookahead--,R.strm.avail_out===0)return ht}else R.match_available=1,R.strstart++,R.lookahead--}return R.match_available&&(dt=r._tr_tally(R,0,R.window[R.strstart-1]),R.match_available=0),R.insert=R.strstart<xt-1?R.strstart:xt-1,st===Z?(Yt(R,!0),R.strm.avail_out===0?ln:Le):R.last_lit&&(Yt(R,!1),R.strm.avail_out===0)?ht:ie}function Cn(R,st,gt,dt,wt){this.good_length=R,this.max_lazy=st,this.nice_length=gt,this.max_chain=dt,this.func=wt}function Bn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Q,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new p.Buf16(2*rt),this.dyn_dtree=new p.Buf16(2*(2*j+1)),this.bl_tree=new p.Buf16(2*(2*k+1)),be(this.dyn_ltree),be(this.dyn_dtree),be(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new p.Buf16(yt+1),this.heap=new p.Buf16(2*Ct+1),be(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new p.Buf16(2*Ct+1),be(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Pn(R){var st;return R&&R.state?(R.total_in=R.total_out=0,R.data_type=J,(st=R.state).pending=0,st.pending_out=0,st.wrap<0&&(st.wrap=-st.wrap),st.status=st.wrap?Et:te,R.adler=st.wrap===2?0:1,st.last_flush=E,r._tr_init(st),Y):_e(R,K)}function cn(R){var st=Pn(R);return st===Y&&function(gt){gt.window_size=2*gt.w_size,be(gt.head),gt.max_lazy_match=c[gt.level].max_lazy,gt.good_match=c[gt.level].good_length,gt.nice_match=c[gt.level].nice_length,gt.max_chain_length=c[gt.level].max_chain,gt.strstart=0,gt.block_start=0,gt.lookahead=0,gt.insert=0,gt.match_length=gt.prev_length=xt-1,gt.match_available=0,gt.ins_h=0}(R.state),st}function Un(R,st,gt,dt,wt,Zt){if(!R)return K;var we=1;if(st===q&&(st=6),dt<0?(we=0,dt=-dt):15<dt&&(we=2,dt-=16),wt<1||lt<wt||gt!==Q||dt<8||15<dt||st<0||9<st||Zt<0||at<Zt)return _e(R,K);dt===8&&(dt=9);var We=new Bn;return(R.state=We).strm=R,We.wrap=we,We.gzhead=null,We.w_bits=dt,We.w_size=1<<We.w_bits,We.w_mask=We.w_size-1,We.hash_bits=wt+7,We.hash_size=1<<We.hash_bits,We.hash_mask=We.hash_size-1,We.hash_shift=~~((We.hash_bits+xt-1)/xt),We.window=new p.Buf8(2*We.w_size),We.head=new p.Buf16(We.hash_size),We.prev=new p.Buf16(We.w_size),We.lit_bufsize=1<<wt+6,We.pending_buf_size=4*We.lit_bufsize,We.pending_buf=new p.Buf8(We.pending_buf_size),We.d_buf=1*We.lit_bufsize,We.l_buf=3*We.lit_bufsize,We.level=st,We.strategy=Zt,We.method=gt,cn(R)}c=[new Cn(0,0,0,0,function(R,st){var gt=65535;for(gt>R.pending_buf_size-5&&(gt=R.pending_buf_size-5);;){if(R.lookahead<=1){if(fe(R),R.lookahead===0&&st===E)return ht;if(R.lookahead===0)break}R.strstart+=R.lookahead,R.lookahead=0;var dt=R.block_start+gt;if((R.strstart===0||R.strstart>=dt)&&(R.lookahead=R.strstart-dt,R.strstart=dt,Yt(R,!1),R.strm.avail_out===0)||R.strstart-R.block_start>=R.w_size-de&&(Yt(R,!1),R.strm.avail_out===0))return ht}return R.insert=0,st===Z?(Yt(R,!0),R.strm.avail_out===0?ln:Le):(R.strstart>R.block_start&&(Yt(R,!1),R.strm.avail_out),ht)}),new Cn(4,4,8,4,mn),new Cn(4,5,16,8,mn),new Cn(4,6,32,32,mn),new Cn(4,4,16,16,Ue),new Cn(8,16,32,32,Ue),new Cn(8,16,128,128,Ue),new Cn(8,32,128,256,Ue),new Cn(32,128,258,1024,Ue),new Cn(32,258,258,4096,Ue)],l.deflateInit=function(R,st){return Un(R,st,Q,15,8,0)},l.deflateInit2=Un,l.deflateReset=cn,l.deflateResetKeep=Pn,l.deflateSetHeader=function(R,st){return R&&R.state?R.state.wrap!==2?K:(R.state.gzhead=st,Y):K},l.deflate=function(R,st){var gt,dt,wt,Zt;if(!R||!R.state||5<st||st<0)return R?_e(R,K):K;if(dt=R.state,!R.output||!R.input&&R.avail_in!==0||dt.status===666&&st!==Z)return _e(R,R.avail_out===0?-5:K);if(dt.strm=R,gt=dt.last_flush,dt.last_flush=st,dt.status===Et)if(dt.wrap===2)R.adler=0,Ee(dt,31),Ee(dt,139),Ee(dt,8),dt.gzhead?(Ee(dt,(dt.gzhead.text?1:0)+(dt.gzhead.hcrc?2:0)+(dt.gzhead.extra?4:0)+(dt.gzhead.name?8:0)+(dt.gzhead.comment?16:0)),Ee(dt,255&dt.gzhead.time),Ee(dt,dt.gzhead.time>>8&255),Ee(dt,dt.gzhead.time>>16&255),Ee(dt,dt.gzhead.time>>24&255),Ee(dt,dt.level===9?2:2<=dt.strategy||dt.level<2?4:0),Ee(dt,255&dt.gzhead.os),dt.gzhead.extra&&dt.gzhead.extra.length&&(Ee(dt,255&dt.gzhead.extra.length),Ee(dt,dt.gzhead.extra.length>>8&255)),dt.gzhead.hcrc&&(R.adler=M(R.adler,dt.pending_buf,dt.pending,0)),dt.gzindex=0,dt.status=69):(Ee(dt,0),Ee(dt,0),Ee(dt,0),Ee(dt,0),Ee(dt,0),Ee(dt,dt.level===9?2:2<=dt.strategy||dt.level<2?4:0),Ee(dt,3),dt.status=te);else{var we=Q+(dt.w_bits-8<<4)<<8;we|=(2<=dt.strategy||dt.level<2?0:dt.level<6?1:dt.level===6?2:3)<<6,dt.strstart!==0&&(we|=32),we+=31-we%31,dt.status=te,ve(dt,we),dt.strstart!==0&&(ve(dt,R.adler>>>16),ve(dt,65535&R.adler)),R.adler=1}if(dt.status===69)if(dt.gzhead.extra){for(wt=dt.pending;dt.gzindex<(65535&dt.gzhead.extra.length)&&(dt.pending!==dt.pending_buf_size||(dt.gzhead.hcrc&&dt.pending>wt&&(R.adler=M(R.adler,dt.pending_buf,dt.pending-wt,wt)),ue(R),wt=dt.pending,dt.pending!==dt.pending_buf_size));)Ee(dt,255&dt.gzhead.extra[dt.gzindex]),dt.gzindex++;dt.gzhead.hcrc&&dt.pending>wt&&(R.adler=M(R.adler,dt.pending_buf,dt.pending-wt,wt)),dt.gzindex===dt.gzhead.extra.length&&(dt.gzindex=0,dt.status=73)}else dt.status=73;if(dt.status===73)if(dt.gzhead.name){wt=dt.pending;do{if(dt.pending===dt.pending_buf_size&&(dt.gzhead.hcrc&&dt.pending>wt&&(R.adler=M(R.adler,dt.pending_buf,dt.pending-wt,wt)),ue(R),wt=dt.pending,dt.pending===dt.pending_buf_size)){Zt=1;break}Zt=dt.gzindex<dt.gzhead.name.length?255&dt.gzhead.name.charCodeAt(dt.gzindex++):0,Ee(dt,Zt)}while(Zt!==0);dt.gzhead.hcrc&&dt.pending>wt&&(R.adler=M(R.adler,dt.pending_buf,dt.pending-wt,wt)),Zt===0&&(dt.gzindex=0,dt.status=91)}else dt.status=91;if(dt.status===91)if(dt.gzhead.comment){wt=dt.pending;do{if(dt.pending===dt.pending_buf_size&&(dt.gzhead.hcrc&&dt.pending>wt&&(R.adler=M(R.adler,dt.pending_buf,dt.pending-wt,wt)),ue(R),wt=dt.pending,dt.pending===dt.pending_buf_size)){Zt=1;break}Zt=dt.gzindex<dt.gzhead.comment.length?255&dt.gzhead.comment.charCodeAt(dt.gzindex++):0,Ee(dt,Zt)}while(Zt!==0);dt.gzhead.hcrc&&dt.pending>wt&&(R.adler=M(R.adler,dt.pending_buf,dt.pending-wt,wt)),Zt===0&&(dt.status=103)}else dt.status=103;if(dt.status===103&&(dt.gzhead.hcrc?(dt.pending+2>dt.pending_buf_size&&ue(R),dt.pending+2<=dt.pending_buf_size&&(Ee(dt,255&R.adler),Ee(dt,R.adler>>8&255),R.adler=0,dt.status=te)):dt.status=te),dt.pending!==0){if(ue(R),R.avail_out===0)return dt.last_flush=-1,Y}else if(R.avail_in===0&&Me(st)<=Me(gt)&&st!==Z)return _e(R,-5);if(dt.status===666&&R.avail_in!==0)return _e(R,-5);if(R.avail_in!==0||dt.lookahead!==0||st!==E&&dt.status!==666){var We=dt.strategy===2?function(pe,un){for(var Ye;;){if(pe.lookahead===0&&(fe(pe),pe.lookahead===0)){if(un===E)return ht;break}if(pe.match_length=0,Ye=r._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++,Ye&&(Yt(pe,!1),pe.strm.avail_out===0))return ht}return pe.insert=0,un===Z?(Yt(pe,!0),pe.strm.avail_out===0?ln:Le):pe.last_lit&&(Yt(pe,!1),pe.strm.avail_out===0)?ht:ie}(dt,st):dt.strategy===3?function(pe,un){for(var Ye,Ge,Gn,_i,ui=pe.window;;){if(pe.lookahead<=kt){if(fe(pe),pe.lookahead<=kt&&un===E)return ht;if(pe.lookahead===0)break}if(pe.match_length=0,pe.lookahead>=xt&&0<pe.strstart&&(Ge=ui[Gn=pe.strstart-1])===ui[++Gn]&&Ge===ui[++Gn]&&Ge===ui[++Gn]){_i=pe.strstart+kt;do;while(Ge===ui[++Gn]&&Ge===ui[++Gn]&&Ge===ui[++Gn]&&Ge===ui[++Gn]&&Ge===ui[++Gn]&&Ge===ui[++Gn]&&Ge===ui[++Gn]&&Ge===ui[++Gn]&&Gn<_i);pe.match_length=kt-(_i-Gn),pe.match_length>pe.lookahead&&(pe.match_length=pe.lookahead)}if(pe.match_length>=xt?(Ye=r._tr_tally(pe,1,pe.match_length-xt),pe.lookahead-=pe.match_length,pe.strstart+=pe.match_length,pe.match_length=0):(Ye=r._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++),Ye&&(Yt(pe,!1),pe.strm.avail_out===0))return ht}return pe.insert=0,un===Z?(Yt(pe,!0),pe.strm.avail_out===0?ln:Le):pe.last_lit&&(Yt(pe,!1),pe.strm.avail_out===0)?ht:ie}(dt,st):c[dt.level].func(dt,st);if(We!==ln&&We!==Le||(dt.status=666),We===ht||We===ln)return R.avail_out===0&&(dt.last_flush=-1),Y;if(We===ie&&(st===1?r._tr_align(dt):st!==5&&(r._tr_stored_block(dt,0,0,!1),st===3&&(be(dt.head),dt.lookahead===0&&(dt.strstart=0,dt.block_start=0,dt.insert=0))),ue(R),R.avail_out===0))return dt.last_flush=-1,Y}return st!==Z?Y:dt.wrap<=0?1:(dt.wrap===2?(Ee(dt,255&R.adler),Ee(dt,R.adler>>8&255),Ee(dt,R.adler>>16&255),Ee(dt,R.adler>>24&255),Ee(dt,255&R.total_in),Ee(dt,R.total_in>>8&255),Ee(dt,R.total_in>>16&255),Ee(dt,R.total_in>>24&255)):(ve(dt,R.adler>>>16),ve(dt,65535&R.adler)),ue(R),0<dt.wrap&&(dt.wrap=-dt.wrap),dt.pending!==0?Y:1)},l.deflateEnd=function(R){var st;return R&&R.state?(st=R.state.status)!==Et&&st!==69&&st!==73&&st!==91&&st!==103&&st!==te&&st!==666?_e(R,K):(R.state=null,st===te?_e(R,-3):Y):K},l.deflateSetDictionary=function(R,st){var gt,dt,wt,Zt,we,We,pe,un,Ye=st.length;if(!R||!R.state||(Zt=(gt=R.state).wrap)===2||Zt===1&&gt.status!==Et||gt.lookahead)return K;for(Zt===1&&(R.adler=w(R.adler,st,Ye,0)),gt.wrap=0,Ye>=gt.w_size&&(Zt===0&&(be(gt.head),gt.strstart=0,gt.block_start=0,gt.insert=0),un=new p.Buf8(gt.w_size),p.arraySet(un,st,Ye-gt.w_size,gt.w_size,0),st=un,Ye=gt.w_size),we=R.avail_in,We=R.next_in,pe=R.input,R.avail_in=Ye,R.next_in=0,R.input=st,fe(gt);gt.lookahead>=xt;){for(dt=gt.strstart,wt=gt.lookahead-(xt-1);gt.ins_h=(gt.ins_h<<gt.hash_shift^gt.window[dt+xt-1])&gt.hash_mask,gt.prev[dt&gt.w_mask]=gt.head[gt.ins_h],gt.head[gt.ins_h]=dt,dt++,--wt;);gt.strstart=dt,gt.lookahead=xt-1,fe(gt)}return gt.strstart+=gt.lookahead,gt.block_start=gt.strstart,gt.insert=gt.lookahead,gt.lookahead=0,gt.match_length=gt.prev_length=xt-1,gt.match_available=0,R.next_in=We,R.input=pe,R.avail_in=we,gt.wrap=Zt,Y},l.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,o,l){o.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,o,l){o.exports=function(c,p){var r,w,M,N,E,Z,Y,K,q,at,J,Q,lt,Ct,j,k,rt,yt,xt,kt,de,Et,te,ht,ie;r=c.state,w=c.next_in,ht=c.input,M=w+(c.avail_in-5),N=c.next_out,ie=c.output,E=N-(p-c.avail_out),Z=N+(c.avail_out-257),Y=r.dmax,K=r.wsize,q=r.whave,at=r.wnext,J=r.window,Q=r.hold,lt=r.bits,Ct=r.lencode,j=r.distcode,k=(1<<r.lenbits)-1,rt=(1<<r.distbits)-1;t:do{lt<15&&(Q+=ht[w++]<<lt,lt+=8,Q+=ht[w++]<<lt,lt+=8),yt=Ct[Q&k];e:for(;;){if(Q>>>=xt=yt>>>24,lt-=xt,(xt=yt>>>16&255)===0)ie[N++]=65535&yt;else{if(!(16&xt)){if(!(64&xt)){yt=Ct[(65535&yt)+(Q&(1<<xt)-1)];continue e}if(32&xt){r.mode=12;break t}c.msg="invalid literal/length code",r.mode=30;break t}kt=65535&yt,(xt&=15)&&(lt<xt&&(Q+=ht[w++]<<lt,lt+=8),kt+=Q&(1<<xt)-1,Q>>>=xt,lt-=xt),lt<15&&(Q+=ht[w++]<<lt,lt+=8,Q+=ht[w++]<<lt,lt+=8),yt=j[Q&rt];n:for(;;){if(Q>>>=xt=yt>>>24,lt-=xt,!(16&(xt=yt>>>16&255))){if(!(64&xt)){yt=j[(65535&yt)+(Q&(1<<xt)-1)];continue n}c.msg="invalid distance code",r.mode=30;break t}if(de=65535&yt,lt<(xt&=15)&&(Q+=ht[w++]<<lt,(lt+=8)<xt&&(Q+=ht[w++]<<lt,lt+=8)),Y<(de+=Q&(1<<xt)-1)){c.msg="invalid distance too far back",r.mode=30;break t}if(Q>>>=xt,lt-=xt,(xt=N-E)<de){if(q<(xt=de-xt)&&r.sane){c.msg="invalid distance too far back",r.mode=30;break t}if(te=J,(Et=0)===at){if(Et+=K-xt,xt<kt){for(kt-=xt;ie[N++]=J[Et++],--xt;);Et=N-de,te=ie}}else if(at<xt){if(Et+=K+at-xt,(xt-=at)<kt){for(kt-=xt;ie[N++]=J[Et++],--xt;);if(Et=0,at<kt){for(kt-=xt=at;ie[N++]=J[Et++],--xt;);Et=N-de,te=ie}}}else if(Et+=at-xt,xt<kt){for(kt-=xt;ie[N++]=J[Et++],--xt;);Et=N-de,te=ie}for(;2<kt;)ie[N++]=te[Et++],ie[N++]=te[Et++],ie[N++]=te[Et++],kt-=3;kt&&(ie[N++]=te[Et++],1<kt&&(ie[N++]=te[Et++]))}else{for(Et=N-de;ie[N++]=ie[Et++],ie[N++]=ie[Et++],ie[N++]=ie[Et++],2<(kt-=3););kt&&(ie[N++]=ie[Et++],1<kt&&(ie[N++]=ie[Et++]))}break}}break}}while(w<M&&N<Z);w-=kt=lt>>3,Q&=(1<<(lt-=kt<<3))-1,c.next_in=w,c.next_out=N,c.avail_in=w<M?M-w+5:5-(w-M),c.avail_out=N<Z?Z-N+257:257-(N-Z),r.hold=Q,r.bits=lt}},{}],49:[function(n,o,l){var c=n("../utils/common"),p=n("./adler32"),r=n("./crc32"),w=n("./inffast"),M=n("./inftrees"),N=1,E=2,Z=0,Y=-2,K=1,q=852,at=592;function J(Et){return(Et>>>24&255)+(Et>>>8&65280)+((65280&Et)<<8)+((255&Et)<<24)}function Q(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function lt(Et){var te;return Et&&Et.state?(te=Et.state,Et.total_in=Et.total_out=te.total=0,Et.msg="",te.wrap&&(Et.adler=1&te.wrap),te.mode=K,te.last=0,te.havedict=0,te.dmax=32768,te.head=null,te.hold=0,te.bits=0,te.lencode=te.lendyn=new c.Buf32(q),te.distcode=te.distdyn=new c.Buf32(at),te.sane=1,te.back=-1,Z):Y}function Ct(Et){var te;return Et&&Et.state?((te=Et.state).wsize=0,te.whave=0,te.wnext=0,lt(Et)):Y}function j(Et,te){var ht,ie;return Et&&Et.state?(ie=Et.state,te<0?(ht=0,te=-te):(ht=1+(te>>4),te<48&&(te&=15)),te&&(te<8||15<te)?Y:(ie.window!==null&&ie.wbits!==te&&(ie.window=null),ie.wrap=ht,ie.wbits=te,Ct(Et))):Y}function k(Et,te){var ht,ie;return Et?(ie=new Q,(Et.state=ie).window=null,(ht=j(Et,te))!==Z&&(Et.state=null),ht):Y}var rt,yt,xt=!0;function kt(Et){if(xt){var te;for(rt=new c.Buf32(512),yt=new c.Buf32(32),te=0;te<144;)Et.lens[te++]=8;for(;te<256;)Et.lens[te++]=9;for(;te<280;)Et.lens[te++]=7;for(;te<288;)Et.lens[te++]=8;for(M(N,Et.lens,0,288,rt,0,Et.work,{bits:9}),te=0;te<32;)Et.lens[te++]=5;M(E,Et.lens,0,32,yt,0,Et.work,{bits:5}),xt=!1}Et.lencode=rt,Et.lenbits=9,Et.distcode=yt,Et.distbits=5}function de(Et,te,ht,ie){var ln,Le=Et.state;return Le.window===null&&(Le.wsize=1<<Le.wbits,Le.wnext=0,Le.whave=0,Le.window=new c.Buf8(Le.wsize)),ie>=Le.wsize?(c.arraySet(Le.window,te,ht-Le.wsize,Le.wsize,0),Le.wnext=0,Le.whave=Le.wsize):(ie<(ln=Le.wsize-Le.wnext)&&(ln=ie),c.arraySet(Le.window,te,ht-ie,ln,Le.wnext),(ie-=ln)?(c.arraySet(Le.window,te,ht-ie,ie,0),Le.wnext=ie,Le.whave=Le.wsize):(Le.wnext+=ln,Le.wnext===Le.wsize&&(Le.wnext=0),Le.whave<Le.wsize&&(Le.whave+=ln))),0}l.inflateReset=Ct,l.inflateReset2=j,l.inflateResetKeep=lt,l.inflateInit=function(Et){return k(Et,15)},l.inflateInit2=k,l.inflate=function(Et,te){var ht,ie,ln,Le,_e,Me,be,ue,Yt,Ee,ve,ye,fe,mn,Ue,Cn,Bn,Pn,cn,Un,R,st,gt,dt,wt=0,Zt=new c.Buf8(4),we=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Et||!Et.state||!Et.output||!Et.input&&Et.avail_in!==0)return Y;(ht=Et.state).mode===12&&(ht.mode=13),_e=Et.next_out,ln=Et.output,be=Et.avail_out,Le=Et.next_in,ie=Et.input,Me=Et.avail_in,ue=ht.hold,Yt=ht.bits,Ee=Me,ve=be,st=Z;t:for(;;)switch(ht.mode){case K:if(ht.wrap===0){ht.mode=13;break}for(;Yt<16;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(2&ht.wrap&&ue===35615){Zt[ht.check=0]=255&ue,Zt[1]=ue>>>8&255,ht.check=r(ht.check,Zt,2,0),Yt=ue=0,ht.mode=2;break}if(ht.flags=0,ht.head&&(ht.head.done=!1),!(1&ht.wrap)||(((255&ue)<<8)+(ue>>8))%31){Et.msg="incorrect header check",ht.mode=30;break}if((15&ue)!=8){Et.msg="unknown compression method",ht.mode=30;break}if(Yt-=4,R=8+(15&(ue>>>=4)),ht.wbits===0)ht.wbits=R;else if(R>ht.wbits){Et.msg="invalid window size",ht.mode=30;break}ht.dmax=1<<R,Et.adler=ht.check=1,ht.mode=512&ue?10:12,Yt=ue=0;break;case 2:for(;Yt<16;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(ht.flags=ue,(255&ht.flags)!=8){Et.msg="unknown compression method",ht.mode=30;break}if(57344&ht.flags){Et.msg="unknown header flags set",ht.mode=30;break}ht.head&&(ht.head.text=ue>>8&1),512&ht.flags&&(Zt[0]=255&ue,Zt[1]=ue>>>8&255,ht.check=r(ht.check,Zt,2,0)),Yt=ue=0,ht.mode=3;case 3:for(;Yt<32;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}ht.head&&(ht.head.time=ue),512&ht.flags&&(Zt[0]=255&ue,Zt[1]=ue>>>8&255,Zt[2]=ue>>>16&255,Zt[3]=ue>>>24&255,ht.check=r(ht.check,Zt,4,0)),Yt=ue=0,ht.mode=4;case 4:for(;Yt<16;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}ht.head&&(ht.head.xflags=255&ue,ht.head.os=ue>>8),512&ht.flags&&(Zt[0]=255&ue,Zt[1]=ue>>>8&255,ht.check=r(ht.check,Zt,2,0)),Yt=ue=0,ht.mode=5;case 5:if(1024&ht.flags){for(;Yt<16;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}ht.length=ue,ht.head&&(ht.head.extra_len=ue),512&ht.flags&&(Zt[0]=255&ue,Zt[1]=ue>>>8&255,ht.check=r(ht.check,Zt,2,0)),Yt=ue=0}else ht.head&&(ht.head.extra=null);ht.mode=6;case 6:if(1024&ht.flags&&(Me<(ye=ht.length)&&(ye=Me),ye&&(ht.head&&(R=ht.head.extra_len-ht.length,ht.head.extra||(ht.head.extra=new Array(ht.head.extra_len)),c.arraySet(ht.head.extra,ie,Le,ye,R)),512&ht.flags&&(ht.check=r(ht.check,ie,ye,Le)),Me-=ye,Le+=ye,ht.length-=ye),ht.length))break t;ht.length=0,ht.mode=7;case 7:if(2048&ht.flags){if(Me===0)break t;for(ye=0;R=ie[Le+ye++],ht.head&&R&&ht.length<65536&&(ht.head.name+=String.fromCharCode(R)),R&&ye<Me;);if(512&ht.flags&&(ht.check=r(ht.check,ie,ye,Le)),Me-=ye,Le+=ye,R)break t}else ht.head&&(ht.head.name=null);ht.length=0,ht.mode=8;case 8:if(4096&ht.flags){if(Me===0)break t;for(ye=0;R=ie[Le+ye++],ht.head&&R&&ht.length<65536&&(ht.head.comment+=String.fromCharCode(R)),R&&ye<Me;);if(512&ht.flags&&(ht.check=r(ht.check,ie,ye,Le)),Me-=ye,Le+=ye,R)break t}else ht.head&&(ht.head.comment=null);ht.mode=9;case 9:if(512&ht.flags){for(;Yt<16;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(ue!==(65535&ht.check)){Et.msg="header crc mismatch",ht.mode=30;break}Yt=ue=0}ht.head&&(ht.head.hcrc=ht.flags>>9&1,ht.head.done=!0),Et.adler=ht.check=0,ht.mode=12;break;case 10:for(;Yt<32;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}Et.adler=ht.check=J(ue),Yt=ue=0,ht.mode=11;case 11:if(ht.havedict===0)return Et.next_out=_e,Et.avail_out=be,Et.next_in=Le,Et.avail_in=Me,ht.hold=ue,ht.bits=Yt,2;Et.adler=ht.check=1,ht.mode=12;case 12:if(te===5||te===6)break t;case 13:if(ht.last){ue>>>=7&Yt,Yt-=7&Yt,ht.mode=27;break}for(;Yt<3;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}switch(ht.last=1&ue,Yt-=1,3&(ue>>>=1)){case 0:ht.mode=14;break;case 1:if(kt(ht),ht.mode=20,te!==6)break;ue>>>=2,Yt-=2;break t;case 2:ht.mode=17;break;case 3:Et.msg="invalid block type",ht.mode=30}ue>>>=2,Yt-=2;break;case 14:for(ue>>>=7&Yt,Yt-=7&Yt;Yt<32;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if((65535&ue)!=(ue>>>16^65535)){Et.msg="invalid stored block lengths",ht.mode=30;break}if(ht.length=65535&ue,Yt=ue=0,ht.mode=15,te===6)break t;case 15:ht.mode=16;case 16:if(ye=ht.length){if(Me<ye&&(ye=Me),be<ye&&(ye=be),ye===0)break t;c.arraySet(ln,ie,Le,ye,_e),Me-=ye,Le+=ye,be-=ye,_e+=ye,ht.length-=ye;break}ht.mode=12;break;case 17:for(;Yt<14;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(ht.nlen=257+(31&ue),ue>>>=5,Yt-=5,ht.ndist=1+(31&ue),ue>>>=5,Yt-=5,ht.ncode=4+(15&ue),ue>>>=4,Yt-=4,286<ht.nlen||30<ht.ndist){Et.msg="too many length or distance symbols",ht.mode=30;break}ht.have=0,ht.mode=18;case 18:for(;ht.have<ht.ncode;){for(;Yt<3;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}ht.lens[we[ht.have++]]=7&ue,ue>>>=3,Yt-=3}for(;ht.have<19;)ht.lens[we[ht.have++]]=0;if(ht.lencode=ht.lendyn,ht.lenbits=7,gt={bits:ht.lenbits},st=M(0,ht.lens,0,19,ht.lencode,0,ht.work,gt),ht.lenbits=gt.bits,st){Et.msg="invalid code lengths set",ht.mode=30;break}ht.have=0,ht.mode=19;case 19:for(;ht.have<ht.nlen+ht.ndist;){for(;Cn=(wt=ht.lencode[ue&(1<<ht.lenbits)-1])>>>16&255,Bn=65535&wt,!((Ue=wt>>>24)<=Yt);){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(Bn<16)ue>>>=Ue,Yt-=Ue,ht.lens[ht.have++]=Bn;else{if(Bn===16){for(dt=Ue+2;Yt<dt;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(ue>>>=Ue,Yt-=Ue,ht.have===0){Et.msg="invalid bit length repeat",ht.mode=30;break}R=ht.lens[ht.have-1],ye=3+(3&ue),ue>>>=2,Yt-=2}else if(Bn===17){for(dt=Ue+3;Yt<dt;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}Yt-=Ue,R=0,ye=3+(7&(ue>>>=Ue)),ue>>>=3,Yt-=3}else{for(dt=Ue+7;Yt<dt;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}Yt-=Ue,R=0,ye=11+(127&(ue>>>=Ue)),ue>>>=7,Yt-=7}if(ht.have+ye>ht.nlen+ht.ndist){Et.msg="invalid bit length repeat",ht.mode=30;break}for(;ye--;)ht.lens[ht.have++]=R}}if(ht.mode===30)break;if(ht.lens[256]===0){Et.msg="invalid code -- missing end-of-block",ht.mode=30;break}if(ht.lenbits=9,gt={bits:ht.lenbits},st=M(N,ht.lens,0,ht.nlen,ht.lencode,0,ht.work,gt),ht.lenbits=gt.bits,st){Et.msg="invalid literal/lengths set",ht.mode=30;break}if(ht.distbits=6,ht.distcode=ht.distdyn,gt={bits:ht.distbits},st=M(E,ht.lens,ht.nlen,ht.ndist,ht.distcode,0,ht.work,gt),ht.distbits=gt.bits,st){Et.msg="invalid distances set",ht.mode=30;break}if(ht.mode=20,te===6)break t;case 20:ht.mode=21;case 21:if(6<=Me&&258<=be){Et.next_out=_e,Et.avail_out=be,Et.next_in=Le,Et.avail_in=Me,ht.hold=ue,ht.bits=Yt,w(Et,ve),_e=Et.next_out,ln=Et.output,be=Et.avail_out,Le=Et.next_in,ie=Et.input,Me=Et.avail_in,ue=ht.hold,Yt=ht.bits,ht.mode===12&&(ht.back=-1);break}for(ht.back=0;Cn=(wt=ht.lencode[ue&(1<<ht.lenbits)-1])>>>16&255,Bn=65535&wt,!((Ue=wt>>>24)<=Yt);){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(Cn&&!(240&Cn)){for(Pn=Ue,cn=Cn,Un=Bn;Cn=(wt=ht.lencode[Un+((ue&(1<<Pn+cn)-1)>>Pn)])>>>16&255,Bn=65535&wt,!(Pn+(Ue=wt>>>24)<=Yt);){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}ue>>>=Pn,Yt-=Pn,ht.back+=Pn}if(ue>>>=Ue,Yt-=Ue,ht.back+=Ue,ht.length=Bn,Cn===0){ht.mode=26;break}if(32&Cn){ht.back=-1,ht.mode=12;break}if(64&Cn){Et.msg="invalid literal/length code",ht.mode=30;break}ht.extra=15&Cn,ht.mode=22;case 22:if(ht.extra){for(dt=ht.extra;Yt<dt;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}ht.length+=ue&(1<<ht.extra)-1,ue>>>=ht.extra,Yt-=ht.extra,ht.back+=ht.extra}ht.was=ht.length,ht.mode=23;case 23:for(;Cn=(wt=ht.distcode[ue&(1<<ht.distbits)-1])>>>16&255,Bn=65535&wt,!((Ue=wt>>>24)<=Yt);){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(!(240&Cn)){for(Pn=Ue,cn=Cn,Un=Bn;Cn=(wt=ht.distcode[Un+((ue&(1<<Pn+cn)-1)>>Pn)])>>>16&255,Bn=65535&wt,!(Pn+(Ue=wt>>>24)<=Yt);){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}ue>>>=Pn,Yt-=Pn,ht.back+=Pn}if(ue>>>=Ue,Yt-=Ue,ht.back+=Ue,64&Cn){Et.msg="invalid distance code",ht.mode=30;break}ht.offset=Bn,ht.extra=15&Cn,ht.mode=24;case 24:if(ht.extra){for(dt=ht.extra;Yt<dt;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}ht.offset+=ue&(1<<ht.extra)-1,ue>>>=ht.extra,Yt-=ht.extra,ht.back+=ht.extra}if(ht.offset>ht.dmax){Et.msg="invalid distance too far back",ht.mode=30;break}ht.mode=25;case 25:if(be===0)break t;if(ye=ve-be,ht.offset>ye){if((ye=ht.offset-ye)>ht.whave&&ht.sane){Et.msg="invalid distance too far back",ht.mode=30;break}fe=ye>ht.wnext?(ye-=ht.wnext,ht.wsize-ye):ht.wnext-ye,ye>ht.length&&(ye=ht.length),mn=ht.window}else mn=ln,fe=_e-ht.offset,ye=ht.length;for(be<ye&&(ye=be),be-=ye,ht.length-=ye;ln[_e++]=mn[fe++],--ye;);ht.length===0&&(ht.mode=21);break;case 26:if(be===0)break t;ln[_e++]=ht.length,be--,ht.mode=21;break;case 27:if(ht.wrap){for(;Yt<32;){if(Me===0)break t;Me--,ue|=ie[Le++]<<Yt,Yt+=8}if(ve-=be,Et.total_out+=ve,ht.total+=ve,ve&&(Et.adler=ht.check=ht.flags?r(ht.check,ln,ve,_e-ve):p(ht.check,ln,ve,_e-ve)),ve=be,(ht.flags?ue:J(ue))!==ht.check){Et.msg="incorrect data check",ht.mode=30;break}Yt=ue=0}ht.mode=28;case 28:if(ht.wrap&&ht.flags){for(;Yt<32;){if(Me===0)break t;Me--,ue+=ie[Le++]<<Yt,Yt+=8}if(ue!==(4294967295&ht.total)){Et.msg="incorrect length check",ht.mode=30;break}Yt=ue=0}ht.mode=29;case 29:st=1;break t;case 30:st=-3;break t;case 31:return-4;case 32:default:return Y}return Et.next_out=_e,Et.avail_out=be,Et.next_in=Le,Et.avail_in=Me,ht.hold=ue,ht.bits=Yt,(ht.wsize||ve!==Et.avail_out&&ht.mode<30&&(ht.mode<27||te!==4))&&de(Et,Et.output,Et.next_out,ve-Et.avail_out)?(ht.mode=31,-4):(Ee-=Et.avail_in,ve-=Et.avail_out,Et.total_in+=Ee,Et.total_out+=ve,ht.total+=ve,ht.wrap&&ve&&(Et.adler=ht.check=ht.flags?r(ht.check,ln,ve,Et.next_out-ve):p(ht.check,ln,ve,Et.next_out-ve)),Et.data_type=ht.bits+(ht.last?64:0)+(ht.mode===12?128:0)+(ht.mode===20||ht.mode===15?256:0),(Ee==0&&ve===0||te===4)&&st===Z&&(st=-5),st)},l.inflateEnd=function(Et){if(!Et||!Et.state)return Y;var te=Et.state;return te.window&&(te.window=null),Et.state=null,Z},l.inflateGetHeader=function(Et,te){var ht;return Et&&Et.state&&2&(ht=Et.state).wrap?((ht.head=te).done=!1,Z):Y},l.inflateSetDictionary=function(Et,te){var ht,ie=te.length;return Et&&Et.state?(ht=Et.state).wrap!==0&&ht.mode!==11?Y:ht.mode===11&&p(1,te,ie,0)!==ht.check?-3:de(Et,te,ie,ie)?(ht.mode=31,-4):(ht.havedict=1,Z):Y},l.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,o,l){var c=n("../utils/common"),p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],M=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];o.exports=function(N,E,Z,Y,K,q,at,J){var Q,lt,Ct,j,k,rt,yt,xt,kt,de=J.bits,Et=0,te=0,ht=0,ie=0,ln=0,Le=0,_e=0,Me=0,be=0,ue=0,Yt=null,Ee=0,ve=new c.Buf16(16),ye=new c.Buf16(16),fe=null,mn=0;for(Et=0;Et<=15;Et++)ve[Et]=0;for(te=0;te<Y;te++)ve[E[Z+te]]++;for(ln=de,ie=15;1<=ie&&ve[ie]===0;ie--);if(ie<ln&&(ln=ie),ie===0)return K[q++]=20971520,K[q++]=20971520,J.bits=1,0;for(ht=1;ht<ie&&ve[ht]===0;ht++);for(ln<ht&&(ln=ht),Et=Me=1;Et<=15;Et++)if(Me<<=1,(Me-=ve[Et])<0)return-1;if(0<Me&&(N===0||ie!==1))return-1;for(ye[1]=0,Et=1;Et<15;Et++)ye[Et+1]=ye[Et]+ve[Et];for(te=0;te<Y;te++)E[Z+te]!==0&&(at[ye[E[Z+te]]++]=te);if(rt=N===0?(Yt=fe=at,19):N===1?(Yt=p,Ee-=257,fe=r,mn-=257,256):(Yt=w,fe=M,-1),Et=ht,k=q,_e=te=ue=0,Ct=-1,j=(be=1<<(Le=ln))-1,N===1&&852<be||N===2&&592<be)return 1;for(;;){for(yt=Et-_e,kt=at[te]<rt?(xt=0,at[te]):at[te]>rt?(xt=fe[mn+at[te]],Yt[Ee+at[te]]):(xt=96,0),Q=1<<Et-_e,ht=lt=1<<Le;K[k+(ue>>_e)+(lt-=Q)]=yt<<24|xt<<16|kt|0,lt!==0;);for(Q=1<<Et-1;ue&Q;)Q>>=1;if(Q!==0?(ue&=Q-1,ue+=Q):ue=0,te++,--ve[Et]==0){if(Et===ie)break;Et=E[Z+at[te]]}if(ln<Et&&(ue&j)!==Ct){for(_e===0&&(_e=ln),k+=ht,Me=1<<(Le=Et-_e);Le+_e<ie&&!((Me-=ve[Le+_e])<=0);)Le++,Me<<=1;if(be+=1<<Le,N===1&&852<be||N===2&&592<be)return 1;K[Ct=ue&j]=ln<<24|Le<<16|k-q|0}}return ue!==0&&(K[k+ue]=Et-_e<<24|64<<16|0),J.bits=ln,0}},{"../utils/common":41}],51:[function(n,o,l){o.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,o,l){var c=n("../utils/common"),p=0,r=1;function w(wt){for(var Zt=wt.length;0<=--Zt;)wt[Zt]=0}var M=0,N=29,E=256,Z=E+1+N,Y=30,K=19,q=2*Z+1,at=15,J=16,Q=7,lt=256,Ct=16,j=17,k=18,rt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],yt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],xt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],kt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=new Array(2*(Z+2));w(de);var Et=new Array(2*Y);w(Et);var te=new Array(512);w(te);var ht=new Array(256);w(ht);var ie=new Array(N);w(ie);var ln,Le,_e,Me=new Array(Y);function be(wt,Zt,we,We,pe){this.static_tree=wt,this.extra_bits=Zt,this.extra_base=we,this.elems=We,this.max_length=pe,this.has_stree=wt&&wt.length}function ue(wt,Zt){this.dyn_tree=wt,this.max_code=0,this.stat_desc=Zt}function Yt(wt){return wt<256?te[wt]:te[256+(wt>>>7)]}function Ee(wt,Zt){wt.pending_buf[wt.pending++]=255&Zt,wt.pending_buf[wt.pending++]=Zt>>>8&255}function ve(wt,Zt,we){wt.bi_valid>J-we?(wt.bi_buf|=Zt<<wt.bi_valid&65535,Ee(wt,wt.bi_buf),wt.bi_buf=Zt>>J-wt.bi_valid,wt.bi_valid+=we-J):(wt.bi_buf|=Zt<<wt.bi_valid&65535,wt.bi_valid+=we)}function ye(wt,Zt,we){ve(wt,we[2*Zt],we[2*Zt+1])}function fe(wt,Zt){for(var we=0;we|=1&wt,wt>>>=1,we<<=1,0<--Zt;);return we>>>1}function mn(wt,Zt,we){var We,pe,un=new Array(at+1),Ye=0;for(We=1;We<=at;We++)un[We]=Ye=Ye+we[We-1]<<1;for(pe=0;pe<=Zt;pe++){var Ge=wt[2*pe+1];Ge!==0&&(wt[2*pe]=fe(un[Ge]++,Ge))}}function Ue(wt){var Zt;for(Zt=0;Zt<Z;Zt++)wt.dyn_ltree[2*Zt]=0;for(Zt=0;Zt<Y;Zt++)wt.dyn_dtree[2*Zt]=0;for(Zt=0;Zt<K;Zt++)wt.bl_tree[2*Zt]=0;wt.dyn_ltree[2*lt]=1,wt.opt_len=wt.static_len=0,wt.last_lit=wt.matches=0}function Cn(wt){8<wt.bi_valid?Ee(wt,wt.bi_buf):0<wt.bi_valid&&(wt.pending_buf[wt.pending++]=wt.bi_buf),wt.bi_buf=0,wt.bi_valid=0}function Bn(wt,Zt,we,We){var pe=2*Zt,un=2*we;return wt[pe]<wt[un]||wt[pe]===wt[un]&&We[Zt]<=We[we]}function Pn(wt,Zt,we){for(var We=wt.heap[we],pe=we<<1;pe<=wt.heap_len&&(pe<wt.heap_len&&Bn(Zt,wt.heap[pe+1],wt.heap[pe],wt.depth)&&pe++,!Bn(Zt,We,wt.heap[pe],wt.depth));)wt.heap[we]=wt.heap[pe],we=pe,pe<<=1;wt.heap[we]=We}function cn(wt,Zt,we){var We,pe,un,Ye,Ge=0;if(wt.last_lit!==0)for(;We=wt.pending_buf[wt.d_buf+2*Ge]<<8|wt.pending_buf[wt.d_buf+2*Ge+1],pe=wt.pending_buf[wt.l_buf+Ge],Ge++,We===0?ye(wt,pe,Zt):(ye(wt,(un=ht[pe])+E+1,Zt),(Ye=rt[un])!==0&&ve(wt,pe-=ie[un],Ye),ye(wt,un=Yt(--We),we),(Ye=yt[un])!==0&&ve(wt,We-=Me[un],Ye)),Ge<wt.last_lit;);ye(wt,lt,Zt)}function Un(wt,Zt){var we,We,pe,un=Zt.dyn_tree,Ye=Zt.stat_desc.static_tree,Ge=Zt.stat_desc.has_stree,Gn=Zt.stat_desc.elems,_i=-1;for(wt.heap_len=0,wt.heap_max=q,we=0;we<Gn;we++)un[2*we]!==0?(wt.heap[++wt.heap_len]=_i=we,wt.depth[we]=0):un[2*we+1]=0;for(;wt.heap_len<2;)un[2*(pe=wt.heap[++wt.heap_len]=_i<2?++_i:0)]=1,wt.depth[pe]=0,wt.opt_len--,Ge&&(wt.static_len-=Ye[2*pe+1]);for(Zt.max_code=_i,we=wt.heap_len>>1;1<=we;we--)Pn(wt,un,we);for(pe=Gn;we=wt.heap[1],wt.heap[1]=wt.heap[wt.heap_len--],Pn(wt,un,1),We=wt.heap[1],wt.heap[--wt.heap_max]=we,wt.heap[--wt.heap_max]=We,un[2*pe]=un[2*we]+un[2*We],wt.depth[pe]=(wt.depth[we]>=wt.depth[We]?wt.depth[we]:wt.depth[We])+1,un[2*we+1]=un[2*We+1]=pe,wt.heap[1]=pe++,Pn(wt,un,1),2<=wt.heap_len;);wt.heap[--wt.heap_max]=wt.heap[1],function(ui,ji){var Hi,vr,Jr,$i,uo,Go,Ir=ji.dyn_tree,Ar=ji.max_code,Ro=ji.stat_desc.static_tree,Qo=ji.stat_desc.has_stree,_s=ji.stat_desc.extra_bits,bo=ji.stat_desc.extra_base,co=ji.stat_desc.max_length,io=0;for($i=0;$i<=at;$i++)ui.bl_count[$i]=0;for(Ir[2*ui.heap[ui.heap_max]+1]=0,Hi=ui.heap_max+1;Hi<q;Hi++)co<($i=Ir[2*Ir[2*(vr=ui.heap[Hi])+1]+1]+1)&&($i=co,io++),Ir[2*vr+1]=$i,Ar<vr||(ui.bl_count[$i]++,uo=0,bo<=vr&&(uo=_s[vr-bo]),Go=Ir[2*vr],ui.opt_len+=Go*($i+uo),Qo&&(ui.static_len+=Go*(Ro[2*vr+1]+uo)));if(io!==0){do{for($i=co-1;ui.bl_count[$i]===0;)$i--;ui.bl_count[$i]--,ui.bl_count[$i+1]+=2,ui.bl_count[co]--,io-=2}while(0<io);for($i=co;$i!==0;$i--)for(vr=ui.bl_count[$i];vr!==0;)Ar<(Jr=ui.heap[--Hi])||(Ir[2*Jr+1]!==$i&&(ui.opt_len+=($i-Ir[2*Jr+1])*Ir[2*Jr],Ir[2*Jr+1]=$i),vr--)}}(wt,Zt),mn(un,_i,wt.bl_count)}function R(wt,Zt,we){var We,pe,un=-1,Ye=Zt[1],Ge=0,Gn=7,_i=4;for(Ye===0&&(Gn=138,_i=3),Zt[2*(we+1)+1]=65535,We=0;We<=we;We++)pe=Ye,Ye=Zt[2*(We+1)+1],++Ge<Gn&&pe===Ye||(Ge<_i?wt.bl_tree[2*pe]+=Ge:pe!==0?(pe!==un&&wt.bl_tree[2*pe]++,wt.bl_tree[2*Ct]++):Ge<=10?wt.bl_tree[2*j]++:wt.bl_tree[2*k]++,un=pe,_i=(Ge=0)===Ye?(Gn=138,3):pe===Ye?(Gn=6,3):(Gn=7,4))}function st(wt,Zt,we){var We,pe,un=-1,Ye=Zt[1],Ge=0,Gn=7,_i=4;for(Ye===0&&(Gn=138,_i=3),We=0;We<=we;We++)if(pe=Ye,Ye=Zt[2*(We+1)+1],!(++Ge<Gn&&pe===Ye)){if(Ge<_i)for(;ye(wt,pe,wt.bl_tree),--Ge!=0;);else pe!==0?(pe!==un&&(ye(wt,pe,wt.bl_tree),Ge--),ye(wt,Ct,wt.bl_tree),ve(wt,Ge-3,2)):Ge<=10?(ye(wt,j,wt.bl_tree),ve(wt,Ge-3,3)):(ye(wt,k,wt.bl_tree),ve(wt,Ge-11,7));un=pe,_i=(Ge=0)===Ye?(Gn=138,3):pe===Ye?(Gn=6,3):(Gn=7,4)}}w(Me);var gt=!1;function dt(wt,Zt,we,We){ve(wt,(M<<1)+(We?1:0),3),function(pe,un,Ye,Ge){Cn(pe),Ge&&(Ee(pe,Ye),Ee(pe,~Ye)),c.arraySet(pe.pending_buf,pe.window,un,Ye,pe.pending),pe.pending+=Ye}(wt,Zt,we,!0)}l._tr_init=function(wt){gt||(function(){var Zt,we,We,pe,un,Ye=new Array(at+1);for(pe=We=0;pe<N-1;pe++)for(ie[pe]=We,Zt=0;Zt<1<<rt[pe];Zt++)ht[We++]=pe;for(ht[We-1]=pe,pe=un=0;pe<16;pe++)for(Me[pe]=un,Zt=0;Zt<1<<yt[pe];Zt++)te[un++]=pe;for(un>>=7;pe<Y;pe++)for(Me[pe]=un<<7,Zt=0;Zt<1<<yt[pe]-7;Zt++)te[256+un++]=pe;for(we=0;we<=at;we++)Ye[we]=0;for(Zt=0;Zt<=143;)de[2*Zt+1]=8,Zt++,Ye[8]++;for(;Zt<=255;)de[2*Zt+1]=9,Zt++,Ye[9]++;for(;Zt<=279;)de[2*Zt+1]=7,Zt++,Ye[7]++;for(;Zt<=287;)de[2*Zt+1]=8,Zt++,Ye[8]++;for(mn(de,Z+1,Ye),Zt=0;Zt<Y;Zt++)Et[2*Zt+1]=5,Et[2*Zt]=fe(Zt,5);ln=new be(de,rt,E+1,Z,at),Le=new be(Et,yt,0,Y,at),_e=new be(new Array(0),xt,0,K,Q)}(),gt=!0),wt.l_desc=new ue(wt.dyn_ltree,ln),wt.d_desc=new ue(wt.dyn_dtree,Le),wt.bl_desc=new ue(wt.bl_tree,_e),wt.bi_buf=0,wt.bi_valid=0,Ue(wt)},l._tr_stored_block=dt,l._tr_flush_block=function(wt,Zt,we,We){var pe,un,Ye=0;0<wt.level?(wt.strm.data_type===2&&(wt.strm.data_type=function(Ge){var Gn,_i=4093624447;for(Gn=0;Gn<=31;Gn++,_i>>>=1)if(1&_i&&Ge.dyn_ltree[2*Gn]!==0)return p;if(Ge.dyn_ltree[18]!==0||Ge.dyn_ltree[20]!==0||Ge.dyn_ltree[26]!==0)return r;for(Gn=32;Gn<E;Gn++)if(Ge.dyn_ltree[2*Gn]!==0)return r;return p}(wt)),Un(wt,wt.l_desc),Un(wt,wt.d_desc),Ye=function(Ge){var Gn;for(R(Ge,Ge.dyn_ltree,Ge.l_desc.max_code),R(Ge,Ge.dyn_dtree,Ge.d_desc.max_code),Un(Ge,Ge.bl_desc),Gn=K-1;3<=Gn&&Ge.bl_tree[2*kt[Gn]+1]===0;Gn--);return Ge.opt_len+=3*(Gn+1)+5+5+4,Gn}(wt),pe=wt.opt_len+3+7>>>3,(un=wt.static_len+3+7>>>3)<=pe&&(pe=un)):pe=un=we+5,we+4<=pe&&Zt!==-1?dt(wt,Zt,we,We):wt.strategy===4||un===pe?(ve(wt,2+(We?1:0),3),cn(wt,de,Et)):(ve(wt,4+(We?1:0),3),function(Ge,Gn,_i,ui){var ji;for(ve(Ge,Gn-257,5),ve(Ge,_i-1,5),ve(Ge,ui-4,4),ji=0;ji<ui;ji++)ve(Ge,Ge.bl_tree[2*kt[ji]+1],3);st(Ge,Ge.dyn_ltree,Gn-1),st(Ge,Ge.dyn_dtree,_i-1)}(wt,wt.l_desc.max_code+1,wt.d_desc.max_code+1,Ye+1),cn(wt,wt.dyn_ltree,wt.dyn_dtree)),Ue(wt),We&&Cn(wt)},l._tr_tally=function(wt,Zt,we){return wt.pending_buf[wt.d_buf+2*wt.last_lit]=Zt>>>8&255,wt.pending_buf[wt.d_buf+2*wt.last_lit+1]=255&Zt,wt.pending_buf[wt.l_buf+wt.last_lit]=255&we,wt.last_lit++,Zt===0?wt.dyn_ltree[2*we]++:(wt.matches++,Zt--,wt.dyn_ltree[2*(ht[we]+E+1)]++,wt.dyn_dtree[2*Yt(Zt)]++),wt.last_lit===wt.lit_bufsize-1},l._tr_align=function(wt){ve(wt,2,3),ye(wt,lt,de),function(Zt){Zt.bi_valid===16?(Ee(Zt,Zt.bi_buf),Zt.bi_buf=0,Zt.bi_valid=0):8<=Zt.bi_valid&&(Zt.pending_buf[Zt.pending++]=255&Zt.bi_buf,Zt.bi_buf>>=8,Zt.bi_valid-=8)}(wt)}},{"../utils/common":41}],53:[function(n,o,l){o.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,o,l){(function(c){(function(p,r){if(!p.setImmediate){var w,M,N,E,Z=1,Y={},K=!1,q=p.document,at=Object.getPrototypeOf&&Object.getPrototypeOf(p);at=at&&at.setTimeout?at:p,w={}.toString.call(p.process)==="[object process]"?function(Ct){process.nextTick(function(){Q(Ct)})}:function(){if(p.postMessage&&!p.importScripts){var Ct=!0,j=p.onmessage;return p.onmessage=function(){Ct=!1},p.postMessage("","*"),p.onmessage=j,Ct}}()?(E="setImmediate$"+Math.random()+"$",p.addEventListener?p.addEventListener("message",lt,!1):p.attachEvent("onmessage",lt),function(Ct){p.postMessage(E+Ct,"*")}):p.MessageChannel?((N=new MessageChannel).port1.onmessage=function(Ct){Q(Ct.data)},function(Ct){N.port2.postMessage(Ct)}):q&&"onreadystatechange"in q.createElement("script")?(M=q.documentElement,function(Ct){var j=q.createElement("script");j.onreadystatechange=function(){Q(Ct),j.onreadystatechange=null,M.removeChild(j),j=null},M.appendChild(j)}):function(Ct){setTimeout(Q,0,Ct)},at.setImmediate=function(Ct){typeof Ct!="function"&&(Ct=new Function(""+Ct));for(var j=new Array(arguments.length-1),k=0;k<j.length;k++)j[k]=arguments[k+1];var rt={callback:Ct,args:j};return Y[Z]=rt,w(Z),Z++},at.clearImmediate=J}function J(Ct){delete Y[Ct]}function Q(Ct){if(K)setTimeout(Q,0,Ct);else{var j=Y[Ct];if(j){K=!0;try{(function(k){var rt=k.callback,yt=k.args;switch(yt.length){case 0:rt();break;case 1:rt(yt[0]);break;case 2:rt(yt[0],yt[1]);break;case 3:rt(yt[0],yt[1],yt[2]);break;default:rt.apply(r,yt)}})(j)}finally{J(Ct),K=!1}}}}function lt(Ct){Ct.source===p&&typeof Ct.data=="string"&&Ct.data.indexOf(E)===0&&Q(+Ct.data.slice(E.length))}})(typeof self>"u"?c===void 0?this:c:self)}).call(this,typeof fa<"u"?fa:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ID);const CD=FC;function AD({handleFileContent:t,handleAppSelected:e,namefile:n}){const[o,l]=Jn.useState(null),c=w=>{if(w.target.files){const M=w.target.files[0],N=M.name.endsWith(".kmz");if(M.name.endsWith(".kml"))l(M);else if(N){const Z=new FileReader;Z.onload=async()=>{const q=await(await new CD().loadAsync(Z.result)).file(/\.kml$/i)[0].async("text"),at=new File([q],`${M.name.slice(0,-4)}.kml`,{type:"application/vnd.google-earth.kml+xml"});l(at)},Z.readAsArrayBuffer(M)}else console.error("O arquivo deve ser do tipo KMZ ou KML")}},p=w=>{var M;((M=w.target)==null?void 0:M.result)!==null&&t(w.target.result)};return Ko(bD,{file:!!o,children:[In("img",{src:"https://i.ibb.co/X7y9BBL/image002-5f3f8cb5.png"}),n&&Ko("label",{children:["Envie o arquivo ",n]}),Ko("div",{children:[In("input",{type:"file",onChange:c}),In("section",{children:In("button",{onClick:()=>{if(!o)return;const w=new FileReader;w.onloadend=p,w.readAsText(o)},children:"Enviar"})})]})]})}const TD=wD`

    *{
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Roboto', sans-serif;
        font-weight: 700;
        color: '#000';
    }


    
  
    


`,SD=ch.div`
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    background: ${t=>t.theme.secondary};
    opacity: .8;
    width: 400px;
    height: 100%;
    z-index: 1;
    overflow-x: auto;

    img{
        margin-top: 30px;
    }

    button{
        display: inline-block;
        border: none;
        background-color: ${t=>t.theme.secondary};
        border: 2px solid ${t=>t.theme.primary};
        opacity: .7;
        margin: 20px 50px 20px 50px;
        border-radius: 10px;
        box-shadow: 2px 2px 2px 1px rgba(0, 0, 0, 0.2);
        
        h1{
            padding-top: 10px;
        }

        p{
            padding:10px;
        }
        
    }
    button:hover{
        background-color: ${t=>t.theme.primary};;
        opacity: 1;
    }

`;function ED({handleAppSelected:t}){return Ko(SD,{children:[In("img",{src:"https://i.ibb.co/X7y9BBL/image002-5f3f8cb5.png"}),Ko("button",{onClick:()=>{t("app1")},children:[In("h1",{children:"App1"}),In("p",{children:"Uma ferramenta eficiente para remover múltiplos elementos de arquivos KML sem afetar a estrutura de pastas do seu projeto."})]}),Ko("button",{onClick:()=>{t("app2")},children:[In("h1",{children:"App2"}),In("p",{children:"Ferramenta capaz de remover postes e pontos que não estão sendo utilizados em projetos FTTH, com o objetivo de enviar apenas as informações relevantes para a concessionária."})]}),Ko("button",{onClick:()=>{t("app3")},children:[In("h1",{children:"App3"}),In("p",{children:"Ferramenta oferece uma solução sofisticada para o dimensionamento preciso dos materiais necessários para projetos FTTH, calculando de forma inteligente a localização ideal para ancoragem dos cabos em postes."})]}),Ko("button",{onClick:()=>{t("app4")},children:[In("h1",{children:"App4"}),In("p",{children:"Ferramenta oferece uma solução sofisticada para o dimensionamento preciso dos materiais necessários para projetos FTTH, calculando de forma inteligente a localização ideal para ancoragem dos cabos em postes."})]})]})}function AL(t,e){const n=Jn.useRef(e);Jn.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const MD=1;function LD(t){return Object.freeze({__version:MD,map:t})}function Fx(t,e){return Object.freeze({...t,...e})}const TL=Jn.createContext(null),nA=TL.Provider;function kg(){const t=Jn.useContext(TL);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function SL(t){function e(n,o){const{instance:l,context:c}=t(n).current;return Jn.useImperativeHandle(o,()=>l),n.children==null?null:Aa.createElement(nA,{value:c},n.children)}return Jn.forwardRef(e)}function kD(t){function e(n,o){const[l,c]=Jn.useState(!1),{instance:p}=t(n,c).current;Jn.useImperativeHandle(o,()=>p),Jn.useEffect(function(){l&&p.update()},[p,l,n.children]);const r=p._contentNode;return r?A1.createPortal(n.children,r):null}return Jn.forwardRef(e)}function PD(t){function e(n,o){const{instance:l}=t(n).current;return Jn.useImperativeHandle(o,()=>l),null}return Jn.forwardRef(e)}function zD(t){return function(n){const o=kg(),l=t(n,o),{instance:c}=l.current,p=Jn.useRef(n.position),{position:r}=n;return Jn.useEffect(function(){return c.addTo(o.map),function(){c.remove()}},[o.map,c]),Jn.useEffect(function(){r!=null&&r!==p.current&&(c.setPosition(r),p.current=r)},[c,r]),l}}function iA(t,e){const n=Jn.useRef();Jn.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function jx(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function DD(t,e){return function(o,l){const c=kg(),p=t(jx(o,c),c);return AL(c.map,o.attribution),iA(p.current,o.eventHandlers),e(p.current,c,o,l),p}}var Bc={},ND={get exports(){return Bc},set exports(t){Bc=t}};/* @preserve
 * Leaflet 1.9.3, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2022 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,o){o(e)})(fa,function(n){var o="1.9.3";function l(d){var b,D,H,ut;for(D=1,H=arguments.length;D<H;D++){ut=arguments[D];for(b in ut)d[b]=ut[b]}return d}var c=Object.create||function(){function d(){}return function(b){return d.prototype=b,new d}}();function p(d,b){var D=Array.prototype.slice;if(d.bind)return d.bind.apply(d,D.call(arguments,1));var H=D.call(arguments,2);return function(){return d.apply(b,H.length?H.concat(D.call(arguments)):arguments)}}var r=0;function w(d){return"_leaflet_id"in d||(d._leaflet_id=++r),d._leaflet_id}function M(d,b,D){var H,ut,St,ne;return ne=function(){H=!1,ut&&(St.apply(D,ut),ut=!1)},St=function(){H?ut=arguments:(d.apply(D,arguments),setTimeout(ne,b),H=!0)},St}function N(d,b,D){var H=b[1],ut=b[0],St=H-ut;return d===H&&D?d:((d-ut)%St+St)%St+ut}function E(){return!1}function Z(d,b){if(b===!1)return d;var D=Math.pow(10,b===void 0?6:b);return Math.round(d*D)/D}function Y(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function K(d){return Y(d).split(/\s+/)}function q(d,b){Object.prototype.hasOwnProperty.call(d,"options")||(d.options=d.options?c(d.options):{});for(var D in b)d.options[D]=b[D];return d.options}function at(d,b,D){var H=[];for(var ut in d)H.push(encodeURIComponent(D?ut.toUpperCase():ut)+"="+encodeURIComponent(d[ut]));return(!b||b.indexOf("?")===-1?"?":"&")+H.join("&")}var J=/\{ *([\w_ -]+) *\}/g;function Q(d,b){return d.replace(J,function(D,H){var ut=b[H];if(ut===void 0)throw new Error("No value provided for variable "+D);return typeof ut=="function"&&(ut=ut(b)),ut})}var lt=Array.isArray||function(d){return Object.prototype.toString.call(d)==="[object Array]"};function Ct(d,b){for(var D=0;D<d.length;D++)if(d[D]===b)return D;return-1}var j="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function k(d){return window["webkit"+d]||window["moz"+d]||window["ms"+d]}var rt=0;function yt(d){var b=+new Date,D=Math.max(0,16-(b-rt));return rt=b+D,window.setTimeout(d,D)}var xt=window.requestAnimationFrame||k("RequestAnimationFrame")||yt,kt=window.cancelAnimationFrame||k("CancelAnimationFrame")||k("CancelRequestAnimationFrame")||function(d){window.clearTimeout(d)};function de(d,b,D){if(D&&xt===yt)d.call(b);else return xt.call(window,p(d,b))}function Et(d){d&&kt.call(window,d)}var te={__proto__:null,extend:l,create:c,bind:p,get lastId(){return r},stamp:w,throttle:M,wrapNum:N,falseFn:E,formatNum:Z,trim:Y,splitWords:K,setOptions:q,getParamString:at,template:Q,isArray:lt,indexOf:Ct,emptyImageUrl:j,requestFn:xt,cancelFn:kt,requestAnimFrame:de,cancelAnimFrame:Et};function ht(){}ht.extend=function(d){var b=function(){q(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},D=b.__super__=this.prototype,H=c(D);H.constructor=b,b.prototype=H;for(var ut in this)Object.prototype.hasOwnProperty.call(this,ut)&&ut!=="prototype"&&ut!=="__super__"&&(b[ut]=this[ut]);return d.statics&&l(b,d.statics),d.includes&&(ie(d.includes),l.apply(null,[H].concat(d.includes))),l(H,d),delete H.statics,delete H.includes,H.options&&(H.options=D.options?c(D.options):{},l(H.options,d.options)),H._initHooks=[],H.callInitHooks=function(){if(!this._initHooksCalled){D.callInitHooks&&D.callInitHooks.call(this),this._initHooksCalled=!0;for(var St=0,ne=H._initHooks.length;St<ne;St++)H._initHooks[St].call(this)}},b},ht.include=function(d){var b=this.prototype.options;return l(this.prototype,d),d.options&&(this.prototype.options=b,this.mergeOptions(d.options)),this},ht.mergeOptions=function(d){return l(this.prototype.options,d),this},ht.addInitHook=function(d){var b=Array.prototype.slice.call(arguments,1),D=typeof d=="function"?d:function(){this[d].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(D),this};function ie(d){if(!(typeof L>"u"||!L||!L.Mixin)){d=lt(d)?d:[d];for(var b=0;b<d.length;b++)d[b]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ln={on:function(d,b,D){if(typeof d=="object")for(var H in d)this._on(H,d[H],b);else{d=K(d);for(var ut=0,St=d.length;ut<St;ut++)this._on(d[ut],b,D)}return this},off:function(d,b,D){if(!arguments.length)delete this._events;else if(typeof d=="object")for(var H in d)this._off(H,d[H],b);else{d=K(d);for(var ut=arguments.length===1,St=0,ne=d.length;St<ne;St++)ut?this._off(d[St]):this._off(d[St],b,D)}return this},_on:function(d,b,D,H){if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}if(this._listens(d,b,D)===!1){D===this&&(D=void 0);var ut={fn:b,ctx:D};H&&(ut.once=!0),this._events=this._events||{},this._events[d]=this._events[d]||[],this._events[d].push(ut)}},_off:function(d,b,D){var H,ut,St;if(this._events&&(H=this._events[d],!!H)){if(arguments.length===1){if(this._firingCount)for(ut=0,St=H.length;ut<St;ut++)H[ut].fn=E;delete this._events[d];return}if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}var ne=this._listens(d,b,D);if(ne!==!1){var Ve=H[ne];this._firingCount&&(Ve.fn=E,this._events[d]=H=H.slice()),H.splice(ne,1)}}},fire:function(d,b,D){if(!this.listens(d,D))return this;var H=l({},b,{type:d,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events){var ut=this._events[d];if(ut){this._firingCount=this._firingCount+1||1;for(var St=0,ne=ut.length;St<ne;St++){var Ve=ut[St],sn=Ve.fn;Ve.once&&this.off(d,sn,Ve.ctx),sn.call(Ve.ctx||this,H)}this._firingCount--}}return D&&this._propagateEvent(H),this},listens:function(d,b,D,H){typeof d!="string"&&console.warn('"string" type argument expected');var ut=b;typeof b!="function"&&(H=!!b,ut=void 0,D=void 0);var St=this._events&&this._events[d];if(St&&St.length&&this._listens(d,ut,D)!==!1)return!0;if(H){for(var ne in this._eventParents)if(this._eventParents[ne].listens(d,b,D,H))return!0}return!1},_listens:function(d,b,D){if(!this._events)return!1;var H=this._events[d]||[];if(!b)return!!H.length;D===this&&(D=void 0);for(var ut=0,St=H.length;ut<St;ut++)if(H[ut].fn===b&&H[ut].ctx===D)return ut;return!1},once:function(d,b,D){if(typeof d=="object")for(var H in d)this._on(H,d[H],b,!0);else{d=K(d);for(var ut=0,St=d.length;ut<St;ut++)this._on(d[ut],b,D,!0)}return this},addEventParent:function(d){return this._eventParents=this._eventParents||{},this._eventParents[w(d)]=d,this},removeEventParent:function(d){return this._eventParents&&delete this._eventParents[w(d)],this},_propagateEvent:function(d){for(var b in this._eventParents)this._eventParents[b].fire(d.type,l({layer:d.target,propagatedFrom:d.target},d),!0)}};ln.addEventListener=ln.on,ln.removeEventListener=ln.clearAllEventListeners=ln.off,ln.addOneTimeEventListener=ln.once,ln.fireEvent=ln.fire,ln.hasEventListeners=ln.listens;var Le=ht.extend(ln);function _e(d,b,D){this.x=D?Math.round(d):d,this.y=D?Math.round(b):b}var Me=Math.trunc||function(d){return d>0?Math.floor(d):Math.ceil(d)};_e.prototype={clone:function(){return new _e(this.x,this.y)},add:function(d){return this.clone()._add(be(d))},_add:function(d){return this.x+=d.x,this.y+=d.y,this},subtract:function(d){return this.clone()._subtract(be(d))},_subtract:function(d){return this.x-=d.x,this.y-=d.y,this},divideBy:function(d){return this.clone()._divideBy(d)},_divideBy:function(d){return this.x/=d,this.y/=d,this},multiplyBy:function(d){return this.clone()._multiplyBy(d)},_multiplyBy:function(d){return this.x*=d,this.y*=d,this},scaleBy:function(d){return new _e(this.x*d.x,this.y*d.y)},unscaleBy:function(d){return new _e(this.x/d.x,this.y/d.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Me(this.x),this.y=Me(this.y),this},distanceTo:function(d){d=be(d);var b=d.x-this.x,D=d.y-this.y;return Math.sqrt(b*b+D*D)},equals:function(d){return d=be(d),d.x===this.x&&d.y===this.y},contains:function(d){return d=be(d),Math.abs(d.x)<=Math.abs(this.x)&&Math.abs(d.y)<=Math.abs(this.y)},toString:function(){return"Point("+Z(this.x)+", "+Z(this.y)+")"}};function be(d,b,D){return d instanceof _e?d:lt(d)?new _e(d[0],d[1]):d==null?d:typeof d=="object"&&"x"in d&&"y"in d?new _e(d.x,d.y):new _e(d,b,D)}function ue(d,b){if(d)for(var D=b?[d,b]:d,H=0,ut=D.length;H<ut;H++)this.extend(D[H])}ue.prototype={extend:function(d){var b,D;if(!d)return this;if(d instanceof _e||typeof d[0]=="number"||"x"in d)b=D=be(d);else if(d=Yt(d),b=d.min,D=d.max,!b||!D)return this;return!this.min&&!this.max?(this.min=b.clone(),this.max=D.clone()):(this.min.x=Math.min(b.x,this.min.x),this.max.x=Math.max(D.x,this.max.x),this.min.y=Math.min(b.y,this.min.y),this.max.y=Math.max(D.y,this.max.y)),this},getCenter:function(d){return be((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,d)},getBottomLeft:function(){return be(this.min.x,this.max.y)},getTopRight:function(){return be(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(d){var b,D;return typeof d[0]=="number"||d instanceof _e?d=be(d):d=Yt(d),d instanceof ue?(b=d.min,D=d.max):b=D=d,b.x>=this.min.x&&D.x<=this.max.x&&b.y>=this.min.y&&D.y<=this.max.y},intersects:function(d){d=Yt(d);var b=this.min,D=this.max,H=d.min,ut=d.max,St=ut.x>=b.x&&H.x<=D.x,ne=ut.y>=b.y&&H.y<=D.y;return St&&ne},overlaps:function(d){d=Yt(d);var b=this.min,D=this.max,H=d.min,ut=d.max,St=ut.x>b.x&&H.x<D.x,ne=ut.y>b.y&&H.y<D.y;return St&&ne},isValid:function(){return!!(this.min&&this.max)},pad:function(d){var b=this.min,D=this.max,H=Math.abs(b.x-D.x)*d,ut=Math.abs(b.y-D.y)*d;return Yt(be(b.x-H,b.y-ut),be(D.x+H,D.y+ut))},equals:function(d){return d?(d=Yt(d),this.min.equals(d.getTopLeft())&&this.max.equals(d.getBottomRight())):!1}};function Yt(d,b){return!d||d instanceof ue?d:new ue(d,b)}function Ee(d,b){if(d)for(var D=b?[d,b]:d,H=0,ut=D.length;H<ut;H++)this.extend(D[H])}Ee.prototype={extend:function(d){var b=this._southWest,D=this._northEast,H,ut;if(d instanceof ye)H=d,ut=d;else if(d instanceof Ee){if(H=d._southWest,ut=d._northEast,!H||!ut)return this}else return d?this.extend(fe(d)||ve(d)):this;return!b&&!D?(this._southWest=new ye(H.lat,H.lng),this._northEast=new ye(ut.lat,ut.lng)):(b.lat=Math.min(H.lat,b.lat),b.lng=Math.min(H.lng,b.lng),D.lat=Math.max(ut.lat,D.lat),D.lng=Math.max(ut.lng,D.lng)),this},pad:function(d){var b=this._southWest,D=this._northEast,H=Math.abs(b.lat-D.lat)*d,ut=Math.abs(b.lng-D.lng)*d;return new Ee(new ye(b.lat-H,b.lng-ut),new ye(D.lat+H,D.lng+ut))},getCenter:function(){return new ye((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ye(this.getNorth(),this.getWest())},getSouthEast:function(){return new ye(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(d){typeof d[0]=="number"||d instanceof ye||"lat"in d?d=fe(d):d=ve(d);var b=this._southWest,D=this._northEast,H,ut;return d instanceof Ee?(H=d.getSouthWest(),ut=d.getNorthEast()):H=ut=d,H.lat>=b.lat&&ut.lat<=D.lat&&H.lng>=b.lng&&ut.lng<=D.lng},intersects:function(d){d=ve(d);var b=this._southWest,D=this._northEast,H=d.getSouthWest(),ut=d.getNorthEast(),St=ut.lat>=b.lat&&H.lat<=D.lat,ne=ut.lng>=b.lng&&H.lng<=D.lng;return St&&ne},overlaps:function(d){d=ve(d);var b=this._southWest,D=this._northEast,H=d.getSouthWest(),ut=d.getNorthEast(),St=ut.lat>b.lat&&H.lat<D.lat,ne=ut.lng>b.lng&&H.lng<D.lng;return St&&ne},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(d,b){return d?(d=ve(d),this._southWest.equals(d.getSouthWest(),b)&&this._northEast.equals(d.getNorthEast(),b)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ve(d,b){return d instanceof Ee?d:new Ee(d,b)}function ye(d,b,D){if(isNaN(d)||isNaN(b))throw new Error("Invalid LatLng object: ("+d+", "+b+")");this.lat=+d,this.lng=+b,D!==void 0&&(this.alt=+D)}ye.prototype={equals:function(d,b){if(!d)return!1;d=fe(d);var D=Math.max(Math.abs(this.lat-d.lat),Math.abs(this.lng-d.lng));return D<=(b===void 0?1e-9:b)},toString:function(d){return"LatLng("+Z(this.lat,d)+", "+Z(this.lng,d)+")"},distanceTo:function(d){return Ue.distance(this,fe(d))},wrap:function(){return Ue.wrapLatLng(this)},toBounds:function(d){var b=180*d/40075017,D=b/Math.cos(Math.PI/180*this.lat);return ve([this.lat-b,this.lng-D],[this.lat+b,this.lng+D])},clone:function(){return new ye(this.lat,this.lng,this.alt)}};function fe(d,b,D){return d instanceof ye?d:lt(d)&&typeof d[0]!="object"?d.length===3?new ye(d[0],d[1],d[2]):d.length===2?new ye(d[0],d[1]):null:d==null?d:typeof d=="object"&&"lat"in d?new ye(d.lat,"lng"in d?d.lng:d.lon,d.alt):b===void 0?null:new ye(d,b,D)}var mn={latLngToPoint:function(d,b){var D=this.projection.project(d),H=this.scale(b);return this.transformation._transform(D,H)},pointToLatLng:function(d,b){var D=this.scale(b),H=this.transformation.untransform(d,D);return this.projection.unproject(H)},project:function(d){return this.projection.project(d)},unproject:function(d){return this.projection.unproject(d)},scale:function(d){return 256*Math.pow(2,d)},zoom:function(d){return Math.log(d/256)/Math.LN2},getProjectedBounds:function(d){if(this.infinite)return null;var b=this.projection.bounds,D=this.scale(d),H=this.transformation.transform(b.min,D),ut=this.transformation.transform(b.max,D);return new ue(H,ut)},infinite:!1,wrapLatLng:function(d){var b=this.wrapLng?N(d.lng,this.wrapLng,!0):d.lng,D=this.wrapLat?N(d.lat,this.wrapLat,!0):d.lat,H=d.alt;return new ye(D,b,H)},wrapLatLngBounds:function(d){var b=d.getCenter(),D=this.wrapLatLng(b),H=b.lat-D.lat,ut=b.lng-D.lng;if(H===0&&ut===0)return d;var St=d.getSouthWest(),ne=d.getNorthEast(),Ve=new ye(St.lat-H,St.lng-ut),sn=new ye(ne.lat-H,ne.lng-ut);return new Ee(Ve,sn)}},Ue=l({},mn,{wrapLng:[-180,180],R:6371e3,distance:function(d,b){var D=Math.PI/180,H=d.lat*D,ut=b.lat*D,St=Math.sin((b.lat-d.lat)*D/2),ne=Math.sin((b.lng-d.lng)*D/2),Ve=St*St+Math.cos(H)*Math.cos(ut)*ne*ne,sn=2*Math.atan2(Math.sqrt(Ve),Math.sqrt(1-Ve));return this.R*sn}}),Cn=6378137,Bn={R:Cn,MAX_LATITUDE:85.0511287798,project:function(d){var b=Math.PI/180,D=this.MAX_LATITUDE,H=Math.max(Math.min(D,d.lat),-D),ut=Math.sin(H*b);return new _e(this.R*d.lng*b,this.R*Math.log((1+ut)/(1-ut))/2)},unproject:function(d){var b=180/Math.PI;return new ye((2*Math.atan(Math.exp(d.y/this.R))-Math.PI/2)*b,d.x*b/this.R)},bounds:function(){var d=Cn*Math.PI;return new ue([-d,-d],[d,d])}()};function Pn(d,b,D,H){if(lt(d)){this._a=d[0],this._b=d[1],this._c=d[2],this._d=d[3];return}this._a=d,this._b=b,this._c=D,this._d=H}Pn.prototype={transform:function(d,b){return this._transform(d.clone(),b)},_transform:function(d,b){return b=b||1,d.x=b*(this._a*d.x+this._b),d.y=b*(this._c*d.y+this._d),d},untransform:function(d,b){return b=b||1,new _e((d.x/b-this._b)/this._a,(d.y/b-this._d)/this._c)}};function cn(d,b,D,H){return new Pn(d,b,D,H)}var Un=l({},Ue,{code:"EPSG:3857",projection:Bn,transformation:function(){var d=.5/(Math.PI*Bn.R);return cn(d,.5,-d,.5)}()}),R=l({},Un,{code:"EPSG:900913"});function st(d){return document.createElementNS("http://www.w3.org/2000/svg",d)}function gt(d,b){var D="",H,ut,St,ne,Ve,sn;for(H=0,St=d.length;H<St;H++){for(Ve=d[H],ut=0,ne=Ve.length;ut<ne;ut++)sn=Ve[ut],D+=(ut?"L":"M")+sn.x+" "+sn.y;D+=b?Ht.svg?"z":"x":""}return D||"M0 0"}var dt=document.documentElement.style,wt="ActiveXObject"in window,Zt=wt&&!document.addEventListener,we="msLaunchUri"in navigator&&!("documentMode"in document),We=qt("webkit"),pe=qt("android"),un=qt("android 2")||qt("android 3"),Ye=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ge=pe&&qt("Google")&&Ye<537&&!("AudioNode"in window),Gn=!!window.opera,_i=!we&&qt("chrome"),ui=qt("gecko")&&!We&&!Gn&&!wt,ji=!_i&&qt("safari"),Hi=qt("phantom"),vr="OTransition"in dt,Jr=navigator.platform.indexOf("Win")===0,$i=wt&&"transition"in dt,uo="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!un,Go="MozPerspective"in dt,Ir=!window.L_DISABLE_3D&&($i||uo||Go)&&!vr&&!Hi,Ar=typeof orientation<"u"||qt("mobile"),Ro=Ar&&We,Qo=Ar&&uo,_s=!window.PointerEvent&&window.MSPointerEvent,bo=!!(window.PointerEvent||_s),co="ontouchstart"in window||!!window.TouchEvent,io=!window.L_NO_TOUCH&&(co||bo),Ta=Ar&&Gn,Wa=Ar&&ui,Sa=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ts=function(){var d=!1;try{var b=Object.defineProperty({},"passive",{get:function(){d=!0}});window.addEventListener("testPassiveEventSupport",E,b),window.removeEventListener("testPassiveEventSupport",E,b)}catch{}return d}(),js=function(){return!!document.createElement("canvas").getContext}(),Ea=!!(document.createElementNS&&st("svg").createSVGRect),Vt=!!Ea&&function(){var d=document.createElement("div");return d.innerHTML="<svg/>",(d.firstChild&&d.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),pt=!Ea&&function(){try{var d=document.createElement("div");d.innerHTML='<v:shape adj="1"/>';var b=d.firstChild;return b.style.behavior="url(#default#VML)",b&&typeof b.adj=="object"}catch{return!1}}(),It=navigator.platform.indexOf("Mac")===0,Ut=navigator.platform.indexOf("Linux")===0;function qt(d){return navigator.userAgent.toLowerCase().indexOf(d)>=0}var Ht={ie:wt,ielt9:Zt,edge:we,webkit:We,android:pe,android23:un,androidStock:Ge,opera:Gn,chrome:_i,gecko:ui,safari:ji,phantom:Hi,opera12:vr,win:Jr,ie3d:$i,webkit3d:uo,gecko3d:Go,any3d:Ir,mobile:Ar,mobileWebkit:Ro,mobileWebkit3d:Qo,msPointer:_s,pointer:bo,touch:io,touchNative:co,mobileOpera:Ta,mobileGecko:Wa,retina:Sa,passiveEvents:ts,canvas:js,svg:Ea,vml:pt,inlineSvg:Vt,mac:It,linux:Ut},Pe=Ht.msPointer?"MSPointerDown":"pointerdown",Se=Ht.msPointer?"MSPointerMove":"pointermove",xe=Ht.msPointer?"MSPointerUp":"pointerup",Re=Ht.msPointer?"MSPointerCancel":"pointercancel",hn={touchstart:Pe,touchmove:Se,touchend:xe,touchcancel:Re},Zn={touchstart:xr,touchmove:yr,touchend:yr,touchcancel:yr},bn={},ci=!1;function hi(d,b,D){return b==="touchstart"&&ti(),Zn[b]?(D=Zn[b].bind(this,D),d.addEventListener(hn[b],D,!1),D):(console.warn("wrong event specified:",b),E)}function Qn(d,b,D){if(!hn[b]){console.warn("wrong event specified:",b);return}d.removeEventListener(hn[b],D,!1)}function pi(d){bn[d.pointerId]=d}function qi(d){bn[d.pointerId]&&(bn[d.pointerId]=d)}function ur(d){delete bn[d.pointerId]}function ti(){ci||(document.addEventListener(Pe,pi,!0),document.addEventListener(Se,qi,!0),document.addEventListener(xe,ur,!0),document.addEventListener(Re,ur,!0),ci=!0)}function yr(d,b){if(b.pointerType!==(b.MSPOINTER_TYPE_MOUSE||"mouse")){b.touches=[];for(var D in bn)b.touches.push(bn[D]);b.changedTouches=[b],d(b)}}function xr(d,b){b.MSPOINTER_TYPE_TOUCH&&b.pointerType===b.MSPOINTER_TYPE_TOUCH&&Ei(b),yr(d,b)}function Js(d){var b={},D,H;for(H in d)D=d[H],b[H]=D&&D.bind?D.bind(d):D;return d=b,b.type="dblclick",b.detail=2,b.isTrusted=!1,b._simulated=!0,b}var Ss=200;function vs(d,b){d.addEventListener("dblclick",b);var D=0,H;function ut(St){if(St.detail!==1){H=St.detail;return}if(!(St.pointerType==="mouse"||St.sourceCapabilities&&!St.sourceCapabilities.firesTouchEvents)){var ne=pl(St);if(!(ne.some(function(sn){return sn instanceof HTMLLabelElement&&sn.attributes.for})&&!ne.some(function(sn){return sn instanceof HTMLInputElement||sn instanceof HTMLSelectElement}))){var Ve=Date.now();Ve-D<=Ss?(H++,H===2&&b(Js(St))):H=1,D=Ve}}}return d.addEventListener("click",ut),{dblclick:b,simDblclick:ut}}function Ke(d,b){d.removeEventListener("dblclick",b.dblclick),d.removeEventListener("click",b.simDblclick)}var Po=Nr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Xr=Nr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ro=Xr==="webkitTransition"||Xr==="OTransition"?Xr+"End":"transitionend";function hl(d){return typeof d=="string"?document.getElementById(d):d}function Io(d,b){var D=d.style[b]||d.currentStyle&&d.currentStyle[b];if((!D||D==="auto")&&document.defaultView){var H=document.defaultView.getComputedStyle(d,null);D=H?H[b]:null}return D==="auto"?null:D}function cr(d,b,D){var H=document.createElement(d);return H.className=b||"",D&&D.appendChild(H),H}function Kr(d){var b=d.parentNode;b&&b.removeChild(d)}function Co(d){for(;d.firstChild;)d.removeChild(d.firstChild)}function jn(d){var b=d.parentNode;b&&b.lastChild!==d&&b.appendChild(d)}function Ti(d){var b=d.parentNode;b&&b.firstChild!==d&&b.insertBefore(d,b.firstChild)}function Oi(d,b){if(d.classList!==void 0)return d.classList.contains(b);var D=Ma(d);return D.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(D)}function Si(d,b){if(d.classList!==void 0)for(var D=K(b),H=0,ut=D.length;H<ut;H++)d.classList.add(D[H]);else if(!Oi(d,b)){var St=Ma(d);vi(d,(St?St+" ":"")+b)}}function Tr(d,b){d.classList!==void 0?d.classList.remove(b):vi(d,Y((" "+Ma(d)+" ").replace(" "+b+" "," ")))}function vi(d,b){d.className.baseVal===void 0?d.className=b:d.className.baseVal=b}function Ma(d){return d.correspondingElement&&(d=d.correspondingElement),d.className.baseVal===void 0?d.className:d.className.baseVal}function oo(d,b){"opacity"in d.style?d.style.opacity=b:"filter"in d.style&&Yo(d,b)}function Yo(d,b){var D=!1,H="DXImageTransform.Microsoft.Alpha";try{D=d.filters.item(H)}catch{if(b===1)return}b=Math.round(b*100),D?(D.Enabled=b!==100,D.Opacity=b):d.style.filter+=" progid:"+H+"(opacity="+b+")"}function Nr(d){for(var b=document.documentElement.style,D=0;D<d.length;D++)if(d[D]in b)return d[D];return!1}function nr(d,b,D){var H=b||new _e(0,0);d.style[Po]=(Ht.ie3d?"translate("+H.x+"px,"+H.y+"px)":"translate3d("+H.x+"px,"+H.y+"px,0)")+(D?" scale("+D+")":"")}function ir(d,b){d._leaflet_pos=b,Ht.any3d?nr(d,b):(d.style.left=b.x+"px",d.style.top=b.y+"px")}function es(d){return d._leaflet_pos||new _e(0,0)}var ns,is,da;if("onselectstart"in document)ns=function(){wi(window,"selectstart",Ei)},is=function(){zr(window,"selectstart",Ei)};else{var zo=Nr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ns=function(){if(zo){var d=document.documentElement.style;da=d[zo],d[zo]="none"}},is=function(){zo&&(document.documentElement.style[zo]=da,da=void 0)}}function Ks(){wi(window,"dragstart",Ei)}function Us(){zr(window,"dragstart",Ei)}var La,fl;function Zo(d){for(;d.tabIndex===-1;)d=d.parentNode;d.style&&(Zr(),La=d,fl=d.style.outline,d.style.outline="none",wi(window,"keydown",Zr))}function Zr(){La&&(La.style.outline=fl,La=void 0,fl=void 0,zr(window,"keydown",Zr))}function Qs(d){do d=d.parentNode;while((!d.offsetWidth||!d.offsetHeight)&&d!==document.body);return d}function Hl(d){var b=d.getBoundingClientRect();return{x:b.width/d.offsetWidth||1,y:b.height/d.offsetHeight||1,boundingClientRect:b}}var Vo={__proto__:null,TRANSFORM:Po,TRANSITION:Xr,TRANSITION_END:ro,get:hl,getStyle:Io,create:cr,remove:Kr,empty:Co,toFront:jn,toBack:Ti,hasClass:Oi,addClass:Si,removeClass:Tr,setClass:vi,getClass:Ma,setOpacity:oo,testProp:Nr,setTransform:nr,setPosition:ir,getPosition:es,get disableTextSelection(){return ns},get enableTextSelection(){return is},disableImageDrag:Ks,enableImageDrag:Us,preventOutline:Zo,restoreOutline:Zr,getSizedParentNode:Qs,getScale:Hl};function wi(d,b,D,H){if(b&&typeof b=="object")for(var ut in b)dl(d,ut,b[ut],D);else{b=K(b);for(var St=0,ne=b.length;St<ne;St++)dl(d,b[St],D,H)}return this}var ta="_leaflet_events";function zr(d,b,D,H){if(arguments.length===1)Ao(d),delete d[ta];else if(b&&typeof b=="object")for(var ut in b)ea(d,ut,b[ut],D);else if(b=K(b),arguments.length===2)Ao(d,function(Ve){return Ct(b,Ve)!==-1});else for(var St=0,ne=b.length;St<ne;St++)ea(d,b[St],D,H);return this}function Ao(d,b){for(var D in d[ta]){var H=D.split(/\d/)[0];(!b||b(H))&&ea(d,H,null,null,D)}}var ka={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function dl(d,b,D,H){var ut=b+w(D)+(H?"_"+w(H):"");if(d[ta]&&d[ta][ut])return this;var St=function(Ve){return D.call(H||d,Ve||window.event)},ne=St;!Ht.touchNative&&Ht.pointer&&b.indexOf("touch")===0?St=hi(d,b,St):Ht.touch&&b==="dblclick"?St=vs(d,St):"addEventListener"in d?b==="touchstart"||b==="touchmove"||b==="wheel"||b==="mousewheel"?d.addEventListener(ka[b]||b,St,Ht.passiveEvents?{passive:!1}:!1):b==="mouseenter"||b==="mouseleave"?(St=function(Ve){Ve=Ve||window.event,Pa(d,Ve)&&ne(Ve)},d.addEventListener(ka[b],St,!1)):d.addEventListener(b,ne,!1):d.attachEvent("on"+b,St),d[ta]=d[ta]||{},d[ta][ut]=St}function ea(d,b,D,H,ut){ut=ut||b+w(D)+(H?"_"+w(H):"");var St=d[ta]&&d[ta][ut];if(!St)return this;!Ht.touchNative&&Ht.pointer&&b.indexOf("touch")===0?Qn(d,b,St):Ht.touch&&b==="dblclick"?Ke(d,St):"removeEventListener"in d?d.removeEventListener(ka[b]||b,St,!1):d.detachEvent("on"+b,St),d[ta][ut]=null}function Or(d){return d.stopPropagation?d.stopPropagation():d.originalEvent?d.originalEvent._stopped=!0:d.cancelBubble=!0,this}function na(d){return dl(d,"wheel",Or),this}function Ya(d){return wi(d,"mousedown touchstart dblclick contextmenu",Or),d._leaflet_disable_click=!0,this}function Ei(d){return d.preventDefault?d.preventDefault():d.returnValue=!1,this}function rr(d){return Ei(d),Or(d),this}function pl(d){if(d.composedPath)return d.composedPath();for(var b=[],D=d.target;D;)b.push(D),D=D.parentNode;return b}function pc(d,b){if(!b)return new _e(d.clientX,d.clientY);var D=Hl(b),H=D.boundingClientRect;return new _e((d.clientX-H.left)/D.x-b.clientLeft,(d.clientY-H.top)/D.y-b.clientTop)}var $l=Ht.linux&&Ht.chrome?window.devicePixelRatio:Ht.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Es(d){return Ht.edge?d.wheelDeltaY/2:d.deltaY&&d.deltaMode===0?-d.deltaY/$l:d.deltaY&&d.deltaMode===1?-d.deltaY*20:d.deltaY&&d.deltaMode===2?-d.deltaY*60:d.deltaX||d.deltaZ?0:d.wheelDelta?(d.wheelDeltaY||d.wheelDelta)/2:d.detail&&Math.abs(d.detail)<32765?-d.detail*20:d.detail?d.detail/-32765*60:0}function Pa(d,b){var D=b.relatedTarget;if(!D)return!0;try{for(;D&&D!==d;)D=D.parentNode}catch{return!1}return D!==d}var vt={__proto__:null,on:wi,off:zr,stopPropagation:Or,disableScrollPropagation:na,disableClickPropagation:Ya,preventDefault:Ei,stop:rr,getPropagationPath:pl,getMousePosition:pc,getWheelDelta:Es,isExternalTarget:Pa,addListener:wi,removeListener:zr},Lt=Le.extend({run:function(d,b,D,H){this.stop(),this._el=d,this._inProgress=!0,this._duration=D||.25,this._easeOutPower=1/Math.max(H||.5,.2),this._startPos=es(d),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=de(this._animate,this),this._step()},_step:function(d){var b=+new Date-this._startTime,D=this._duration*1e3;b<D?this._runFrame(this._easeOut(b/D),d):(this._runFrame(1),this._complete())},_runFrame:function(d,b){var D=this._startPos.add(this._offset.multiplyBy(d));b&&D._round(),ir(this._el,D),this.fire("step")},_complete:function(){Et(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(d){return 1-Math.pow(1-d,this._easeOutPower)}}),$t=Le.extend({options:{crs:Un,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(d,b){b=q(this,b),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(d),this._initLayout(),this._onResize=p(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.zoom!==void 0&&(this._zoom=this._limitZoom(b.zoom)),b.center&&b.zoom!==void 0&&this.setView(fe(b.center),b.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Xr&&Ht.any3d&&!Ht.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),wi(this._proxy,ro,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(d,b,D){if(b=b===void 0?this._zoom:this._limitZoom(b),d=this._limitCenter(fe(d),b,this.options.maxBounds),D=D||{},this._stop(),this._loaded&&!D.reset&&D!==!0){D.animate!==void 0&&(D.zoom=l({animate:D.animate},D.zoom),D.pan=l({animate:D.animate,duration:D.duration},D.pan));var H=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(d,b,D.zoom):this._tryAnimatedPan(d,D.pan);if(H)return clearTimeout(this._sizeTimer),this}return this._resetView(d,b,D.pan&&D.pan.noMoveStart),this},setZoom:function(d,b){return this._loaded?this.setView(this.getCenter(),d,{zoom:b}):(this._zoom=d,this)},zoomIn:function(d,b){return d=d||(Ht.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+d,b)},zoomOut:function(d,b){return d=d||(Ht.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-d,b)},setZoomAround:function(d,b,D){var H=this.getZoomScale(b),ut=this.getSize().divideBy(2),St=d instanceof _e?d:this.latLngToContainerPoint(d),ne=St.subtract(ut).multiplyBy(1-1/H),Ve=this.containerPointToLatLng(ut.add(ne));return this.setView(Ve,b,{zoom:D})},_getBoundsCenterZoom:function(d,b){b=b||{},d=d.getBounds?d.getBounds():ve(d);var D=be(b.paddingTopLeft||b.padding||[0,0]),H=be(b.paddingBottomRight||b.padding||[0,0]),ut=this.getBoundsZoom(d,!1,D.add(H));if(ut=typeof b.maxZoom=="number"?Math.min(b.maxZoom,ut):ut,ut===1/0)return{center:d.getCenter(),zoom:ut};var St=H.subtract(D).divideBy(2),ne=this.project(d.getSouthWest(),ut),Ve=this.project(d.getNorthEast(),ut),sn=this.unproject(ne.add(Ve).divideBy(2).add(St),ut);return{center:sn,zoom:ut}},fitBounds:function(d,b){if(d=ve(d),!d.isValid())throw new Error("Bounds are not valid.");var D=this._getBoundsCenterZoom(d,b);return this.setView(D.center,D.zoom,b)},fitWorld:function(d){return this.fitBounds([[-90,-180],[90,180]],d)},panTo:function(d,b){return this.setView(d,this._zoom,{pan:b})},panBy:function(d,b){if(d=be(d).round(),b=b||{},!d.x&&!d.y)return this.fire("moveend");if(b.animate!==!0&&!this.getSize().contains(d))return this._resetView(this.unproject(this.project(this.getCenter()).add(d)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Lt,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){Si(this._mapPane,"leaflet-pan-anim");var D=this._getMapPanePos().subtract(d).round();this._panAnim.run(this._mapPane,D,b.duration||.25,b.easeLinearity)}else this._rawPanBy(d),this.fire("move").fire("moveend");return this},flyTo:function(d,b,D){if(D=D||{},D.animate===!1||!Ht.any3d)return this.setView(d,b,D);this._stop();var H=this.project(this.getCenter()),ut=this.project(d),St=this.getSize(),ne=this._zoom;d=fe(d),b=b===void 0?ne:b;var Ve=Math.max(St.x,St.y),sn=Ve*this.getZoomScale(ne,b),On=ut.distanceTo(H)||1,ii=1.42,Zi=ii*ii;function Qi(Lo){var eu=Lo?-1:1,Uh=Lo?sn:Ve,Dt=sn*sn-Ve*Ve+eu*Zi*Zi*On*On,nu=2*Uh*Zi*On,Hu=Dt/nu,_a=Math.sqrt(Hu*Hu+1)-Hu,Ni=_a<1e-9?-18:Math.log(_a);return Ni}function Ys(Lo){return(Math.exp(Lo)-Math.exp(-Lo))/2}function ra(Lo){return(Math.exp(Lo)+Math.exp(-Lo))/2}function tu(Lo){return Ys(Lo)/ra(Lo)}var oa=Qi(0);function zl(Lo){return Ve*(ra(oa)/ra(oa+ii*Lo))}function Xu(Lo){return Ve*(ra(oa)*tu(oa+ii*Lo)-Ys(oa))/Zi}function Bh(Lo){return 1-Math.pow(1-Lo,1.5)}var Fh=Date.now(),jh=(Qi(1)-oa)/ii,fh=D.duration?1e3*D.duration:1e3*jh*.8;function Dl(){var Lo=(Date.now()-Fh)/fh,eu=Bh(Lo)*jh;Lo<=1?(this._flyToFrame=de(Dl,this),this._move(this.unproject(H.add(ut.subtract(H).multiplyBy(Xu(eu)/On)),ne),this.getScaleZoom(Ve/zl(eu),ne),{flyTo:!0})):this._move(d,b)._moveEnd(!0)}return this._moveStart(!0,D.noMoveStart),Dl.call(this),this},flyToBounds:function(d,b){var D=this._getBoundsCenterZoom(d,b);return this.flyTo(D.center,D.zoom,b)},setMaxBounds:function(d){return d=ve(d),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),d.isValid()?(this.options.maxBounds=d,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(d){var b=this.options.minZoom;return this.options.minZoom=d,this._loaded&&b!==d&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(d):this},setMaxZoom:function(d){var b=this.options.maxZoom;return this.options.maxZoom=d,this._loaded&&b!==d&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(d):this},panInsideBounds:function(d,b){this._enforcingBounds=!0;var D=this.getCenter(),H=this._limitCenter(D,this._zoom,ve(d));return D.equals(H)||this.panTo(H,b),this._enforcingBounds=!1,this},panInside:function(d,b){b=b||{};var D=be(b.paddingTopLeft||b.padding||[0,0]),H=be(b.paddingBottomRight||b.padding||[0,0]),ut=this.project(this.getCenter()),St=this.project(d),ne=this.getPixelBounds(),Ve=Yt([ne.min.add(D),ne.max.subtract(H)]),sn=Ve.getSize();if(!Ve.contains(St)){this._enforcingBounds=!0;var On=St.subtract(Ve.getCenter()),ii=Ve.extend(St).getSize().subtract(sn);ut.x+=On.x<0?-ii.x:ii.x,ut.y+=On.y<0?-ii.y:ii.y,this.panTo(this.unproject(ut),b),this._enforcingBounds=!1}return this},invalidateSize:function(d){if(!this._loaded)return this;d=l({animate:!1,pan:!0},d===!0?{animate:!0}:d);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var D=this.getSize(),H=b.divideBy(2).round(),ut=D.divideBy(2).round(),St=H.subtract(ut);return!St.x&&!St.y?this:(d.animate&&d.pan?this.panBy(St):(d.pan&&this._rawPanBy(St),this.fire("move"),d.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(p(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:D}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(d){if(d=this._locateOptions=l({timeout:1e4,watch:!1},d),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=p(this._handleGeolocationResponse,this),D=p(this._handleGeolocationError,this);return d.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,D,d):navigator.geolocation.getCurrentPosition(b,D,d),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(d){if(this._container._leaflet_id){var b=d.code,D=d.message||(b===1?"permission denied":b===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+D+"."})}},_handleGeolocationResponse:function(d){if(this._container._leaflet_id){var b=d.coords.latitude,D=d.coords.longitude,H=new ye(b,D),ut=H.toBounds(d.coords.accuracy*2),St=this._locateOptions;if(St.setView){var ne=this.getBoundsZoom(ut);this.setView(H,St.maxZoom?Math.min(ne,St.maxZoom):ne)}var Ve={latlng:H,bounds:ut,timestamp:d.timestamp};for(var sn in d.coords)typeof d.coords[sn]=="number"&&(Ve[sn]=d.coords[sn]);this.fire("locationfound",Ve)}},addHandler:function(d,b){if(!b)return this;var D=this[d]=new b(this);return this._handlers.push(D),this.options[d]&&D.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Kr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Et(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var d;for(d in this._layers)this._layers[d].remove();for(d in this._panes)Kr(this._panes[d]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(d,b){var D="leaflet-pane"+(d?" leaflet-"+d.replace("Pane","")+"-pane":""),H=cr("div",D,b||this._mapPane);return d&&(this._panes[d]=H),H},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var d=this.getPixelBounds(),b=this.unproject(d.getBottomLeft()),D=this.unproject(d.getTopRight());return new Ee(b,D)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(d,b,D){d=ve(d),D=be(D||[0,0]);var H=this.getZoom()||0,ut=this.getMinZoom(),St=this.getMaxZoom(),ne=d.getNorthWest(),Ve=d.getSouthEast(),sn=this.getSize().subtract(D),On=Yt(this.project(Ve,H),this.project(ne,H)).getSize(),ii=Ht.any3d?this.options.zoomSnap:1,Zi=sn.x/On.x,Qi=sn.y/On.y,Ys=b?Math.max(Zi,Qi):Math.min(Zi,Qi);return H=this.getScaleZoom(Ys,H),ii&&(H=Math.round(H/(ii/100))*(ii/100),H=b?Math.ceil(H/ii)*ii:Math.floor(H/ii)*ii),Math.max(ut,Math.min(St,H))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new _e(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(d,b){var D=this._getTopLeftPoint(d,b);return new ue(D,D.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(d){return this.options.crs.getProjectedBounds(d===void 0?this.getZoom():d)},getPane:function(d){return typeof d=="string"?this._panes[d]:d},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(d,b){var D=this.options.crs;return b=b===void 0?this._zoom:b,D.scale(d)/D.scale(b)},getScaleZoom:function(d,b){var D=this.options.crs;b=b===void 0?this._zoom:b;var H=D.zoom(d*D.scale(b));return isNaN(H)?1/0:H},project:function(d,b){return b=b===void 0?this._zoom:b,this.options.crs.latLngToPoint(fe(d),b)},unproject:function(d,b){return b=b===void 0?this._zoom:b,this.options.crs.pointToLatLng(be(d),b)},layerPointToLatLng:function(d){var b=be(d).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(d){var b=this.project(fe(d))._round();return b._subtract(this.getPixelOrigin())},wrapLatLng:function(d){return this.options.crs.wrapLatLng(fe(d))},wrapLatLngBounds:function(d){return this.options.crs.wrapLatLngBounds(ve(d))},distance:function(d,b){return this.options.crs.distance(fe(d),fe(b))},containerPointToLayerPoint:function(d){return be(d).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(d){return be(d).add(this._getMapPanePos())},containerPointToLatLng:function(d){var b=this.containerPointToLayerPoint(be(d));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(d){return this.layerPointToContainerPoint(this.latLngToLayerPoint(fe(d)))},mouseEventToContainerPoint:function(d){return pc(d,this._container)},mouseEventToLayerPoint:function(d){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(d))},mouseEventToLatLng:function(d){return this.layerPointToLatLng(this.mouseEventToLayerPoint(d))},_initContainer:function(d){var b=this._container=hl(d);if(b){if(b._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");wi(b,"scroll",this._onScroll,this),this._containerId=w(b)},_initLayout:function(){var d=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ht.any3d,Si(d,"leaflet-container"+(Ht.touch?" leaflet-touch":"")+(Ht.retina?" leaflet-retina":"")+(Ht.ielt9?" leaflet-oldie":"")+(Ht.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=Io(d,"position");b!=="absolute"&&b!=="relative"&&b!=="fixed"&&b!=="sticky"&&(d.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var d=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ir(this._mapPane,new _e(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Si(d.markerPane,"leaflet-zoom-hide"),Si(d.shadowPane,"leaflet-zoom-hide"))},_resetView:function(d,b,D){ir(this._mapPane,new _e(0,0));var H=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var ut=this._zoom!==b;this._moveStart(ut,D)._move(d,b)._moveEnd(ut),this.fire("viewreset"),H&&this.fire("load")},_moveStart:function(d,b){return d&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(d,b,D,H){b===void 0&&(b=this._zoom);var ut=this._zoom!==b;return this._zoom=b,this._lastCenter=d,this._pixelOrigin=this._getNewPixelOrigin(d),H?D&&D.pinch&&this.fire("zoom",D):((ut||D&&D.pinch)&&this.fire("zoom",D),this.fire("move",D)),this},_moveEnd:function(d){return d&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Et(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(d){ir(this._mapPane,this._getMapPanePos().subtract(d))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(d){this._targets={},this._targets[w(this._container)]=this;var b=d?zr:wi;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&b(window,"resize",this._onResize,this),Ht.any3d&&this.options.transform3DLimit&&(d?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Et(this._resizeRequest),this._resizeRequest=de(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var d=this._getMapPanePos();Math.max(Math.abs(d.x),Math.abs(d.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(d,b){for(var D=[],H,ut=b==="mouseout"||b==="mouseover",St=d.target||d.srcElement,ne=!1;St;){if(H=this._targets[w(St)],H&&(b==="click"||b==="preclick")&&this._draggableMoved(H)){ne=!0;break}if(H&&H.listens(b,!0)&&(ut&&!Pa(St,d)||(D.push(H),ut))||St===this._container)break;St=St.parentNode}return!D.length&&!ne&&!ut&&this.listens(b,!0)&&(D=[this]),D},_isClickDisabled:function(d){for(;d&&d!==this._container;){if(d._leaflet_disable_click)return!0;d=d.parentNode}},_handleDOMEvent:function(d){var b=d.target||d.srcElement;if(!(!this._loaded||b._leaflet_disable_events||d.type==="click"&&this._isClickDisabled(b))){var D=d.type;D==="mousedown"&&Zo(b),this._fireDOMEvent(d,D)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(d,b,D){if(d.type==="click"){var H=l({},d);H.type="preclick",this._fireDOMEvent(H,H.type,D)}var ut=this._findEventTargets(d,b);if(D){for(var St=[],ne=0;ne<D.length;ne++)D[ne].listens(b,!0)&&St.push(D[ne]);ut=St.concat(ut)}if(ut.length){b==="contextmenu"&&Ei(d);var Ve=ut[0],sn={originalEvent:d};if(d.type!=="keypress"&&d.type!=="keydown"&&d.type!=="keyup"){var On=Ve.getLatLng&&(!Ve._radius||Ve._radius<=10);sn.containerPoint=On?this.latLngToContainerPoint(Ve.getLatLng()):this.mouseEventToContainerPoint(d),sn.layerPoint=this.containerPointToLayerPoint(sn.containerPoint),sn.latlng=On?Ve.getLatLng():this.layerPointToLatLng(sn.layerPoint)}for(ne=0;ne<ut.length;ne++)if(ut[ne].fire(b,sn,!0),sn.originalEvent._stopped||ut[ne].options.bubblingMouseEvents===!1&&Ct(this._mouseEvents,b)!==-1)return}},_draggableMoved:function(d){return d=d.dragging&&d.dragging.enabled()?d:this,d.dragging&&d.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var d=0,b=this._handlers.length;d<b;d++)this._handlers[d].disable()},whenReady:function(d,b){return this._loaded?d.call(b||this,{target:this}):this.on("load",d,b),this},_getMapPanePos:function(){return es(this._mapPane)||new _e(0,0)},_moved:function(){var d=this._getMapPanePos();return d&&!d.equals([0,0])},_getTopLeftPoint:function(d,b){var D=d&&b!==void 0?this._getNewPixelOrigin(d,b):this.getPixelOrigin();return D.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(d,b){var D=this.getSize()._divideBy(2);return this.project(d,b)._subtract(D)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(d,b,D){var H=this._getNewPixelOrigin(D,b);return this.project(d,b)._subtract(H)},_latLngBoundsToNewLayerBounds:function(d,b,D){var H=this._getNewPixelOrigin(D,b);return Yt([this.project(d.getSouthWest(),b)._subtract(H),this.project(d.getNorthWest(),b)._subtract(H),this.project(d.getSouthEast(),b)._subtract(H),this.project(d.getNorthEast(),b)._subtract(H)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(d){return this.latLngToLayerPoint(d).subtract(this._getCenterLayerPoint())},_limitCenter:function(d,b,D){if(!D)return d;var H=this.project(d,b),ut=this.getSize().divideBy(2),St=new ue(H.subtract(ut),H.add(ut)),ne=this._getBoundsOffset(St,D,b);return Math.abs(ne.x)<=1&&Math.abs(ne.y)<=1?d:this.unproject(H.add(ne),b)},_limitOffset:function(d,b){if(!b)return d;var D=this.getPixelBounds(),H=new ue(D.min.add(d),D.max.add(d));return d.add(this._getBoundsOffset(H,b))},_getBoundsOffset:function(d,b,D){var H=Yt(this.project(b.getNorthEast(),D),this.project(b.getSouthWest(),D)),ut=H.min.subtract(d.min),St=H.max.subtract(d.max),ne=this._rebound(ut.x,-St.x),Ve=this._rebound(ut.y,-St.y);return new _e(ne,Ve)},_rebound:function(d,b){return d+b>0?Math.round(d-b)/2:Math.max(0,Math.ceil(d))-Math.max(0,Math.floor(b))},_limitZoom:function(d){var b=this.getMinZoom(),D=this.getMaxZoom(),H=Ht.any3d?this.options.zoomSnap:1;return H&&(d=Math.round(d/H)*H),Math.max(b,Math.min(D,d))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Tr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(d,b){var D=this._getCenterOffset(d)._trunc();return(b&&b.animate)!==!0&&!this.getSize().contains(D)?!1:(this.panBy(D,b),!0)},_createAnimProxy:function(){var d=this._proxy=cr("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(d),this.on("zoomanim",function(b){var D=Po,H=this._proxy.style[D];nr(this._proxy,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1)),H===this._proxy.style[D]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Kr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var d=this.getCenter(),b=this.getZoom();nr(this._proxy,this.project(d,b),this.getZoomScale(b,1))},_catchTransitionEnd:function(d){this._animatingZoom&&d.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(d,b,D){if(this._animatingZoom)return!0;if(D=D||{},!this._zoomAnimated||D.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var H=this.getZoomScale(b),ut=this._getCenterOffset(d)._divideBy(1-1/H);return D.animate!==!0&&!this.getSize().contains(ut)?!1:(de(function(){this._moveStart(!0,!1)._animateZoom(d,b,!0)},this),!0)},_animateZoom:function(d,b,D,H){this._mapPane&&(D&&(this._animatingZoom=!0,this._animateToCenter=d,this._animateToZoom=b,Si(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:d,zoom:b,noUpdate:H}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(p(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Tr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function oe(d,b){return new $t(d,b)}var C=ht.extend({options:{position:"topright"},initialize:function(d){q(this,d)},getPosition:function(){return this.options.position},setPosition:function(d){var b=this._map;return b&&b.removeControl(this),this.options.position=d,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(d){this.remove(),this._map=d;var b=this._container=this.onAdd(d),D=this.getPosition(),H=d._controlCorners[D];return Si(b,"leaflet-control"),D.indexOf("bottom")!==-1?H.insertBefore(b,H.firstChild):H.appendChild(b),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Kr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(d){this._map&&d&&d.screenX>0&&d.screenY>0&&this._map.getContainer().focus()}}),z=function(d){return new C(d)};$t.include({addControl:function(d){return d.addTo(this),this},removeControl:function(d){return d.remove(),this},_initControlPos:function(){var d=this._controlCorners={},b="leaflet-",D=this._controlContainer=cr("div",b+"control-container",this._container);function H(ut,St){var ne=b+ut+" "+b+St;d[ut+St]=cr("div",ne,D)}H("top","left"),H("top","right"),H("bottom","left"),H("bottom","right")},_clearControlPos:function(){for(var d in this._controlCorners)Kr(this._controlCorners[d]);Kr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var U=C.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(d,b,D,H){return D<H?-1:H<D?1:0}},initialize:function(d,b,D){q(this,D),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var H in d)this._addLayer(d[H],H);for(H in b)this._addLayer(b[H],H,!0)},onAdd:function(d){this._initLayout(),this._update(),this._map=d,d.on("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(d){return C.prototype.addTo.call(this,d),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(d,b){return this._addLayer(d,b),this._map?this._update():this},addOverlay:function(d,b){return this._addLayer(d,b,!0),this._map?this._update():this},removeLayer:function(d){d.off("add remove",this._onLayerChange,this);var b=this._getLayer(w(d));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){Si(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var d=this._map.getSize().y-(this._container.offsetTop+50);return d<this._section.clientHeight?(Si(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=d+"px"):Tr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Tr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var d="leaflet-control-layers",b=this._container=cr("div",d),D=this.options.collapsed;b.setAttribute("aria-haspopup",!0),Ya(b),na(b);var H=this._section=cr("section",d+"-list");D&&(this._map.on("click",this.collapse,this),wi(b,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var ut=this._layersLink=cr("a",d+"-toggle",b);ut.href="#",ut.title="Layers",ut.setAttribute("role","button"),wi(ut,{keydown:function(St){St.keyCode===13&&this._expandSafely()},click:function(St){Ei(St),this._expandSafely()}},this),D||this.expand(),this._baseLayersList=cr("div",d+"-base",H),this._separator=cr("div",d+"-separator",H),this._overlaysList=cr("div",d+"-overlays",H),b.appendChild(H)},_getLayer:function(d){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&w(this._layers[b].layer)===d)return this._layers[b]},_addLayer:function(d,b,D){this._map&&d.on("add remove",this._onLayerChange,this),this._layers.push({layer:d,name:b,overlay:D}),this.options.sortLayers&&this._layers.sort(p(function(H,ut){return this.options.sortFunction(H.layer,ut.layer,H.name,ut.name)},this)),this.options.autoZIndex&&d.setZIndex&&(this._lastZIndex++,d.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Co(this._baseLayersList),Co(this._overlaysList),this._layerControlInputs=[];var d,b,D,H,ut=0;for(D=0;D<this._layers.length;D++)H=this._layers[D],this._addItem(H),b=b||H.overlay,d=d||!H.overlay,ut+=H.overlay?0:1;return this.options.hideSingleBase&&(d=d&&ut>1,this._baseLayersList.style.display=d?"":"none"),this._separator.style.display=b&&d?"":"none",this},_onLayerChange:function(d){this._handlingClick||this._update();var b=this._getLayer(w(d.target)),D=b.overlay?d.type==="add"?"overlayadd":"overlayremove":d.type==="add"?"baselayerchange":null;D&&this._map.fire(D,b)},_createRadioElement:function(d,b){var D='<input type="radio" class="leaflet-control-layers-selector" name="'+d+'"'+(b?' checked="checked"':"")+"/>",H=document.createElement("div");return H.innerHTML=D,H.firstChild},_addItem:function(d){var b=document.createElement("label"),D=this._map.hasLayer(d.layer),H;d.overlay?(H=document.createElement("input"),H.type="checkbox",H.className="leaflet-control-layers-selector",H.defaultChecked=D):H=this._createRadioElement("leaflet-base-layers_"+w(this),D),this._layerControlInputs.push(H),H.layerId=w(d.layer),wi(H,"click",this._onInputClick,this);var ut=document.createElement("span");ut.innerHTML=" "+d.name;var St=document.createElement("span");b.appendChild(St),St.appendChild(H),St.appendChild(ut);var ne=d.overlay?this._overlaysList:this._baseLayersList;return ne.appendChild(b),this._checkDisabledLayers(),b},_onInputClick:function(){var d=this._layerControlInputs,b,D,H=[],ut=[];this._handlingClick=!0;for(var St=d.length-1;St>=0;St--)b=d[St],D=this._getLayer(b.layerId).layer,b.checked?H.push(D):b.checked||ut.push(D);for(St=0;St<ut.length;St++)this._map.hasLayer(ut[St])&&this._map.removeLayer(ut[St]);for(St=0;St<H.length;St++)this._map.hasLayer(H[St])||this._map.addLayer(H[St]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var d=this._layerControlInputs,b,D,H=this._map.getZoom(),ut=d.length-1;ut>=0;ut--)b=d[ut],D=this._getLayer(b.layerId).layer,b.disabled=D.options.minZoom!==void 0&&H<D.options.minZoom||D.options.maxZoom!==void 0&&H>D.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var d=this._section;wi(d,"click",Ei),this.expand(),setTimeout(function(){zr(d,"click",Ei)})}}),X=function(d,b,D){return new U(d,b,D)},ft=C.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(d){var b="leaflet-control-zoom",D=cr("div",b+" leaflet-bar"),H=this.options;return this._zoomInButton=this._createButton(H.zoomInText,H.zoomInTitle,b+"-in",D,this._zoomIn),this._zoomOutButton=this._createButton(H.zoomOutText,H.zoomOutTitle,b+"-out",D,this._zoomOut),this._updateDisabled(),d.on("zoomend zoomlevelschange",this._updateDisabled,this),D},onRemove:function(d){d.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(d){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(d.shiftKey?3:1))},_zoomOut:function(d){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(d.shiftKey?3:1))},_createButton:function(d,b,D,H,ut){var St=cr("a",D,H);return St.innerHTML=d,St.href="#",St.title=b,St.setAttribute("role","button"),St.setAttribute("aria-label",b),Ya(St),wi(St,"click",rr),wi(St,"click",ut,this),wi(St,"click",this._refocusOnMap,this),St},_updateDisabled:function(){var d=this._map,b="leaflet-disabled";Tr(this._zoomInButton,b),Tr(this._zoomOutButton,b),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||d._zoom===d.getMinZoom())&&(Si(this._zoomOutButton,b),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||d._zoom===d.getMaxZoom())&&(Si(this._zoomInButton,b),this._zoomInButton.setAttribute("aria-disabled","true"))}});$t.mergeOptions({zoomControl:!0}),$t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ft,this.addControl(this.zoomControl))});var mt=function(d){return new ft(d)},Tt=C.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(d){var b="leaflet-control-scale",D=cr("div",b),H=this.options;return this._addScales(H,b+"-line",D),d.on(H.updateWhenIdle?"moveend":"move",this._update,this),d.whenReady(this._update,this),D},onRemove:function(d){d.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(d,b,D){d.metric&&(this._mScale=cr("div",b,D)),d.imperial&&(this._iScale=cr("div",b,D))},_update:function(){var d=this._map,b=d.getSize().y/2,D=d.distance(d.containerPointToLatLng([0,b]),d.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(D)},_updateScales:function(d){this.options.metric&&d&&this._updateMetric(d),this.options.imperial&&d&&this._updateImperial(d)},_updateMetric:function(d){var b=this._getRoundNum(d),D=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,D,b/d)},_updateImperial:function(d){var b=d*3.2808399,D,H,ut;b>5280?(D=b/5280,H=this._getRoundNum(D),this._updateScale(this._iScale,H+" mi",H/D)):(ut=this._getRoundNum(b),this._updateScale(this._iScale,ut+" ft",ut/b))},_updateScale:function(d,b,D){d.style.width=Math.round(this.options.maxWidth*D)+"px",d.innerHTML=b},_getRoundNum:function(d){var b=Math.pow(10,(Math.floor(d)+"").length-1),D=d/b;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:1,b*D}}),ce=function(d){return new Tt(d)},ee='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Oe=C.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ht.inlineSvg?ee+" ":"")+"Leaflet</a>"},initialize:function(d){q(this,d),this._attributions={}},onAdd:function(d){d.attributionControl=this,this._container=cr("div","leaflet-control-attribution"),Ya(this._container);for(var b in d._layers)d._layers[b].getAttribution&&this.addAttribution(d._layers[b].getAttribution());return this._update(),d.on("layeradd",this._addAttribution,this),this._container},onRemove:function(d){d.off("layeradd",this._addAttribution,this)},_addAttribution:function(d){d.layer.getAttribution&&(this.addAttribution(d.layer.getAttribution()),d.layer.once("remove",function(){this.removeAttribution(d.layer.getAttribution())},this))},setPrefix:function(d){return this.options.prefix=d,this._update(),this},addAttribution:function(d){return d?(this._attributions[d]||(this._attributions[d]=0),this._attributions[d]++,this._update(),this):this},removeAttribution:function(d){return d?(this._attributions[d]&&(this._attributions[d]--,this._update()),this):this},_update:function(){if(this._map){var d=[];for(var b in this._attributions)this._attributions[b]&&d.push(b);var D=[];this.options.prefix&&D.push(this.options.prefix),d.length&&D.push(d.join(", ")),this._container.innerHTML=D.join(' <span aria-hidden="true">|</span> ')}}});$t.mergeOptions({attributionControl:!0}),$t.addInitHook(function(){this.options.attributionControl&&new Oe().addTo(this)});var Qe=function(d){return new Oe(d)};C.Layers=U,C.Zoom=ft,C.Scale=Tt,C.Attribution=Oe,z.layers=X,z.zoom=mt,z.scale=ce,z.attribution=Qe;var pn=ht.extend({initialize:function(d){this._map=d},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});pn.addTo=function(d,b){return d.addHandler(b,this),this};var qe={Events:ln},an=Ht.touch?"touchstart mousedown":"mousedown",Fn=Le.extend({options:{clickTolerance:3},initialize:function(d,b,D,H){q(this,H),this._element=d,this._dragStartTarget=b||d,this._preventOutline=D},enable:function(){this._enabled||(wi(this._dragStartTarget,an,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Fn._dragging===this&&this.finishDrag(!0),zr(this._dragStartTarget,an,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(d){if(this._enabled&&(this._moved=!1,!Oi(this._element,"leaflet-zoom-anim"))){if(d.touches&&d.touches.length!==1){Fn._dragging===this&&this.finishDrag();return}if(!(Fn._dragging||d.shiftKey||d.which!==1&&d.button!==1&&!d.touches)&&(Fn._dragging=this,this._preventOutline&&Zo(this._element),Ks(),ns(),!this._moving)){this.fire("down");var b=d.touches?d.touches[0]:d,D=Qs(this._element);this._startPoint=new _e(b.clientX,b.clientY),this._startPos=es(this._element),this._parentScale=Hl(D);var H=d.type==="mousedown";wi(document,H?"mousemove":"touchmove",this._onMove,this),wi(document,H?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(d){if(this._enabled){if(d.touches&&d.touches.length>1){this._moved=!0;return}var b=d.touches&&d.touches.length===1?d.touches[0]:d,D=new _e(b.clientX,b.clientY)._subtract(this._startPoint);!D.x&&!D.y||Math.abs(D.x)+Math.abs(D.y)<this.options.clickTolerance||(D.x/=this._parentScale.x,D.y/=this._parentScale.y,Ei(d),this._moved||(this.fire("dragstart"),this._moved=!0,Si(document.body,"leaflet-dragging"),this._lastTarget=d.target||d.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Si(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(D),this._moving=!0,this._lastEvent=d,this._updatePosition())}},_updatePosition:function(){var d={originalEvent:this._lastEvent};this.fire("predrag",d),ir(this._element,this._newPos),this.fire("drag",d)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(d){Tr(document.body,"leaflet-dragging"),this._lastTarget&&(Tr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zr(document,"mousemove touchmove",this._onMove,this),zr(document,"mouseup touchend touchcancel",this._onUp,this),Us(),is(),this._moved&&this._moving&&this.fire("dragend",{noInertia:d,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,Fn._dragging=!1}});function Ui(d,b){if(!b||!d.length)return d.slice();var D=b*b;return d=sr(d,D),d=Qr(d,D),d}function ei(d,b,D){return Math.sqrt(za(d,b,D,!0))}function To(d,b,D){return za(d,b,D)}function Qr(d,b){var D=d.length,H=typeof Uint8Array!=void 0+""?Uint8Array:Array,ut=new H(D);ut[0]=ut[D-1]=1,tr(d,ut,b,0,D-1);var St,ne=[];for(St=0;St<D;St++)ut[St]&&ne.push(d[St]);return ne}function tr(d,b,D,H,ut){var St=0,ne,Ve,sn;for(Ve=H+1;Ve<=ut-1;Ve++)sn=za(d[Ve],d[H],d[ut],!0),sn>St&&(ne=Ve,St=sn);St>D&&(b[ne]=1,tr(d,b,D,H,ne),tr(d,b,D,ne,ut))}function sr(d,b){for(var D=[d[0]],H=1,ut=0,St=d.length;H<St;H++)Xa(d[H],d[ut])>b&&(D.push(d[H]),ut=H);return ut<St-1&&D.push(d[St-1]),D}var Di;function ls(d,b,D,H,ut){var St=H?Di:wr(d,D),ne=wr(b,D),Ve,sn,On;for(Di=ne;;){if(!(St|ne))return[d,b];if(St&ne)return!1;Ve=St||ne,sn=er(d,b,Ve,D,ut),On=wr(sn,D),Ve===St?(d=sn,St=On):(b=sn,ne=On)}}function er(d,b,D,H,ut){var St=b.x-d.x,ne=b.y-d.y,Ve=H.min,sn=H.max,On,ii;return D&8?(On=d.x+St*(sn.y-d.y)/ne,ii=sn.y):D&4?(On=d.x+St*(Ve.y-d.y)/ne,ii=Ve.y):D&2?(On=sn.x,ii=d.y+ne*(sn.x-d.x)/St):D&1&&(On=Ve.x,ii=d.y+ne*(Ve.x-d.x)/St),new _e(On,ii,ut)}function wr(d,b){var D=0;return d.x<b.min.x?D|=1:d.x>b.max.x&&(D|=2),d.y<b.min.y?D|=4:d.y>b.max.y&&(D|=8),D}function Xa(d,b){var D=b.x-d.x,H=b.y-d.y;return D*D+H*H}function za(d,b,D,H){var ut=b.x,St=b.y,ne=D.x-ut,Ve=D.y-St,sn=ne*ne+Ve*Ve,On;return sn>0&&(On=((d.x-ut)*ne+(d.y-St)*Ve)/sn,On>1?(ut=D.x,St=D.y):On>0&&(ut+=ne*On,St+=Ve*On)),ne=d.x-ut,Ve=d.y-St,H?ne*ne+Ve*Ve:new _e(ut,St)}function Vr(d){return!lt(d[0])||typeof d[0][0]!="object"&&typeof d[0][0]<"u"}function Gs(d){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Vr(d)}function Ri(d,b){var D,H,ut,St,ne,Ve,sn,On;if(!d||d.length===0)throw new Error("latlngs not passed");Vr(d)||(console.warn("latlngs are not flat! Only the first ring will be used"),d=d[0]);var ii=[];for(var Zi in d)ii.push(b.project(fe(d[Zi])));var Qi=ii.length;for(D=0,H=0;D<Qi-1;D++)H+=ii[D].distanceTo(ii[D+1])/2;if(H===0)On=ii[0];else for(D=0,St=0;D<Qi-1;D++)if(ne=ii[D],Ve=ii[D+1],ut=ne.distanceTo(Ve),St+=ut,St>H){sn=(St-H)/ut,On=[Ve.x-sn*(Ve.x-ne.x),Ve.y-sn*(Ve.y-ne.y)];break}return b.unproject(be(On))}var us={__proto__:null,simplify:Ui,pointToSegmentDistance:ei,closestPointOnSegment:To,clipSegment:ls,_getEdgeIntersection:er,_getBitCode:wr,_sqClosestPointOnSegment:za,isFlat:Vr,_flat:Gs,polylineCenter:Ri};function pa(d,b,D){var H,ut=[1,4,2,8],St,ne,Ve,sn,On,ii,Zi,Qi;for(St=0,ii=d.length;St<ii;St++)d[St]._code=wr(d[St],b);for(Ve=0;Ve<4;Ve++){for(Zi=ut[Ve],H=[],St=0,ii=d.length,ne=ii-1;St<ii;ne=St++)sn=d[St],On=d[ne],sn._code&Zi?On._code&Zi||(Qi=er(On,sn,Zi,b,D),Qi._code=wr(Qi,b),H.push(Qi)):(On._code&Zi&&(Qi=er(On,sn,Zi,b,D),Qi._code=wr(Qi,b),H.push(Qi)),H.push(sn));d=H}return d}function Ms(d,b){var D,H,ut,St,ne,Ve,sn,On,ii;if(!d||d.length===0)throw new Error("latlngs not passed");Vr(d)||(console.warn("latlngs are not flat! Only the first ring will be used"),d=d[0]);var Zi=[];for(var Qi in d)Zi.push(b.project(fe(d[Qi])));var Ys=Zi.length;for(Ve=sn=On=0,D=0,H=Ys-1;D<Ys;H=D++)ut=Zi[D],St=Zi[H],ne=ut.y*St.x-St.y*ut.x,sn+=(ut.x+St.x)*ne,On+=(ut.y+St.y)*ne,Ve+=ne*3;return Ve===0?ii=Zi[0]:ii=[sn/Ve,On/Ve],b.unproject(be(ii))}var ma={__proto__:null,clipPolygon:pa,polygonCenter:Ms},ml={project:function(d){return new _e(d.lng,d.lat)},unproject:function(d){return new ye(d.y,d.x)},bounds:new ue([-180,-90],[180,90])},Da={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ue([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(d){var b=Math.PI/180,D=this.R,H=d.lat*b,ut=this.R_MINOR/D,St=Math.sqrt(1-ut*ut),ne=St*Math.sin(H),Ve=Math.tan(Math.PI/4-H/2)/Math.pow((1-ne)/(1+ne),St/2);return H=-D*Math.log(Math.max(Ve,1e-10)),new _e(d.lng*b*D,H)},unproject:function(d){for(var b=180/Math.PI,D=this.R,H=this.R_MINOR/D,ut=Math.sqrt(1-H*H),St=Math.exp(-d.y/D),ne=Math.PI/2-2*Math.atan(St),Ve=0,sn=.1,On;Ve<15&&Math.abs(sn)>1e-7;Ve++)On=ut*Math.sin(ne),On=Math.pow((1-On)/(1+On),ut/2),sn=Math.PI/2-2*Math.atan(St*On)-ne,ne+=sn;return new ye(ne*b,d.x*b/D)}},mc={__proto__:null,LonLat:ml,Mercator:Da,SphericalMercator:Bn},Mr=l({},Ue,{code:"EPSG:3395",projection:Da,transformation:function(){var d=.5/(Math.PI*Da.R);return cn(d,.5,-d,.5)}()}),ia=l({},Ue,{code:"EPSG:4326",projection:ml,transformation:cn(1/180,1,-1/180,.5)}),Zu=l({},mn,{projection:ml,transformation:cn(1,0,-1,0),scale:function(d){return Math.pow(2,d)},zoom:function(d){return Math.log(d)/Math.LN2},distance:function(d,b){var D=b.lng-d.lng,H=b.lat-d.lat;return Math.sqrt(D*D+H*H)},infinite:!0});mn.Earth=Ue,mn.EPSG3395=Mr,mn.EPSG3857=Un,mn.EPSG900913=R,mn.EPSG4326=ia,mn.Simple=Zu;var ys=Le.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(d){return d.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(d){return d&&d.removeLayer(this),this},getPane:function(d){return this._map.getPane(d?this.options[d]||d:this.options.pane)},addInteractiveTarget:function(d){return this._map._targets[w(d)]=this,this},removeInteractiveTarget:function(d){return delete this._map._targets[w(d)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(d){var b=d.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var D=this.getEvents();b.on(D,this),this.once("remove",function(){b.off(D,this)},this)}this.onAdd(b),this.fire("add"),b.fire("layeradd",{layer:this})}}});$t.include({addLayer:function(d){if(!d._layerAdd)throw new Error("The provided object is not a Layer.");var b=w(d);return this._layers[b]?this:(this._layers[b]=d,d._mapToAdd=this,d.beforeAdd&&d.beforeAdd(this),this.whenReady(d._layerAdd,d),this)},removeLayer:function(d){var b=w(d);return this._layers[b]?(this._loaded&&d.onRemove(this),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:d}),d.fire("remove")),d._map=d._mapToAdd=null,this):this},hasLayer:function(d){return w(d)in this._layers},eachLayer:function(d,b){for(var D in this._layers)d.call(b,this._layers[D]);return this},_addLayers:function(d){d=d?lt(d)?d:[d]:[];for(var b=0,D=d.length;b<D;b++)this.addLayer(d[b])},_addZoomLimit:function(d){(!isNaN(d.options.maxZoom)||!isNaN(d.options.minZoom))&&(this._zoomBoundLayers[w(d)]=d,this._updateZoomLevels())},_removeZoomLimit:function(d){var b=w(d);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var d=1/0,b=-1/0,D=this._getZoomSpan();for(var H in this._zoomBoundLayers){var ut=this._zoomBoundLayers[H].options;d=ut.minZoom===void 0?d:Math.min(d,ut.minZoom),b=ut.maxZoom===void 0?b:Math.max(b,ut.maxZoom)}this._layersMaxZoom=b===-1/0?void 0:b,this._layersMinZoom=d===1/0?void 0:d,D!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Wo=ys.extend({initialize:function(d,b){q(this,b),this._layers={};var D,H;if(d)for(D=0,H=d.length;D<H;D++)this.addLayer(d[D])},addLayer:function(d){var b=this.getLayerId(d);return this._layers[b]=d,this._map&&this._map.addLayer(d),this},removeLayer:function(d){var b=d in this._layers?d:this.getLayerId(d);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(d){var b=typeof d=="number"?d:this.getLayerId(d);return b in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(d){var b=Array.prototype.slice.call(arguments,1),D,H;for(D in this._layers)H=this._layers[D],H[d]&&H[d].apply(H,b);return this},onAdd:function(d){this.eachLayer(d.addLayer,d)},onRemove:function(d){this.eachLayer(d.removeLayer,d)},eachLayer:function(d,b){for(var D in this._layers)d.call(b,this._layers[D]);return this},getLayer:function(d){return this._layers[d]},getLayers:function(){var d=[];return this.eachLayer(d.push,d),d},setZIndex:function(d){return this.invoke("setZIndex",d)},getLayerId:function(d){return w(d)}}),ql=function(d,b){return new Wo(d,b)},Zs=Wo.extend({addLayer:function(d){return this.hasLayer(d)?this:(d.addEventParent(this),Wo.prototype.addLayer.call(this,d),this.fire("layeradd",{layer:d}))},removeLayer:function(d){return this.hasLayer(d)?(d in this._layers&&(d=this._layers[d]),d.removeEventParent(this),Wo.prototype.removeLayer.call(this,d),this.fire("layerremove",{layer:d})):this},setStyle:function(d){return this.invoke("setStyle",d)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var d=new Ee;for(var b in this._layers){var D=this._layers[b];d.extend(D.getBounds?D.getBounds():D.getLatLng())}return d}}),Fc=function(d,b){return new Zs(d,b)},Na=ht.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(d){q(this,d)},createIcon:function(d){return this._createIcon("icon",d)},createShadow:function(d){return this._createIcon("shadow",d)},_createIcon:function(d,b){var D=this._getIconUrl(d);if(!D){if(d==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var H=this._createImg(D,b&&b.tagName==="IMG"?b:null);return this._setIconStyles(H,d),(this.options.crossOrigin||this.options.crossOrigin==="")&&(H.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),H},_setIconStyles:function(d,b){var D=this.options,H=D[b+"Size"];typeof H=="number"&&(H=[H,H]);var ut=be(H),St=be(b==="shadow"&&D.shadowAnchor||D.iconAnchor||ut&&ut.divideBy(2,!0));d.className="leaflet-marker-"+b+" "+(D.className||""),St&&(d.style.marginLeft=-St.x+"px",d.style.marginTop=-St.y+"px"),ut&&(d.style.width=ut.x+"px",d.style.height=ut.y+"px")},_createImg:function(d,b){return b=b||document.createElement("img"),b.src=d,b},_getIconUrl:function(d){return Ht.retina&&this.options[d+"RetinaUrl"]||this.options[d+"Url"]}});function xu(d){return new Na(d)}var wu=Na.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(d){return typeof wu.imagePath!="string"&&(wu.imagePath=this._detectIconPath()),(this.options.imagePath||wu.imagePath)+Na.prototype._getIconUrl.call(this,d)},_stripUrl:function(d){var b=function(D,H,ut){var St=H.exec(D);return St&&St[ut]};return d=b(d,/^url\((['"])?(.+)\1\)$/,2),d&&b(d,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var d=cr("div","leaflet-default-icon-path",document.body),b=Io(d,"background-image")||Io(d,"backgroundImage");if(document.body.removeChild(d),b=this._stripUrl(b),b)return b;var D=document.querySelector('link[href$="leaflet.css"]');return D?D.href.substring(0,D.href.length-11-1):""}}),Sl=pn.extend({initialize:function(d){this._marker=d},addHooks:function(){var d=this._marker._icon;this._draggable||(this._draggable=new Fn(d,d,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Si(d,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Tr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(d){var b=this._marker,D=b._map,H=this._marker.options.autoPanSpeed,ut=this._marker.options.autoPanPadding,St=es(b._icon),ne=D.getPixelBounds(),Ve=D.getPixelOrigin(),sn=Yt(ne.min._subtract(Ve).add(ut),ne.max._subtract(Ve).subtract(ut));if(!sn.contains(St)){var On=be((Math.max(sn.max.x,St.x)-sn.max.x)/(ne.max.x-sn.max.x)-(Math.min(sn.min.x,St.x)-sn.min.x)/(ne.min.x-sn.min.x),(Math.max(sn.max.y,St.y)-sn.max.y)/(ne.max.y-sn.max.y)-(Math.min(sn.min.y,St.y)-sn.min.y)/(ne.min.y-sn.min.y)).multiplyBy(H);D.panBy(On,{animate:!1}),this._draggable._newPos._add(On),this._draggable._startPos._add(On),ir(b._icon,this._draggable._newPos),this._onDrag(d),this._panRequest=de(this._adjustPan.bind(this,d))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(d){this._marker.options.autoPan&&(Et(this._panRequest),this._panRequest=de(this._adjustPan.bind(this,d)))},_onDrag:function(d){var b=this._marker,D=b._shadow,H=es(b._icon),ut=b._map.layerPointToLatLng(H);D&&ir(D,H),b._latlng=ut,d.latlng=ut,d.oldLatLng=this._oldLatLng,b.fire("move",d).fire("drag",d)},_onDragEnd:function(d){Et(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",d)}}),bu=ys.extend({options:{icon:new wu,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(d,b){q(this,b),this._latlng=fe(d)},onAdd:function(d){this._zoomAnimated=this._zoomAnimated&&d.options.markerZoomAnimation,this._zoomAnimated&&d.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(d){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&d.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(d){var b=this._latlng;return this._latlng=fe(d),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(d){return this.options.zIndexOffset=d,this.update()},getIcon:function(){return this.options.icon},setIcon:function(d){return this.options.icon=d,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var d=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(d)}return this},_initIcon:function(){var d=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),D=d.icon.createIcon(this._icon),H=!1;D!==this._icon&&(this._icon&&this._removeIcon(),H=!0,d.title&&(D.title=d.title),D.tagName==="IMG"&&(D.alt=d.alt||"")),Si(D,b),d.keyboard&&(D.tabIndex="0",D.setAttribute("role","button")),this._icon=D,d.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&wi(D,"focus",this._panOnFocus,this);var ut=d.icon.createShadow(this._shadow),St=!1;ut!==this._shadow&&(this._removeShadow(),St=!0),ut&&(Si(ut,b),ut.alt=""),this._shadow=ut,d.opacity<1&&this._updateOpacity(),H&&this.getPane().appendChild(this._icon),this._initInteraction(),ut&&St&&this.getPane(d.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zr(this._icon,"focus",this._panOnFocus,this),Kr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Kr(this._shadow),this._shadow=null},_setPos:function(d){this._icon&&ir(this._icon,d),this._shadow&&ir(this._shadow,d),this._zIndex=d.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(d){this._icon&&(this._icon.style.zIndex=this._zIndex+d)},_animateZoom:function(d){var b=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(Si(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Sl)){var d=this.options.draggable;this.dragging&&(d=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Sl(this),d&&this.dragging.enable()}},setOpacity:function(d){return this.options.opacity=d,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var d=this.options.opacity;this._icon&&oo(this._icon,d),this._shadow&&oo(this._shadow,d)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var d=this._map;if(d){var b=this.options.icon.options,D=b.iconSize?be(b.iconSize):be(0,0),H=b.iconAnchor?be(b.iconAnchor):be(0,0);d.panInside(this._latlng,{paddingTopLeft:H,paddingBottomRight:D.subtract(H)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Ha(d,b){return new bu(d,b)}var xs=ys.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(d){this._renderer=d.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(d){return q(this,d),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&d&&Object.prototype.hasOwnProperty.call(d,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),$a=xs.extend({options:{fill:!0,radius:10},initialize:function(d,b){q(this,b),this._latlng=fe(d),this._radius=this.options.radius},setLatLng:function(d){var b=this._latlng;return this._latlng=fe(d),this.redraw(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(d){return this.options.radius=this._radius=d,this.redraw()},getRadius:function(){return this._radius},setStyle:function(d){var b=d&&d.radius||this._radius;return xs.prototype.setStyle.call(this,d),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var d=this._radius,b=this._radiusY||d,D=this._clickTolerance(),H=[d+D,b+D];this._pxBounds=new ue(this._point.subtract(H),this._point.add(H))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(d){return d.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function gc(d,b){return new $a(d,b)}var El=$a.extend({initialize:function(d,b,D){if(typeof b=="number"&&(b=l({},D,{radius:b})),q(this,b),this._latlng=fe(d),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(d){return this._mRadius=d,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var d=[this._radius,this._radiusY||this._radius];return new Ee(this._map.layerPointToLatLng(this._point.subtract(d)),this._map.layerPointToLatLng(this._point.add(d)))},setStyle:xs.prototype.setStyle,_project:function(){var d=this._latlng.lng,b=this._latlng.lat,D=this._map,H=D.options.crs;if(H.distance===Ue.distance){var ut=Math.PI/180,St=this._mRadius/Ue.R/ut,ne=D.project([b+St,d]),Ve=D.project([b-St,d]),sn=ne.add(Ve).divideBy(2),On=D.unproject(sn).lat,ii=Math.acos((Math.cos(St*ut)-Math.sin(b*ut)*Math.sin(On*ut))/(Math.cos(b*ut)*Math.cos(On*ut)))/ut;(isNaN(ii)||ii===0)&&(ii=St/Math.cos(Math.PI/180*b)),this._point=sn.subtract(D.getPixelOrigin()),this._radius=isNaN(ii)?0:sn.x-D.project([On,d-ii]).x,this._radiusY=sn.y-ne.y}else{var Zi=H.unproject(H.project(this._latlng).subtract([this._mRadius,0]));this._point=D.latLngToLayerPoint(this._latlng),this._radius=this._point.x-D.latLngToLayerPoint(Zi).x}this._updateBounds()}});function ga(d,b,D){return new El(d,b,D)}var ho=xs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(d,b){q(this,b),this._setLatLngs(d)},getLatLngs:function(){return this._latlngs},setLatLngs:function(d){return this._setLatLngs(d),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(d){for(var b=1/0,D=null,H=za,ut,St,ne=0,Ve=this._parts.length;ne<Ve;ne++)for(var sn=this._parts[ne],On=1,ii=sn.length;On<ii;On++){ut=sn[On-1],St=sn[On];var Zi=H(d,ut,St,!0);Zi<b&&(b=Zi,D=H(d,ut,St))}return D&&(D.distance=Math.sqrt(b)),D},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ri(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(d,b){return b=b||this._defaultShape(),d=fe(d),b.push(d),this._bounds.extend(d),this.redraw()},_setLatLngs:function(d){this._bounds=new Ee,this._latlngs=this._convertLatLngs(d)},_defaultShape:function(){return Vr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(d){for(var b=[],D=Vr(d),H=0,ut=d.length;H<ut;H++)D?(b[H]=fe(d[H]),this._bounds.extend(b[H])):b[H]=this._convertLatLngs(d[H]);return b},_project:function(){var d=new ue;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,d),this._bounds.isValid()&&d.isValid()&&(this._rawPxBounds=d,this._updateBounds())},_updateBounds:function(){var d=this._clickTolerance(),b=new _e(d,d);this._rawPxBounds&&(this._pxBounds=new ue([this._rawPxBounds.min.subtract(b),this._rawPxBounds.max.add(b)]))},_projectLatlngs:function(d,b,D){var H=d[0]instanceof ye,ut=d.length,St,ne;if(H){for(ne=[],St=0;St<ut;St++)ne[St]=this._map.latLngToLayerPoint(d[St]),D.extend(ne[St]);b.push(ne)}else for(St=0;St<ut;St++)this._projectLatlngs(d[St],b,D)},_clipPoints:function(){var d=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(d))){if(this.options.noClip){this._parts=this._rings;return}var b=this._parts,D,H,ut,St,ne,Ve,sn;for(D=0,ut=0,St=this._rings.length;D<St;D++)for(sn=this._rings[D],H=0,ne=sn.length;H<ne-1;H++)Ve=ls(sn[H],sn[H+1],d,H,!0),Ve&&(b[ut]=b[ut]||[],b[ut].push(Ve[0]),(Ve[1]!==sn[H+1]||H===ne-2)&&(b[ut].push(Ve[1]),ut++))}},_simplifyPoints:function(){for(var d=this._parts,b=this.options.smoothFactor,D=0,H=d.length;D<H;D++)d[D]=Ui(d[D],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(d,b){var D,H,ut,St,ne,Ve,sn=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(d))return!1;for(D=0,St=this._parts.length;D<St;D++)for(Ve=this._parts[D],H=0,ne=Ve.length,ut=ne-1;H<ne;ut=H++)if(!(!b&&H===0)&&ei(d,Ve[ut],Ve[H])<=sn)return!0;return!1}});function Ml(d,b){return new ho(d,b)}ho._flat=Gs;var Ll=ho.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ms(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(d){var b=ho.prototype._convertLatLngs.call(this,d),D=b.length;return D>=2&&b[0]instanceof ye&&b[0].equals(b[D-1])&&b.pop(),b},_setLatLngs:function(d){ho.prototype._setLatLngs.call(this,d),Vr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Vr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var d=this._renderer._bounds,b=this.options.weight,D=new _e(b,b);if(d=new ue(d.min.subtract(D),d.max.add(D)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(d))){if(this.options.noClip){this._parts=this._rings;return}for(var H=0,ut=this._rings.length,St;H<ut;H++)St=pa(this._rings[H],d,!0),St.length&&this._parts.push(St)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(d){var b=!1,D,H,ut,St,ne,Ve,sn,On;if(!this._pxBounds||!this._pxBounds.contains(d))return!1;for(St=0,sn=this._parts.length;St<sn;St++)for(D=this._parts[St],ne=0,On=D.length,Ve=On-1;ne<On;Ve=ne++)H=D[ne],ut=D[Ve],H.y>d.y!=ut.y>d.y&&d.x<(ut.x-H.x)*(d.y-H.y)/(ut.y-H.y)+H.x&&(b=!b);return b||ho.prototype._containsPoint.call(this,d,!0)}});function Vu(d,b){return new Ll(d,b)}var gl=Zs.extend({initialize:function(d,b){q(this,b),this._layers={},d&&this.addData(d)},addData:function(d){var b=lt(d)?d:d.features,D,H,ut;if(b){for(D=0,H=b.length;D<H;D++)ut=b[D],(ut.geometries||ut.geometry||ut.features||ut.coordinates)&&this.addData(ut);return this}var St=this.options;if(St.filter&&!St.filter(d))return this;var ne=dr(d,St);return ne?(ne.feature=Yu(d),ne.defaultOptions=ne.options,this.resetStyle(ne),St.onEachFeature&&St.onEachFeature(d,ne),this.addLayer(ne)):this},resetStyle:function(d){return d===void 0?this.eachLayer(this.resetStyle,this):(d.options=l({},d.defaultOptions),this._setLayerStyle(d,this.options.style),this)},setStyle:function(d){return this.eachLayer(function(b){this._setLayerStyle(b,d)},this)},_setLayerStyle:function(d,b){d.setStyle&&(typeof b=="function"&&(b=b(d.feature)),d.setStyle(b))}});function dr(d,b){var D=d.type==="Feature"?d.geometry:d,H=D?D.coordinates:null,ut=[],St=b&&b.pointToLayer,ne=b&&b.coordsToLatLng||Xo,Ve,sn,On,ii;if(!H&&!D)return null;switch(D.type){case"Point":return Ve=ne(H),Ls(St,d,Ve,b);case"MultiPoint":for(On=0,ii=H.length;On<ii;On++)Ve=ne(H[On]),ut.push(Ls(St,d,Ve,b));return new Zs(ut);case"LineString":case"MultiLineString":return sn=ws(H,D.type==="LineString"?0:1,ne),new ho(sn,b);case"Polygon":case"MultiPolygon":return sn=ws(H,D.type==="Polygon"?1:2,ne),new Ll(sn,b);case"GeometryCollection":for(On=0,ii=D.geometries.length;On<ii;On++){var Zi=dr({geometry:D.geometries[On],type:"Feature",properties:d.properties},b);Zi&&ut.push(Zi)}return new Zs(ut);case"FeatureCollection":for(On=0,ii=D.features.length;On<ii;On++){var Qi=dr(D.features[On],b);Qi&&ut.push(Qi)}return new Zs(ut);default:throw new Error("Invalid GeoJSON object.")}}function Ls(d,b,D,H){return d?d(b,D):new bu(D,H&&H.markersInheritOptions&&H)}function Xo(d){return new ye(d[1],d[0],d[2])}function ws(d,b,D){for(var H=[],ut=0,St=d.length,ne;ut<St;ut++)ne=b?ws(d[ut],b-1,D):(D||Xo)(d[ut]),H.push(ne);return H}function _l(d,b){return d=fe(d),d.alt!==void 0?[Z(d.lng,b),Z(d.lat,b),Z(d.alt,b)]:[Z(d.lng,b),Z(d.lat,b)]}function Wu(d,b,D,H){for(var ut=[],St=0,ne=d.length;St<ne;St++)ut.push(b?Wu(d[St],Vr(d[St])?0:b-1,D,H):_l(d[St],H));return!b&&D&&ut.push(ut[0].slice()),ut}function Jl(d,b){return d.feature?l({},d.feature,{geometry:b}):Yu(b)}function Yu(d){return d.type==="Feature"||d.type==="FeatureCollection"?d:{type:"Feature",properties:{},geometry:d}}var ks={toGeoJSON:function(d){return Jl(this,{type:"Point",coordinates:_l(this.getLatLng(),d)})}};bu.include(ks),El.include(ks),$a.include(ks),ho.include({toGeoJSON:function(d){var b=!Vr(this._latlngs),D=Wu(this._latlngs,b?1:0,!1,d);return Jl(this,{type:(b?"Multi":"")+"LineString",coordinates:D})}}),Ll.include({toGeoJSON:function(d){var b=!Vr(this._latlngs),D=b&&!Vr(this._latlngs[0]),H=Wu(this._latlngs,D?2:b?1:0,!0,d);return b||(H=[H]),Jl(this,{type:(D?"Multi":"")+"Polygon",coordinates:H})}}),Wo.include({toMultiPoint:function(d){var b=[];return this.eachLayer(function(D){b.push(D.toGeoJSON(d).geometry.coordinates)}),Jl(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(d){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(b==="MultiPoint")return this.toMultiPoint(d);var D=b==="GeometryCollection",H=[];return this.eachLayer(function(ut){if(ut.toGeoJSON){var St=ut.toGeoJSON(d);if(D)H.push(St.geometry);else{var ne=Yu(St);ne.type==="FeatureCollection"?H.push.apply(H,ne.features):H.push(ne)}}}),D?Jl(this,{geometries:H,type:"GeometryCollection"}):{type:"FeatureCollection",features:H}}});function ze(d,b){return new gl(d,b)}var gn=ze,on=ys.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(d,b,D){this._url=d,this._bounds=ve(b),q(this,D)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Si(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Kr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(d){return this.options.opacity=d,this._image&&this._updateOpacity(),this},setStyle:function(d){return d.opacity&&this.setOpacity(d.opacity),this},bringToFront:function(){return this._map&&jn(this._image),this},bringToBack:function(){return this._map&&Ti(this._image),this},setUrl:function(d){return this._url=d,this._image&&(this._image.src=d),this},setBounds:function(d){return this._bounds=ve(d),this._map&&this._reset(),this},getEvents:function(){var d={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var d=this._url.tagName==="IMG",b=this._image=d?this._url:cr("img");if(Si(b,"leaflet-image-layer"),this._zoomAnimated&&Si(b,"leaflet-zoom-animated"),this.options.className&&Si(b,this.options.className),b.onselectstart=E,b.onmousemove=E,b.onload=p(this.fire,this,"load"),b.onerror=p(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),d){this._url=b.src;return}b.src=this._url,b.alt=this.options.alt},_animateZoom:function(d){var b=this._map.getZoomScale(d.zoom),D=this._map._latLngBoundsToNewLayerBounds(this._bounds,d.zoom,d.center).min;nr(this._image,D,b)},_reset:function(){var d=this._image,b=new ue(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),D=b.getSize();ir(d,b.min),d.style.width=D.x+"px",d.style.height=D.y+"px"},_updateOpacity:function(){oo(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var d=this.options.errorOverlayUrl;d&&this._url!==d&&(this._url=d,this._image.src=d)},getCenter:function(){return this._bounds.getCenter()}}),ni=function(d,b,D){return new on(d,b,D)},Bi=on.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var d=this._url.tagName==="VIDEO",b=this._image=d?this._url:cr("video");if(Si(b,"leaflet-image-layer"),this._zoomAnimated&&Si(b,"leaflet-zoom-animated"),this.options.className&&Si(b,this.options.className),b.onselectstart=E,b.onmousemove=E,b.onloadeddata=p(this.fire,this,"load"),d){for(var D=b.getElementsByTagName("source"),H=[],ut=0;ut<D.length;ut++)H.push(D[ut].src);this._url=D.length>0?H:[b.src];return}lt(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(b.style,"objectFit")&&(b.style.objectFit="fill"),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,b.muted=!!this.options.muted,b.playsInline=!!this.options.playsInline;for(var St=0;St<this._url.length;St++){var ne=cr("source");ne.src=this._url[St],b.appendChild(ne)}}});function Sr(d,b,D){return new Bi(d,b,D)}var Do=on.extend({_initImage:function(){var d=this._image=this._url;Si(d,"leaflet-image-layer"),this._zoomAnimated&&Si(d,"leaflet-zoom-animated"),this.options.className&&Si(d,this.options.className),d.onselectstart=E,d.onmousemove=E}});function Lr(d,b,D){return new Do(d,b,D)}var Ps=ys.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(d,b){d&&(d instanceof ye||lt(d))?(this._latlng=fe(d),q(this,b)):(q(this,d),this._source=b),this.options.content&&(this._content=this.options.content)},openOn:function(d){return d=arguments.length?d:this._source._map,d.hasLayer(this)||d.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(d){return this._map?this.close():(arguments.length?this._source=d:d=this._source,this._prepareOpen(),this.openOn(d._map)),this},onAdd:function(d){this._zoomAnimated=d._zoomAnimated,this._container||this._initLayout(),d._fadeAnimated&&oo(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),d._fadeAnimated&&oo(this._container,1),this.bringToFront(),this.options.interactive&&(Si(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(d){d._fadeAnimated?(oo(this._container,0),this._removeTimeout=setTimeout(p(Kr,void 0,this._container),200)):Kr(this._container),this.options.interactive&&(Tr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(d){return this._latlng=fe(d),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(d){return this._content=d,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var d={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&jn(this._container),this},bringToBack:function(){return this._map&&Ti(this._container),this},_prepareOpen:function(d){var b=this._source;if(!b._map)return!1;if(b instanceof Zs){b=null;var D=this._source._layers;for(var H in D)if(D[H]._map){b=D[H];break}if(!b)return!1;this._source=b}if(!d)if(b.getCenter)d=b.getCenter();else if(b.getLatLng)d=b.getLatLng();else if(b.getBounds)d=b.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(d),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var d=this._contentNode,b=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof b=="string")d.innerHTML=b;else{for(;d.hasChildNodes();)d.removeChild(d.firstChild);d.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var d=this._map.latLngToLayerPoint(this._latlng),b=be(this.options.offset),D=this._getAnchor();this._zoomAnimated?ir(this._container,d.add(D)):b=b.add(d).add(D);var H=this._containerBottom=-b.y,ut=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=H+"px",this._container.style.left=ut+"px"}},_getAnchor:function(){return[0,0]}});$t.include({_initOverlay:function(d,b,D,H){var ut=b;return ut instanceof d||(ut=new d(H).setContent(b)),D&&ut.setLatLng(D),ut}}),ys.include({_initOverlay:function(d,b,D,H){var ut=D;return ut instanceof d?(q(ut,H),ut._source=this):(ut=b&&!H?b:new d(H,this),ut.setContent(D)),ut}});var Kl=Ps.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(d){return d=arguments.length?d:this._source._map,!d.hasLayer(this)&&d._popup&&d._popup.options.autoClose&&d.removeLayer(d._popup),d._popup=this,Ps.prototype.openOn.call(this,d)},onAdd:function(d){Ps.prototype.onAdd.call(this,d),d.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof xs||this._source.on("preclick",Or))},onRemove:function(d){Ps.prototype.onRemove.call(this,d),d.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof xs||this._source.off("preclick",Or))},getEvents:function(){var d=Ps.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(d.preclick=this.close),this.options.keepInView&&(d.moveend=this._adjustPan),d},_initLayout:function(){var d="leaflet-popup",b=this._container=cr("div",d+" "+(this.options.className||"")+" leaflet-zoom-animated"),D=this._wrapper=cr("div",d+"-content-wrapper",b);if(this._contentNode=cr("div",d+"-content",D),Ya(b),na(this._contentNode),wi(b,"contextmenu",Or),this._tipContainer=cr("div",d+"-tip-container",b),this._tip=cr("div",d+"-tip",this._tipContainer),this.options.closeButton){var H=this._closeButton=cr("a",d+"-close-button",b);H.setAttribute("role","button"),H.setAttribute("aria-label","Close popup"),H.href="#close",H.innerHTML='<span aria-hidden="true">&#215;</span>',wi(H,"click",function(ut){Ei(ut),this.close()},this)}},_updateLayout:function(){var d=this._contentNode,b=d.style;b.width="",b.whiteSpace="nowrap";var D=d.offsetWidth;D=Math.min(D,this.options.maxWidth),D=Math.max(D,this.options.minWidth),b.width=D+1+"px",b.whiteSpace="",b.height="";var H=d.offsetHeight,ut=this.options.maxHeight,St="leaflet-popup-scrolled";ut&&H>ut?(b.height=ut+"px",Si(d,St)):Tr(d,St),this._containerWidth=this._container.offsetWidth},_animateZoom:function(d){var b=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center),D=this._getAnchor();ir(this._container,b.add(D))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var d=this._map,b=parseInt(Io(this._container,"marginBottom"),10)||0,D=this._container.offsetHeight+b,H=this._containerWidth,ut=new _e(this._containerLeft,-D-this._containerBottom);ut._add(es(this._container));var St=d.layerPointToContainerPoint(ut),ne=be(this.options.autoPanPadding),Ve=be(this.options.autoPanPaddingTopLeft||ne),sn=be(this.options.autoPanPaddingBottomRight||ne),On=d.getSize(),ii=0,Zi=0;St.x+H+sn.x>On.x&&(ii=St.x+H-On.x+sn.x),St.x-ii-Ve.x<0&&(ii=St.x-Ve.x),St.y+D+sn.y>On.y&&(Zi=St.y+D-On.y+sn.y),St.y-Zi-Ve.y<0&&(Zi=St.y-Ve.y),(ii||Zi)&&(this.options.keepInView&&(this._autopanning=!0),d.fire("autopanstart").panBy([ii,Zi]))}},_getAnchor:function(){return be(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Vs=function(d,b){return new Kl(d,b)};$t.mergeOptions({closePopupOnClick:!0}),$t.include({openPopup:function(d,b,D){return this._initOverlay(Kl,d,b,D).openOn(this),this},closePopup:function(d){return d=arguments.length?d:this._popup,d&&d.close(),this}}),ys.include({bindPopup:function(d,b){return this._popup=this._initOverlay(Kl,this._popup,d,b),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(d){return this._popup&&(this instanceof Zs||(this._popup._source=this),this._popup._prepareOpen(d||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(d){return this._popup&&this._popup.setContent(d),this},getPopup:function(){return this._popup},_openPopup:function(d){if(!(!this._popup||!this._map)){rr(d);var b=d.layer||d.target;if(this._popup._source===b&&!(b instanceof xs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(d.latlng);return}this._popup._source=b,this.openPopup(d.latlng)}},_movePopup:function(d){this._popup.setLatLng(d.latlng)},_onKeyPress:function(d){d.originalEvent.keyCode===13&&this._openPopup(d)}});var Nt=Ps.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(d){Ps.prototype.onAdd.call(this,d),this.setOpacity(this.options.opacity),d.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(d){Ps.prototype.onRemove.call(this,d),d.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var d=Ps.prototype.getEvents.call(this);return this.options.permanent||(d.preclick=this.close),d},_initLayout:function(){var d="leaflet-tooltip",b=d+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=cr("div",b),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+w(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(d){var b,D,H=this._map,ut=this._container,St=H.latLngToContainerPoint(H.getCenter()),ne=H.layerPointToContainerPoint(d),Ve=this.options.direction,sn=ut.offsetWidth,On=ut.offsetHeight,ii=be(this.options.offset),Zi=this._getAnchor();Ve==="top"?(b=sn/2,D=On):Ve==="bottom"?(b=sn/2,D=0):Ve==="center"?(b=sn/2,D=On/2):Ve==="right"?(b=0,D=On/2):Ve==="left"?(b=sn,D=On/2):ne.x<St.x?(Ve="right",b=0,D=On/2):(Ve="left",b=sn+(ii.x+Zi.x)*2,D=On/2),d=d.subtract(be(b,D,!0)).add(ii).add(Zi),Tr(ut,"leaflet-tooltip-right"),Tr(ut,"leaflet-tooltip-left"),Tr(ut,"leaflet-tooltip-top"),Tr(ut,"leaflet-tooltip-bottom"),Si(ut,"leaflet-tooltip-"+Ve),ir(ut,d)},_updatePosition:function(){var d=this._map.latLngToLayerPoint(this._latlng);this._setPosition(d)},setOpacity:function(d){this.options.opacity=d,this._container&&oo(this._container,d)},_animateZoom:function(d){var b=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center);this._setPosition(b)},_getAnchor:function(){return be(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),ae=function(d,b){return new Nt(d,b)};$t.include({openTooltip:function(d,b,D){return this._initOverlay(Nt,d,b,D).openOn(this),this},closeTooltip:function(d){return d.close(),this}}),ys.include({bindTooltip:function(d,b){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Nt,this._tooltip,d,b),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(d){if(!(!d&&this._tooltipHandlersAdded)){var b=d?"off":"on",D={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?D.add=this._openTooltip:(D.mouseover=this._openTooltip,D.mouseout=this.closeTooltip,D.click=this._openTooltip,this._map?this._addFocusListeners():D.add=this._addFocusListeners),this._tooltip.options.sticky&&(D.mousemove=this._moveTooltip),this[b](D),this._tooltipHandlersAdded=!d}},openTooltip:function(d){return this._tooltip&&(this instanceof Zs||(this._tooltip._source=this),this._tooltip._prepareOpen(d)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(d){return this._tooltip&&this._tooltip.setContent(d),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(d){var b=d.getElement();b&&(wi(b,"focus",function(){this._tooltip._source=d,this.openTooltip()},this),wi(b,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(d){var b=d.getElement();b&&b.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(d){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=d.layer||d.target,this.openTooltip(this._tooltip.options.sticky?d.latlng:void 0))},_moveTooltip:function(d){var b=d.latlng,D,H;this._tooltip.options.sticky&&d.originalEvent&&(D=this._map.mouseEventToContainerPoint(d.originalEvent),H=this._map.containerPointToLayerPoint(D),b=this._map.layerPointToLatLng(H)),this._tooltip.setLatLng(b)}});var Ce=Na.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(d){var b=d&&d.tagName==="DIV"?d:document.createElement("div"),D=this.options;if(D.html instanceof Element?(Co(b),b.appendChild(D.html)):b.innerHTML=D.html!==!1?D.html:"",D.bgPos){var H=be(D.bgPos);b.style.backgroundPosition=-H.x+"px "+-H.y+"px"}return this._setIconStyles(b,"icon"),b},createShadow:function(){return null}});function vn(d){return new Ce(d)}Na.Default=wu;var ke=ys.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ht.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(d){q(this,d)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(d){d._addZoomLimit(this)},onRemove:function(d){this._removeAllTiles(),Kr(this._container),d._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(jn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ti(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(d){return this.options.opacity=d,this._updateOpacity(),this},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var d=this._clampZoom(this._map.getZoom());d!==this._tileZoom&&(this._tileZoom=d,this._updateLevels()),this._update()}return this},getEvents:function(){var d={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=M(this._onMoveEnd,this.options.updateInterval,this)),d.move=this._onMove),this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},createTile:function(){return document.createElement("div")},getTileSize:function(){var d=this.options.tileSize;return d instanceof _e?d:new _e(d,d)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(d){for(var b=this.getPane().children,D=-d(-1/0,1/0),H=0,ut=b.length,St;H<ut;H++)St=b[H].style.zIndex,b[H]!==this._container&&St&&(D=d(D,+St));isFinite(D)&&(this.options.zIndex=D+d(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ht.ielt9){oo(this._container,this.options.opacity);var d=+new Date,b=!1,D=!1;for(var H in this._tiles){var ut=this._tiles[H];if(!(!ut.current||!ut.loaded)){var St=Math.min(1,(d-ut.loaded)/200);oo(ut.el,St),St<1?b=!0:(ut.active?D=!0:this._onOpaqueTile(ut),ut.active=!0)}}D&&!this._noPrune&&this._pruneTiles(),b&&(Et(this._fadeFrame),this._fadeFrame=de(this._updateOpacity,this))}},_onOpaqueTile:E,_initContainer:function(){this._container||(this._container=cr("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var d=this._tileZoom,b=this.options.maxZoom;if(d!==void 0){for(var D in this._levels)D=Number(D),this._levels[D].el.children.length||D===d?(this._levels[D].el.style.zIndex=b-Math.abs(d-D),this._onUpdateLevel(D)):(Kr(this._levels[D].el),this._removeTilesAtZoom(D),this._onRemoveLevel(D),delete this._levels[D]);var H=this._levels[d],ut=this._map;return H||(H=this._levels[d]={},H.el=cr("div","leaflet-tile-container leaflet-zoom-animated",this._container),H.el.style.zIndex=b,H.origin=ut.project(ut.unproject(ut.getPixelOrigin()),d).round(),H.zoom=d,this._setZoomTransform(H,ut.getCenter(),ut.getZoom()),E(H.el.offsetWidth),this._onCreateLevel(H)),this._level=H,H}},_onUpdateLevel:E,_onRemoveLevel:E,_onCreateLevel:E,_pruneTiles:function(){if(this._map){var d,b,D=this._map.getZoom();if(D>this.options.maxZoom||D<this.options.minZoom){this._removeAllTiles();return}for(d in this._tiles)b=this._tiles[d],b.retain=b.current;for(d in this._tiles)if(b=this._tiles[d],b.current&&!b.active){var H=b.coords;this._retainParent(H.x,H.y,H.z,H.z-5)||this._retainChildren(H.x,H.y,H.z,H.z+2)}for(d in this._tiles)this._tiles[d].retain||this._removeTile(d)}},_removeTilesAtZoom:function(d){for(var b in this._tiles)this._tiles[b].coords.z===d&&this._removeTile(b)},_removeAllTiles:function(){for(var d in this._tiles)this._removeTile(d)},_invalidateAll:function(){for(var d in this._levels)Kr(this._levels[d].el),this._onRemoveLevel(Number(d)),delete this._levels[d];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(d,b,D,H){var ut=Math.floor(d/2),St=Math.floor(b/2),ne=D-1,Ve=new _e(+ut,+St);Ve.z=+ne;var sn=this._tileCoordsToKey(Ve),On=this._tiles[sn];return On&&On.active?(On.retain=!0,!0):(On&&On.loaded&&(On.retain=!0),ne>H?this._retainParent(ut,St,ne,H):!1)},_retainChildren:function(d,b,D,H){for(var ut=2*d;ut<2*d+2;ut++)for(var St=2*b;St<2*b+2;St++){var ne=new _e(ut,St);ne.z=D+1;var Ve=this._tileCoordsToKey(ne),sn=this._tiles[Ve];if(sn&&sn.active){sn.retain=!0;continue}else sn&&sn.loaded&&(sn.retain=!0);D+1<H&&this._retainChildren(ut,St,D+1,H)}},_resetView:function(d){var b=d&&(d.pinch||d.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(d){this._setView(d.center,d.zoom,!0,d.noUpdate)},_clampZoom:function(d){var b=this.options;return b.minNativeZoom!==void 0&&d<b.minNativeZoom?b.minNativeZoom:b.maxNativeZoom!==void 0&&b.maxNativeZoom<d?b.maxNativeZoom:d},_setView:function(d,b,D,H){var ut=Math.round(b);this.options.maxZoom!==void 0&&ut>this.options.maxZoom||this.options.minZoom!==void 0&&ut<this.options.minZoom?ut=void 0:ut=this._clampZoom(ut);var St=this.options.updateWhenZooming&&ut!==this._tileZoom;(!H||St)&&(this._tileZoom=ut,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),ut!==void 0&&this._update(d),D||this._pruneTiles(),this._noPrune=!!D),this._setZoomTransforms(d,b)},_setZoomTransforms:function(d,b){for(var D in this._levels)this._setZoomTransform(this._levels[D],d,b)},_setZoomTransform:function(d,b,D){var H=this._map.getZoomScale(D,d.zoom),ut=d.origin.multiplyBy(H).subtract(this._map._getNewPixelOrigin(b,D)).round();Ht.any3d?nr(d.el,ut,H):ir(d.el,ut)},_resetGrid:function(){var d=this._map,b=d.options.crs,D=this._tileSize=this.getTileSize(),H=this._tileZoom,ut=this._map.getPixelWorldBounds(this._tileZoom);ut&&(this._globalTileRange=this._pxBoundsToTileRange(ut)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(d.project([0,b.wrapLng[0]],H).x/D.x),Math.ceil(d.project([0,b.wrapLng[1]],H).x/D.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(d.project([b.wrapLat[0],0],H).y/D.x),Math.ceil(d.project([b.wrapLat[1],0],H).y/D.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(d){var b=this._map,D=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),H=b.getZoomScale(D,this._tileZoom),ut=b.project(d,this._tileZoom).floor(),St=b.getSize().divideBy(H*2);return new ue(ut.subtract(St),ut.add(St))},_update:function(d){var b=this._map;if(b){var D=this._clampZoom(b.getZoom());if(d===void 0&&(d=b.getCenter()),this._tileZoom!==void 0){var H=this._getTiledPixelBounds(d),ut=this._pxBoundsToTileRange(H),St=ut.getCenter(),ne=[],Ve=this.options.keepBuffer,sn=new ue(ut.getBottomLeft().subtract([Ve,-Ve]),ut.getTopRight().add([Ve,-Ve]));if(!(isFinite(ut.min.x)&&isFinite(ut.min.y)&&isFinite(ut.max.x)&&isFinite(ut.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var On in this._tiles){var ii=this._tiles[On].coords;(ii.z!==this._tileZoom||!sn.contains(new _e(ii.x,ii.y)))&&(this._tiles[On].current=!1)}if(Math.abs(D-this._tileZoom)>1){this._setView(d,D);return}for(var Zi=ut.min.y;Zi<=ut.max.y;Zi++)for(var Qi=ut.min.x;Qi<=ut.max.x;Qi++){var Ys=new _e(Qi,Zi);if(Ys.z=this._tileZoom,!!this._isValidTile(Ys)){var ra=this._tiles[this._tileCoordsToKey(Ys)];ra?ra.current=!0:ne.push(Ys)}}if(ne.sort(function(oa,zl){return oa.distanceTo(St)-zl.distanceTo(St)}),ne.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var tu=document.createDocumentFragment();for(Qi=0;Qi<ne.length;Qi++)this._addTile(ne[Qi],tu);this._level.el.appendChild(tu)}}}},_isValidTile:function(d){var b=this._map.options.crs;if(!b.infinite){var D=this._globalTileRange;if(!b.wrapLng&&(d.x<D.min.x||d.x>D.max.x)||!b.wrapLat&&(d.y<D.min.y||d.y>D.max.y))return!1}if(!this.options.bounds)return!0;var H=this._tileCoordsToBounds(d);return ve(this.options.bounds).overlaps(H)},_keyToBounds:function(d){return this._tileCoordsToBounds(this._keyToTileCoords(d))},_tileCoordsToNwSe:function(d){var b=this._map,D=this.getTileSize(),H=d.scaleBy(D),ut=H.add(D),St=b.unproject(H,d.z),ne=b.unproject(ut,d.z);return[St,ne]},_tileCoordsToBounds:function(d){var b=this._tileCoordsToNwSe(d),D=new Ee(b[0],b[1]);return this.options.noWrap||(D=this._map.wrapLatLngBounds(D)),D},_tileCoordsToKey:function(d){return d.x+":"+d.y+":"+d.z},_keyToTileCoords:function(d){var b=d.split(":"),D=new _e(+b[0],+b[1]);return D.z=+b[2],D},_removeTile:function(d){var b=this._tiles[d];b&&(Kr(b.el),delete this._tiles[d],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(d)}))},_initTile:function(d){Si(d,"leaflet-tile");var b=this.getTileSize();d.style.width=b.x+"px",d.style.height=b.y+"px",d.onselectstart=E,d.onmousemove=E,Ht.ielt9&&this.options.opacity<1&&oo(d,this.options.opacity)},_addTile:function(d,b){var D=this._getTilePos(d),H=this._tileCoordsToKey(d),ut=this.createTile(this._wrapCoords(d),p(this._tileReady,this,d));this._initTile(ut),this.createTile.length<2&&de(p(this._tileReady,this,d,null,ut)),ir(ut,D),this._tiles[H]={el:ut,coords:d,current:!0},b.appendChild(ut),this.fire("tileloadstart",{tile:ut,coords:d})},_tileReady:function(d,b,D){b&&this.fire("tileerror",{error:b,tile:D,coords:d});var H=this._tileCoordsToKey(d);D=this._tiles[H],D&&(D.loaded=+new Date,this._map._fadeAnimated?(oo(D.el,0),Et(this._fadeFrame),this._fadeFrame=de(this._updateOpacity,this)):(D.active=!0,this._pruneTiles()),b||(Si(D.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:D.el,coords:d})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ht.ielt9||!this._map._fadeAnimated?de(this._pruneTiles,this):setTimeout(p(this._pruneTiles,this),250)))},_getTilePos:function(d){return d.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(d){var b=new _e(this._wrapX?N(d.x,this._wrapX):d.x,this._wrapY?N(d.y,this._wrapY):d.y);return b.z=d.z,b},_pxBoundsToTileRange:function(d){var b=this.getTileSize();return new ue(d.min.unscaleBy(b).floor(),d.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var d in this._tiles)if(!this._tiles[d].loaded)return!1;return!0}});function rn(d){return new ke(d)}var Sn=ke.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(d,b){this._url=d,b=q(this,b),b.detectRetina&&Ht.retina&&b.maxZoom>0?(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom=Math.min(b.maxZoom,b.minZoom+1)):(b.zoomOffset++,b.maxZoom=Math.max(b.minZoom,b.maxZoom-1)),b.minZoom=Math.max(0,b.minZoom)):b.zoomReverse?b.minZoom=Math.min(b.maxZoom,b.minZoom):b.maxZoom=Math.max(b.minZoom,b.maxZoom),typeof b.subdomains=="string"&&(b.subdomains=b.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(d,b){return this._url===d&&b===void 0&&(b=!0),this._url=d,b||this.redraw(),this},createTile:function(d,b){var D=document.createElement("img");return wi(D,"load",p(this._tileOnLoad,this,b,D)),wi(D,"error",p(this._tileOnError,this,b,D)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(D.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(D.referrerPolicy=this.options.referrerPolicy),D.alt="",D.src=this.getTileUrl(d),D},getTileUrl:function(d){var b={r:Ht.retina?"@2x":"",s:this._getSubdomain(d),x:d.x,y:d.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var D=this._globalTileRange.max.y-d.y;this.options.tms&&(b.y=D),b["-y"]=D}return Q(this._url,l(b,this.options))},_tileOnLoad:function(d,b){Ht.ielt9?setTimeout(p(d,this,null,b),0):d(null,b)},_tileOnError:function(d,b,D){var H=this.options.errorTileUrl;H&&b.getAttribute("src")!==H&&(b.src=H),d(D,b)},_onTileRemove:function(d){d.tile.onload=null},_getZoomForUrl:function(){var d=this._tileZoom,b=this.options.maxZoom,D=this.options.zoomReverse,H=this.options.zoomOffset;return D&&(d=b-d),d+H},_getSubdomain:function(d){var b=Math.abs(d.x+d.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var d,b;for(d in this._tiles)if(this._tiles[d].coords.z!==this._tileZoom&&(b=this._tiles[d].el,b.onload=E,b.onerror=E,!b.complete)){b.src=j;var D=this._tiles[d].coords;Kr(b),delete this._tiles[d],this.fire("tileabort",{tile:b,coords:D})}},_removeTile:function(d){var b=this._tiles[d];if(b)return b.el.setAttribute("src",j),ke.prototype._removeTile.call(this,d)},_tileReady:function(d,b,D){if(!(!this._map||D&&D.getAttribute("src")===j))return ke.prototype._tileReady.call(this,d,b,D)}});function Yn(d,b){return new Sn(d,b)}var Mn=Sn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(d,b){this._url=d;var D=l({},this.defaultWmsParams);for(var H in b)H in this.options||(D[H]=b[H]);b=q(this,b);var ut=b.detectRetina&&Ht.retina?2:1,St=this.getTileSize();D.width=St.x*ut,D.height=St.y*ut,this.wmsParams=D},onAdd:function(d){this._crs=this.options.crs||d.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,Sn.prototype.onAdd.call(this,d)},getTileUrl:function(d){var b=this._tileCoordsToNwSe(d),D=this._crs,H=Yt(D.project(b[0]),D.project(b[1])),ut=H.min,St=H.max,ne=(this._wmsVersion>=1.3&&this._crs===ia?[ut.y,ut.x,St.y,St.x]:[ut.x,ut.y,St.x,St.y]).join(","),Ve=Sn.prototype.getTileUrl.call(this,d);return Ve+at(this.wmsParams,Ve,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ne},setParams:function(d,b){return l(this.wmsParams,d),b||this.redraw(),this}});function bi(d,b){return new Mn(d,b)}Sn.WMS=Mn,Yn.wms=bi;var mi=ys.extend({options:{padding:.1},initialize:function(d){q(this,d),w(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Si(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var d={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(d.zoomanim=this._onAnimZoom),d},_onAnimZoom:function(d){this._updateTransform(d.center,d.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(d,b){var D=this._map.getZoomScale(b,this._zoom),H=this._map.getSize().multiplyBy(.5+this.options.padding),ut=this._map.project(this._center,b),St=H.multiplyBy(-D).add(ut).subtract(this._map._getNewPixelOrigin(d,b));Ht.any3d?nr(this._container,St,D):ir(this._container,St)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var d in this._layers)this._layers[d]._reset()},_onZoomEnd:function(){for(var d in this._layers)this._layers[d]._project()},_updatePaths:function(){for(var d in this._layers)this._layers[d]._update()},_update:function(){var d=this.options.padding,b=this._map.getSize(),D=this._map.containerPointToLayerPoint(b.multiplyBy(-d)).round();this._bounds=new ue(D,D.add(b.multiplyBy(1+d*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Mi=mi.extend({options:{tolerance:0},getEvents:function(){var d=mi.prototype.getEvents.call(this);return d.viewprereset=this._onViewPreReset,d},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){mi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var d=this._container=document.createElement("canvas");wi(d,"mousemove",this._onMouseMove,this),wi(d,"click dblclick mousedown mouseup contextmenu",this._onClick,this),wi(d,"mouseout",this._handleMouseOut,this),d._leaflet_disable_events=!0,this._ctx=d.getContext("2d")},_destroyContainer:function(){Et(this._redrawRequest),delete this._ctx,Kr(this._container),zr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var d;this._redrawBounds=null;for(var b in this._layers)d=this._layers[b],d._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){mi.prototype._update.call(this);var d=this._bounds,b=this._container,D=d.getSize(),H=Ht.retina?2:1;ir(b,d.min),b.width=H*D.x,b.height=H*D.y,b.style.width=D.x+"px",b.style.height=D.y+"px",Ht.retina&&this._ctx.scale(2,2),this._ctx.translate(-d.min.x,-d.min.y),this.fire("update")}},_reset:function(){mi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(d){this._updateDashArray(d),this._layers[w(d)]=d;var b=d._order={layer:d,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(d){this._requestRedraw(d)},_removePath:function(d){var b=d._order,D=b.next,H=b.prev;D?D.prev=H:this._drawLast=H,H?H.next=D:this._drawFirst=D,delete d._order,delete this._layers[w(d)],this._requestRedraw(d)},_updatePath:function(d){this._extendRedrawBounds(d),d._project(),d._update(),this._requestRedraw(d)},_updateStyle:function(d){this._updateDashArray(d),this._requestRedraw(d)},_updateDashArray:function(d){if(typeof d.options.dashArray=="string"){var b=d.options.dashArray.split(/[, ]+/),D=[],H,ut;for(ut=0;ut<b.length;ut++){if(H=Number(b[ut]),isNaN(H))return;D.push(H)}d.options._dashArray=D}else d.options._dashArray=d.options.dashArray},_requestRedraw:function(d){this._map&&(this._extendRedrawBounds(d),this._redrawRequest=this._redrawRequest||de(this._redraw,this))},_extendRedrawBounds:function(d){if(d._pxBounds){var b=(d.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ue,this._redrawBounds.extend(d._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(d._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var d=this._redrawBounds;if(d){var b=d.getSize();this._ctx.clearRect(d.min.x,d.min.y,b.x,b.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var d,b=this._redrawBounds;if(this._ctx.save(),b){var D=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,D.x,D.y),this._ctx.clip()}this._drawing=!0;for(var H=this._drawFirst;H;H=H.next)d=H.layer,(!b||d._pxBounds&&d._pxBounds.intersects(b))&&d._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(d,b){if(this._drawing){var D,H,ut,St,ne=d._parts,Ve=ne.length,sn=this._ctx;if(Ve){for(sn.beginPath(),D=0;D<Ve;D++){for(H=0,ut=ne[D].length;H<ut;H++)St=ne[D][H],sn[H?"lineTo":"moveTo"](St.x,St.y);b&&sn.closePath()}this._fillStroke(sn,d)}}},_updateCircle:function(d){if(!(!this._drawing||d._empty())){var b=d._point,D=this._ctx,H=Math.max(Math.round(d._radius),1),ut=(Math.max(Math.round(d._radiusY),1)||H)/H;ut!==1&&(D.save(),D.scale(1,ut)),D.beginPath(),D.arc(b.x,b.y/ut,H,0,Math.PI*2,!1),ut!==1&&D.restore(),this._fillStroke(D,d)}},_fillStroke:function(d,b){var D=b.options;D.fill&&(d.globalAlpha=D.fillOpacity,d.fillStyle=D.fillColor||D.color,d.fill(D.fillRule||"evenodd")),D.stroke&&D.weight!==0&&(d.setLineDash&&d.setLineDash(b.options&&b.options._dashArray||[]),d.globalAlpha=D.opacity,d.lineWidth=D.weight,d.strokeStyle=D.color,d.lineCap=D.lineCap,d.lineJoin=D.lineJoin,d.stroke())},_onClick:function(d){for(var b=this._map.mouseEventToLayerPoint(d),D,H,ut=this._drawFirst;ut;ut=ut.next)D=ut.layer,D.options.interactive&&D._containsPoint(b)&&(!(d.type==="click"||d.type==="preclick")||!this._map._draggableMoved(D))&&(H=D);this._fireEvent(H?[H]:!1,d)},_onMouseMove:function(d){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var b=this._map.mouseEventToLayerPoint(d);this._handleMouseHover(d,b)}},_handleMouseOut:function(d){var b=this._hoveredLayer;b&&(Tr(this._container,"leaflet-interactive"),this._fireEvent([b],d,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(d,b){if(!this._mouseHoverThrottled){for(var D,H,ut=this._drawFirst;ut;ut=ut.next)D=ut.layer,D.options.interactive&&D._containsPoint(b)&&(H=D);H!==this._hoveredLayer&&(this._handleMouseOut(d),H&&(Si(this._container,"leaflet-interactive"),this._fireEvent([H],d,"mouseover"),this._hoveredLayer=H)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,d),this._mouseHoverThrottled=!0,setTimeout(p(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(d,b,D){this._map._fireDOMEvent(b,D||b.type,d)},_bringToFront:function(d){var b=d._order;if(b){var D=b.next,H=b.prev;if(D)D.prev=H;else return;H?H.next=D:D&&(this._drawFirst=D),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(d)}},_bringToBack:function(d){var b=d._order;if(b){var D=b.next,H=b.prev;if(H)H.next=D;else return;D?D.prev=H:H&&(this._drawLast=H),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(d)}}});function Gi(d){return Ht.canvas?new Mi(d):null}var or=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(d){return document.createElement("<lvml:"+d+' class="lvml">')}}catch{}return function(d){return document.createElement("<"+d+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ii={_initContainer:function(){this._container=cr("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(mi.prototype._update.call(this),this.fire("update"))},_initPath:function(d){var b=d._container=or("shape");Si(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",d._path=or("path"),b.appendChild(d._path),this._updateStyle(d),this._layers[w(d)]=d},_addPath:function(d){var b=d._container;this._container.appendChild(b),d.options.interactive&&d.addInteractiveTarget(b)},_removePath:function(d){var b=d._container;Kr(b),d.removeInteractiveTarget(b),delete this._layers[w(d)]},_updateStyle:function(d){var b=d._stroke,D=d._fill,H=d.options,ut=d._container;ut.stroked=!!H.stroke,ut.filled=!!H.fill,H.stroke?(b||(b=d._stroke=or("stroke")),ut.appendChild(b),b.weight=H.weight+"px",b.color=H.color,b.opacity=H.opacity,H.dashArray?b.dashStyle=lt(H.dashArray)?H.dashArray.join(" "):H.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=H.lineCap.replace("butt","flat"),b.joinstyle=H.lineJoin):b&&(ut.removeChild(b),d._stroke=null),H.fill?(D||(D=d._fill=or("fill")),ut.appendChild(D),D.color=H.fillColor||H.color,D.opacity=H.fillOpacity):D&&(ut.removeChild(D),d._fill=null)},_updateCircle:function(d){var b=d._point.round(),D=Math.round(d._radius),H=Math.round(d._radiusY||D);this._setPath(d,d._empty()?"M0 0":"AL "+b.x+","+b.y+" "+D+","+H+" 0,"+65535*360)},_setPath:function(d,b){d._path.v=b},_bringToFront:function(d){jn(d._container)},_bringToBack:function(d){Ti(d._container)}},fo=Ht.vml?or:st,po=mi.extend({_initContainer:function(){this._container=fo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=fo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Kr(this._container),zr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){mi.prototype._update.call(this);var d=this._bounds,b=d.getSize(),D=this._container;(!this._svgSize||!this._svgSize.equals(b))&&(this._svgSize=b,D.setAttribute("width",b.x),D.setAttribute("height",b.y)),ir(D,d.min),D.setAttribute("viewBox",[d.min.x,d.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(d){var b=d._path=fo("path");d.options.className&&Si(b,d.options.className),d.options.interactive&&Si(b,"leaflet-interactive"),this._updateStyle(d),this._layers[w(d)]=d},_addPath:function(d){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(d._path),d.addInteractiveTarget(d._path)},_removePath:function(d){Kr(d._path),d.removeInteractiveTarget(d._path),delete this._layers[w(d)]},_updatePath:function(d){d._project(),d._update()},_updateStyle:function(d){var b=d._path,D=d.options;b&&(D.stroke?(b.setAttribute("stroke",D.color),b.setAttribute("stroke-opacity",D.opacity),b.setAttribute("stroke-width",D.weight),b.setAttribute("stroke-linecap",D.lineCap),b.setAttribute("stroke-linejoin",D.lineJoin),D.dashArray?b.setAttribute("stroke-dasharray",D.dashArray):b.removeAttribute("stroke-dasharray"),D.dashOffset?b.setAttribute("stroke-dashoffset",D.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),D.fill?(b.setAttribute("fill",D.fillColor||D.color),b.setAttribute("fill-opacity",D.fillOpacity),b.setAttribute("fill-rule",D.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(d,b){this._setPath(d,gt(d._parts,b))},_updateCircle:function(d){var b=d._point,D=Math.max(Math.round(d._radius),1),H=Math.max(Math.round(d._radiusY),1)||D,ut="a"+D+","+H+" 0 1,0 ",St=d._empty()?"M0 0":"M"+(b.x-D)+","+b.y+ut+D*2+",0 "+ut+-D*2+",0 ";this._setPath(d,St)},_setPath:function(d,b){d._path.setAttribute("d",b)},_bringToFront:function(d){jn(d._path)},_bringToBack:function(d){Ti(d._path)}});Ht.vml&&po.include(Ii);function rs(d){return Ht.svg||Ht.vml?new po(d):null}$t.include({getRenderer:function(d){var b=d.options.renderer||this._getPaneRenderer(d.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(d){if(d==="overlayPane"||d===void 0)return!1;var b=this._paneRenderers[d];return b===void 0&&(b=this._createRenderer({pane:d}),this._paneRenderers[d]=b),b},_createRenderer:function(d){return this.options.preferCanvas&&Gi(d)||rs(d)}});var Rr=Ll.extend({initialize:function(d,b){Ll.prototype.initialize.call(this,this._boundsToLatLngs(d),b)},setBounds:function(d){return this.setLatLngs(this._boundsToLatLngs(d))},_boundsToLatLngs:function(d){return d=ve(d),[d.getSouthWest(),d.getNorthWest(),d.getNorthEast(),d.getSouthEast()]}});function zs(d,b){return new Rr(d,b)}po.create=fo,po.pointsToPath=gt,gl.geometryToLayer=dr,gl.coordsToLatLng=Xo,gl.coordsToLatLngs=ws,gl.latLngToCoords=_l,gl.latLngsToCoords=Wu,gl.getFeature=Jl,gl.asFeature=Yu,$t.mergeOptions({boxZoom:!0});var Ws=pn.extend({initialize:function(d){this._map=d,this._container=d._container,this._pane=d._panes.overlayPane,this._resetStateTimeout=0,d.on("unload",this._destroy,this)},addHooks:function(){wi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Kr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(d){if(!d.shiftKey||d.which!==1&&d.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ns(),Ks(),this._startPoint=this._map.mouseEventToContainerPoint(d),wi(document,{contextmenu:rr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(d){this._moved||(this._moved=!0,this._box=cr("div","leaflet-zoom-box",this._container),Si(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(d);var b=new ue(this._point,this._startPoint),D=b.getSize();ir(this._box,b.min),this._box.style.width=D.x+"px",this._box.style.height=D.y+"px"},_finish:function(){this._moved&&(Kr(this._box),Tr(this._container,"leaflet-crosshair")),is(),Us(),zr(document,{contextmenu:rr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(d){if(!(d.which!==1&&d.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(p(this._resetState,this),0);var b=new Ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(d){d.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});$t.addInitHook("addHandler","boxZoom",Ws),$t.mergeOptions({doubleClickZoom:!0});var Bo=pn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(d){var b=this._map,D=b.getZoom(),H=b.options.zoomDelta,ut=d.originalEvent.shiftKey?D-H:D+H;b.options.doubleClickZoom==="center"?b.setZoom(ut):b.setZoomAround(d.containerPoint,ut)}});$t.addInitHook("addHandler","doubleClickZoom",Bo),$t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var kl=pn.extend({addHooks:function(){if(!this._draggable){var d=this._map;this._draggable=new Fn(d._mapPane,d._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),d.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),d.on("zoomend",this._onZoomEnd,this),d.whenReady(this._onZoomEnd,this))}Si(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Tr(this._map._container,"leaflet-grab"),Tr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var d=this._map;if(d._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=ve(this._map.options.maxBounds);this._offsetLimit=Yt(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;d.fire("movestart").fire("dragstart"),d.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(d){if(this._map.options.inertia){var b=this._lastTime=+new Date,D=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(D),this._times.push(b),this._prunePositions(b)}this._map.fire("move",d).fire("drag",d)},_prunePositions:function(d){for(;this._positions.length>1&&d-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var d=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(d).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(d,b){return d-(d-b)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var d=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;d.x<b.min.x&&(d.x=this._viscousLimit(d.x,b.min.x)),d.y<b.min.y&&(d.y=this._viscousLimit(d.y,b.min.y)),d.x>b.max.x&&(d.x=this._viscousLimit(d.x,b.max.x)),d.y>b.max.y&&(d.y=this._viscousLimit(d.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(d)}},_onPreDragWrap:function(){var d=this._worldWidth,b=Math.round(d/2),D=this._initialWorldOffset,H=this._draggable._newPos.x,ut=(H-b+D)%d+b-D,St=(H+b+D)%d-b-D,ne=Math.abs(ut+D)<Math.abs(St+D)?ut:St;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ne},_onDragEnd:function(d){var b=this._map,D=b.options,H=!D.inertia||d.noInertia||this._times.length<2;if(b.fire("dragend",d),H)b.fire("moveend");else{this._prunePositions(+new Date);var ut=this._lastPos.subtract(this._positions[0]),St=(this._lastTime-this._times[0])/1e3,ne=D.easeLinearity,Ve=ut.multiplyBy(ne/St),sn=Ve.distanceTo([0,0]),On=Math.min(D.inertiaMaxSpeed,sn),ii=Ve.multiplyBy(On/sn),Zi=On/(D.inertiaDeceleration*ne),Qi=ii.multiplyBy(-Zi/2).round();!Qi.x&&!Qi.y?b.fire("moveend"):(Qi=b._limitOffset(Qi,b.options.maxBounds),de(function(){b.panBy(Qi,{duration:Zi,easeLinearity:ne,noMoveStart:!0,animate:!0})}))}}});$t.addInitHook("addHandler","dragging",kl),$t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Pl=pn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(d){this._map=d,this._setPanDelta(d.options.keyboardPanDelta),this._setZoomDelta(d.options.zoomDelta)},addHooks:function(){var d=this._map._container;d.tabIndex<=0&&(d.tabIndex="0"),wi(d,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var d=document.body,b=document.documentElement,D=d.scrollTop||b.scrollTop,H=d.scrollLeft||b.scrollLeft;this._map._container.focus(),window.scrollTo(H,D)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(d){var b=this._panKeys={},D=this.keyCodes,H,ut;for(H=0,ut=D.left.length;H<ut;H++)b[D.left[H]]=[-1*d,0];for(H=0,ut=D.right.length;H<ut;H++)b[D.right[H]]=[d,0];for(H=0,ut=D.down.length;H<ut;H++)b[D.down[H]]=[0,d];for(H=0,ut=D.up.length;H<ut;H++)b[D.up[H]]=[0,-1*d]},_setZoomDelta:function(d){var b=this._zoomKeys={},D=this.keyCodes,H,ut;for(H=0,ut=D.zoomIn.length;H<ut;H++)b[D.zoomIn[H]]=d;for(H=0,ut=D.zoomOut.length;H<ut;H++)b[D.zoomOut[H]]=-d},_addHooks:function(){wi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(d){if(!(d.altKey||d.ctrlKey||d.metaKey)){var b=d.keyCode,D=this._map,H;if(b in this._panKeys){if(!D._panAnim||!D._panAnim._inProgress)if(H=this._panKeys[b],d.shiftKey&&(H=be(H).multiplyBy(3)),D.options.maxBounds&&(H=D._limitOffset(be(H),D.options.maxBounds)),D.options.worldCopyJump){var ut=D.wrapLatLng(D.unproject(D.project(D.getCenter()).add(H)));D.panTo(ut)}else D.panBy(H)}else if(b in this._zoomKeys)D.setZoom(D.getZoom()+(d.shiftKey?3:1)*this._zoomKeys[b]);else if(b===27&&D._popup&&D._popup.options.closeOnEscapeKey)D.closePopup();else return;rr(d)}}});$t.addInitHook("addHandler","keyboard",Pl),$t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _c=pn.extend({addHooks:function(){wi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(d){var b=Es(d),D=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(d),this._startTime||(this._startTime=+new Date);var H=Math.max(D-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(p(this._performZoom,this),H),rr(d)},_performZoom:function(){var d=this._map,b=d.getZoom(),D=this._map.options.zoomSnap||0;d._stop();var H=this._delta/(this._map.options.wheelPxPerZoomLevel*4),ut=4*Math.log(2/(1+Math.exp(-Math.abs(H))))/Math.LN2,St=D?Math.ceil(ut/D)*D:ut,ne=d._limitZoom(b+(this._delta>0?St:-St))-b;this._delta=0,this._startTime=null,ne&&(d.options.scrollWheelZoom==="center"?d.setZoom(b+ne):d.setZoomAround(this._lastMousePos,b+ne))}});$t.addInitHook("addHandler","scrollWheelZoom",_c);var $n=600;$t.mergeOptions({tapHold:Ht.touchNative&&Ht.safari&&Ht.mobile,tapTolerance:15});var Oa=pn.extend({addHooks:function(){wi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(d){if(clearTimeout(this._holdTimeout),d.touches.length===1){var b=d.touches[0];this._startPos=this._newPos=new _e(b.clientX,b.clientY),this._holdTimeout=setTimeout(p(function(){this._cancel(),this._isTapValid()&&(wi(document,"touchend",Ei),wi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",b))},this),$n),wi(document,"touchend touchcancel contextmenu",this._cancel,this),wi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function d(){zr(document,"touchend",Ei),zr(document,"touchend touchcancel",d)},_cancel:function(){clearTimeout(this._holdTimeout),zr(document,"touchend touchcancel contextmenu",this._cancel,this),zr(document,"touchmove",this._onMove,this)},_onMove:function(d){var b=d.touches[0];this._newPos=new _e(b.clientX,b.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(d,b){var D=new MouseEvent(d,{bubbles:!0,cancelable:!0,view:window,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY});D._simulated=!0,b.target.dispatchEvent(D)}});$t.addInitHook("addHandler","tapHold",Oa),$t.mergeOptions({touchZoom:Ht.touch,bounceAtZoomLimits:!0});var Ql=pn.extend({addHooks:function(){Si(this._map._container,"leaflet-touch-zoom"),wi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Tr(this._map._container,"leaflet-touch-zoom"),zr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(d){var b=this._map;if(!(!d.touches||d.touches.length!==2||b._animatingZoom||this._zooming)){var D=b.mouseEventToContainerPoint(d.touches[0]),H=b.mouseEventToContainerPoint(d.touches[1]);this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),b.options.touchZoom!=="center"&&(this._pinchStartLatLng=b.containerPointToLatLng(D.add(H)._divideBy(2))),this._startDist=D.distanceTo(H),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),wi(document,"touchmove",this._onTouchMove,this),wi(document,"touchend touchcancel",this._onTouchEnd,this),Ei(d)}},_onTouchMove:function(d){if(!(!d.touches||d.touches.length!==2||!this._zooming)){var b=this._map,D=b.mouseEventToContainerPoint(d.touches[0]),H=b.mouseEventToContainerPoint(d.touches[1]),ut=D.distanceTo(H)/this._startDist;if(this._zoom=b.getScaleZoom(ut,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&ut<1||this._zoom>b.getMaxZoom()&&ut>1)&&(this._zoom=b._limitZoom(this._zoom)),b.options.touchZoom==="center"){if(this._center=this._startLatLng,ut===1)return}else{var St=D._add(H)._divideBy(2)._subtract(this._centerPoint);if(ut===1&&St.x===0&&St.y===0)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(St),this._zoom)}this._moved||(b._moveStart(!0,!1),this._moved=!0),Et(this._animRequest);var ne=p(b._move,b,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=de(ne,this,!0),Ei(d)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Et(this._animRequest),zr(document,"touchmove",this._onTouchMove,this),zr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});$t.addInitHook("addHandler","touchZoom",Ql),$t.BoxZoom=Ws,$t.DoubleClickZoom=Bo,$t.Drag=kl,$t.Keyboard=Pl,$t.ScrollWheelZoom=_c,$t.TapHold=Oa,$t.TouchZoom=Ql,n.Bounds=ue,n.Browser=Ht,n.CRS=mn,n.Canvas=Mi,n.Circle=El,n.CircleMarker=$a,n.Class=ht,n.Control=C,n.DivIcon=Ce,n.DivOverlay=Ps,n.DomEvent=vt,n.DomUtil=Vo,n.Draggable=Fn,n.Evented=Le,n.FeatureGroup=Zs,n.GeoJSON=gl,n.GridLayer=ke,n.Handler=pn,n.Icon=Na,n.ImageOverlay=on,n.LatLng=ye,n.LatLngBounds=Ee,n.Layer=ys,n.LayerGroup=Wo,n.LineUtil=us,n.Map=$t,n.Marker=bu,n.Mixin=qe,n.Path=xs,n.Point=_e,n.PolyUtil=ma,n.Polygon=Ll,n.Polyline=ho,n.Popup=Kl,n.PosAnimation=Lt,n.Projection=mc,n.Rectangle=Rr,n.Renderer=mi,n.SVG=po,n.SVGOverlay=Do,n.TileLayer=Sn,n.Tooltip=Nt,n.Transformation=Pn,n.Util=te,n.VideoOverlay=Bi,n.bind=p,n.bounds=Yt,n.canvas=Gi,n.circle=ga,n.circleMarker=gc,n.control=z,n.divIcon=vn,n.extend=l,n.featureGroup=Fc,n.geoJSON=ze,n.geoJson=gn,n.gridLayer=rn,n.icon=xu,n.imageOverlay=ni,n.latLng=fe,n.latLngBounds=ve,n.layerGroup=ql,n.map=oe,n.marker=Ha,n.point=be,n.polygon=Vu,n.polyline=Ml,n.popup=Vs,n.rectangle=zs,n.setOptions=q,n.stamp=w,n.svg=rs,n.svgOverlay=Lr,n.tileLayer=Yn,n.tooltip=ae,n.transformation=cn,n.version=o,n.videoOverlay=Sr;var jc=window.L;n.noConflict=function(){return window.L=jc,this},window.L=n})})(ND,Bc);const ll=Bc;function ry(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function Ux(t,e){return e==null?function(o,l){const c=Jn.useRef();return c.current||(c.current=t(o,l)),c}:function(o,l){const c=Jn.useRef();c.current||(c.current=t(o,l));const p=Jn.useRef(o),{instance:r}=c.current;return Jn.useEffect(function(){p.current!==o&&(e(r,o,p.current),p.current=o)},[r,o,l]),c}}function EL(t,e){Jn.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var c;(c=e.layerContainer)==null||c.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function OD(t){return function(n){const o=kg(),l=t(jx(n,o),o);return AL(o.map,n.attribution),iA(l.current,n.eventHandlers),EL(l.current,o),l}}function RD(t,e){const n=Jn.useRef();Jn.useEffect(function(){if(e.pathOptions!==n.current){const l=e.pathOptions??{};t.instance.setStyle(l),n.current=l}},[t,e])}function BD(t){return function(n){const o=kg(),l=t(jx(n,o),o);return iA(l.current,n.eventHandlers),EL(l.current,o),RD(l.current,n),l}}function FD(t,e){const n=Ux(t),o=DD(n,e);return kD(o)}function ML(t,e){const n=Ux(t,e),o=BD(n);return SL(o)}function jD(t,e){const n=Ux(t,e),o=OD(n);return PD(o)}function UD(t,e,n){const{opacity:o,zIndex:l}=e;o!=null&&o!==n.opacity&&t.setOpacity(o),l!=null&&l!==n.zIndex&&t.setZIndex(l)}const cc=ML(function({children:e,...n},o){const l=new Bc.FeatureGroup([],n);return ry(l,Fx(o,{layerContainer:l,overlayContainer:l}))}),If=ML(function({data:e,...n},o){const l=new Bc.GeoJSON(e,n);return ry(l,Fx(o,{overlayContainer:l}))},function(e,n,o){n.style!==o.style&&(n.style==null?e.resetStyle():e.setStyle(n.style))}),GD=Ux(function({children:e,...n},o){const l=new Bc.Control.Layers(void 0,void 0,n);return ry(l,Fx(o,{layersControl:l}))},function(e,n,o){n.collapsed!==o.collapsed&&(n.collapsed===!0?e.collapse():e.expand())}),ZD=zD(GD),hh=SL(ZD);function LL(t){return function(n){const o=kg(),l=Jn.useRef(n),[c,p]=Jn.useState(null),{layersControl:r,map:w}=o,M=Jn.useCallback(Z=>{r!=null&&(l.current.checked&&w.addLayer(Z),t(r,Z,l.current.name),p(Z))},[r,w]),N=Jn.useCallback(Z=>{r==null||r.removeLayer(Z),p(null)},[r]),E=Jn.useMemo(()=>Fx(o,{layerContainer:{addLayer:M,removeLayer:N}}),[o,M,N]);return Jn.useEffect(()=>{c!==null&&l.current!==n&&(n.checked===!0&&(l.current.checked==null||l.current.checked===!1)?w.addLayer(c):l.current.checked===!0&&(n.checked==null||n.checked===!1)&&w.removeLayer(c),l.current=n)}),n.children?Aa.createElement(nA,{value:E},n.children):null}}hh.BaseLayer=LL(function(e,n,o){e.addBaseLayer(n,o)});hh.Overlay=LL(function(e,n,o){e.addOverlay(n,o)});function jC(){return jC=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},jC.apply(this,arguments)}function VD({bounds:t,boundsOptions:e,center:n,children:o,className:l,id:c,placeholder:p,style:r,whenReady:w,zoom:M,...N},E){const[Z]=Jn.useState({className:l,id:c,style:r}),[Y,K]=Jn.useState(null);Jn.useImperativeHandle(E,()=>(Y==null?void 0:Y.map)??null,[Y]);const q=Jn.useCallback(J=>{if(J!==null&&Y===null){const Q=new Bc.Map(J,N);n!=null&&M!=null?Q.setView(n,M):t!=null&&Q.fitBounds(t,e),w!=null&&Q.whenReady(w),K(LD(Q))}},[]);Jn.useEffect(()=>()=>{Y==null||Y.map.remove()},[Y]);const at=Y?Aa.createElement(nA,{value:Y},o):p??null;return Aa.createElement("div",jC({},Z,{ref:q}),at)}const Gx=Jn.forwardRef(VD),Cf=FD(function(e,n){const o=new Bc.Popup(e,n.overlayContainer);return ry(o,n)},function(e,n,{position:o},l){Jn.useEffect(function(){const{instance:p}=e;function r(M){M.popup===p&&(p.update(),l(!0))}function w(M){M.popup===p&&l(!1)}return n.map.on({popupopen:r,popupclose:w}),n.overlayContainer==null?(o!=null&&p.setLatLng(o),p.openOn(n.map)):n.overlayContainer.bindPopup(p),function(){var N;n.map.off({popupopen:r,popupclose:w}),(N=n.overlayContainer)==null||N.unbindPopup(),n.map.removeLayer(p)}},[e,n,l,o])}),Zx=jD(function({url:e,...n},o){const l=new Bc.TileLayer(e,jx(n,o));return ry(l,o)},function(e,n,o){UD(e,n,o);const{url:l}=n;l!=null&&l!==o.url&&e.setUrl(l)});var jr={},WD={get exports(){return jr},set exports(t){jr=t}},YD="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",XD=YD,HD=XD;function kL(){}function PL(){}PL.resetWarningCache=kL;var $D=function(){function t(o,l,c,p,r,w){if(w!==HD){var M=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw M.name="Invariant Violation",M}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:PL,resetWarningCache:kL};return n.PropTypes=n,n};WD.exports=$D();(function(t,e,n){function o(l,c){for(;(l=l.parentElement)&&!l.classList.contains(c););return l}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(l,c){this._map=l,this._container=l._container,this._overlayPane=l._panes.overlayPane,this._popupPane=l._panes.popupPane,c&&c.shapeOptions&&(c.shapeOptions=L.Util.extend({},this.options.shapeOptions,c.shapeOptions)),L.setOptions(this,c);var p=L.version.split(".");parseInt(p[0],10)===1&&parseInt(p[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var l=this._map;l&&(L.DomUtil.disableTextSelection(),l.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(l){L.setOptions(this,l)},_fireCreatedEvent:function(l){this._map.fire(L.Draw.Event.CREATED,{layer:l,layerType:this.type})},_cancelDrawing:function(l){l.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(l,c){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,c&&c.drawError&&(c.drawError=L.Util.extend({},this.options.drawError,c.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,l,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var l=this._markers.pop(),c=this._poly,p=c.getLatLngs(),r=p.splice(-1,1)[0];this._poly.setLatLngs(p),this._markerGroup.removeLayer(l),c.getLatLngs().length<2&&this._map.removeLayer(c),this._vertexChanged(r,!1)}},addVertex:function(l){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(l))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(l)),this._poly.addLatLng(l),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(l,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var l=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),c=this._poly.newLatLngIntersects(l[l.length-1]);if(!this.options.allowIntersection&&c||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(l){var c=this._map.mouseEventToLayerPoint(l.originalEvent),p=this._map.layerPointToLatLng(c);this._currentLatLng=p,this._updateTooltip(p),this._updateGuide(c),this._mouseMarker.setLatLng(p),L.DomEvent.preventDefault(l.originalEvent)},_vertexChanged:function(l,c){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(l,c),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(l){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(l),this._clickHandled=!0,this._disableNewMarkers();var c=l.originalEvent,p=c.clientX,r=c.clientY;this._startPoint.call(this,p,r)}},_startPoint:function(l,c){this._mouseDownOrigin=L.point(l,c)},_onMouseUp:function(l){var c=l.originalEvent,p=c.clientX,r=c.clientY;this._endPoint.call(this,p,r,l),this._clickHandled=null},_endPoint:function(l,c,p){if(this._mouseDownOrigin){var r=L.point(l,c).distanceTo(this._mouseDownOrigin),w=this._calculateFinishDistance(p.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(p.latlng),this._finishShape()):w<10&&L.Browser.touch?this._finishShape():Math.abs(r)<9*(t.devicePixelRatio||1)&&this.addVertex(p.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(l){var c,p,r=l.originalEvent;!r.touches||!r.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(c=r.touches[0].clientX,p=r.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,c,p),this._endPoint.call(this,c,p,l),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(l){var c;if(this._markers.length>0){var p;if(this.type===L.Draw.Polyline.TYPE)p=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;p=this._markers[0]}var r=this._map.latLngToContainerPoint(p.getLatLng()),w=new L.Marker(l,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),M=this._map.latLngToContainerPoint(w.getLatLng());c=r.distanceTo(M)}else c=1/0;return c},_updateFinishHandler:function(){var l=this._markers.length;l>1&&this._markers[l-1].on("click",this._finishShape,this),l>2&&this._markers[l-2].off("click",this._finishShape,this)},_createMarker:function(l){var c=new L.Marker(l,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(c),c},_updateGuide:function(l){var c=this._markers?this._markers.length:0;c>0&&(l=l||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[c-1].getLatLng()),l))},_updateTooltip:function(l){var c=this._getTooltipText();l&&this._tooltip.updatePosition(l),this._errorShown||this._tooltip.updateContent(c)},_drawGuide:function(l,c){var p,r,w,M=Math.floor(Math.sqrt(Math.pow(c.x-l.x,2)+Math.pow(c.y-l.y,2))),N=this.options.guidelineDistance,E=this.options.maxGuideLineLength,Z=M>E?M-E:N;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));Z<M;Z+=this.options.guidelineDistance)p=Z/M,r={x:Math.floor(l.x*(1-p)+p*c.x),y:Math.floor(l.y*(1-p)+p*c.y)},w=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),w.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(w,r)},_updateGuideColor:function(l){if(this._guidesContainer)for(var c=0,p=this._guidesContainer.childNodes.length;c<p;c++)this._guidesContainer.childNodes[c].style.backgroundColor=l},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var l,c,p=this.options.showLength;return this._markers.length===0?l={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(c=p?this._getMeasurementString():"",l=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:c}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:c}),l},_updateRunningMeasure:function(l,c){var p,r,w=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(p=w-(c?2:1),r=L.GeometryUtil.isVersion07x()?l.distanceTo(this._markers[p].getLatLng())*(this.options.factor||1):this._map.distance(l,this._markers[p].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=r*(c?1:-1))},_getMeasurementString:function(){var l,c=this._currentLatLng,p=this._markers[this._markers.length-1].getLatLng();return l=L.GeometryUtil.isVersion07x()?p&&c&&c.distanceTo?this._measurementRunningTotal+c.distanceTo(p)*(this.options.factor||1):this._measurementRunningTotal||0:p&&c?this._measurementRunningTotal+this._map.distance(c,p)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(l,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var l=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,l)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(l,c){L.Draw.Polyline.prototype.initialize.call(this,l,c),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var l=this._markers.length;l===1&&this._markers[0].on("click",this._finishShape,this),l>2&&(this._markers[l-1].on("dblclick",this._finishShape,this),l>3&&this._markers[l-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var l,c;return this._markers.length===0?l=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(l=L.drawLocal.draw.handlers.polygon.tooltip.cont,c=this._getMeasurementString()):(l=L.drawLocal.draw.handlers.polygon.tooltip.end,c=this._getMeasurementString()),{text:l,subtext:c}},_getMeasurementString:function(){var l=this._area,c="";return l||this.options.showLength?(this.options.showLength&&(c=L.Draw.Polyline.prototype._getMeasurementString.call(this)),l&&(c+="<br>"+L.GeometryUtil.readableArea(l,this.options.metric,this.options.precision)),c):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(l,c){var p;!this.options.allowIntersection&&this.options.showArea&&(p=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(p)),L.Draw.Polyline.prototype._vertexChanged.call(this,l,c)},_cleanUpShape:function(){var l=this._markers.length;l>0&&(this._markers[0].off("click",this._finishShape,this),l>2&&this._markers[l-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(l,c){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,l,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),e.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),e.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(l){this._isDrawing=!0,this._startLatLng=l.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(l.originalEvent)},_onMouseMove:function(l){var c=l.latlng;this._tooltip.updatePosition(c),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(c))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(l,c){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,l,c)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(l){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!o(l.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(l){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,l)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,l),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var l=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,l)},_getTooltipText:function(){var l,c,p,r=L.Draw.SimpleShape.prototype._getTooltipText.call(this),w=this._shape,M=this.options.showArea;return w&&(l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=L.GeometryUtil.geodesicArea(l),p=M?L.GeometryUtil.readableArea(c,this.options.metric):""),{text:r.text,subtext:p}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(l,c){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,l,c)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(l){var c=l.latlng;this._tooltip.updatePosition(c),this._mouseMarker.setLatLng(c),this._marker?(c=this._mouseMarker.getLatLng(),this._marker.setLatLng(c)):(this._marker=this._createMarker(c),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(l){return new L.Marker(l,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(l){this._onMouseMove(l),this._onClick()},_fireCreatedEvent:function(){var l=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,l)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(l,c){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,l,c)},_fireCreatedEvent:function(){var l=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,l)},_createMarker:function(l){return new L.CircleMarker(l,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(l,c){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,l,c)},_drawShape:function(l){if(L.GeometryUtil.isVersion07x())var c=this._startLatLng.distanceTo(l);else var c=this._map.distance(this._startLatLng,l);this._shape?this._shape.setRadius(c):(this._shape=new L.Circle(this._startLatLng,c,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var l=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,l)},_onMouseMove:function(l){var c,p=l.latlng,r=this.options.showRadius,w=this.options.metric;if(this._tooltip.updatePosition(p),this._isDrawing){this._drawShape(p),c=this._shape.getRadius().toFixed(1);var M="";r&&(M=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(c,w,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:M})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(l,c){this._marker=l,L.setOptions(this,c)},addHooks:function(){var l=this._marker;l.dragging.enable(),l.on("dragend",this._onDragEnd,l),this._toggleMarkerHighlight()},removeHooks:function(){var l=this._marker;l.dragging.disable(),l.off("dragend",this._onDragEnd,l),this._toggleMarkerHighlight()},_onDragEnd:function(l){var c=l.target;c.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:c})},_toggleMarkerHighlight:function(){var l=this._marker._icon;l&&(l.style.display="none",L.DomUtil.hasClass(l,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(l,"leaflet-edit-marker-selected"),this._offsetMarker(l,-4)):(L.DomUtil.addClass(l,"leaflet-edit-marker-selected"),this._offsetMarker(l,4)),l.style.display="")},_offsetMarker:function(l,c){var p=parseInt(l.style.marginTop,10)-c,r=parseInt(l.style.marginLeft,10)-c;l.style.marginTop=p+"px",l.style.marginLeft=r+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(l){this.latlngs=[l._latlngs],l._holes&&(this.latlngs=this.latlngs.concat(l._holes)),this._poly=l,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(l){for(var c=0;c<this._verticesHandlers.length;c++)l(this._verticesHandlers[c])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(l){l.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(l){l.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(l){l.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var l=0;l<this.latlngs.length;l++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[l],this._poly.options.poly))},_updateLatLngs:function(l){this.latlngs=[l.layer._latlngs],l.layer._holes&&(this.latlngs=this.latlngs.concat(l.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(l,c,p){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=l,p&&p.drawError&&(p.drawError=L.Util.extend({},this.options.drawError,p.drawError)),this._latlngs=c,L.setOptions(this,p)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var l=this._poly,c=l._path;l instanceof L.Polygon||(l.options.fill=!1,l.options.editing&&(l.options.editing.fill=!1)),c&&l.options.editing&&l.options.editing.className&&(l.options.original.className&&l.options.original.className.split(" ").forEach(function(p){L.DomUtil.removeClass(c,p)}),l.options.editing.className.split(" ").forEach(function(p){L.DomUtil.addClass(c,p)})),l.setStyle(l.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var l=this._poly,c=l._path;c&&l.options.editing&&l.options.editing.className&&(l.options.editing.className.split(" ").forEach(function(p){L.DomUtil.removeClass(c,p)}),l.options.original.className&&l.options.original.className.split(" ").forEach(function(p){L.DomUtil.addClass(c,p)})),l.setStyle(l.options.original),l._map&&(l._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var l,c,p,r,w=this._defaultShape();for(l=0,p=w.length;l<p;l++)r=this._createMarker(w[l],l),r.on("click",this._onMarkerClick,this),r.on("contextmenu",this._onContextMenu,this),this._markers.push(r);var M,N;for(l=0,c=p-1;l<p;c=l++)(l!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(M=this._markers[c],N=this._markers[l],this._createMiddleMarker(M,N),this._updatePrevNext(M,N))},_createMarker:function(l,c){var p=new L.Marker.Touch(l,{draggable:!0,icon:this.options.icon});return p._origLatLng=l,p._index=c,p.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(p),p},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var l=this._defaultShape(),c=[].splice.apply(l,arguments);return this._poly._convertLatLngs(l,!0),this._poly.redraw(),c},_removeMarker:function(l){var c=l._index;this._markerGroup.removeLayer(l),this._markers.splice(c,1),this._spliceLatLngs(c,1),this._updateIndexes(c,-1),l.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(l){var c=l.target,p=this._poly,r=L.LatLngUtil.cloneLatLng(c._origLatLng);if(L.extend(c._origLatLng,c._latlng),p.options.poly){var w=p._map._editTooltip;if(!p.options.poly.allowIntersection&&p.intersects()){L.extend(c._origLatLng,r),c.setLatLng(r);var M=p.options.color;p.setStyle({color:this.options.drawError.color}),w&&w.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){p.setStyle({color:M}),w&&w.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c)),c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var N=this._poly.getLatLngs();this._poly._convertLatLngs(N,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(l){var c=L.Polygon&&this._poly instanceof L.Polygon?4:3,p=l.target;this._defaultShape().length<c||(this._removeMarker(p),this._updatePrevNext(p._prev,p._next),p._middleLeft&&this._markerGroup.removeLayer(p._middleLeft),p._middleRight&&this._markerGroup.removeLayer(p._middleRight),p._prev&&p._next?this._createMiddleMarker(p._prev,p._next):p._prev?p._next||(p._prev._middleRight=null):p._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(l){var c=l.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:c,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(l){var c=this._map.mouseEventToLayerPoint(l.originalEvent.touches[0]),p=this._map.layerPointToLatLng(c),r=l.target;L.extend(r._origLatLng,p),r._middleLeft&&r._middleLeft.setLatLng(this._getMiddleLatLng(r._prev,r)),r._middleRight&&r._middleRight.setLatLng(this._getMiddleLatLng(r,r._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(l,c){this._markerGroup.eachLayer(function(p){p._index>l&&(p._index+=c)})},_createMiddleMarker:function(l,c){var p,r,w,M=this._getMiddleLatLng(l,c),N=this._createMarker(M);N.setOpacity(.6),l._middleRight=c._middleLeft=N,r=function(){N.off("touchmove",r,this);var E=c._index;N._index=E,N.off("click",p,this).on("click",this._onMarkerClick,this),M.lat=N.getLatLng().lat,M.lng=N.getLatLng().lng,this._spliceLatLngs(E,0,M),this._markers.splice(E,0,N),N.setOpacity(1),this._updateIndexes(E,1),c._index++,this._updatePrevNext(l,N),this._updatePrevNext(N,c),this._poly.fire("editstart")},w=function(){N.off("dragstart",r,this),N.off("dragend",w,this),N.off("touchmove",r,this),this._createMiddleMarker(l,N),this._createMiddleMarker(N,c)},p=function(){r.call(this),w.call(this),this._fireEdit()},N.on("click",p,this).on("dragstart",r,this).on("dragend",w,this).on("touchmove",r,this),this._markerGroup.addLayer(N)},_updatePrevNext:function(l,c){l&&(l._next=c),c&&(c._prev=l)},_getMiddleLatLng:function(l,c){var p=this._poly._map,r=p.project(l.getLatLng()),w=p.project(c.getLatLng());return p.unproject(r._add(w)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(l,c){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=l,L.Util.setOptions(this,c)},addHooks:function(){var l=this._shape;this._shape._map&&(this._map=this._shape._map,l.setStyle(l.options.editing),l._map&&(this._map=l._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var l=this._shape;if(l.setStyle(l.options.original),l._map){this._unbindMarker(this._moveMarker);for(var c=0,p=this._resizeMarkers.length;c<p;c++)this._unbindMarker(this._resizeMarkers[c]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(l,c){var p=new L.Marker.Touch(l,{draggable:!0,icon:c,zIndexOffset:10});return this._bindMarker(p),this._markerGroup.addLayer(p),p},_bindMarker:function(l){l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(l){l.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(l){l.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(l){var c=l.target,p=c.getLatLng();c===this._moveMarker?this._move(p):this._resize(p),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(l){l.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(l){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,l),typeof this._getCorners=="function"){var c=this._getCorners(),p=l.target,r=p._cornerIndex;p.setOpacity(0),this._oppositeCorner=c[(r+2)%4],this._toggleCornerMarkers(0,r)}this._shape.fire("editstart")},_onTouchMove:function(l){var c=this._map.mouseEventToLayerPoint(l.originalEvent.touches[0]),p=this._map.layerPointToLatLng(c);return l.target===this._moveMarker?this._move(p):this._resize(p),this._shape.redraw(),!1},_onTouchEnd:function(l){l.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var l=this._shape.getBounds(),c=l.getCenter();this._moveMarker=this._createMarker(c,this.options.moveIcon)},_createResizeMarker:function(){var l=this._getCorners();this._resizeMarkers=[];for(var c=0,p=l.length;c<p;c++)this._resizeMarkers.push(this._createMarker(l[c],this.options.resizeIcon)),this._resizeMarkers[c]._cornerIndex=c},_onMarkerDragStart:function(l){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,l);var c=this._getCorners(),p=l.target,r=p._cornerIndex;this._oppositeCorner=c[(r+2)%4],this._toggleCornerMarkers(0,r)},_onMarkerDragEnd:function(l){var c,p,r=l.target;r===this._moveMarker&&(c=this._shape.getBounds(),p=c.getCenter(),r.setLatLng(p)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,l)},_move:function(l){for(var c,p=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),r=this._shape.getBounds(),w=r.getCenter(),M=[],N=0,E=p.length;N<E;N++)c=[p[N].lat-w.lat,p[N].lng-w.lng],M.push([l.lat+c[0],l.lng+c[1]]);this._shape.setLatLngs(M),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(l){var c;this._shape.setBounds(L.latLngBounds(l,this._oppositeCorner)),c=this._shape.getBounds(),this._moveMarker.setLatLng(c.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var l=this._shape.getBounds();return[l.getNorthWest(),l.getNorthEast(),l.getSouthEast(),l.getSouthWest()]},_toggleCornerMarkers:function(l){for(var c=0,p=this._resizeMarkers.length;c<p;c++)this._resizeMarkers[c].setOpacity(l)},_repositionCornerMarkers:function(){for(var l=this._getCorners(),c=0,p=this._resizeMarkers.length;c<p;c++)this._resizeMarkers[c].setLatLng(l[c])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var l=this._shape.getLatLng();this._moveMarker=this._createMarker(l,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(l){if(this._resizeMarkers.length){var c=this._getResizeMarkerPoint(l);this._resizeMarkers[0].setLatLng(c)}this._shape.setLatLng(l),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var l=this._shape.getLatLng(),c=this._getResizeMarkerPoint(l);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(c,this.options.resizeIcon))},_getResizeMarkerPoint:function(l){var c=this._shape._radius*Math.cos(Math.PI/4),p=this._map.project(l);return this._map.unproject([p.x+c,p.y-c])},_resize:function(l){var c=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=c.distanceTo(l):radius=this._map.distance(c,l),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(l){this._map=l,this._container=l._container,this._pane=l._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(l,c){var p={};if(l.touches!==void 0){if(!l.touches.length)return;p=l.touches[0]}else if(l.pointerType!=="touch"||(p=l,!this._filterClick(l)))return;var r=this._map.mouseEventToContainerPoint(p),w=this._map.mouseEventToLayerPoint(p),M=this._map.layerPointToLatLng(w);this._map.fire(c,{latlng:M,layerPoint:w,containerPoint:r,pageX:p.pageX,pageY:p.pageY,originalEvent:l})},_filterClick:function(l){var c=l.timeStamp||l.originalEvent.timeStamp,p=L.DomEvent._lastClick&&c-L.DomEvent._lastClick;return p&&p>100&&p<500||l.target._simulatedClick&&!l._simulated?(L.DomEvent.stop(l),!1):(L.DomEvent._lastClick=c,!0)},_onTouchStart:function(l){this._map._loaded&&this._touchEvent(l,"touchstart")},_onTouchEnd:function(l){this._map._loaded&&this._touchEvent(l,"touchend")},_onTouchCancel:function(l){if(this._map._loaded){var c="touchcancel";this._detectIE()&&(c="pointercancel"),this._touchEvent(l,c)}},_onTouchLeave:function(l){this._map._loaded&&this._touchEvent(l,"touchleave")},_onTouchMove:function(l){this._map._loaded&&this._touchEvent(l,"touchmove")},_detectIE:function(){var l=t.navigator.userAgent,c=l.indexOf("MSIE ");if(c>0)return parseInt(l.substring(c+5,l.indexOf(".",c)),10);if(l.indexOf("Trident/")>0){var p=l.indexOf("rv:");return parseInt(l.substring(p+3,l.indexOf(".",p)),10)}var r=l.indexOf("Edge/");return r>0&&parseInt(l.substring(r+5,l.indexOf(".",r)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var l=this._icon,c=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?c.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):c.concat(["touchcancel"]),L.DomUtil.addClass(l,"leaflet-clickable"),L.DomEvent.on(l,"click",this._onMouseClick,this),L.DomEvent.on(l,"keypress",this._onKeyPress,this);for(var p=0;p<c.length;p++)L.DomEvent.on(l,c[p],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var l=t.navigator.userAgent,c=l.indexOf("MSIE ");if(c>0)return parseInt(l.substring(c+5,l.indexOf(".",c)),10);if(l.indexOf("Trident/")>0){var p=l.indexOf("rv:");return parseInt(l.substring(p+3,l.indexOf(".",p)),10)}var r=l.indexOf("Edge/");return r>0&&parseInt(l.substring(r+5,l.indexOf(".",r)),10)}}),L.LatLngUtil={cloneLatLngs:function(l){for(var c=[],p=0,r=l.length;p<r;p++)Array.isArray(l[p])?c.push(L.LatLngUtil.cloneLatLngs(l[p])):c.push(this.cloneLatLng(l[p]));return c},cloneLatLng:function(l){return L.latLng(l.lat,l.lng)}},function(){var l={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(c){var p,r,w=c.length,M=0,N=Math.PI/180;if(w>2){for(var E=0;E<w;E++)p=c[E],r=c[(E+1)%w],M+=(r.lng-p.lng)*N*(2+Math.sin(p.lat*N)+Math.sin(r.lat*N));M=6378137*M*6378137/2}return Math.abs(M)},formattedNumber:function(c,p){var r=parseFloat(c).toFixed(p),w=L.drawLocal.format&&L.drawLocal.format.numeric,M=w&&w.delimiters,N=M&&M.thousands,E=M&&M.decimal;if(N||E){var Z=r.split(".");r=N?Z[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+N):Z[0],E=E||".",Z.length>1&&(r=r+E+Z[1])}return r},readableArea:function(c,p,N){var w,M,N=L.Util.extend({},l,N);return p?(M=["ha","m"],type=typeof p,type==="string"?M=[p]:type!=="boolean"&&(M=p),w=c>=1e6&&M.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*c,N.km)+" km²":c>=1e4&&M.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*c,N.ha)+" ha":L.GeometryUtil.formattedNumber(c,N.m)+" m²"):(c/=.836127,w=c>=3097600?L.GeometryUtil.formattedNumber(c/3097600,N.mi)+" mi²":c>=4840?L.GeometryUtil.formattedNumber(c/4840,N.ac)+" acres":L.GeometryUtil.formattedNumber(c,N.yd)+" yd²"),w},readableDistance:function(c,p,r,w,E){var N,E=L.Util.extend({},l,E);switch(p?typeof p=="string"?p:"metric":r?"feet":w?"nauticalMile":"yards"){case"metric":N=c>1e3?L.GeometryUtil.formattedNumber(c/1e3,E.km)+" km":L.GeometryUtil.formattedNumber(c,E.m)+" m";break;case"feet":c*=3.28083,N=L.GeometryUtil.formattedNumber(c,E.ft)+" ft";break;case"nauticalMile":c*=.53996,N=L.GeometryUtil.formattedNumber(c/1e3,E.nm)+" nm";break;case"yards":default:c*=1.09361,N=c>1760?L.GeometryUtil.formattedNumber(c/1760,E.mi)+" miles":L.GeometryUtil.formattedNumber(c,E.yd)+" yd"}return N},isVersion07x:function(){var c=L.version.split(".");return parseInt(c[0],10)===0&&parseInt(c[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(l,c,p,r){return this._checkCounterclockwise(l,p,r)!==this._checkCounterclockwise(c,p,r)&&this._checkCounterclockwise(l,c,p)!==this._checkCounterclockwise(l,c,r)},_checkCounterclockwise:function(l,c,p){return(p.y-l.y)*(c.x-l.x)>(c.y-l.y)*(p.x-l.x)}}),L.Polyline.include({intersects:function(){var l,c,p,r=this._getProjectedPoints(),w=r?r.length:0;if(this._tooFewPointsForIntersection())return!1;for(l=w-1;l>=3;l--)if(c=r[l-1],p=r[l],this._lineSegmentsIntersectsRange(c,p,l-2))return!0;return!1},newLatLngIntersects:function(l,c){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(l),c)},newPointIntersects:function(l,c){var p=this._getProjectedPoints(),r=p?p.length:0,w=p?p[r-1]:null,M=r-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(w,l,M,c?1:0)},_tooFewPointsForIntersection:function(l){var c=this._getProjectedPoints(),p=c?c.length:0;return p+=l||0,!c||p<=3},_lineSegmentsIntersectsRange:function(l,c,p,r){var w,M,N=this._getProjectedPoints();r=r||0;for(var E=p;E>r;E--)if(w=N[E-1],M=N[E],L.LineUtil.segmentsIntersect(l,c,w,M))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var l=[],c=this._defaultShape(),p=0;p<c.length;p++)l.push(this._map.latLngToLayerPoint(c[p]));return l}}),L.Polygon.include({intersects:function(){var l,c,p,r,w=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(l=w.length,c=w[0],p=w[l-1],r=l-2,this._lineSegmentsIntersectsRange(p,c,r,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(l){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,l);var c;this._toolbars={},L.DrawToolbar&&this.options.draw&&(c=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=c,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(c=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=c,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(l){var c,p=L.DomUtil.create("div","leaflet-draw"),r=!1;for(var w in this._toolbars)this._toolbars.hasOwnProperty(w)&&(c=this._toolbars[w].addToolbar(l))&&(r||(L.DomUtil.hasClass(c,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(c.childNodes[0],"leaflet-draw-toolbar-top"),r=!0),p.appendChild(c));return p},onRemove:function(){for(var l in this._toolbars)this._toolbars.hasOwnProperty(l)&&this._toolbars[l].removeToolbar()},setDrawingOptions:function(l){for(var c in this._toolbars)this._toolbars[c]instanceof L.DrawToolbar&&this._toolbars[c].setOptions(l)},_toolbarEnabled:function(l){var c=l.target;for(var p in this._toolbars)this._toolbars[p]!==c&&this._toolbars[p].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(l){L.setOptions(this,l),this._modes={},this._actionButtons=[],this._activeMode=null;var c=L.version.split(".");parseInt(c[0],10)===1&&parseInt(c[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(l){var c,p=L.DomUtil.create("div","leaflet-draw-section"),r=0,w=this._toolbarClass||"",M=this.getModeHandlers(l);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=l,c=0;c<M.length;c++)M[c].enabled&&this._initModeHandler(M[c].handler,this._toolbarContainer,r++,w,M[c].title);if(r)return this._lastButtonIndex=--r,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),p.appendChild(this._toolbarContainer),p.appendChild(this._actionsContainer),p},removeToolbar:function(){for(var l in this._modes)this._modes.hasOwnProperty(l)&&(this._disposeButton(this._modes[l].button,this._modes[l].handler.enable,this._modes[l].handler),this._modes[l].handler.disable(),this._modes[l].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var c=0,p=this._actionButtons.length;c<p;c++)this._disposeButton(this._actionButtons[c].button,this._actionButtons[c].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(l,c,p,r,w){var M=l.type;this._modes[M]={},this._modes[M].handler=l,this._modes[M].button=this._createButton({type:M,title:w,className:r+"-"+M,container:c,callback:this._modes[M].handler.enable,context:this._modes[M].handler}),this._modes[M].buttonIndex=p,this._modes[M].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!t.MSStream},_createButton:function(l){var c=L.DomUtil.create("a",l.className||"",l.container),p=L.DomUtil.create("span","sr-only",l.container);c.href="#",c.appendChild(p),l.title&&(c.title=l.title,p.innerHTML=l.title),l.text&&(c.innerHTML=l.text,p.innerHTML=l.text);var r=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(c,"click",L.DomEvent.stopPropagation).on(c,"mousedown",L.DomEvent.stopPropagation).on(c,"dblclick",L.DomEvent.stopPropagation).on(c,"touchstart",L.DomEvent.stopPropagation).on(c,"click",L.DomEvent.preventDefault).on(c,r,l.callback,l.context),c},_disposeButton:function(l,c){var p=this._detectIOS()?"touchstart":"click";L.DomEvent.off(l,"click",L.DomEvent.stopPropagation).off(l,"mousedown",L.DomEvent.stopPropagation).off(l,"dblclick",L.DomEvent.stopPropagation).off(l,"touchstart",L.DomEvent.stopPropagation).off(l,"click",L.DomEvent.preventDefault).off(l,p,c)},_handlerActivated:function(l){this.disable(),this._activeMode=this._modes[l.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(l){var c,p,r,w,M=this._actionsContainer,N=this.getActions(l),E=N.length;for(p=0,r=this._actionButtons.length;p<r;p++)this._disposeButton(this._actionButtons[p].button,this._actionButtons[p].callback);for(this._actionButtons=[];M.firstChild;)M.removeChild(M.firstChild);for(var Z=0;Z<E;Z++)"enabled"in N[Z]&&!N[Z].enabled||(c=L.DomUtil.create("li","",M),w=this._createButton({title:N[Z].title,text:N[Z].text,container:c,callback:N[Z].callback,context:N[Z].context}),this._actionButtons.push({button:w,callback:N[Z].callback}))},_showActionsToolbar:function(){var l=this._activeMode.buttonIndex,c=this._lastButtonIndex,p=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=p+"px",l===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),l===c&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(l){this._map=l,this._popupPane=l._panes.popupPane,this._visible=!1,this._container=l.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(l){return this._container?(l.subtext=l.subtext||"",l.subtext.length!==0||this._singleLineLabel?l.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(l.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+l.subtext+"</span><br />":"")+"<span>"+l.text+"</span>",l.text||l.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(l){var c=this._map.latLngToLayerPoint(l),p=this._container;return this._container&&(this._visible&&(p.style.visibility="inherit"),L.DomUtil.setPosition(p,c)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(l){for(var c in this.options)this.options.hasOwnProperty(c)&&l[c]&&(l[c]=L.extend({},this.options[c],l[c]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,l)},getModeHandlers:function(l){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(l,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(l,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(l,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(l,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(l,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(l,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(l){return[{enabled:l.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:l.completeShape,context:l},{enabled:l.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:l.deleteLastVertex,context:l},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(l){L.setOptions(this,l);for(var c in this._modes)this._modes.hasOwnProperty(c)&&l.hasOwnProperty(c)&&this._modes[c].handler.setOptions(l[c])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(l){l.edit&&(l.edit.selectedPathOptions===void 0&&(l.edit.selectedPathOptions=this.options.edit.selectedPathOptions),l.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,l.edit.selectedPathOptions)),l.remove&&(l.remove=L.extend({},this.options.remove,l.remove)),l.poly&&(l.poly=L.extend({},this.options.poly,l.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,l),this._selectedFeatureCount=0},getModeHandlers:function(l){var c=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(l,{featureGroup:c,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(l,{featureGroup:c}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(l){var c=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return l.removeAllLayers&&c.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),c},addToolbar:function(l){var c=L.Toolbar.prototype.addToolbar.call(this,l);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),c},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var l,c=this.options.featureGroup,p=c.getLayers().length!==0;this.options.edit&&(l=this._modes[L.EditToolbar.Edit.TYPE].button,p?L.DomUtil.removeClass(l,"leaflet-disabled"):L.DomUtil.addClass(l,"leaflet-disabled"),l.setAttribute("title",p?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(l=this._modes[L.EditToolbar.Delete.TYPE].button,p?L.DomUtil.removeClass(l,"leaflet-disabled"):L.DomUtil.addClass(l,"leaflet-disabled"),l.setAttribute("title",p?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(l,c){if(L.Handler.prototype.initialize.call(this,l),L.setOptions(this,c),this._featureGroup=c.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var p=L.version.split(".");parseInt(p[0],10)===1&&parseInt(p[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var l=this._map;l&&(l.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),l._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(l){this._revertLayer(l)},this)},save:function(){var l=new L.LayerGroup;this._featureGroup.eachLayer(function(c){c.edited&&(l.addLayer(c),c.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:l})},_backupLayer:function(l){var c=L.Util.stamp(l);this._uneditedLayerProps[c]||(l instanceof L.Polyline||l instanceof L.Polygon||l instanceof L.Rectangle?this._uneditedLayerProps[c]={latlngs:L.LatLngUtil.cloneLatLngs(l.getLatLngs())}:l instanceof L.Circle?this._uneditedLayerProps[c]={latlng:L.LatLngUtil.cloneLatLng(l.getLatLng()),radius:l.getRadius()}:(l instanceof L.Marker||l instanceof L.CircleMarker)&&(this._uneditedLayerProps[c]={latlng:L.LatLngUtil.cloneLatLng(l.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(l){var c=L.Util.stamp(l);l.edited=!1,this._uneditedLayerProps.hasOwnProperty(c)&&(l instanceof L.Polyline||l instanceof L.Polygon||l instanceof L.Rectangle?l.setLatLngs(this._uneditedLayerProps[c].latlngs):l instanceof L.Circle?(l.setLatLng(this._uneditedLayerProps[c].latlng),l.setRadius(this._uneditedLayerProps[c].radius)):(l instanceof L.Marker||l instanceof L.CircleMarker)&&l.setLatLng(this._uneditedLayerProps[c].latlng),l.fire("revert-edited",{layer:l}))},_enableLayerEdit:function(l){var c,p,r=l.layer||l.target||l;this._backupLayer(r),this.options.poly&&(p=L.Util.extend({},this.options.poly),r.options.poly=p),this.options.selectedPathOptions&&(c=L.Util.extend({},this.options.selectedPathOptions),c.maintainColor&&(c.color=r.options.color,c.fillColor=r.options.fillColor),r.options.original=L.extend({},r.options),r.options.editing=c),r instanceof L.Marker?(r.editing&&r.editing.enable(),r.dragging.enable(),r.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):r.editing.enable()},_disableLayerEdit:function(l){var c=l.layer||l.target||l;c.edited=!1,c.editing&&c.editing.disable(),delete c.options.editing,delete c.options.original,this._selectedPathOptions&&(c instanceof L.Marker?this._toggleMarkerHighlight(c):(c.setStyle(c.options.previousOptions),delete c.options.previousOptions)),c instanceof L.Marker?(c.dragging.disable(),c.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.disable()},_onMouseMove:function(l){this._tooltip.updatePosition(l.latlng)},_onMarkerDragEnd:function(l){var c=l.target;c.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:c})},_onTouchMove:function(l){var c=l.originalEvent.changedTouches[0],p=this._map.mouseEventToLayerPoint(c),r=this._map.layerPointToLatLng(p);l.target.setLatLng(r)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(l,c){if(L.Handler.prototype.initialize.call(this,l),L.Util.setOptions(this,c),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var p=L.version.split(".");parseInt(p[0],10)===1&&parseInt(p[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var l=this._map;l&&(l.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(l){this._deletableLayers.addLayer(l),l.fire("revert-deleted",{layer:l})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(l){this._removeLayer({layer:l})},this),this.save()},_enableLayerDelete:function(l){(l.layer||l.target||l).on("click",this._removeLayer,this)},_disableLayerDelete:function(l){var c=l.layer||l.target||l;c.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(c)},_removeLayer:function(l){var c=l.layer||l.target||l;this._deletableLayers.removeLayer(c),this._deletedLayers.addLayer(c),c.fire("deleted")},_onMouseMove:function(l){this._tooltip.updatePosition(l.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);var aS=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var o,l,c;if(Array.isArray(e)){if(o=e.length,o!=n.length)return!1;for(l=o;l--!==0;)if(!t(e[l],n[l]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(c=Object.keys(e),o=c.length,o!==Object.keys(n).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(n,c[l]))return!1;for(l=o;l--!==0;){var p=c[l];if(!t(e[p],n[p]))return!1}return!0}return e!==e&&n!==n};function lS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,o)}return n}function Mv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lS(Object(n),!0).forEach(function(o){qD(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lS(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function qD(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var gp={onEdited:"draw:edited",onDrawStart:"draw:drawstart",onDrawStop:"draw:drawstop",onDrawVertex:"draw:drawvertex",onEditStart:"draw:editstart",onEditMove:"draw:editmove",onEditResize:"draw:editresize",onEditVertex:"draw:editvertex",onEditStop:"draw:editstop",onDeleted:"draw:deleted",onDeleteStart:"draw:deletestart",onDeleteStop:"draw:deletestop"};function rA(t){var e=kg(),n=Jn.useRef(),o=Jn.useRef(t),l=function(p){var r=t.onCreated,w=e.layerContainer||e.map;w.addLayer(p.layer),r&&r(p)};return Aa.useEffect(function(){var c=e.map,p=t.onMounted;for(var r in gp)c.on(gp[r],function(w){var M=Object.keys(gp).filter(function(E){return gp[E]===w.type});if(M.length===1){var N=M[0];t[N]&&t[N](w)}});return c.on(ll.Draw.Event.CREATED,l),n.current=uS(t,e),c.addControl(n.current),p&&p(n.current),function(){c.off(ll.Draw.Event.CREATED,l);for(var w in gp)t[w]&&c.off(gp[w],t[w]);n.current.remove(c)}},[]),Aa.useEffect(function(){if(!(aS(t.draw,o.current.draw)&&aS(t.edit,o.current.edit)&&t.position===o.current.position)){var c=e.map;n.current.remove(c),n.current=uS(t,e),n.current.addTo(c);var p=t.onMounted;return p&&p(n.current),function(){n.current.remove(c)}}},[t.draw,t.edit,t.position]),null}function uS(t,e){var n=e.layerContainer,o=t.draw,l=t.edit,c=t.position,p={edit:Mv(Mv({},l),{},{featureGroup:n})};return o&&(p.draw=Mv({},o)),c&&(p.position=c),new Bc.Control.Draw(p)}rA.propTypes=Mv(Mv({},Object.keys(gp).reduce(function(t,e){return t[e]=jr.PropTypes.func,t},{})),{},{onCreated:jr.PropTypes.func,onMounted:jr.PropTypes.func,draw:jr.PropTypes.shape({polyline:jr.PropTypes.oneOfType([jr.PropTypes.object,jr.PropTypes.bool]),polygon:jr.PropTypes.oneOfType([jr.PropTypes.object,jr.PropTypes.bool]),rectangle:jr.PropTypes.oneOfType([jr.PropTypes.object,jr.PropTypes.bool]),circle:jr.PropTypes.oneOfType([jr.PropTypes.object,jr.PropTypes.bool]),marker:jr.PropTypes.oneOfType([jr.PropTypes.object,jr.PropTypes.bool])}),edit:jr.PropTypes.shape({edit:jr.PropTypes.oneOfType([jr.PropTypes.object,jr.PropTypes.bool]),remove:jr.PropTypes.oneOfType([jr.PropTypes.object,jr.PropTypes.bool]),poly:jr.PropTypes.oneOfType([jr.PropTypes.object,jr.PropTypes.bool]),allowIntersection:jr.PropTypes.bool}),position:jr.PropTypes.oneOf(["topright","topleft","bottomright","bottomleft"]),leaflet:jr.PropTypes.shape({map:jr.PropTypes.instanceOf(Bc.Map),layerContainer:jr.PropTypes.shape({addLayer:jr.PropTypes.func.isRequired,removeLayer:jr.PropTypes.func.isRequired})})});const JD=ch(Gx)`
    width: 100vw;
    height: 100vh;
    
`,Bp=ch.button`
    display: flex;
    align-items: center;
    justify-content: center;
    border:1px solid gray;
    font-size:1.5rem;
    color:#000;
    background:#fff;
    width:33.2px;
    height:33.2px;
    border-radius: 5px;
    img{
        width:70%;
        margin: auto;
        display: block;
    }
    :hover{
        background-color: #D9D9D9;
    }
`;var zL={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},cS=Aa.createContext&&Aa.createContext(zL),yd=globalThis&&globalThis.__assign||function(){return yd=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(t[l]=e[l])}return t},yd.apply(this,arguments)},KD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(t);l<o.length;l++)e.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(t,o[l])&&(n[o[l]]=t[o[l]]);return n};function DL(t){return t&&t.map(function(e,n){return Aa.createElement(e.tag,yd({key:n},e.attr),DL(e.child))})}function oy(t){return function(e){return Aa.createElement(QD,yd({attr:yd({},t.attr)},e),DL(t.child))}}function QD(t){var e=function(n){var o=t.attr,l=t.size,c=t.title,p=KD(t,["attr","size","title"]),r=l||n.size||"1em",w;return n.className&&(w=n.className),t.className&&(w=(w?w+" ":"")+t.className),Aa.createElement("svg",yd({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,p,{className:w,style:yd(yd({color:t.color||n.color},n.style),t.style),height:r,width:r,xmlns:"http://www.w3.org/2000/svg"}),c&&Aa.createElement("title",null,c),t.children)};return cS!==void 0?Aa.createElement(cS.Consumer,null,function(n){return e(n)}):e(zL)}function tN(t){return oy({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 0C229.232 0 0 229.232 0 512c0 282.784 229.232 512 512 512 282.784 0 512-229.216 512-512C1024 229.232 794.784 0 512 0zm0 961.008c-247.024 0-448-201.984-448-449.01 0-247.024 200.976-448 448-448s448 200.977 448 448-200.976 449.01-448 449.01zm181.008-630.016c-12.496-12.496-32.752-12.496-45.248 0L512 466.752l-135.76-135.76c-12.496-12.496-32.752-12.496-45.264 0-12.496 12.496-12.496 32.752 0 45.248L466.736 512l-135.76 135.76c-12.496 12.48-12.496 32.769 0 45.249 12.496 12.496 32.752 12.496 45.264 0L512 557.249l135.76 135.76c12.496 12.496 32.752 12.496 45.248 0 12.496-12.48 12.496-32.769 0-45.249L557.248 512l135.76-135.76c12.512-12.512 12.512-32.768 0-45.248z"}}]})(t)}function eN({removeElementsInPolygon:t}){return In(Bp,{title:"Remove Point In Polygons",onClick:t,children:In(tN,{})})}const NL=ch.button`
    color: #000;
    font-size: 1.6rem;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 50px;
    height: 50px;
    border-radius: 5px;
    border: 2px solid rgb(231, 50, 50);
    background-color: #FFF;
    cursor: pointer;
    box-shadow: 0 0 10px #333;
    overflow: hidden;
    transition: .3s;
    :hover {
        font-size: 2rem;
        background-color: rgb(245, 50, 50);
        transform: scale(1.2);
        box-shadow: 0 0 4px #111;
        transition: .3s;
    }
    ::after{
            content: '🗑';
        }
`,Ad=ch.div`
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: black;
`,nN={Point:{color:"#ff0000",weight:1},LineString:{color:"#00ff00",weight:3},Polygon:{color:"#00ff00",weight:3},MultiPoint:{color:"#00ff00",weight:3},MultiLineString:{color:"#00ff00",weight:3},MultiPolygon:{color:"#00ff00",weight:3}};function iN({geojson:t,removeFeatureById:e}){return In(lE,{children:t.features.map(n=>In(If,{data:n,style:()=>nN[`${n.geometry.type}`],pointToLayer:(o,l)=>ll.circle(l,{radius:10,fillColor:"red"}),children:In(Cf,{children:Ko(Ad,{children:[In(NL,{onClick:()=>{e(n.id)}}),In("p",{style:{color:"#000"},children:n.properties.name})]})})},n.id))})}function OL(t){const e=oN(t);let n=0;return e.replace(/<Placemark.*?>/g,function(l){return n++,l.replace("<Placemark","<Placemark id='placemark-"+n+"'")})}function Vx(t){let e={lat:0,lng:0},n=0;for(let o of t.features)o.geometry.type==="Point"&&(e.lat+=o.geometry.coordinates[1],e.lng+=o.geometry.coordinates[0],n++);return e.lat/=n,e.lng/=n,e}function Ag(t,e){let n=Array.isArray(t)?t:t.geometry.coordinates,o=n[0],l=n[1],c=e.geometry.coordinates[0],p=!1;return c.forEach((r,w,M)=>{let N=r[0],E=r[1],Z,Y;w===M.length-1?(Z=M[0][0],Y=M[0][1]):(Z=M[w+1][0],Y=M[w+1][1]),E>l!=Y>l&&o<(Z-N)*(l-E)/(Y-E)+N&&(p=!p)}),p}function rN(t,e){if(t.geometry.type==="Point")return Ag(t,e);let n=!0;return t.geometry.coordinates.forEach(o=>{Ag(o,e)||(n=!1)}),n}function RL(t,e){var c;const o=new DOMParser().parseFromString(t,"application/xml"),l=o.getElementsByTagName("Placemark");for(let p=l.length-1;p>=0;p--){const r=l[p],w=r.getAttribute("id")??"";e.includes(w)||(c=r.parentNode)==null||c.removeChild(r)}return new XMLSerializer().serializeToString(o)}function oN(t){const n=new DOMParser().parseFromString(t,"application/xml"),o=n.getElementsByTagName("Placemark");for(let l=0;l<o.length;l++)o[l].removeAttribute("id");return new XMLSerializer().serializeToString(n)}function sN(t,e,n){for(let o=0;o<e.geometry.coordinates.length-1;o++){const l={lng:e.geometry.coordinates[o][0],lat:e.geometry.coordinates[o][1]},c={lng:e.geometry.coordinates[o+1][0],lat:e.geometry.coordinates[o+1][1]};if(aN(t.geometry.coordinates,l,c)<=n)return!0}return!1}function Wx(t){const n=new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("Placemark"),o={type:"FeatureCollection",features:[]};for(let l=0;l<n.length;l++){const c=n[l],w={type:"Feature",properties:{folderName:(c==null?void 0:c.parentNode).getElementsByTagName("name")[0].textContent,name:"",description:""},id:`placemark-${l}`,geometry:{type:"Point",coordinates:null}},M=c.getElementsByTagName("name")[0];M&&(w.properties.name=M.textContent);const N=c.getElementsByTagName("description")[0];N&&(w.properties.description=N.textContent);const E=c.getElementsByTagName("Point")[0];if(E){const K=E.getElementsByTagName("coordinates")[0].textContent;w.geometry.type="Point",w.geometry.coordinates=K.split(",").map(q=>Number(q))}const Z=c.getElementsByTagName("LineString")[0];if(Z){const K=Z.getElementsByTagName("coordinates")[0].textContent;w.geometry.type="LineString",w.geometry.coordinates=K.trim().split(/\s+/).map(q=>q.split(",").map(parseFloat))}const Y=c.getElementsByTagName("LinearRing")[0];if(Y){const K=Y.getElementsByTagName("coordinates")[0].textContent;w.geometry.type="Polygon",w.geometry.coordinates=K.trim().split(/\s+/).map(q=>q.split(",").map(parseFloat))}o.features.push(w)}return o}function aN(t,e,n){const o=ll.latLng(t[1],t[0]),l=n.lng-e.lng,c=n.lat-e.lat;if(l===0&&c===0)return o.distanceTo(e);const p=((o.lng-e.lng)*l+(o.lat-e.lat)*c)/(l*l+c*c);if(p<0)return o.distanceTo(e);if(p>1)return o.distanceTo(n);const r=ll.latLng(e.lat+p*c,e.lng+p*l);return o.distanceTo(r)}function tx(t,e){const n=Array.isArray(t)?t:t.geometry.coordinates,o=Array.isArray(e)?e:e.geometry.coordinates,l=ll.latLng(n[1],n[0]),c=ll.latLng(o[1],o[0]);return l.distanceTo(c)}function lN(t,e,n){const o=e[1]*(Math.PI/180),l=e[0]*(Math.PI/180),c=t[1]*(Math.PI/180),p=t[0]*(Math.PI/180),r=n[1]*(Math.PI/180),w=n[0]*(Math.PI/180),M=Math.acos(Math.sin(c)*Math.sin(r)+Math.cos(c)*Math.cos(r)*Math.cos(w-p)),N=Math.acos(Math.sin(o)*Math.sin(c)+Math.cos(o)*Math.cos(c)*Math.cos(p-l)),E=Math.acos(Math.sin(r)*Math.sin(o)+Math.cos(r)*Math.cos(o)*Math.cos(l-w));let Z;try{Z=Math.acos((Math.cos(M)-Math.cos(N)*Math.cos(E))/(Math.sin(N)*Math.sin(E))),Z=Z*(180/Math.PI)}catch{Z=180}return Number.isNaN(Z)?180:Z}function uN(t,e){if(t.geometry.type==="Point")return Ag(t,e);let n=!1;return t.geometry.coordinates.forEach(o=>{Ag(o,e)&&(n=!0)}),n}function ex(t){let e=0;return t.geometry.coordinates.forEach((n,o)=>{if(o>0){const l=ll.latLng(t.geometry.coordinates[o-1][1],t.geometry.coordinates[o-1][0]),c=ll.latLng(n[1],n[0]);e+=l.distanceTo(c)}}),e}function cN(t,e){const n=t[0],o=t[1],l=e[0],p=e[1]-o,r=Math.cos(Math.PI/180*o)*(l-n),w=Math.atan2(p,r)*180/Math.PI;return Math.ceil(w<0?w+360:w)}function hN(t){const e=[];return t.forEach(o=>{const l=o[0],c=o[1];e.push(cN(l,c))}),[...new Set(e)].length}var mg,sd,fx;class Yx{constructor(){k0(this,mg,[{url:"https://api.mapbox.com/styles/v1/mapbox/light-v8/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZWRnYXJiYXJyb3NvIiwiYSI6ImNsZGthYm1haDA0cWQzdmxjdnNwcnJoeGoifQ.VWGQI2nHd22h3A54eYWXOQ",attribution:"Map data © Mapbox"},{url:"https://api.mapbox.com/styles/v1/mapbox/dark-v8/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZWRnYXJiYXJyb3NvIiwiYSI6ImNsZGthYm1haDA0cWQzdmxjdnNwcnJoeGoifQ.VWGQI2nHd22h3A54eYWXOQ",attribution:"Map data © Mapbox"},{url:"https://api.mapbox.com/styles/v1/mapbox/satellite-v9/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZWRnYXJiYXJyb3NvIiwiYSI6ImNsZGthYm1haDA0cWQzdmxjdnNwcnJoeGoifQ.VWGQI2nHd22h3A54eYWXOQ",attribution:"Map data © Mapbox"}]);k0(this,sd,0);k0(this,fx,uf(this,mg).length)}changeMap(){Hb(this,sd,uf(this,sd)+1),uf(this,sd)==uf(this,fx)&&Hb(this,sd,0)}getUrl(){return uf(this,mg)[uf(this,sd)].url}getAttribution(){return uf(this,mg)[uf(this,sd)].attribution}}mg=new WeakMap,sd=new WeakMap,fx=new WeakMap;function BL(t){const e=new Blob([t],{type:"text/plain"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download="file.kml",document.body.appendChild(o),o.click(),document.body.removeChild(o)}function fN(t){const e=new Blob([t],{type:"text/plain"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download="ferragens.csv",document.body.appendChild(o),o.click(),document.body.removeChild(o)}function dN(t){return oy({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",stroke:"#000",strokeWidth:"2",d:"M4.99787498,8.99999999 L4.99787498,0.999999992 L19.4999998,0.999999992 L22.9999998,4.50000005 L23,23 L4,23 M18,1 L18,6 L23,6 M7,13 C7,13 6.00000004,13 5,13 C3.99999996,13 3,13.5 3,14.5 L3,16 C3,16 3.00000001,16.5 3,17.5 C2.99999999,18.5 4,19 5,19 L7,19 M13.25,13 C13.25,13 12.25,13 10.75,13 C9.25,13 8.75,13.5 8.75,14.5 C8.75,15.5 9.25,16 10.75,16 C12.25,16 12.75,16.5 12.75,17.5 C12.75,18.5 12.25,19 10.75,19 C9.25,19 8.25,19 8.25,19 M20.5,12 C20.5,12 20.5,12 20.5,12.5 C20.5,13 18,19 18,19 L17.5,19 C17.5,19 15,13 15,12.5 L15,12"}}]})(t)}function oA({save:t}){return In(Bp,{title:"Download",onClick:t,children:In(dN,{})})}function pN(t){return oy({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"18"}},{tag:"line",attr:{x1:"16",y1:"6",x2:"16",y2:"22"}}]})(t)}function Xx({changeMap:t}){return In(Bp,{onClick:t,title:"Change Map",children:In(pN,{})})}const mN=ch.div`
    display: flex;
    flex-direction: column;
    position: absolute;
    width: 32.5px;
    background: transparent;
    top: 150px;
    right: 10px;
    gap: 10px;

`;function Hx({children:t}){return In(mN,{className:"leaflet-control",children:t})}function $x(){return In(Bp,{className:"leaflet-control",onClick:()=>location.reload(),style:{position:"absolute",top:"5px",left:"5px"},title:"Home",children:In("img",{src:"https://i.ibb.co/X7y9BBL/image002-5f3f8cb5.png"})})}function gN({fileContent:t}){const e=Jn.useRef(null),n=Jn.useRef(null),o=Jn.useRef(null),l=Jn.useMemo(()=>new Yx,[]),c=Jn.useMemo(()=>OL(t),[]),[p,r]=Jn.useState(Wx(t)),w=()=>{const Z=e.current.toGeoJSON(),Y=n.current.toGeoJSON();if(Z.features.length>0){const K=[];Y.features.forEach(q=>{Z.features.forEach(at=>{!rN(q,at)&&K.push(q)})}),r({type:"FeatureCollection",features:K}),e.current.clearLayers()}},M=Z=>{const Y=p.features.filter(K=>K.id!==Z);r(K=>({...K,features:Y}))},N=()=>{let Z=c;const Y=p.features.map(K=>K.id);Z=RL(Z,Y),BL(Z)},E=()=>{l.changeMap(),o.current.setUrl(l.getUrl())};return Ko(JD,{zoomControl:!1,center:Vx(p),zoom:14,doubleClickZoom:!1,children:[In(Zx,{ref:o,attribution:l.getAttribution(),url:l.getUrl()}),In(cc,{ref:e,children:In(rA,{position:"topright",draw:{rectangle:!1,circle:!1,marker:!1,circlemarker:!1,polyline:!1}})}),In(cc,{ref:n,children:In(iN,{geojson:p,removeFeatureById:M})}),Ko(Hx,{children:[In(oA,{save:N}),In(eN,{removeElementsInPolygon:w}),In(Xx,{changeMap:E})]}),In($x,{})]})}const _N={primary:"#184B4B",secondary:"#F8F8FF",fontColor:"#000",mapTheme:"mapbox://styles/mapbox/light-v11"},vN=ch(Gx)`
    width: 100vw;
    height: 100vh;
    
`,yN={Point:{color:"#ff0000",weight:1},LineString:{color:"#00ff00",weight:3},Polygon:{color:"#00ff00",weight:3},MultiPoint:{color:"#00ff00",weight:3},MultiLineString:{color:"#00ff00",weight:3},MultiPolygon:{color:"#00ff00",weight:3}};function xN({geojson:t,removeFeatureById:e}){return In(lE,{children:t.features.map(n=>In(If,{data:n,style:()=>yN[`${n.geometry.type}`],pointToLayer:(o,l)=>ll.circle(l,{radius:10,fillColor:"red"}),children:In(Cf,{children:Ko(Ad,{children:[In(NL,{onClick:()=>{e(n.id)}}),In("p",{style:{color:"#000"},children:n.properties.name})]})})},n.id))})}function wN({removeNotUsedPoints:t}){return In(Bp,{title:"Remove Point Not Used",onClick:t,children:"☨"})}function bN({fileContent:t}){Jn.useRef(null);const e=Jn.useRef(null),n=Jn.useRef(null),o=Jn.useMemo(()=>new Yx,[]),l=Jn.useMemo(()=>OL(t),[]),[c,p]=Jn.useState(Wx(t)),r=()=>{const Z=c.features.filter(at=>at.geometry.type==="Point"),Y=c.features.filter(at=>at.geometry.type==="LineString"),q=Z.filter(at=>{let J=!1;return Y.forEach(Q=>{sN(at,Q,10)&&(J||(J=!0))}),!J}).map(at=>at.id);w(q)},w=E=>{let Z;Array.isArray(E)?Z=E:Z=[E];const Y=c.features.filter(K=>!Z.includes(K.id));p({type:"FeatureCollection",features:Y})},M=()=>{let E=l;const Z=c.features.map(Y=>Y.id);E=RL(E,Z),BL(E)},N=()=>{o.changeMap(),n.current.setUrl(o.getUrl())};return Ko(vN,{zoomControl:!1,center:Vx(c),zoom:14,doubleClickZoom:!1,children:[In(Zx,{ref:n,attribution:o.getAttribution(),url:o.getUrl()}),In(cc,{ref:e,children:In(xN,{geojson:c,removeFeatureById:w})}),Ko(Hx,{children:[In(wN,{removeNotUsedPoints:r}),In(oA,{save:M}),In(Xx,{changeMap:N})]}),In($x,{})]})}const IN=ch(Gx)`
    width: 100vw;
    height: 100vh;
    
`;function CN(t){return oy({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M15 16v1.26l-6-3v-3.17L11.7 8H16V2h-6v4.9L7.3 10H3v6h5l7 3.5V22h6v-6h-6zM12 4h2v2h-2V4zM7 14H5v-2h2v2zm12 6h-2v-2h2v2z"}}]})(t)}function AN({calculeAllAnchors:t}){return In(Bp,{title:"Calcular Todos",onClick:t,children:In(CN,{})})}function TN(t){return oy({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M384 352c-.35 0-.67.1-1.02.1l-39.2-65.32c5.07-9.17 8.22-19.56 8.22-30.78s-3.14-21.61-8.22-30.78l39.2-65.32c.35.01.67.1 1.02.1 35.35 0 64-28.65 64-64s-28.65-64-64-64c-23.63 0-44.04 12.95-55.12 32H119.12C108.04 44.95 87.63 32 64 32 28.65 32 0 60.65 0 96c0 23.63 12.95 44.04 32 55.12v209.75C12.95 371.96 0 392.37 0 416c0 35.35 28.65 64 64 64 23.63 0 44.04-12.95 55.12-32h209.75c11.09 19.05 31.49 32 55.12 32 35.35 0 64-28.65 64-64 .01-35.35-28.64-64-63.99-64zm-288 8.88V151.12A63.825 63.825 0 0 0 119.12 128h208.36l-38.46 64.1c-.35-.01-.67-.1-1.02-.1-35.35 0-64 28.65-64 64s28.65 64 64 64c.35 0 .67-.1 1.02-.1l38.46 64.1H119.12A63.748 63.748 0 0 0 96 360.88zM272 256c0-8.82 7.18-16 16-16s16 7.18 16 16-7.18 16-16 16-16-7.18-16-16zM400 96c0 8.82-7.18 16-16 16s-16-7.18-16-16 7.18-16 16-16 16 7.18 16 16zM64 80c8.82 0 16 7.18 16 16s-7.18 16-16 16-16-7.18-16-16 7.18-16 16-16zM48 416c0-8.82 7.18-16 16-16s16 7.18 16 16-7.18 16-16 16-16-7.18-16-16zm336 16c-8.82 0-16-7.18-16-16s7.18-16 16-16 16 7.18 16 16-7.18 16-16 16z"}}]})(t)}function SN({calculeAnchorsInPolygons:t}){return In(Bp,{title:"Calcular ferragens do poligono",onClick:t,children:In(TN,{})})}function EN({geojsonPostes:t}){return In(hh.Overlay,{name:"Postes",checked:!0,children:In(cc,{children:t.features.map(e=>In(If,{data:e,style:()=>({color:"#FFF",weight:1}),pointToLayer:(n,o)=>{const c=o.toBounds(5).getNorthEast(),p=o.toBounds(10/2).getSouthWest();return ll.rectangle(new ll.LatLngBounds(c,p),{fillColor:"#C0C0C0",fillOpacity:1})},children:e.properties.name&&In(Cf,{children:In(Ad,{children:In("p",{style:{color:"#000"},children:e.properties.name})})})},e.id))})})}function MN({geojsonCtos:t}){return In(hh.Overlay,{name:"Caixas",checked:!0,children:In(cc,{children:t.features.map(e=>In(If,{data:e,style:()=>({color:"#000",weight:0}),pointToLayer:(n,o)=>ll.circle(o,{radius:8,fillColor:"blue",fillOpacity:.7}),children:e.properties.name&&In(Cf,{children:In(Ad,{children:In("p",{style:{color:"#000"},children:e.properties.name})})})},e.id))})})}const hS={"01f":"#00ff00","02f":"#ffff00","06f":"#ff0000","12f":"#00ffff","24f":"#ff00ff","36f":"#0000ff","72f":"#aa0000","144f":"#fff"};function LN(t){for(let e in hS)if(t.includes(e))return hS[`${e}`];return"#000"}function kN({geojsonCabos:t}){return In(hh.Overlay,{name:"Cabos",checked:!0,children:In(cc,{children:t.features.map(e=>In(If,{data:e,style:()=>({color:LN(e.properties.name),weight:4,opacity:.6}),children:In(Cf,{children:Ko(Ad,{children:[In("p",{style:{color:"#000"},children:e.properties.name}),Ko("p",{style:{color:"#000"},children:[Math.ceil(ex(e)),"m"]})]})})},e.id))})})}const PN=ch.table`
border: 1px solid black;
border-collapse: collapse;
width: 100%;

th,
td {
  padding: 10px;
  border: 2px solid black;
  text-align: center;
}

th {
  background-color: gray;
}
`;function zN({geojsonAnchors:t}){return In(hh.Overlay,{name:"Ancoragens/Passagens",checked:!0,children:In(cc,{children:t.features.map(e=>In(If,{data:e,style:()=>({color:"#FFF",weight:1}),pointToLayer:(n,o)=>{const c=o.toBounds(5).getNorthEast(),p=o.toBounds(10/2).getSouthWest();return ll.rectangle(new ll.LatLngBounds(c,p),{fillColor:n.properties.bap?"#fb00ff":"#C0C0C0",fillOpacity:1})},children:In(Cf,{children:In(Ad,{children:Ko(PN,{children:[In("thead",{children:Ko("tr",{children:[In("th",{children:"supas"}),In("th",{children:"alças"})]})}),In("tbody",{children:Ko("tr",{children:[In("td",{children:e.properties.supa}),In("td",{children:e.properties.alca})]})})]})})})},e.id))})})}function DN(t,e){t.forEach(n=>{n.geometry.coordinates=n.geometry.coordinates.map(o=>{let l=30,c=o;return e.forEach(p=>{let r=tx(o,p);r<l&&(l=r,c=p.geometry.coordinates)}),c})});for(let n of t)n.geometry.coordinates=n.geometry.coordinates.filter((o,l)=>{if(l===0)return!0;if(o!==n.geometry.coordinates[l-1])return!0})}function NN(t,e){t.forEach(n=>{let o=30,l=n.geometry.coordinates;e.forEach(c=>{let p=tx(n,c);p<o&&(o=p,l=c.geometry.coordinates)}),n.geometry.coordinates=l})}function ON(t,e){e.forEach(n=>{t.forEach(o=>{o.geometry.coordinates.forEach(l=>{n.geometry.coordinates===l&&(n.properties.bap=!0)})})})}function RN(t,e){e.forEach(n=>{let o=0;t.forEach(l=>{l.geometry.coordinates.forEach((c,p)=>{n.geometry.coordinates===c&&(p===0||p===l.geometry.coordinates.length-1?o+=1:o+=2)})}),n.properties.alca+=o})}function BN(t,e){e.forEach(n=>{let o=[];t.forEach(l=>{l.geometry.coordinates.forEach((c,p)=>{n.geometry.coordinates===c&&(p>0&&p<l.geometry.coordinates.length-1?(o.push([n.geometry.coordinates,l.geometry.coordinates[p-1]]),o.push([n.geometry.coordinates,l.geometry.coordinates[p+1]])):p===0?o.push([n.geometry.coordinates,l.geometry.coordinates[p+1]]):p===l.geometry.coordinates.length-1&&o.push([n.geometry.coordinates,l.geometry.coordinates[p-1]]))})}),n.properties.supa+=hN(o)})}function FN(t,e,n){e.forEach(o=>{t.forEach(l=>{l.geometry.coordinates.forEach((c,p)=>{if(o.geometry.coordinates===c&&p>0&&p<l.geometry.coordinates.length-1){const r=lN(l.geometry.coordinates[p-1],c,l.geometry.coordinates[p+1]);if(Math.abs(r-180)<20){let w=!1;n.forEach(M=>{M.geometry.coordinates===o.geometry.coordinates&&(w=!0)}),!w&&o.properties.alca===2&&o.properties.supa===2&&(o.properties.alca-=2,o.properties.supa-=1)}}})})})}const hv={type:"FeatureCollection",features:[]};function jN({fileContent:t}){const e=Jn.useRef(null),n=Jn.useRef(null),o=Jn.useMemo(()=>new Yx,[]),[l,c]=Jn.useState(Wx(t)),[p,r]=Jn.useState(hv),[w,M]=Jn.useState(hv),[N,E]=Jn.useState(hv),[Z,Y]=Jn.useState(hv);Jn.useEffect(()=>{const Q=l.features.filter(j=>j.properties.folderName.includes("Cabos")&&j.geometry.type==="LineString"),lt=l.features.filter(j=>j.properties.folderName.includes("Postes")&&j.geometry.type==="Point"),Ct=l.features.filter(j=>(j.properties.folderName.includes("Ramal")||j.properties.folderName.includes("Caixas de atendimento"))&&j.geometry.type==="Point");r(j=>({...j,features:lt})),E(j=>({...j,features:Ct})),M(j=>({...j,features:Q}))},[l]);const K=()=>{const Q=p.features.map(j=>(j.properties={...j.properties,supa:0,alca:0,bap:!1},j)),lt=w.features.map(j=>j),Ct=N.features.map(j=>j);DN(lt,Q),NN(Ct,Q),ON(lt,Q),RN(lt,Q),BN(lt,Q),FN(lt,Q,Ct),c(j=>({...j,features:[...Q,...lt,...Ct]})),Y(j=>({...j,features:Q}))},q=()=>{let Q=e.current.toGeoJSON();const lt=hv;w.features.forEach(Ct=>{Ct.geometry.coordinates.length>2?Ct.geometry.coordinates.forEach((j,k)=>{if(k>0){let rt;rt={type:"Feature",id:`${Ct.id}.${k}`,properties:{},geometry:{coordinates:[Ct.geometry.coordinates[k-1],j],type:"LineString"}},lt.features.push(rt)}}):lt.features.push(Ct)}),Q.features.length!==0&&e.current.getLayers().map(Ct=>{const j=Ct.toGeoJSON();let k=0,rt=0,yt=0,xt=0,kt=0;return lt.features.forEach(de=>{uN(de,j)&&(rt+=ex(de))}),w.features.forEach(de=>{de.geometry.coordinates.forEach(Et=>{N.features.forEach((te,ht)=>{tx(te.geometry.coordinates,Et)<3&&Ag(te,Ct.toGeoJSON())&&(ht===0||ht===te.geometry.coordinates.length-1?k+=10:k+=20)})})}),Z.features.forEach(de=>{Ag(de,j)&&de.properties.bap&&(yt+=1,xt+=de.properties.supa,kt+=de.properties.alca)}),Ct.bindPopup(`<table border="1" style="border-collapse: collapse; width: 100%;">
            <thead>
              <tr>
                <th style="padding: 10px; border: 2px solid black; text-align: center;background-color: gray">baps</th>
                <th style="padding: 10px; border: 2px solid black; text-align: center;background-color: gray">supas</th>
                <th style="padding: 10px; border: 2px solid black; text-align: center;background-color: gray">alças</th>
                <th style="padding: 10px; border: 2px solid black; text-align: center;background-color: gray">Metros de cabo + reservas</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding: 10px; border: 2px solid black; text-align: center;">${yt}</td>
                <td style="padding: 10px; border: 2px solid black; text-align: center;">${xt}</td>
                <td style="padding: 10px; border: 2px solid black; text-align: center;">${kt}</td>
                <td style="padding: 10px; border: 2px solid black; text-align: center;">${Math.ceil(rt)}m + ${k}m</td>
              </tr>
            </tbody>
          </table>`)})},at=()=>{let Q="nome;metragem;reservas";w.features.forEach(lt=>{let Ct=0;const j=ex(lt);lt.geometry.coordinates.forEach(k=>{N.features.forEach((rt,yt)=>{tx(rt.geometry.coordinates,k)<3&&(yt===0||yt===rt.geometry.coordinates.length-1?Ct+=10:Ct+=20)})}),Q+=`
${lt.properties.name};${Math.ceil(j)};${Ct}`}),fN(Q)},J=()=>{o.changeMap(),n.current.setUrl(o.getUrl())};return Ko(IN,{zoomControl:!1,center:Vx(l),zoom:14,doubleClickZoom:!1,children:[In(Zx,{ref:n,attribution:o.getAttribution(),url:o.getUrl()}),In(hh,{position:"bottomleft",children:Ko(cc,{children:[In(zN,{geojsonAnchors:Z}),In(kN,{geojsonCabos:w}),In(MN,{geojsonCtos:N}),In(EN,{geojsonPostes:p})]})}),Ko(Hx,{children:[In(AN,{calculeAllAnchors:K}),In(SN,{calculeAnchorsInPolygons:q}),In(oA,{save:at}),In(Xx,{changeMap:J})]}),In($x,{}),In(cc,{ref:e,children:In(rA,{position:"topright",draw:{rectangle:!1,circle:!1,marker:!1,circlemarker:!1,polyline:!1}})})]})}const UN=ch(Gx)`
    width: 100vw;
    height: 100vh;
    
`;function GN({geojsonPostes:t}){return In(hh.Overlay,{name:"Postes",checked:!0,children:In(cc,{children:t.features.map(e=>In(If,{data:e,style:()=>({color:"#FFF",weight:1}),pointToLayer:(n,o)=>{const c=o.toBounds(5).getNorthEast(),p=o.toBounds(10/2).getSouthWest();return ll.rectangle(new ll.LatLngBounds(c,p),{fillColor:"#C0C0C0",fillOpacity:1})},children:In(Cf,{children:In(Ad,{children:In("p",{style:{color:"#000"},children:e.properties.name})})})},e.id))})})}const hf={x:"x",y:"y",width:"w",height:"h",minimum:"s",maximum:"l",diagonal:"d"},ZN=Object.keys(hf).map(t=>hf[t]).join(""),II="[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?",VN=/\s/g,fS=new RegExp(`^(${II}\\*)?([${ZN}])(/${II})?([-+]{1,2}${II})?$`,"g");function FL(t){throw new Error(`Invalid calc() expression: ${t}`)}function WN(t,e){const n=fS.exec(t.replace(VN,""));n||FL(t),fS.lastIndex=0;const[,o,l,c,p]=n,{x:r,y:w,width:M,height:N}=e;let E=0;switch(l){case hf.width:{E=M;break}case hf.height:{E=N;break}case hf.x:{E=r;break}case hf.y:{E=w;break}case hf.minimum:{E=Math.min(N,M);break}case hf.maximum:{E=Math.max(N,M);break}case hf.diagonal:{E=Math.sqrt(N*N+M*M);break}}return o&&(E*=parseFloat(o)),c&&(E/=parseFloat(c.slice(1))),p&&(E+=YN(p)),E}function YN(t){if(!t)return 0;const[e]=t;switch(e){case"+":return parseFloat(t.substr(1));case"-":return-parseFloat(t.substr(1))}return parseFloat(t)}function Lh(t){return typeof t=="string"&&t.includes("calc")}const jL="calc(",dS=jL.length;function kh(t,e){let n=t,o=0;do{let l=n.indexOf(jL,o);if(l===-1)return n;let c=l+dS,p=1;t:do{switch(n[c]){case"(":{p++;break}case")":{if(p--,p===0)break t;break}case void 0:FL(n)}c++}while(!0);let r=n.slice(l+dS,c);Lh(r)&&(r=kh(r,e));const w=String(WN(r,e));n=n.slice(0,l)+w+n.slice(c+1),o=l+w.length}while(!0)}const{round:XN,floor:HN,PI:UL}=Math,$N={linear:function(t,e,n){var o=t[1]-t[0],l=e[1]-e[0];return(n-t[0])/o*l+e[0]||0}},Rh=function(t){return t%360+(t<0?360:0)},zp=function(t,e){return e*XN(t/e)},qx=function(t){return 180*t/UL%360},ju=function(t,e){return e=e||!1,t=e?t:t%360,t*UL/180},UC=function(t,e){if(e===void 0)e=t===void 0?1:t,t=0;else if(e<t){const n=t;t=e,e=n}return HN(Math.random()*(e-t+1)+t)},{cos:K0,sin:CI,atan2:qN}=Math,GL=function(t,e){var n=ju(t.y),o=ju(e.y),l=t.x,c=e.x,p=ju(c-l),r=CI(p)*K0(o),w=K0(n)*CI(o)-CI(n)*K0(o)*K0(p),M=qx(qN(r,w)),N=["NE","E","SE","S","SW","W","NW","N"],E=M-22.5;return E<0&&(E+=360),E=parseInt(E/45),N[E]},sA=function(t,e){var n=t.x,o=t.y,l=e.x,c=e.y;return(n-=l)*n+(o-=c)*o},ZL=function(t,e){return Math.sqrt(sA(t,e))},Er={Point:1,Line:2,Ellipse:3,Rect:4,Polyline:5,Polygon:6,Curve:7,Path:8},{abs:nx,cos:GC,sin:ZC,sqrt:pS,min:mS,max:gS,atan2:JN,round:_S,pow:KN,PI:vS}=Math,Te=function(t,e){if(!(this instanceof Te))return new Te(t,e);if(typeof t=="string"){var n=t.split(t.indexOf("@")===-1?" ":"@");t=parseFloat(n[0]),e=parseFloat(n[1])}else Object(t)===t&&(e=t.y,t=t.x);this.x=t===void 0?0:t,this.y=e===void 0?0:e};Te.fromPolar=function(t,e,n){n=new Te(n);var o=nx(t*GC(e)),l=nx(t*ZC(e)),c=Rh(qx(e));return c<90?l=-l:c<180?(o=-o,l=-l):c<270&&(o=-o),new Te(n.x+o,n.y+l)};Te.random=function(t,e,n,o){return new Te(UC(t,e),UC(n,o))};Te.prototype={type:Er.Point,chooseClosest:function(t){var e=t.length;if(e===1)return new Te(t[0]);for(var n=null,o=1/0,l=0;l<e;l++){var c=new Te(t[l]),p=this.squaredDistance(c);p<o&&(n=c,o=p)}return n},adhereToRect:function(t){return t.containsPoint(this)?this:(this.x=mS(gS(this.x,t.x),t.x+t.width),this.y=mS(gS(this.y,t.y),t.y+t.height),this)},angleBetween:function(t,e){var n=this.equals(t)||this.equals(e)?NaN:this.theta(e)-this.theta(t);return n<0&&(n+=360),n},bearing:function(t){return GL(this,t)},changeInAngle:function(t,e,n){return this.clone().offset(-t,-e).theta(n)-this.theta(n)},clone:function(){return new Te(this)},cross:function(t,e){return t&&e?(e.x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x):NaN},difference:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),new Te(this.x-(t||0),this.y-(e||0))},distance:function(t){return ZL(this,t)},dot:function(t){return t?this.x*t.x+this.y*t.y:NaN},equals:function(t){return!!t&&this.x===t.x&&this.y===t.y},lerp:function(t,e){var n=this.x,o=this.y;return new Te((1-e)*n+e*t.x,(1-e)*o+e*t.y)},magnitude:function(){return pS(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(t){return nx(t.x-this.x)+nx(t.y-this.y)},move:function(t,e){var n=ju(new Te(t).theta(this)),o=this.offset(GC(n)*e,-ZC(n)*e);return o},normalize:function(t){var e=(t||1)/this.magnitude();return this.scale(e,e)},offset:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x+=t||0,this.y+=e||0,this},reflection:function(t){return new Te(t).move(this,this.distance(t))},rotate:function(t,e){if(e===0)return this;t=t||new Te(0,0),e=ju(Rh(-e));var n=GC(e),o=ZC(e),l=n*(this.x-t.x)-o*(this.y-t.y)+t.x,c=o*(this.x-t.x)+n*(this.y-t.y)+t.y;return this.x=l,this.y=c,this},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=KN(10,t);break}return this.x=_S(this.x*e)/e,this.y=_S(this.y*e)/e,this},scale:function(t,e,n){return n=n&&new Te(n)||new Te(0,0),this.x=n.x+t*(this.x-n.x),this.y=n.y+e*(this.y-n.y),this},snapToGrid:function(t,e){return this.x=zp(this.x,t),this.y=zp(this.y,e||t),this},squaredDistance:function(t){return sA(this,t)},theta:function(t){t=new Te(t);var e=-(t.y-this.y),n=t.x-this.x,o=JN(e,n);return o<0&&(o=2*vS+o),180*o/vS},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(t){t=t&&new Te(t)||new Te(0,0);var e=this.x,n=this.y;return this.x=pS((e-t.x)*(e-t.x)+(n-t.y)*(n-t.y)),this.y=ju(t.theta(new Te(e,n))),this},toString:function(){return this.x+"@"+this.y},serialize:function(){return this.x+","+this.y},update:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x=t||0,this.y=e||0,this},vectorAngle:function(t){var e=new Te(0,0);return e.angleBetween(this,t)}};Te.prototype.translate=Te.prototype.offset;const ix=Te,{max:AI,min:TI}=Math,di=function(t,e){if(!(this instanceof di))return new di(t,e);if(t instanceof di)return new di(t.start,t.end);this.start=new Te(t),this.end=new Te(e)};di.prototype={type:Er.Line,angle:function(){var t=new Te(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)},bbox:function(){var t=TI(this.start.x,this.end.x),e=TI(this.start.y,this.end.y),n=AI(this.start.x,this.end.x),o=AI(this.start.y,this.end.y);return new ai(t,e,n-t,o-e)},bearing:function(){return GL(this.start,this.end)},clone:function(){return new di(this.start,this.end)},closestPoint:function(t){return this.pointAt(this.closestPointNormalizedLength(t))},closestPointLength:function(t){return this.closestPointNormalizedLength(t)*this.length()},closestPointNormalizedLength:function(t){var e=this.vector().dot(new di(this.start,t).vector()),n=TI(1,AI(0,e/this.squaredLength()));return n!==n?0:n},closestPointTangent:function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},containsPoint:function(t){var e=this.start,n=this.end;if(e.cross(t,n)!==0)return!1;var o=this.length();return!(new di(e,t).length()>o||new di(t,n).length()>o)},divideAt:function(t){var e=this.pointAt(t);return[new di(this.start,e),new di(e,this.end)]},divideAtLength:function(t){var e=this.pointAtLength(t);return[new di(this.start,e),new di(e,this.end)]},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},intersect:function(t,e){if(t&&t.intersectionWithLine){var n=t.intersectionWithLine(this,e);return n&&t instanceof di&&(n=n[0]),n}return null},intersectionWithLine:function(t){var e=new Te(this.end.x-this.start.x,this.end.y-this.start.y),n=new Te(t.end.x-t.start.x,t.end.y-t.start.y),o=e.x*n.y-e.y*n.x,l=new Te(t.start.x-this.start.x,t.start.y-this.start.y),c=l.x*n.y-l.y*n.x,p=l.x*e.y-l.y*e.x;if(o===0||c*o<0||p*o<0)return null;if(o>0){if(c>o||p>o)return null}else if(c<o||p<o)return null;return[new Te(this.start.x+c*e.x/o,this.start.y+c*e.y/o)]},isDifferentiable:function(){return!this.start.equals(this.end)},length:function(){return ZL(this.start,this.end)},midpoint:function(){return new Te((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},parallel:function(t){const e=this.clone();if(!this.isDifferentiable())return e;const{start:n,end:o}=e,l=n.clone().rotate(o,270),c=o.clone().rotate(n,90);return n.move(c,t),o.move(l,t),e},pointAt:function(t){var e=this.start,n=this.end;return t<=0?e.clone():t>=1?n.clone():e.lerp(n,t)},pointAtLength:function(t){var e=this.start,n=this.end,o=!0;t<0&&(o=!1,t=-t);var l=this.length();return t>=l?o?n.clone():e.clone():this.pointAt((o?t:l-t)/l)},pointOffset:function(t){t=new Te(t);var e=this.start,n=this.end,o=(n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x);return o/this.length()},rotate:function(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this},round:function(t){return this.start.round(t),this.end.round(t),this},scale:function(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this},setLength:function(t){var e=this.length();if(!e)return this;var n=t/e;return this.scale(n,n,this.start)},squaredLength:function(){return sA(this.start,this.end)},tangentAt:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,o=this.pointAt(t),l=new di(e,n);return l.translate(o.x-e.x,o.y-e.y),l},tangentAtLength:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,o=this.pointAtLength(t),l=new di(e,n);return l.translate(o.x-e.x,o.y-e.y),l},toString:function(){return this.start.toString()+" "+this.end.toString()},serialize:function(){return this.start.serialize()+" "+this.end.serialize()},translate:function(t,e){return this.start.translate(t,e),this.end.translate(t,e),this},vector:function(){return new Te(this.end.x-this.start.x,this.end.y-this.start.y)}};di.prototype.intersection=di.prototype.intersect;const Ap=di,{sqrt:yS,round:Q0,pow:QN}=Math,pu=function(t,e,n){if(!(this instanceof pu))return new pu(t,e,n);if(t instanceof pu)return new pu(new Te(t.x,t.y),t.a,t.b);t=new Te(t),this.x=t.x,this.y=t.y,this.a=e,this.b=n};pu.fromRect=function(t){return t=new ai(t),new pu(t.center(),t.width/2,t.height/2)};pu.prototype={type:Er.Ellipse,bbox:function(){return new ai(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},center:function(){return new Te(this.x,this.y)},clone:function(){return new pu(this)},containsPoint:function(t){return this.normalizedDistance(t)<=1},equals:function(t){return!!t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},inflate:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.a+=2*t,this.b+=2*e,this},intersectionWithLine:function(t){var e=[],n=t.start,o=t.end,l=this.a,c=this.b,p=t.vector(),r=n.difference(new Te(this)),w=new Te(p.x/(l*l),p.y/(c*c)),M=new Te(r.x/(l*l),r.y/(c*c)),N=p.dot(w),E=p.dot(M),Z=r.dot(M)-1,Y=E*E-N*Z;if(Y<0)return null;if(Y>0){var K=yS(Y),q=(-E-K)/N,at=(-E+K)/N;if((q<0||1<q)&&(at<0||1<at))return null;0<=q&&q<=1&&e.push(n.lerp(o,q)),0<=at&&at<=1&&e.push(n.lerp(o,at))}else{var J=-E/N;if(0<=J&&J<=1)e.push(n.lerp(o,J));else return null}return e},intersectionWithLineFromCenterToPoint:function(t,e){t=new Te(t),e&&t.rotate(new Te(this.x,this.y),e);var n=t.x-this.x,o=t.y-this.y,l;if(n===0)return l=this.bbox().pointNearestToPoint(t),e?l.rotate(new Te(this.x,this.y),-e):l;var c=o/n,p=c*c,r=this.a*this.a,w=this.b*this.b,M=yS(1/(1/r+p/w));M=n<0?-M:M;var N=c*M;return l=new Te(this.x+M,this.y+N),e?l.rotate(new Te(this.x,this.y),-e):l},normalizedDistance:function(t){var e=t.x,n=t.y,o=this.a,l=this.b,c=this.x,p=this.y;return(e-c)*(e-c)/(o*o)+(n-p)*(n-p)/(l*l)},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=QN(10,t);break}return this.x=Q0(this.x*e)/e,this.y=Q0(this.y*e)/e,this.a=Q0(this.a*e)/e,this.b=Q0(this.b*e)/e,this},tangentTheta:function(t){var e=30,n=t.x,o=t.y,l=this.a,c=this.b,p=this.bbox().center(),r=p.x,w=p.y,M=n>p.x+l/2,N=n<p.x-l/2,E,Z;return M||N?(E=n>p.x?o-e:o+e,Z=l*l/(n-r)-l*l*(o-w)*(E-w)/(c*c*(n-r))+r):(Z=o>p.y?n+e:n-e,E=c*c/(o-w)-c*c*(n-r)*(Z-r)/(l*l*(o-w))+w),new Te(Z,E).theta(t)},toString:function(){return new Te(this.x,this.y).toString()+" "+this.a+" "+this.b}};const tO=pu,{abs:xS,cos:eO,sin:nO,min:fv,max:wS,round:t1,pow:iO}=Math,ai=function(t,e,n,o){if(!(this instanceof ai))return new ai(t,e,n,o);Object(t)===t&&(e=t.y,n=t.width,o=t.height,t=t.x),this.x=t===void 0?0:t,this.y=e===void 0?0:e,this.width=n===void 0?0:n,this.height=o===void 0?0:o};ai.fromEllipse=function(t){return t=new pu(t),new ai(t.x-t.a,t.y-t.b,2*t.a,2*t.b)};ai.fromPointUnion=function(...t){if(t.length===0)return null;const e=new Te;let n,o,l,c;n=o=1/0,l=c=-1/0;for(let p=0;p<t.length;p++){e.update(t[p]);const r=e.x,w=e.y;r<n&&(n=r),r>l&&(l=r),w<o&&(o=w),w>c&&(c=w)}return new ai(n,o,l-n,c-o)};ai.fromRectUnion=function(...t){if(t.length===0)return null;const e=new ai;let n,o,l,c;n=o=1/0,l=c=-1/0;for(let p=0;p<t.length;p++){e.update(t[p]);const r=e.x,w=e.y,M=r+e.width,N=w+e.height;r<n&&(n=r),M>l&&(l=M),w<o&&(o=w),N>c&&(c=N)}return new ai(n,o,l-n,c-o)};ai.prototype={type:Er.Rect,bbox:function(t){return this.clone().rotateAroundCenter(t)},rotateAroundCenter:function(t){if(!t)return this;const{width:e,height:n}=this,o=ju(t),l=xS(nO(o)),c=xS(eO(o)),p=e*c+n*l,r=e*l+n*c;return this.x+=(e-p)/2,this.y+=(n-r)/2,this.width=p,this.height=r,this},bottomLeft:function(){return new Te(this.x,this.y+this.height)},bottomLine:function(){return new di(this.bottomLeft(),this.bottomRight())},bottomMiddle:function(){return new Te(this.x+this.width/2,this.y+this.height)},center:function(){return new Te(this.x+this.width/2,this.y+this.height/2)},clone:function(){return new ai(this)},containsPoint:function(t){return t=new Te(t),t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},containsRect:function(t){var e=new ai(this).normalize(),n=new ai(t).normalize(),o=e.width,l=e.height,c=n.width,p=n.height;if(!o||!l||!c||!p)return!1;var r=e.x,w=e.y,M=n.x,N=n.y;return c+=M,o+=r,p+=N,l+=w,r<=M&&c<=o&&w<=N&&p<=l},corner:function(){return new Te(this.x+this.width,this.y+this.height)},equals:function(t){var e=new ai(this).normalize(),n=new ai(t).normalize();return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height},inflate:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},intersect:function(t){var e=this.origin(),n=this.corner(),o=t.origin(),l=t.corner();if(l.x<=e.x||l.y<=e.y||o.x>=n.x||o.y>=n.y)return null;var c=wS(e.x,o.x),p=wS(e.y,o.y);return new ai(c,p,fv(n.x,l.x)-c,fv(n.y,l.y)-p)},intersectionWithLine:function(t){var e=this,n=[e.topLine(),e.rightLine(),e.bottomLine(),e.leftLine()],o=[],l=[],c,p,r=n.length;for(p=0;p<r;p++)c=t.intersect(n[p]),c!==null&&l.indexOf(c.toString())<0&&(o.push(c),l.push(c.toString()));return o.length>0?o:null},intersectionWithLineFromCenterToPoint:function(t,e){t=new Te(t);var n=new Te(this.x+this.width/2,this.y+this.height/2),o;e&&t.rotate(n,e);for(var l=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],c=new di(n,t),p=l.length-1;p>=0;--p){var r=l[p].intersection(c);if(r!==null){o=r;break}}return o&&e&&o.rotate(n,-e),o},leftLine:function(){return new di(this.topLeft(),this.bottomLeft())},leftMiddle:function(){return new Te(this.x,this.y+this.height/2)},maxRectScaleToFit:function(t,e){t=new ai(t),e||(e=t.center());var n,o,l,c,p,r,w,M,N=e.x,E=e.y;n=o=l=c=p=r=w=M=1/0;var Z=t.topLeft();Z.x<N&&(n=(this.x-N)/(Z.x-N)),Z.y<E&&(p=(this.y-E)/(Z.y-E));var Y=t.bottomRight();Y.x>N&&(o=(this.x+this.width-N)/(Y.x-N)),Y.y>E&&(r=(this.y+this.height-E)/(Y.y-E));var K=t.topRight();K.x>N&&(l=(this.x+this.width-N)/(K.x-N)),K.y<E&&(w=(this.y-E)/(K.y-E));var q=t.bottomLeft();return q.x<N&&(c=(this.x-N)/(q.x-N)),q.y>E&&(M=(this.y+this.height-E)/(q.y-E)),{sx:fv(n,o,l,c),sy:fv(p,r,w,M)}},maxRectUniformScaleToFit:function(t,e){var n=this.maxRectScaleToFit(t,e);return fv(n.sx,n.sy)},moveAndExpand:function(t){return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this},normalize:function(){var t=this.x,e=this.y,n=this.width,o=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,o=-this.height),this.x=t,this.y=e,this.width=n,this.height=o,this},offset:function(t,e){return Te.prototype.offset.call(this,t,e)},origin:function(){return new Te(this.x,this.y)},pointNearestToPoint:function(t){if(t=new Te(t),this.containsPoint(t)){var e=this.sideNearestToPoint(t);switch(e){case"right":return new Te(this.x+this.width,t.y);case"left":return new Te(this.x,t.y);case"bottom":return new Te(t.x,this.y+this.height);case"top":return new Te(t.x,this.y)}}return t.adhereToRect(this)},rightLine:function(){return new di(this.topRight(),this.bottomRight())},rightMiddle:function(){return new Te(this.x+this.width,this.y+this.height/2)},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=iO(10,t);break}return this.x=t1(this.x*e)/e,this.y=t1(this.y*e)/e,this.width=t1(this.width*e)/e,this.height=t1(this.height*e)/e,this},scale:function(t,e,n){return n=this.origin().scale(t,e,n),this.x=n.x,this.y=n.y,this.width*=t,this.height*=e,this},sideNearestToPoint:function(t){t=new Te(t);var e=t.x-this.x,n=this.x+this.width-t.x,o=t.y-this.y,l=this.y+this.height-t.y,c=e,p="left";return n<c&&(c=n,p="right"),o<c&&(c=o,p="top"),l<c&&(p="bottom"),p},snapToGrid:function(t,e){var n=this.origin().snapToGrid(t,e),o=this.corner().snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=o.x-n.x,this.height=o.y-n.y,this},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},topLine:function(){return new di(this.topLeft(),this.topRight())},topMiddle:function(){return new Te(this.x+this.width/2,this.y)},topRight:function(){return new Te(this.x+this.width,this.y)},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(t){return ai.fromRectUnion(this,t)},update:function(t,e,n,o){return Object(t)===t&&(e=t.y,n=t.width,o=t.height,t=t.x),this.x=t||0,this.y=e||0,this.width=n||0,this.height=o||0,this}};ai.prototype.bottomRight=ai.prototype.corner;ai.prototype.topLeft=ai.prototype.origin;ai.prototype.translate=ai.prototype.offset;const rO=ai;function VL(t){const e=t.trim();if(e==="")return[];const n=[],o=e.split(/\b\s*,\s*|,\s*|\s+/),l=o.length;for(let c=0;c<l;c+=2)n.push({x:+o[c],y:+o[c+1]});return n}function WL(t){const e=t.length;if(e===0)return[];const n=[];for(let o=0;o<e;o++){const l=t[o].clone();n.push(l)}return n}function YL(t){const{abs:e}=Math;var n,o,l=t.length;if(l===0)return[];var c;for(n=0;n<l;n++)(c===void 0||t[n].y<c.y||t[n].y===c.y&&t[n].x>c.x)&&(c=t[n]);var p=[];for(n=0;n<l;n++){var r=c.theta(t[n]);r===0&&(r=360);var w=[t[n],n,r];p.push(w)}if(p.sort(function(te,ht){var ie=te[2]-ht[2];return ie===0&&(ie=ht[1]-te[1]),ie}),p.length>2){var M=p[p.length-1];p.unshift(M)}for(var N={},E=[],Z,Y,K,q,at,J;p.length!==0;)if(Z=p.pop(),Y=Z[0],!N.hasOwnProperty(Z[0]+"@@"+Z[1]))for(var Q=!1;!Q;)if(E.length<2)E.push(Z),Q=!0;else{K=E.pop(),q=K[0],at=E.pop(),J=at[0];var lt=J.cross(q,Y);if(lt<0)E.push(at),E.push(K),E.push(Z),Q=!0;else if(lt===0){var Ct=1e-10,j=q.angleBetween(J,Y);e(j-180)<Ct||q.equals(Y)||J.equals(q)?(N[K[0]+"@@"+K[1]]=q,E.push(at)):e((j+1)%360-1)<Ct&&(E.push(at),p.push(K))}else N[K[0]+"@@"+K[1]]=q,E.push(at)}E.length>2&&E.pop();var k,rt=-1;for(o=E.length,n=0;n<o;n++){var yt=E[n][1];(k===void 0||yt<k)&&(k=yt,rt=n)}var xt=[];if(rt>0){var kt=E.slice(rt),de=E.slice(0,rt);xt=kt.concat(de)}else xt=E;var Et=[];for(o=xt.length,n=0;n<o;n++)Et.push(xt[n][0]);return Et}const as=function(t){if(!(this instanceof as))return new as(t);if(typeof t=="string")return new as.parse(t);this.points=Array.isArray(t)?t.map(Te):[]};as.parse=function(t){return new as(VL(t))};as.fromRect=function(t){return new as([t.topLeft(),t.topRight(),t.bottomRight(),t.bottomLeft(),t.topLeft()])};as.prototype={type:Er.Polyline,bbox:function(){var t=1/0,e=-1/0,n=1/0,o=-1/0,l=this.points,c=l.length;if(c===0)return null;for(var p=0;p<c;p++){var r=l[p],w=r.x,M=r.y;w<t&&(t=w),w>e&&(e=w),M<n&&(n=M),M>o&&(o=M)}return new ai(t,n,e-t,o-n)},clone:function(){return new as(WL(this.points))},closestPoint:function(t){var e=this.closestPointLength(t);return this.pointAtLength(e)},closestPointLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return 0;for(var o,l=1/0,c=0,p=n-1,r=0;r<p;r++){var w=new di(e[r],e[r+1]),M=w.length(),N=w.closestPointNormalizedLength(t),E=w.pointAt(N),Z=E.squaredDistance(t);Z<l&&(l=Z,o=c+N*M),c+=M}return o},closestPointNormalizedLength:function(t){var e=this.closestPointLength(t);if(e===0)return 0;var n=this.length();return n===0?0:e/n},closestPointTangent:function(t){var e=this.closestPointLength(t);return this.tangentAtLength(e)},containsPoint:function(t){var e=this.points,n=e.length;if(n===0)return!1;for(var o=t.x,l=t.y,c=n-1,p=0,r=0,w=new di,M=new di,N=new Te;p<n;p++){var E=e[c],Z=e[p];if(t.equals(E)||(w.start=E,w.end=Z,w.containsPoint(t)))return!0;if(l<=E.y&&l>Z.y||l>E.y&&l<=Z.y){var Y=E.x-o>Z.x-o?E.x-o:Z.x-o;Y>=0&&(N.x=o+Y,N.y=l,M.start=t,M.end=N,w.intersect(M)&&r++)}c=p}return r%2===1},close:function(){const{start:t,end:e,points:n}=this;return t&&e&&!t.equals(e)&&n.push(t.clone()),this},lengthPoints:function(){return this.points},convexHull:function(){return new as(YL(this.points))},equals:function(t){if(!t)return!1;var e=this.points,n=t.points,o=e.length;if(n.length!==o)return!1;for(var l=0;l<o;l++){var c=e[l],p=t.points[l];if(!c.equals(p))return!1}return!0},intersectionWithLine:function(t){for(var e=new di(t),n=[],o=this.lengthPoints(),l=new di,c=0,p=o.length-1;c<p;c++){l.start=o[c],l.end=o[c+1];var r=e.intersectionWithLine(l);r&&n.push(r[0])}return n.length>0?n:null},isDifferentiable:function(){var t=this.points,e=t.length;if(e===0)return!1;for(var n=new di,o=e-1,l=0;l<o;l++)if(n.start=t[l],n.end=t[l+1],n.isDifferentiable())return!0;return!1},length:function(){var t=this.lengthPoints(),e=t.length;if(e===0)return 0;for(var n=0,o=e-1,l=0;l<o;l++)n+=t[l].distance(t[l+1]);return n},pointAt:function(t){var e=this.lengthPoints(),n=e.length;if(n===0)return null;if(n===1||t<=0)return e[0].clone();if(t>=1)return e[n-1].clone();var o=this.length(),l=o*t;return this.pointAtLength(l)},pointAtLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0)return null;if(n===1)return e[0].clone();var o=!0;t<0&&(o=!1,t=-t);for(var l=0,c=n-1,p=0;p<c;p++){var r=o?p:c-1-p,w=e[r],M=e[r+1],N=new di(w,M),E=w.distance(M);if(t<=l+E)return N.pointAtLength((o?1:-1)*(t-l));l+=E}var Z=o?e[n-1]:e[0];return Z.clone()},round:function(t){for(var e=this.points,n=e.length,o=0;o<n;o++)e[o].round(t);return this},scale:function(t,e,n){for(var o=this.points,l=o.length,c=0;c<l;c++)o[c].scale(t,e,n);return this},simplify:function(t={}){const e=this.points;if(e.length<3)return this;const n=t.threshold||0;let o=0;for(;e[o+2];){const l=o,c=o+1,p=o+2,r=e[l],w=e[c],M=e[p];new di(r,M).closestPoint(w).distance(w)<=n?e.splice(c,1):o+=1}return this},tangentAt:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return null;t<0&&(t=0),t>1&&(t=1);var o=this.length(),l=o*t;return this.tangentAtLength(l)},tangentAtLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return null;var o=!0;t<0&&(o=!1,t=-t);for(var l,c=0,p=n-1,r=0;r<p;r++){var w=o?r:p-1-r,M=e[w],N=e[w+1],E=new di(M,N),Z=M.distance(N);if(E.isDifferentiable()){if(t<=c+Z)return E.tangentAtLength((o?1:-1)*(t-c));l=E}c+=Z}if(l){var Y=o?1:0;return l.tangentAt(Y)}return null},toString:function(){return this.points+""},translate:function(t,e){for(var n=this.points,o=n.length,l=0;l<o;l++)n[l].translate(t,e);return this},serialize:function(){var t=this.points,e=t.length;if(e===0)return"";for(var n="",o=0;o<e;o++){var l=t[o];n+=l.x+","+l.y+" "}return n.trim()}};Object.defineProperty(as.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.points,e=t.length;return e===0?null:this.points[0]}});Object.defineProperty(as.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.points,e=t.length;return e===0?null:this.points[e-1]}});const{abs:e1,sqrt:oO,min:bS,max:IS,pow:SI}=Math,Mo=function(t,e,n,o){if(!(this instanceof Mo))return new Mo(t,e,n,o);if(t instanceof Mo)return new Mo(t.start,t.controlPoint1,t.controlPoint2,t.end);this.start=new Te(t),this.controlPoint1=new Te(e),this.controlPoint2=new Te(n),this.end=new Te(o)};Mo.throughPoints=function(){function t(n){var o=[],l=[],c=n.length-1,p;if(c==1)return o[0]=new Te((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),l[0]=new Te(2*o[0].x-n[0].x,2*o[0].y-n[0].y),[o,l];var r=[];for(p=1;p<c-1;p++)r[p]=4*n[p].x+2*n[p+1].x;r[0]=n[0].x+2*n[1].x,r[c-1]=(8*n[c-1].x+n[c].x)/2;var w=e(r);for(p=1;p<c-1;++p)r[p]=4*n[p].y+2*n[p+1].y;r[0]=n[0].y+2*n[1].y,r[c-1]=(8*n[c-1].y+n[c].y)/2;var M=e(r);for(p=0;p<c;p++)o.push(new Te(w[p],M[p])),p<c-1?l.push(new Te(2*n[p+1].x-w[p+1],2*n[p+1].y-M[p+1])):l.push(new Te((n[c].x+w[c-1])/2,(n[c].y+M[c-1])/2));return[o,l]}function e(n){var o=n.length,l=[],c=[],p=2;l[0]=n[0]/p;for(var r=1;r<o;r++)c[r]=1/p,p=(r<o-1?4:3.5)-c[r],l[r]=(n[r]-l[r-1])/p;for(r=1;r<o;r++)l[o-r-1]-=c[o-r]*l[o-r];return l}return function(n){if(!n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");for(var o=t(n),l=[],c=o[0].length,p=0;p<c;p++){var r=new Te(o[0][p].x,o[0][p].y),w=new Te(o[1][p].x,o[1][p].y);l.push(new Mo(n[p],r,w,n[p+1]))}return l}}();Mo.prototype={type:Er.Curve,bbox:function(){for(var t=this.start,e=this.controlPoint1,n=this.controlPoint2,o=this.end,l=t.x,c=t.y,p=e.x,r=e.y,w=n.x,M=n.y,N=o.x,E=o.y,Z=new Array,Y=new Array,K=[new Array,new Array],q,at,J,Q,lt,Ct,j,k,rt=0;rt<2;++rt){if(rt===0?(at=6*l-12*p+6*w,q=-3*l+9*p-9*w+3*N,J=3*p-3*l):(at=6*c-12*r+6*M,q=-3*c+9*r-9*M+3*E,J=3*r-3*c),e1(q)<1e-12){if(e1(at)<1e-12)continue;Q=-J/at,0<Q&&Q<1&&Y.push(Q);continue}j=at*at-4*J*q,k=oO(j),!(j<0)&&(lt=(-at+k)/(2*q),0<lt&&lt<1&&Y.push(lt),Ct=(-at-k)/(2*q),0<Ct&&Ct<1&&Y.push(Ct))}for(var yt=Y.length,xt=yt,kt,de,Et;yt--;)Q=Y[yt],kt=1-Q,de=kt*kt*kt*l+3*kt*kt*Q*p+3*kt*Q*Q*w+Q*Q*Q*N,K[0][yt]=de,Et=kt*kt*kt*c+3*kt*kt*Q*r+3*kt*Q*Q*M+Q*Q*Q*E,K[1][yt]=Et,Z[yt]={X:de,Y:Et};Y[xt]=0,Y[xt+1]=1,Z[xt]={X:l,Y:c},Z[xt+1]={X:N,Y:E},K[0][xt]=l,K[1][xt]=c,K[0][xt+1]=N,K[1][xt+1]=E,Y.length=xt+2,K[0].length=xt+2,K[1].length=xt+2,Z.length=xt+2;var te=bS.apply(null,K[0]),ht=bS.apply(null,K[1]),ie=IS.apply(null,K[0]),ln=IS.apply(null,K[1]);return new ai(te,ht,ie-te,ln-ht)},clone:function(){return new Mo(this.start,this.controlPoint1,this.controlPoint2,this.end)},closestPoint:function(t,e){return this.pointAtT(this.closestPointT(t,e))},closestPointLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,o=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,l={precision:n,subdivisions:o};return this.lengthAtT(this.closestPointT(t,l),l)},closestPointNormalizedLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,o=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,l={precision:n,subdivisions:o},c=this.closestPointLength(t,l);if(!c)return 0;var p=this.length(l);return p===0?0:c/p},closestPointT:function(t,e){e=e||{};for(var n=e.precision===void 0?this.PRECISION:e.precision,o=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,l,c,p,r,w,M,N,E=o.length,Z=E?1/E:0,Y=0;Y<E;Y++){var K=o[Y],q=K.start.distance(t),at=K.end.distance(t),J=q+at;(!N||J<N)&&(l=K,c=Y*Z,p=(Y+1)*Z,r=q,w=at,M=K.start.distance(K.end),N=J)}for(var Q=SI(10,-n);;){var lt=r?e1(r-w)/r:0,Ct=w?e1(r-w)/w:0,j=lt<Q||Ct<Q,k=r?r<M*Q:!0,rt=w?w<M*Q:!0,yt=k||rt;if(j||yt)return r<=w?c:p;var xt=l.divide(.5);Z/=2;var kt=xt[0].start.distance(t),de=xt[0].end.distance(t),Et=kt+de,te=xt[1].start.distance(t),ht=xt[1].end.distance(t),ie=te+ht;Et<=ie?(l=xt[0],p-=Z,r=kt,w=de):(l=xt[1],c+=Z,r=te,w=ht)}},closestPointTangent:function(t,e){return this.tangentAtT(this.closestPointT(t,e))},containsPoint:function(t,e){var n=this.toPolyline(e);return n.containsPoint(t)},divideAt:function(t,e){if(t<=0)return this.divideAtT(0);if(t>=1)return this.divideAtT(1);var n=this.tAt(t,e);return this.divideAtT(n)},divideAtLength:function(t,e){var n=this.tAtLength(t,e);return this.divideAtT(n)},divideAtT:function(t){var e=this.start,n=this.controlPoint1,o=this.controlPoint2,l=this.end;if(t<=0)return[new Mo(e,e,e,e),new Mo(e,n,o,l)];if(t>=1)return[new Mo(e,n,o,l),new Mo(l,l,l,l)];var c=this.getSkeletonPoints(t),p=c.startControlPoint1,r=c.startControlPoint2,w=c.divider,M=c.dividerControlPoint1,N=c.dividerControlPoint2;return[new Mo(e,p,r,w),new Mo(w,M,N,l)]},endpointDistance:function(){return this.start.distance(this.end)},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.controlPoint1.x===t.controlPoint1.x&&this.controlPoint1.y===t.controlPoint1.y&&this.controlPoint2.x===t.controlPoint2.x&&this.controlPoint2.y===t.controlPoint2.y&&this.end.x===t.end.x&&this.end.y===t.end.y},getSkeletonPoints:function(t){var e=this.start,n=this.controlPoint1,o=this.controlPoint2,l=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:o.clone()};if(t>=1)return{startControlPoint1:n.clone(),startControlPoint2:o.clone(),divider:l.clone(),dividerControlPoint1:l.clone(),dividerControlPoint2:l.clone()};var c=new di(e,n).pointAt(t),p=new di(n,o).pointAt(t),r=new di(o,l).pointAt(t),w=new di(c,p).pointAt(t),M=new di(p,r).pointAt(t),N=new di(w,M).pointAt(t),E={startControlPoint1:c,startControlPoint2:w,divider:N,dividerControlPoint1:M,dividerControlPoint2:r};return E},getSubdivisions:function(t){t=t||{};var e=t.precision===void 0?this.PRECISION:t.precision,n=[new Mo(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(e===0)return n;for(var o=this.endpointDistance(),l=SI(10,-e),c=0;;){c+=1;for(var p=[],r=n.length,w=0;w<r;w++){var M=n[w],N=M.divide(.5);p.push(N[0],N[1])}for(var E=0,Z=p.length,Y=0;Y<Z;Y++){var K=p[Y];E+=K.endpointDistance()}var q=E!==0?(E-o)/E:0;if(c>1&&q<l)return p;n=p,o=E}},isDifferentiable:function(){var t=this.start,e=this.controlPoint1,n=this.controlPoint2,o=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(o))},length:function(t){t=t||{};for(var e=t.precision===void 0?this.PRECISION:t.precision,n=t.subdivisions===void 0?this.getSubdivisions({precision:e}):t.subdivisions,o=0,l=n.length,c=0;c<l;c++){var p=n[c];o+=p.endpointDistance()}return o},lengthAtT:function(t,e){if(t<=0)return 0;e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,o=this.divide(t)[0],l=o.length({precision:n});return l},pointAt:function(t,e){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();var n=this.tAt(t,e);return this.pointAtT(n)},pointAtLength:function(t,e){var n=this.tAtLength(t,e);return this.pointAtT(n)},pointAtT:function(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider},PRECISION:3,round:function(t){return this.start.round(t),this.controlPoint1.round(t),this.controlPoint2.round(t),this.end.round(t),this},scale:function(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},tangentAt:function(t,e){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);var n=this.tAt(t,e);return this.tangentAtT(n)},tangentAtLength:function(t,e){if(!this.isDifferentiable())return null;var n=this.tAtLength(t,e);return this.tangentAtT(n)},tangentAtT:function(t){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);var e=this.getSkeletonPoints(t),n=e.startControlPoint2,o=e.dividerControlPoint1,l=e.divider,c=new di(n,o);return c.translate(l.x-n.x,l.y-n.y),c},tAt:function(t,e){if(t<=0)return 0;if(t>=1)return 1;e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,o=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,l={precision:n,subdivisions:o},c=this.length(l),p=c*t;return this.tAtLength(p,l)},tAtLength:function(t,e){var n=!0;t<0&&(n=!1,t=-t),e=e||{};for(var o=e.precision===void 0?this.PRECISION:e.precision,l=e.subdivisions===void 0?this.getSubdivisions({precision:o}):e.subdivisions,c={precision:o,subdivisions:l},p,r,w,M,N,E=0,Z=l.length,Y=1/Z,K=0;K<Z;K++){var q=n?K:Z-1-K,at=l[K],J=at.endpointDistance();if(t<=E+J){p=at,r=q*Y,w=(q+1)*Y,M=n?t-E:J+E-t,N=n?J+E-t:t-E;break}E+=J}if(!p)return n?1:0;for(var Q=this.length(c),lt=SI(10,-o);;){var Ct;if(Ct=Q!==0?M/Q:0,Ct<lt)return r;if(Ct=Q!==0?N/Q:0,Ct<lt)return w;var j,k,rt=p.divide(.5);Y/=2;var yt=rt[0].endpointDistance(),xt=rt[1].endpointDistance();M<=yt?(p=rt[0],w-=Y,j=M,k=yt-j):(p=rt[1],r+=Y,j=M-yt,k=xt-j),M=j,N=k}},toPoints:function(t){t=t||{};for(var e=t.precision===void 0?this.PRECISION:t.precision,n=t.subdivisions===void 0?this.getSubdivisions({precision:e}):t.subdivisions,o=[n[0].start.clone()],l=n.length,c=0;c<l;c++){var p=n[c];o.push(p.end.clone())}return o},toPolyline:function(t){return new as(this.toPoints(t))},toString:function(){return this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};Mo.prototype.divide=Mo.prototype.divideAtT;function sy(t){var e,n,o=[];for(n=arguments.length,e=1;e<n;e++)o.push(arguments[e]);if(!t)throw new Error("Missing a parent object.");var l=Object.create(t);for(n=o.length,e=0;e<n;e++){var c=o[e],p,r;for(r in c)c.hasOwnProperty(r)&&(delete l[r],p=Object.getOwnPropertyDescriptor(c,r),Object.defineProperty(l,r,p))}return l}const zi=function(t){if(!(this instanceof zi))return new zi(t);if(typeof t=="string")return new zi.parse(t);this.segments=[];var e,n;if(t)if(Array.isArray(t)&&t.length!==0)if(t=t.reduce(function(r,w){return r.concat(w)},[]),n=t.length,t[0].isSegment)for(e=0;e<n;e++){var o=t[e];this.appendSegment(o)}else{var l=null;for(e=0;e<n;e++){var c=t[e];if(!(c instanceof di||c instanceof Mo))throw new Error("Cannot construct a path segment from the provided object.");e===0&&this.appendSegment(zi.createSegment("M",c.start)),l&&!l.end.equals(c.start)&&this.appendSegment(zi.createSegment("M",c.start)),c instanceof di?this.appendSegment(zi.createSegment("L",c.end)):c instanceof Mo&&this.appendSegment(zi.createSegment("C",c.controlPoint1,c.controlPoint2,c.end)),l=c}}else if(t.isSegment)this.appendSegment(t);else if(t instanceof di)this.appendSegment(zi.createSegment("M",t.start)),this.appendSegment(zi.createSegment("L",t.end));else if(t instanceof Mo)this.appendSegment(zi.createSegment("M",t.start)),this.appendSegment(zi.createSegment("C",t.controlPoint1,t.controlPoint2,t.end));else if(t instanceof as){if(!(t.points&&t.points.length!==0))return;for(n=t.points.length,e=0;e<n;e++){var p=t.points[e];e===0?this.appendSegment(zi.createSegment("M",p)):this.appendSegment(zi.createSegment("L",p))}}else throw new Error("Cannot construct a path from the provided object.")};zi.parse=function(t){if(!t)return new zi;for(var e=new zi,n=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g,o=t.match(n),l=o.length,c=0;c<l;c++){var p=o[c],r=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,w=p.match(r),M=zi.createSegment.apply(this,w);e.appendSegment(M)}return e};zi.createSegment=function(t){if(!t)throw new Error("Type must be provided.");var e=zi.segmentTypes[t];if(!e)throw new Error(t+" is not a recognized path segment type.");for(var n=[],o=arguments.length,l=1;l<o;l++)n.push(arguments[l]);return Nh(e,n)};zi.prototype={type:Er.Path,appendSegment:function(t){var e=this.segments,n=e.length,o,l=n!==0?e[n-1]:null,c=null;if(Array.isArray(t)){if(t=t.reduce(function(M,N){return M.concat(N)},[]),!t[0].isSegment)throw new Error("Segments required.");for(var p=t.length,r=0;r<p;r++){var w=t[r];o=this.prepareSegment(w,l,c),e.push(o),l=o}}else{if(!t||!t.isSegment)throw new Error("Segment required.");o=this.prepareSegment(t,l,c),e.push(o)}},bbox:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n,o=0;o<e;o++){var l=t[o];if(l.isVisible){var c=l.bbox();n=n?n.union(c):c}}if(n)return n;var p=t[e-1];return new ai(p.end.x,p.end.y,0,0)},clone:function(){for(var t=this.segments,e=t.length,n=new zi,o=0;o<e;o++){var l=t[o].clone();n.appendSegment(l)}return n},closestPoint:function(t,e){var n=this.closestPointT(t,e);return n?this.pointAtT(n):null},closestPointLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,o=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions,l={precision:n,segmentSubdivisions:o},c=this.closestPointT(t,l);return c?this.lengthAtT(c,l):0},closestPointNormalizedLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,o=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions,l={precision:n,segmentSubdivisions:o},c=this.closestPointLength(t,l);if(c===0)return 0;var p=this.length(l);return p===0?0:c/p},closestPointT:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;e=e||{};for(var l=e.precision===void 0?this.PRECISION:e.precision,c=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:l}):e.segmentSubdivisions,p,r=1/0,w=0;w<o;w++){var M=n[w],N=c[w];if(M.isVisible){var E=M.closestPointT(t,{precision:l,subdivisions:N}),Z=M.pointAtT(E),Y=new di(Z,t).squaredLength();Y<r&&(p={segmentIndex:w,value:E},r=Y)}}return p||{segmentIndex:o-1,value:1}},closestPointTangent:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;e=e||{};for(var l=e.precision===void 0?this.PRECISION:e.precision,c=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:l}):e.segmentSubdivisions,p,r=1/0,w=0;w<o;w++){var M=n[w],N=c[w];if(M.isDifferentiable()){var E=M.closestPointT(t,{precision:l,subdivisions:N}),Z=M.pointAtT(E),Y=new di(Z,t).squaredLength();Y<r&&(p=M.tangentAtT(E),r=Y)}}return p||null},containsPoint:function(t,e){var n=this.toPolylines(e);if(!n)return!1;for(var o=n.length,l=0,c=0;c<o;c++){var p=n[c];p.containsPoint(t)&&l++}return l%2===1},divideAt:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var l=e.precision===void 0?this.PRECISION:e.precision,c=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:l}):e.segmentSubdivisions,p={precision:l,segmentSubdivisions:c},r=this.length(p),w=r*t;return this.divideAtLength(w,p)},divideAtLength:function(t,e){var n=this.segments.length;if(n===0)return null;var o=!0;t<0&&(o=!1,t=-t),e=e||{};var l=e.precision===void 0?this.PRECISION:e.precision,c=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:l}):e.segmentSubdivisions,p,r,w=0,M,N,E,Z,Y;for(p=0;p<n;p++){var K=o?p:n-1-p;r=this.getSegment(K);var q=c[K],at=r.length({precision:l,subdivisions:q});if(r.isDifferentiable()&&(E=r,Z=K,t<=w+at)){N=K,M=r.divideAtLength((o?1:-1)*(t-w),{precision:l,subdivisions:q});break}w+=at}if(!E)return null;M||(N=Z,Y=o?1:0,M=E.divideAtT(Y));var J=this.clone();J.replaceSegment(N,M);var Q=N,lt=N+1,Ct=N+2;M[0].isDifferentiable()||(J.removeSegment(Q),lt-=1,Ct-=1);var j=J.getSegment(lt).start;J.insertSegment(lt,zi.createSegment("M",j)),Ct+=1,M[1].isDifferentiable()||(J.removeSegment(Ct-1),Ct-=1);var k=Ct-Q-1;for(p=Ct;p<J.segments.length;p++){var rt=this.getSegment(p-k);if(r=J.getSegment(p),r.type==="Z"&&!rt.subpathStartSegment.end.equals(r.subpathStartSegment.end)){var yt=zi.createSegment("L",rt.end);J.replaceSegment(p,yt)}}var xt=new zi(J.segments.slice(0,lt)),kt=new zi(J.segments.slice(lt));return[xt,kt]},equals:function(t){if(!t)return!1;var e=this.segments,n=t.segments,o=e.length;if(n.length!==o)return!1;for(var l=0;l<o;l++){var c=e[l],p=n[l];if(c.type!==p.type||!c.equals(p))return!1}return!0},getSegment:function(t){var e=this.segments,n=e.length;if(n===0)throw new Error("Path has no segments.");if(t<0&&(t=n+t),t>=n||t<0)throw new Error("Index out of range.");return e[t]},getSegmentSubdivisions:function(t){var e=this.segments,n=e.length;t=t||{};for(var o=t.precision===void 0?this.PRECISION:t.precision,l=[],c=0;c<n;c++){var p=e[c],r=p.getSubdivisions({precision:o});l.push(r)}return l},getSubpaths:function(){const e=this.clone().validate().segments,n=e.length,o=[];for(let l=0;l<n;l++){const c=e[l];c.isSubpathStart?o.push(new zi(c)):o[o.length-1].appendSegment(c)}return o},insertSegment:function(t,e){var n=this.segments,o=n.length;if(t<0&&(t=o+t+1),t>o||t<0)throw new Error("Index out of range.");var l,c=null,p=null;if(o!==0&&(t>=1?(c=n[t-1],p=c.nextSegment):p=n[0]),Array.isArray(e)){if(e=e.reduce(function(N,E){return N.concat(E)},[]),!e[0].isSegment)throw new Error("Segments required.");for(var r=e.length,w=0;w<r;w++){var M=e[w];l=this.prepareSegment(M,c,p),n.splice(t+w,0,l),c=l}}else{if(!e||!e.isSegment)throw new Error("Segment required.");l=this.prepareSegment(e,c,p),n.splice(t,0,l)}},intersectionWithLine:function(t,e){var n=null,o=this.toPolylines(e);if(!o)return null;for(var l=0,c=o.length;l<c;l++){var p=o[l],r=t.intersect(p);r&&(n||(n=[]),Array.isArray(r)?Array.prototype.push.apply(n,r):n.push(r))}return n},isDifferentiable:function(){for(var t=this.segments,e=t.length,n=0;n<e;n++){var o=t[n];if(o.isDifferentiable())return!0}return!1},isValid:function(){var t=this.segments,e=t.length===0||t[0].type==="M";return e},length:function(t){var e=this.segments,n=e.length;if(n===0)return 0;t=t||{};for(var o=t.precision===void 0?this.PRECISION:t.precision,l=t.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:o}):t.segmentSubdivisions,c=0,p=0;p<n;p++){var r=e[p],w=l[p];c+=r.length({subdivisions:w})}return c},lengthAtT:function(t,e){var n=this.segments,o=n.length;if(o===0)return 0;var l=t.segmentIndex;if(l<0)return 0;var c=t.value;l>=o?(l=o-1,c=1):c<0?c=0:c>1&&(c=1),e=e||{};for(var p=e.precision===void 0?this.PRECISION:e.precision,r=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:p}):e.segmentSubdivisions,w,M=0,N=0;N<l;N++){var E=n[N];w=r[N],M+=E.length({precisison:p,subdivisions:w})}return E=n[l],w=r[l],M+=E.lengthAtT(c,{precisison:p,subdivisions:w}),M},pointAt:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();e=e||{};var l=e.precision===void 0?this.PRECISION:e.precision,c=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:l}):e.segmentSubdivisions,p={precision:l,segmentSubdivisions:c},r=this.length(p),w=r*t;return this.pointAtLength(w,p)},pointAtLength:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;if(t===0)return this.start.clone();var l=!0;t<0&&(l=!1,t=-t),e=e||{};for(var c=e.precision===void 0?this.PRECISION:e.precision,p=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:c}):e.segmentSubdivisions,r,w=0,M=0;M<o;M++){var N=l?M:o-1-M,E=n[N],Z=p[N],Y=E.length({precision:c,subdivisions:Z});if(E.isVisible){if(t<=w+Y)return E.pointAtLength((l?1:-1)*(t-w),{precision:c,subdivisions:Z});r=E}w+=Y}if(r)return l?r.end:r.start;var K=n[o-1];return K.end.clone()},pointAtT:function(t){var e=this.segments,n=e.length;if(n===0)return null;var o=t.segmentIndex;if(o<0)return e[0].pointAtT(0);if(o>=n)return e[n-1].pointAtT(1);var l=t.value;return l<0?l=0:l>1&&(l=1),e[o].pointAtT(l)},PRECISION:3,prepareSegment:function(t,e,n){t.previousSegment=e,t.nextSegment=n,e&&(e.nextSegment=t),n&&(n.previousSegment=t);var o=t;return t.isSubpathStart&&(t.subpathStartSegment=t,o=n),o&&this.updateSubpathStartSegment(o),t},removeSegment:function(t){var e=this.segments,n=e.length;if(n===0)throw new Error("Path has no segments.");if(t<0&&(t=n+t),t>=n||t<0)throw new Error("Index out of range.");var o=e.splice(t,1)[0],l=o.previousSegment,c=o.nextSegment;l&&(l.nextSegment=c),c&&(c.previousSegment=l),o.isSubpathStart&&c&&this.updateSubpathStartSegment(c)},replaceSegment:function(t,e){var n=this.segments,o=n.length;if(o===0)throw new Error("Path has no segments.");if(t<0&&(t=o+t),t>=o||t<0)throw new Error("Index out of range.");var l,c=n[t],p=c.previousSegment,r=c.nextSegment,w=c.isSubpathStart;if(Array.isArray(e)){if(e=e.reduce(function(Z,Y){return Z.concat(Y)},[]),!e[0].isSegment)throw new Error("Segments required.");n.splice(t,1);for(var M=e.length,N=0;N<M;N++){var E=e[N];l=this.prepareSegment(E,p,r),n.splice(t+N,0,l),p=l,w&&l.isSubpathStart&&(w=!1)}}else{if(!e||!e.isSegment)throw new Error("Segment required.");l=this.prepareSegment(e,p,r),n.splice(t,1,l),w&&l.isSubpathStart&&(w=!1)}w&&r&&this.updateSubpathStartSegment(r)},round:function(t){for(var e=this.segments,n=e.length,o=0;o<n;o++){var l=e[o];l.round(t)}return this},scale:function(t,e,n){for(var o=this.segments,l=o.length,c=0;c<l;c++){var p=o[c];p.scale(t,e,n)}return this},segmentAt:function(t,e){var n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null},segmentAtLength:function(t,e){var n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null},segmentIndexAt:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var l=e.precision===void 0?this.PRECISION:e.precision,c=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:l}):e.segmentSubdivisions,p={precision:l,segmentSubdivisions:c},r=this.length(p),w=r*t;return this.segmentIndexAtLength(w,p)},segmentIndexAtLength:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;var l=!0;t<0&&(l=!1,t=-t),e=e||{};for(var c=e.precision===void 0?this.PRECISION:e.precision,p=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:c}):e.segmentSubdivisions,r=null,w=0,M=0;M<o;M++){var N=l?M:o-1-M,E=n[N],Z=p[N],Y=E.length({precision:c,subdivisions:Z});if(E.isVisible){if(t<=w+Y)return N;r=N}w+=Y}return r},serialize:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.toString()},tangentAt:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var l=e.precision===void 0?this.PRECISION:e.precision,c=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:l}):e.segmentSubdivisions,p={precision:l,segmentSubdivisions:c},r=this.length(p),w=r*t;return this.tangentAtLength(w,p)},tangentAtLength:function(t,e){var n=this.segments,o=n.length;if(o===0)return null;var l=!0;t<0&&(l=!1,t=-t),e=e||{};for(var c=e.precision===void 0?this.PRECISION:e.precision,p=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:c}):e.segmentSubdivisions,r,w=0,M=0;M<o;M++){var N=l?M:o-1-M,E=n[N],Z=p[N],Y=E.length({precision:c,subdivisions:Z});if(E.isDifferentiable()){if(t<=w+Y)return E.tangentAtLength((l?1:-1)*(t-w),{precision:c,subdivisions:Z});r=E}w+=Y}if(r){var K=l?1:0;return r.tangentAtT(K)}return null},tangentAtT:function(t){var e=this.segments,n=e.length;if(n===0)return null;var o=t.segmentIndex;if(o<0)return e[0].tangentAtT(0);if(o>=n)return e[n-1].tangentAtT(1);var l=t.value;return l<0?l=0:l>1&&(l=1),e[o].tangentAtT(l)},toPoints:function(t){var e=this.segments,n=e.length;if(n===0)return null;t=t||{};for(var o=t.precision===void 0?this.PRECISION:t.precision,l=t.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:o}):t.segmentSubdivisions,c=[],p=[],r=0;r<n;r++){var w=e[r];if(w.isVisible){var M=l[r];if(M.length>0){var N=M.map(function(E){return E.start});Array.prototype.push.apply(p,N)}else p.push(w.start)}else p.length>0&&(p.push(e[r-1].end),c.push(p),p=[])}return p.length>0&&(p.push(this.end),c.push(p)),c},toPolylines:function(t){var e=[],n=this.toPoints(t);if(!n)return null;for(var o=0,l=n.length;o<l;o++)e.push(new as(n[o]));return e},toString:function(){for(var t=this.segments,e=t.length,n="",o=0;o<e;o++){var l=t[o];n+=l.serialize()+" "}return n.trim()},translate:function(t,e){for(var n=this.segments,o=n.length,l=0;l<o;l++){var c=n[l];c.translate(t,e)}return this},updateSubpathStartSegment:function(t){for(var e=t.previousSegment;t&&!t.isSubpathStart;)e?t.subpathStartSegment=e.subpathStartSegment:t.subpathStartSegment=null,e=t,t=t.nextSegment},validate:function(){return this.isValid()||this.insertSegment(0,zi.createSegment("M",0,0)),this}};Object.defineProperty(zi.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n=0;n<e;n++){var o=t[n];if(o.isVisible)return o.start}return t[e-1].end}});Object.defineProperty(zi.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n=e-1;n>=0;n--){var o=t[n];if(o.isVisible)return o.end}return t[e-1].end}});function Nh(t,e){return e.unshift(null),new(Function.prototype.bind.apply(t,e))}var Fp={bbox:function(){throw new Error("Declaration missing for virtual function.")},clone:function(){throw new Error("Declaration missing for virtual function.")},closestPoint:function(){throw new Error("Declaration missing for virtual function.")},closestPointLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointNormalizedLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointT:function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither closestPointT() nor closestPointNormalizedLength() function is implemented.")},closestPointTangent:function(){throw new Error("Declaration missing for virtual function.")},divideAt:function(){throw new Error("Declaration missing for virtual function.")},divideAtLength:function(){throw new Error("Declaration missing for virtual function.")},divideAtT:function(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither divideAtT() nor divideAt() function is implemented.")},equals:function(){throw new Error("Declaration missing for virtual function.")},getSubdivisions:function(){throw new Error("Declaration missing for virtual function.")},isDifferentiable:function(){throw new Error("Declaration missing for virtual function.")},isSegment:!0,isSubpathStart:!1,isVisible:!0,length:function(){throw new Error("Declaration missing for virtual function.")},lengthAtT:function(t){if(t<=0)return 0;var e=this.length();return t>=1?e:e*t},nextSegment:null,pointAt:function(){throw new Error("Declaration missing for virtual function.")},pointAtLength:function(){throw new Error("Declaration missing for virtual function.")},pointAtT:function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither pointAtT() nor pointAt() function is implemented.")},previousSegment:null,round:function(){throw new Error("Declaration missing for virtual function.")},subpathStartSegment:null,scale:function(){throw new Error("Declaration missing for virtual function.")},serialize:function(){throw new Error("Declaration missing for virtual function.")},tangentAt:function(){throw new Error("Declaration missing for virtual function.")},tangentAtLength:function(){throw new Error("Declaration missing for virtual function.")},tangentAtT:function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither tangentAtT() nor tangentAt() function is implemented.")},toString:function(){throw new Error("Declaration missing for virtual function.")},translate:function(){throw new Error("Declaration missing for virtual function.")}};Object.defineProperty(Fp,"end",{configurable:!0,enumerable:!0,writable:!0});Object.defineProperty(Fp,"start",{configurable:!0,enumerable:!0,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}});Object.defineProperty(Fp,"type",{configurable:!0,enumerable:!0,get:function(){throw new Error("Bad segment declaration. No type specified.")}});var Cl=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof Cl))return Nh(Cl,t);if(e===0)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).");var o;if(t[0]instanceof di){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+e+" lines provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===2)return this.end=new Te(+t[0],+t[1]),this;if(e<2)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+e+" coordinates provided).");var l;for(o=[],n=0;n<e;n+=2)l=t.slice(n,n+2),o.push(Nh(Cl,l));return o}else{if(e===1)return this.end=new Te(t[0]),this;var c;for(o=[],n=0;n<e;n+=1)c=t[n],o.push(new Cl(c));return o}},XL={clone:function(){return new Cl(this.end)},divideAt:function(t){var e=new di(this.start,this.end),n=e.divideAt(t);return[new Cl(n[0]),new Cl(n[1])]},divideAtLength:function(t){var e=new di(this.start,this.end),n=e.divideAtLength(t);return[new Cl(n[0]),new Cl(n[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return this.previousSegment?!this.start.equals(this.end):!1},round:function(t){return this.end.round(t),this},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(XL,"type",{configurable:!0,enumerable:!0,value:"L"});Cl.prototype=sy(Fp,di.prototype,XL);var sc=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof sc))return Nh(sc,t);if(e===0)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).");var o;if(t[0]instanceof Mo){if(e===1)return this.controlPoint1=t[0].controlPoint1.clone(),this.controlPoint2=t[0].controlPoint2.clone(),this.end=t[0].end.clone(),this;throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" curves provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===6)return this.controlPoint1=new Te(+t[0],+t[1]),this.controlPoint2=new Te(+t[2],+t[3]),this.end=new Te(+t[4],+t[5]),this;if(e<6)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" coordinates provided).");var l;for(o=[],n=0;n<e;n+=6)l=t.slice(n,n+6),o.push(Nh(sc,l));return o}else{if(e===3)return this.controlPoint1=new Te(t[0]),this.controlPoint2=new Te(t[1]),this.end=new Te(t[2]),this;if(e<3)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" points provided).");var c;for(o=[],n=0;n<e;n+=3)c=t.slice(n,n+3),o.push(Nh(sc,c));return o}},HL={clone:function(){return new sc(this.controlPoint1,this.controlPoint2,this.end)},divideAt:function(t,e){var n=new Mo(this.start,this.controlPoint1,this.controlPoint2,this.end),o=n.divideAt(t,e);return[new sc(o[0]),new sc(o[1])]},divideAtLength:function(t,e){var n=new Mo(this.start,this.controlPoint1,this.controlPoint2,this.end),o=n.divideAtLength(t,e);return[new sc(o[0]),new sc(o[1])]},divideAtT:function(t){var e=new Mo(this.start,this.controlPoint1,this.controlPoint2,this.end),n=e.divideAtT(t);return[new sc(n[0]),new sc(n[1])]},isDifferentiable:function(){if(!this.previousSegment)return!1;var t=this.start,e=this.controlPoint1,n=this.controlPoint2,o=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(o))},round:function(t){return this.controlPoint1.round(t),this.controlPoint2.round(t),this.end.round(t),this},scale:function(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},serialize:function(){var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return this.type+" "+t.x+" "+t.y+" "+e.x+" "+e.y+" "+n.x+" "+n.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};Object.defineProperty(HL,"type",{configurable:!0,enumerable:!0,value:"C"});sc.prototype=sy(Fp,Mo.prototype,HL);var wp=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof wp))return Nh(wp,t);if(e===0)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).");var o;if(t[0]instanceof di){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" lines provided).")}else if(t[0]instanceof Mo){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" curves provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===2)return this.end=new Te(+t[0],+t[1]),this;if(e<2)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" coordinates provided).");var l;for(o=[],n=0;n<e;n+=2)l=t.slice(n,n+2),n===0?o.push(Nh(wp,l)):o.push(Nh(Cl,l));return o}else{if(e===1)return this.end=new Te(t[0]),this;var c;for(o=[],n=0;n<e;n+=1)c=t[n],n===0?o.push(new wp(c)):o.push(new Cl(c));return o}},aA={bbox:function(){return null},clone:function(){return new wp(this.end)},closestPoint:function(){return this.end.clone()},closestPointNormalizedLength:function(){return 0},closestPointLength:function(){return 0},closestPointT:function(){return 1},closestPointTangent:function(){return null},divideAt:function(){return[this.clone(),this.clone()]},divideAtLength:function(){return[this.clone(),this.clone()]},equals:function(t){return this.end.equals(t.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){return!1},isSubpathStart:!0,isVisible:!1,length:function(){return 0},lengthAtT:function(){return 0},pointAt:function(){return this.end.clone()},pointAtLength:function(){return this.end.clone()},pointAtT:function(){return this.end.clone()},round:function(t){return this.end.round(t),this},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},tangentAt:function(){return null},tangentAtLength:function(){return null},tangentAtT:function(){return null},toString:function(){return this.type+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(aA,"start",{configurable:!0,enumerable:!0,get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}});Object.defineProperty(aA,"type",{configurable:!0,enumerable:!0,value:"M"});wp.prototype=sy(Fp,aA);var Tg=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof Tg))return Nh(Tg,t);if(e>0)throw new Error("Closepath constructor expects no arguments.");return this},lA={clone:function(){return new Tg},divideAt:function(t){var e=new di(this.start,this.end),n=e.divideAt(t);return[n[1].isDifferentiable()?new Cl(n[0]):this.clone(),new Cl(n[1])]},divideAtLength:function(t){var e=new di(this.start,this.end),n=e.divideAtLength(t);return[n[1].isDifferentiable()?new Cl(n[0]):this.clone(),new Cl(n[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!this.previousSegment||!this.subpathStartSegment?!1:!this.start.equals(this.end)},round:function(){return this},scale:function(){return this},serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(){return this}};Object.defineProperty(lA,"end",{configurable:!0,enumerable:!0,get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)");return this.subpathStartSegment.end}});Object.defineProperty(lA,"type",{configurable:!0,enumerable:!0,value:"Z"});Tg.prototype=sy(Fp,di.prototype,lA);var sO=zi.segmentTypes={L:Cl,C:sc,M:wp,Z:Tg,z:Tg};zi.regexSupportedData=new RegExp("^[\\s\\d"+Object.keys(sO).join("")+",.]*$");zi.isDataSupported=function(t){return typeof t!="string"?!1:this.regexSupportedData.test(t)};const aO={curveThroughPoints:function(t){return console.warn("deprecated"),new zi(Mo.throughPoints(t)).serialize()},getCurveControlPoints:function(t){console.warn("deprecated");var e=[],n=[],o=t.length-1,l;if(o==1)return e[0]=new Te((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),n[0]=new Te(2*e[0].x-t[0].x,2*e[0].y-t[0].y),[e,n];var c=[];for(l=1;l<o-1;l++)c[l]=4*t[l].x+2*t[l+1].x;c[0]=t[0].x+2*t[1].x,c[o-1]=(8*t[o-1].x+t[o].x)/2;var p=this.getFirstControlPoints(c);for(l=1;l<o-1;++l)c[l]=4*t[l].y+2*t[l+1].y;c[0]=t[0].y+2*t[1].y,c[o-1]=(8*t[o-1].y+t[o].y)/2;var r=this.getFirstControlPoints(c);for(l=0;l<o;l++)e.push(new Te(p[l],r[l])),l<o-1?n.push(new Te(2*t[l+1].x-p[l+1],2*t[l+1].y-r[l+1])):n.push(new Te((t[o].x+p[o-1])/2,(t[o].y+r[o-1])/2));return[e,n]},getCurveDivider:function(t,e,n,o){console.warn("deprecated");var l=new Mo(t,e,n,o);return function(p){var r=l.divide(p);return[{p0:r[0].start,p1:r[0].controlPoint1,p2:r[0].controlPoint2,p3:r[0].end},{p0:r[1].start,p1:r[1].controlPoint1,p2:r[1].controlPoint2,p3:r[1].end}]}},getFirstControlPoints:function(t){console.warn("deprecated");var e=t.length,n=[],o=[],l=2;n[0]=t[0]/l;for(var c=1;c<e;c++)o[c]=1/l,l=(c<e-1?4:3.5)-o[c],n[c]=(t[c]-n[c-1])/l;for(c=1;c<e;c++)n[e-c-1]-=o[e-c]*n[e-c];return n},getInversionSolver:function(t,e,n,o){console.warn("deprecated");var l=new Mo(t,e,n,o);return function(p){return l.closestPointT(p)}}},Uu=function(t){if(!(this instanceof Uu))return new Uu(t);if(typeof t=="string")return new Uu.parse(t);this.points=Array.isArray(t)?t.map(Te):[]};Uu.parse=function(t){return new Uu(VL(t))};Uu.fromRect=function(t){return new Uu([t.topLeft(),t.topRight(),t.bottomRight(),t.bottomLeft()])};Uu.prototype=sy(as.prototype,{type:Er.Polygon,clone:function(){return new Uu(WL(this.points))},convexHull:function(){return new Uu(YL(this.points))},lengthPoints:function(){const{start:t,end:e,points:n}=this;return n.length<=1||t.equals(e)?n:[...n,t.clone()]}});function $L(t,e,n,o){switch(t.type){case Er.Line:{switch(e.type){case Er.Line:return bp(t,e)}break}case Er.Ellipse:{switch(e.type){case Er.Line:return uA(t,e);case Er.Ellipse:return qL(t,e)}break}case Er.Rect:{switch(e.type){case Er.Line:return JL(t,e);case Er.Ellipse:return KL(t,e);case Er.Rect:return cA(t,e)}break}case Er.Polyline:{switch(e.type){case Er.Line:return Jx(t,e);case Er.Ellipse:return hA(t,e);case Er.Rect:return QL(t,e);case Er.Polyline:return tk(t,e)}break}case Er.Polygon:{switch(e.type){case Er.Line:return fA(t,e);case Er.Ellipse:return Kx(t,e);case Er.Rect:return ek(t,e);case Er.Polyline:return nk(t,e);case Er.Polygon:return ik(t,e)}break}case Er.Path:{switch(e.type){case Er.Line:return rk(t,e,n);case Er.Ellipse:return ok(t,e,n);case Er.Rect:return sk(t,e,n);case Er.Polyline:return dA(t,e,n);case Er.Polygon:return Qx(t,e,n);case Er.Path:return ak(t,e,n,o)}break}}switch(e.type){case Er.Ellipse:case Er.Rect:case Er.Polyline:case Er.Polygon:case Er.Path:return $L(e,t,o,n);default:throw Error(`The intersection for ${t} and ${e} could not be found.`)}}function bp(t,e){const n=t.start.x,o=t.start.y,l=t.end.x,c=t.end.y,p=e.start.x,r=e.start.y,w=e.end.x,M=e.end.y,N=l-n,E=c-o,Z=w-p,Y=M-r,K=n-p,q=o-r,at=N*Y-Z*E,J=(N*q-E*K)/at,Q=(Z*q-Y*K)/at;return J>=0&&J<=1&&Q>=0&&Q<=1}function uA(t,e){const n=t.a,o=t.b,l=t.x,c=t.y,p=e.start.x-l,r=e.end.x-l,w=e.start.y-c,M=e.end.y-c,N=n*n,E=o*o,Z=r-p,Y=M-w,K=Z*Z/N+Y*Y/E,q=2*p*Z/N+2*w*Y/E,at=p*p/N+w*w/E-1,J=q*q-4*K*at;if(J===0){const Q=-q/2/K;return Q>=0&&Q<=1}else if(J>0){const Q=Math.sqrt(J),lt=(-q+Q)/2/K,Ct=(-q-Q)/2/K;return lt>=0&&lt<=1||Ct>=0&&Ct<=1}return!1}function qL(t,e){return lO(t,0,e,0)}function JL(t,e){const{start:n,end:o}=e,{x:l,y:c,width:p,height:r}=t;return n.x>l+p&&o.x>l+p||n.x<l&&o.x<l||n.y>c+r&&o.y>c+r||n.y<c&&o.y<c?!1:t.containsPoint(e.start)||t.containsPoint(e.end)?!0:bp(t.topLine(),e)||bp(t.rightLine(),e)||bp(t.bottomLine(),e)||bp(t.leftLine(),e)}function KL(t,e){return cA(t,ai.fromEllipse(e))?Kx(Uu.fromRect(t),e):!1}function cA(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function Jx(t,e){return lk(t,e,{interior:!1})}function hA(t,e){return uk(t,e,{interior:!1})}function QL(t,e){return ck(t,e,{interior:!1})}function tk(t,e){return tw(t,e,{interior:!1})}function fA(t,e){return lk(t,e,{interior:!0})}function Kx(t,e){return uk(t,e,{interior:!0})}function ek(t,e){return ck(t,e,{interior:!0})}function nk(t,e){return tw(t,e,{interior:!0})}function ik(t,e){return pA(t,e,{interior:!0})}function rk(t,e,n){return t.getSubpaths().some(o=>{const[l]=o.toPolylines(n),{type:c}=o.getSegment(-1);return c==="Z"?fA(l,e):Jx(l,e)})}function ok(t,e,n){return t.getSubpaths().some(o=>{const[l]=o.toPolylines(n),{type:c}=o.getSegment(-1);return c==="Z"?Kx(l,e):hA(l,e)})}function sk(t,e,n){return Qx(t,Uu.fromRect(e),n)}function dA(t,e,n){return hk(t,e,n,{interior:!1})}function Qx(t,e,n){return hk(t,e,n,{interior:!0})}function ak(t,e,n,o){return t.getSubpaths().some(l=>{const[c]=l.toPolylines(n),{type:p}=l.getSegment(-1);return p==="Z"?Qx(e,c,o):dA(e,c,o)})}function lk(t,e,n={}){const{interior:o=!1}=n;let l;if(o){if(t.containsPoint(e.start))return!0;const{start:r,end:w,points:M}=t;l=w.equals(r)?M:[...M,r]}else l=t.points;const{length:c}=l,p=new di;for(let r=0;r<c-1;r++)if(p.start=l[r],p.end=l[r+1],bp(e,p))return!0;return!1}function uk(t,e,n={}){const{start:o,end:l,points:c}=t;if(e.containsPoint(o))return!0;let p;const{interior:r=!1}=n;if(r){if(t.containsPoint(e.center()))return!0;p=l.equals(o)?c:[...c,o]}else p=c;const{length:w}=p,M=new di;for(let N=0;N<w-1;N++)if(M.start=p[N],M.end=p[N+1],uA(e,M))return!0;return!1}function ck(t,e,n){const o=Uu.fromRect(e);return pA(t,o,n)}function hk(t,e,n,o){return t.getSubpaths().some(l=>{const[c]=l.toPolylines(n),{type:p}=l.getSegment(-1);return p==="Z"?pA(e,c,o):tw(e,c,o)})}function tw(t,e,n={}){const{interior:o=!1}=n;let l;if(o){const{start:w}=e;if(t.containsPoint(w))return!0;l=t.clone().close()}else l=t;const c=e.points,{length:p}=c,r=new di;for(let w=0;w<p-1;w++)if(r.start=c[w],r.end=c[w+1],Jx(l,r))return!0;return!1}function pA(t,e,n){return e.containsPoint(t.start)||tw(t,e.clone().close(),n)}function lO(t,e,n,o){const{cos:l,sin:c}=Math,p=c(e),r=l(e),w=c(o),M=l(o),N=p*p,E=r*r,Z=p*r,Y=w*w,K=M*M,q=w*M,at=t.a*t.a,J=t.b*t.b,Q=n.a*n.a,lt=n.b*n.b,Ct=at*N+J*E,j=Q*Y+lt*K,k=at*E+J*N,rt=Q*K+lt*Y;let yt=2*(J-at)*Z,xt=2*(lt-Q)*q,kt=-2*Ct*t.x-yt*t.y,de=-2*j*n.x-xt*n.y,Et=-yt*t.x-2*k*t.y,te=-xt*n.x-2*rt*n.y;const ht=Ct*t.x*t.x+k*t.y*t.y+yt*t.x*t.y-at*J,ie=j*n.x*n.x+rt*n.y*n.y+xt*n.x*n.y-Q*lt;yt=yt/2,xt=xt/2,kt=kt/2,de=de/2,Et=Et/2,te=te/2;const ln=td([[Ct,yt,kt],[yt,k,Et],[kt,Et,ht]]),Le=td([[j,xt,de],[xt,rt,te],[de,te,ie]]),_e=.33333333*(td([[j,yt,kt],[xt,k,Et],[de,Et,ht]])+td([[Ct,xt,kt],[yt,rt,Et],[kt,te,ht]])+td([[Ct,yt,de],[yt,k,te],[kt,Et,ie]])),Me=.33333333*(td([[Ct,xt,de],[yt,rt,te],[kt,te,ie]])+td([[j,yt,de],[xt,k,te],[de,Et,ie]])+td([[j,xt,kt],[xt,rt,Et],[de,te,ht]])),be=n1([[ln,_e],[_e,Me]]),ue=n1([[ln,Me],[_e,Le]]),Yt=n1([[_e,Me],[Me,Le]]);return!(n1([[2*be,ue],[ue,2*Yt]])>0&&(Me>0||_e>0))}function n1(t){return t[0][0]*t[1][1]-t[0][1]*t[1][0]}function td(t){return t[0][0]*t[1][1]*t[2][2]-t[0][0]*t[1][2]*t[2][1]-t[0][1]*t[1][0]*t[2][2]+t[0][1]*t[1][2]*t[2][0]+t[0][2]*t[1][0]*t[2][1]-t[0][2]*t[1][1]*t[2][0]}const uO=Object.freeze(Object.defineProperty({__proto__:null,ellipseWithEllipse:qL,ellipseWithLine:uA,exists:$L,lineWithLine:bp,pathWithEllipse:ok,pathWithLine:rk,pathWithPath:ak,pathWithPolygon:Qx,pathWithPolyline:dA,pathWithRect:sk,polygonWithEllipse:Kx,polygonWithLine:fA,polygonWithPolygon:ik,polygonWithPolyline:nk,polygonWithRect:ek,polylineWithEllipse:hA,polylineWithLine:Jx,polylineWithPolyline:tk,polylineWithRect:QL,rectWithEllipse:KL,rectWithLine:JL,rectWithRect:cA},Symbol.toStringTag,{value:"Module"})),cO=uO,hO=Object.freeze(Object.defineProperty({__proto__:null,Curve:Mo,Ellipse:pu,Line:di,Path:zi,Point:Te,Polygon:Uu,Polyline:as,Rect:ai,bezier:aO,ellipse:tO,intersection:cO,line:Ap,normalizeAngle:Rh,point:ix,random:UC,rect:rO,scale:$N,snapToGrid:zp,toDeg:qx,toRad:ju,types:Er},Symbol.toStringTag,{value:"Module"}));var fk={},rx={},fO={get exports(){return rx},set exports(t){rx=t}},CS;function dO(){return CS||(CS=1,function(t,e){(function(n,o){t.exports=o()})(fa,function(){var n="1.13.6",o=typeof self=="object"&&self.self===self&&self||typeof fa=="object"&&fa.global===fa&&fa||Function("return this")()||{},l=Array.prototype,c=Object.prototype,p=typeof Symbol<"u"?Symbol.prototype:null,r=l.push,w=l.slice,M=c.toString,N=c.hasOwnProperty,E=typeof ArrayBuffer<"u",Z=typeof DataView<"u",Y=Array.isArray,K=Object.keys,q=Object.create,at=E&&ArrayBuffer.isView,J=isNaN,Q=isFinite,lt=!{toString:null}.propertyIsEnumerable("toString"),Ct=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],j=Math.pow(2,53)-1;function k(vt,Lt){return Lt=Lt==null?vt.length-1:+Lt,function(){for(var $t=Math.max(arguments.length-Lt,0),oe=Array($t),C=0;C<$t;C++)oe[C]=arguments[C+Lt];switch(Lt){case 0:return vt.call(this,oe);case 1:return vt.call(this,arguments[0],oe);case 2:return vt.call(this,arguments[0],arguments[1],oe)}var z=Array(Lt+1);for(C=0;C<Lt;C++)z[C]=arguments[C];return z[Lt]=oe,vt.apply(this,z)}}function rt(vt){var Lt=typeof vt;return Lt==="function"||Lt==="object"&&!!vt}function yt(vt){return vt===void 0}function xt(vt){return vt===!0||vt===!1||M.call(vt)==="[object Boolean]"}function kt(vt){var Lt="[object "+vt+"]";return function($t){return M.call($t)===Lt}}var de=kt("String"),Et=kt("Number"),te=kt("Date"),ht=kt("RegExp"),ie=kt("Error"),ln=kt("Symbol"),Le=kt("ArrayBuffer"),_e=kt("Function"),Me=o.document&&o.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof Me!="function"&&(_e=function(vt){return typeof vt=="function"||!1});var be=_e,ue=kt("Object"),Yt=Z&&ue(new DataView(new ArrayBuffer(8))),Ee=typeof Map<"u"&&ue(new Map),ve=kt("DataView"),ye=Yt?function(vt){return vt!=null&&be(vt.getInt8)&&Le(vt.buffer)}:ve,fe=Y||kt("Array");function mn(vt,Lt){return vt!=null&&N.call(vt,Lt)}var Ue=kt("Arguments");(function(){Ue(arguments)||(Ue=function(vt){return mn(vt,"callee")})})();var Cn=Ue;function Bn(vt){return Et(vt)&&J(vt)}function Pn(vt){return function(){return vt}}function cn(vt){return function(Lt){var $t=vt(Lt);return typeof $t=="number"&&$t>=0&&$t<=j}}function Un(vt){return function(Lt){return Lt==null?void 0:Lt[vt]}}var R=Un("byteLength"),st=cn(R),gt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/,dt=E?function(vt){return at?at(vt)&&!ye(vt):st(vt)&&gt.test(M.call(vt))}:Pn(!1),wt=Un("length");function Zt(vt,Lt){Lt=function(U){for(var X={},ft=U.length,mt=0;mt<ft;++mt)X[U[mt]]=!0;return{contains:function(Tt){return X[Tt]===!0},push:function(Tt){return X[Tt]=!0,U.push(Tt)}}}(Lt);var $t=Ct.length,oe=vt.constructor,C=be(oe)&&oe.prototype||c,z="constructor";for(mn(vt,z)&&!Lt.contains(z)&&Lt.push(z);$t--;)(z=Ct[$t])in vt&&vt[z]!==C[z]&&!Lt.contains(z)&&Lt.push(z)}function we(vt){if(!rt(vt))return[];if(K)return K(vt);var Lt=[];for(var $t in vt)mn(vt,$t)&&Lt.push($t);return lt&&Zt(vt,Lt),Lt}function We(vt,Lt){var $t=we(Lt),oe=$t.length;if(vt==null)return!oe;for(var C=Object(vt),z=0;z<oe;z++){var U=$t[z];if(Lt[U]!==C[U]||!(U in C))return!1}return!0}function pe(vt){return vt instanceof pe?vt:this instanceof pe?void(this._wrapped=vt):new pe(vt)}function un(vt){return new Uint8Array(vt.buffer||vt,vt.byteOffset||0,R(vt))}pe.VERSION=n,pe.prototype.value=function(){return this._wrapped},pe.prototype.valueOf=pe.prototype.toJSON=pe.prototype.value,pe.prototype.toString=function(){return String(this._wrapped)};var Ye="[object DataView]";function Ge(vt,Lt,$t,oe){if(vt===Lt)return vt!==0||1/vt==1/Lt;if(vt==null||Lt==null)return!1;if(vt!=vt)return Lt!=Lt;var C=typeof vt;return(C==="function"||C==="object"||typeof Lt=="object")&&function z(U,X,ft,mt){U instanceof pe&&(U=U._wrapped),X instanceof pe&&(X=X._wrapped);var Tt=M.call(U);if(Tt!==M.call(X))return!1;if(Yt&&Tt=="[object Object]"&&ye(U)){if(!ye(X))return!1;Tt=Ye}switch(Tt){case"[object RegExp]":case"[object String]":return""+U==""+X;case"[object Number]":return+U!=+U?+X!=+X:+U==0?1/+U==1/X:+U==+X;case"[object Date]":case"[object Boolean]":return+U==+X;case"[object Symbol]":return p.valueOf.call(U)===p.valueOf.call(X);case"[object ArrayBuffer]":case Ye:return z(un(U),un(X),ft,mt)}var ce=Tt==="[object Array]";if(!ce&&dt(U)){if(R(U)!==R(X))return!1;if(U.buffer===X.buffer&&U.byteOffset===X.byteOffset)return!0;ce=!0}if(!ce){if(typeof U!="object"||typeof X!="object")return!1;var ee=U.constructor,Oe=X.constructor;if(ee!==Oe&&!(be(ee)&&ee instanceof ee&&be(Oe)&&Oe instanceof Oe)&&"constructor"in U&&"constructor"in X)return!1}mt=mt||[];for(var Qe=(ft=ft||[]).length;Qe--;)if(ft[Qe]===U)return mt[Qe]===X;if(ft.push(U),mt.push(X),ce){if((Qe=U.length)!==X.length)return!1;for(;Qe--;)if(!Ge(U[Qe],X[Qe],ft,mt))return!1}else{var pn,qe=we(U);if(Qe=qe.length,we(X).length!==Qe)return!1;for(;Qe--;)if(pn=qe[Qe],!mn(X,pn)||!Ge(U[pn],X[pn],ft,mt))return!1}return ft.pop(),mt.pop(),!0}(vt,Lt,$t,oe)}function Gn(vt){if(!rt(vt))return[];var Lt=[];for(var $t in vt)Lt.push($t);return lt&&Zt(vt,Lt),Lt}function _i(vt){var Lt=wt(vt);return function($t){if($t==null)return!1;var oe=Gn($t);if(wt(oe))return!1;for(var C=0;C<Lt;C++)if(!be($t[vt[C]]))return!1;return vt!==$i||!be($t[ui])}}var ui="forEach",ji="has",Hi=["clear","delete"],vr=["get",ji,"set"],Jr=Hi.concat(ui,vr),$i=Hi.concat(vr),uo=["add"].concat(Hi,ui,ji),Go=Ee?_i(Jr):kt("Map"),Ir=Ee?_i($i):kt("WeakMap"),Ar=Ee?_i(uo):kt("Set"),Ro=kt("WeakSet");function Qo(vt){for(var Lt=we(vt),$t=Lt.length,oe=Array($t),C=0;C<$t;C++)oe[C]=vt[Lt[C]];return oe}function _s(vt){for(var Lt={},$t=we(vt),oe=0,C=$t.length;oe<C;oe++)Lt[vt[$t[oe]]]=$t[oe];return Lt}function bo(vt){var Lt=[];for(var $t in vt)be(vt[$t])&&Lt.push($t);return Lt.sort()}function co(vt,Lt){return function($t){var oe=arguments.length;if(Lt&&($t=Object($t)),oe<2||$t==null)return $t;for(var C=1;C<oe;C++)for(var z=arguments[C],U=vt(z),X=U.length,ft=0;ft<X;ft++){var mt=U[ft];Lt&&$t[mt]!==void 0||($t[mt]=z[mt])}return $t}}var io=co(Gn),Ta=co(we),Wa=co(Gn,!0);function Sa(vt){if(!rt(vt))return{};if(q)return q(vt);var Lt=function(){};Lt.prototype=vt;var $t=new Lt;return Lt.prototype=null,$t}function ts(vt){return fe(vt)?vt:[vt]}function js(vt){return pe.toPath(vt)}function Ea(vt,Lt){for(var $t=Lt.length,oe=0;oe<$t;oe++){if(vt==null)return;vt=vt[Lt[oe]]}return $t?vt:void 0}function Vt(vt,Lt,$t){var oe=Ea(vt,js(Lt));return yt(oe)?$t:oe}function pt(vt){return vt}function It(vt){return vt=Ta({},vt),function(Lt){return We(Lt,vt)}}function Ut(vt){return vt=js(vt),function(Lt){return Ea(Lt,vt)}}function qt(vt,Lt,$t){if(Lt===void 0)return vt;switch($t??3){case 1:return function(oe){return vt.call(Lt,oe)};case 3:return function(oe,C,z){return vt.call(Lt,oe,C,z)};case 4:return function(oe,C,z,U){return vt.call(Lt,oe,C,z,U)}}return function(){return vt.apply(Lt,arguments)}}function Ht(vt,Lt,$t){return vt==null?pt:be(vt)?qt(vt,Lt,$t):rt(vt)&&!fe(vt)?It(vt):Ut(vt)}function Pe(vt,Lt){return Ht(vt,Lt,1/0)}function Se(vt,Lt,$t){return pe.iteratee!==Pe?pe.iteratee(vt,Lt):Ht(vt,Lt,$t)}function xe(){}function Re(vt,Lt){return Lt==null&&(Lt=vt,vt=0),vt+Math.floor(Math.random()*(Lt-vt+1))}pe.toPath=ts,pe.iteratee=Pe;var hn=Date.now||function(){return new Date().getTime()};function Zn(vt){var Lt=function(z){return vt[z]},$t="(?:"+we(vt).join("|")+")",oe=RegExp($t),C=RegExp($t,"g");return function(z){return z=z==null?"":""+z,oe.test(z)?z.replace(C,Lt):z}}var bn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ci=Zn(bn),hi=Zn(_s(bn)),Qn=pe.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},pi=/(.)^/,qi={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ur=/\\|'|\r|\n|\u2028|\u2029/g;function ti(vt){return"\\"+qi[vt]}var yr=/^\s*(\w|\$)+\s*$/,xr=0;function Js(vt,Lt,$t,oe,C){if(!(oe instanceof Lt))return vt.apply($t,C);var z=Sa(vt.prototype),U=vt.apply(z,C);return rt(U)?U:z}var Ss=k(function(vt,Lt){var $t=Ss.placeholder,oe=function(){for(var C=0,z=Lt.length,U=Array(z),X=0;X<z;X++)U[X]=Lt[X]===$t?arguments[C++]:Lt[X];for(;C<arguments.length;)U.push(arguments[C++]);return Js(vt,oe,this,this,U)};return oe});Ss.placeholder=pe;var vs=k(function(vt,Lt,$t){if(!be(vt))throw new TypeError("Bind must be called on a function");var oe=k(function(C){return Js(vt,oe,Lt,this,$t.concat(C))});return oe}),Ke=cn(wt);function Po(vt,Lt,$t,oe){if(oe=oe||[],Lt||Lt===0){if(Lt<=0)return oe.concat(vt)}else Lt=1/0;for(var C=oe.length,z=0,U=wt(vt);z<U;z++){var X=vt[z];if(Ke(X)&&(fe(X)||Cn(X)))if(Lt>1)Po(X,Lt-1,$t,oe),C=oe.length;else for(var ft=0,mt=X.length;ft<mt;)oe[C++]=X[ft++];else $t||(oe[C++]=X)}return oe}var Xr=k(function(vt,Lt){var $t=(Lt=Po(Lt,!1,!1)).length;if($t<1)throw new Error("bindAll must be passed function names");for(;$t--;){var oe=Lt[$t];vt[oe]=vs(vt[oe],vt)}return vt}),ro=k(function(vt,Lt,$t){return setTimeout(function(){return vt.apply(null,$t)},Lt)}),hl=Ss(ro,pe,1);function Io(vt){return function(){return!vt.apply(this,arguments)}}function cr(vt,Lt){var $t;return function(){return--vt>0&&($t=Lt.apply(this,arguments)),vt<=1&&(Lt=null),$t}}var Kr=Ss(cr,2);function Co(vt,Lt,$t){Lt=Se(Lt,$t);for(var oe,C=we(vt),z=0,U=C.length;z<U;z++)if(Lt(vt[oe=C[z]],oe,vt))return oe}function jn(vt){return function(Lt,$t,oe){$t=Se($t,oe);for(var C=wt(Lt),z=vt>0?0:C-1;z>=0&&z<C;z+=vt)if($t(Lt[z],z,Lt))return z;return-1}}var Ti=jn(1),Oi=jn(-1);function Si(vt,Lt,$t,oe){for(var C=($t=Se($t,oe,1))(Lt),z=0,U=wt(vt);z<U;){var X=Math.floor((z+U)/2);$t(vt[X])<C?z=X+1:U=X}return z}function Tr(vt,Lt,$t){return function(oe,C,z){var U=0,X=wt(oe);if(typeof z=="number")vt>0?U=z>=0?z:Math.max(z+X,U):X=z>=0?Math.min(z+1,X):z+X+1;else if($t&&z&&X)return oe[z=$t(oe,C)]===C?z:-1;if(C!=C)return(z=Lt(w.call(oe,U,X),Bn))>=0?z+U:-1;for(z=vt>0?U:X-1;z>=0&&z<X;z+=vt)if(oe[z]===C)return z;return-1}}var vi=Tr(1,Ti,Si),Ma=Tr(-1,Oi);function oo(vt,Lt,$t){var oe=(Ke(vt)?Ti:Co)(vt,Lt,$t);if(oe!==void 0&&oe!==-1)return vt[oe]}function Yo(vt,Lt,$t){var oe,C;if(Lt=qt(Lt,$t),Ke(vt))for(oe=0,C=vt.length;oe<C;oe++)Lt(vt[oe],oe,vt);else{var z=we(vt);for(oe=0,C=z.length;oe<C;oe++)Lt(vt[z[oe]],z[oe],vt)}return vt}function Nr(vt,Lt,$t){Lt=Se(Lt,$t);for(var oe=!Ke(vt)&&we(vt),C=(oe||vt).length,z=Array(C),U=0;U<C;U++){var X=oe?oe[U]:U;z[U]=Lt(vt[X],X,vt)}return z}function nr(vt){var Lt=function($t,oe,C,z){var U=!Ke($t)&&we($t),X=(U||$t).length,ft=vt>0?0:X-1;for(z||(C=$t[U?U[ft]:ft],ft+=vt);ft>=0&&ft<X;ft+=vt){var mt=U?U[ft]:ft;C=oe(C,$t[mt],mt,$t)}return C};return function($t,oe,C,z){var U=arguments.length>=3;return Lt($t,qt(oe,z,4),C,U)}}var ir=nr(1),es=nr(-1);function ns(vt,Lt,$t){var oe=[];return Lt=Se(Lt,$t),Yo(vt,function(C,z,U){Lt(C,z,U)&&oe.push(C)}),oe}function is(vt,Lt,$t){Lt=Se(Lt,$t);for(var oe=!Ke(vt)&&we(vt),C=(oe||vt).length,z=0;z<C;z++){var U=oe?oe[z]:z;if(!Lt(vt[U],U,vt))return!1}return!0}function da(vt,Lt,$t){Lt=Se(Lt,$t);for(var oe=!Ke(vt)&&we(vt),C=(oe||vt).length,z=0;z<C;z++){var U=oe?oe[z]:z;if(Lt(vt[U],U,vt))return!0}return!1}function zo(vt,Lt,$t,oe){return Ke(vt)||(vt=Qo(vt)),(typeof $t!="number"||oe)&&($t=0),vi(vt,Lt,$t)>=0}var Ks=k(function(vt,Lt,$t){var oe,C;return be(Lt)?C=Lt:(Lt=js(Lt),oe=Lt.slice(0,-1),Lt=Lt[Lt.length-1]),Nr(vt,function(z){var U=C;if(!U){if(oe&&oe.length&&(z=Ea(z,oe)),z==null)return;U=z[Lt]}return U==null?U:U.apply(z,$t)})});function Us(vt,Lt){return Nr(vt,Ut(Lt))}function La(vt,Lt,$t){var oe,C,z=-1/0,U=-1/0;if(Lt==null||typeof Lt=="number"&&typeof vt[0]!="object"&&vt!=null)for(var X=0,ft=(vt=Ke(vt)?vt:Qo(vt)).length;X<ft;X++)(oe=vt[X])!=null&&oe>z&&(z=oe);else Lt=Se(Lt,$t),Yo(vt,function(mt,Tt,ce){((C=Lt(mt,Tt,ce))>U||C===-1/0&&z===-1/0)&&(z=mt,U=C)});return z}var fl=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Zo(vt){return vt?fe(vt)?w.call(vt):de(vt)?vt.match(fl):Ke(vt)?Nr(vt,pt):Qo(vt):[]}function Zr(vt,Lt,$t){if(Lt==null||$t)return Ke(vt)||(vt=Qo(vt)),vt[Re(vt.length-1)];var oe=Zo(vt),C=wt(oe);Lt=Math.max(Math.min(Lt,C),0);for(var z=C-1,U=0;U<Lt;U++){var X=Re(U,z),ft=oe[U];oe[U]=oe[X],oe[X]=ft}return oe.slice(0,Lt)}function Qs(vt,Lt){return function($t,oe,C){var z=Lt?[[],[]]:{};return oe=Se(oe,C),Yo($t,function(U,X){var ft=oe(U,X,$t);vt(z,U,ft)}),z}}var Hl=Qs(function(vt,Lt,$t){mn(vt,$t)?vt[$t].push(Lt):vt[$t]=[Lt]}),Vo=Qs(function(vt,Lt,$t){vt[$t]=Lt}),wi=Qs(function(vt,Lt,$t){mn(vt,$t)?vt[$t]++:vt[$t]=1}),ta=Qs(function(vt,Lt,$t){vt[$t?0:1].push(Lt)},!0);function zr(vt,Lt,$t){return Lt in $t}var Ao=k(function(vt,Lt){var $t={},oe=Lt[0];if(vt==null)return $t;be(oe)?(Lt.length>1&&(oe=qt(oe,Lt[1])),Lt=Gn(vt)):(oe=zr,Lt=Po(Lt,!1,!1),vt=Object(vt));for(var C=0,z=Lt.length;C<z;C++){var U=Lt[C],X=vt[U];oe(X,U,vt)&&($t[U]=X)}return $t}),ka=k(function(vt,Lt){var $t,oe=Lt[0];return be(oe)?(oe=Io(oe),Lt.length>1&&($t=Lt[1])):(Lt=Nr(Po(Lt,!1,!1),String),oe=function(C,z){return!zo(Lt,z)}),Ao(vt,oe,$t)});function dl(vt,Lt,$t){return w.call(vt,0,Math.max(0,vt.length-(Lt==null||$t?1:Lt)))}function ea(vt,Lt,$t){return vt==null||vt.length<1?Lt==null||$t?void 0:[]:Lt==null||$t?vt[0]:dl(vt,vt.length-Lt)}function Or(vt,Lt,$t){return w.call(vt,Lt==null||$t?1:Lt)}var na=k(function(vt,Lt){return Lt=Po(Lt,!0,!0),ns(vt,function($t){return!zo(Lt,$t)})}),Ya=k(function(vt,Lt){return na(vt,Lt)});function Ei(vt,Lt,$t,oe){xt(Lt)||(oe=$t,$t=Lt,Lt=!1),$t!=null&&($t=Se($t,oe));for(var C=[],z=[],U=0,X=wt(vt);U<X;U++){var ft=vt[U],mt=$t?$t(ft,U,vt):ft;Lt&&!$t?(U&&z===mt||C.push(ft),z=mt):$t?zo(z,mt)||(z.push(mt),C.push(ft)):zo(C,ft)||C.push(ft)}return C}var rr=k(function(vt){return Ei(Po(vt,!0,!0))});function pl(vt){for(var Lt=vt&&La(vt,wt).length||0,$t=Array(Lt),oe=0;oe<Lt;oe++)$t[oe]=Us(vt,oe);return $t}var pc=k(pl);function $l(vt,Lt){return vt._chain?pe(Lt).chain():Lt}function Es(vt){return Yo(bo(vt),function(Lt){var $t=pe[Lt]=vt[Lt];pe.prototype[Lt]=function(){var oe=[this._wrapped];return r.apply(oe,arguments),$l(this,$t.apply(pe,oe))}}),pe}Yo(["pop","push","reverse","shift","sort","splice","unshift"],function(vt){var Lt=l[vt];pe.prototype[vt]=function(){var $t=this._wrapped;return $t!=null&&(Lt.apply($t,arguments),vt!=="shift"&&vt!=="splice"||$t.length!==0||delete $t[0]),$l(this,$t)}}),Yo(["concat","join","slice"],function(vt){var Lt=l[vt];pe.prototype[vt]=function(){var $t=this._wrapped;return $t!=null&&($t=Lt.apply($t,arguments)),$l(this,$t)}});var Pa=Es({__proto__:null,VERSION:n,restArguments:k,isObject:rt,isNull:function(vt){return vt===null},isUndefined:yt,isBoolean:xt,isElement:function(vt){return!(!vt||vt.nodeType!==1)},isString:de,isNumber:Et,isDate:te,isRegExp:ht,isError:ie,isSymbol:ln,isArrayBuffer:Le,isDataView:ye,isArray:fe,isFunction:be,isArguments:Cn,isFinite:function(vt){return!ln(vt)&&Q(vt)&&!isNaN(parseFloat(vt))},isNaN:Bn,isTypedArray:dt,isEmpty:function(vt){if(vt==null)return!0;var Lt=wt(vt);return typeof Lt=="number"&&(fe(vt)||de(vt)||Cn(vt))?Lt===0:wt(we(vt))===0},isMatch:We,isEqual:function(vt,Lt){return Ge(vt,Lt)},isMap:Go,isWeakMap:Ir,isSet:Ar,isWeakSet:Ro,keys:we,allKeys:Gn,values:Qo,pairs:function(vt){for(var Lt=we(vt),$t=Lt.length,oe=Array($t),C=0;C<$t;C++)oe[C]=[Lt[C],vt[Lt[C]]];return oe},invert:_s,functions:bo,methods:bo,extend:io,extendOwn:Ta,assign:Ta,defaults:Wa,create:function(vt,Lt){var $t=Sa(vt);return Lt&&Ta($t,Lt),$t},clone:function(vt){return rt(vt)?fe(vt)?vt.slice():io({},vt):vt},tap:function(vt,Lt){return Lt(vt),vt},get:Vt,has:function(vt,Lt){for(var $t=(Lt=js(Lt)).length,oe=0;oe<$t;oe++){var C=Lt[oe];if(!mn(vt,C))return!1;vt=vt[C]}return!!$t},mapObject:function(vt,Lt,$t){Lt=Se(Lt,$t);for(var oe=we(vt),C=oe.length,z={},U=0;U<C;U++){var X=oe[U];z[X]=Lt(vt[X],X,vt)}return z},identity:pt,constant:Pn,noop:xe,toPath:ts,property:Ut,propertyOf:function(vt){return vt==null?xe:function(Lt){return Vt(vt,Lt)}},matcher:It,matches:It,times:function(vt,Lt,$t){var oe=Array(Math.max(0,vt));Lt=qt(Lt,$t,1);for(var C=0;C<vt;C++)oe[C]=Lt(C);return oe},random:Re,now:hn,escape:ci,unescape:hi,templateSettings:Qn,template:function(vt,Lt,$t){!Lt&&$t&&(Lt=$t),Lt=Wa({},Lt,pe.templateSettings);var oe=RegExp([(Lt.escape||pi).source,(Lt.interpolate||pi).source,(Lt.evaluate||pi).source].join("|")+"|$","g"),C=0,z="__p+='";vt.replace(oe,function(mt,Tt,ce,ee,Oe){return z+=vt.slice(C,Oe).replace(ur,ti),C=Oe+mt.length,Tt?z+=`'+
((__t=(`+Tt+`))==null?'':_.escape(__t))+
'`:ce?z+=`'+
((__t=(`+ce+`))==null?'':__t)+
'`:ee&&(z+=`';
`+ee+`
__p+='`),mt}),z+=`';
`;var U,X=Lt.variable;if(X){if(!yr.test(X))throw new Error("variable is not a bare identifier: "+X)}else z=`with(obj||{}){
`+z+`}
`,X="obj";z=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+z+`return __p;
`;try{U=new Function(X,"_",z)}catch(mt){throw mt.source=z,mt}var ft=function(mt){return U.call(this,mt,pe)};return ft.source="function("+X+`){
`+z+"}",ft},result:function(vt,Lt,$t){var oe=(Lt=js(Lt)).length;if(!oe)return be($t)?$t.call(vt):$t;for(var C=0;C<oe;C++){var z=vt==null?void 0:vt[Lt[C]];z===void 0&&(z=$t,C=oe),vt=be(z)?z.call(vt):z}return vt},uniqueId:function(vt){var Lt=++xr+"";return vt?vt+Lt:Lt},chain:function(vt){var Lt=pe(vt);return Lt._chain=!0,Lt},iteratee:Pe,partial:Ss,bind:vs,bindAll:Xr,memoize:function(vt,Lt){var $t=function(oe){var C=$t.cache,z=""+(Lt?Lt.apply(this,arguments):oe);return mn(C,z)||(C[z]=vt.apply(this,arguments)),C[z]};return $t.cache={},$t},delay:ro,defer:hl,throttle:function(vt,Lt,$t){var oe,C,z,U,X=0;$t||($t={});var ft=function(){X=$t.leading===!1?0:hn(),oe=null,U=vt.apply(C,z),oe||(C=z=null)},mt=function(){var Tt=hn();X||$t.leading!==!1||(X=Tt);var ce=Lt-(Tt-X);return C=this,z=arguments,ce<=0||ce>Lt?(oe&&(clearTimeout(oe),oe=null),X=Tt,U=vt.apply(C,z),oe||(C=z=null)):oe||$t.trailing===!1||(oe=setTimeout(ft,ce)),U};return mt.cancel=function(){clearTimeout(oe),X=0,oe=C=z=null},mt},debounce:function(vt,Lt,$t){var oe,C,z,U,X,ft=function(){var Tt=hn()-C;Lt>Tt?oe=setTimeout(ft,Lt-Tt):(oe=null,$t||(U=vt.apply(X,z)),oe||(z=X=null))},mt=k(function(Tt){return X=this,z=Tt,C=hn(),oe||(oe=setTimeout(ft,Lt),$t&&(U=vt.apply(X,z))),U});return mt.cancel=function(){clearTimeout(oe),oe=z=X=null},mt},wrap:function(vt,Lt){return Ss(Lt,vt)},negate:Io,compose:function(){var vt=arguments,Lt=vt.length-1;return function(){for(var $t=Lt,oe=vt[Lt].apply(this,arguments);$t--;)oe=vt[$t].call(this,oe);return oe}},after:function(vt,Lt){return function(){if(--vt<1)return Lt.apply(this,arguments)}},before:cr,once:Kr,findKey:Co,findIndex:Ti,findLastIndex:Oi,sortedIndex:Si,indexOf:vi,lastIndexOf:Ma,find:oo,detect:oo,findWhere:function(vt,Lt){return oo(vt,It(Lt))},each:Yo,forEach:Yo,map:Nr,collect:Nr,reduce:ir,foldl:ir,inject:ir,reduceRight:es,foldr:es,filter:ns,select:ns,reject:function(vt,Lt,$t){return ns(vt,Io(Se(Lt)),$t)},every:is,all:is,some:da,any:da,contains:zo,includes:zo,include:zo,invoke:Ks,pluck:Us,where:function(vt,Lt){return ns(vt,It(Lt))},max:La,min:function(vt,Lt,$t){var oe,C,z=1/0,U=1/0;if(Lt==null||typeof Lt=="number"&&typeof vt[0]!="object"&&vt!=null)for(var X=0,ft=(vt=Ke(vt)?vt:Qo(vt)).length;X<ft;X++)(oe=vt[X])!=null&&oe<z&&(z=oe);else Lt=Se(Lt,$t),Yo(vt,function(mt,Tt,ce){((C=Lt(mt,Tt,ce))<U||C===1/0&&z===1/0)&&(z=mt,U=C)});return z},shuffle:function(vt){return Zr(vt,1/0)},sample:Zr,sortBy:function(vt,Lt,$t){var oe=0;return Lt=Se(Lt,$t),Us(Nr(vt,function(C,z,U){return{value:C,index:oe++,criteria:Lt(C,z,U)}}).sort(function(C,z){var U=C.criteria,X=z.criteria;if(U!==X){if(U>X||U===void 0)return 1;if(U<X||X===void 0)return-1}return C.index-z.index}),"value")},groupBy:Hl,indexBy:Vo,countBy:wi,partition:ta,toArray:Zo,size:function(vt){return vt==null?0:Ke(vt)?vt.length:we(vt).length},pick:Ao,omit:ka,first:ea,head:ea,take:ea,initial:dl,last:function(vt,Lt,$t){return vt==null||vt.length<1?Lt==null||$t?void 0:[]:Lt==null||$t?vt[vt.length-1]:Or(vt,Math.max(0,vt.length-Lt))},rest:Or,tail:Or,drop:Or,compact:function(vt){return ns(vt,Boolean)},flatten:function(vt,Lt){return Po(vt,Lt,!1)},without:Ya,uniq:Ei,unique:Ei,union:rr,intersection:function(vt){for(var Lt=[],$t=arguments.length,oe=0,C=wt(vt);oe<C;oe++){var z=vt[oe];if(!zo(Lt,z)){var U;for(U=1;U<$t&&zo(arguments[U],z);U++);U===$t&&Lt.push(z)}}return Lt},difference:na,unzip:pl,transpose:pl,zip:pc,object:function(vt,Lt){for(var $t={},oe=0,C=wt(vt);oe<C;oe++)Lt?$t[vt[oe]]=Lt[oe]:$t[vt[oe][0]]=vt[oe][1];return $t},range:function(vt,Lt,$t){Lt==null&&(Lt=vt||0,vt=0),$t||($t=Lt<vt?-1:1);for(var oe=Math.max(Math.ceil((Lt-vt)/$t),0),C=Array(oe),z=0;z<oe;z++,vt+=$t)C[z]=vt;return C},chunk:function(vt,Lt){if(Lt==null||Lt<1)return[];for(var $t=[],oe=0,C=vt.length;oe<C;)$t.push(w.call(vt,oe,oe+=Lt));return $t},mixin:Es,default:pe});return Pa._=Pa,Pa})}(fO)),rx}var ox={},pO={get exports(){return ox},set exports(t){ox=t}};/*!
 * jQuery JavaScript Library v3.6.4
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-03-08T15:28Z
 */var AS;function dk(){return AS||(AS=1,function(t){(function(e,n){t.exports=e.document?n(e,!0):function(o){if(!o.document)throw new Error("jQuery requires a window with a document");return n(o)}})(typeof window<"u"?window:fa,function(e,n){var o=[],l=Object.getPrototypeOf,c=o.slice,p=o.flat?function(C){return o.flat.call(C)}:function(C){return o.concat.apply([],C)},r=o.push,w=o.indexOf,M={},N=M.toString,E=M.hasOwnProperty,Z=E.toString,Y=Z.call(Object),K={},q=function(z){return typeof z=="function"&&typeof z.nodeType!="number"&&typeof z.item!="function"},at=function(z){return z!=null&&z===z.window},J=e.document,Q={type:!0,src:!0,nonce:!0,noModule:!0};function lt(C,z,U){U=U||J;var X,ft,mt=U.createElement("script");if(mt.text=C,z)for(X in Q)ft=z[X]||z.getAttribute&&z.getAttribute(X),ft&&mt.setAttribute(X,ft);U.head.appendChild(mt).parentNode.removeChild(mt)}function Ct(C){return C==null?C+"":typeof C=="object"||typeof C=="function"?M[N.call(C)]||"object":typeof C}var j="3.6.4",k=function(C,z){return new k.fn.init(C,z)};k.fn=k.prototype={jquery:j,constructor:k,length:0,toArray:function(){return c.call(this)},get:function(C){return C==null?c.call(this):C<0?this[C+this.length]:this[C]},pushStack:function(C){var z=k.merge(this.constructor(),C);return z.prevObject=this,z},each:function(C){return k.each(this,C)},map:function(C){return this.pushStack(k.map(this,function(z,U){return C.call(z,U,z)}))},slice:function(){return this.pushStack(c.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(k.grep(this,function(C,z){return(z+1)%2}))},odd:function(){return this.pushStack(k.grep(this,function(C,z){return z%2}))},eq:function(C){var z=this.length,U=+C+(C<0?z:0);return this.pushStack(U>=0&&U<z?[this[U]]:[])},end:function(){return this.prevObject||this.constructor()},push:r,sort:o.sort,splice:o.splice},k.extend=k.fn.extend=function(){var C,z,U,X,ft,mt,Tt=arguments[0]||{},ce=1,ee=arguments.length,Oe=!1;for(typeof Tt=="boolean"&&(Oe=Tt,Tt=arguments[ce]||{},ce++),typeof Tt!="object"&&!q(Tt)&&(Tt={}),ce===ee&&(Tt=this,ce--);ce<ee;ce++)if((C=arguments[ce])!=null)for(z in C)X=C[z],!(z==="__proto__"||Tt===X)&&(Oe&&X&&(k.isPlainObject(X)||(ft=Array.isArray(X)))?(U=Tt[z],ft&&!Array.isArray(U)?mt=[]:!ft&&!k.isPlainObject(U)?mt={}:mt=U,ft=!1,Tt[z]=k.extend(Oe,mt,X)):X!==void 0&&(Tt[z]=X));return Tt},k.extend({expando:"jQuery"+(j+Math.random()).replace(/\D/g,""),isReady:!0,error:function(C){throw new Error(C)},noop:function(){},isPlainObject:function(C){var z,U;return!C||N.call(C)!=="[object Object]"?!1:(z=l(C),z?(U=E.call(z,"constructor")&&z.constructor,typeof U=="function"&&Z.call(U)===Y):!0)},isEmptyObject:function(C){var z;for(z in C)return!1;return!0},globalEval:function(C,z,U){lt(C,{nonce:z&&z.nonce},U)},each:function(C,z){var U,X=0;if(rt(C))for(U=C.length;X<U&&z.call(C[X],X,C[X])!==!1;X++);else for(X in C)if(z.call(C[X],X,C[X])===!1)break;return C},makeArray:function(C,z){var U=z||[];return C!=null&&(rt(Object(C))?k.merge(U,typeof C=="string"?[C]:C):r.call(U,C)),U},inArray:function(C,z,U){return z==null?-1:w.call(z,C,U)},merge:function(C,z){for(var U=+z.length,X=0,ft=C.length;X<U;X++)C[ft++]=z[X];return C.length=ft,C},grep:function(C,z,U){for(var X,ft=[],mt=0,Tt=C.length,ce=!U;mt<Tt;mt++)X=!z(C[mt],mt),X!==ce&&ft.push(C[mt]);return ft},map:function(C,z,U){var X,ft,mt=0,Tt=[];if(rt(C))for(X=C.length;mt<X;mt++)ft=z(C[mt],mt,U),ft!=null&&Tt.push(ft);else for(mt in C)ft=z(C[mt],mt,U),ft!=null&&Tt.push(ft);return p(Tt)},guid:1,support:K}),typeof Symbol=="function"&&(k.fn[Symbol.iterator]=o[Symbol.iterator]),k.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(C,z){M["[object "+z+"]"]=z.toLowerCase()});function rt(C){var z=!!C&&"length"in C&&C.length,U=Ct(C);return q(C)||at(C)?!1:U==="array"||z===0||typeof z=="number"&&z>0&&z-1 in C}var yt=function(C){var z,U,X,ft,mt,Tt,ce,ee,Oe,Qe,pn,qe,an,Fn,Ui,ei,To,Qr,tr,sr="sizzle"+1*new Date,Di=C.document,ls=0,er=0,wr=Ls(),Xa=Ls(),za=Ls(),Vr=Ls(),Gs=function(Nt,ae){return Nt===ae&&(pn=!0),0},Ri={}.hasOwnProperty,us=[],pa=us.pop,Ms=us.push,ma=us.push,ml=us.slice,Da=function(Nt,ae){for(var Ce=0,vn=Nt.length;Ce<vn;Ce++)if(Nt[Ce]===ae)return Ce;return-1},mc="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Mr="[\\x20\\t\\r\\n\\f]",ia="(?:\\\\[\\da-fA-F]{1,6}"+Mr+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Zu="\\["+Mr+"*("+ia+")(?:"+Mr+"*([*^$|!~]?=)"+Mr+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+ia+"))|)"+Mr+"*\\]",ys=":("+ia+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Zu+")*)|.*)\\)|)",Wo=new RegExp(Mr+"+","g"),ql=new RegExp("^"+Mr+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Mr+"+$","g"),Zs=new RegExp("^"+Mr+"*,"+Mr+"*"),Fc=new RegExp("^"+Mr+"*([>+~]|"+Mr+")"+Mr+"*"),Na=new RegExp(Mr+"|>"),xu=new RegExp(ys),wu=new RegExp("^"+ia+"$"),Sl={ID:new RegExp("^#("+ia+")"),CLASS:new RegExp("^\\.("+ia+")"),TAG:new RegExp("^("+ia+"|[*])"),ATTR:new RegExp("^"+Zu),PSEUDO:new RegExp("^"+ys),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Mr+"*(even|odd|(([+-]|)(\\d*)n|)"+Mr+"*(?:([+-]|)"+Mr+"*(\\d+)|))"+Mr+"*\\)|)","i"),bool:new RegExp("^(?:"+mc+")$","i"),needsContext:new RegExp("^"+Mr+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Mr+"*((?:-\\d)?\\d*)"+Mr+"*\\)|)(?=[^-]|$)","i")},bu=/HTML$/i,Ha=/^(?:input|select|textarea|button)$/i,xs=/^h\d$/i,$a=/^[^{]+\{\s*\[native \w/,gc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,El=/[+~]/,ga=new RegExp("\\\\[\\da-fA-F]{1,6}"+Mr+"?|\\\\([^\\r\\n\\f])","g"),ho=function(Nt,ae){var Ce="0x"+Nt.slice(1)-65536;return ae||(Ce<0?String.fromCharCode(Ce+65536):String.fromCharCode(Ce>>10|55296,Ce&1023|56320))},Ml=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Ll=function(Nt,ae){return ae?Nt==="\0"?"�":Nt.slice(0,-1)+"\\"+Nt.charCodeAt(Nt.length-1).toString(16)+" ":"\\"+Nt},Vu=function(){qe()},gl=Bi(function(Nt){return Nt.disabled===!0&&Nt.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{ma.apply(us=ml.call(Di.childNodes),Di.childNodes),us[Di.childNodes.length].nodeType}catch{ma={apply:us.length?function(ae,Ce){Ms.apply(ae,ml.call(Ce))}:function(ae,Ce){for(var vn=ae.length,ke=0;ae[vn++]=Ce[ke++];);ae.length=vn-1}}}function dr(Nt,ae,Ce,vn){var ke,rn,Sn,Yn,Mn,bi,mi,Mi=ae&&ae.ownerDocument,Gi=ae?ae.nodeType:9;if(Ce=Ce||[],typeof Nt!="string"||!Nt||Gi!==1&&Gi!==9&&Gi!==11)return Ce;if(!vn&&(qe(ae),ae=ae||an,Ui)){if(Gi!==11&&(Mn=gc.exec(Nt)))if(ke=Mn[1]){if(Gi===9)if(Sn=ae.getElementById(ke)){if(Sn.id===ke)return Ce.push(Sn),Ce}else return Ce;else if(Mi&&(Sn=Mi.getElementById(ke))&&tr(ae,Sn)&&Sn.id===ke)return Ce.push(Sn),Ce}else{if(Mn[2])return ma.apply(Ce,ae.getElementsByTagName(Nt)),Ce;if((ke=Mn[3])&&U.getElementsByClassName&&ae.getElementsByClassName)return ma.apply(Ce,ae.getElementsByClassName(ke)),Ce}if(U.qsa&&!Vr[Nt+" "]&&(!ei||!ei.test(Nt))&&(Gi!==1||ae.nodeName.toLowerCase()!=="object")){if(mi=Nt,Mi=ae,Gi===1&&(Na.test(Nt)||Fc.test(Nt))){for(Mi=El.test(Nt)&&gn(ae.parentNode)||ae,(Mi!==ae||!U.scope)&&((Yn=ae.getAttribute("id"))?Yn=Yn.replace(Ml,Ll):ae.setAttribute("id",Yn=sr)),bi=Tt(Nt),rn=bi.length;rn--;)bi[rn]=(Yn?"#"+Yn:":scope")+" "+ni(bi[rn]);mi=bi.join(",")}try{return ma.apply(Ce,Mi.querySelectorAll(mi)),Ce}catch{Vr(Nt,!0)}finally{Yn===sr&&ae.removeAttribute("id")}}}return ee(Nt.replace(ql,"$1"),ae,Ce,vn)}function Ls(){var Nt=[];function ae(Ce,vn){return Nt.push(Ce+" ")>X.cacheLength&&delete ae[Nt.shift()],ae[Ce+" "]=vn}return ae}function Xo(Nt){return Nt[sr]=!0,Nt}function ws(Nt){var ae=an.createElement("fieldset");try{return!!Nt(ae)}catch{return!1}finally{ae.parentNode&&ae.parentNode.removeChild(ae),ae=null}}function _l(Nt,ae){for(var Ce=Nt.split("|"),vn=Ce.length;vn--;)X.attrHandle[Ce[vn]]=ae}function Wu(Nt,ae){var Ce=ae&&Nt,vn=Ce&&Nt.nodeType===1&&ae.nodeType===1&&Nt.sourceIndex-ae.sourceIndex;if(vn)return vn;if(Ce){for(;Ce=Ce.nextSibling;)if(Ce===ae)return-1}return Nt?1:-1}function Jl(Nt){return function(ae){var Ce=ae.nodeName.toLowerCase();return Ce==="input"&&ae.type===Nt}}function Yu(Nt){return function(ae){var Ce=ae.nodeName.toLowerCase();return(Ce==="input"||Ce==="button")&&ae.type===Nt}}function ks(Nt){return function(ae){return"form"in ae?ae.parentNode&&ae.disabled===!1?"label"in ae?"label"in ae.parentNode?ae.parentNode.disabled===Nt:ae.disabled===Nt:ae.isDisabled===Nt||ae.isDisabled!==!Nt&&gl(ae)===Nt:ae.disabled===Nt:"label"in ae?ae.disabled===Nt:!1}}function ze(Nt){return Xo(function(ae){return ae=+ae,Xo(function(Ce,vn){for(var ke,rn=Nt([],Ce.length,ae),Sn=rn.length;Sn--;)Ce[ke=rn[Sn]]&&(Ce[ke]=!(vn[ke]=Ce[ke]))})})}function gn(Nt){return Nt&&typeof Nt.getElementsByTagName<"u"&&Nt}U=dr.support={},mt=dr.isXML=function(Nt){var ae=Nt&&Nt.namespaceURI,Ce=Nt&&(Nt.ownerDocument||Nt).documentElement;return!bu.test(ae||Ce&&Ce.nodeName||"HTML")},qe=dr.setDocument=function(Nt){var ae,Ce,vn=Nt?Nt.ownerDocument||Nt:Di;return vn==an||vn.nodeType!==9||!vn.documentElement||(an=vn,Fn=an.documentElement,Ui=!mt(an),Di!=an&&(Ce=an.defaultView)&&Ce.top!==Ce&&(Ce.addEventListener?Ce.addEventListener("unload",Vu,!1):Ce.attachEvent&&Ce.attachEvent("onunload",Vu)),U.scope=ws(function(ke){return Fn.appendChild(ke).appendChild(an.createElement("div")),typeof ke.querySelectorAll<"u"&&!ke.querySelectorAll(":scope fieldset div").length}),U.cssHas=ws(function(){try{return an.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),U.attributes=ws(function(ke){return ke.className="i",!ke.getAttribute("className")}),U.getElementsByTagName=ws(function(ke){return ke.appendChild(an.createComment("")),!ke.getElementsByTagName("*").length}),U.getElementsByClassName=$a.test(an.getElementsByClassName),U.getById=ws(function(ke){return Fn.appendChild(ke).id=sr,!an.getElementsByName||!an.getElementsByName(sr).length}),U.getById?(X.filter.ID=function(ke){var rn=ke.replace(ga,ho);return function(Sn){return Sn.getAttribute("id")===rn}},X.find.ID=function(ke,rn){if(typeof rn.getElementById<"u"&&Ui){var Sn=rn.getElementById(ke);return Sn?[Sn]:[]}}):(X.filter.ID=function(ke){var rn=ke.replace(ga,ho);return function(Sn){var Yn=typeof Sn.getAttributeNode<"u"&&Sn.getAttributeNode("id");return Yn&&Yn.value===rn}},X.find.ID=function(ke,rn){if(typeof rn.getElementById<"u"&&Ui){var Sn,Yn,Mn,bi=rn.getElementById(ke);if(bi){if(Sn=bi.getAttributeNode("id"),Sn&&Sn.value===ke)return[bi];for(Mn=rn.getElementsByName(ke),Yn=0;bi=Mn[Yn++];)if(Sn=bi.getAttributeNode("id"),Sn&&Sn.value===ke)return[bi]}return[]}}),X.find.TAG=U.getElementsByTagName?function(ke,rn){if(typeof rn.getElementsByTagName<"u")return rn.getElementsByTagName(ke);if(U.qsa)return rn.querySelectorAll(ke)}:function(ke,rn){var Sn,Yn=[],Mn=0,bi=rn.getElementsByTagName(ke);if(ke==="*"){for(;Sn=bi[Mn++];)Sn.nodeType===1&&Yn.push(Sn);return Yn}return bi},X.find.CLASS=U.getElementsByClassName&&function(ke,rn){if(typeof rn.getElementsByClassName<"u"&&Ui)return rn.getElementsByClassName(ke)},To=[],ei=[],(U.qsa=$a.test(an.querySelectorAll))&&(ws(function(ke){var rn;Fn.appendChild(ke).innerHTML="<a id='"+sr+"'></a><select id='"+sr+"-\r\\' msallowcapture=''><option selected=''></option></select>",ke.querySelectorAll("[msallowcapture^='']").length&&ei.push("[*^$]="+Mr+`*(?:''|"")`),ke.querySelectorAll("[selected]").length||ei.push("\\["+Mr+"*(?:value|"+mc+")"),ke.querySelectorAll("[id~="+sr+"-]").length||ei.push("~="),rn=an.createElement("input"),rn.setAttribute("name",""),ke.appendChild(rn),ke.querySelectorAll("[name='']").length||ei.push("\\["+Mr+"*name"+Mr+"*="+Mr+`*(?:''|"")`),ke.querySelectorAll(":checked").length||ei.push(":checked"),ke.querySelectorAll("a#"+sr+"+*").length||ei.push(".#.+[+~]"),ke.querySelectorAll("\\\f"),ei.push("[\\r\\n\\f]")}),ws(function(ke){ke.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var rn=an.createElement("input");rn.setAttribute("type","hidden"),ke.appendChild(rn).setAttribute("name","D"),ke.querySelectorAll("[name=d]").length&&ei.push("name"+Mr+"*[*^$|!~]?="),ke.querySelectorAll(":enabled").length!==2&&ei.push(":enabled",":disabled"),Fn.appendChild(ke).disabled=!0,ke.querySelectorAll(":disabled").length!==2&&ei.push(":enabled",":disabled"),ke.querySelectorAll("*,:x"),ei.push(",.*:")})),(U.matchesSelector=$a.test(Qr=Fn.matches||Fn.webkitMatchesSelector||Fn.mozMatchesSelector||Fn.oMatchesSelector||Fn.msMatchesSelector))&&ws(function(ke){U.disconnectedMatch=Qr.call(ke,"*"),Qr.call(ke,"[s!='']:x"),To.push("!=",ys)}),U.cssHas||ei.push(":has"),ei=ei.length&&new RegExp(ei.join("|")),To=To.length&&new RegExp(To.join("|")),ae=$a.test(Fn.compareDocumentPosition),tr=ae||$a.test(Fn.contains)?function(ke,rn){var Sn=ke.nodeType===9&&ke.documentElement||ke,Yn=rn&&rn.parentNode;return ke===Yn||!!(Yn&&Yn.nodeType===1&&(Sn.contains?Sn.contains(Yn):ke.compareDocumentPosition&&ke.compareDocumentPosition(Yn)&16))}:function(ke,rn){if(rn){for(;rn=rn.parentNode;)if(rn===ke)return!0}return!1},Gs=ae?function(ke,rn){if(ke===rn)return pn=!0,0;var Sn=!ke.compareDocumentPosition-!rn.compareDocumentPosition;return Sn||(Sn=(ke.ownerDocument||ke)==(rn.ownerDocument||rn)?ke.compareDocumentPosition(rn):1,Sn&1||!U.sortDetached&&rn.compareDocumentPosition(ke)===Sn?ke==an||ke.ownerDocument==Di&&tr(Di,ke)?-1:rn==an||rn.ownerDocument==Di&&tr(Di,rn)?1:Qe?Da(Qe,ke)-Da(Qe,rn):0:Sn&4?-1:1)}:function(ke,rn){if(ke===rn)return pn=!0,0;var Sn,Yn=0,Mn=ke.parentNode,bi=rn.parentNode,mi=[ke],Mi=[rn];if(!Mn||!bi)return ke==an?-1:rn==an?1:Mn?-1:bi?1:Qe?Da(Qe,ke)-Da(Qe,rn):0;if(Mn===bi)return Wu(ke,rn);for(Sn=ke;Sn=Sn.parentNode;)mi.unshift(Sn);for(Sn=rn;Sn=Sn.parentNode;)Mi.unshift(Sn);for(;mi[Yn]===Mi[Yn];)Yn++;return Yn?Wu(mi[Yn],Mi[Yn]):mi[Yn]==Di?-1:Mi[Yn]==Di?1:0}),an},dr.matches=function(Nt,ae){return dr(Nt,null,null,ae)},dr.matchesSelector=function(Nt,ae){if(qe(Nt),U.matchesSelector&&Ui&&!Vr[ae+" "]&&(!To||!To.test(ae))&&(!ei||!ei.test(ae)))try{var Ce=Qr.call(Nt,ae);if(Ce||U.disconnectedMatch||Nt.document&&Nt.document.nodeType!==11)return Ce}catch{Vr(ae,!0)}return dr(ae,an,null,[Nt]).length>0},dr.contains=function(Nt,ae){return(Nt.ownerDocument||Nt)!=an&&qe(Nt),tr(Nt,ae)},dr.attr=function(Nt,ae){(Nt.ownerDocument||Nt)!=an&&qe(Nt);var Ce=X.attrHandle[ae.toLowerCase()],vn=Ce&&Ri.call(X.attrHandle,ae.toLowerCase())?Ce(Nt,ae,!Ui):void 0;return vn!==void 0?vn:U.attributes||!Ui?Nt.getAttribute(ae):(vn=Nt.getAttributeNode(ae))&&vn.specified?vn.value:null},dr.escape=function(Nt){return(Nt+"").replace(Ml,Ll)},dr.error=function(Nt){throw new Error("Syntax error, unrecognized expression: "+Nt)},dr.uniqueSort=function(Nt){var ae,Ce=[],vn=0,ke=0;if(pn=!U.detectDuplicates,Qe=!U.sortStable&&Nt.slice(0),Nt.sort(Gs),pn){for(;ae=Nt[ke++];)ae===Nt[ke]&&(vn=Ce.push(ke));for(;vn--;)Nt.splice(Ce[vn],1)}return Qe=null,Nt},ft=dr.getText=function(Nt){var ae,Ce="",vn=0,ke=Nt.nodeType;if(ke){if(ke===1||ke===9||ke===11){if(typeof Nt.textContent=="string")return Nt.textContent;for(Nt=Nt.firstChild;Nt;Nt=Nt.nextSibling)Ce+=ft(Nt)}else if(ke===3||ke===4)return Nt.nodeValue}else for(;ae=Nt[vn++];)Ce+=ft(ae);return Ce},X=dr.selectors={cacheLength:50,createPseudo:Xo,match:Sl,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Nt){return Nt[1]=Nt[1].replace(ga,ho),Nt[3]=(Nt[3]||Nt[4]||Nt[5]||"").replace(ga,ho),Nt[2]==="~="&&(Nt[3]=" "+Nt[3]+" "),Nt.slice(0,4)},CHILD:function(Nt){return Nt[1]=Nt[1].toLowerCase(),Nt[1].slice(0,3)==="nth"?(Nt[3]||dr.error(Nt[0]),Nt[4]=+(Nt[4]?Nt[5]+(Nt[6]||1):2*(Nt[3]==="even"||Nt[3]==="odd")),Nt[5]=+(Nt[7]+Nt[8]||Nt[3]==="odd")):Nt[3]&&dr.error(Nt[0]),Nt},PSEUDO:function(Nt){var ae,Ce=!Nt[6]&&Nt[2];return Sl.CHILD.test(Nt[0])?null:(Nt[3]?Nt[2]=Nt[4]||Nt[5]||"":Ce&&xu.test(Ce)&&(ae=Tt(Ce,!0))&&(ae=Ce.indexOf(")",Ce.length-ae)-Ce.length)&&(Nt[0]=Nt[0].slice(0,ae),Nt[2]=Ce.slice(0,ae)),Nt.slice(0,3))}},filter:{TAG:function(Nt){var ae=Nt.replace(ga,ho).toLowerCase();return Nt==="*"?function(){return!0}:function(Ce){return Ce.nodeName&&Ce.nodeName.toLowerCase()===ae}},CLASS:function(Nt){var ae=wr[Nt+" "];return ae||(ae=new RegExp("(^|"+Mr+")"+Nt+"("+Mr+"|$)"))&&wr(Nt,function(Ce){return ae.test(typeof Ce.className=="string"&&Ce.className||typeof Ce.getAttribute<"u"&&Ce.getAttribute("class")||"")})},ATTR:function(Nt,ae,Ce){return function(vn){var ke=dr.attr(vn,Nt);return ke==null?ae==="!=":ae?(ke+="",ae==="="?ke===Ce:ae==="!="?ke!==Ce:ae==="^="?Ce&&ke.indexOf(Ce)===0:ae==="*="?Ce&&ke.indexOf(Ce)>-1:ae==="$="?Ce&&ke.slice(-Ce.length)===Ce:ae==="~="?(" "+ke.replace(Wo," ")+" ").indexOf(Ce)>-1:ae==="|="?ke===Ce||ke.slice(0,Ce.length+1)===Ce+"-":!1):!0}},CHILD:function(Nt,ae,Ce,vn,ke){var rn=Nt.slice(0,3)!=="nth",Sn=Nt.slice(-4)!=="last",Yn=ae==="of-type";return vn===1&&ke===0?function(Mn){return!!Mn.parentNode}:function(Mn,bi,mi){var Mi,Gi,or,Ii,fo,po,rs=rn!==Sn?"nextSibling":"previousSibling",Rr=Mn.parentNode,zs=Yn&&Mn.nodeName.toLowerCase(),Ws=!mi&&!Yn,Bo=!1;if(Rr){if(rn){for(;rs;){for(Ii=Mn;Ii=Ii[rs];)if(Yn?Ii.nodeName.toLowerCase()===zs:Ii.nodeType===1)return!1;po=rs=Nt==="only"&&!po&&"nextSibling"}return!0}if(po=[Sn?Rr.firstChild:Rr.lastChild],Sn&&Ws){for(Ii=Rr,or=Ii[sr]||(Ii[sr]={}),Gi=or[Ii.uniqueID]||(or[Ii.uniqueID]={}),Mi=Gi[Nt]||[],fo=Mi[0]===ls&&Mi[1],Bo=fo&&Mi[2],Ii=fo&&Rr.childNodes[fo];Ii=++fo&&Ii&&Ii[rs]||(Bo=fo=0)||po.pop();)if(Ii.nodeType===1&&++Bo&&Ii===Mn){Gi[Nt]=[ls,fo,Bo];break}}else if(Ws&&(Ii=Mn,or=Ii[sr]||(Ii[sr]={}),Gi=or[Ii.uniqueID]||(or[Ii.uniqueID]={}),Mi=Gi[Nt]||[],fo=Mi[0]===ls&&Mi[1],Bo=fo),Bo===!1)for(;(Ii=++fo&&Ii&&Ii[rs]||(Bo=fo=0)||po.pop())&&!((Yn?Ii.nodeName.toLowerCase()===zs:Ii.nodeType===1)&&++Bo&&(Ws&&(or=Ii[sr]||(Ii[sr]={}),Gi=or[Ii.uniqueID]||(or[Ii.uniqueID]={}),Gi[Nt]=[ls,Bo]),Ii===Mn)););return Bo-=ke,Bo===vn||Bo%vn===0&&Bo/vn>=0}}},PSEUDO:function(Nt,ae){var Ce,vn=X.pseudos[Nt]||X.setFilters[Nt.toLowerCase()]||dr.error("unsupported pseudo: "+Nt);return vn[sr]?vn(ae):vn.length>1?(Ce=[Nt,Nt,"",ae],X.setFilters.hasOwnProperty(Nt.toLowerCase())?Xo(function(ke,rn){for(var Sn,Yn=vn(ke,ae),Mn=Yn.length;Mn--;)Sn=Da(ke,Yn[Mn]),ke[Sn]=!(rn[Sn]=Yn[Mn])}):function(ke){return vn(ke,0,Ce)}):vn}},pseudos:{not:Xo(function(Nt){var ae=[],Ce=[],vn=ce(Nt.replace(ql,"$1"));return vn[sr]?Xo(function(ke,rn,Sn,Yn){for(var Mn,bi=vn(ke,null,Yn,[]),mi=ke.length;mi--;)(Mn=bi[mi])&&(ke[mi]=!(rn[mi]=Mn))}):function(ke,rn,Sn){return ae[0]=ke,vn(ae,null,Sn,Ce),ae[0]=null,!Ce.pop()}}),has:Xo(function(Nt){return function(ae){return dr(Nt,ae).length>0}}),contains:Xo(function(Nt){return Nt=Nt.replace(ga,ho),function(ae){return(ae.textContent||ft(ae)).indexOf(Nt)>-1}}),lang:Xo(function(Nt){return wu.test(Nt||"")||dr.error("unsupported lang: "+Nt),Nt=Nt.replace(ga,ho).toLowerCase(),function(ae){var Ce;do if(Ce=Ui?ae.lang:ae.getAttribute("xml:lang")||ae.getAttribute("lang"))return Ce=Ce.toLowerCase(),Ce===Nt||Ce.indexOf(Nt+"-")===0;while((ae=ae.parentNode)&&ae.nodeType===1);return!1}}),target:function(Nt){var ae=C.location&&C.location.hash;return ae&&ae.slice(1)===Nt.id},root:function(Nt){return Nt===Fn},focus:function(Nt){return Nt===an.activeElement&&(!an.hasFocus||an.hasFocus())&&!!(Nt.type||Nt.href||~Nt.tabIndex)},enabled:ks(!1),disabled:ks(!0),checked:function(Nt){var ae=Nt.nodeName.toLowerCase();return ae==="input"&&!!Nt.checked||ae==="option"&&!!Nt.selected},selected:function(Nt){return Nt.parentNode&&Nt.parentNode.selectedIndex,Nt.selected===!0},empty:function(Nt){for(Nt=Nt.firstChild;Nt;Nt=Nt.nextSibling)if(Nt.nodeType<6)return!1;return!0},parent:function(Nt){return!X.pseudos.empty(Nt)},header:function(Nt){return xs.test(Nt.nodeName)},input:function(Nt){return Ha.test(Nt.nodeName)},button:function(Nt){var ae=Nt.nodeName.toLowerCase();return ae==="input"&&Nt.type==="button"||ae==="button"},text:function(Nt){var ae;return Nt.nodeName.toLowerCase()==="input"&&Nt.type==="text"&&((ae=Nt.getAttribute("type"))==null||ae.toLowerCase()==="text")},first:ze(function(){return[0]}),last:ze(function(Nt,ae){return[ae-1]}),eq:ze(function(Nt,ae,Ce){return[Ce<0?Ce+ae:Ce]}),even:ze(function(Nt,ae){for(var Ce=0;Ce<ae;Ce+=2)Nt.push(Ce);return Nt}),odd:ze(function(Nt,ae){for(var Ce=1;Ce<ae;Ce+=2)Nt.push(Ce);return Nt}),lt:ze(function(Nt,ae,Ce){for(var vn=Ce<0?Ce+ae:Ce>ae?ae:Ce;--vn>=0;)Nt.push(vn);return Nt}),gt:ze(function(Nt,ae,Ce){for(var vn=Ce<0?Ce+ae:Ce;++vn<ae;)Nt.push(vn);return Nt})}},X.pseudos.nth=X.pseudos.eq;for(z in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})X.pseudos[z]=Jl(z);for(z in{submit:!0,reset:!0})X.pseudos[z]=Yu(z);function on(){}on.prototype=X.filters=X.pseudos,X.setFilters=new on,Tt=dr.tokenize=function(Nt,ae){var Ce,vn,ke,rn,Sn,Yn,Mn,bi=Xa[Nt+" "];if(bi)return ae?0:bi.slice(0);for(Sn=Nt,Yn=[],Mn=X.preFilter;Sn;){(!Ce||(vn=Zs.exec(Sn)))&&(vn&&(Sn=Sn.slice(vn[0].length)||Sn),Yn.push(ke=[])),Ce=!1,(vn=Fc.exec(Sn))&&(Ce=vn.shift(),ke.push({value:Ce,type:vn[0].replace(ql," ")}),Sn=Sn.slice(Ce.length));for(rn in X.filter)(vn=Sl[rn].exec(Sn))&&(!Mn[rn]||(vn=Mn[rn](vn)))&&(Ce=vn.shift(),ke.push({value:Ce,type:rn,matches:vn}),Sn=Sn.slice(Ce.length));if(!Ce)break}return ae?Sn.length:Sn?dr.error(Nt):Xa(Nt,Yn).slice(0)};function ni(Nt){for(var ae=0,Ce=Nt.length,vn="";ae<Ce;ae++)vn+=Nt[ae].value;return vn}function Bi(Nt,ae,Ce){var vn=ae.dir,ke=ae.next,rn=ke||vn,Sn=Ce&&rn==="parentNode",Yn=er++;return ae.first?function(Mn,bi,mi){for(;Mn=Mn[vn];)if(Mn.nodeType===1||Sn)return Nt(Mn,bi,mi);return!1}:function(Mn,bi,mi){var Mi,Gi,or,Ii=[ls,Yn];if(mi){for(;Mn=Mn[vn];)if((Mn.nodeType===1||Sn)&&Nt(Mn,bi,mi))return!0}else for(;Mn=Mn[vn];)if(Mn.nodeType===1||Sn)if(or=Mn[sr]||(Mn[sr]={}),Gi=or[Mn.uniqueID]||(or[Mn.uniqueID]={}),ke&&ke===Mn.nodeName.toLowerCase())Mn=Mn[vn]||Mn;else{if((Mi=Gi[rn])&&Mi[0]===ls&&Mi[1]===Yn)return Ii[2]=Mi[2];if(Gi[rn]=Ii,Ii[2]=Nt(Mn,bi,mi))return!0}return!1}}function Sr(Nt){return Nt.length>1?function(ae,Ce,vn){for(var ke=Nt.length;ke--;)if(!Nt[ke](ae,Ce,vn))return!1;return!0}:Nt[0]}function Do(Nt,ae,Ce){for(var vn=0,ke=ae.length;vn<ke;vn++)dr(Nt,ae[vn],Ce);return Ce}function Lr(Nt,ae,Ce,vn,ke){for(var rn,Sn=[],Yn=0,Mn=Nt.length,bi=ae!=null;Yn<Mn;Yn++)(rn=Nt[Yn])&&(!Ce||Ce(rn,vn,ke))&&(Sn.push(rn),bi&&ae.push(Yn));return Sn}function Ps(Nt,ae,Ce,vn,ke,rn){return vn&&!vn[sr]&&(vn=Ps(vn)),ke&&!ke[sr]&&(ke=Ps(ke,rn)),Xo(function(Sn,Yn,Mn,bi){var mi,Mi,Gi,or=[],Ii=[],fo=Yn.length,po=Sn||Do(ae||"*",Mn.nodeType?[Mn]:Mn,[]),rs=Nt&&(Sn||!ae)?Lr(po,or,Nt,Mn,bi):po,Rr=Ce?ke||(Sn?Nt:fo||vn)?[]:Yn:rs;if(Ce&&Ce(rs,Rr,Mn,bi),vn)for(mi=Lr(Rr,Ii),vn(mi,[],Mn,bi),Mi=mi.length;Mi--;)(Gi=mi[Mi])&&(Rr[Ii[Mi]]=!(rs[Ii[Mi]]=Gi));if(Sn){if(ke||Nt){if(ke){for(mi=[],Mi=Rr.length;Mi--;)(Gi=Rr[Mi])&&mi.push(rs[Mi]=Gi);ke(null,Rr=[],mi,bi)}for(Mi=Rr.length;Mi--;)(Gi=Rr[Mi])&&(mi=ke?Da(Sn,Gi):or[Mi])>-1&&(Sn[mi]=!(Yn[mi]=Gi))}}else Rr=Lr(Rr===Yn?Rr.splice(fo,Rr.length):Rr),ke?ke(null,Yn,Rr,bi):ma.apply(Yn,Rr)})}function Kl(Nt){for(var ae,Ce,vn,ke=Nt.length,rn=X.relative[Nt[0].type],Sn=rn||X.relative[" "],Yn=rn?1:0,Mn=Bi(function(Mi){return Mi===ae},Sn,!0),bi=Bi(function(Mi){return Da(ae,Mi)>-1},Sn,!0),mi=[function(Mi,Gi,or){var Ii=!rn&&(or||Gi!==Oe)||((ae=Gi).nodeType?Mn(Mi,Gi,or):bi(Mi,Gi,or));return ae=null,Ii}];Yn<ke;Yn++)if(Ce=X.relative[Nt[Yn].type])mi=[Bi(Sr(mi),Ce)];else{if(Ce=X.filter[Nt[Yn].type].apply(null,Nt[Yn].matches),Ce[sr]){for(vn=++Yn;vn<ke&&!X.relative[Nt[vn].type];vn++);return Ps(Yn>1&&Sr(mi),Yn>1&&ni(Nt.slice(0,Yn-1).concat({value:Nt[Yn-2].type===" "?"*":""})).replace(ql,"$1"),Ce,Yn<vn&&Kl(Nt.slice(Yn,vn)),vn<ke&&Kl(Nt=Nt.slice(vn)),vn<ke&&ni(Nt))}mi.push(Ce)}return Sr(mi)}function Vs(Nt,ae){var Ce=ae.length>0,vn=Nt.length>0,ke=function(rn,Sn,Yn,Mn,bi){var mi,Mi,Gi,or=0,Ii="0",fo=rn&&[],po=[],rs=Oe,Rr=rn||vn&&X.find.TAG("*",bi),zs=ls+=rs==null?1:Math.random()||.1,Ws=Rr.length;for(bi&&(Oe=Sn==an||Sn||bi);Ii!==Ws&&(mi=Rr[Ii])!=null;Ii++){if(vn&&mi){for(Mi=0,!Sn&&mi.ownerDocument!=an&&(qe(mi),Yn=!Ui);Gi=Nt[Mi++];)if(Gi(mi,Sn||an,Yn)){Mn.push(mi);break}bi&&(ls=zs)}Ce&&((mi=!Gi&&mi)&&or--,rn&&fo.push(mi))}if(or+=Ii,Ce&&Ii!==or){for(Mi=0;Gi=ae[Mi++];)Gi(fo,po,Sn,Yn);if(rn){if(or>0)for(;Ii--;)fo[Ii]||po[Ii]||(po[Ii]=pa.call(Mn));po=Lr(po)}ma.apply(Mn,po),bi&&!rn&&po.length>0&&or+ae.length>1&&dr.uniqueSort(Mn)}return bi&&(ls=zs,Oe=rs),fo};return Ce?Xo(ke):ke}return ce=dr.compile=function(Nt,ae){var Ce,vn=[],ke=[],rn=za[Nt+" "];if(!rn){for(ae||(ae=Tt(Nt)),Ce=ae.length;Ce--;)rn=Kl(ae[Ce]),rn[sr]?vn.push(rn):ke.push(rn);rn=za(Nt,Vs(ke,vn)),rn.selector=Nt}return rn},ee=dr.select=function(Nt,ae,Ce,vn){var ke,rn,Sn,Yn,Mn,bi=typeof Nt=="function"&&Nt,mi=!vn&&Tt(Nt=bi.selector||Nt);if(Ce=Ce||[],mi.length===1){if(rn=mi[0]=mi[0].slice(0),rn.length>2&&(Sn=rn[0]).type==="ID"&&ae.nodeType===9&&Ui&&X.relative[rn[1].type]){if(ae=(X.find.ID(Sn.matches[0].replace(ga,ho),ae)||[])[0],ae)bi&&(ae=ae.parentNode);else return Ce;Nt=Nt.slice(rn.shift().value.length)}for(ke=Sl.needsContext.test(Nt)?0:rn.length;ke--&&(Sn=rn[ke],!X.relative[Yn=Sn.type]);)if((Mn=X.find[Yn])&&(vn=Mn(Sn.matches[0].replace(ga,ho),El.test(rn[0].type)&&gn(ae.parentNode)||ae))){if(rn.splice(ke,1),Nt=vn.length&&ni(rn),!Nt)return ma.apply(Ce,vn),Ce;break}}return(bi||ce(Nt,mi))(vn,ae,!Ui,Ce,!ae||El.test(Nt)&&gn(ae.parentNode)||ae),Ce},U.sortStable=sr.split("").sort(Gs).join("")===sr,U.detectDuplicates=!!pn,qe(),U.sortDetached=ws(function(Nt){return Nt.compareDocumentPosition(an.createElement("fieldset"))&1}),ws(function(Nt){return Nt.innerHTML="<a href='#'></a>",Nt.firstChild.getAttribute("href")==="#"})||_l("type|href|height|width",function(Nt,ae,Ce){if(!Ce)return Nt.getAttribute(ae,ae.toLowerCase()==="type"?1:2)}),(!U.attributes||!ws(function(Nt){return Nt.innerHTML="<input/>",Nt.firstChild.setAttribute("value",""),Nt.firstChild.getAttribute("value")===""}))&&_l("value",function(Nt,ae,Ce){if(!Ce&&Nt.nodeName.toLowerCase()==="input")return Nt.defaultValue}),ws(function(Nt){return Nt.getAttribute("disabled")==null})||_l(mc,function(Nt,ae,Ce){var vn;if(!Ce)return Nt[ae]===!0?ae.toLowerCase():(vn=Nt.getAttributeNode(ae))&&vn.specified?vn.value:null}),dr}(e);k.find=yt,k.expr=yt.selectors,k.expr[":"]=k.expr.pseudos,k.uniqueSort=k.unique=yt.uniqueSort,k.text=yt.getText,k.isXMLDoc=yt.isXML,k.contains=yt.contains,k.escapeSelector=yt.escape;var xt=function(C,z,U){for(var X=[],ft=U!==void 0;(C=C[z])&&C.nodeType!==9;)if(C.nodeType===1){if(ft&&k(C).is(U))break;X.push(C)}return X},kt=function(C,z){for(var U=[];C;C=C.nextSibling)C.nodeType===1&&C!==z&&U.push(C);return U},de=k.expr.match.needsContext;function Et(C,z){return C.nodeName&&C.nodeName.toLowerCase()===z.toLowerCase()}var te=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function ht(C,z,U){return q(z)?k.grep(C,function(X,ft){return!!z.call(X,ft,X)!==U}):z.nodeType?k.grep(C,function(X){return X===z!==U}):typeof z!="string"?k.grep(C,function(X){return w.call(z,X)>-1!==U}):k.filter(z,C,U)}k.filter=function(C,z,U){var X=z[0];return U&&(C=":not("+C+")"),z.length===1&&X.nodeType===1?k.find.matchesSelector(X,C)?[X]:[]:k.find.matches(C,k.grep(z,function(ft){return ft.nodeType===1}))},k.fn.extend({find:function(C){var z,U,X=this.length,ft=this;if(typeof C!="string")return this.pushStack(k(C).filter(function(){for(z=0;z<X;z++)if(k.contains(ft[z],this))return!0}));for(U=this.pushStack([]),z=0;z<X;z++)k.find(C,ft[z],U);return X>1?k.uniqueSort(U):U},filter:function(C){return this.pushStack(ht(this,C||[],!1))},not:function(C){return this.pushStack(ht(this,C||[],!0))},is:function(C){return!!ht(this,typeof C=="string"&&de.test(C)?k(C):C||[],!1).length}});var ie,ln=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Le=k.fn.init=function(C,z,U){var X,ft;if(!C)return this;if(U=U||ie,typeof C=="string")if(C[0]==="<"&&C[C.length-1]===">"&&C.length>=3?X=[null,C,null]:X=ln.exec(C),X&&(X[1]||!z))if(X[1]){if(z=z instanceof k?z[0]:z,k.merge(this,k.parseHTML(X[1],z&&z.nodeType?z.ownerDocument||z:J,!0)),te.test(X[1])&&k.isPlainObject(z))for(X in z)q(this[X])?this[X](z[X]):this.attr(X,z[X]);return this}else return ft=J.getElementById(X[2]),ft&&(this[0]=ft,this.length=1),this;else return!z||z.jquery?(z||U).find(C):this.constructor(z).find(C);else{if(C.nodeType)return this[0]=C,this.length=1,this;if(q(C))return U.ready!==void 0?U.ready(C):C(k)}return k.makeArray(C,this)};Le.prototype=k.fn,ie=k(J);var _e=/^(?:parents|prev(?:Until|All))/,Me={children:!0,contents:!0,next:!0,prev:!0};k.fn.extend({has:function(C){var z=k(C,this),U=z.length;return this.filter(function(){for(var X=0;X<U;X++)if(k.contains(this,z[X]))return!0})},closest:function(C,z){var U,X=0,ft=this.length,mt=[],Tt=typeof C!="string"&&k(C);if(!de.test(C)){for(;X<ft;X++)for(U=this[X];U&&U!==z;U=U.parentNode)if(U.nodeType<11&&(Tt?Tt.index(U)>-1:U.nodeType===1&&k.find.matchesSelector(U,C))){mt.push(U);break}}return this.pushStack(mt.length>1?k.uniqueSort(mt):mt)},index:function(C){return C?typeof C=="string"?w.call(k(C),this[0]):w.call(this,C.jquery?C[0]:C):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(C,z){return this.pushStack(k.uniqueSort(k.merge(this.get(),k(C,z))))},addBack:function(C){return this.add(C==null?this.prevObject:this.prevObject.filter(C))}});function be(C,z){for(;(C=C[z])&&C.nodeType!==1;);return C}k.each({parent:function(C){var z=C.parentNode;return z&&z.nodeType!==11?z:null},parents:function(C){return xt(C,"parentNode")},parentsUntil:function(C,z,U){return xt(C,"parentNode",U)},next:function(C){return be(C,"nextSibling")},prev:function(C){return be(C,"previousSibling")},nextAll:function(C){return xt(C,"nextSibling")},prevAll:function(C){return xt(C,"previousSibling")},nextUntil:function(C,z,U){return xt(C,"nextSibling",U)},prevUntil:function(C,z,U){return xt(C,"previousSibling",U)},siblings:function(C){return kt((C.parentNode||{}).firstChild,C)},children:function(C){return kt(C.firstChild)},contents:function(C){return C.contentDocument!=null&&l(C.contentDocument)?C.contentDocument:(Et(C,"template")&&(C=C.content||C),k.merge([],C.childNodes))}},function(C,z){k.fn[C]=function(U,X){var ft=k.map(this,z,U);return C.slice(-5)!=="Until"&&(X=U),X&&typeof X=="string"&&(ft=k.filter(X,ft)),this.length>1&&(Me[C]||k.uniqueSort(ft),_e.test(C)&&ft.reverse()),this.pushStack(ft)}});var ue=/[^\x20\t\r\n\f]+/g;function Yt(C){var z={};return k.each(C.match(ue)||[],function(U,X){z[X]=!0}),z}k.Callbacks=function(C){C=typeof C=="string"?Yt(C):k.extend({},C);var z,U,X,ft,mt=[],Tt=[],ce=-1,ee=function(){for(ft=ft||C.once,X=z=!0;Tt.length;ce=-1)for(U=Tt.shift();++ce<mt.length;)mt[ce].apply(U[0],U[1])===!1&&C.stopOnFalse&&(ce=mt.length,U=!1);C.memory||(U=!1),z=!1,ft&&(U?mt=[]:mt="")},Oe={add:function(){return mt&&(U&&!z&&(ce=mt.length-1,Tt.push(U)),function Qe(pn){k.each(pn,function(qe,an){q(an)?(!C.unique||!Oe.has(an))&&mt.push(an):an&&an.length&&Ct(an)!=="string"&&Qe(an)})}(arguments),U&&!z&&ee()),this},remove:function(){return k.each(arguments,function(Qe,pn){for(var qe;(qe=k.inArray(pn,mt,qe))>-1;)mt.splice(qe,1),qe<=ce&&ce--}),this},has:function(Qe){return Qe?k.inArray(Qe,mt)>-1:mt.length>0},empty:function(){return mt&&(mt=[]),this},disable:function(){return ft=Tt=[],mt=U="",this},disabled:function(){return!mt},lock:function(){return ft=Tt=[],!U&&!z&&(mt=U=""),this},locked:function(){return!!ft},fireWith:function(Qe,pn){return ft||(pn=pn||[],pn=[Qe,pn.slice?pn.slice():pn],Tt.push(pn),z||ee()),this},fire:function(){return Oe.fireWith(this,arguments),this},fired:function(){return!!X}};return Oe};function Ee(C){return C}function ve(C){throw C}function ye(C,z,U,X){var ft;try{C&&q(ft=C.promise)?ft.call(C).done(z).fail(U):C&&q(ft=C.then)?ft.call(C,z,U):z.apply(void 0,[C].slice(X))}catch(mt){U.apply(void 0,[mt])}}k.extend({Deferred:function(C){var z=[["notify","progress",k.Callbacks("memory"),k.Callbacks("memory"),2],["resolve","done",k.Callbacks("once memory"),k.Callbacks("once memory"),0,"resolved"],["reject","fail",k.Callbacks("once memory"),k.Callbacks("once memory"),1,"rejected"]],U="pending",X={state:function(){return U},always:function(){return ft.done(arguments).fail(arguments),this},catch:function(mt){return X.then(null,mt)},pipe:function(){var mt=arguments;return k.Deferred(function(Tt){k.each(z,function(ce,ee){var Oe=q(mt[ee[4]])&&mt[ee[4]];ft[ee[1]](function(){var Qe=Oe&&Oe.apply(this,arguments);Qe&&q(Qe.promise)?Qe.promise().progress(Tt.notify).done(Tt.resolve).fail(Tt.reject):Tt[ee[0]+"With"](this,Oe?[Qe]:arguments)})}),mt=null}).promise()},then:function(mt,Tt,ce){var ee=0;function Oe(Qe,pn,qe,an){return function(){var Fn=this,Ui=arguments,ei=function(){var Qr,tr;if(!(Qe<ee)){if(Qr=qe.apply(Fn,Ui),Qr===pn.promise())throw new TypeError("Thenable self-resolution");tr=Qr&&(typeof Qr=="object"||typeof Qr=="function")&&Qr.then,q(tr)?an?tr.call(Qr,Oe(ee,pn,Ee,an),Oe(ee,pn,ve,an)):(ee++,tr.call(Qr,Oe(ee,pn,Ee,an),Oe(ee,pn,ve,an),Oe(ee,pn,Ee,pn.notifyWith))):(qe!==Ee&&(Fn=void 0,Ui=[Qr]),(an||pn.resolveWith)(Fn,Ui))}},To=an?ei:function(){try{ei()}catch(Qr){k.Deferred.exceptionHook&&k.Deferred.exceptionHook(Qr,To.stackTrace),Qe+1>=ee&&(qe!==ve&&(Fn=void 0,Ui=[Qr]),pn.rejectWith(Fn,Ui))}};Qe?To():(k.Deferred.getStackHook&&(To.stackTrace=k.Deferred.getStackHook()),e.setTimeout(To))}}return k.Deferred(function(Qe){z[0][3].add(Oe(0,Qe,q(ce)?ce:Ee,Qe.notifyWith)),z[1][3].add(Oe(0,Qe,q(mt)?mt:Ee)),z[2][3].add(Oe(0,Qe,q(Tt)?Tt:ve))}).promise()},promise:function(mt){return mt!=null?k.extend(mt,X):X}},ft={};return k.each(z,function(mt,Tt){var ce=Tt[2],ee=Tt[5];X[Tt[1]]=ce.add,ee&&ce.add(function(){U=ee},z[3-mt][2].disable,z[3-mt][3].disable,z[0][2].lock,z[0][3].lock),ce.add(Tt[3].fire),ft[Tt[0]]=function(){return ft[Tt[0]+"With"](this===ft?void 0:this,arguments),this},ft[Tt[0]+"With"]=ce.fireWith}),X.promise(ft),C&&C.call(ft,ft),ft},when:function(C){var z=arguments.length,U=z,X=Array(U),ft=c.call(arguments),mt=k.Deferred(),Tt=function(ce){return function(ee){X[ce]=this,ft[ce]=arguments.length>1?c.call(arguments):ee,--z||mt.resolveWith(X,ft)}};if(z<=1&&(ye(C,mt.done(Tt(U)).resolve,mt.reject,!z),mt.state()==="pending"||q(ft[U]&&ft[U].then)))return mt.then();for(;U--;)ye(ft[U],Tt(U),mt.reject);return mt.promise()}});var fe=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;k.Deferred.exceptionHook=function(C,z){e.console&&e.console.warn&&C&&fe.test(C.name)&&e.console.warn("jQuery.Deferred exception: "+C.message,C.stack,z)},k.readyException=function(C){e.setTimeout(function(){throw C})};var mn=k.Deferred();k.fn.ready=function(C){return mn.then(C).catch(function(z){k.readyException(z)}),this},k.extend({isReady:!1,readyWait:1,ready:function(C){(C===!0?--k.readyWait:k.isReady)||(k.isReady=!0,!(C!==!0&&--k.readyWait>0)&&mn.resolveWith(J,[k]))}}),k.ready.then=mn.then;function Ue(){J.removeEventListener("DOMContentLoaded",Ue),e.removeEventListener("load",Ue),k.ready()}J.readyState==="complete"||J.readyState!=="loading"&&!J.documentElement.doScroll?e.setTimeout(k.ready):(J.addEventListener("DOMContentLoaded",Ue),e.addEventListener("load",Ue));var Cn=function(C,z,U,X,ft,mt,Tt){var ce=0,ee=C.length,Oe=U==null;if(Ct(U)==="object"){ft=!0;for(ce in U)Cn(C,z,ce,U[ce],!0,mt,Tt)}else if(X!==void 0&&(ft=!0,q(X)||(Tt=!0),Oe&&(Tt?(z.call(C,X),z=null):(Oe=z,z=function(Qe,pn,qe){return Oe.call(k(Qe),qe)})),z))for(;ce<ee;ce++)z(C[ce],U,Tt?X:X.call(C[ce],ce,z(C[ce],U)));return ft?C:Oe?z.call(C):ee?z(C[0],U):mt},Bn=/^-ms-/,Pn=/-([a-z])/g;function cn(C,z){return z.toUpperCase()}function Un(C){return C.replace(Bn,"ms-").replace(Pn,cn)}var R=function(C){return C.nodeType===1||C.nodeType===9||!+C.nodeType};function st(){this.expando=k.expando+st.uid++}st.uid=1,st.prototype={cache:function(C){var z=C[this.expando];return z||(z={},R(C)&&(C.nodeType?C[this.expando]=z:Object.defineProperty(C,this.expando,{value:z,configurable:!0}))),z},set:function(C,z,U){var X,ft=this.cache(C);if(typeof z=="string")ft[Un(z)]=U;else for(X in z)ft[Un(X)]=z[X];return ft},get:function(C,z){return z===void 0?this.cache(C):C[this.expando]&&C[this.expando][Un(z)]},access:function(C,z,U){return z===void 0||z&&typeof z=="string"&&U===void 0?this.get(C,z):(this.set(C,z,U),U!==void 0?U:z)},remove:function(C,z){var U,X=C[this.expando];if(X!==void 0){if(z!==void 0)for(Array.isArray(z)?z=z.map(Un):(z=Un(z),z=z in X?[z]:z.match(ue)||[]),U=z.length;U--;)delete X[z[U]];(z===void 0||k.isEmptyObject(X))&&(C.nodeType?C[this.expando]=void 0:delete C[this.expando])}},hasData:function(C){var z=C[this.expando];return z!==void 0&&!k.isEmptyObject(z)}};var gt=new st,dt=new st,wt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Zt=/[A-Z]/g;function we(C){return C==="true"?!0:C==="false"?!1:C==="null"?null:C===+C+""?+C:wt.test(C)?JSON.parse(C):C}function We(C,z,U){var X;if(U===void 0&&C.nodeType===1)if(X="data-"+z.replace(Zt,"-$&").toLowerCase(),U=C.getAttribute(X),typeof U=="string"){try{U=we(U)}catch{}dt.set(C,z,U)}else U=void 0;return U}k.extend({hasData:function(C){return dt.hasData(C)||gt.hasData(C)},data:function(C,z,U){return dt.access(C,z,U)},removeData:function(C,z){dt.remove(C,z)},_data:function(C,z,U){return gt.access(C,z,U)},_removeData:function(C,z){gt.remove(C,z)}}),k.fn.extend({data:function(C,z){var U,X,ft,mt=this[0],Tt=mt&&mt.attributes;if(C===void 0){if(this.length&&(ft=dt.get(mt),mt.nodeType===1&&!gt.get(mt,"hasDataAttrs"))){for(U=Tt.length;U--;)Tt[U]&&(X=Tt[U].name,X.indexOf("data-")===0&&(X=Un(X.slice(5)),We(mt,X,ft[X])));gt.set(mt,"hasDataAttrs",!0)}return ft}return typeof C=="object"?this.each(function(){dt.set(this,C)}):Cn(this,function(ce){var ee;if(mt&&ce===void 0)return ee=dt.get(mt,C),ee!==void 0||(ee=We(mt,C),ee!==void 0)?ee:void 0;this.each(function(){dt.set(this,C,ce)})},null,z,arguments.length>1,null,!0)},removeData:function(C){return this.each(function(){dt.remove(this,C)})}}),k.extend({queue:function(C,z,U){var X;if(C)return z=(z||"fx")+"queue",X=gt.get(C,z),U&&(!X||Array.isArray(U)?X=gt.access(C,z,k.makeArray(U)):X.push(U)),X||[]},dequeue:function(C,z){z=z||"fx";var U=k.queue(C,z),X=U.length,ft=U.shift(),mt=k._queueHooks(C,z),Tt=function(){k.dequeue(C,z)};ft==="inprogress"&&(ft=U.shift(),X--),ft&&(z==="fx"&&U.unshift("inprogress"),delete mt.stop,ft.call(C,Tt,mt)),!X&&mt&&mt.empty.fire()},_queueHooks:function(C,z){var U=z+"queueHooks";return gt.get(C,U)||gt.access(C,U,{empty:k.Callbacks("once memory").add(function(){gt.remove(C,[z+"queue",U])})})}}),k.fn.extend({queue:function(C,z){var U=2;return typeof C!="string"&&(z=C,C="fx",U--),arguments.length<U?k.queue(this[0],C):z===void 0?this:this.each(function(){var X=k.queue(this,C,z);k._queueHooks(this,C),C==="fx"&&X[0]!=="inprogress"&&k.dequeue(this,C)})},dequeue:function(C){return this.each(function(){k.dequeue(this,C)})},clearQueue:function(C){return this.queue(C||"fx",[])},promise:function(C,z){var U,X=1,ft=k.Deferred(),mt=this,Tt=this.length,ce=function(){--X||ft.resolveWith(mt,[mt])};for(typeof C!="string"&&(z=C,C=void 0),C=C||"fx";Tt--;)U=gt.get(mt[Tt],C+"queueHooks"),U&&U.empty&&(X++,U.empty.add(ce));return ce(),ft.promise(z)}});var pe=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,un=new RegExp("^(?:([+-])=|)("+pe+")([a-z%]*)$","i"),Ye=["Top","Right","Bottom","Left"],Ge=J.documentElement,Gn=function(C){return k.contains(C.ownerDocument,C)},_i={composed:!0};Ge.getRootNode&&(Gn=function(C){return k.contains(C.ownerDocument,C)||C.getRootNode(_i)===C.ownerDocument});var ui=function(C,z){return C=z||C,C.style.display==="none"||C.style.display===""&&Gn(C)&&k.css(C,"display")==="none"};function ji(C,z,U,X){var ft,mt,Tt=20,ce=X?function(){return X.cur()}:function(){return k.css(C,z,"")},ee=ce(),Oe=U&&U[3]||(k.cssNumber[z]?"":"px"),Qe=C.nodeType&&(k.cssNumber[z]||Oe!=="px"&&+ee)&&un.exec(k.css(C,z));if(Qe&&Qe[3]!==Oe){for(ee=ee/2,Oe=Oe||Qe[3],Qe=+ee||1;Tt--;)k.style(C,z,Qe+Oe),(1-mt)*(1-(mt=ce()/ee||.5))<=0&&(Tt=0),Qe=Qe/mt;Qe=Qe*2,k.style(C,z,Qe+Oe),U=U||[]}return U&&(Qe=+Qe||+ee||0,ft=U[1]?Qe+(U[1]+1)*U[2]:+U[2],X&&(X.unit=Oe,X.start=Qe,X.end=ft)),ft}var Hi={};function vr(C){var z,U=C.ownerDocument,X=C.nodeName,ft=Hi[X];return ft||(z=U.body.appendChild(U.createElement(X)),ft=k.css(z,"display"),z.parentNode.removeChild(z),ft==="none"&&(ft="block"),Hi[X]=ft,ft)}function Jr(C,z){for(var U,X,ft=[],mt=0,Tt=C.length;mt<Tt;mt++)X=C[mt],X.style&&(U=X.style.display,z?(U==="none"&&(ft[mt]=gt.get(X,"display")||null,ft[mt]||(X.style.display="")),X.style.display===""&&ui(X)&&(ft[mt]=vr(X))):U!=="none"&&(ft[mt]="none",gt.set(X,"display",U)));for(mt=0;mt<Tt;mt++)ft[mt]!=null&&(C[mt].style.display=ft[mt]);return C}k.fn.extend({show:function(){return Jr(this,!0)},hide:function(){return Jr(this)},toggle:function(C){return typeof C=="boolean"?C?this.show():this.hide():this.each(function(){ui(this)?k(this).show():k(this).hide()})}});var $i=/^(?:checkbox|radio)$/i,uo=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Go=/^$|^module$|\/(?:java|ecma)script/i;(function(){var C=J.createDocumentFragment(),z=C.appendChild(J.createElement("div")),U=J.createElement("input");U.setAttribute("type","radio"),U.setAttribute("checked","checked"),U.setAttribute("name","t"),z.appendChild(U),K.checkClone=z.cloneNode(!0).cloneNode(!0).lastChild.checked,z.innerHTML="<textarea>x</textarea>",K.noCloneChecked=!!z.cloneNode(!0).lastChild.defaultValue,z.innerHTML="<option></option>",K.option=!!z.lastChild})();var Ir={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ir.tbody=Ir.tfoot=Ir.colgroup=Ir.caption=Ir.thead,Ir.th=Ir.td,K.option||(Ir.optgroup=Ir.option=[1,"<select multiple='multiple'>","</select>"]);function Ar(C,z){var U;return typeof C.getElementsByTagName<"u"?U=C.getElementsByTagName(z||"*"):typeof C.querySelectorAll<"u"?U=C.querySelectorAll(z||"*"):U=[],z===void 0||z&&Et(C,z)?k.merge([C],U):U}function Ro(C,z){for(var U=0,X=C.length;U<X;U++)gt.set(C[U],"globalEval",!z||gt.get(z[U],"globalEval"))}var Qo=/<|&#?\w+;/;function _s(C,z,U,X,ft){for(var mt,Tt,ce,ee,Oe,Qe,pn=z.createDocumentFragment(),qe=[],an=0,Fn=C.length;an<Fn;an++)if(mt=C[an],mt||mt===0)if(Ct(mt)==="object")k.merge(qe,mt.nodeType?[mt]:mt);else if(!Qo.test(mt))qe.push(z.createTextNode(mt));else{for(Tt=Tt||pn.appendChild(z.createElement("div")),ce=(uo.exec(mt)||["",""])[1].toLowerCase(),ee=Ir[ce]||Ir._default,Tt.innerHTML=ee[1]+k.htmlPrefilter(mt)+ee[2],Qe=ee[0];Qe--;)Tt=Tt.lastChild;k.merge(qe,Tt.childNodes),Tt=pn.firstChild,Tt.textContent=""}for(pn.textContent="",an=0;mt=qe[an++];){if(X&&k.inArray(mt,X)>-1){ft&&ft.push(mt);continue}if(Oe=Gn(mt),Tt=Ar(pn.appendChild(mt),"script"),Oe&&Ro(Tt),U)for(Qe=0;mt=Tt[Qe++];)Go.test(mt.type||"")&&U.push(mt)}return pn}var bo=/^([^.]*)(?:\.(.+)|)/;function co(){return!0}function io(){return!1}function Ta(C,z){return C===Wa()==(z==="focus")}function Wa(){try{return J.activeElement}catch{}}function Sa(C,z,U,X,ft,mt){var Tt,ce;if(typeof z=="object"){typeof U!="string"&&(X=X||U,U=void 0);for(ce in z)Sa(C,ce,U,X,z[ce],mt);return C}if(X==null&&ft==null?(ft=U,X=U=void 0):ft==null&&(typeof U=="string"?(ft=X,X=void 0):(ft=X,X=U,U=void 0)),ft===!1)ft=io;else if(!ft)return C;return mt===1&&(Tt=ft,ft=function(ee){return k().off(ee),Tt.apply(this,arguments)},ft.guid=Tt.guid||(Tt.guid=k.guid++)),C.each(function(){k.event.add(this,z,ft,X,U)})}k.event={global:{},add:function(C,z,U,X,ft){var mt,Tt,ce,ee,Oe,Qe,pn,qe,an,Fn,Ui,ei=gt.get(C);if(R(C))for(U.handler&&(mt=U,U=mt.handler,ft=mt.selector),ft&&k.find.matchesSelector(Ge,ft),U.guid||(U.guid=k.guid++),(ee=ei.events)||(ee=ei.events=Object.create(null)),(Tt=ei.handle)||(Tt=ei.handle=function(To){return typeof k<"u"&&k.event.triggered!==To.type?k.event.dispatch.apply(C,arguments):void 0}),z=(z||"").match(ue)||[""],Oe=z.length;Oe--;)ce=bo.exec(z[Oe])||[],an=Ui=ce[1],Fn=(ce[2]||"").split(".").sort(),an&&(pn=k.event.special[an]||{},an=(ft?pn.delegateType:pn.bindType)||an,pn=k.event.special[an]||{},Qe=k.extend({type:an,origType:Ui,data:X,handler:U,guid:U.guid,selector:ft,needsContext:ft&&k.expr.match.needsContext.test(ft),namespace:Fn.join(".")},mt),(qe=ee[an])||(qe=ee[an]=[],qe.delegateCount=0,(!pn.setup||pn.setup.call(C,X,Fn,Tt)===!1)&&C.addEventListener&&C.addEventListener(an,Tt)),pn.add&&(pn.add.call(C,Qe),Qe.handler.guid||(Qe.handler.guid=U.guid)),ft?qe.splice(qe.delegateCount++,0,Qe):qe.push(Qe),k.event.global[an]=!0)},remove:function(C,z,U,X,ft){var mt,Tt,ce,ee,Oe,Qe,pn,qe,an,Fn,Ui,ei=gt.hasData(C)&&gt.get(C);if(!(!ei||!(ee=ei.events))){for(z=(z||"").match(ue)||[""],Oe=z.length;Oe--;){if(ce=bo.exec(z[Oe])||[],an=Ui=ce[1],Fn=(ce[2]||"").split(".").sort(),!an){for(an in ee)k.event.remove(C,an+z[Oe],U,X,!0);continue}for(pn=k.event.special[an]||{},an=(X?pn.delegateType:pn.bindType)||an,qe=ee[an]||[],ce=ce[2]&&new RegExp("(^|\\.)"+Fn.join("\\.(?:.*\\.|)")+"(\\.|$)"),Tt=mt=qe.length;mt--;)Qe=qe[mt],(ft||Ui===Qe.origType)&&(!U||U.guid===Qe.guid)&&(!ce||ce.test(Qe.namespace))&&(!X||X===Qe.selector||X==="**"&&Qe.selector)&&(qe.splice(mt,1),Qe.selector&&qe.delegateCount--,pn.remove&&pn.remove.call(C,Qe));Tt&&!qe.length&&((!pn.teardown||pn.teardown.call(C,Fn,ei.handle)===!1)&&k.removeEvent(C,an,ei.handle),delete ee[an])}k.isEmptyObject(ee)&&gt.remove(C,"handle events")}},dispatch:function(C){var z,U,X,ft,mt,Tt,ce=new Array(arguments.length),ee=k.event.fix(C),Oe=(gt.get(this,"events")||Object.create(null))[ee.type]||[],Qe=k.event.special[ee.type]||{};for(ce[0]=ee,z=1;z<arguments.length;z++)ce[z]=arguments[z];if(ee.delegateTarget=this,!(Qe.preDispatch&&Qe.preDispatch.call(this,ee)===!1)){for(Tt=k.event.handlers.call(this,ee,Oe),z=0;(ft=Tt[z++])&&!ee.isPropagationStopped();)for(ee.currentTarget=ft.elem,U=0;(mt=ft.handlers[U++])&&!ee.isImmediatePropagationStopped();)(!ee.rnamespace||mt.namespace===!1||ee.rnamespace.test(mt.namespace))&&(ee.handleObj=mt,ee.data=mt.data,X=((k.event.special[mt.origType]||{}).handle||mt.handler).apply(ft.elem,ce),X!==void 0&&(ee.result=X)===!1&&(ee.preventDefault(),ee.stopPropagation()));return Qe.postDispatch&&Qe.postDispatch.call(this,ee),ee.result}},handlers:function(C,z){var U,X,ft,mt,Tt,ce=[],ee=z.delegateCount,Oe=C.target;if(ee&&Oe.nodeType&&!(C.type==="click"&&C.button>=1)){for(;Oe!==this;Oe=Oe.parentNode||this)if(Oe.nodeType===1&&!(C.type==="click"&&Oe.disabled===!0)){for(mt=[],Tt={},U=0;U<ee;U++)X=z[U],ft=X.selector+" ",Tt[ft]===void 0&&(Tt[ft]=X.needsContext?k(ft,this).index(Oe)>-1:k.find(ft,this,null,[Oe]).length),Tt[ft]&&mt.push(X);mt.length&&ce.push({elem:Oe,handlers:mt})}}return Oe=this,ee<z.length&&ce.push({elem:Oe,handlers:z.slice(ee)}),ce},addProp:function(C,z){Object.defineProperty(k.Event.prototype,C,{enumerable:!0,configurable:!0,get:q(z)?function(){if(this.originalEvent)return z(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[C]},set:function(U){Object.defineProperty(this,C,{enumerable:!0,configurable:!0,writable:!0,value:U})}})},fix:function(C){return C[k.expando]?C:new k.Event(C)},special:{load:{noBubble:!0},click:{setup:function(C){var z=this||C;return $i.test(z.type)&&z.click&&Et(z,"input")&&ts(z,"click",co),!1},trigger:function(C){var z=this||C;return $i.test(z.type)&&z.click&&Et(z,"input")&&ts(z,"click"),!0},_default:function(C){var z=C.target;return $i.test(z.type)&&z.click&&Et(z,"input")&&gt.get(z,"click")||Et(z,"a")}},beforeunload:{postDispatch:function(C){C.result!==void 0&&C.originalEvent&&(C.originalEvent.returnValue=C.result)}}}};function ts(C,z,U){if(!U){gt.get(C,z)===void 0&&k.event.add(C,z,co);return}gt.set(C,z,!1),k.event.add(C,z,{namespace:!1,handler:function(X){var ft,mt,Tt=gt.get(this,z);if(X.isTrigger&1&&this[z]){if(Tt.length)(k.event.special[z]||{}).delegateType&&X.stopPropagation();else if(Tt=c.call(arguments),gt.set(this,z,Tt),ft=U(this,z),this[z](),mt=gt.get(this,z),Tt!==mt||ft?gt.set(this,z,!1):mt={},Tt!==mt)return X.stopImmediatePropagation(),X.preventDefault(),mt&&mt.value}else Tt.length&&(gt.set(this,z,{value:k.event.trigger(k.extend(Tt[0],k.Event.prototype),Tt.slice(1),this)}),X.stopImmediatePropagation())}})}k.removeEvent=function(C,z,U){C.removeEventListener&&C.removeEventListener(z,U)},k.Event=function(C,z){if(!(this instanceof k.Event))return new k.Event(C,z);C&&C.type?(this.originalEvent=C,this.type=C.type,this.isDefaultPrevented=C.defaultPrevented||C.defaultPrevented===void 0&&C.returnValue===!1?co:io,this.target=C.target&&C.target.nodeType===3?C.target.parentNode:C.target,this.currentTarget=C.currentTarget,this.relatedTarget=C.relatedTarget):this.type=C,z&&k.extend(this,z),this.timeStamp=C&&C.timeStamp||Date.now(),this[k.expando]=!0},k.Event.prototype={constructor:k.Event,isDefaultPrevented:io,isPropagationStopped:io,isImmediatePropagationStopped:io,isSimulated:!1,preventDefault:function(){var C=this.originalEvent;this.isDefaultPrevented=co,C&&!this.isSimulated&&C.preventDefault()},stopPropagation:function(){var C=this.originalEvent;this.isPropagationStopped=co,C&&!this.isSimulated&&C.stopPropagation()},stopImmediatePropagation:function(){var C=this.originalEvent;this.isImmediatePropagationStopped=co,C&&!this.isSimulated&&C.stopImmediatePropagation(),this.stopPropagation()}},k.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},k.event.addProp),k.each({focus:"focusin",blur:"focusout"},function(C,z){k.event.special[C]={setup:function(){return ts(this,C,Ta),!1},trigger:function(){return ts(this,C),!0},_default:function(U){return gt.get(U.target,C)},delegateType:z}}),k.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(C,z){k.event.special[C]={delegateType:z,bindType:z,handle:function(U){var X,ft=this,mt=U.relatedTarget,Tt=U.handleObj;return(!mt||mt!==ft&&!k.contains(ft,mt))&&(U.type=Tt.origType,X=Tt.handler.apply(this,arguments),U.type=z),X}}}),k.fn.extend({on:function(C,z,U,X){return Sa(this,C,z,U,X)},one:function(C,z,U,X){return Sa(this,C,z,U,X,1)},off:function(C,z,U){var X,ft;if(C&&C.preventDefault&&C.handleObj)return X=C.handleObj,k(C.delegateTarget).off(X.namespace?X.origType+"."+X.namespace:X.origType,X.selector,X.handler),this;if(typeof C=="object"){for(ft in C)this.off(ft,z,C[ft]);return this}return(z===!1||typeof z=="function")&&(U=z,z=void 0),U===!1&&(U=io),this.each(function(){k.event.remove(this,C,U,z)})}});var js=/<script|<style|<link/i,Ea=/checked\s*(?:[^=]|=\s*.checked.)/i,Vt=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function pt(C,z){return Et(C,"table")&&Et(z.nodeType!==11?z:z.firstChild,"tr")&&k(C).children("tbody")[0]||C}function It(C){return C.type=(C.getAttribute("type")!==null)+"/"+C.type,C}function Ut(C){return(C.type||"").slice(0,5)==="true/"?C.type=C.type.slice(5):C.removeAttribute("type"),C}function qt(C,z){var U,X,ft,mt,Tt,ce,ee;if(z.nodeType===1){if(gt.hasData(C)&&(mt=gt.get(C),ee=mt.events,ee)){gt.remove(z,"handle events");for(ft in ee)for(U=0,X=ee[ft].length;U<X;U++)k.event.add(z,ft,ee[ft][U])}dt.hasData(C)&&(Tt=dt.access(C),ce=k.extend({},Tt),dt.set(z,ce))}}function Ht(C,z){var U=z.nodeName.toLowerCase();U==="input"&&$i.test(C.type)?z.checked=C.checked:(U==="input"||U==="textarea")&&(z.defaultValue=C.defaultValue)}function Pe(C,z,U,X){z=p(z);var ft,mt,Tt,ce,ee,Oe,Qe=0,pn=C.length,qe=pn-1,an=z[0],Fn=q(an);if(Fn||pn>1&&typeof an=="string"&&!K.checkClone&&Ea.test(an))return C.each(function(Ui){var ei=C.eq(Ui);Fn&&(z[0]=an.call(this,Ui,ei.html())),Pe(ei,z,U,X)});if(pn&&(ft=_s(z,C[0].ownerDocument,!1,C,X),mt=ft.firstChild,ft.childNodes.length===1&&(ft=mt),mt||X)){for(Tt=k.map(Ar(ft,"script"),It),ce=Tt.length;Qe<pn;Qe++)ee=ft,Qe!==qe&&(ee=k.clone(ee,!0,!0),ce&&k.merge(Tt,Ar(ee,"script"))),U.call(C[Qe],ee,Qe);if(ce)for(Oe=Tt[Tt.length-1].ownerDocument,k.map(Tt,Ut),Qe=0;Qe<ce;Qe++)ee=Tt[Qe],Go.test(ee.type||"")&&!gt.access(ee,"globalEval")&&k.contains(Oe,ee)&&(ee.src&&(ee.type||"").toLowerCase()!=="module"?k._evalUrl&&!ee.noModule&&k._evalUrl(ee.src,{nonce:ee.nonce||ee.getAttribute("nonce")},Oe):lt(ee.textContent.replace(Vt,""),ee,Oe))}return C}function Se(C,z,U){for(var X,ft=z?k.filter(z,C):C,mt=0;(X=ft[mt])!=null;mt++)!U&&X.nodeType===1&&k.cleanData(Ar(X)),X.parentNode&&(U&&Gn(X)&&Ro(Ar(X,"script")),X.parentNode.removeChild(X));return C}k.extend({htmlPrefilter:function(C){return C},clone:function(C,z,U){var X,ft,mt,Tt,ce=C.cloneNode(!0),ee=Gn(C);if(!K.noCloneChecked&&(C.nodeType===1||C.nodeType===11)&&!k.isXMLDoc(C))for(Tt=Ar(ce),mt=Ar(C),X=0,ft=mt.length;X<ft;X++)Ht(mt[X],Tt[X]);if(z)if(U)for(mt=mt||Ar(C),Tt=Tt||Ar(ce),X=0,ft=mt.length;X<ft;X++)qt(mt[X],Tt[X]);else qt(C,ce);return Tt=Ar(ce,"script"),Tt.length>0&&Ro(Tt,!ee&&Ar(C,"script")),ce},cleanData:function(C){for(var z,U,X,ft=k.event.special,mt=0;(U=C[mt])!==void 0;mt++)if(R(U)){if(z=U[gt.expando]){if(z.events)for(X in z.events)ft[X]?k.event.remove(U,X):k.removeEvent(U,X,z.handle);U[gt.expando]=void 0}U[dt.expando]&&(U[dt.expando]=void 0)}}}),k.fn.extend({detach:function(C){return Se(this,C,!0)},remove:function(C){return Se(this,C)},text:function(C){return Cn(this,function(z){return z===void 0?k.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=z)})},null,C,arguments.length)},append:function(){return Pe(this,arguments,function(C){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var z=pt(this,C);z.appendChild(C)}})},prepend:function(){return Pe(this,arguments,function(C){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var z=pt(this,C);z.insertBefore(C,z.firstChild)}})},before:function(){return Pe(this,arguments,function(C){this.parentNode&&this.parentNode.insertBefore(C,this)})},after:function(){return Pe(this,arguments,function(C){this.parentNode&&this.parentNode.insertBefore(C,this.nextSibling)})},empty:function(){for(var C,z=0;(C=this[z])!=null;z++)C.nodeType===1&&(k.cleanData(Ar(C,!1)),C.textContent="");return this},clone:function(C,z){return C=C??!1,z=z??C,this.map(function(){return k.clone(this,C,z)})},html:function(C){return Cn(this,function(z){var U=this[0]||{},X=0,ft=this.length;if(z===void 0&&U.nodeType===1)return U.innerHTML;if(typeof z=="string"&&!js.test(z)&&!Ir[(uo.exec(z)||["",""])[1].toLowerCase()]){z=k.htmlPrefilter(z);try{for(;X<ft;X++)U=this[X]||{},U.nodeType===1&&(k.cleanData(Ar(U,!1)),U.innerHTML=z);U=0}catch{}}U&&this.empty().append(z)},null,C,arguments.length)},replaceWith:function(){var C=[];return Pe(this,arguments,function(z){var U=this.parentNode;k.inArray(this,C)<0&&(k.cleanData(Ar(this)),U&&U.replaceChild(z,this))},C)}}),k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(C,z){k.fn[C]=function(U){for(var X,ft=[],mt=k(U),Tt=mt.length-1,ce=0;ce<=Tt;ce++)X=ce===Tt?this:this.clone(!0),k(mt[ce])[z](X),r.apply(ft,X.get());return this.pushStack(ft)}});var xe=new RegExp("^("+pe+")(?!px)[a-z%]+$","i"),Re=/^--/,hn=function(C){var z=C.ownerDocument.defaultView;return(!z||!z.opener)&&(z=e),z.getComputedStyle(C)},Zn=function(C,z,U){var X,ft,mt={};for(ft in z)mt[ft]=C.style[ft],C.style[ft]=z[ft];X=U.call(C);for(ft in z)C.style[ft]=mt[ft];return X},bn=new RegExp(Ye.join("|"),"i"),ci="[\\x20\\t\\r\\n\\f]",hi=new RegExp("^"+ci+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ci+"+$","g");(function(){function C(){if(Oe){ee.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Oe.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Ge.appendChild(ee).appendChild(Oe);var Qe=e.getComputedStyle(Oe);U=Qe.top!=="1%",ce=z(Qe.marginLeft)===12,Oe.style.right="60%",mt=z(Qe.right)===36,X=z(Qe.width)===36,Oe.style.position="absolute",ft=z(Oe.offsetWidth/3)===12,Ge.removeChild(ee),Oe=null}}function z(Qe){return Math.round(parseFloat(Qe))}var U,X,ft,mt,Tt,ce,ee=J.createElement("div"),Oe=J.createElement("div");Oe.style&&(Oe.style.backgroundClip="content-box",Oe.cloneNode(!0).style.backgroundClip="",K.clearCloneStyle=Oe.style.backgroundClip==="content-box",k.extend(K,{boxSizingReliable:function(){return C(),X},pixelBoxStyles:function(){return C(),mt},pixelPosition:function(){return C(),U},reliableMarginLeft:function(){return C(),ce},scrollboxSize:function(){return C(),ft},reliableTrDimensions:function(){var Qe,pn,qe,an;return Tt==null&&(Qe=J.createElement("table"),pn=J.createElement("tr"),qe=J.createElement("div"),Qe.style.cssText="position:absolute;left:-11111px;border-collapse:separate",pn.style.cssText="border:1px solid",pn.style.height="1px",qe.style.height="9px",qe.style.display="block",Ge.appendChild(Qe).appendChild(pn).appendChild(qe),an=e.getComputedStyle(pn),Tt=parseInt(an.height,10)+parseInt(an.borderTopWidth,10)+parseInt(an.borderBottomWidth,10)===pn.offsetHeight,Ge.removeChild(Qe)),Tt}}))})();function Qn(C,z,U){var X,ft,mt,Tt,ce=Re.test(z),ee=C.style;return U=U||hn(C),U&&(Tt=U.getPropertyValue(z)||U[z],ce&&Tt&&(Tt=Tt.replace(hi,"$1")||void 0),Tt===""&&!Gn(C)&&(Tt=k.style(C,z)),!K.pixelBoxStyles()&&xe.test(Tt)&&bn.test(z)&&(X=ee.width,ft=ee.minWidth,mt=ee.maxWidth,ee.minWidth=ee.maxWidth=ee.width=Tt,Tt=U.width,ee.width=X,ee.minWidth=ft,ee.maxWidth=mt)),Tt!==void 0?Tt+"":Tt}function pi(C,z){return{get:function(){if(C()){delete this.get;return}return(this.get=z).apply(this,arguments)}}}var qi=["Webkit","Moz","ms"],ur=J.createElement("div").style,ti={};function yr(C){for(var z=C[0].toUpperCase()+C.slice(1),U=qi.length;U--;)if(C=qi[U]+z,C in ur)return C}function xr(C){var z=k.cssProps[C]||ti[C];return z||(C in ur?C:ti[C]=yr(C)||C)}var Js=/^(none|table(?!-c[ea]).+)/,Ss={position:"absolute",visibility:"hidden",display:"block"},vs={letterSpacing:"0",fontWeight:"400"};function Ke(C,z,U){var X=un.exec(z);return X?Math.max(0,X[2]-(U||0))+(X[3]||"px"):z}function Po(C,z,U,X,ft,mt){var Tt=z==="width"?1:0,ce=0,ee=0;if(U===(X?"border":"content"))return 0;for(;Tt<4;Tt+=2)U==="margin"&&(ee+=k.css(C,U+Ye[Tt],!0,ft)),X?(U==="content"&&(ee-=k.css(C,"padding"+Ye[Tt],!0,ft)),U!=="margin"&&(ee-=k.css(C,"border"+Ye[Tt]+"Width",!0,ft))):(ee+=k.css(C,"padding"+Ye[Tt],!0,ft),U!=="padding"?ee+=k.css(C,"border"+Ye[Tt]+"Width",!0,ft):ce+=k.css(C,"border"+Ye[Tt]+"Width",!0,ft));return!X&&mt>=0&&(ee+=Math.max(0,Math.ceil(C["offset"+z[0].toUpperCase()+z.slice(1)]-mt-ee-ce-.5))||0),ee}function Xr(C,z,U){var X=hn(C),ft=!K.boxSizingReliable()||U,mt=ft&&k.css(C,"boxSizing",!1,X)==="border-box",Tt=mt,ce=Qn(C,z,X),ee="offset"+z[0].toUpperCase()+z.slice(1);if(xe.test(ce)){if(!U)return ce;ce="auto"}return(!K.boxSizingReliable()&&mt||!K.reliableTrDimensions()&&Et(C,"tr")||ce==="auto"||!parseFloat(ce)&&k.css(C,"display",!1,X)==="inline")&&C.getClientRects().length&&(mt=k.css(C,"boxSizing",!1,X)==="border-box",Tt=ee in C,Tt&&(ce=C[ee])),ce=parseFloat(ce)||0,ce+Po(C,z,U||(mt?"border":"content"),Tt,X,ce)+"px"}k.extend({cssHooks:{opacity:{get:function(C,z){if(z){var U=Qn(C,"opacity");return U===""?"1":U}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(C,z,U,X){if(!(!C||C.nodeType===3||C.nodeType===8||!C.style)){var ft,mt,Tt,ce=Un(z),ee=Re.test(z),Oe=C.style;if(ee||(z=xr(ce)),Tt=k.cssHooks[z]||k.cssHooks[ce],U!==void 0){if(mt=typeof U,mt==="string"&&(ft=un.exec(U))&&ft[1]&&(U=ji(C,z,ft),mt="number"),U==null||U!==U)return;mt==="number"&&!ee&&(U+=ft&&ft[3]||(k.cssNumber[ce]?"":"px")),!K.clearCloneStyle&&U===""&&z.indexOf("background")===0&&(Oe[z]="inherit"),(!Tt||!("set"in Tt)||(U=Tt.set(C,U,X))!==void 0)&&(ee?Oe.setProperty(z,U):Oe[z]=U)}else return Tt&&"get"in Tt&&(ft=Tt.get(C,!1,X))!==void 0?ft:Oe[z]}},css:function(C,z,U,X){var ft,mt,Tt,ce=Un(z),ee=Re.test(z);return ee||(z=xr(ce)),Tt=k.cssHooks[z]||k.cssHooks[ce],Tt&&"get"in Tt&&(ft=Tt.get(C,!0,U)),ft===void 0&&(ft=Qn(C,z,X)),ft==="normal"&&z in vs&&(ft=vs[z]),U===""||U?(mt=parseFloat(ft),U===!0||isFinite(mt)?mt||0:ft):ft}}),k.each(["height","width"],function(C,z){k.cssHooks[z]={get:function(U,X,ft){if(X)return Js.test(k.css(U,"display"))&&(!U.getClientRects().length||!U.getBoundingClientRect().width)?Zn(U,Ss,function(){return Xr(U,z,ft)}):Xr(U,z,ft)},set:function(U,X,ft){var mt,Tt=hn(U),ce=!K.scrollboxSize()&&Tt.position==="absolute",ee=ce||ft,Oe=ee&&k.css(U,"boxSizing",!1,Tt)==="border-box",Qe=ft?Po(U,z,ft,Oe,Tt):0;return Oe&&ce&&(Qe-=Math.ceil(U["offset"+z[0].toUpperCase()+z.slice(1)]-parseFloat(Tt[z])-Po(U,z,"border",!1,Tt)-.5)),Qe&&(mt=un.exec(X))&&(mt[3]||"px")!=="px"&&(U.style[z]=X,X=k.css(U,z)),Ke(U,X,Qe)}}}),k.cssHooks.marginLeft=pi(K.reliableMarginLeft,function(C,z){if(z)return(parseFloat(Qn(C,"marginLeft"))||C.getBoundingClientRect().left-Zn(C,{marginLeft:0},function(){return C.getBoundingClientRect().left}))+"px"}),k.each({margin:"",padding:"",border:"Width"},function(C,z){k.cssHooks[C+z]={expand:function(U){for(var X=0,ft={},mt=typeof U=="string"?U.split(" "):[U];X<4;X++)ft[C+Ye[X]+z]=mt[X]||mt[X-2]||mt[0];return ft}},C!=="margin"&&(k.cssHooks[C+z].set=Ke)}),k.fn.extend({css:function(C,z){return Cn(this,function(U,X,ft){var mt,Tt,ce={},ee=0;if(Array.isArray(X)){for(mt=hn(U),Tt=X.length;ee<Tt;ee++)ce[X[ee]]=k.css(U,X[ee],!1,mt);return ce}return ft!==void 0?k.style(U,X,ft):k.css(U,X)},C,z,arguments.length>1)}});function ro(C,z,U,X,ft){return new ro.prototype.init(C,z,U,X,ft)}k.Tween=ro,ro.prototype={constructor:ro,init:function(C,z,U,X,ft,mt){this.elem=C,this.prop=U,this.easing=ft||k.easing._default,this.options=z,this.start=this.now=this.cur(),this.end=X,this.unit=mt||(k.cssNumber[U]?"":"px")},cur:function(){var C=ro.propHooks[this.prop];return C&&C.get?C.get(this):ro.propHooks._default.get(this)},run:function(C){var z,U=ro.propHooks[this.prop];return this.options.duration?this.pos=z=k.easing[this.easing](C,this.options.duration*C,0,1,this.options.duration):this.pos=z=C,this.now=(this.end-this.start)*z+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),U&&U.set?U.set(this):ro.propHooks._default.set(this),this}},ro.prototype.init.prototype=ro.prototype,ro.propHooks={_default:{get:function(C){var z;return C.elem.nodeType!==1||C.elem[C.prop]!=null&&C.elem.style[C.prop]==null?C.elem[C.prop]:(z=k.css(C.elem,C.prop,""),!z||z==="auto"?0:z)},set:function(C){k.fx.step[C.prop]?k.fx.step[C.prop](C):C.elem.nodeType===1&&(k.cssHooks[C.prop]||C.elem.style[xr(C.prop)]!=null)?k.style(C.elem,C.prop,C.now+C.unit):C.elem[C.prop]=C.now}}},ro.propHooks.scrollTop=ro.propHooks.scrollLeft={set:function(C){C.elem.nodeType&&C.elem.parentNode&&(C.elem[C.prop]=C.now)}},k.easing={linear:function(C){return C},swing:function(C){return .5-Math.cos(C*Math.PI)/2},_default:"swing"},k.fx=ro.prototype.init,k.fx.step={};var hl,Io,cr=/^(?:toggle|show|hide)$/,Kr=/queueHooks$/;function Co(){Io&&(J.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(Co):e.setTimeout(Co,k.fx.interval),k.fx.tick())}function jn(){return e.setTimeout(function(){hl=void 0}),hl=Date.now()}function Ti(C,z){var U,X=0,ft={height:C};for(z=z?1:0;X<4;X+=2-z)U=Ye[X],ft["margin"+U]=ft["padding"+U]=C;return z&&(ft.opacity=ft.width=C),ft}function Oi(C,z,U){for(var X,ft=(vi.tweeners[z]||[]).concat(vi.tweeners["*"]),mt=0,Tt=ft.length;mt<Tt;mt++)if(X=ft[mt].call(U,z,C))return X}function Si(C,z,U){var X,ft,mt,Tt,ce,ee,Oe,Qe,pn="width"in z||"height"in z,qe=this,an={},Fn=C.style,Ui=C.nodeType&&ui(C),ei=gt.get(C,"fxshow");U.queue||(Tt=k._queueHooks(C,"fx"),Tt.unqueued==null&&(Tt.unqueued=0,ce=Tt.empty.fire,Tt.empty.fire=function(){Tt.unqueued||ce()}),Tt.unqueued++,qe.always(function(){qe.always(function(){Tt.unqueued--,k.queue(C,"fx").length||Tt.empty.fire()})}));for(X in z)if(ft=z[X],cr.test(ft)){if(delete z[X],mt=mt||ft==="toggle",ft===(Ui?"hide":"show"))if(ft==="show"&&ei&&ei[X]!==void 0)Ui=!0;else continue;an[X]=ei&&ei[X]||k.style(C,X)}if(ee=!k.isEmptyObject(z),!(!ee&&k.isEmptyObject(an))){pn&&C.nodeType===1&&(U.overflow=[Fn.overflow,Fn.overflowX,Fn.overflowY],Oe=ei&&ei.display,Oe==null&&(Oe=gt.get(C,"display")),Qe=k.css(C,"display"),Qe==="none"&&(Oe?Qe=Oe:(Jr([C],!0),Oe=C.style.display||Oe,Qe=k.css(C,"display"),Jr([C]))),(Qe==="inline"||Qe==="inline-block"&&Oe!=null)&&k.css(C,"float")==="none"&&(ee||(qe.done(function(){Fn.display=Oe}),Oe==null&&(Qe=Fn.display,Oe=Qe==="none"?"":Qe)),Fn.display="inline-block")),U.overflow&&(Fn.overflow="hidden",qe.always(function(){Fn.overflow=U.overflow[0],Fn.overflowX=U.overflow[1],Fn.overflowY=U.overflow[2]})),ee=!1;for(X in an)ee||(ei?"hidden"in ei&&(Ui=ei.hidden):ei=gt.access(C,"fxshow",{display:Oe}),mt&&(ei.hidden=!Ui),Ui&&Jr([C],!0),qe.done(function(){Ui||Jr([C]),gt.remove(C,"fxshow");for(X in an)k.style(C,X,an[X])})),ee=Oi(Ui?ei[X]:0,X,qe),X in ei||(ei[X]=ee.start,Ui&&(ee.end=ee.start,ee.start=0))}}function Tr(C,z){var U,X,ft,mt,Tt;for(U in C)if(X=Un(U),ft=z[X],mt=C[U],Array.isArray(mt)&&(ft=mt[1],mt=C[U]=mt[0]),U!==X&&(C[X]=mt,delete C[U]),Tt=k.cssHooks[X],Tt&&"expand"in Tt){mt=Tt.expand(mt),delete C[X];for(U in mt)U in C||(C[U]=mt[U],z[U]=ft)}else z[X]=ft}function vi(C,z,U){var X,ft,mt=0,Tt=vi.prefilters.length,ce=k.Deferred().always(function(){delete ee.elem}),ee=function(){if(ft)return!1;for(var pn=hl||jn(),qe=Math.max(0,Oe.startTime+Oe.duration-pn),an=qe/Oe.duration||0,Fn=1-an,Ui=0,ei=Oe.tweens.length;Ui<ei;Ui++)Oe.tweens[Ui].run(Fn);return ce.notifyWith(C,[Oe,Fn,qe]),Fn<1&&ei?qe:(ei||ce.notifyWith(C,[Oe,1,0]),ce.resolveWith(C,[Oe]),!1)},Oe=ce.promise({elem:C,props:k.extend({},z),opts:k.extend(!0,{specialEasing:{},easing:k.easing._default},U),originalProperties:z,originalOptions:U,startTime:hl||jn(),duration:U.duration,tweens:[],createTween:function(pn,qe){var an=k.Tween(C,Oe.opts,pn,qe,Oe.opts.specialEasing[pn]||Oe.opts.easing);return Oe.tweens.push(an),an},stop:function(pn){var qe=0,an=pn?Oe.tweens.length:0;if(ft)return this;for(ft=!0;qe<an;qe++)Oe.tweens[qe].run(1);return pn?(ce.notifyWith(C,[Oe,1,0]),ce.resolveWith(C,[Oe,pn])):ce.rejectWith(C,[Oe,pn]),this}}),Qe=Oe.props;for(Tr(Qe,Oe.opts.specialEasing);mt<Tt;mt++)if(X=vi.prefilters[mt].call(Oe,C,Qe,Oe.opts),X)return q(X.stop)&&(k._queueHooks(Oe.elem,Oe.opts.queue).stop=X.stop.bind(X)),X;return k.map(Qe,Oi,Oe),q(Oe.opts.start)&&Oe.opts.start.call(C,Oe),Oe.progress(Oe.opts.progress).done(Oe.opts.done,Oe.opts.complete).fail(Oe.opts.fail).always(Oe.opts.always),k.fx.timer(k.extend(ee,{elem:C,anim:Oe,queue:Oe.opts.queue})),Oe}k.Animation=k.extend(vi,{tweeners:{"*":[function(C,z){var U=this.createTween(C,z);return ji(U.elem,C,un.exec(z),U),U}]},tweener:function(C,z){q(C)?(z=C,C=["*"]):C=C.match(ue);for(var U,X=0,ft=C.length;X<ft;X++)U=C[X],vi.tweeners[U]=vi.tweeners[U]||[],vi.tweeners[U].unshift(z)},prefilters:[Si],prefilter:function(C,z){z?vi.prefilters.unshift(C):vi.prefilters.push(C)}}),k.speed=function(C,z,U){var X=C&&typeof C=="object"?k.extend({},C):{complete:U||!U&&z||q(C)&&C,duration:C,easing:U&&z||z&&!q(z)&&z};return k.fx.off?X.duration=0:typeof X.duration!="number"&&(X.duration in k.fx.speeds?X.duration=k.fx.speeds[X.duration]:X.duration=k.fx.speeds._default),(X.queue==null||X.queue===!0)&&(X.queue="fx"),X.old=X.complete,X.complete=function(){q(X.old)&&X.old.call(this),X.queue&&k.dequeue(this,X.queue)},X},k.fn.extend({fadeTo:function(C,z,U,X){return this.filter(ui).css("opacity",0).show().end().animate({opacity:z},C,U,X)},animate:function(C,z,U,X){var ft=k.isEmptyObject(C),mt=k.speed(z,U,X),Tt=function(){var ce=vi(this,k.extend({},C),mt);(ft||gt.get(this,"finish"))&&ce.stop(!0)};return Tt.finish=Tt,ft||mt.queue===!1?this.each(Tt):this.queue(mt.queue,Tt)},stop:function(C,z,U){var X=function(ft){var mt=ft.stop;delete ft.stop,mt(U)};return typeof C!="string"&&(U=z,z=C,C=void 0),z&&this.queue(C||"fx",[]),this.each(function(){var ft=!0,mt=C!=null&&C+"queueHooks",Tt=k.timers,ce=gt.get(this);if(mt)ce[mt]&&ce[mt].stop&&X(ce[mt]);else for(mt in ce)ce[mt]&&ce[mt].stop&&Kr.test(mt)&&X(ce[mt]);for(mt=Tt.length;mt--;)Tt[mt].elem===this&&(C==null||Tt[mt].queue===C)&&(Tt[mt].anim.stop(U),ft=!1,Tt.splice(mt,1));(ft||!U)&&k.dequeue(this,C)})},finish:function(C){return C!==!1&&(C=C||"fx"),this.each(function(){var z,U=gt.get(this),X=U[C+"queue"],ft=U[C+"queueHooks"],mt=k.timers,Tt=X?X.length:0;for(U.finish=!0,k.queue(this,C,[]),ft&&ft.stop&&ft.stop.call(this,!0),z=mt.length;z--;)mt[z].elem===this&&mt[z].queue===C&&(mt[z].anim.stop(!0),mt.splice(z,1));for(z=0;z<Tt;z++)X[z]&&X[z].finish&&X[z].finish.call(this);delete U.finish})}}),k.each(["toggle","show","hide"],function(C,z){var U=k.fn[z];k.fn[z]=function(X,ft,mt){return X==null||typeof X=="boolean"?U.apply(this,arguments):this.animate(Ti(z,!0),X,ft,mt)}}),k.each({slideDown:Ti("show"),slideUp:Ti("hide"),slideToggle:Ti("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(C,z){k.fn[C]=function(U,X,ft){return this.animate(z,U,X,ft)}}),k.timers=[],k.fx.tick=function(){var C,z=0,U=k.timers;for(hl=Date.now();z<U.length;z++)C=U[z],!C()&&U[z]===C&&U.splice(z--,1);U.length||k.fx.stop(),hl=void 0},k.fx.timer=function(C){k.timers.push(C),k.fx.start()},k.fx.interval=13,k.fx.start=function(){Io||(Io=!0,Co())},k.fx.stop=function(){Io=null},k.fx.speeds={slow:600,fast:200,_default:400},k.fn.delay=function(C,z){return C=k.fx&&k.fx.speeds[C]||C,z=z||"fx",this.queue(z,function(U,X){var ft=e.setTimeout(U,C);X.stop=function(){e.clearTimeout(ft)}})},function(){var C=J.createElement("input"),z=J.createElement("select"),U=z.appendChild(J.createElement("option"));C.type="checkbox",K.checkOn=C.value!=="",K.optSelected=U.selected,C=J.createElement("input"),C.value="t",C.type="radio",K.radioValue=C.value==="t"}();var Ma,oo=k.expr.attrHandle;k.fn.extend({attr:function(C,z){return Cn(this,k.attr,C,z,arguments.length>1)},removeAttr:function(C){return this.each(function(){k.removeAttr(this,C)})}}),k.extend({attr:function(C,z,U){var X,ft,mt=C.nodeType;if(!(mt===3||mt===8||mt===2)){if(typeof C.getAttribute>"u")return k.prop(C,z,U);if((mt!==1||!k.isXMLDoc(C))&&(ft=k.attrHooks[z.toLowerCase()]||(k.expr.match.bool.test(z)?Ma:void 0)),U!==void 0){if(U===null){k.removeAttr(C,z);return}return ft&&"set"in ft&&(X=ft.set(C,U,z))!==void 0?X:(C.setAttribute(z,U+""),U)}return ft&&"get"in ft&&(X=ft.get(C,z))!==null?X:(X=k.find.attr(C,z),X??void 0)}},attrHooks:{type:{set:function(C,z){if(!K.radioValue&&z==="radio"&&Et(C,"input")){var U=C.value;return C.setAttribute("type",z),U&&(C.value=U),z}}}},removeAttr:function(C,z){var U,X=0,ft=z&&z.match(ue);if(ft&&C.nodeType===1)for(;U=ft[X++];)C.removeAttribute(U)}}),Ma={set:function(C,z,U){return z===!1?k.removeAttr(C,U):C.setAttribute(U,U),U}},k.each(k.expr.match.bool.source.match(/\w+/g),function(C,z){var U=oo[z]||k.find.attr;oo[z]=function(X,ft,mt){var Tt,ce,ee=ft.toLowerCase();return mt||(ce=oo[ee],oo[ee]=Tt,Tt=U(X,ft,mt)!=null?ee:null,oo[ee]=ce),Tt}});var Yo=/^(?:input|select|textarea|button)$/i,Nr=/^(?:a|area)$/i;k.fn.extend({prop:function(C,z){return Cn(this,k.prop,C,z,arguments.length>1)},removeProp:function(C){return this.each(function(){delete this[k.propFix[C]||C]})}}),k.extend({prop:function(C,z,U){var X,ft,mt=C.nodeType;if(!(mt===3||mt===8||mt===2))return(mt!==1||!k.isXMLDoc(C))&&(z=k.propFix[z]||z,ft=k.propHooks[z]),U!==void 0?ft&&"set"in ft&&(X=ft.set(C,U,z))!==void 0?X:C[z]=U:ft&&"get"in ft&&(X=ft.get(C,z))!==null?X:C[z]},propHooks:{tabIndex:{get:function(C){var z=k.find.attr(C,"tabindex");return z?parseInt(z,10):Yo.test(C.nodeName)||Nr.test(C.nodeName)&&C.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),K.optSelected||(k.propHooks.selected={get:function(C){var z=C.parentNode;return z&&z.parentNode&&z.parentNode.selectedIndex,null},set:function(C){var z=C.parentNode;z&&(z.selectedIndex,z.parentNode&&z.parentNode.selectedIndex)}}),k.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){k.propFix[this.toLowerCase()]=this});function nr(C){var z=C.match(ue)||[];return z.join(" ")}function ir(C){return C.getAttribute&&C.getAttribute("class")||""}function es(C){return Array.isArray(C)?C:typeof C=="string"?C.match(ue)||[]:[]}k.fn.extend({addClass:function(C){var z,U,X,ft,mt,Tt;return q(C)?this.each(function(ce){k(this).addClass(C.call(this,ce,ir(this)))}):(z=es(C),z.length?this.each(function(){if(X=ir(this),U=this.nodeType===1&&" "+nr(X)+" ",U){for(mt=0;mt<z.length;mt++)ft=z[mt],U.indexOf(" "+ft+" ")<0&&(U+=ft+" ");Tt=nr(U),X!==Tt&&this.setAttribute("class",Tt)}}):this)},removeClass:function(C){var z,U,X,ft,mt,Tt;return q(C)?this.each(function(ce){k(this).removeClass(C.call(this,ce,ir(this)))}):arguments.length?(z=es(C),z.length?this.each(function(){if(X=ir(this),U=this.nodeType===1&&" "+nr(X)+" ",U){for(mt=0;mt<z.length;mt++)for(ft=z[mt];U.indexOf(" "+ft+" ")>-1;)U=U.replace(" "+ft+" "," ");Tt=nr(U),X!==Tt&&this.setAttribute("class",Tt)}}):this):this.attr("class","")},toggleClass:function(C,z){var U,X,ft,mt,Tt=typeof C,ce=Tt==="string"||Array.isArray(C);return q(C)?this.each(function(ee){k(this).toggleClass(C.call(this,ee,ir(this),z),z)}):typeof z=="boolean"&&ce?z?this.addClass(C):this.removeClass(C):(U=es(C),this.each(function(){if(ce)for(mt=k(this),ft=0;ft<U.length;ft++)X=U[ft],mt.hasClass(X)?mt.removeClass(X):mt.addClass(X);else(C===void 0||Tt==="boolean")&&(X=ir(this),X&&gt.set(this,"__className__",X),this.setAttribute&&this.setAttribute("class",X||C===!1?"":gt.get(this,"__className__")||""))}))},hasClass:function(C){var z,U,X=0;for(z=" "+C+" ";U=this[X++];)if(U.nodeType===1&&(" "+nr(ir(U))+" ").indexOf(z)>-1)return!0;return!1}});var ns=/\r/g;k.fn.extend({val:function(C){var z,U,X,ft=this[0];return arguments.length?(X=q(C),this.each(function(mt){var Tt;this.nodeType===1&&(X?Tt=C.call(this,mt,k(this).val()):Tt=C,Tt==null?Tt="":typeof Tt=="number"?Tt+="":Array.isArray(Tt)&&(Tt=k.map(Tt,function(ce){return ce==null?"":ce+""})),z=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()],(!z||!("set"in z)||z.set(this,Tt,"value")===void 0)&&(this.value=Tt))})):ft?(z=k.valHooks[ft.type]||k.valHooks[ft.nodeName.toLowerCase()],z&&"get"in z&&(U=z.get(ft,"value"))!==void 0?U:(U=ft.value,typeof U=="string"?U.replace(ns,""):U??"")):void 0}}),k.extend({valHooks:{option:{get:function(C){var z=k.find.attr(C,"value");return z??nr(k.text(C))}},select:{get:function(C){var z,U,X,ft=C.options,mt=C.selectedIndex,Tt=C.type==="select-one",ce=Tt?null:[],ee=Tt?mt+1:ft.length;for(mt<0?X=ee:X=Tt?mt:0;X<ee;X++)if(U=ft[X],(U.selected||X===mt)&&!U.disabled&&(!U.parentNode.disabled||!Et(U.parentNode,"optgroup"))){if(z=k(U).val(),Tt)return z;ce.push(z)}return ce},set:function(C,z){for(var U,X,ft=C.options,mt=k.makeArray(z),Tt=ft.length;Tt--;)X=ft[Tt],(X.selected=k.inArray(k.valHooks.option.get(X),mt)>-1)&&(U=!0);return U||(C.selectedIndex=-1),mt}}}}),k.each(["radio","checkbox"],function(){k.valHooks[this]={set:function(C,z){if(Array.isArray(z))return C.checked=k.inArray(k(C).val(),z)>-1}},K.checkOn||(k.valHooks[this].get=function(C){return C.getAttribute("value")===null?"on":C.value})}),K.focusin="onfocusin"in e;var is=/^(?:focusinfocus|focusoutblur)$/,da=function(C){C.stopPropagation()};k.extend(k.event,{trigger:function(C,z,U,X){var ft,mt,Tt,ce,ee,Oe,Qe,pn,qe=[U||J],an=E.call(C,"type")?C.type:C,Fn=E.call(C,"namespace")?C.namespace.split("."):[];if(mt=pn=Tt=U=U||J,!(U.nodeType===3||U.nodeType===8)&&!is.test(an+k.event.triggered)&&(an.indexOf(".")>-1&&(Fn=an.split("."),an=Fn.shift(),Fn.sort()),ee=an.indexOf(":")<0&&"on"+an,C=C[k.expando]?C:new k.Event(an,typeof C=="object"&&C),C.isTrigger=X?2:3,C.namespace=Fn.join("."),C.rnamespace=C.namespace?new RegExp("(^|\\.)"+Fn.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,C.result=void 0,C.target||(C.target=U),z=z==null?[C]:k.makeArray(z,[C]),Qe=k.event.special[an]||{},!(!X&&Qe.trigger&&Qe.trigger.apply(U,z)===!1))){if(!X&&!Qe.noBubble&&!at(U)){for(ce=Qe.delegateType||an,is.test(ce+an)||(mt=mt.parentNode);mt;mt=mt.parentNode)qe.push(mt),Tt=mt;Tt===(U.ownerDocument||J)&&qe.push(Tt.defaultView||Tt.parentWindow||e)}for(ft=0;(mt=qe[ft++])&&!C.isPropagationStopped();)pn=mt,C.type=ft>1?ce:Qe.bindType||an,Oe=(gt.get(mt,"events")||Object.create(null))[C.type]&&gt.get(mt,"handle"),Oe&&Oe.apply(mt,z),Oe=ee&&mt[ee],Oe&&Oe.apply&&R(mt)&&(C.result=Oe.apply(mt,z),C.result===!1&&C.preventDefault());return C.type=an,!X&&!C.isDefaultPrevented()&&(!Qe._default||Qe._default.apply(qe.pop(),z)===!1)&&R(U)&&ee&&q(U[an])&&!at(U)&&(Tt=U[ee],Tt&&(U[ee]=null),k.event.triggered=an,C.isPropagationStopped()&&pn.addEventListener(an,da),U[an](),C.isPropagationStopped()&&pn.removeEventListener(an,da),k.event.triggered=void 0,Tt&&(U[ee]=Tt)),C.result}},simulate:function(C,z,U){var X=k.extend(new k.Event,U,{type:C,isSimulated:!0});k.event.trigger(X,null,z)}}),k.fn.extend({trigger:function(C,z){return this.each(function(){k.event.trigger(C,z,this)})},triggerHandler:function(C,z){var U=this[0];if(U)return k.event.trigger(C,z,U,!0)}}),K.focusin||k.each({focus:"focusin",blur:"focusout"},function(C,z){var U=function(X){k.event.simulate(z,X.target,k.event.fix(X))};k.event.special[z]={setup:function(){var X=this.ownerDocument||this.document||this,ft=gt.access(X,z);ft||X.addEventListener(C,U,!0),gt.access(X,z,(ft||0)+1)},teardown:function(){var X=this.ownerDocument||this.document||this,ft=gt.access(X,z)-1;ft?gt.access(X,z,ft):(X.removeEventListener(C,U,!0),gt.remove(X,z))}}});var zo=e.location,Ks={guid:Date.now()},Us=/\?/;k.parseXML=function(C){var z,U;if(!C||typeof C!="string")return null;try{z=new e.DOMParser().parseFromString(C,"text/xml")}catch{}return U=z&&z.getElementsByTagName("parsererror")[0],(!z||U)&&k.error("Invalid XML: "+(U?k.map(U.childNodes,function(X){return X.textContent}).join(`
`):C)),z};var La=/\[\]$/,fl=/\r?\n/g,Zo=/^(?:submit|button|image|reset|file)$/i,Zr=/^(?:input|select|textarea|keygen)/i;function Qs(C,z,U,X){var ft;if(Array.isArray(z))k.each(z,function(mt,Tt){U||La.test(C)?X(C,Tt):Qs(C+"["+(typeof Tt=="object"&&Tt!=null?mt:"")+"]",Tt,U,X)});else if(!U&&Ct(z)==="object")for(ft in z)Qs(C+"["+ft+"]",z[ft],U,X);else X(C,z)}k.param=function(C,z){var U,X=[],ft=function(mt,Tt){var ce=q(Tt)?Tt():Tt;X[X.length]=encodeURIComponent(mt)+"="+encodeURIComponent(ce??"")};if(C==null)return"";if(Array.isArray(C)||C.jquery&&!k.isPlainObject(C))k.each(C,function(){ft(this.name,this.value)});else for(U in C)Qs(U,C[U],z,ft);return X.join("&")},k.fn.extend({serialize:function(){return k.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var C=k.prop(this,"elements");return C?k.makeArray(C):this}).filter(function(){var C=this.type;return this.name&&!k(this).is(":disabled")&&Zr.test(this.nodeName)&&!Zo.test(C)&&(this.checked||!$i.test(C))}).map(function(C,z){var U=k(this).val();return U==null?null:Array.isArray(U)?k.map(U,function(X){return{name:z.name,value:X.replace(fl,`\r
`)}}):{name:z.name,value:U.replace(fl,`\r
`)}}).get()}});var Hl=/%20/g,Vo=/#.*$/,wi=/([?&])_=[^&]*/,ta=/^(.*?):[ \t]*([^\r\n]*)$/mg,zr=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ao=/^(?:GET|HEAD)$/,ka=/^\/\//,dl={},ea={},Or="*/".concat("*"),na=J.createElement("a");na.href=zo.href;function Ya(C){return function(z,U){typeof z!="string"&&(U=z,z="*");var X,ft=0,mt=z.toLowerCase().match(ue)||[];if(q(U))for(;X=mt[ft++];)X[0]==="+"?(X=X.slice(1)||"*",(C[X]=C[X]||[]).unshift(U)):(C[X]=C[X]||[]).push(U)}}function Ei(C,z,U,X){var ft={},mt=C===ea;function Tt(ce){var ee;return ft[ce]=!0,k.each(C[ce]||[],function(Oe,Qe){var pn=Qe(z,U,X);if(typeof pn=="string"&&!mt&&!ft[pn])return z.dataTypes.unshift(pn),Tt(pn),!1;if(mt)return!(ee=pn)}),ee}return Tt(z.dataTypes[0])||!ft["*"]&&Tt("*")}function rr(C,z){var U,X,ft=k.ajaxSettings.flatOptions||{};for(U in z)z[U]!==void 0&&((ft[U]?C:X||(X={}))[U]=z[U]);return X&&k.extend(!0,C,X),C}function pl(C,z,U){for(var X,ft,mt,Tt,ce=C.contents,ee=C.dataTypes;ee[0]==="*";)ee.shift(),X===void 0&&(X=C.mimeType||z.getResponseHeader("Content-Type"));if(X){for(ft in ce)if(ce[ft]&&ce[ft].test(X)){ee.unshift(ft);break}}if(ee[0]in U)mt=ee[0];else{for(ft in U){if(!ee[0]||C.converters[ft+" "+ee[0]]){mt=ft;break}Tt||(Tt=ft)}mt=mt||Tt}if(mt)return mt!==ee[0]&&ee.unshift(mt),U[mt]}function pc(C,z,U,X){var ft,mt,Tt,ce,ee,Oe={},Qe=C.dataTypes.slice();if(Qe[1])for(Tt in C.converters)Oe[Tt.toLowerCase()]=C.converters[Tt];for(mt=Qe.shift();mt;)if(C.responseFields[mt]&&(U[C.responseFields[mt]]=z),!ee&&X&&C.dataFilter&&(z=C.dataFilter(z,C.dataType)),ee=mt,mt=Qe.shift(),mt){if(mt==="*")mt=ee;else if(ee!=="*"&&ee!==mt){if(Tt=Oe[ee+" "+mt]||Oe["* "+mt],!Tt){for(ft in Oe)if(ce=ft.split(" "),ce[1]===mt&&(Tt=Oe[ee+" "+ce[0]]||Oe["* "+ce[0]],Tt)){Tt===!0?Tt=Oe[ft]:Oe[ft]!==!0&&(mt=ce[0],Qe.unshift(ce[1]));break}}if(Tt!==!0)if(Tt&&C.throws)z=Tt(z);else try{z=Tt(z)}catch(pn){return{state:"parsererror",error:Tt?pn:"No conversion from "+ee+" to "+mt}}}}return{state:"success",data:z}}k.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zo.href,type:"GET",isLocal:zr.test(zo.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Or,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":k.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(C,z){return z?rr(rr(C,k.ajaxSettings),z):rr(k.ajaxSettings,C)},ajaxPrefilter:Ya(dl),ajaxTransport:Ya(ea),ajax:function(C,z){typeof C=="object"&&(z=C,C=void 0),z=z||{};var U,X,ft,mt,Tt,ce,ee,Oe,Qe,pn,qe=k.ajaxSetup({},z),an=qe.context||qe,Fn=qe.context&&(an.nodeType||an.jquery)?k(an):k.event,Ui=k.Deferred(),ei=k.Callbacks("once memory"),To=qe.statusCode||{},Qr={},tr={},sr="canceled",Di={readyState:0,getResponseHeader:function(er){var wr;if(ee){if(!mt)for(mt={};wr=ta.exec(ft);)mt[wr[1].toLowerCase()+" "]=(mt[wr[1].toLowerCase()+" "]||[]).concat(wr[2]);wr=mt[er.toLowerCase()+" "]}return wr==null?null:wr.join(", ")},getAllResponseHeaders:function(){return ee?ft:null},setRequestHeader:function(er,wr){return ee==null&&(er=tr[er.toLowerCase()]=tr[er.toLowerCase()]||er,Qr[er]=wr),this},overrideMimeType:function(er){return ee==null&&(qe.mimeType=er),this},statusCode:function(er){var wr;if(er)if(ee)Di.always(er[Di.status]);else for(wr in er)To[wr]=[To[wr],er[wr]];return this},abort:function(er){var wr=er||sr;return U&&U.abort(wr),ls(0,wr),this}};if(Ui.promise(Di),qe.url=((C||qe.url||zo.href)+"").replace(ka,zo.protocol+"//"),qe.type=z.method||z.type||qe.method||qe.type,qe.dataTypes=(qe.dataType||"*").toLowerCase().match(ue)||[""],qe.crossDomain==null){ce=J.createElement("a");try{ce.href=qe.url,ce.href=ce.href,qe.crossDomain=na.protocol+"//"+na.host!=ce.protocol+"//"+ce.host}catch{qe.crossDomain=!0}}if(qe.data&&qe.processData&&typeof qe.data!="string"&&(qe.data=k.param(qe.data,qe.traditional)),Ei(dl,qe,z,Di),ee)return Di;Oe=k.event&&qe.global,Oe&&k.active++===0&&k.event.trigger("ajaxStart"),qe.type=qe.type.toUpperCase(),qe.hasContent=!Ao.test(qe.type),X=qe.url.replace(Vo,""),qe.hasContent?qe.data&&qe.processData&&(qe.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(qe.data=qe.data.replace(Hl,"+")):(pn=qe.url.slice(X.length),qe.data&&(qe.processData||typeof qe.data=="string")&&(X+=(Us.test(X)?"&":"?")+qe.data,delete qe.data),qe.cache===!1&&(X=X.replace(wi,"$1"),pn=(Us.test(X)?"&":"?")+"_="+Ks.guid+++pn),qe.url=X+pn),qe.ifModified&&(k.lastModified[X]&&Di.setRequestHeader("If-Modified-Since",k.lastModified[X]),k.etag[X]&&Di.setRequestHeader("If-None-Match",k.etag[X])),(qe.data&&qe.hasContent&&qe.contentType!==!1||z.contentType)&&Di.setRequestHeader("Content-Type",qe.contentType),Di.setRequestHeader("Accept",qe.dataTypes[0]&&qe.accepts[qe.dataTypes[0]]?qe.accepts[qe.dataTypes[0]]+(qe.dataTypes[0]!=="*"?", "+Or+"; q=0.01":""):qe.accepts["*"]);for(Qe in qe.headers)Di.setRequestHeader(Qe,qe.headers[Qe]);if(qe.beforeSend&&(qe.beforeSend.call(an,Di,qe)===!1||ee))return Di.abort();if(sr="abort",ei.add(qe.complete),Di.done(qe.success),Di.fail(qe.error),U=Ei(ea,qe,z,Di),!U)ls(-1,"No Transport");else{if(Di.readyState=1,Oe&&Fn.trigger("ajaxSend",[Di,qe]),ee)return Di;qe.async&&qe.timeout>0&&(Tt=e.setTimeout(function(){Di.abort("timeout")},qe.timeout));try{ee=!1,U.send(Qr,ls)}catch(er){if(ee)throw er;ls(-1,er)}}function ls(er,wr,Xa,za){var Vr,Gs,Ri,us,pa,Ms=wr;ee||(ee=!0,Tt&&e.clearTimeout(Tt),U=void 0,ft=za||"",Di.readyState=er>0?4:0,Vr=er>=200&&er<300||er===304,Xa&&(us=pl(qe,Di,Xa)),!Vr&&k.inArray("script",qe.dataTypes)>-1&&k.inArray("json",qe.dataTypes)<0&&(qe.converters["text script"]=function(){}),us=pc(qe,us,Di,Vr),Vr?(qe.ifModified&&(pa=Di.getResponseHeader("Last-Modified"),pa&&(k.lastModified[X]=pa),pa=Di.getResponseHeader("etag"),pa&&(k.etag[X]=pa)),er===204||qe.type==="HEAD"?Ms="nocontent":er===304?Ms="notmodified":(Ms=us.state,Gs=us.data,Ri=us.error,Vr=!Ri)):(Ri=Ms,(er||!Ms)&&(Ms="error",er<0&&(er=0))),Di.status=er,Di.statusText=(wr||Ms)+"",Vr?Ui.resolveWith(an,[Gs,Ms,Di]):Ui.rejectWith(an,[Di,Ms,Ri]),Di.statusCode(To),To=void 0,Oe&&Fn.trigger(Vr?"ajaxSuccess":"ajaxError",[Di,qe,Vr?Gs:Ri]),ei.fireWith(an,[Di,Ms]),Oe&&(Fn.trigger("ajaxComplete",[Di,qe]),--k.active||k.event.trigger("ajaxStop")))}return Di},getJSON:function(C,z,U){return k.get(C,z,U,"json")},getScript:function(C,z){return k.get(C,void 0,z,"script")}}),k.each(["get","post"],function(C,z){k[z]=function(U,X,ft,mt){return q(X)&&(mt=mt||ft,ft=X,X=void 0),k.ajax(k.extend({url:U,type:z,dataType:mt,data:X,success:ft},k.isPlainObject(U)&&U))}}),k.ajaxPrefilter(function(C){var z;for(z in C.headers)z.toLowerCase()==="content-type"&&(C.contentType=C.headers[z]||"")}),k._evalUrl=function(C,z,U){return k.ajax({url:C,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(X){k.globalEval(X,z,U)}})},k.fn.extend({wrapAll:function(C){var z;return this[0]&&(q(C)&&(C=C.call(this[0])),z=k(C,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&z.insertBefore(this[0]),z.map(function(){for(var U=this;U.firstElementChild;)U=U.firstElementChild;return U}).append(this)),this},wrapInner:function(C){return q(C)?this.each(function(z){k(this).wrapInner(C.call(this,z))}):this.each(function(){var z=k(this),U=z.contents();U.length?U.wrapAll(C):z.append(C)})},wrap:function(C){var z=q(C);return this.each(function(U){k(this).wrapAll(z?C.call(this,U):C)})},unwrap:function(C){return this.parent(C).not("body").each(function(){k(this).replaceWith(this.childNodes)}),this}}),k.expr.pseudos.hidden=function(C){return!k.expr.pseudos.visible(C)},k.expr.pseudos.visible=function(C){return!!(C.offsetWidth||C.offsetHeight||C.getClientRects().length)},k.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}};var $l={0:200,1223:204},Es=k.ajaxSettings.xhr();K.cors=!!Es&&"withCredentials"in Es,K.ajax=Es=!!Es,k.ajaxTransport(function(C){var z,U;if(K.cors||Es&&!C.crossDomain)return{send:function(X,ft){var mt,Tt=C.xhr();if(Tt.open(C.type,C.url,C.async,C.username,C.password),C.xhrFields)for(mt in C.xhrFields)Tt[mt]=C.xhrFields[mt];C.mimeType&&Tt.overrideMimeType&&Tt.overrideMimeType(C.mimeType),!C.crossDomain&&!X["X-Requested-With"]&&(X["X-Requested-With"]="XMLHttpRequest");for(mt in X)Tt.setRequestHeader(mt,X[mt]);z=function(ce){return function(){z&&(z=U=Tt.onload=Tt.onerror=Tt.onabort=Tt.ontimeout=Tt.onreadystatechange=null,ce==="abort"?Tt.abort():ce==="error"?typeof Tt.status!="number"?ft(0,"error"):ft(Tt.status,Tt.statusText):ft($l[Tt.status]||Tt.status,Tt.statusText,(Tt.responseType||"text")!=="text"||typeof Tt.responseText!="string"?{binary:Tt.response}:{text:Tt.responseText},Tt.getAllResponseHeaders()))}},Tt.onload=z(),U=Tt.onerror=Tt.ontimeout=z("error"),Tt.onabort!==void 0?Tt.onabort=U:Tt.onreadystatechange=function(){Tt.readyState===4&&e.setTimeout(function(){z&&U()})},z=z("abort");try{Tt.send(C.hasContent&&C.data||null)}catch(ce){if(z)throw ce}},abort:function(){z&&z()}}}),k.ajaxPrefilter(function(C){C.crossDomain&&(C.contents.script=!1)}),k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(C){return k.globalEval(C),C}}}),k.ajaxPrefilter("script",function(C){C.cache===void 0&&(C.cache=!1),C.crossDomain&&(C.type="GET")}),k.ajaxTransport("script",function(C){if(C.crossDomain||C.scriptAttrs){var z,U;return{send:function(X,ft){z=k("<script>").attr(C.scriptAttrs||{}).prop({charset:C.scriptCharset,src:C.url}).on("load error",U=function(mt){z.remove(),U=null,mt&&ft(mt.type==="error"?404:200,mt.type)}),J.head.appendChild(z[0])},abort:function(){U&&U()}}}});var Pa=[],vt=/(=)\?(?=&|$)|\?\?/;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var C=Pa.pop()||k.expando+"_"+Ks.guid++;return this[C]=!0,C}}),k.ajaxPrefilter("json jsonp",function(C,z,U){var X,ft,mt,Tt=C.jsonp!==!1&&(vt.test(C.url)?"url":typeof C.data=="string"&&(C.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&vt.test(C.data)&&"data");if(Tt||C.dataTypes[0]==="jsonp")return X=C.jsonpCallback=q(C.jsonpCallback)?C.jsonpCallback():C.jsonpCallback,Tt?C[Tt]=C[Tt].replace(vt,"$1"+X):C.jsonp!==!1&&(C.url+=(Us.test(C.url)?"&":"?")+C.jsonp+"="+X),C.converters["script json"]=function(){return mt||k.error(X+" was not called"),mt[0]},C.dataTypes[0]="json",ft=e[X],e[X]=function(){mt=arguments},U.always(function(){ft===void 0?k(e).removeProp(X):e[X]=ft,C[X]&&(C.jsonpCallback=z.jsonpCallback,Pa.push(X)),mt&&q(ft)&&ft(mt[0]),mt=ft=void 0}),"script"}),K.createHTMLDocument=function(){var C=J.implementation.createHTMLDocument("").body;return C.innerHTML="<form></form><form></form>",C.childNodes.length===2}(),k.parseHTML=function(C,z,U){if(typeof C!="string")return[];typeof z=="boolean"&&(U=z,z=!1);var X,ft,mt;return z||(K.createHTMLDocument?(z=J.implementation.createHTMLDocument(""),X=z.createElement("base"),X.href=J.location.href,z.head.appendChild(X)):z=J),ft=te.exec(C),mt=!U&&[],ft?[z.createElement(ft[1])]:(ft=_s([C],z,mt),mt&&mt.length&&k(mt).remove(),k.merge([],ft.childNodes))},k.fn.load=function(C,z,U){var X,ft,mt,Tt=this,ce=C.indexOf(" ");return ce>-1&&(X=nr(C.slice(ce)),C=C.slice(0,ce)),q(z)?(U=z,z=void 0):z&&typeof z=="object"&&(ft="POST"),Tt.length>0&&k.ajax({url:C,type:ft||"GET",dataType:"html",data:z}).done(function(ee){mt=arguments,Tt.html(X?k("<div>").append(k.parseHTML(ee)).find(X):ee)}).always(U&&function(ee,Oe){Tt.each(function(){U.apply(this,mt||[ee.responseText,Oe,ee])})}),this},k.expr.pseudos.animated=function(C){return k.grep(k.timers,function(z){return C===z.elem}).length},k.offset={setOffset:function(C,z,U){var X,ft,mt,Tt,ce,ee,Oe,Qe=k.css(C,"position"),pn=k(C),qe={};Qe==="static"&&(C.style.position="relative"),ce=pn.offset(),mt=k.css(C,"top"),ee=k.css(C,"left"),Oe=(Qe==="absolute"||Qe==="fixed")&&(mt+ee).indexOf("auto")>-1,Oe?(X=pn.position(),Tt=X.top,ft=X.left):(Tt=parseFloat(mt)||0,ft=parseFloat(ee)||0),q(z)&&(z=z.call(C,U,k.extend({},ce))),z.top!=null&&(qe.top=z.top-ce.top+Tt),z.left!=null&&(qe.left=z.left-ce.left+ft),"using"in z?z.using.call(C,qe):pn.css(qe)}},k.fn.extend({offset:function(C){if(arguments.length)return C===void 0?this:this.each(function(ft){k.offset.setOffset(this,C,ft)});var z,U,X=this[0];if(X)return X.getClientRects().length?(z=X.getBoundingClientRect(),U=X.ownerDocument.defaultView,{top:z.top+U.pageYOffset,left:z.left+U.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var C,z,U,X=this[0],ft={top:0,left:0};if(k.css(X,"position")==="fixed")z=X.getBoundingClientRect();else{for(z=this.offset(),U=X.ownerDocument,C=X.offsetParent||U.documentElement;C&&(C===U.body||C===U.documentElement)&&k.css(C,"position")==="static";)C=C.parentNode;C&&C!==X&&C.nodeType===1&&(ft=k(C).offset(),ft.top+=k.css(C,"borderTopWidth",!0),ft.left+=k.css(C,"borderLeftWidth",!0))}return{top:z.top-ft.top-k.css(X,"marginTop",!0),left:z.left-ft.left-k.css(X,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var C=this.offsetParent;C&&k.css(C,"position")==="static";)C=C.offsetParent;return C||Ge})}}),k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(C,z){var U=z==="pageYOffset";k.fn[C]=function(X){return Cn(this,function(ft,mt,Tt){var ce;if(at(ft)?ce=ft:ft.nodeType===9&&(ce=ft.defaultView),Tt===void 0)return ce?ce[z]:ft[mt];ce?ce.scrollTo(U?ce.pageXOffset:Tt,U?Tt:ce.pageYOffset):ft[mt]=Tt},C,X,arguments.length)}}),k.each(["top","left"],function(C,z){k.cssHooks[z]=pi(K.pixelPosition,function(U,X){if(X)return X=Qn(U,z),xe.test(X)?k(U).position()[z]+"px":X})}),k.each({Height:"height",Width:"width"},function(C,z){k.each({padding:"inner"+C,content:z,"":"outer"+C},function(U,X){k.fn[X]=function(ft,mt){var Tt=arguments.length&&(U||typeof ft!="boolean"),ce=U||(ft===!0||mt===!0?"margin":"border");return Cn(this,function(ee,Oe,Qe){var pn;return at(ee)?X.indexOf("outer")===0?ee["inner"+C]:ee.document.documentElement["client"+C]:ee.nodeType===9?(pn=ee.documentElement,Math.max(ee.body["scroll"+C],pn["scroll"+C],ee.body["offset"+C],pn["offset"+C],pn["client"+C])):Qe===void 0?k.css(ee,Oe,ce):k.style(ee,Oe,Qe,ce)},z,Tt?ft:void 0,Tt)}})}),k.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(C,z){k.fn[z]=function(U){return this.on(z,U)}}),k.fn.extend({bind:function(C,z,U){return this.on(C,null,z,U)},unbind:function(C,z){return this.off(C,null,z)},delegate:function(C,z,U,X){return this.on(z,C,U,X)},undelegate:function(C,z,U){return arguments.length===1?this.off(C,"**"):this.off(z,C||"**",U)},hover:function(C,z){return this.mouseenter(C).mouseleave(z||C)}}),k.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(C,z){k.fn[z]=function(U,X){return arguments.length>0?this.on(z,null,U,X):this.trigger(z)}});var Lt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;k.proxy=function(C,z){var U,X,ft;if(typeof z=="string"&&(U=C[z],z=C,C=U),!!q(C))return X=c.call(arguments,2),ft=function(){return C.apply(z||this,X.concat(c.call(arguments)))},ft.guid=C.guid=C.guid||k.guid++,ft},k.holdReady=function(C){C?k.readyWait++:k.ready(!0)},k.isArray=Array.isArray,k.parseJSON=JSON.parse,k.nodeName=Et,k.isFunction=q,k.isWindow=at,k.camelCase=Un,k.type=Ct,k.now=Date.now,k.isNumeric=function(C){var z=k.type(C);return(z==="number"||z==="string")&&!isNaN(C-parseFloat(C))},k.trim=function(C){return C==null?"":(C+"").replace(Lt,"$1")};var $t=e.jQuery,oe=e.$;return k.noConflict=function(C){return e.$===k&&(e.$=oe),C&&e.jQuery===k&&(e.jQuery=$t),k},typeof n>"u"&&(e.jQuery=e.$=k),k})}(pO)),ox}(function(t){(function(e){var n=typeof self=="object"&&self.self===self&&self||typeof fa=="object"&&fa.global===fa&&fa;{var o=dO(),l;try{l=dk()}catch{}e(n,t,o,l)}})(function(e,n,o,l){var c=e.Backbone,p=Array.prototype.slice;n.VERSION="1.4.1",n.$=l,n.noConflict=function(){return e.Backbone=c,this},n.emulateHTTP=!1,n.emulateJSON=!1;var r=n.Events={},w=/\s+/,M,N=function(R,st,gt,dt,wt){var Zt=0,we;if(gt&&typeof gt=="object")for(dt!==void 0&&("context"in wt)&&wt.context===void 0&&(wt.context=dt),we=o.keys(gt);Zt<we.length;Zt++)st=N(R,st,we[Zt],gt[we[Zt]],wt);else if(gt&&w.test(gt))for(we=gt.split(w);Zt<we.length;Zt++)st=R(st,we[Zt],dt,wt);else st=R(st,gt,dt,wt);return st};r.on=function(R,st,gt){if(this._events=N(E,this._events||{},R,st,{context:gt,ctx:this,listening:M}),M){var dt=this._listeners||(this._listeners={});dt[M.id]=M,M.interop=!1}return this},r.listenTo=function(R,st,gt){if(!R)return this;var dt=R._listenId||(R._listenId=o.uniqueId("l")),wt=this._listeningTo||(this._listeningTo={}),Zt=M=wt[dt];Zt||(this._listenId||(this._listenId=o.uniqueId("l")),Zt=M=wt[dt]=new J(this,R));var we=Z(R,st,gt,this);if(M=void 0,we)throw we;return Zt.interop&&Zt.on(st,gt),this};var E=function(R,st,gt,dt){if(gt){var wt=R[st]||(R[st]=[]),Zt=dt.context,we=dt.ctx,We=dt.listening;We&&We.count++,wt.push({callback:gt,context:Zt,ctx:Zt||we,listening:We})}return R},Z=function(R,st,gt,dt){try{R.on(st,gt,dt)}catch(wt){return wt}};r.off=function(R,st,gt){return this._events?(this._events=N(Y,this._events,R,st,{context:gt,listeners:this._listeners}),this):this},r.stopListening=function(R,st,gt){var dt=this._listeningTo;if(!dt)return this;for(var wt=R?[R._listenId]:o.keys(dt),Zt=0;Zt<wt.length;Zt++){var we=dt[wt[Zt]];if(!we)break;we.obj.off(st,gt,this),we.interop&&we.off(st,gt)}return o.isEmpty(dt)&&(this._listeningTo=void 0),this};var Y=function(R,st,gt,dt){if(R){var wt=dt.context,Zt=dt.listeners,we=0,We;if(!st&&!wt&&!gt){for(We=o.keys(Zt);we<We.length;we++)Zt[We[we]].cleanup();return}for(We=st?[st]:o.keys(R);we<We.length;we++){st=We[we];var pe=R[st];if(!pe)break;for(var un=[],Ye=0;Ye<pe.length;Ye++){var Ge=pe[Ye];if(gt&&gt!==Ge.callback&&gt!==Ge.callback._callback||wt&&wt!==Ge.context)un.push(Ge);else{var Gn=Ge.listening;Gn&&Gn.off(st,gt)}}un.length?R[st]=un:delete R[st]}return R}};r.once=function(R,st,gt){var dt=N(K,{},R,st,this.off.bind(this));return typeof R=="string"&&gt==null&&(st=void 0),this.on(dt,st,gt)},r.listenToOnce=function(R,st,gt){var dt=N(K,{},st,gt,this.stopListening.bind(this,R));return this.listenTo(R,dt)};var K=function(R,st,gt,dt){if(gt){var wt=R[st]=o.once(function(){dt(st,wt),gt.apply(this,arguments)});wt._callback=gt}return R};r.trigger=function(R){if(!this._events)return this;for(var st=Math.max(0,arguments.length-1),gt=Array(st),dt=0;dt<st;dt++)gt[dt]=arguments[dt+1];return N(q,this._events,R,void 0,gt),this};var q=function(R,st,gt,dt){if(R){var wt=R[st],Zt=R.all;wt&&Zt&&(Zt=Zt.slice()),wt&&at(wt,dt),Zt&&at(Zt,[st].concat(dt))}return R},at=function(R,st){var gt,dt=-1,wt=R.length,Zt=st[0],we=st[1],We=st[2];switch(st.length){case 0:for(;++dt<wt;)(gt=R[dt]).callback.call(gt.ctx);return;case 1:for(;++dt<wt;)(gt=R[dt]).callback.call(gt.ctx,Zt);return;case 2:for(;++dt<wt;)(gt=R[dt]).callback.call(gt.ctx,Zt,we);return;case 3:for(;++dt<wt;)(gt=R[dt]).callback.call(gt.ctx,Zt,we,We);return;default:for(;++dt<wt;)(gt=R[dt]).callback.apply(gt.ctx,st);return}},J=function(R,st){this.id=R._listenId,this.listener=R,this.obj=st,this.interop=!0,this.count=0,this._events=void 0};J.prototype.on=r.on,J.prototype.off=function(R,st){var gt;this.interop?(this._events=N(Y,this._events,R,st,{context:void 0,listeners:void 0}),gt=!this._events):(this.count--,gt=this.count===0),gt&&this.cleanup()},J.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},r.bind=r.on,r.unbind=r.off,o.extend(n,r);var Q=n.Model=function(R,st){var gt=R||{};st||(st={}),this.preinitialize.apply(this,arguments),this.cid=o.uniqueId(this.cidPrefix),this.attributes={},st.collection&&(this.collection=st.collection),st.parse&&(gt=this.parse(gt,st)||{});var dt=o.result(this,"defaults");gt=o.defaults(o.extend({},dt,gt),dt),this.set(gt,st),this.changed={},this.initialize.apply(this,arguments)};o.extend(Q.prototype,r,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(R){return o.clone(this.attributes)},sync:function(){return n.sync.apply(this,arguments)},get:function(R){return this.attributes[R]},escape:function(R){return o.escape(this.get(R))},has:function(R){return this.get(R)!=null},matches:function(R){return!!o.iteratee(R,this)(this.attributes)},set:function(R,st,gt){if(R==null)return this;var dt;if(typeof R=="object"?(dt=R,gt=st):(dt={})[R]=st,gt||(gt={}),!this._validate(dt,gt))return!1;var wt=gt.unset,Zt=gt.silent,we=[],We=this._changing;this._changing=!0,We||(this._previousAttributes=o.clone(this.attributes),this.changed={});var pe=this.attributes,un=this.changed,Ye=this._previousAttributes;for(var Ge in dt)st=dt[Ge],o.isEqual(pe[Ge],st)||we.push(Ge),o.isEqual(Ye[Ge],st)?delete un[Ge]:un[Ge]=st,wt?delete pe[Ge]:pe[Ge]=st;if(this.idAttribute in dt){var Gn=this.id;this.id=this.get(this.idAttribute),this.trigger("changeId",this,Gn,gt)}if(!Zt){we.length&&(this._pending=gt);for(var _i=0;_i<we.length;_i++)this.trigger("change:"+we[_i],this,pe[we[_i]],gt)}if(We)return this;if(!Zt)for(;this._pending;)gt=this._pending,this._pending=!1,this.trigger("change",this,gt);return this._pending=!1,this._changing=!1,this},unset:function(R,st){return this.set(R,void 0,o.extend({},st,{unset:!0}))},clear:function(R){var st={};for(var gt in this.attributes)st[gt]=void 0;return this.set(st,o.extend({},R,{unset:!0}))},hasChanged:function(R){return R==null?!o.isEmpty(this.changed):o.has(this.changed,R)},changedAttributes:function(R){if(!R)return this.hasChanged()?o.clone(this.changed):!1;var st=this._changing?this._previousAttributes:this.attributes,gt={},dt;for(var wt in R){var Zt=R[wt];o.isEqual(st[wt],Zt)||(gt[wt]=Zt,dt=!0)}return dt?gt:!1},previous:function(R){return R==null||!this._previousAttributes?null:this._previousAttributes[R]},previousAttributes:function(){return o.clone(this._previousAttributes)},fetch:function(R){R=o.extend({parse:!0},R);var st=this,gt=R.success;return R.success=function(dt){var wt=R.parse?st.parse(dt,R):dt;if(!st.set(wt,R))return!1;gt&&gt.call(R.context,st,dt,R),st.trigger("sync",st,dt,R)},Un(this,R),this.sync("read",this,R)},save:function(R,st,gt){var dt;R==null||typeof R=="object"?(dt=R,gt=st):(dt={})[R]=st,gt=o.extend({validate:!0,parse:!0},gt);var wt=gt.wait;if(dt&&!wt){if(!this.set(dt,gt))return!1}else if(!this._validate(dt,gt))return!1;var Zt=this,we=gt.success,We=this.attributes;gt.success=function(Ye){Zt.attributes=We;var Ge=gt.parse?Zt.parse(Ye,gt):Ye;if(wt&&(Ge=o.extend({},dt,Ge)),Ge&&!Zt.set(Ge,gt))return!1;we&&we.call(gt.context,Zt,Ye,gt),Zt.trigger("sync",Zt,Ye,gt)},Un(this,gt),dt&&wt&&(this.attributes=o.extend({},We,dt));var pe=this.isNew()?"create":gt.patch?"patch":"update";pe==="patch"&&!gt.attrs&&(gt.attrs=dt);var un=this.sync(pe,this,gt);return this.attributes=We,un},destroy:function(R){R=R?o.clone(R):{};var st=this,gt=R.success,dt=R.wait,wt=function(){st.stopListening(),st.trigger("destroy",st,st.collection,R)};R.success=function(we){dt&&wt(),gt&&gt.call(R.context,st,we,R),st.isNew()||st.trigger("sync",st,we,R)};var Zt=!1;return this.isNew()?o.defer(R.success):(Un(this,R),Zt=this.sync("delete",this,R)),dt||wt(),Zt},url:function(){var R=o.result(this,"urlRoot")||o.result(this.collection,"url")||cn();if(this.isNew())return R;var st=this.get(this.idAttribute);return R.replace(/[^\/]$/,"$&/")+encodeURIComponent(st)},parse:function(R,st){return R},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(R){return this._validate({},o.extend({},R,{validate:!0}))},_validate:function(R,st){if(!st.validate||!this.validate)return!0;R=o.extend({},this.attributes,R);var gt=this.validationError=this.validate(R,st)||null;return gt?(this.trigger("invalid",this,gt,o.extend(st,{validationError:gt})),!1):!0}});var lt=n.Collection=function(R,st){st||(st={}),this.preinitialize.apply(this,arguments),st.model&&(this.model=st.model),st.comparator!==void 0&&(this.comparator=st.comparator),this._reset(),this.initialize.apply(this,arguments),R&&this.reset(R,o.extend({silent:!0},st))},Ct={add:!0,remove:!0,merge:!0},j={add:!0,remove:!1},k=function(R,st,gt){gt=Math.min(Math.max(gt,0),R.length);var dt=Array(R.length-gt),wt=st.length,Zt;for(Zt=0;Zt<dt.length;Zt++)dt[Zt]=R[Zt+gt];for(Zt=0;Zt<wt;Zt++)R[Zt+gt]=st[Zt];for(Zt=0;Zt<dt.length;Zt++)R[Zt+wt+gt]=dt[Zt]};o.extend(lt.prototype,r,{model:Q,preinitialize:function(){},initialize:function(){},toJSON:function(R){return this.map(function(st){return st.toJSON(R)})},sync:function(){return n.sync.apply(this,arguments)},add:function(R,st){return this.set(R,o.extend({merge:!1},st,j))},remove:function(R,st){st=o.extend({},st);var gt=!o.isArray(R);R=gt?[R]:R.slice();var dt=this._removeModels(R,st);return!st.silent&&dt.length&&(st.changes={added:[],merged:[],removed:dt},this.trigger("update",this,st)),gt?dt[0]:dt},set:function(R,st){if(R!=null){st=o.extend({},Ct,st),st.parse&&!this._isModel(R)&&(R=this.parse(R,st)||[]);var gt=!o.isArray(R);R=gt?[R]:R.slice();var dt=st.at;dt!=null&&(dt=+dt),dt>this.length&&(dt=this.length),dt<0&&(dt+=this.length+1);var wt=[],Zt=[],we=[],We=[],pe={},un=st.add,Ye=st.merge,Ge=st.remove,Gn=!1,_i=this.comparator&&dt==null&&st.sort!==!1,ui=o.isString(this.comparator)?this.comparator:null,ji,Hi;for(Hi=0;Hi<R.length;Hi++){ji=R[Hi];var vr=this.get(ji);if(vr){if(Ye&&ji!==vr){var Jr=this._isModel(ji)?ji.attributes:ji;st.parse&&(Jr=vr.parse(Jr,st)),vr.set(Jr,st),we.push(vr),_i&&!Gn&&(Gn=vr.hasChanged(ui))}pe[vr.cid]||(pe[vr.cid]=!0,wt.push(vr)),R[Hi]=vr}else un&&(ji=R[Hi]=this._prepareModel(ji,st),ji&&(Zt.push(ji),this._addReference(ji,st),pe[ji.cid]=!0,wt.push(ji)))}if(Ge){for(Hi=0;Hi<this.length;Hi++)ji=this.models[Hi],pe[ji.cid]||We.push(ji);We.length&&this._removeModels(We,st)}var $i=!1,uo=!_i&&un&&Ge;if(wt.length&&uo?($i=this.length!==wt.length||o.some(this.models,function(Go,Ir){return Go!==wt[Ir]}),this.models.length=0,k(this.models,wt,0),this.length=this.models.length):Zt.length&&(_i&&(Gn=!0),k(this.models,Zt,dt??this.length),this.length=this.models.length),Gn&&this.sort({silent:!0}),!st.silent){for(Hi=0;Hi<Zt.length;Hi++)dt!=null&&(st.index=dt+Hi),ji=Zt[Hi],ji.trigger("add",ji,this,st);(Gn||$i)&&this.trigger("sort",this,st),(Zt.length||We.length||we.length)&&(st.changes={added:Zt,removed:We,merged:we},this.trigger("update",this,st))}return gt?R[0]:R}},reset:function(R,st){st=st?o.clone(st):{};for(var gt=0;gt<this.models.length;gt++)this._removeReference(this.models[gt],st);return st.previousModels=this.models,this._reset(),R=this.add(R,o.extend({silent:!0},st)),st.silent||this.trigger("reset",this,st),R},push:function(R,st){return this.add(R,o.extend({at:this.length},st))},pop:function(R){var st=this.at(this.length-1);return this.remove(st,R)},unshift:function(R,st){return this.add(R,o.extend({at:0},st))},shift:function(R){var st=this.at(0);return this.remove(st,R)},slice:function(){return p.apply(this.models,arguments)},get:function(R){if(R!=null)return this._byId[R]||this._byId[this.modelId(this._isModel(R)?R.attributes:R,R.idAttribute)]||R.cid&&this._byId[R.cid]},has:function(R){return this.get(R)!=null},at:function(R){return R<0&&(R+=this.length),this.models[R]},where:function(R,st){return this[st?"find":"filter"](R)},findWhere:function(R){return this.where(R,!0)},sort:function(R){var st=this.comparator;if(!st)throw new Error("Cannot sort a set without a comparator");R||(R={});var gt=st.length;return o.isFunction(st)&&(st=st.bind(this)),gt===1||o.isString(st)?this.models=this.sortBy(st):this.models.sort(st),R.silent||this.trigger("sort",this,R),this},pluck:function(R){return this.map(R+"")},fetch:function(R){R=o.extend({parse:!0},R);var st=R.success,gt=this;return R.success=function(dt){var wt=R.reset?"reset":"set";gt[wt](dt,R),st&&st.call(R.context,gt,dt,R),gt.trigger("sync",gt,dt,R)},Un(this,R),this.sync("read",this,R)},create:function(R,st){st=st?o.clone(st):{};var gt=st.wait;if(R=this._prepareModel(R,st),!R)return!1;gt||this.add(R,st);var dt=this,wt=st.success;return st.success=function(Zt,we,We){gt&&dt.add(Zt,We),wt&&wt.call(We.context,Zt,we,We)},R.save(null,st),R},parse:function(R,st){return R},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(R,st){return R[st||this.model.prototype.idAttribute||"id"]},values:function(){return new yt(this,xt)},keys:function(){return new yt(this,kt)},entries:function(){return new yt(this,de)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(R,st){if(this._isModel(R))return R.collection||(R.collection=this),R;st=st?o.clone(st):{},st.collection=this;var gt;return this.model.prototype?gt=new this.model(R,st):gt=this.model(R,st),gt.validationError?(this.trigger("invalid",this,gt.validationError,st),!1):gt},_removeModels:function(R,st){for(var gt=[],dt=0;dt<R.length;dt++){var wt=this.get(R[dt]);if(wt){var Zt=this.indexOf(wt);this.models.splice(Zt,1),this.length--,delete this._byId[wt.cid];var we=this.modelId(wt.attributes,wt.idAttribute);we!=null&&delete this._byId[we],st.silent||(st.index=Zt,wt.trigger("remove",wt,this,st)),gt.push(wt),this._removeReference(wt,st)}}return gt},_isModel:function(R){return R instanceof Q},_addReference:function(R,st){this._byId[R.cid]=R;var gt=this.modelId(R.attributes,R.idAttribute);gt!=null&&(this._byId[gt]=R),R.on("all",this._onModelEvent,this)},_removeReference:function(R,st){delete this._byId[R.cid];var gt=this.modelId(R.attributes,R.idAttribute);gt!=null&&delete this._byId[gt],this===R.collection&&delete R.collection,R.off("all",this._onModelEvent,this)},_onModelEvent:function(R,st,gt,dt){if(st){if((R==="add"||R==="remove")&&gt!==this)return;if(R==="destroy"&&this.remove(st,dt),R==="changeId"){var wt=this.modelId(st.previousAttributes(),st.idAttribute),Zt=this.modelId(st.attributes,st.idAttribute);wt!=null&&delete this._byId[wt],Zt!=null&&(this._byId[Zt]=st)}}this.trigger.apply(this,arguments)}});var rt=typeof Symbol=="function"&&Symbol.iterator;rt&&(lt.prototype[rt]=lt.prototype.values);var yt=function(R,st){this._collection=R,this._kind=st,this._index=0},xt=1,kt=2,de=3;rt&&(yt.prototype[rt]=function(){return this}),yt.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var R=this._collection.at(this._index);this._index++;var st;if(this._kind===xt)st=R;else{var gt=this._collection.modelId(R.attributes,R.idAttribute);this._kind===kt?st=gt:st=[gt,R]}return{value:st,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var Et=n.View=function(R){this.cid=o.uniqueId("view"),this.preinitialize.apply(this,arguments),o.extend(this,o.pick(R,ht)),this._ensureElement(),this.initialize.apply(this,arguments)},te=/^(\S+)\s*(.*)$/,ht=["model","collection","el","id","attributes","className","tagName","events"];o.extend(Et.prototype,r,{tagName:"div",$:function(R){return this.$el.find(R)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(R){return this.undelegateEvents(),this._setElement(R),this.delegateEvents(),this},_setElement:function(R){this.$el=R instanceof n.$?R:n.$(R),this.el=this.$el[0]},delegateEvents:function(R){if(R||(R=o.result(this,"events")),!R)return this;this.undelegateEvents();for(var st in R){var gt=R[st];if(o.isFunction(gt)||(gt=this[gt]),!!gt){var dt=st.match(te);this.delegate(dt[1],dt[2],gt.bind(this))}}return this},delegate:function(R,st,gt){return this.$el.on(R+".delegateEvents"+this.cid,st,gt),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(R,st,gt){return this.$el.off(R+".delegateEvents"+this.cid,st,gt),this},_createElement:function(R){return document.createElement(R)},_ensureElement:function(){if(this.el)this.setElement(o.result(this,"el"));else{var R=o.extend({},o.result(this,"attributes"));this.id&&(R.id=o.result(this,"id")),this.className&&(R.class=o.result(this,"className")),this.setElement(this._createElement(o.result(this,"tagName"))),this._setAttributes(R)}},_setAttributes:function(R){this.$el.attr(R)}});var ie=function(R,st,gt,dt){switch(st){case 1:return function(){return R[gt](this[dt])};case 2:return function(wt){return R[gt](this[dt],wt)};case 3:return function(wt,Zt){return R[gt](this[dt],Le(wt,this),Zt)};case 4:return function(wt,Zt,we){return R[gt](this[dt],Le(wt,this),Zt,we)};default:return function(){var wt=p.call(arguments);return wt.unshift(this[dt]),R[gt].apply(R,wt)}}},ln=function(R,st,gt,dt){o.each(gt,function(wt,Zt){st[Zt]&&(R.prototype[Zt]=ie(st,wt,Zt,dt))})},Le=function(R,st){return o.isFunction(R)?R:o.isObject(R)&&!st._isModel(R)?_e(R):o.isString(R)?function(gt){return gt.get(R)}:R},_e=function(R){var st=o.matches(R);return function(gt){return st(gt.attributes)}},Me={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},be={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};o.each([[lt,Me,"models"],[Q,be,"attributes"]],function(R){var st=R[0],gt=R[1],dt=R[2];st.mixin=function(wt){var Zt=o.reduce(o.functions(wt),function(we,We){return we[We]=0,we},{});ln(st,wt,Zt,dt)},ln(st,o,gt,dt)}),n.sync=function(R,st,gt){var dt=ue[R];o.defaults(gt||(gt={}),{emulateHTTP:n.emulateHTTP,emulateJSON:n.emulateJSON});var wt={type:dt,dataType:"json"};if(gt.url||(wt.url=o.result(st,"url")||cn()),gt.data==null&&st&&(R==="create"||R==="update"||R==="patch")&&(wt.contentType="application/json",wt.data=JSON.stringify(gt.attrs||st.toJSON(gt))),gt.emulateJSON&&(wt.contentType="application/x-www-form-urlencoded",wt.data=wt.data?{model:wt.data}:{}),gt.emulateHTTP&&(dt==="PUT"||dt==="DELETE"||dt==="PATCH")){wt.type="POST",gt.emulateJSON&&(wt.data._method=dt);var Zt=gt.beforeSend;gt.beforeSend=function(pe){if(pe.setRequestHeader("X-HTTP-Method-Override",dt),Zt)return Zt.apply(this,arguments)}}wt.type!=="GET"&&!gt.emulateJSON&&(wt.processData=!1);var we=gt.error;gt.error=function(pe,un,Ye){gt.textStatus=un,gt.errorThrown=Ye,we&&we.call(gt.context,pe,un,Ye)};var We=gt.xhr=n.ajax(o.extend(wt,gt));return st.trigger("request",st,We,gt),We};var ue={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};n.ajax=function(){return n.$.ajax.apply(n.$,arguments)};var Yt=n.Router=function(R){R||(R={}),this.preinitialize.apply(this,arguments),R.routes&&(this.routes=R.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},Ee=/\((.*?)\)/g,ve=/(\(\?)?:\w+/g,ye=/\*\w+/g,fe=/[\-{}\[\]+?.,\\\^$|#\s]/g;o.extend(Yt.prototype,r,{preinitialize:function(){},initialize:function(){},route:function(R,st,gt){o.isRegExp(R)||(R=this._routeToRegExp(R)),o.isFunction(st)&&(gt=st,st=""),gt||(gt=this[st]);var dt=this;return n.history.route(R,function(wt){var Zt=dt._extractParameters(R,wt);dt.execute(gt,Zt,st)!==!1&&(dt.trigger.apply(dt,["route:"+st].concat(Zt)),dt.trigger("route",st,Zt),n.history.trigger("route",dt,st,Zt))}),this},execute:function(R,st,gt){R&&R.apply(this,st)},navigate:function(R,st){return n.history.navigate(R,st),this},_bindRoutes:function(){if(this.routes){this.routes=o.result(this,"routes");for(var R,st=o.keys(this.routes);(R=st.pop())!=null;)this.route(R,this.routes[R])}},_routeToRegExp:function(R){return R=R.replace(fe,"\\$&").replace(Ee,"(?:$1)?").replace(ve,function(st,gt){return gt?st:"([^/?]+)"}).replace(ye,"([^?]*?)"),new RegExp("^"+R+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(R,st){var gt=R.exec(st).slice(1);return o.map(gt,function(dt,wt){return wt===gt.length-1?dt||null:dt?decodeURIComponent(dt):null})}});var mn=n.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),typeof window<"u"&&(this.location=window.location,this.history=window.history)},Ue=/^[#\/]|\s+$/g,Cn=/^\/+|\/+$/g,Bn=/#.*$/;mn.started=!1,o.extend(mn.prototype,r,{interval:50,atRoot:function(){var R=this.location.pathname.replace(/[^\/]$/,"$&/");return R===this.root&&!this.getSearch()},matchRoot:function(){var R=this.decodeFragment(this.location.pathname),st=R.slice(0,this.root.length-1)+"/";return st===this.root},decodeFragment:function(R){return decodeURI(R.replace(/%25/g,"%2525"))},getSearch:function(){var R=this.location.href.replace(/#.*/,"").match(/\?.+/);return R?R[0]:""},getHash:function(R){var st=(R||this).location.href.match(/#(.*)$/);return st?st[1]:""},getPath:function(){var R=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return R.charAt(0)==="/"?R.slice(1):R},getFragment:function(R){return R==null&&(this._usePushState||!this._wantsHashChange?R=this.getPath():R=this.getHash()),R.replace(Ue,"")},start:function(R){if(mn.started)throw new Error("Backbone.history has already been started");if(mn.started=!0,this.options=o.extend({root:"/"},this.options,R),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.history&&this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(Cn,"/"),this._wantsHashChange&&this._wantsPushState)if(!this._hasPushState&&!this.atRoot()){var st=this.root.slice(0,-1)||"/";return this.location.replace(st+"#"+this.getPath()),!0}else this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0});if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var gt=document.body,dt=gt.insertBefore(this.iframe,gt.firstChild).contentWindow;dt.document.open(),dt.document.close(),dt.location.hash="#"+this.fragment}var wt=window.addEventListener||function(Zt,we){return attachEvent("on"+Zt,we)};if(this._usePushState?wt("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?wt("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var R=window.removeEventListener||function(st,gt){return detachEvent("on"+st,gt)};this._usePushState?R("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&R("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),mn.started=!1},route:function(R,st){this.handlers.unshift({route:R,callback:st})},checkUrl:function(R){var st=this.getFragment();if(st===this.fragment&&this.iframe&&(st=this.getHash(this.iframe.contentWindow)),st===this.fragment)return!1;this.iframe&&this.navigate(st),this.loadUrl()},loadUrl:function(R){return this.matchRoot()?(R=this.fragment=this.getFragment(R),o.some(this.handlers,function(st){if(st.route.test(R))return st.callback(R),!0})):!1},navigate:function(R,st){if(!mn.started)return!1;(!st||st===!0)&&(st={trigger:!!st}),R=this.getFragment(R||"");var gt=this.root;(R===""||R.charAt(0)==="?")&&(gt=gt.slice(0,-1)||"/");var dt=gt+R;R=R.replace(Bn,"");var wt=this.decodeFragment(R);if(this.fragment!==wt){if(this.fragment=wt,this._usePushState)this.history[st.replace?"replaceState":"pushState"]({},document.title,dt);else if(this._wantsHashChange){if(this._updateHash(this.location,R,st.replace),this.iframe&&R!==this.getHash(this.iframe.contentWindow)){var Zt=this.iframe.contentWindow;st.replace||(Zt.document.open(),Zt.document.close()),this._updateHash(Zt.location,R,st.replace)}}else return this.location.assign(dt);if(st.trigger)return this.loadUrl(R)}},_updateHash:function(R,st,gt){if(gt){var dt=R.href.replace(/(javascript:|#).*$/,"");R.replace(dt+"#"+st)}else R.hash="#"+st}}),n.history=new mn;var Pn=function(R,st){var gt=this,dt;return R&&o.has(R,"constructor")?dt=R.constructor:dt=function(){return gt.apply(this,arguments)},o.extend(dt,gt,st),dt.prototype=o.create(gt.prototype,R),dt.prototype.constructor=dt,dt.__super__=gt.prototype,dt};Q.extend=lt.extend=Yt.extend=Et.extend=mn.extend=Pn;var cn=function(){throw new Error('A "url" property or function must be specified')},Un=function(R,st){var gt=st.error;st.error=function(dt){gt&&gt.call(st.context,R,dt,st),R.trigger("error",R,dt,st)}};return n})})(fk);const Yl=fk;var sx={},mO={get exports(){return sx},set exports(t){sx=t}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(t,e){(function(){var n,o="4.17.21",l=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",r="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",M=500,N="__lodash_placeholder__",E=1,Z=2,Y=4,K=1,q=2,at=1,J=2,Q=4,lt=8,Ct=16,j=32,k=64,rt=128,yt=256,xt=512,kt=30,de="...",Et=800,te=16,ht=1,ie=2,ln=3,Le=1/0,_e=9007199254740991,Me=17976931348623157e292,be=0/0,ue=4294967295,Yt=ue-1,Ee=ue>>>1,ve=[["ary",rt],["bind",at],["bindKey",J],["curry",lt],["curryRight",Ct],["flip",xt],["partial",j],["partialRight",k],["rearg",yt]],ye="[object Arguments]",fe="[object Array]",mn="[object AsyncFunction]",Ue="[object Boolean]",Cn="[object Date]",Bn="[object DOMException]",Pn="[object Error]",cn="[object Function]",Un="[object GeneratorFunction]",R="[object Map]",st="[object Number]",gt="[object Null]",dt="[object Object]",wt="[object Promise]",Zt="[object Proxy]",we="[object RegExp]",We="[object Set]",pe="[object String]",un="[object Symbol]",Ye="[object Undefined]",Ge="[object WeakMap]",Gn="[object WeakSet]",_i="[object ArrayBuffer]",ui="[object DataView]",ji="[object Float32Array]",Hi="[object Float64Array]",vr="[object Int8Array]",Jr="[object Int16Array]",$i="[object Int32Array]",uo="[object Uint8Array]",Go="[object Uint8ClampedArray]",Ir="[object Uint16Array]",Ar="[object Uint32Array]",Ro=/\b__p \+= '';/g,Qo=/\b(__p \+=) '' \+/g,_s=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bo=/&(?:amp|lt|gt|quot|#39);/g,co=/[&<>"']/g,io=RegExp(bo.source),Ta=RegExp(co.source),Wa=/<%-([\s\S]+?)%>/g,Sa=/<%([\s\S]+?)%>/g,ts=/<%=([\s\S]+?)%>/g,js=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ea=/^\w*$/,Vt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/[\\^$.*+?()[\]{}|]/g,It=RegExp(pt.source),Ut=/^\s+/,qt=/\s/,Ht=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pe=/\{\n\/\* \[wrapped with (.+)\] \*/,Se=/,? & /,xe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Re=/[()=,{}\[\]\/\s]/,hn=/\\(\\)?/g,Zn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,bn=/\w*$/,ci=/^[-+]0x[0-9a-f]+$/i,hi=/^0b[01]+$/i,Qn=/^\[object .+?Constructor\]$/,pi=/^0o[0-7]+$/i,qi=/^(?:0|[1-9]\d*)$/,ur=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ti=/($^)/,yr=/['\n\r\u2028\u2029\\]/g,xr="\\ud800-\\udfff",Js="\\u0300-\\u036f",Ss="\\ufe20-\\ufe2f",vs="\\u20d0-\\u20ff",Ke=Js+Ss+vs,Po="\\u2700-\\u27bf",Xr="a-z\\xdf-\\xf6\\xf8-\\xff",ro="\\xac\\xb1\\xd7\\xf7",hl="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Io="\\u2000-\\u206f",cr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Kr="A-Z\\xc0-\\xd6\\xd8-\\xde",Co="\\ufe0e\\ufe0f",jn=ro+hl+Io+cr,Ti="['’]",Oi="["+xr+"]",Si="["+jn+"]",Tr="["+Ke+"]",vi="\\d+",Ma="["+Po+"]",oo="["+Xr+"]",Yo="[^"+xr+jn+vi+Po+Xr+Kr+"]",Nr="\\ud83c[\\udffb-\\udfff]",nr="(?:"+Tr+"|"+Nr+")",ir="[^"+xr+"]",es="(?:\\ud83c[\\udde6-\\uddff]){2}",ns="[\\ud800-\\udbff][\\udc00-\\udfff]",is="["+Kr+"]",da="\\u200d",zo="(?:"+oo+"|"+Yo+")",Ks="(?:"+is+"|"+Yo+")",Us="(?:"+Ti+"(?:d|ll|m|re|s|t|ve))?",La="(?:"+Ti+"(?:D|LL|M|RE|S|T|VE))?",fl=nr+"?",Zo="["+Co+"]?",Zr="(?:"+da+"(?:"+[ir,es,ns].join("|")+")"+Zo+fl+")*",Qs="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Hl="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Vo=Zo+fl+Zr,wi="(?:"+[Ma,es,ns].join("|")+")"+Vo,ta="(?:"+[ir+Tr+"?",Tr,es,ns,Oi].join("|")+")",zr=RegExp(Ti,"g"),Ao=RegExp(Tr,"g"),ka=RegExp(Nr+"(?="+Nr+")|"+ta+Vo,"g"),dl=RegExp([is+"?"+oo+"+"+Us+"(?="+[Si,is,"$"].join("|")+")",Ks+"+"+La+"(?="+[Si,is+zo,"$"].join("|")+")",is+"?"+zo+"+"+Us,is+"+"+La,Hl,Qs,vi,wi].join("|"),"g"),ea=RegExp("["+da+xr+Ke+Co+"]"),Or=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,na=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ya=-1,Ei={};Ei[ji]=Ei[Hi]=Ei[vr]=Ei[Jr]=Ei[$i]=Ei[uo]=Ei[Go]=Ei[Ir]=Ei[Ar]=!0,Ei[ye]=Ei[fe]=Ei[_i]=Ei[Ue]=Ei[ui]=Ei[Cn]=Ei[Pn]=Ei[cn]=Ei[R]=Ei[st]=Ei[dt]=Ei[we]=Ei[We]=Ei[pe]=Ei[Ge]=!1;var rr={};rr[ye]=rr[fe]=rr[_i]=rr[ui]=rr[Ue]=rr[Cn]=rr[ji]=rr[Hi]=rr[vr]=rr[Jr]=rr[$i]=rr[R]=rr[st]=rr[dt]=rr[we]=rr[We]=rr[pe]=rr[un]=rr[uo]=rr[Go]=rr[Ir]=rr[Ar]=!0,rr[Pn]=rr[cn]=rr[Ge]=!1;var pl={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},pc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$l={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Es={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Pa=parseFloat,vt=parseInt,Lt=typeof fa=="object"&&fa&&fa.Object===Object&&fa,$t=typeof self=="object"&&self&&self.Object===Object&&self,oe=Lt||$t||Function("return this")(),C=e&&!e.nodeType&&e,z=C&&!0&&t&&!t.nodeType&&t,U=z&&z.exports===C,X=U&&Lt.process,ft=function(){try{var ze=z&&z.require&&z.require("util").types;return ze||X&&X.binding&&X.binding("util")}catch{}}(),mt=ft&&ft.isArrayBuffer,Tt=ft&&ft.isDate,ce=ft&&ft.isMap,ee=ft&&ft.isRegExp,Oe=ft&&ft.isSet,Qe=ft&&ft.isTypedArray;function pn(ze,gn,on){switch(on.length){case 0:return ze.call(gn);case 1:return ze.call(gn,on[0]);case 2:return ze.call(gn,on[0],on[1]);case 3:return ze.call(gn,on[0],on[1],on[2])}return ze.apply(gn,on)}function qe(ze,gn,on,ni){for(var Bi=-1,Sr=ze==null?0:ze.length;++Bi<Sr;){var Do=ze[Bi];gn(ni,Do,on(Do),ze)}return ni}function an(ze,gn){for(var on=-1,ni=ze==null?0:ze.length;++on<ni&&gn(ze[on],on,ze)!==!1;);return ze}function Fn(ze,gn){for(var on=ze==null?0:ze.length;on--&&gn(ze[on],on,ze)!==!1;);return ze}function Ui(ze,gn){for(var on=-1,ni=ze==null?0:ze.length;++on<ni;)if(!gn(ze[on],on,ze))return!1;return!0}function ei(ze,gn){for(var on=-1,ni=ze==null?0:ze.length,Bi=0,Sr=[];++on<ni;){var Do=ze[on];gn(Do,on,ze)&&(Sr[Bi++]=Do)}return Sr}function To(ze,gn){var on=ze==null?0:ze.length;return!!on&&Ri(ze,gn,0)>-1}function Qr(ze,gn,on){for(var ni=-1,Bi=ze==null?0:ze.length;++ni<Bi;)if(on(gn,ze[ni]))return!0;return!1}function tr(ze,gn){for(var on=-1,ni=ze==null?0:ze.length,Bi=Array(ni);++on<ni;)Bi[on]=gn(ze[on],on,ze);return Bi}function sr(ze,gn){for(var on=-1,ni=gn.length,Bi=ze.length;++on<ni;)ze[Bi+on]=gn[on];return ze}function Di(ze,gn,on,ni){var Bi=-1,Sr=ze==null?0:ze.length;for(ni&&Sr&&(on=ze[++Bi]);++Bi<Sr;)on=gn(on,ze[Bi],Bi,ze);return on}function ls(ze,gn,on,ni){var Bi=ze==null?0:ze.length;for(ni&&Bi&&(on=ze[--Bi]);Bi--;)on=gn(on,ze[Bi],Bi,ze);return on}function er(ze,gn){for(var on=-1,ni=ze==null?0:ze.length;++on<ni;)if(gn(ze[on],on,ze))return!0;return!1}var wr=ma("length");function Xa(ze){return ze.split("")}function za(ze){return ze.match(xe)||[]}function Vr(ze,gn,on){var ni;return on(ze,function(Bi,Sr,Do){if(gn(Bi,Sr,Do))return ni=Sr,!1}),ni}function Gs(ze,gn,on,ni){for(var Bi=ze.length,Sr=on+(ni?1:-1);ni?Sr--:++Sr<Bi;)if(gn(ze[Sr],Sr,ze))return Sr;return-1}function Ri(ze,gn,on){return gn===gn?Vu(ze,gn,on):Gs(ze,pa,on)}function us(ze,gn,on,ni){for(var Bi=on-1,Sr=ze.length;++Bi<Sr;)if(ni(ze[Bi],gn))return Bi;return-1}function pa(ze){return ze!==ze}function Ms(ze,gn){var on=ze==null?0:ze.length;return on?Mr(ze,gn)/on:be}function ma(ze){return function(gn){return gn==null?n:gn[ze]}}function ml(ze){return function(gn){return ze==null?n:ze[gn]}}function Da(ze,gn,on,ni,Bi){return Bi(ze,function(Sr,Do,Lr){on=ni?(ni=!1,Sr):gn(on,Sr,Do,Lr)}),on}function mc(ze,gn){var on=ze.length;for(ze.sort(gn);on--;)ze[on]=ze[on].value;return ze}function Mr(ze,gn){for(var on,ni=-1,Bi=ze.length;++ni<Bi;){var Sr=gn(ze[ni]);Sr!==n&&(on=on===n?Sr:on+Sr)}return on}function ia(ze,gn){for(var on=-1,ni=Array(ze);++on<ze;)ni[on]=gn(on);return ni}function Zu(ze,gn){return tr(gn,function(on){return[on,ze[on]]})}function ys(ze){return ze&&ze.slice(0,Xo(ze)+1).replace(Ut,"")}function Wo(ze){return function(gn){return ze(gn)}}function ql(ze,gn){return tr(gn,function(on){return ze[on]})}function Zs(ze,gn){return ze.has(gn)}function Fc(ze,gn){for(var on=-1,ni=ze.length;++on<ni&&Ri(gn,ze[on],0)>-1;);return on}function Na(ze,gn){for(var on=ze.length;on--&&Ri(gn,ze[on],0)>-1;);return on}function xu(ze,gn){for(var on=ze.length,ni=0;on--;)ze[on]===gn&&++ni;return ni}var wu=ml(pl),Sl=ml(pc);function bu(ze){return"\\"+Es[ze]}function Ha(ze,gn){return ze==null?n:ze[gn]}function xs(ze){return ea.test(ze)}function $a(ze){return Or.test(ze)}function gc(ze){for(var gn,on=[];!(gn=ze.next()).done;)on.push(gn.value);return on}function El(ze){var gn=-1,on=Array(ze.size);return ze.forEach(function(ni,Bi){on[++gn]=[Bi,ni]}),on}function ga(ze,gn){return function(on){return ze(gn(on))}}function ho(ze,gn){for(var on=-1,ni=ze.length,Bi=0,Sr=[];++on<ni;){var Do=ze[on];(Do===gn||Do===N)&&(ze[on]=N,Sr[Bi++]=on)}return Sr}function Ml(ze){var gn=-1,on=Array(ze.size);return ze.forEach(function(ni){on[++gn]=ni}),on}function Ll(ze){var gn=-1,on=Array(ze.size);return ze.forEach(function(ni){on[++gn]=[ni,ni]}),on}function Vu(ze,gn,on){for(var ni=on-1,Bi=ze.length;++ni<Bi;)if(ze[ni]===gn)return ni;return-1}function gl(ze,gn,on){for(var ni=on+1;ni--;)if(ze[ni]===gn)return ni;return ni}function dr(ze){return xs(ze)?_l(ze):wr(ze)}function Ls(ze){return xs(ze)?Wu(ze):Xa(ze)}function Xo(ze){for(var gn=ze.length;gn--&&qt.test(ze.charAt(gn)););return gn}var ws=ml($l);function _l(ze){for(var gn=ka.lastIndex=0;ka.test(ze);)++gn;return gn}function Wu(ze){return ze.match(ka)||[]}function Jl(ze){return ze.match(dl)||[]}var Yu=function ze(gn){gn=gn==null?oe:ks.defaults(oe.Object(),gn,ks.pick(oe,na));var on=gn.Array,ni=gn.Date,Bi=gn.Error,Sr=gn.Function,Do=gn.Math,Lr=gn.Object,Ps=gn.RegExp,Kl=gn.String,Vs=gn.TypeError,Nt=on.prototype,ae=Sr.prototype,Ce=Lr.prototype,vn=gn["__core-js_shared__"],ke=ae.toString,rn=Ce.hasOwnProperty,Sn=0,Yn=function(){var g=/[^.]+$/.exec(vn&&vn.keys&&vn.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Mn=Ce.toString,bi=ke.call(Lr),mi=oe._,Mi=Ps("^"+ke.call(rn).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gi=U?gn.Buffer:n,or=gn.Symbol,Ii=gn.Uint8Array,fo=Gi?Gi.allocUnsafe:n,po=ga(Lr.getPrototypeOf,Lr),rs=Lr.create,Rr=Ce.propertyIsEnumerable,zs=Nt.splice,Ws=or?or.isConcatSpreadable:n,Bo=or?or.iterator:n,kl=or?or.toStringTag:n,Pl=function(){try{var g=Hh(Lr,"defineProperty");return g({},"",{}),g}catch{}}(),_c=gn.clearTimeout!==oe.clearTimeout&&gn.clearTimeout,$n=ni&&ni.now!==oe.Date.now&&ni.now,Oa=gn.setTimeout!==oe.setTimeout&&gn.setTimeout,Ql=Do.ceil,jc=Do.floor,d=Lr.getOwnPropertySymbols,b=Gi?Gi.isBuffer:n,D=gn.isFinite,H=Nt.join,ut=ga(Lr.keys,Lr),St=Do.max,ne=Do.min,Ve=ni.now,sn=gn.parseInt,On=Do.random,ii=Nt.reverse,Zi=Hh(gn,"DataView"),Qi=Hh(gn,"Map"),Ys=Hh(gn,"Promise"),ra=Hh(gn,"Set"),tu=Hh(gn,"WeakMap"),oa=Hh(Lr,"create"),zl=tu&&new tu,Xu={},Bh=tc(Zi),Fh=tc(Qi),jh=tc(Ys),fh=tc(ra),Dl=tc(tu),Lo=or?or.prototype:n,eu=Lo?Lo.valueOf:n,Uh=Lo?Lo.toString:n;function Dt(g){if(fs(g)&&!hr(g)&&!(g instanceof Ni)){if(g instanceof _a)return g;if(rn.call(g,"__wrapped__"))return Bf(g)}return new _a(g)}var nu=function(){function g(){}return function(I){if(!$o(I))return{};if(rs)return rs(I);g.prototype=I;var F=new g;return g.prototype=n,F}}();function Hu(){}function _a(g,I){this.__wrapped__=g,this.__actions__=[],this.__chain__=!!I,this.__index__=0,this.__values__=n}Dt.templateSettings={escape:Wa,evaluate:Sa,interpolate:ts,variable:"",imports:{_:Dt}},Dt.prototype=Hu.prototype,Dt.prototype.constructor=Dt,_a.prototype=nu(Hu.prototype),_a.prototype.constructor=_a;function Ni(g){this.__wrapped__=g,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ue,this.__views__=[]}function Pg(){var g=new Ni(this.__wrapped__);return g.__actions__=bs(this.__actions__),g.__dir__=this.__dir__,g.__filtered__=this.__filtered__,g.__iteratees__=bs(this.__iteratees__),g.__takeCount__=this.__takeCount__,g.__views__=bs(this.__views__),g}function Sd(){if(this.__filtered__){var g=new Ni(this);g.__dir__=-1,g.__filtered__=!0}else g=this.clone(),g.__dir__*=-1;return g}function zg(){var g=this.__wrapped__.value(),I=this.__dir__,F=hr(g),nt=I<0,At=F?g.length:0,Rt=$g(0,At,this.__views__),se=Rt.start,Ie=Rt.end,Be=Ie-se,Tn=nt?Ie:se-1,kn=this.__iteratees__,Rn=kn.length,si=0,Ci=ne(Be,this.__takeCount__);if(!F||!nt&&At==Be&&Ci==Be)return Vh(g,this.__actions__);var Yi=[];t:for(;Be--&&si<Ci;){Tn+=I;for(var Cr=-1,Ji=g[Tn];++Cr<Rn;){var Pr=kn[Cr],Br=Pr.iteratee,jl=Pr.type,il=Br(Ji);if(jl==ie)Ji=il;else if(!il){if(jl==ht)continue t;break t}}Yi[si++]=Ji}return Yi}Ni.prototype=nu(Hu.prototype),Ni.prototype.constructor=Ni;function Uc(g){var I=-1,F=g==null?0:g.length;for(this.clear();++I<F;){var nt=g[I];this.set(nt[0],nt[1])}}function $u(){this.__data__=oa?oa(null):{},this.size=0}function Gp(g){var I=this.has(g)&&delete this.__data__[g];return this.size-=I?1:0,I}function dh(g){var I=this.__data__;if(oa){var F=I[g];return F===w?n:F}return rn.call(I,g)?I[g]:n}function Iu(g){var I=this.__data__;return oa?I[g]!==n:rn.call(I,g)}function Tf(g,I){var F=this.__data__;return this.size+=this.has(g)?0:1,F[g]=oa&&I===n?w:I,this}Uc.prototype.clear=$u,Uc.prototype.delete=Gp,Uc.prototype.get=dh,Uc.prototype.has=Iu,Uc.prototype.set=Tf;function Xn(g){var I=-1,F=g==null?0:g.length;for(this.clear();++I<F;){var nt=g[I];this.set(nt[0],nt[1])}}function Zp(){this.__data__=[],this.size=0}function Vp(g){var I=this.__data__,F=u(I,g);if(F<0)return!1;var nt=I.length-1;return F==nt?I.pop():zs.call(I,F,1),--this.size,!0}function vc(g){var I=this.__data__,F=u(I,g);return F<0?n:I[F][1]}function Gh(g){return u(this.__data__,g)>-1}function Ed(g,I){var F=this.__data__,nt=u(F,g);return nt<0?(++this.size,F.push([g,I])):F[nt][1]=I,this}Xn.prototype.clear=Zp,Xn.prototype.delete=Vp,Xn.prototype.get=vc,Xn.prototype.has=Gh,Xn.prototype.set=Ed;function Cu(g){var I=-1,F=g==null?0:g.length;for(this.clear();++I<F;){var nt=g[I];this.set(nt[0],nt[1])}}function Md(){this.size=0,this.__data__={hash:new Uc,map:new(Qi||Xn),string:new Uc}}function Ld(g){var I=Pf(this,g).delete(g);return this.size-=I?1:0,I}function kd(g){return Pf(this,g).get(g)}function Pd(g){return Pf(this,g).has(g)}function ph(g,I){var F=Pf(this,g),nt=F.size;return F.set(g,I),this.size+=F.size==nt?0:1,this}Cu.prototype.clear=Md,Cu.prototype.delete=Ld,Cu.prototype.get=kd,Cu.prototype.has=Pd,Cu.prototype.set=ph;function iu(g){var I=-1,F=g==null?0:g.length;for(this.__data__=new Cu;++I<F;)this.add(g[I])}function Sf(g){return this.__data__.set(g,w),this}function Wp(g){return this.__data__.has(g)}iu.prototype.add=iu.prototype.push=Sf,iu.prototype.has=Wp;function vl(g){var I=this.__data__=new Xn(g);this.size=I.size}function Yp(){this.__data__=new Xn,this.size=0}function Xp(g){var I=this.__data__,F=I.delete(g);return this.size=I.size,F}function Hp(g){return this.__data__.get(g)}function $p(g){return this.__data__.has(g)}function qp(g,I){var F=this.__data__;if(F instanceof Xn){var nt=F.__data__;if(!Qi||nt.length<l-1)return nt.push([g,I]),this.size=++F.size,this;F=this.__data__=new Cu(nt)}return F.set(g,I),this.size=F.size,this}vl.prototype.clear=Yp,vl.prototype.delete=Xp,vl.prototype.get=Hp,vl.prototype.has=$p,vl.prototype.set=qp;function Ef(g,I){var F=hr(g),nt=!F&&ef(g),At=!F&&!nt&&ic(g),Rt=!F&&!nt&&!At&&rc(g),se=F||nt||At||Rt,Ie=se?ia(g.length,Kl):[],Be=Ie.length;for(var Tn in g)(I||rn.call(g,Tn))&&!(se&&(Tn=="length"||At&&(Tn=="offset"||Tn=="parent")||Rt&&(Tn=="buffer"||Tn=="byteLength"||Tn=="byteOffset")||Ic(Tn,Be)))&&Ie.push(Tn);return Ie}function zd(g){var I=g.length;return I?g[Ja(0,I-1)]:n}function Jp(g,I){return Rf(bs(g),G(I,0,g.length))}function Dd(g){return Rf(bs(g))}function Gc(g,I,F){(F!==n&&!nc(g[I],F)||F===n&&!(I in g))&&S(g,I,F)}function _(g,I,F){var nt=g[I];(!(rn.call(g,I)&&nc(nt,F))||F===n&&!(I in g))&&S(g,I,F)}function u(g,I){for(var F=g.length;F--;)if(nc(g[F][0],I))return F;return-1}function f(g,I,F,nt){return Bt(g,function(At,Rt,se){I(nt,At,F(At),se)}),nt}function y(g,I){return g&&Xs(I,ds(I),g)}function A(g,I){return g&&Xs(I,wl(I),g)}function S(g,I,F){I=="__proto__"&&Pl?Pl(g,I,{configurable:!0,enumerable:!0,value:F,writable:!0}):g[I]=F}function B(g,I){for(var F=-1,nt=I.length,At=on(nt),Rt=g==null;++F<nt;)At[F]=Rt?n:Em(g,I[F]);return At}function G(g,I,F){return g===g&&(F!==n&&(g=g<=F?g:F),I!==n&&(g=g>=I?g:I)),g}function W(g,I,F,nt,At,Rt){var se,Ie=I&E,Be=I&Z,Tn=I&Y;if(F&&(se=At?F(g,nt,At,Rt):F(g)),se!==n)return se;if(!$o(g))return g;var kn=hr(g);if(kn){if(se=$h(g),!Ie)return bs(g,se)}else{var Rn=Ka(g),si=Rn==cn||Rn==Un;if(ic(g))return xc(g,Ie);if(Rn==dt||Rn==ye||si&&!At){if(se=Be||si?{}:Jg(g),!Ie)return Be?_h(g,A(se,g)):gh(g,y(se,g))}else{if(!rr[Rn])return At?g:{};se=aw(g,Rn,Ie)}}Rt||(Rt=new vl);var Ci=Rt.get(g);if(Ci)return Ci;Rt.set(g,se),n0(g)?g.forEach(function(Ji){se.add(W(Ji,I,F,Ji,g,Rt))}):T_(g)&&g.forEach(function(Ji,Pr){se.set(Pr,W(Ji,I,F,Pr,g,Rt))});var Yi=Tn?Be?Xg:im:Be?wl:ds,Cr=kn?n:Yi(g);return an(Cr||g,function(Ji,Pr){Cr&&(Pr=Ji,Ji=g[Pr]),_(se,Pr,W(Ji,I,F,Pr,g,Rt))}),se}function it(g){var I=ds(g);return function(F){return et(F,g,I)}}function et(g,I,F){var nt=F.length;if(g==null)return!nt;for(g=Lr(g);nt--;){var At=F[nt],Rt=I[At],se=g[At];if(se===n&&!(At in g)||!Rt(se))return!1}return!0}function _t(g,I,F){if(typeof g!="function")throw new Vs(p);return Of(function(){g.apply(n,F)},I)}function Mt(g,I,F,nt){var At=-1,Rt=To,se=!0,Ie=g.length,Be=[],Tn=I.length;if(!Ie)return Be;F&&(I=tr(I,Wo(F))),nt?(Rt=Qr,se=!1):I.length>=l&&(Rt=Zs,se=!1,I=new iu(I));t:for(;++At<Ie;){var kn=g[At],Rn=F==null?kn:F(kn);if(kn=nt||kn!==0?kn:0,se&&Rn===Rn){for(var si=Tn;si--;)if(I[si]===Rn)continue t;Be.push(kn)}else Rt(I,Rn,nt)||Be.push(kn)}return Be}var Bt=vy(re),Ft=vy(Ae,!0);function Gt(g,I){var F=!0;return Bt(g,function(nt,At,Rt){return F=!!I(nt,At,Rt),F}),F}function Pt(g,I,F){for(var nt=-1,At=g.length;++nt<At;){var Rt=g[nt],se=I(Rt);if(se!=null&&(Ie===n?se===se&&!nl(se):F(se,Ie)))var Ie=se,Be=Rt}return Be}function Ot(g,I,F,nt){var At=g.length;for(F=Vi(F),F<0&&(F=-F>At?0:At+F),nt=nt===n||nt>At?At:Vi(nt),nt<0&&(nt+=At),nt=F>nt?0:Wf(nt);F<nt;)g[F++]=I;return g}function Wt(g,I){var F=[];return Bt(g,function(nt,At,Rt){I(nt,At,Rt)&&F.push(nt)}),F}function jt(g,I,F,nt,At){var Rt=-1,se=g.length;for(F||(F=sm),At||(At=[]);++Rt<se;){var Ie=g[Rt];I>0&&F(Ie)?I>1?jt(Ie,I-1,F,nt,At):sr(At,Ie):nt||(At[At.length]=Ie)}return At}var Kt=yy(),me=yy(!0);function re(g,I){return g&&Kt(g,I,ds)}function Ae(g,I){return g&&me(g,I,ds)}function He(g,I){return ei(I,function(F){return Ac(g[F])})}function je(g,I){I=qu(I,g);for(var F=0,nt=I.length;g!=null&&F<nt;)g=g[Bl(I[F++])];return F&&F==nt?g:n}function De(g,I,F){var nt=I(g);return hr(g)?nt:sr(nt,F(g))}function An(g){return g==null?g===n?Ye:gt:kl&&kl in Lr(g)?wy(g):Qg(g)}function Fe(g,I){return g>I}function fn(g,I){return g!=null&&rn.call(g,I)}function Je(g,I){return g!=null&&I in Lr(g)}function Ln(g,I,F){return g>=ne(I,F)&&g<St(I,F)}function tn(g,I,F){for(var nt=F?Qr:To,At=g[0].length,Rt=g.length,se=Rt,Ie=on(Rt),Be=1/0,Tn=[];se--;){var kn=g[se];se&&I&&(kn=tr(kn,Wo(I))),Be=ne(kn.length,Be),Ie[se]=!F&&(I||At>=120&&kn.length>=120)?new iu(se&&kn):n}kn=g[0];var Rn=-1,si=Ie[0];t:for(;++Rn<At&&Tn.length<Be;){var Ci=kn[Rn],Yi=I?I(Ci):Ci;if(Ci=F||Ci!==0?Ci:0,!(si?Zs(si,Yi):nt(Tn,Yi,F))){for(se=Rt;--se;){var Cr=Ie[se];if(!(Cr?Zs(Cr,Yi):nt(g[se],Yi,F)))continue t}si&&si.push(Yi),Tn.push(Ci)}}return Tn}function xn(g,I,F,nt){return re(g,function(At,Rt,se){I(nt,F(At),Rt,se)}),nt}function zn(g,I,F){I=qu(I,g),g=t_(g,I);var nt=g==null?g:g[Bl(Mu(I))];return nt==null?n:pn(nt,g,F)}function Ne(g){return fs(g)&&An(g)==ye}function $e(g){return fs(g)&&An(g)==_i}function ri(g){return fs(g)&&An(g)==Cn}function fi(g,I,F,nt,At){return g===I?!0:g==null||I==null||!fs(g)&&!fs(I)?g!==g&&I!==I:oi(g,I,F,nt,fi,At)}function oi(g,I,F,nt,At,Rt){var se=hr(g),Ie=hr(I),Be=se?fe:Ka(g),Tn=Ie?fe:Ka(I);Be=Be==ye?dt:Be,Tn=Tn==ye?dt:Tn;var kn=Be==dt,Rn=Tn==dt,si=Be==Tn;if(si&&ic(g)){if(!ic(I))return!1;se=!0,kn=!1}if(si&&!kn)return Rt||(Rt=new vl),se||rc(g)?Wg(g,I,F,nt,At,Rt):Yg(g,I,Be,F,nt,At,Rt);if(!(F&K)){var Ci=kn&&rn.call(g,"__wrapped__"),Yi=Rn&&rn.call(I,"__wrapped__");if(Ci||Yi){var Cr=Ci?g.value():g,Ji=Yi?I.value():I;return Rt||(Rt=new vl),At(Cr,Ji,F,nt,Rt)}}return si?(Rt||(Rt=new vl),sw(g,I,F,nt,At,Rt)):!1}function Li(g){return fs(g)&&Ka(g)==R}function Ki(g,I,F,nt){var At=F.length,Rt=At,se=!nt;if(g==null)return!Rt;for(g=Lr(g);At--;){var Ie=F[At];if(se&&Ie[2]?Ie[1]!==g[Ie[0]]:!(Ie[0]in g))return!1}for(;++At<Rt;){Ie=F[At];var Be=Ie[0],Tn=g[Be],kn=Ie[1];if(se&&Ie[2]){if(Tn===n&&!(Be in g))return!1}else{var Rn=new vl;if(nt)var si=nt(Tn,kn,Be,g,I,Rn);if(!(si===n?fi(kn,Tn,K|q,nt,Rn):si))return!1}}return!0}function gi(g){if(!$o(g)||Rl(g))return!1;var I=Ac(g)?Mi:Qn;return I.test(tc(g))}function Kn(g){return fs(g)&&An(g)==we}function Hr(g){return fs(g)&&Ka(g)==We}function Dr(g){return fs(g)&&$r(g.length)&&!!Ei[An(g)]}function to(g){return typeof g=="function"?g:g==null?Ds:typeof g=="object"?hr(g)?mo(g[0],g[1]):ru(g):X_(g)}function Wr(g){if(!Nf(g))return ut(g);var I=[];for(var F in Lr(g))rn.call(g,F)&&F!="constructor"&&I.push(F);return I}function qa(g){if(!$o(g))return Jh(g);var I=Nf(g),F=[];for(var nt in g)nt=="constructor"&&(I||!rn.call(g,nt))||F.push(nt);return F}function Ra(g,I){return g<I}function va(g,I){var F=-1,nt=_o(g)?on(g.length):[];return Bt(g,function(At,Rt,se){nt[++F]=I(At,Rt,se)}),nt}function ru(g){var I=rm(g);return I.length==1&&I[0][2]?am(I[0][0],I[0][1]):function(F){return F===g||Ki(F,g,I)}}function mo(g,I){return Kg(g)&&Su(I)?am(Bl(g),I):function(F){var nt=Em(F,g);return nt===n&&nt===I?nf(F,g):fi(I,nt,K|q)}}function Yr(g,I,F,nt,At){g!==I&&Kt(I,function(Rt,se){if(At||(At=new vl),$o(Rt))kr(g,I,se,F,Yr,nt,At);else{var Ie=nt?nt(e_(g,se),Rt,se+"",g,I,At):n;Ie===n&&(Ie=Rt),Gc(g,se,Ie)}},wl)}function kr(g,I,F,nt,At,Rt,se){var Ie=e_(g,F),Be=e_(I,F),Tn=se.get(Be);if(Tn){Gc(g,F,Tn);return}var kn=Rt?Rt(Ie,Be,F+"",g,I,se):n,Rn=kn===n;if(Rn){var si=hr(Be),Ci=!si&&ic(Be),Yi=!si&&!Ci&&rc(Be);kn=Be,si||Ci||Yi?hr(Ie)?kn=Ie:So(Ie)?kn=bs(Ie):Ci?(Rn=!1,kn=xc(Be,!0)):Yi?(Rn=!1,kn=gy(Be,!0)):kn=[]:Qd(Be)||ef(Be)?(kn=Ie,ef(Ie)?kn=Am(Ie):(!$o(Ie)||Ac(Ie))&&(kn=Jg(Be))):Rn=!1}Rn&&(se.set(Be,kn),At(kn,Be,nt,Rt,se),se.delete(Be)),Gc(g,F,kn)}function Ho(g,I){var F=g.length;if(F)return I+=I<0?F:0,Ic(I,F)?g[I]:n}function sa(g,I,F){I.length?I=tr(I,function(Rt){return hr(Rt)?function(se){return je(se,Rt.length===1?Rt[0]:Rt)}:Rt}):I=[Ds];var nt=-1;I=tr(I,Wo(Fi()));var At=va(g,function(Rt,se,Ie){var Be=tr(I,function(Tn){return Tn(Rt)});return{criteria:Be,index:++nt,value:Rt}});return mc(At,function(Rt,se){return Fg(Rt,se,F)})}function go(g,I){return ya(g,I,function(F,nt){return nf(g,nt)})}function ya(g,I,F){for(var nt=-1,At=I.length,Rt={};++nt<At;){var se=I[nt],Ie=je(g,se);F(Ie,se)&&Zc(Rt,qu(se,g),Ie)}return Rt}function Zh(g){return function(I){return je(I,g)}}function ou(g,I,F,nt){var At=nt?us:Ri,Rt=-1,se=I.length,Ie=g;for(g===I&&(I=bs(I)),F&&(Ie=tr(g,Wo(F)));++Rt<se;)for(var Be=0,Tn=I[Rt],kn=F?F(Tn):Tn;(Be=At(Ie,kn,Be,nt))>-1;)Ie!==g&&zs.call(Ie,Be,1),zs.call(g,Be,1);return g}function aa(g,I){for(var F=g?I.length:0,nt=F-1;F--;){var At=I[F];if(F==nt||At!==Rt){var Rt=At;Ic(At)?zs.call(g,At,1):Qp(g,At)}}return g}function Ja(g,I){return g+jc(On()*(I-g+1))}function Au(g,I,F,nt){for(var At=-1,Rt=St(Ql((I-g)/(F||1)),0),se=on(Rt);Rt--;)se[nt?Rt:++At]=g,g+=F;return se}function Nl(g,I){var F="";if(!g||I<1||I>_e)return F;do I%2&&(F+=g),I=jc(I/2),I&&(g+=g);while(I);return F}function ar(g,I){return Kh(jd(g,I,Ds),g+"")}function mh(g){return zd(rf(g))}function Tu(g,I){var F=rf(g);return Rf(F,G(I,0,F.length))}function Zc(g,I,F,nt){if(!$o(g))return g;I=qu(I,g);for(var At=-1,Rt=I.length,se=Rt-1,Ie=g;Ie!=null&&++At<Rt;){var Be=Bl(I[At]),Tn=F;if(Be==="__proto__"||Be==="constructor"||Be==="prototype")return g;if(At!=se){var kn=Ie[Be];Tn=nt?nt(kn,Be,Ie):n,Tn===n&&(Tn=$o(kn)?kn:Ic(I[At+1])?[]:{})}_(Ie,Be,Tn),Ie=Ie[Be]}return g}var Nd=zl?function(g,I){return zl.set(g,I),g}:Ds,cy=Pl?function(g,I){return Pl(g,"toString",{configurable:!0,enumerable:!1,value:V_(I),writable:!0})}:Ds;function Dg(g){return Rf(rf(g))}function su(g,I,F){var nt=-1,At=g.length;I<0&&(I=-I>At?0:At+I),F=F>At?At:F,F<0&&(F+=At),At=I>F?0:F-I>>>0,I>>>=0;for(var Rt=on(At);++nt<At;)Rt[nt]=g[nt+I];return Rt}function hy(g,I){var F;return Bt(g,function(nt,At,Rt){return F=I(nt,At,Rt),!F}),!!F}function Od(g,I,F){var nt=0,At=g==null?nt:g.length;if(typeof I=="number"&&I===I&&At<=Ee){for(;nt<At;){var Rt=nt+At>>>1,se=g[Rt];se!==null&&!nl(se)&&(F?se<=I:se<I)?nt=Rt+1:At=Rt}return At}return Kp(g,I,Ds,F)}function Kp(g,I,F,nt){var At=0,Rt=g==null?0:g.length;if(Rt===0)return 0;I=F(I);for(var se=I!==I,Ie=I===null,Be=nl(I),Tn=I===n;At<Rt;){var kn=jc((At+Rt)/2),Rn=F(g[kn]),si=Rn!==n,Ci=Rn===null,Yi=Rn===Rn,Cr=nl(Rn);if(se)var Ji=nt||Yi;else Tn?Ji=Yi&&(nt||si):Ie?Ji=Yi&&si&&(nt||!Ci):Be?Ji=Yi&&si&&!Ci&&(nt||!Cr):Ci||Cr?Ji=!1:Ji=nt?Rn<=I:Rn<I;Ji?At=kn+1:Rt=kn}return ne(Rt,Yt)}function Ng(g,I){for(var F=-1,nt=g.length,At=0,Rt=[];++F<nt;){var se=g[F],Ie=I?I(se):se;if(!F||!nc(Ie,Be)){var Be=Ie;Rt[At++]=se===0?0:se}}return Rt}function Og(g){return typeof g=="number"?g:nl(g)?be:+g}function Ol(g){if(typeof g=="string")return g;if(hr(g))return tr(g,Ol)+"";if(nl(g))return Uh?Uh.call(g):"";var I=g+"";return I=="0"&&1/g==-Le?"-0":I}function Vc(g,I,F){var nt=-1,At=To,Rt=g.length,se=!0,Ie=[],Be=Ie;if(F)se=!1,At=Qr;else if(Rt>=l){var Tn=I?null:xa(g);if(Tn)return Ml(Tn);se=!1,At=Zs,Be=new iu}else Be=I?[]:Ie;t:for(;++nt<Rt;){var kn=g[nt],Rn=I?I(kn):kn;if(kn=F||kn!==0?kn:0,se&&Rn===Rn){for(var si=Be.length;si--;)if(Be[si]===Rn)continue t;I&&Be.push(Rn),Ie.push(kn)}else At(Be,Rn,F)||(Be!==Ie&&Be.push(Rn),Ie.push(kn))}return Ie}function Qp(g,I){return I=qu(I,g),g=t_(g,I),g==null||delete g[Bl(Mu(I))]}function fy(g,I,F,nt){return Zc(g,I,F(je(g,I)),nt)}function tm(g,I,F,nt){for(var At=g.length,Rt=nt?At:-1;(nt?Rt--:++Rt<At)&&I(g[Rt],Rt,g););return F?su(g,nt?0:Rt,nt?Rt+1:At):su(g,nt?Rt+1:0,nt?At:Rt)}function Vh(g,I){var F=g;return F instanceof Ni&&(F=F.value()),Di(I,function(nt,At){return At.func.apply(At.thisArg,sr([nt],At.args))},F)}function em(g,I,F){var nt=g.length;if(nt<2)return nt?Vc(g[0]):[];for(var At=-1,Rt=on(nt);++At<nt;)for(var se=g[At],Ie=-1;++Ie<nt;)Ie!=At&&(Rt[At]=Mt(Rt[At]||se,g[Ie],I,F));return Vc(jt(Rt,1),I,F)}function Rg(g,I,F){for(var nt=-1,At=g.length,Rt=I.length,se={};++nt<At;){var Ie=nt<Rt?I[nt]:n;F(se,g[nt],Ie)}return se}function nm(g){return So(g)?g:[]}function Bg(g){return typeof g=="function"?g:Ds}function qu(g,I){return hr(g)?g:Kg(g,I)?[g]:n_(Eo(g))}var dy=ar;function yc(g,I,F){var nt=g.length;return F=F===n?nt:F,!I&&F>=nt?g:su(g,I,F)}var Rd=_c||function(g){return oe.clearTimeout(g)};function xc(g,I){if(I)return g.slice();var F=g.length,nt=fo?fo(F):new g.constructor(F);return g.copy(nt),nt}function Mf(g){var I=new g.constructor(g.byteLength);return new Ii(I).set(new Ii(g)),I}function py(g,I){var F=I?Mf(g.buffer):g.buffer;return new g.constructor(F,g.byteOffset,g.byteLength)}function my(g){var I=new g.constructor(g.source,bn.exec(g));return I.lastIndex=g.lastIndex,I}function iw(g){return eu?Lr(eu.call(g)):{}}function gy(g,I){var F=I?Mf(g.buffer):g.buffer;return new g.constructor(F,g.byteOffset,g.length)}function _y(g,I){if(g!==I){var F=g!==n,nt=g===null,At=g===g,Rt=nl(g),se=I!==n,Ie=I===null,Be=I===I,Tn=nl(I);if(!Ie&&!Tn&&!Rt&&g>I||Rt&&se&&Be&&!Ie&&!Tn||nt&&se&&Be||!F&&Be||!At)return 1;if(!nt&&!Rt&&!Tn&&g<I||Tn&&F&&At&&!nt&&!Rt||Ie&&F&&At||!se&&At||!Be)return-1}return 0}function Fg(g,I,F){for(var nt=-1,At=g.criteria,Rt=I.criteria,se=At.length,Ie=F.length;++nt<se;){var Be=_y(At[nt],Rt[nt]);if(Be){if(nt>=Ie)return Be;var Tn=F[nt];return Be*(Tn=="desc"?-1:1)}}return g.index-I.index}function Lf(g,I,F,nt){for(var At=-1,Rt=g.length,se=F.length,Ie=-1,Be=I.length,Tn=St(Rt-se,0),kn=on(Be+Tn),Rn=!nt;++Ie<Be;)kn[Ie]=I[Ie];for(;++At<se;)(Rn||At<Rt)&&(kn[F[At]]=g[At]);for(;Tn--;)kn[Ie++]=g[At++];return kn}function Wh(g,I,F,nt){for(var At=-1,Rt=g.length,se=-1,Ie=F.length,Be=-1,Tn=I.length,kn=St(Rt-Ie,0),Rn=on(kn+Tn),si=!nt;++At<kn;)Rn[At]=g[At];for(var Ci=At;++Be<Tn;)Rn[Ci+Be]=I[Be];for(;++se<Ie;)(si||At<Rt)&&(Rn[Ci+F[se]]=g[At++]);return Rn}function bs(g,I){var F=-1,nt=g.length;for(I||(I=on(nt));++F<nt;)I[F]=g[F];return I}function Xs(g,I,F,nt){var At=!F;F||(F={});for(var Rt=-1,se=I.length;++Rt<se;){var Ie=I[Rt],Be=nt?nt(F[Ie],g[Ie],Ie,F,g):n;Be===n&&(Be=g[Ie]),At?S(F,Ie,Be):_(F,Ie,Be)}return F}function gh(g,I){return Xs(g,Hg(g),I)}function _h(g,I){return Xs(g,om(g),I)}function wc(g,I){return function(F,nt){var At=hr(F)?qe:f,Rt=I?I():{};return At(F,g,Fi(nt,2),Rt)}}function kf(g){return ar(function(I,F){var nt=-1,At=F.length,Rt=At>1?F[At-1]:n,se=At>2?F[2]:n;for(Rt=g.length>3&&typeof Rt=="function"?(At--,Rt):n,se&&Qa(F[0],F[1],se)&&(Rt=At<3?n:Rt,At=1),I=Lr(I);++nt<At;){var Ie=F[nt];Ie&&g(I,Ie,nt,Rt)}return I})}function vy(g,I){return function(F,nt){if(F==null)return F;if(!_o(F))return g(F,nt);for(var At=F.length,Rt=I?At:-1,se=Lr(F);(I?Rt--:++Rt<At)&&nt(se[Rt],Rt,se)!==!1;);return F}}function yy(g){return function(I,F,nt){for(var At=-1,Rt=Lr(I),se=nt(I),Ie=se.length;Ie--;){var Be=se[g?Ie:++At];if(F(Rt[Be],Be,Rt)===!1)break}return I}}function rw(g,I,F){var nt=I&at,At=yl(g);function Rt(){var se=this&&this!==oe&&this instanceof Rt?At:g;return se.apply(nt?F:this,arguments)}return Rt}function jg(g){return function(I){I=Eo(I);var F=xs(I)?Ls(I):n,nt=F?F[0]:I.charAt(0),At=F?yc(F,1).join(""):I.slice(1);return nt[g]()+At}}function Wc(g){return function(I){return Di(sf(R_(I).replace(zr,"")),g,"")}}function yl(g){return function(){var I=arguments;switch(I.length){case 0:return new g;case 1:return new g(I[0]);case 2:return new g(I[0],I[1]);case 3:return new g(I[0],I[1],I[2]);case 4:return new g(I[0],I[1],I[2],I[3]);case 5:return new g(I[0],I[1],I[2],I[3],I[4]);case 6:return new g(I[0],I[1],I[2],I[3],I[4],I[5]);case 7:return new g(I[0],I[1],I[2],I[3],I[4],I[5],I[6])}var F=nu(g.prototype),nt=g.apply(F,I);return $o(nt)?nt:F}}function ow(g,I,F){var nt=yl(g);function At(){for(var Rt=arguments.length,se=on(Rt),Ie=Rt,Be=Xc(At);Ie--;)se[Ie]=arguments[Ie];var Tn=Rt<3&&se[0]!==Be&&se[Rt-1]!==Be?[]:ho(se,Be);if(Rt-=Tn.length,Rt<F)return lu(g,I,xi,At.placeholder,n,se,Tn,n,n,F-Rt);var kn=this&&this!==oe&&this instanceof At?nt:g;return pn(kn,this,se)}return At}function xy(g){return function(I,F,nt){var At=Lr(I);if(!_o(I)){var Rt=Fi(F,3);I=ds(I),F=function(Ie){return Rt(At[Ie],Ie,At)}}var se=g(I,F,nt);return se>-1?At[Rt?I[se]:se]:n}}function cs(g){return Ku(function(I){var F=I.length,nt=F,At=_a.prototype.thru;for(g&&I.reverse();nt--;){var Rt=I[nt];if(typeof Rt!="function")throw new Vs(p);if(At&&!se&&bc(Rt)=="wrapper")var se=new _a([],!0)}for(nt=se?nt:F;++nt<F;){Rt=I[nt];var Ie=bc(Rt),Be=Ie=="wrapper"?Qu(Rt):n;Be&&Df(Be[0])&&Be[1]==(rt|lt|j|yt)&&!Be[4].length&&Be[9]==1?se=se[bc(Be[0])].apply(se,Be[3]):se=Rt.length==1&&Df(Rt)?se[Ie]():se.thru(Rt)}return function(){var Tn=arguments,kn=Tn[0];if(se&&Tn.length==1&&hr(kn))return se.plant(kn).value();for(var Rn=0,si=F?I[Rn].apply(this,Tn):kn;++Rn<F;)si=I[Rn].call(this,si);return si}})}function xi(g,I,F,nt,At,Rt,se,Ie,Be,Tn){var kn=I&rt,Rn=I&at,si=I&J,Ci=I&(lt|Ct),Yi=I&xt,Cr=si?n:yl(g);function Ji(){for(var Pr=arguments.length,Br=on(Pr),jl=Pr;jl--;)Br[jl]=arguments[jl];if(Ci)var il=Xc(Ji),Ul=xu(Br,il);if(nt&&(Br=Lf(Br,nt,At,Ci)),Rt&&(Br=Wh(Br,Rt,se,Ci)),Pr-=Ul,Ci&&Pr<Tn){var Is=ho(Br,il);return lu(g,I,xi,Ji.placeholder,F,Br,Is,Ie,Be,Tn-Pr)}var ba=Rn?F:this,Ec=si?ba[g]:g;return Pr=Br.length,Ie?Br=Cy(Br,Ie):Yi&&Pr>1&&Br.reverse(),kn&&Be<Pr&&(Br.length=Be),this&&this!==oe&&this instanceof Ji&&(Ec=Cr||yl(Ec)),Ec.apply(ba,Br)}return Ji}function Yc(g,I){return function(F,nt){return xn(F,g,I(nt),{})}}function Yh(g,I){return function(F,nt){var At;if(F===n&&nt===n)return I;if(F!==n&&(At=F),nt!==n){if(At===n)return nt;typeof F=="string"||typeof nt=="string"?(F=Ol(F),nt=Ol(nt)):(F=Og(F),nt=Og(nt)),At=g(F,nt)}return At}}function br(g){return Ku(function(I){return I=tr(I,Wo(Fi())),ar(function(F){var nt=this;return g(I,function(At){return pn(At,nt,F)})})})}function Bd(g,I){I=I===n?" ":Ol(I);var F=I.length;if(F<2)return F?Nl(I,g):I;var nt=Nl(I,Ql(g/dr(I)));return xs(I)?yc(Ls(nt),0,g).join(""):nt.slice(0,g)}function Ug(g,I,F,nt){var At=I&at,Rt=yl(g);function se(){for(var Ie=-1,Be=arguments.length,Tn=-1,kn=nt.length,Rn=on(kn+Be),si=this&&this!==oe&&this instanceof se?Rt:g;++Tn<kn;)Rn[Tn]=nt[Tn];for(;Be--;)Rn[Tn++]=arguments[++Ie];return pn(si,At?F:this,Rn)}return se}function Ju(g){return function(I,F,nt){return nt&&typeof nt!="number"&&Qa(I,F,nt)&&(F=nt=n),I=Tc(I),F===n?(F=I,I=0):F=Tc(F),nt=nt===n?I<F?1:-1:Tc(nt),Au(I,F,nt,g)}}function au(g){return function(I,F){return typeof I=="string"&&typeof F=="string"||(I=Ba(I),F=Ba(F)),g(I,F)}}function lu(g,I,F,nt,At,Rt,se,Ie,Be,Tn){var kn=I&lt,Rn=kn?se:n,si=kn?n:se,Ci=kn?Rt:n,Yi=kn?n:Rt;I|=kn?j:k,I&=~(kn?k:j),I&Q||(I&=~(at|J));var Cr=[g,I,At,Ci,Rn,Yi,si,Ie,Be,Tn],Ji=F.apply(n,Cr);return Df(g)&&lm(Ji,Cr),Ji.placeholder=nt,Qh(Ji,g,I)}function xl(g){var I=Do[g];return function(F,nt){if(F=Ba(F),nt=nt==null?0:ne(Vi(nt),292),nt&&D(F)){var At=(Eo(F)+"e").split("e"),Rt=I(At[0]+"e"+(+At[1]+nt));return At=(Eo(Rt)+"e").split("e"),+(At[0]+"e"+(+At[1]-nt))}return I(F)}}var xa=ra&&1/Ml(new ra([,-0]))[1]==Le?function(g){return new ra(g)}:Y_;function Gg(g){return function(I){var F=Ka(I);return F==R?El(I):F==We?Ll(I):Zu(I,g(I))}}function wa(g,I,F,nt,At,Rt,se,Ie){var Be=I&J;if(!Be&&typeof g!="function")throw new Vs(p);var Tn=nt?nt.length:0;if(Tn||(I&=~(j|k),nt=At=n),se=se===n?se:St(Vi(se),0),Ie=Ie===n?Ie:Vi(Ie),Tn-=At?At.length:0,I&k){var kn=nt,Rn=At;nt=At=n}var si=Be?n:Qu(g),Ci=[g,I,F,nt,At,kn,Rn,Rt,se,Ie];if(si&&Fd(Ci,si),g=Ci[0],I=Ci[1],F=Ci[2],nt=Ci[3],At=Ci[4],Ie=Ci[9]=Ci[9]===n?Be?0:g.length:St(Ci[9]-Tn,0),!Ie&&I&(lt|Ct)&&(I&=~(lt|Ct)),!I||I==at)var Yi=rw(g,I,F);else I==lt||I==Ct?Yi=ow(g,I,Ie):(I==j||I==(at|j))&&!At.length?Yi=Ug(g,I,F,nt):Yi=xi.apply(n,Ci);var Cr=si?Nd:lm;return Qh(Cr(Yi,Ci),g,I)}function Zg(g,I,F,nt){return g===n||nc(g,Ce[F])&&!rn.call(nt,F)?I:g}function Xh(g,I,F,nt,At,Rt){return $o(g)&&$o(I)&&(Rt.set(I,g),Yr(g,I,n,Xh,Rt),Rt.delete(I)),g}function Vg(g){return Qd(g)?n:g}function Wg(g,I,F,nt,At,Rt){var se=F&K,Ie=g.length,Be=I.length;if(Ie!=Be&&!(se&&Be>Ie))return!1;var Tn=Rt.get(g),kn=Rt.get(I);if(Tn&&kn)return Tn==I&&kn==g;var Rn=-1,si=!0,Ci=F&q?new iu:n;for(Rt.set(g,I),Rt.set(I,g);++Rn<Ie;){var Yi=g[Rn],Cr=I[Rn];if(nt)var Ji=se?nt(Cr,Yi,Rn,I,g,Rt):nt(Yi,Cr,Rn,g,I,Rt);if(Ji!==n){if(Ji)continue;si=!1;break}if(Ci){if(!er(I,function(Pr,Br){if(!Zs(Ci,Br)&&(Yi===Pr||At(Yi,Pr,F,nt,Rt)))return Ci.push(Br)})){si=!1;break}}else if(!(Yi===Cr||At(Yi,Cr,F,nt,Rt))){si=!1;break}}return Rt.delete(g),Rt.delete(I),si}function Yg(g,I,F,nt,At,Rt,se){switch(F){case ui:if(g.byteLength!=I.byteLength||g.byteOffset!=I.byteOffset)return!1;g=g.buffer,I=I.buffer;case _i:return!(g.byteLength!=I.byteLength||!Rt(new Ii(g),new Ii(I)));case Ue:case Cn:case st:return nc(+g,+I);case Pn:return g.name==I.name&&g.message==I.message;case we:case pe:return g==I+"";case R:var Ie=El;case We:var Be=nt&K;if(Ie||(Ie=Ml),g.size!=I.size&&!Be)return!1;var Tn=se.get(g);if(Tn)return Tn==I;nt|=q,se.set(g,I);var kn=Wg(Ie(g),Ie(I),nt,At,Rt,se);return se.delete(g),kn;case un:if(eu)return eu.call(g)==eu.call(I)}return!1}function sw(g,I,F,nt,At,Rt){var se=F&K,Ie=im(g),Be=Ie.length,Tn=im(I),kn=Tn.length;if(Be!=kn&&!se)return!1;for(var Rn=Be;Rn--;){var si=Ie[Rn];if(!(se?si in I:rn.call(I,si)))return!1}var Ci=Rt.get(g),Yi=Rt.get(I);if(Ci&&Yi)return Ci==I&&Yi==g;var Cr=!0;Rt.set(g,I),Rt.set(I,g);for(var Ji=se;++Rn<Be;){si=Ie[Rn];var Pr=g[si],Br=I[si];if(nt)var jl=se?nt(Br,Pr,si,I,g,Rt):nt(Pr,Br,si,g,I,Rt);if(!(jl===n?Pr===Br||At(Pr,Br,F,nt,Rt):jl)){Cr=!1;break}Ji||(Ji=si=="constructor")}if(Cr&&!Ji){var il=g.constructor,Ul=I.constructor;il!=Ul&&"constructor"in g&&"constructor"in I&&!(typeof il=="function"&&il instanceof il&&typeof Ul=="function"&&Ul instanceof Ul)&&(Cr=!1)}return Rt.delete(g),Rt.delete(I),Cr}function Ku(g){return Kh(jd(g,n,o_),g+"")}function im(g){return De(g,ds,Hg)}function Xg(g){return De(g,wl,om)}var Qu=zl?function(g){return zl.get(g)}:Y_;function bc(g){for(var I=g.name+"",F=Xu[I],nt=rn.call(Xu,I)?F.length:0;nt--;){var At=F[nt],Rt=At.func;if(Rt==null||Rt==g)return At.name}return I}function Xc(g){var I=rn.call(Dt,"placeholder")?Dt:g;return I.placeholder}function Fi(){var g=Dt.iteratee||W_;return g=g===W_?to:g,arguments.length?g(arguments[0],arguments[1]):g}function Pf(g,I){var F=g.__data__;return lw(I)?F[typeof I=="string"?"string":"hash"]:F.map}function rm(g){for(var I=ds(g),F=I.length;F--;){var nt=I[F],At=g[nt];I[F]=[nt,At,Su(At)]}return I}function Hh(g,I){var F=Ha(g,I);return gi(F)?F:n}function wy(g){var I=rn.call(g,kl),F=g[kl];try{g[kl]=n;var nt=!0}catch{}var At=Mn.call(g);return nt&&(I?g[kl]=F:delete g[kl]),At}var Hg=d?function(g){return g==null?[]:(g=Lr(g),ei(d(g),function(I){return Rr.call(g,I)}))}:Om,om=d?function(g){for(var I=[];g;)sr(I,Hg(g)),g=po(g);return I}:Om,Ka=An;(Zi&&Ka(new Zi(new ArrayBuffer(1)))!=ui||Qi&&Ka(new Qi)!=R||Ys&&Ka(Ys.resolve())!=wt||ra&&Ka(new ra)!=We||tu&&Ka(new tu)!=Ge)&&(Ka=function(g){var I=An(g),F=I==dt?g.constructor:n,nt=F?tc(F):"";if(nt)switch(nt){case Bh:return ui;case Fh:return R;case jh:return wt;case fh:return We;case Dl:return Ge}return I});function $g(g,I,F){for(var nt=-1,At=F.length;++nt<At;){var Rt=F[nt],se=Rt.size;switch(Rt.type){case"drop":g+=se;break;case"dropRight":I-=se;break;case"take":I=ne(I,g+se);break;case"takeRight":g=St(g,I-se);break}}return{start:g,end:I}}function by(g){var I=g.match(Pe);return I?I[1].split(Se):[]}function qg(g,I,F){I=qu(I,g);for(var nt=-1,At=I.length,Rt=!1;++nt<At;){var se=Bl(I[nt]);if(!(Rt=g!=null&&F(g,se)))break;g=g[se]}return Rt||++nt!=At?Rt:(At=g==null?0:g.length,!!At&&$r(At)&&Ic(se,At)&&(hr(g)||ef(g)))}function $h(g){var I=g.length,F=new g.constructor(I);return I&&typeof g[0]=="string"&&rn.call(g,"index")&&(F.index=g.index,F.input=g.input),F}function Jg(g){return typeof g.constructor=="function"&&!Nf(g)?nu(po(g)):{}}function aw(g,I,F){var nt=g.constructor;switch(I){case _i:return Mf(g);case Ue:case Cn:return new nt(+g);case ui:return py(g,F);case ji:case Hi:case vr:case Jr:case $i:case uo:case Go:case Ir:case Ar:return gy(g,F);case R:return new nt;case st:case pe:return new nt(g);case we:return my(g);case We:return new nt;case un:return iw(g)}}function zf(g,I){var F=I.length;if(!F)return g;var nt=F-1;return I[nt]=(F>1?"& ":"")+I[nt],I=I.join(F>2?", ":" "),g.replace(Ht,`{
/* [wrapped with `+I+`] */
`)}function sm(g){return hr(g)||ef(g)||!!(Ws&&g&&g[Ws])}function Ic(g,I){var F=typeof g;return I=I??_e,!!I&&(F=="number"||F!="symbol"&&qi.test(g))&&g>-1&&g%1==0&&g<I}function Qa(g,I,F){if(!$o(F))return!1;var nt=typeof I;return(nt=="number"?_o(F)&&Ic(I,F.length):nt=="string"&&I in F)?nc(F[I],g):!1}function Kg(g,I){if(hr(g))return!1;var F=typeof g;return F=="number"||F=="symbol"||F=="boolean"||g==null||nl(g)?!0:Ea.test(g)||!js.test(g)||I!=null&&g in Lr(I)}function lw(g){var I=typeof g;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?g!=="__proto__":g===null}function Df(g){var I=bc(g),F=Dt[I];if(typeof F!="function"||!(I in Ni.prototype))return!1;if(g===F)return!0;var nt=Qu(F);return!!nt&&g===nt[0]}function Rl(g){return!!Yn&&Yn in g}var Iy=vn?Ac:H_;function Nf(g){var I=g&&g.constructor,F=typeof I=="function"&&I.prototype||Ce;return g===F}function Su(g){return g===g&&!$o(g)}function am(g,I){return function(F){return F==null?!1:F[g]===I&&(I!==n||g in Lr(F))}}function qh(g){var I=la(g,function(nt){return F.size===M&&F.clear(),nt}),F=I.cache;return I}function Fd(g,I){var F=g[1],nt=I[1],At=F|nt,Rt=At<(at|J|rt),se=nt==rt&&F==lt||nt==rt&&F==yt&&g[7].length<=I[8]||nt==(rt|yt)&&I[7].length<=I[8]&&F==lt;if(!(Rt||se))return g;nt&at&&(g[2]=I[2],At|=F&at?0:Q);var Ie=I[3];if(Ie){var Be=g[3];g[3]=Be?Lf(Be,Ie,I[4]):Ie,g[4]=Be?ho(g[3],N):I[4]}return Ie=I[5],Ie&&(Be=g[5],g[5]=Be?Wh(Be,Ie,I[6]):Ie,g[6]=Be?ho(g[5],N):I[6]),Ie=I[7],Ie&&(g[7]=Ie),nt&rt&&(g[8]=g[8]==null?I[8]:ne(g[8],I[8])),g[9]==null&&(g[9]=I[9]),g[0]=I[0],g[1]=At,g}function Jh(g){var I=[];if(g!=null)for(var F in Lr(g))I.push(F);return I}function Qg(g){return Mn.call(g)}function jd(g,I,F){return I=St(I===n?g.length-1:I,0),function(){for(var nt=arguments,At=-1,Rt=St(nt.length-I,0),se=on(Rt);++At<Rt;)se[At]=nt[I+At];At=-1;for(var Ie=on(I+1);++At<I;)Ie[At]=nt[At];return Ie[I]=F(se),pn(g,this,Ie)}}function t_(g,I){return I.length<2?g:je(g,su(I,0,-1))}function Cy(g,I){for(var F=g.length,nt=ne(I.length,F),At=bs(g);nt--;){var Rt=I[nt];g[nt]=Ic(Rt,F)?At[Rt]:n}return g}function e_(g,I){if(!(I==="constructor"&&typeof g[I]=="function")&&I!="__proto__")return g[I]}var lm=Cc(Nd),Of=Oa||function(g,I){return oe.setTimeout(g,I)},Kh=Cc(cy);function Qh(g,I,F){var nt=I+"";return Kh(g,zf(nt,uu(by(nt),F)))}function Cc(g){var I=0,F=0;return function(){var nt=Ve(),At=te-(nt-F);if(F=nt,At>0){if(++I>=Et)return arguments[0]}else I=0;return g.apply(n,arguments)}}function Rf(g,I){var F=-1,nt=g.length,At=nt-1;for(I=I===n?nt:I;++F<I;){var Rt=Ja(F,At),se=g[Rt];g[Rt]=g[F],g[F]=se}return g.length=I,g}var n_=qh(function(g){var I=[];return g.charCodeAt(0)===46&&I.push(""),g.replace(Vt,function(F,nt,At,Rt){I.push(At?Rt.replace(hn,"$1"):nt||F)}),I});function Bl(g){if(typeof g=="string"||nl(g))return g;var I=g+"";return I=="0"&&1/g==-Le?"-0":I}function tc(g){if(g!=null){try{return ke.call(g)}catch{}try{return g+""}catch{}}return""}function uu(g,I){return an(ve,function(F){var nt="_."+F[0];I&F[1]&&!To(g,nt)&&g.push(nt)}),g.sort()}function Bf(g){if(g instanceof Ni)return g.clone();var I=new _a(g.__wrapped__,g.__chain__);return I.__actions__=bs(g.__actions__),I.__index__=g.__index__,I.__values__=g.__values__,I}function tl(g,I,F){(F?Qa(g,I,F):I===n)?I=1:I=St(Vi(I),0);var nt=g==null?0:g.length;if(!nt||I<1)return[];for(var At=0,Rt=0,se=on(Ql(nt/I));At<nt;)se[Rt++]=su(g,At,At+=I);return se}function Eu(g){for(var I=-1,F=g==null?0:g.length,nt=0,At=[];++I<F;){var Rt=g[I];Rt&&(At[nt++]=Rt)}return At}function i_(){var g=arguments.length;if(!g)return[];for(var I=on(g-1),F=arguments[0],nt=g;nt--;)I[nt-1]=arguments[nt];return sr(hr(F)?bs(F):[F],jt(I,1))}var os=ar(function(g,I){return So(g)?Mt(g,jt(I,1,So,!0)):[]}),Ay=ar(function(g,I){var F=Mu(I);return So(F)&&(F=n),So(g)?Mt(g,jt(I,1,So,!0),Fi(F,2)):[]}),Ud=ar(function(g,I){var F=Mu(I);return So(F)&&(F=n),So(g)?Mt(g,jt(I,1,So,!0),n,F):[]});function ec(g,I,F){var nt=g==null?0:g.length;return nt?(I=F||I===n?1:Vi(I),su(g,I<0?0:I,nt)):[]}function uw(g,I,F){var nt=g==null?0:g.length;return nt?(I=F||I===n?1:Vi(I),I=nt-I,su(g,0,I<0?0:I)):[]}function cw(g,I){return g&&g.length?tm(g,Fi(I,3),!0,!0):[]}function Ty(g,I){return g&&g.length?tm(g,Fi(I,3),!0):[]}function Sy(g,I,F,nt){var At=g==null?0:g.length;return At?(F&&typeof F!="number"&&Qa(g,I,F)&&(F=0,nt=At),Ot(g,I,F,nt)):[]}function vh(g,I,F){var nt=g==null?0:g.length;if(!nt)return-1;var At=F==null?0:Vi(F);return At<0&&(At=St(nt+At,0)),Gs(g,Fi(I,3),At)}function r_(g,I,F){var nt=g==null?0:g.length;if(!nt)return-1;var At=nt-1;return F!==n&&(At=Vi(F),At=F<0?St(nt+At,0):ne(At,nt-1)),Gs(g,Fi(I,3),At,!0)}function o_(g){var I=g==null?0:g.length;return I?jt(g,1):[]}function Ey(g){var I=g==null?0:g.length;return I?jt(g,Le):[]}function My(g,I){var F=g==null?0:g.length;return F?(I=I===n?1:Vi(I),jt(g,I)):[]}function hw(g){for(var I=-1,F=g==null?0:g.length,nt={};++I<F;){var At=g[I];nt[At[0]]=At[1]}return nt}function um(g){return g&&g.length?g[0]:n}function s_(g,I,F){var nt=g==null?0:g.length;if(!nt)return-1;var At=F==null?0:Vi(F);return At<0&&(At=St(nt+At,0)),Ri(g,I,At)}function a_(g){var I=g==null?0:g.length;return I?su(g,0,-1):[]}var el=ar(function(g){var I=tr(g,nm);return I.length&&I[0]===g[0]?tn(I):[]}),Ly=ar(function(g){var I=Mu(g),F=tr(g,nm);return I===Mu(F)?I=n:F.pop(),F.length&&F[0]===g[0]?tn(F,Fi(I,2)):[]}),fw=ar(function(g){var I=Mu(g),F=tr(g,nm);return I=typeof I=="function"?I:n,I&&F.pop(),F.length&&F[0]===g[0]?tn(F,n,I):[]});function ky(g,I){return g==null?"":H.call(g,I)}function Mu(g){var I=g==null?0:g.length;return I?g[I-1]:n}function dw(g,I,F){var nt=g==null?0:g.length;if(!nt)return-1;var At=nt;return F!==n&&(At=Vi(F),At=At<0?St(nt+At,0):ne(At,nt-1)),I===I?gl(g,I,At):Gs(g,pa,At,!0)}function Py(g,I){return g&&g.length?Ho(g,Vi(I)):n}var zy=ar(l_);function l_(g,I){return g&&g.length&&I&&I.length?ou(g,I):g}function u_(g,I,F){return g&&g.length&&I&&I.length?ou(g,I,Fi(F,2)):g}function Hc(g,I,F){return g&&g.length&&I&&I.length?ou(g,I,n,F):g}var Fl=Ku(function(g,I){var F=g==null?0:g.length,nt=B(g,I);return aa(g,tr(I,function(At){return Ic(At,F)?+At:At}).sort(_y)),nt});function pw(g,I){var F=[];if(!(g&&g.length))return F;var nt=-1,At=[],Rt=g.length;for(I=Fi(I,3);++nt<Rt;){var se=g[nt];I(se,nt,g)&&(F.push(se),At.push(nt))}return aa(g,At),F}function Gd(g){return g==null?g:ii.call(g)}function mw(g,I,F){var nt=g==null?0:g.length;return nt?(F&&typeof F!="number"&&Qa(g,I,F)?(I=0,F=nt):(I=I==null?0:Vi(I),F=F===n?nt:Vi(F)),su(g,I,F)):[]}function gw(g,I){return Od(g,I)}function _w(g,I,F){return Kp(g,I,Fi(F,2))}function Zd(g,I){var F=g==null?0:g.length;if(F){var nt=Od(g,I);if(nt<F&&nc(g[nt],I))return nt}return-1}function cm(g,I){return Od(g,I,!0)}function Dy(g,I,F){return Kp(g,I,Fi(F,2),!0)}function tf(g,I){var F=g==null?0:g.length;if(F){var nt=Od(g,I,!0)-1;if(nc(g[nt],I))return nt}return-1}function Vd(g){return g&&g.length?Ng(g):[]}function vw(g,I){return g&&g.length?Ng(g,Fi(I,2)):[]}function yw(g){var I=g==null?0:g.length;return I?su(g,1,I):[]}function xw(g,I,F){return g&&g.length?(I=F||I===n?1:Vi(I),su(g,0,I<0?0:I)):[]}function ww(g,I,F){var nt=g==null?0:g.length;return nt?(I=F||I===n?1:Vi(I),I=nt-I,su(g,I<0?0:I,nt)):[]}function bw(g,I){return g&&g.length?tm(g,Fi(I,3),!1,!0):[]}function Iw(g,I){return g&&g.length?tm(g,Fi(I,3)):[]}var Cw=ar(function(g){return Vc(jt(g,1,So,!0))}),c_=ar(function(g){var I=Mu(g);return So(I)&&(I=n),Vc(jt(g,1,So,!0),Fi(I,2))}),Aw=ar(function(g){var I=Mu(g);return I=typeof I=="function"?I:n,Vc(jt(g,1,So,!0),n,I)});function Ff(g){return g&&g.length?Vc(g):[]}function Tw(g,I){return g&&g.length?Vc(g,Fi(I,2)):[]}function hs(g,I){return I=typeof I=="function"?I:n,g&&g.length?Vc(g,n,I):[]}function jf(g){if(!(g&&g.length))return[];var I=0;return g=ei(g,function(F){if(So(F))return I=St(F.length,I),!0}),ia(I,function(F){return tr(g,ma(F))})}function h_(g,I){if(!(g&&g.length))return[];var F=jf(g);return I==null?F:tr(F,function(nt){return pn(I,n,nt)})}var hm=ar(function(g,I){return So(g)?Mt(g,I):[]}),fm=ar(function(g){return em(ei(g,So))}),Wd=ar(function(g){var I=Mu(g);return So(I)&&(I=n),em(ei(g,So),Fi(I,2))}),Ny=ar(function(g){var I=Mu(g);return I=typeof I=="function"?I:n,em(ei(g,So),n,I)}),Oy=ar(jf);function Yd(g,I){return Rg(g||[],I||[],_)}function f_(g,I){return Rg(g||[],I||[],Zc)}var d_=ar(function(g){var I=g.length,F=I>1?g[I-1]:n;return F=typeof F=="function"?(g.pop(),F):n,h_(g,F)});function Ry(g){var I=Dt(g);return I.__chain__=!0,I}function By(g,I){return I(g),g}function yh(g,I){return I(g)}var Sw=Ku(function(g){var I=g.length,F=I?g[0]:0,nt=this.__wrapped__,At=function(Rt){return B(Rt,g)};return I>1||this.__actions__.length||!(nt instanceof Ni)||!Ic(F)?this.thru(At):(nt=nt.slice(F,+F+(I?1:0)),nt.__actions__.push({func:yh,args:[At],thisArg:n}),new _a(nt,this.__chain__).thru(function(Rt){return I&&!Rt.length&&Rt.push(n),Rt}))});function p_(){return Ry(this)}function Ew(){return new _a(this.value(),this.__chain__)}function m_(){this.__values__===n&&(this.__values__=Cm(this.value()));var g=this.__index__>=this.__values__.length,I=g?n:this.__values__[this.__index__++];return{done:g,value:I}}function g_(){return this}function dm(g){for(var I,F=this;F instanceof Hu;){var nt=Bf(F);nt.__index__=0,nt.__values__=n,I?At.__wrapped__=nt:I=nt;var At=nt;F=F.__wrapped__}return At.__wrapped__=g,I}function Mw(){var g=this.__wrapped__;if(g instanceof Ni){var I=g;return this.__actions__.length&&(I=new Ni(this)),I=I.reverse(),I.__actions__.push({func:yh,args:[Gd],thisArg:n}),new _a(I,this.__chain__)}return this.thru(Gd)}function Lw(){return Vh(this.__wrapped__,this.__actions__)}var kw=wc(function(g,I,F){rn.call(g,F)?++g[F]:S(g,F,1)});function Pw(g,I,F){var nt=hr(g)?Ui:Gt;return F&&Qa(g,I,F)&&(I=n),nt(g,Fi(I,3))}function zw(g,I){var F=hr(g)?ei:Wt;return F(g,Fi(I,3))}var Dw=xy(vh),pm=xy(r_);function Nw(g,I){return jt(mm(g,I),1)}function Fy(g,I){return jt(mm(g,I),Le)}function Uf(g,I,F){return F=F===n?1:Vi(F),jt(mm(g,I),F)}function jy(g,I){var F=hr(g)?an:Bt;return F(g,Fi(I,3))}function Uy(g,I){var F=hr(g)?Fn:Ft;return F(g,Fi(I,3))}var Ow=wc(function(g,I,F){rn.call(g,F)?g[F].push(I):S(g,F,[I])});function Gy(g,I,F,nt){g=_o(g)?g:rf(g),F=F&&!nt?Vi(F):0;var At=g.length;return F<0&&(F=St(At+F,0)),Im(g)?F<=At&&g.indexOf(I,F)>-1:!!At&&Ri(g,I,F)>-1}var Zy=ar(function(g,I,F){var nt=-1,At=typeof I=="function",Rt=_o(g)?on(g.length):[];return Bt(g,function(se){Rt[++nt]=At?pn(I,se,F):zn(se,I,F)}),Rt}),Rw=wc(function(g,I,F){S(g,F,I)});function mm(g,I){var F=hr(g)?tr:va;return F(g,Fi(I,3))}function Bw(g,I,F,nt){return g==null?[]:(hr(I)||(I=I==null?[]:[I]),F=nt?n:F,hr(F)||(F=F==null?[]:[F]),sa(g,I,F))}var __=wc(function(g,I,F){g[F?0:1].push(I)},function(){return[[],[]]});function gm(g,I,F){var nt=hr(g)?Di:Da,At=arguments.length<3;return nt(g,Fi(I,4),F,At,Bt)}function _m(g,I,F){var nt=hr(g)?ls:Da,At=arguments.length<3;return nt(g,Fi(I,4),F,At,Ft)}function Fw(g,I){var F=hr(g)?ei:Wt;return F(g,xh(Fi(I,3)))}function jw(g){var I=hr(g)?zd:mh;return I(g)}function Xd(g,I,F){(F?Qa(g,I,F):I===n)?I=1:I=Vi(I);var nt=hr(g)?Jp:Tu;return nt(g,I)}function Hd(g){var I=hr(g)?Dd:Dg;return I(g)}function Vy(g){if(g==null)return 0;if(_o(g))return Im(g)?dr(g):g.length;var I=Ka(g);return I==R||I==We?g.size:Wr(g).length}function $d(g,I,F){var nt=hr(g)?er:hy;return F&&Qa(g,I,F)&&(I=n),nt(g,Fi(I,3))}var Wy=ar(function(g,I){if(g==null)return[];var F=I.length;return F>1&&Qa(g,I[0],I[1])?I=[]:F>2&&Qa(I[0],I[1],I[2])&&(I=[I[0]]),sa(g,jt(I,1),[])}),vm=$n||function(){return oe.Date.now()};function Yy(g,I){if(typeof I!="function")throw new Vs(p);return g=Vi(g),function(){if(--g<1)return I.apply(this,arguments)}}function v_(g,I,F){return I=F?n:I,I=g&&I==null?g.length:I,wa(g,rt,n,n,n,n,I)}function y_(g,I){var F;if(typeof I!="function")throw new Vs(p);return g=Vi(g),function(){return--g>0&&(F=I.apply(this,arguments)),g<=1&&(I=n),F}}var ym=ar(function(g,I,F){var nt=at;if(F.length){var At=ho(F,Xc(ym));nt|=j}return wa(g,nt,I,F,At)}),x_=ar(function(g,I,F){var nt=at|J;if(F.length){var At=ho(F,Xc(x_));nt|=j}return wa(I,nt,g,F,At)});function w_(g,I,F){I=F?n:I;var nt=wa(g,lt,n,n,n,n,n,I);return nt.placeholder=w_.placeholder,nt}function Xy(g,I,F){I=F?n:I;var nt=wa(g,Ct,n,n,n,n,n,I);return nt.placeholder=Xy.placeholder,nt}function Hy(g,I,F){var nt,At,Rt,se,Ie,Be,Tn=0,kn=!1,Rn=!1,si=!0;if(typeof g!="function")throw new Vs(p);I=Ba(I)||0,$o(F)&&(kn=!!F.leading,Rn="maxWait"in F,Rt=Rn?St(Ba(F.maxWait)||0,I):Rt,si="trailing"in F?!!F.trailing:si);function Ci(Is){var ba=nt,Ec=At;return nt=At=n,Tn=Is,se=g.apply(Ec,ba),se}function Yi(Is){return Tn=Is,Ie=Of(Pr,I),kn?Ci(Is):se}function Cr(Is){var ba=Is-Be,Ec=Is-Tn,cp=I-ba;return Rn?ne(cp,Rt-Ec):cp}function Ji(Is){var ba=Is-Be,Ec=Is-Tn;return Be===n||ba>=I||ba<0||Rn&&Ec>=Rt}function Pr(){var Is=vm();if(Ji(Is))return Br(Is);Ie=Of(Pr,Cr(Is))}function Br(Is){return Ie=n,si&&nt?Ci(Is):(nt=At=n,se)}function jl(){Ie!==n&&Rd(Ie),Tn=0,nt=Be=At=Ie=n}function il(){return Ie===n?se:Br(vm())}function Ul(){var Is=vm(),ba=Ji(Is);if(nt=arguments,At=this,Be=Is,ba){if(Ie===n)return Yi(Be);if(Rn)return Rd(Ie),Ie=Of(Pr,I),Ci(Be)}return Ie===n&&(Ie=Of(Pr,I)),se}return Ul.cancel=jl,Ul.flush=il,Ul}var $y=ar(function(g,I){return _t(g,1,I)}),xm=ar(function(g,I,F){return _t(g,Ba(I)||0,F)});function qy(g){return wa(g,xt)}function la(g,I){if(typeof g!="function"||I!=null&&typeof I!="function")throw new Vs(p);var F=function(){var nt=arguments,At=I?I.apply(this,nt):nt[0],Rt=F.cache;if(Rt.has(At))return Rt.get(At);var se=g.apply(this,nt);return F.cache=Rt.set(At,se)||Rt,se};return F.cache=new(la.Cache||Cu),F}la.Cache=Cu;function xh(g){if(typeof g!="function")throw new Vs(p);return function(){var I=arguments;switch(I.length){case 0:return!g.call(this);case 1:return!g.call(this,I[0]);case 2:return!g.call(this,I[0],I[1]);case 3:return!g.call(this,I[0],I[1],I[2])}return!g.apply(this,I)}}function Gf(g){return y_(2,g)}var qd=dy(function(g,I){I=I.length==1&&hr(I[0])?tr(I[0],Wo(Fi())):tr(jt(I,1),Wo(Fi()));var F=I.length;return ar(function(nt){for(var At=-1,Rt=ne(nt.length,F);++At<Rt;)nt[At]=I[At].call(this,nt[At]);return pn(g,this,nt)})}),wm=ar(function(g,I){var F=ho(I,Xc(wm));return wa(g,j,n,I,F)}),b_=ar(function(g,I){var F=ho(I,Xc(b_));return wa(g,k,n,I,F)}),Uw=Ku(function(g,I){return wa(g,yt,n,n,n,I)});function Gw(g,I){if(typeof g!="function")throw new Vs(p);return I=I===n?I:Vi(I),ar(g,I)}function Zw(g,I){if(typeof g!="function")throw new Vs(p);return I=I==null?0:St(Vi(I),0),ar(function(F){var nt=F[I],At=yc(F,0,I);return nt&&sr(At,nt),pn(g,this,At)})}function Vw(g,I,F){var nt=!0,At=!0;if(typeof g!="function")throw new Vs(p);return $o(F)&&(nt="leading"in F?!!F.leading:nt,At="trailing"in F?!!F.trailing:At),Hy(g,I,{leading:nt,maxWait:I,trailing:At})}function Ww(g){return v_(g,1)}function Yw(g,I){return wm(Bg(I),g)}function bm(){if(!arguments.length)return[];var g=arguments[0];return hr(g)?g:[g]}function Xw(g){return W(g,Y)}function Jy(g,I){return I=typeof I=="function"?I:n,W(g,Y,I)}function Ky(g){return W(g,E|Y)}function Qy(g,I){return I=typeof I=="function"?I:n,W(g,E|Y,I)}function Hw(g,I){return I==null||et(g,I,ds(I))}function nc(g,I){return g===I||g!==g&&I!==I}var $w=au(Fe),qw=au(function(g,I){return g>=I}),ef=Ne(function(){return arguments}())?Ne:function(g){return fs(g)&&rn.call(g,"callee")&&!Rr.call(g,"callee")},hr=on.isArray,Jw=mt?Wo(mt):$e;function _o(g){return g!=null&&$r(g.length)&&!Ac(g)}function So(g){return fs(g)&&_o(g)}function I_(g){return g===!0||g===!1||fs(g)&&An(g)==Ue}var ic=b||H_,Zf=Tt?Wo(Tt):ri;function Kw(g){return fs(g)&&g.nodeType===1&&!Qd(g)}function Qw(g){if(g==null)return!0;if(_o(g)&&(hr(g)||typeof g=="string"||typeof g.splice=="function"||ic(g)||rc(g)||ef(g)))return!g.length;var I=Ka(g);if(I==R||I==We)return!g.size;if(Nf(g))return!Wr(g).length;for(var F in g)if(rn.call(g,F))return!1;return!0}function Jd(g,I){return fi(g,I)}function tb(g,I,F){F=typeof F=="function"?F:n;var nt=F?F(g,I):n;return nt===n?fi(g,I,n,F):!!nt}function C_(g){if(!fs(g))return!1;var I=An(g);return I==Pn||I==Bn||typeof g.message=="string"&&typeof g.name=="string"&&!Qd(g)}function Kd(g){return typeof g=="number"&&D(g)}function Ac(g){if(!$o(g))return!1;var I=An(g);return I==cn||I==Un||I==mn||I==Zt}function A_(g){return typeof g=="number"&&g==Vi(g)}function $r(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=_e}function $o(g){var I=typeof g;return g!=null&&(I=="object"||I=="function")}function fs(g){return g!=null&&typeof g=="object"}var T_=ce?Wo(ce):Li;function $c(g,I){return g===I||Ki(g,I,rm(I))}function Vf(g,I,F){return F=typeof F=="function"?F:n,Ki(g,I,rm(I),F)}function t0(g){return e0(g)&&g!=+g}function eb(g){if(Iy(g))throw new Bi(c);return gi(g)}function nb(g){return g===null}function ib(g){return g==null}function e0(g){return typeof g=="number"||fs(g)&&An(g)==st}function Qd(g){if(!fs(g)||An(g)!=dt)return!1;var I=po(g);if(I===null)return!0;var F=rn.call(I,"constructor")&&I.constructor;return typeof F=="function"&&F instanceof F&&ke.call(F)==bi}var S_=ee?Wo(ee):Kn;function rb(g){return A_(g)&&g>=-_e&&g<=_e}var n0=Oe?Wo(Oe):Hr;function Im(g){return typeof g=="string"||!hr(g)&&fs(g)&&An(g)==pe}function nl(g){return typeof g=="symbol"||fs(g)&&An(g)==un}var rc=Qe?Wo(Qe):Dr;function i0(g){return g===n}function ob(g){return fs(g)&&Ka(g)==Ge}function sb(g){return fs(g)&&An(g)==Gn}var ab=au(Ra),E_=au(function(g,I){return g<=I});function Cm(g){if(!g)return[];if(_o(g))return Im(g)?Ls(g):bs(g);if(Bo&&g[Bo])return gc(g[Bo]());var I=Ka(g),F=I==R?El:I==We?Ml:rf;return F(g)}function Tc(g){if(!g)return g===0?g:0;if(g=Ba(g),g===Le||g===-Le){var I=g<0?-1:1;return I*Me}return g===g?g:0}function Vi(g){var I=Tc(g),F=I%1;return I===I?F?I-F:I:0}function Wf(g){return g?G(Vi(g),0,ue):0}function Ba(g){if(typeof g=="number")return g;if(nl(g))return be;if($o(g)){var I=typeof g.valueOf=="function"?g.valueOf():g;g=$o(I)?I+"":I}if(typeof g!="string")return g===0?g:+g;g=ys(g);var F=hi.test(g);return F||pi.test(g)?vt(g.slice(2),F?2:8):ci.test(g)?be:+g}function Am(g){return Xs(g,wl(g))}function Tm(g){return g?G(Vi(g),-_e,_e):g===0?g:0}function Eo(g){return g==null?"":Ol(g)}var r0=kf(function(g,I){if(Nf(I)||_o(I)){Xs(I,ds(I),g);return}for(var F in I)rn.call(I,F)&&_(g,F,I[F])}),M_=kf(function(g,I){Xs(I,wl(I),g)}),Sm=kf(function(g,I,F,nt){Xs(I,wl(I),g,nt)}),o0=kf(function(g,I,F,nt){Xs(I,ds(I),g,nt)}),s0=Ku(B);function L_(g,I){var F=nu(g);return I==null?F:y(F,I)}var a0=ar(function(g,I){g=Lr(g);var F=-1,nt=I.length,At=nt>2?I[2]:n;for(At&&Qa(I[0],I[1],At)&&(nt=1);++F<nt;)for(var Rt=I[F],se=wl(Rt),Ie=-1,Be=se.length;++Ie<Be;){var Tn=se[Ie],kn=g[Tn];(kn===n||nc(kn,Ce[Tn])&&!rn.call(g,Tn))&&(g[Tn]=Rt[Tn])}return g}),lb=ar(function(g){return g.push(n,Xh),pn(tp,n,g)});function l0(g,I){return Vr(g,Fi(I,3),re)}function qc(g,I){return Vr(g,Fi(I,3),Ae)}function u0(g,I){return g==null?g:Kt(g,Fi(I,3),wl)}function c0(g,I){return g==null?g:me(g,Fi(I,3),wl)}function h0(g,I){return g&&re(g,Fi(I,3))}function f0(g,I){return g&&Ae(g,Fi(I,3))}function ub(g){return g==null?[]:He(g,ds(g))}function cb(g){return g==null?[]:He(g,wl(g))}function Em(g,I,F){var nt=g==null?n:je(g,I);return nt===n?F:nt}function d0(g,I){return g!=null&&qg(g,I,fn)}function nf(g,I){return g!=null&&qg(g,I,Je)}var p0=Yc(function(g,I,F){I!=null&&typeof I.toString!="function"&&(I=Mn.call(I)),g[I]=F},V_(Ds)),m0=Yc(function(g,I,F){I!=null&&typeof I.toString!="function"&&(I=Mn.call(I)),rn.call(g,I)?g[I].push(F):g[I]=[F]},Fi),k_=ar(zn);function ds(g){return _o(g)?Ef(g):Wr(g)}function wl(g){return _o(g)?Ef(g,!0):qa(g)}function Mm(g,I){var F={};return I=Fi(I,3),re(g,function(nt,At,Rt){S(F,I(nt,At,Rt),nt)}),F}function g0(g,I){var F={};return I=Fi(I,3),re(g,function(nt,At,Rt){S(F,At,I(nt,At,Rt))}),F}var Lm=kf(function(g,I,F){Yr(g,I,F)}),tp=kf(function(g,I,F,nt){Yr(g,I,F,nt)}),hb=Ku(function(g,I){var F={};if(g==null)return F;var nt=!1;I=tr(I,function(Rt){return Rt=qu(Rt,g),nt||(nt=Rt.length>1),Rt}),Xs(g,Xg(g),F),nt&&(F=W(F,E|Z|Y,Vg));for(var At=I.length;At--;)Qp(F,I[At]);return F});function fb(g,I){return _0(g,xh(Fi(I)))}var db=Ku(function(g,I){return g==null?{}:go(g,I)});function _0(g,I){if(g==null)return{};var F=tr(Xg(g),function(nt){return[nt]});return I=Fi(I),ya(g,F,function(nt,At){return I(nt,At[0])})}function pb(g,I,F){I=qu(I,g);var nt=-1,At=I.length;for(At||(At=1,g=n);++nt<At;){var Rt=g==null?n:g[Bl(I[nt])];Rt===n&&(nt=At,Rt=F),g=Ac(Rt)?Rt.call(g):Rt}return g}function Yf(g,I,F){return g==null?g:Zc(g,I,F)}function P_(g,I,F,nt){return nt=typeof nt=="function"?nt:n,g==null?g:Zc(g,I,F,nt)}var v0=Gg(ds),z_=Gg(wl);function mb(g,I,F){var nt=hr(g),At=nt||ic(g)||rc(g);if(I=Fi(I,4),F==null){var Rt=g&&g.constructor;At?F=nt?new Rt:[]:$o(g)?F=Ac(Rt)?nu(po(g)):{}:F={}}return(At?an:re)(g,function(se,Ie,Be){return I(F,se,Ie,Be)}),F}function D_(g,I){return g==null?!0:Qp(g,I)}function gb(g,I,F){return g==null?g:fy(g,I,Bg(F))}function wh(g,I,F,nt){return nt=typeof nt=="function"?nt:n,g==null?g:fy(g,I,Bg(F),nt)}function rf(g){return g==null?[]:ql(g,ds(g))}function y0(g){return g==null?[]:ql(g,wl(g))}function km(g,I,F){return F===n&&(F=I,I=n),F!==n&&(F=Ba(F),F=F===F?F:0),I!==n&&(I=Ba(I),I=I===I?I:0),G(Ba(g),I,F)}function N_(g,I,F){return I=Tc(I),F===n?(F=I,I=0):F=Tc(F),g=Ba(g),Ln(g,I,F)}function _b(g,I,F){if(F&&typeof F!="boolean"&&Qa(g,I,F)&&(I=F=n),F===n&&(typeof I=="boolean"?(F=I,I=n):typeof g=="boolean"&&(F=g,g=n)),g===n&&I===n?(g=0,I=1):(g=Tc(g),I===n?(I=g,g=0):I=Tc(I)),g>I){var nt=g;g=I,I=nt}if(F||g%1||I%1){var At=On();return ne(g+At*(I-g+Pa("1e-"+((At+"").length-1))),I)}return Ja(g,I)}var vb=Wc(function(g,I,F){return I=I.toLowerCase(),g+(F?O_(I):I)});function O_(g){return Dm(Eo(g).toLowerCase())}function R_(g){return g=Eo(g),g&&g.replace(ur,wu).replace(Ao,"")}function ep(g,I,F){g=Eo(g),I=Ol(I);var nt=g.length;F=F===n?nt:G(Vi(F),0,nt);var At=F;return F-=I.length,F>=0&&g.slice(F,At)==I}function Jc(g){return g=Eo(g),g&&Ta.test(g)?g.replace(co,Sl):g}function B_(g){return g=Eo(g),g&&It.test(g)?g.replace(pt,"\\$&"):g}var Xf=Wc(function(g,I,F){return g+(F?"-":"")+I.toLowerCase()}),Hf=Wc(function(g,I,F){return g+(F?" ":"")+I.toLowerCase()}),Lu=jg("toLowerCase");function ku(g,I,F){g=Eo(g),I=Vi(I);var nt=I?dr(g):0;if(!I||nt>=I)return g;var At=(I-nt)/2;return Bd(jc(At),F)+g+Bd(Ql(At),F)}function yb(g,I,F){g=Eo(g),I=Vi(I);var nt=I?dr(g):0;return I&&nt<I?g+Bd(I-nt,F):g}function x0(g,I,F){g=Eo(g),I=Vi(I);var nt=I?dr(g):0;return I&&nt<I?Bd(I-nt,F)+g:g}function xb(g,I,F){return F||I==null?I=0:I&&(I=+I),sn(Eo(g).replace(Ut,""),I||0)}function F_(g,I,F){return(F?Qa(g,I,F):I===n)?I=1:I=Vi(I),Nl(Eo(g),I)}function Sc(){var g=arguments,I=Eo(g[0]);return g.length<3?I:I.replace(g[1],g[2])}var of=Wc(function(g,I,F){return g+(F?"_":"")+I.toLowerCase()});function w0(g,I,F){return F&&typeof F!="number"&&Qa(g,I,F)&&(I=F=n),F=F===n?ue:F>>>0,F?(g=Eo(g),g&&(typeof I=="string"||I!=null&&!S_(I))&&(I=Ol(I),!I&&xs(g))?yc(Ls(g),0,F):g.split(I,F)):[]}var b0=Wc(function(g,I,F){return g+(F?" ":"")+Dm(I)});function wb(g,I,F){return g=Eo(g),F=F==null?0:G(Vi(F),0,g.length),I=Ol(I),g.slice(F,F+I.length)==I}function Pm(g,I,F){var nt=Dt.templateSettings;F&&Qa(g,I,F)&&(I=n),g=Eo(g),I=Sm({},I,nt,Zg);var At=Sm({},I.imports,nt.imports,Zg),Rt=ds(At),se=ql(At,Rt),Ie,Be,Tn=0,kn=I.interpolate||ti,Rn="__p += '",si=Ps((I.escape||ti).source+"|"+kn.source+"|"+(kn===ts?Zn:ti).source+"|"+(I.evaluate||ti).source+"|$","g"),Ci="//# sourceURL="+(rn.call(I,"sourceURL")?(I.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ya+"]")+`
`;g.replace(si,function(Ji,Pr,Br,jl,il,Ul){return Br||(Br=jl),Rn+=g.slice(Tn,Ul).replace(yr,bu),Pr&&(Ie=!0,Rn+=`' +
__e(`+Pr+`) +
'`),il&&(Be=!0,Rn+=`';
`+il+`;
__p += '`),Br&&(Rn+=`' +
((__t = (`+Br+`)) == null ? '' : __t) +
'`),Tn=Ul+Ji.length,Ji}),Rn+=`';
`;var Yi=rn.call(I,"variable")&&I.variable;if(!Yi)Rn=`with (obj) {
`+Rn+`
}
`;else if(Re.test(Yi))throw new Bi(r);Rn=(Be?Rn.replace(Ro,""):Rn).replace(Qo,"$1").replace(_s,"$1;"),Rn="function("+(Yi||"obj")+`) {
`+(Yi?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ie?", __e = _.escape":"")+(Be?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Rn+`return __p
}`;var Cr=G_(function(){return Sr(Rt,Ci+"return "+Rn).apply(n,se)});if(Cr.source=Rn,C_(Cr))throw Cr;return Cr}function j_(g){return Eo(g).toLowerCase()}function $f(g){return Eo(g).toUpperCase()}function np(g,I,F){if(g=Eo(g),g&&(F||I===n))return ys(g);if(!g||!(I=Ol(I)))return g;var nt=Ls(g),At=Ls(I),Rt=Fc(nt,At),se=Na(nt,At)+1;return yc(nt,Rt,se).join("")}function ip(g,I,F){if(g=Eo(g),g&&(F||I===n))return g.slice(0,Xo(g)+1);if(!g||!(I=Ol(I)))return g;var nt=Ls(g),At=Na(nt,Ls(I))+1;return yc(nt,0,At).join("")}function zm(g,I,F){if(g=Eo(g),g&&(F||I===n))return g.replace(Ut,"");if(!g||!(I=Ol(I)))return g;var nt=Ls(g),At=Fc(nt,Ls(I));return yc(nt,At).join("")}function I0(g,I){var F=kt,nt=de;if($o(I)){var At="separator"in I?I.separator:At;F="length"in I?Vi(I.length):F,nt="omission"in I?Ol(I.omission):nt}g=Eo(g);var Rt=g.length;if(xs(g)){var se=Ls(g);Rt=se.length}if(F>=Rt)return g;var Ie=F-dr(nt);if(Ie<1)return nt;var Be=se?yc(se,0,Ie).join(""):g.slice(0,Ie);if(At===n)return Be+nt;if(se&&(Ie+=Be.length-Ie),S_(At)){if(g.slice(Ie).search(At)){var Tn,kn=Be;for(At.global||(At=Ps(At.source,Eo(bn.exec(At))+"g")),At.lastIndex=0;Tn=At.exec(kn);)var Rn=Tn.index;Be=Be.slice(0,Rn===n?Ie:Rn)}}else if(g.indexOf(Ol(At),Ie)!=Ie){var si=Be.lastIndexOf(At);si>-1&&(Be=Be.slice(0,si))}return Be+nt}function rp(g){return g=Eo(g),g&&io.test(g)?g.replace(bo,ws):g}var U_=Wc(function(g,I,F){return g+(F?" ":"")+I.toUpperCase()}),Dm=jg("toUpperCase");function sf(g,I,F){return g=Eo(g),I=F?n:I,I===n?$a(g)?Jl(g):za(g):g.match(I)||[]}var G_=ar(function(g,I){try{return pn(g,n,I)}catch(F){return C_(F)?F:new Bi(F)}}),Z_=Ku(function(g,I){return an(I,function(F){F=Bl(F),S(g,F,ym(g[F],g))}),g});function C0(g){var I=g==null?0:g.length,F=Fi();return g=I?tr(g,function(nt){if(typeof nt[1]!="function")throw new Vs(p);return[F(nt[0]),nt[1]]}):[],ar(function(nt){for(var At=-1;++At<I;){var Rt=g[At];if(pn(Rt[0],this,nt))return pn(Rt[1],this,nt)}})}function bb(g){return it(W(g,E))}function V_(g){return function(){return g}}function A0(g,I){return g==null||g!==g?I:g}var af=cs(),Ib=cs(!0);function Ds(g){return g}function W_(g){return to(typeof g=="function"?g:W(g,E))}function op(g){return ru(W(g,E))}function sp(g,I){return mo(g,W(I,E))}var ap=ar(function(g,I){return function(F){return zn(F,g,I)}}),lp=ar(function(g,I){return function(F){return zn(g,F,I)}});function qf(g,I,F){var nt=ds(I),At=He(I,nt);F==null&&!($o(I)&&(At.length||!nt.length))&&(F=I,I=g,g=this,At=He(I,ds(I)));var Rt=!($o(F)&&"chain"in F)||!!F.chain,se=Ac(g);return an(At,function(Ie){var Be=I[Ie];g[Ie]=Be,se&&(g.prototype[Ie]=function(){var Tn=this.__chain__;if(Rt||Tn){var kn=g(this.__wrapped__),Rn=kn.__actions__=bs(this.__actions__);return Rn.push({func:Be,args:arguments,thisArg:g}),kn.__chain__=Tn,kn}return Be.apply(g,sr([this.value()],arguments))})}),g}function Cb(){return oe._===this&&(oe._=mi),this}function Y_(){}function Jf(g){return g=Vi(g),ar(function(I){return Ho(I,g)})}var Nm=br(tr),Ab=br(Ui),T0=br(er);function X_(g){return Kg(g)?ma(Bl(g)):Zh(g)}function Tb(g){return function(I){return g==null?n:je(g,I)}}var S0=Ju(),Sb=Ju(!0);function Om(){return[]}function H_(){return!1}function E0(){return{}}function Eb(){return""}function Mb(){return!0}function Rm(g,I){if(g=Vi(g),g<1||g>_e)return[];var F=ue,nt=ne(g,ue);I=Fi(I),g-=ue;for(var At=ia(nt,I);++F<g;)I(F);return At}function Bm(g){return hr(g)?tr(g,Bl):nl(g)?[g]:bs(n_(Eo(g)))}function Fm(g){var I=++Sn;return Eo(g)+I}var Lb=Yh(function(g,I){return g+I},0),$_=xl("ceil"),q_=Yh(function(g,I){return g/I},1),bh=xl("floor");function kb(g){return g&&g.length?Pt(g,Ds,Fe):n}function J_(g,I){return g&&g.length?Pt(g,Fi(I,2),Fe):n}function M0(g){return Ms(g,Ds)}function jm(g,I){return Ms(g,Fi(I,2))}function Pb(g){return g&&g.length?Pt(g,Ds,Ra):n}function zb(g,I){return g&&g.length?Pt(g,Fi(I,2),Ra):n}var Db=Yh(function(g,I){return g*I},1),Nb=xl("round"),K_=Yh(function(g,I){return g-I},0);function Ob(g){return g&&g.length?Mr(g,Ds):0}function up(g,I){return g&&g.length?Mr(g,Fi(I,2)):0}return Dt.after=Yy,Dt.ary=v_,Dt.assign=r0,Dt.assignIn=M_,Dt.assignInWith=Sm,Dt.assignWith=o0,Dt.at=s0,Dt.before=y_,Dt.bind=ym,Dt.bindAll=Z_,Dt.bindKey=x_,Dt.castArray=bm,Dt.chain=Ry,Dt.chunk=tl,Dt.compact=Eu,Dt.concat=i_,Dt.cond=C0,Dt.conforms=bb,Dt.constant=V_,Dt.countBy=kw,Dt.create=L_,Dt.curry=w_,Dt.curryRight=Xy,Dt.debounce=Hy,Dt.defaults=a0,Dt.defaultsDeep=lb,Dt.defer=$y,Dt.delay=xm,Dt.difference=os,Dt.differenceBy=Ay,Dt.differenceWith=Ud,Dt.drop=ec,Dt.dropRight=uw,Dt.dropRightWhile=cw,Dt.dropWhile=Ty,Dt.fill=Sy,Dt.filter=zw,Dt.flatMap=Nw,Dt.flatMapDeep=Fy,Dt.flatMapDepth=Uf,Dt.flatten=o_,Dt.flattenDeep=Ey,Dt.flattenDepth=My,Dt.flip=qy,Dt.flow=af,Dt.flowRight=Ib,Dt.fromPairs=hw,Dt.functions=ub,Dt.functionsIn=cb,Dt.groupBy=Ow,Dt.initial=a_,Dt.intersection=el,Dt.intersectionBy=Ly,Dt.intersectionWith=fw,Dt.invert=p0,Dt.invertBy=m0,Dt.invokeMap=Zy,Dt.iteratee=W_,Dt.keyBy=Rw,Dt.keys=ds,Dt.keysIn=wl,Dt.map=mm,Dt.mapKeys=Mm,Dt.mapValues=g0,Dt.matches=op,Dt.matchesProperty=sp,Dt.memoize=la,Dt.merge=Lm,Dt.mergeWith=tp,Dt.method=ap,Dt.methodOf=lp,Dt.mixin=qf,Dt.negate=xh,Dt.nthArg=Jf,Dt.omit=hb,Dt.omitBy=fb,Dt.once=Gf,Dt.orderBy=Bw,Dt.over=Nm,Dt.overArgs=qd,Dt.overEvery=Ab,Dt.overSome=T0,Dt.partial=wm,Dt.partialRight=b_,Dt.partition=__,Dt.pick=db,Dt.pickBy=_0,Dt.property=X_,Dt.propertyOf=Tb,Dt.pull=zy,Dt.pullAll=l_,Dt.pullAllBy=u_,Dt.pullAllWith=Hc,Dt.pullAt=Fl,Dt.range=S0,Dt.rangeRight=Sb,Dt.rearg=Uw,Dt.reject=Fw,Dt.remove=pw,Dt.rest=Gw,Dt.reverse=Gd,Dt.sampleSize=Xd,Dt.set=Yf,Dt.setWith=P_,Dt.shuffle=Hd,Dt.slice=mw,Dt.sortBy=Wy,Dt.sortedUniq=Vd,Dt.sortedUniqBy=vw,Dt.split=w0,Dt.spread=Zw,Dt.tail=yw,Dt.take=xw,Dt.takeRight=ww,Dt.takeRightWhile=bw,Dt.takeWhile=Iw,Dt.tap=By,Dt.throttle=Vw,Dt.thru=yh,Dt.toArray=Cm,Dt.toPairs=v0,Dt.toPairsIn=z_,Dt.toPath=Bm,Dt.toPlainObject=Am,Dt.transform=mb,Dt.unary=Ww,Dt.union=Cw,Dt.unionBy=c_,Dt.unionWith=Aw,Dt.uniq=Ff,Dt.uniqBy=Tw,Dt.uniqWith=hs,Dt.unset=D_,Dt.unzip=jf,Dt.unzipWith=h_,Dt.update=gb,Dt.updateWith=wh,Dt.values=rf,Dt.valuesIn=y0,Dt.without=hm,Dt.words=sf,Dt.wrap=Yw,Dt.xor=fm,Dt.xorBy=Wd,Dt.xorWith=Ny,Dt.zip=Oy,Dt.zipObject=Yd,Dt.zipObjectDeep=f_,Dt.zipWith=d_,Dt.entries=v0,Dt.entriesIn=z_,Dt.extend=M_,Dt.extendWith=Sm,qf(Dt,Dt),Dt.add=Lb,Dt.attempt=G_,Dt.camelCase=vb,Dt.capitalize=O_,Dt.ceil=$_,Dt.clamp=km,Dt.clone=Xw,Dt.cloneDeep=Ky,Dt.cloneDeepWith=Qy,Dt.cloneWith=Jy,Dt.conformsTo=Hw,Dt.deburr=R_,Dt.defaultTo=A0,Dt.divide=q_,Dt.endsWith=ep,Dt.eq=nc,Dt.escape=Jc,Dt.escapeRegExp=B_,Dt.every=Pw,Dt.find=Dw,Dt.findIndex=vh,Dt.findKey=l0,Dt.findLast=pm,Dt.findLastIndex=r_,Dt.findLastKey=qc,Dt.floor=bh,Dt.forEach=jy,Dt.forEachRight=Uy,Dt.forIn=u0,Dt.forInRight=c0,Dt.forOwn=h0,Dt.forOwnRight=f0,Dt.get=Em,Dt.gt=$w,Dt.gte=qw,Dt.has=d0,Dt.hasIn=nf,Dt.head=um,Dt.identity=Ds,Dt.includes=Gy,Dt.indexOf=s_,Dt.inRange=N_,Dt.invoke=k_,Dt.isArguments=ef,Dt.isArray=hr,Dt.isArrayBuffer=Jw,Dt.isArrayLike=_o,Dt.isArrayLikeObject=So,Dt.isBoolean=I_,Dt.isBuffer=ic,Dt.isDate=Zf,Dt.isElement=Kw,Dt.isEmpty=Qw,Dt.isEqual=Jd,Dt.isEqualWith=tb,Dt.isError=C_,Dt.isFinite=Kd,Dt.isFunction=Ac,Dt.isInteger=A_,Dt.isLength=$r,Dt.isMap=T_,Dt.isMatch=$c,Dt.isMatchWith=Vf,Dt.isNaN=t0,Dt.isNative=eb,Dt.isNil=ib,Dt.isNull=nb,Dt.isNumber=e0,Dt.isObject=$o,Dt.isObjectLike=fs,Dt.isPlainObject=Qd,Dt.isRegExp=S_,Dt.isSafeInteger=rb,Dt.isSet=n0,Dt.isString=Im,Dt.isSymbol=nl,Dt.isTypedArray=rc,Dt.isUndefined=i0,Dt.isWeakMap=ob,Dt.isWeakSet=sb,Dt.join=ky,Dt.kebabCase=Xf,Dt.last=Mu,Dt.lastIndexOf=dw,Dt.lowerCase=Hf,Dt.lowerFirst=Lu,Dt.lt=ab,Dt.lte=E_,Dt.max=kb,Dt.maxBy=J_,Dt.mean=M0,Dt.meanBy=jm,Dt.min=Pb,Dt.minBy=zb,Dt.stubArray=Om,Dt.stubFalse=H_,Dt.stubObject=E0,Dt.stubString=Eb,Dt.stubTrue=Mb,Dt.multiply=Db,Dt.nth=Py,Dt.noConflict=Cb,Dt.noop=Y_,Dt.now=vm,Dt.pad=ku,Dt.padEnd=yb,Dt.padStart=x0,Dt.parseInt=xb,Dt.random=_b,Dt.reduce=gm,Dt.reduceRight=_m,Dt.repeat=F_,Dt.replace=Sc,Dt.result=pb,Dt.round=Nb,Dt.runInContext=ze,Dt.sample=jw,Dt.size=Vy,Dt.snakeCase=of,Dt.some=$d,Dt.sortedIndex=gw,Dt.sortedIndexBy=_w,Dt.sortedIndexOf=Zd,Dt.sortedLastIndex=cm,Dt.sortedLastIndexBy=Dy,Dt.sortedLastIndexOf=tf,Dt.startCase=b0,Dt.startsWith=wb,Dt.subtract=K_,Dt.sum=Ob,Dt.sumBy=up,Dt.template=Pm,Dt.times=Rm,Dt.toFinite=Tc,Dt.toInteger=Vi,Dt.toLength=Wf,Dt.toLower=j_,Dt.toNumber=Ba,Dt.toSafeInteger=Tm,Dt.toString=Eo,Dt.toUpper=$f,Dt.trim=np,Dt.trimEnd=ip,Dt.trimStart=zm,Dt.truncate=I0,Dt.unescape=rp,Dt.uniqueId=Fm,Dt.upperCase=U_,Dt.upperFirst=Dm,Dt.each=jy,Dt.eachRight=Uy,Dt.first=um,qf(Dt,function(){var g={};return re(Dt,function(I,F){rn.call(Dt.prototype,F)||(g[F]=I)}),g}(),{chain:!1}),Dt.VERSION=o,an(["bind","bindKey","curry","curryRight","partial","partialRight"],function(g){Dt[g].placeholder=Dt}),an(["drop","take"],function(g,I){Ni.prototype[g]=function(F){F=F===n?1:St(Vi(F),0);var nt=this.__filtered__&&!I?new Ni(this):this.clone();return nt.__filtered__?nt.__takeCount__=ne(F,nt.__takeCount__):nt.__views__.push({size:ne(F,ue),type:g+(nt.__dir__<0?"Right":"")}),nt},Ni.prototype[g+"Right"]=function(F){return this.reverse()[g](F).reverse()}}),an(["filter","map","takeWhile"],function(g,I){var F=I+1,nt=F==ht||F==ln;Ni.prototype[g]=function(At){var Rt=this.clone();return Rt.__iteratees__.push({iteratee:Fi(At,3),type:F}),Rt.__filtered__=Rt.__filtered__||nt,Rt}}),an(["head","last"],function(g,I){var F="take"+(I?"Right":"");Ni.prototype[g]=function(){return this[F](1).value()[0]}}),an(["initial","tail"],function(g,I){var F="drop"+(I?"":"Right");Ni.prototype[g]=function(){return this.__filtered__?new Ni(this):this[F](1)}}),Ni.prototype.compact=function(){return this.filter(Ds)},Ni.prototype.find=function(g){return this.filter(g).head()},Ni.prototype.findLast=function(g){return this.reverse().find(g)},Ni.prototype.invokeMap=ar(function(g,I){return typeof g=="function"?new Ni(this):this.map(function(F){return zn(F,g,I)})}),Ni.prototype.reject=function(g){return this.filter(xh(Fi(g)))},Ni.prototype.slice=function(g,I){g=Vi(g);var F=this;return F.__filtered__&&(g>0||I<0)?new Ni(F):(g<0?F=F.takeRight(-g):g&&(F=F.drop(g)),I!==n&&(I=Vi(I),F=I<0?F.dropRight(-I):F.take(I-g)),F)},Ni.prototype.takeRightWhile=function(g){return this.reverse().takeWhile(g).reverse()},Ni.prototype.toArray=function(){return this.take(ue)},re(Ni.prototype,function(g,I){var F=/^(?:filter|find|map|reject)|While$/.test(I),nt=/^(?:head|last)$/.test(I),At=Dt[nt?"take"+(I=="last"?"Right":""):I],Rt=nt||/^find/.test(I);At&&(Dt.prototype[I]=function(){var se=this.__wrapped__,Ie=nt?[1]:arguments,Be=se instanceof Ni,Tn=Ie[0],kn=Be||hr(se),Rn=function(Pr){var Br=At.apply(Dt,sr([Pr],Ie));return nt&&si?Br[0]:Br};kn&&F&&typeof Tn=="function"&&Tn.length!=1&&(Be=kn=!1);var si=this.__chain__,Ci=!!this.__actions__.length,Yi=Rt&&!si,Cr=Be&&!Ci;if(!Rt&&kn){se=Cr?se:new Ni(this);var Ji=g.apply(se,Ie);return Ji.__actions__.push({func:yh,args:[Rn],thisArg:n}),new _a(Ji,si)}return Yi&&Cr?g.apply(this,Ie):(Ji=this.thru(Rn),Yi?nt?Ji.value()[0]:Ji.value():Ji)})}),an(["pop","push","shift","sort","splice","unshift"],function(g){var I=Nt[g],F=/^(?:push|sort|unshift)$/.test(g)?"tap":"thru",nt=/^(?:pop|shift)$/.test(g);Dt.prototype[g]=function(){var At=arguments;if(nt&&!this.__chain__){var Rt=this.value();return I.apply(hr(Rt)?Rt:[],At)}return this[F](function(se){return I.apply(hr(se)?se:[],At)})}}),re(Ni.prototype,function(g,I){var F=Dt[I];if(F){var nt=F.name+"";rn.call(Xu,nt)||(Xu[nt]=[]),Xu[nt].push({name:I,func:F})}}),Xu[xi(n,J).name]=[{name:"wrapper",func:n}],Ni.prototype.clone=Pg,Ni.prototype.reverse=Sd,Ni.prototype.value=zg,Dt.prototype.at=Sw,Dt.prototype.chain=p_,Dt.prototype.commit=Ew,Dt.prototype.next=m_,Dt.prototype.plant=dm,Dt.prototype.reverse=Mw,Dt.prototype.toJSON=Dt.prototype.valueOf=Dt.prototype.value=Lw,Dt.prototype.first=Dt.prototype.head,Bo&&(Dt.prototype[Bo]=g_),Dt},ks=Yu();z?((z.exports=ks)._=ks,C._=ks):oe._=ks}).call(fa)})(mO,sx);const Gr=sx;var gO=dk();const lo=QS(gO),_O=function(){var t=typeof window=="object"&&!!window.SVGAngle;if(!t)return function(){throw new Error("SVG is required to use Vectorizer.")};var e={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},n="1.1",o=Math,l=o.PI,c=o.atan2,p=o.sqrt,r=o.min,w=o.max,M=o.cos,N=o.sin,E=function(j,k,rt){if(!(this instanceof E))return E.apply(Object.create(E.prototype),arguments);if(j){if(E.isV(j)&&(j=j.node),k=k||{},E.isString(j)){if(j=j.trim(),j.toLowerCase()==="svg")j=E.createSvgDocument();else if(j[0]==="<"){var yt=E.createSvgDocument(j);if(yt.childNodes.length>1){var xt=[],kt,de;for(kt=0,de=yt.childNodes.length;kt<de;kt++){var Et=yt.childNodes[kt];xt.push(new E(document.importNode(Et,!0)))}return xt}j=document.importNode(yt.firstChild,!0)}else j=document.createElementNS(e.svg,j);E.ensureId(j)}return this.node=j,this.setAttributes(k),rt&&this.append(rt),this}},Z=E.prototype;Object.defineProperty(Z,"id",{enumerable:!0,get:function(){return this.node.id},set:function(j){this.node.id=j}}),Z.getTransformToElement=function(j){var k=this.node;if(E.isSVGGraphicsElement(j)&&E.isSVGGraphicsElement(k)){var rt=E.toNode(j).getScreenCTM(),yt=k.getScreenCTM();if(rt&&yt)return rt.inverse().multiply(yt)}return E.createSVGMatrix()},Z.transform=function(j,k){var rt=this.node;if(E.isUndefined(j))return E.transformStringToMatrix(this.attr("transform"));if(k&&k.absolute)return this.attr("transform",E.matrixToTransformString(j));var yt=E.createSVGTransform(j);return rt.transform.baseVal.appendItem(yt),this},Z.translate=function(j,k,rt){rt=rt||{},k=k||0;var yt=this.attr("transform")||"",xt=E.parseTransformString(yt);if(yt=xt.value,E.isUndefined(j))return xt.translate;yt=yt.replace(/translate\([^)]*\)/g,"").trim();var kt=rt.absolute?j:xt.translate.tx+j,de=rt.absolute?k:xt.translate.ty+k,Et="translate("+kt+","+de+")";return this.attr("transform",(Et+" "+yt).trim()),this},Z.rotate=function(j,k,rt,yt){yt=yt||{};var xt=this.attr("transform")||"",kt=E.parseTransformString(xt);if(xt=kt.value,E.isUndefined(j))return kt.rotate;xt=xt.replace(/rotate\([^)]*\)/g,"").trim(),j%=360;var de=yt.absolute?j:kt.rotate.angle+j,Et=k!==void 0&&rt!==void 0?","+k+","+rt:"",te="rotate("+de+Et+")";return this.attr("transform",(xt+" "+te).trim()),this},Z.scale=function(j,k){k=E.isUndefined(k)?j:k;var rt=this.attr("transform")||"",yt=E.parseTransformString(rt);if(rt=yt.value,E.isUndefined(j))return yt.scale;rt=rt.replace(/scale\([^)]*\)/g,"").trim();var xt="scale("+j+","+k+")";return this.attr("transform",(rt+" "+xt).trim()),this},Z.bbox=function(j,k){var rt,yt=this.node,xt=yt.ownerSVGElement;if(!xt)return new ai(0,0,0,0);try{rt=yt.getBBox()}catch{rt={x:yt.clientLeft,y:yt.clientTop,width:yt.clientWidth,height:yt.clientHeight}}if(j)return new ai(rt);var kt=this.getTransformToElement(k||xt);return E.transformRect(rt,kt)},Z.getBBox=function(j){var k={},rt,yt=this.node,xt=yt.ownerSVGElement;if(!xt||!E.isSVGGraphicsElement(yt))return new ai(0,0,0,0);if(j&&(j.target&&(k.target=E.toNode(j.target)),j.recursive&&(k.recursive=j.recursive)),k.recursive){var de=this.children(),Et=de.length;if(Et===0)return this.getBBox({target:k.target,recursive:!1});k.target||(k.target=this);for(var te=0;te<Et;te++){var ht=de[te],ie;ht.children().length===0?ie=ht.getBBox({target:k.target,recursive:!1}):ie=ht.getBBox({target:k.target,recursive:!0}),rt?rt=rt.union(ie):rt=ie}return rt}else{try{rt=yt.getBBox()}catch{rt={x:yt.clientLeft,y:yt.clientTop,width:yt.clientWidth,height:yt.clientHeight}}if(k.target){var kt=this.getTransformToElement(k.target);return E.transformRect(rt,kt)}else return new ai(rt)}};function Y(j,k){j||(j={});var rt=E("textPath"),yt=j.d;if(yt&&j["xlink:href"]===void 0){var xt=E("path").attr("d",yt).appendTo(k.defs());rt.attr("xlink:href","#"+xt.id)}return E.isObject(j)&&rt.attr(j),rt.node}function K(j,k,rt){rt||(rt={});for(var yt=rt.includeAnnotationIndices,xt=rt.eol,kt=rt.lineHeight,de=rt.baseSize,Et=0,te={},ht=k.length-1,ie=0;ie<=ht;ie++){var ln=k[ie],Le=null;if(E.isObject(ln)){var _e=ln.attrs,Me=E("tspan",_e),be=Me.node,ue=ln.t;xt&&ie===ht&&(ue+=xt),be.textContent=ue;var Yt=_e.class;Yt&&Me.addClass(Yt),yt&&Me.attr("annotations",ln.annotations),Le=parseFloat(_e["font-size"]),isFinite(Le)||(Le=de),Le&&Le>Et&&(Et=Le)}else xt&&ie===ht&&(ln+=xt),be=document.createTextNode(ln||" "),de&&de>Et&&(Et=de);j.appendChild(be)}return Et&&(te.maxFontSize=Et),kt?te.lineHeight=kt:Et&&(te.lineHeight=Et*1.2),te}var q=/em$/;function at(j,k){var rt=parseFloat(j);return q.test(j)?rt*k:rt}function J(j,k,rt,yt){if(!Array.isArray(k))return 0;var xt=k.length;if(!xt)return 0;for(var kt=k[0],de=at(kt.maxFontSize,rt)||rt,Et=0,te=at(yt,rt),ht=1;ht<xt;ht++){kt=k[ht];var ie=at(kt.lineHeight,rt)||te;Et+=ie}var ln=at(kt.maxFontSize,rt)||rt,Le;switch(j){case"middle":Le=de/2-.15*ln-Et/2;break;case"bottom":Le=-(.25*ln)-Et;break;default:case"top":Le=.8*de;break}return Le}Z.text=function(j,k){if(j&&typeof j!="string")throw new Error("Vectorizer: text() expects the first argument to be a string.");j=E.sanitizeText(j),k||(k={});var rt=k.displayEmpty,yt=k.eol,xt=k.textPath,kt=k.textVerticalAnchor,de=kt==="middle"||kt==="bottom"||kt==="top",Et=k.x;Et===void 0&&(Et=this.attr("x")||0);var te=k.includeAnnotationIndices,ht=k.annotations;ht&&!E.isArray(ht)&&(ht=[ht]);var ie=k.lineHeight,ln=ie==="auto",Le=ln?"1.5em":ie||"1em";this.empty(),this.attr({"xml:space":"preserve",display:j||rt?null:"none"});var _e=parseFloat(this.attr("font-size"));_e||(_e=16,(de||ht)&&this.attr("font-size",_e));var Me=document,be;xt?(typeof xt=="string"&&(xt={d:xt}),be=Y(xt,this)):be=Me.createDocumentFragment();for(var ue=0,Yt=j.split(`
`),Ee=[],ve,ye=0,fe=Yt.length-1;ye<=fe;ye++){var mn=Le,Ue="v-line",Cn=Me.createElementNS(e.svg,"tspan"),Bn=Yt[ye],Pn;if(Bn)if(ht){var cn=E.annotateString(Bn,ht,{offset:-ue,includeAnnotationIndices:te});Pn=K(Cn,cn,{includeAnnotationIndices:te,eol:ye!==fe&&yt,lineHeight:ln?null:Le,baseSize:_e});var Un=Pn.lineHeight;Un&&ln&&ye!==0&&(mn=Un),ye===0&&(ve=Pn.maxFontSize*.8)}else yt&&ye!==fe&&(Bn+=yt),Cn.textContent=Bn;else{Cn.textContent="-",Ue+=" v-empty-line";var R=Cn.style;if(R.fillOpacity=0,R.strokeOpacity=0,ht){Pn={},cn=E.findAnnotationsAtIndex(ht,ue);let gt=_e;for(let dt=cn.length;dt>0;dt--){const wt=cn[dt-1].attrs;if(!wt||!("font-size"in wt))continue;const Zt=parseFloat(wt["font-size"]);if(isFinite(Zt)){gt=Zt;break}}ln&&(ye>0?mn=gt*1.2:ve=gt*.8),Cn.setAttribute("font-size",gt),Pn.maxFontSize=gt}}Pn&&Ee.push(Pn),ye>0&&Cn.setAttribute("dy",mn),(ye>0||xt)&&Cn.setAttribute("x",Et),Cn.className.baseVal=Ue,be.appendChild(Cn),ue+=Bn.length+1}if(de)if(ht)mn=J(kt,Ee,_e,Le);else if(kt==="top")mn="0.8em";else{var st;switch(fe>0?(st=parseFloat(Le)||1,st*=fe,q.test(Le)||(st/=_e)):st=0,kt){case"middle":mn=.3-st/2+"em";break;case"bottom":mn=-st-.3+"em";break}}else kt===0?mn="0em":kt?mn=kt:(mn=0,this.attr("y")===null&&this.attr("y",ve||"0.8em"));return be.firstChild.setAttribute("dy",mn),this.append(be),this},Z.removeAttr=function(j){var k=E.qualifyAttr(j),rt=this.node;return k.ns?rt.hasAttributeNS(k.ns,k.local)&&rt.removeAttributeNS(k.ns,k.local):rt.hasAttribute(j)&&rt.removeAttribute(j),this},Z.attr=function(j,k){if(E.isUndefined(j)){for(var rt=this.node.attributes,yt={},xt=0;xt<rt.length;xt++)yt[rt[xt].name]=rt[xt].value;return yt}if(E.isString(j)&&E.isUndefined(k))return this.node.getAttribute(j);if(typeof j=="object")for(var kt in j)j.hasOwnProperty(kt)&&this.setAttribute(kt,j[kt]);else this.setAttribute(j,k);return this},Z.normalizePath=function(){var j=this.tagName();return j==="PATH"&&this.attr("d",E.normalizePathData(this.attr("d"))),this},Z.remove=function(){return this.node.parentNode&&this.node.parentNode.removeChild(this.node),this},Z.empty=function(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);return this},Z.setAttributes=function(j){for(var k in j)j.hasOwnProperty(k)&&this.setAttribute(k,j[k]);return this},Z.append=function(j){E.isArray(j)||(j=[j]);for(var k=0,rt=j.length;k<rt;k++)this.node.appendChild(E.toNode(j[k]));return this},Z.prepend=function(j){var k=this.node.firstChild;return k?E(k).before(j):this.append(j)},Z.before=function(j){var k=this.node,rt=k.parentNode;if(rt){E.isArray(j)||(j=[j]);for(var yt=0,xt=j.length;yt<xt;yt++)rt.insertBefore(E.toNode(j[yt]),k)}return this},Z.appendTo=function(j){return E.toNode(j).appendChild(this.node),this},Z.svg=function(){return this.node instanceof window.SVGSVGElement?this:E(this.node.ownerSVGElement)},Z.tagName=function(){return this.node.tagName.toUpperCase()},Z.defs=function(){var j=this.svg()||this,k=j.node.getElementsByTagName("defs")[0];return k?E(k):E("defs").appendTo(j)},Z.clone=function(){var j=E(this.node.cloneNode(!0));return j.node.id=E.uniqueId(),j},Z.findOne=function(j){var k=this.node.querySelector(j);return k?E(k):void 0},Z.find=function(j){var k=[],rt=this.node.querySelectorAll(j);if(rt)for(var yt=0;yt<rt.length;yt++)k.push(E(rt[yt]));return k},Z.children=function(){for(var j=this.node.childNodes,k=[],rt=0;rt<j.length;rt++){var yt=j[rt];yt.nodeType===1&&k.push(E(j[rt]))}return k},Z.parent=function(){return E(this.node.parentNode)||null},Z.index=function(){for(var j=0,k=this.node.previousSibling;k;)k.nodeType===1&&j++,k=k.previousSibling;return j},Z.findParentByClass=function(j,k){for(var rt=this.node.ownerSVGElement,yt=this.node.parentNode;yt&&yt!==k&&yt!==rt;){var xt=E(yt);if(xt.hasClass(j))return xt;yt=yt.parentNode}return null},Z.contains=function(j){var k=this.node,rt=E.toNode(j),yt=rt&&rt.parentNode;return k===yt||!!(yt&&yt.nodeType===1&&k.compareDocumentPosition(yt)&16)},Z.toLocalPoint=function(j,k){var rt=this.svg().node,yt=rt.createSVGPoint();yt.x=j,yt.y=k;try{var xt=yt.matrixTransform(rt.getScreenCTM().inverse()),kt=this.getTransformToElement(rt).inverse()}catch{return yt}return xt.matrixTransform(kt)},Z.translateCenterToPoint=function(j){var k=this.getBBox({target:this.svg()}),rt=k.center();return this.translate(j.x-rt.x,j.y-rt.y),this},Z.translateAndAutoOrient=function(j,k,rt){j=new Te(j),k=new Te(k),rt||(rt=this.svg());var yt=this.scale();this.attr("transform","");var xt=this.getBBox({target:rt}).scale(yt.sx,yt.sy),kt=E.createSVGTransform();kt.setTranslate(-xt.x-xt.width/2,-xt.y-xt.height/2);var de=E.createSVGTransform(),Et=j.angleBetween(k,j.clone().offset(1,0));Et&&de.setRotate(Et,0,0);var te=E.createSVGTransform(),ht=j.clone().move(k,xt.width/2);te.setTranslate(2*j.x-ht.x,2*j.y-ht.y);var ie=this.getTransformToElement(rt),ln=E.createSVGTransform();return ln.setMatrix(te.matrix.multiply(de.matrix.multiply(kt.matrix.multiply(ie.scale(yt.sx,yt.sy))))),this.attr("transform",E.matrixToTransformString(ln.matrix)),this},Z.animateAlongPath=function(j,k){k=E.toNode(k);var rt=E.ensureId(k),yt=E("animateMotion",j),xt=E("mpath",{"xlink:href":"#"+rt});yt.append(xt),this.append(yt);try{yt.node.beginElement()}catch{if(document.documentElement.getAttribute("smiling")==="fake"){var kt=yt.node;kt.animators=[];var de=kt.getAttribute("id");de&&(id2anim[de]=kt);for(var Et=getTargets(kt),te=0,ht=Et.length;te<ht;te++){var ie=Et[te],ln=new Animator(kt,ie,te);animators.push(ln),kt.animators[te]=ln,ln.register()}}}return this};const Q=/[^\x20\t\r\n\f]+/g;function lt(j){return E.isString(j)?j.trim().match(Q)||[]:[]}Z.hasClass=function(j){return E.isString(j)?this.node.classList.contains(j.trim()):!1},Z.addClass=function(j){return this.node.classList.add(...lt(j)),this},Z.removeClass=function(j){return this.node.classList.remove(...lt(j)),this},Z.toggleClass=function(j,k){const rt=lt(j);for(let yt=0;yt<rt.length;yt++)this.node.classList.toggle(rt[yt],k);return this},Z.sample=function(j){j=j||1;for(var k=this.node,rt=k.getTotalLength(),yt=[],xt=0,kt;xt<rt;)kt=k.getPointAtLength(xt),yt.push({x:kt.x,y:kt.y,distance:xt}),xt+=j;return yt},Z.convertToPath=function(){var j=E("path");j.attr(this.attr());var k=this.convertToPathData();return k&&j.attr("d",k),j},Z.convertToPathData=function(){var j=this.tagName();switch(j){case"PATH":return this.attr("d");case"LINE":return E.convertLineToPathData(this.node);case"POLYGON":return E.convertPolygonToPathData(this.node);case"POLYLINE":return E.convertPolylineToPathData(this.node);case"ELLIPSE":return E.convertEllipseToPathData(this.node);case"CIRCLE":return E.convertCircleToPathData(this.node);case"RECT":return E.convertRectToPathData(this.node)}throw new Error(j+" cannot be converted to PATH.")},E.prototype.toGeometryShape=function(){var j,k,rt,yt,xt,kt,de,Et,te,ht,ie,ln,Le,_e,Me;switch(this.tagName()){case"RECT":return j=parseFloat(this.attr("x"))||0,k=parseFloat(this.attr("y"))||0,rt=parseFloat(this.attr("width"))||0,yt=parseFloat(this.attr("height"))||0,new ai(j,k,rt,yt);case"CIRCLE":return xt=parseFloat(this.attr("cx"))||0,kt=parseFloat(this.attr("cy"))||0,de=parseFloat(this.attr("r"))||0,new pu({x:xt,y:kt},de,de);case"ELLIPSE":return xt=parseFloat(this.attr("cx"))||0,kt=parseFloat(this.attr("cy"))||0,Et=parseFloat(this.attr("rx"))||0,te=parseFloat(this.attr("ry"))||0,new pu({x:xt,y:kt},Et,te);case"POLYLINE":return ht=E.getPointsFromSvgNode(this),new as(ht);case"POLYGON":return ht=E.getPointsFromSvgNode(this),ht.length>1&&ht.push(ht[0]),new as(ht);case"PATH":return ie=this.attr("d"),zi.isDataSupported(ie)||(ie=E.normalizePathData(ie)),new zi(ie);case"LINE":return ln=parseFloat(this.attr("x1"))||0,_e=parseFloat(this.attr("y1"))||0,Le=parseFloat(this.attr("x2"))||0,Me=parseFloat(this.attr("y2"))||0,new di({x:ln,y:_e},{x:Le,y:Me})}return this.getBBox()},Z.findIntersection=function(j,k){var rt=this.svg().node;k=k||rt;var yt=this.getBBox({target:k}),xt=yt.center();if(yt.intersectionWithLineFromCenterToPoint(j)){var kt,de=this.tagName();if(de==="RECT"){var Et=new ai(parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),te=this.getTransformToElement(k),ht=E.decomposeMatrix(te),ie=rt.createSVGTransform();ie.setRotate(-ht.rotation,xt.x,xt.y);var ln=E.transformRect(Et,ie.matrix.multiply(te));kt=new ai(ln).intersectionWithLineFromCenterToPoint(j,ht.rotation)}else if(de==="PATH"||de==="POLYGON"||de==="POLYLINE"||de==="CIRCLE"||de==="ELLIPSE"){var Le=de==="PATH"?this:this.convertToPath(),_e=Le.sample(),Me=1/0,be=[],ue,Yt,Ee,ve,ye,fe;for(ue=0;ue<_e.length;ue++)Yt=_e[ue],Ee=E.createSVGPoint(Yt.x,Yt.y),Ee=Ee.matrixTransform(this.getTransformToElement(k)),Yt=new Te(Ee),ve=Yt.distance(xt),ye=Yt.distance(j)*1.1,fe=ve+ye,fe<Me?(Me=fe,be=[{sample:Yt,refDistance:ye}]):fe<Me+1&&be.push({sample:Yt,refDistance:ye});be.sort(function(mn,Ue){return mn.refDistance-Ue.refDistance}),be[0]&&(kt=be[0].sample)}return kt}},Z.setAttribute=function(j,k){var rt=this.node;if(k===null)return this.removeAttr(j),this;var yt=E.qualifyAttr(j);return yt.ns?rt.setAttributeNS(yt.ns,j,k):j==="id"?rt.id=k:rt.setAttribute(j,k),this},E.createSvgDocument=function(j){if(j){const rt=`<svg xmlns="${e.svg}" xmlns:xlink="${e.xlink}" version="${n}">${j}</svg>`,{documentElement:yt}=E.parseXML(rt,{async:!1});return yt}const k=document.createElementNS(e.svg,"svg");return k.setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),k.setAttribute("version",n),k},E.createSVGStyle=function(j){const{node:k}=E("style",{type:"text/css"},[E.createCDATASection(j)]);return k},E.createCDATASection=function(j=""){return document.implementation.createDocument(null,"xml",null).createCDATASection(j)},E.idCounter=0,E.uniqueId=function(){return"v-"+ ++E.idCounter},E.toNode=function(j){return E.isV(j)?j.node:j.nodeName&&j||j[0]},E.ensureId=function(j){return j=E.toNode(j),j.id||(j.id=E.uniqueId())},E.sanitizeText=function(j){return(j||"").replace(/ /g," ")},E.isUndefined=function(j){return typeof j>"u"},E.isString=function(j){return typeof j=="string"},E.isObject=function(j){return j&&typeof j=="object"},E.isArray=Array.isArray,E.parseXML=function(j,k){k=k||{};var rt;try{var yt=new DOMParser;E.isUndefined(k.async)||(yt.async=k.async),rt=yt.parseFromString(j,"text/xml")}catch{rt=void 0}if(!rt||rt.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+j);return rt},E.qualifyAttr=function(j){if(j.indexOf(":")!==-1){var k=j.split(":");return{ns:e[k[0]],local:k[1]}}return{ns:null,local:j}},E.transformSeparatorRegex=/[ ,]+/,E.transformRegex=/\b\w+\([^()]+\)/g,E.transformFunctionRegex=/\b(\w+)\(([^()]+)\)/,E.transformTranslateRegex=/\btranslate\(([^()]+)\)/,E.transformRotateRegex=/\brotate\(([^()]+)\)/,E.transformScaleRegex=/\bscale\(([^()]+)\)/,E.transformStringToMatrix=function(j){let k=E.createSVGMatrix();const rt=j&&j.match(E.transformRegex);if(!rt)return k;const yt=rt.length;for(let xt=0;xt<yt;xt++){const de=rt[xt].match(E.transformFunctionRegex);if(de){let Et,te,ht,ie,ln,Le=E.createSVGMatrix();const _e=de[1].toLowerCase(),Me=de[2].split(E.transformSeparatorRegex);switch(_e){case"scale":Et=parseFloat(Me[0]),te=Me[1]===void 0?Et:parseFloat(Me[1]),Le=Le.scaleNonUniform(Et,te);break;case"translate":ht=parseFloat(Me[0]),ie=parseFloat(Me[1]),Le=Le.translate(ht,ie);break;case"rotate":ln=parseFloat(Me[0]),ht=parseFloat(Me[1])||0,ie=parseFloat(Me[2])||0,ht!==0||ie!==0?Le=Le.translate(ht,ie).rotate(ln).translate(-ht,-ie):Le=Le.rotate(ln);break;case"skewx":ln=parseFloat(Me[0]),Le=Le.skewX(ln);break;case"skewy":ln=parseFloat(Me[0]),Le=Le.skewY(ln);break;case"matrix":Le.a=parseFloat(Me[0]),Le.b=parseFloat(Me[1]),Le.c=parseFloat(Me[2]),Le.d=parseFloat(Me[3]),Le.e=parseFloat(Me[4]),Le.f=parseFloat(Me[5]);break;default:continue}k=k.multiply(Le)}}return k},E.matrixToTransformString=function(j){return j||(j=!0),"matrix("+(j.a!==void 0?j.a:1)+","+(j.b!==void 0?j.b:0)+","+(j.c!==void 0?j.c:0)+","+(j.d!==void 0?j.d:1)+","+(j.e!==void 0?j.e:0)+","+(j.f!==void 0?j.f:0)+")"},E.parseTransformString=function(j){var k,rt,yt;if(j){var xt=E.transformSeparatorRegex;if(j.trim().indexOf("matrix")>=0){var kt=E.transformStringToMatrix(j),de=E.decomposeMatrix(kt);k=[de.translateX,de.translateY],yt=[de.scaleX,de.scaleY],rt=[de.rotation];var Et=[];(k[0]!==0||k[1]!==0)&&Et.push("translate("+k+")"),(yt[0]!==1||yt[1]!==1)&&Et.push("scale("+yt+")"),rt[0]!==0&&Et.push("rotate("+rt+")"),j=Et.join(" ")}else{const ht=j.match(E.transformTranslateRegex);ht&&(k=ht[1].split(xt));const ie=j.match(E.transformRotateRegex);ie&&(rt=ie[1].split(xt));const ln=j.match(E.transformScaleRegex);ln&&(yt=ln[1].split(xt))}}var te=yt&&yt[0]?parseFloat(yt[0]):1;return{value:j,translate:{tx:k&&k[0]?parseInt(k[0],10):0,ty:k&&k[1]?parseInt(k[1],10):0},rotate:{angle:rt&&rt[0]?parseInt(rt[0],10):0,cx:rt&&rt[1]?parseInt(rt[1],10):void 0,cy:rt&&rt[2]?parseInt(rt[2],10):void 0},scale:{sx:te,sy:yt&&yt[1]?parseFloat(yt[1]):te}}},E.deltaTransformPoint=function(j,k){var rt=k.x*j.a+k.y*j.c+0,yt=k.x*j.b+k.y*j.d+0;return{x:rt,y:yt}},E.decomposeMatrix=function(j){var k=E.deltaTransformPoint(j,{x:0,y:1}),rt=E.deltaTransformPoint(j,{x:1,y:0}),yt=180/l*c(k.y,k.x)-90,xt=180/l*c(rt.y,rt.x);return{translateX:j.e,translateY:j.f,scaleX:p(j.a*j.a+j.b*j.b),scaleY:p(j.c*j.c+j.d*j.d),skewX:yt,skewY:xt,rotation:yt}},E.matrixToScale=function(j){var k,rt,yt,xt;return j?(k=E.isUndefined(j.a)?1:j.a,xt=E.isUndefined(j.d)?1:j.d,rt=j.b,yt=j.c):k=xt=1,{sx:rt?p(k*k+rt*rt):k,sy:yt?p(yt*yt+xt*xt):xt}},E.matrixToRotate=function(j){var k={x:0,y:1};return j&&(k=E.deltaTransformPoint(j,k)),{angle:Rh(qx(c(k.y,k.x))-90)}},E.matrixToTranslate=function(j){return{tx:j&&j.e||0,ty:j&&j.f||0}},E.isV=function(j){return j instanceof E},E.isVElement=E.isV,E.isSVGGraphicsElement=function(j){return j?(j=E.toNode(j),j instanceof SVGElement&&typeof j.getScreenCTM=="function"):!1};var Ct=E("svg").node;return E.createSVGMatrix=function(j){var k=Ct.createSVGMatrix();for(var rt in j)k[rt]=j[rt];return k},E.createSVGTransform=function(j){return E.isUndefined(j)?Ct.createSVGTransform():(j instanceof SVGMatrix||(j=E.createSVGMatrix(j)),Ct.createSVGTransformFromMatrix(j))},E.createSVGPoint=function(j,k){var rt=Ct.createSVGPoint();return rt.x=j,rt.y=k,rt},E.transformRect=function(j,k){var rt=Ct.createSVGPoint();rt.x=j.x,rt.y=j.y;var yt=rt.matrixTransform(k);rt.x=j.x+j.width,rt.y=j.y;var xt=rt.matrixTransform(k);rt.x=j.x+j.width,rt.y=j.y+j.height;var kt=rt.matrixTransform(k);rt.x=j.x,rt.y=j.y+j.height;var de=rt.matrixTransform(k),Et=r(yt.x,xt.x,kt.x,de.x),te=w(yt.x,xt.x,kt.x,de.x),ht=r(yt.y,xt.y,kt.y,de.y),ie=w(yt.y,xt.y,kt.y,de.y);return new ai(Et,ht,te-Et,ie-ht)},E.transformPoint=function(j,k){return new Te(E.createSVGPoint(j.x,j.y).matrixTransform(k))},E.transformLine=function(j,k){return new di(E.transformPoint(j.start,k),E.transformPoint(j.end,k))},E.transformPolyline=function(j,k){var rt=j instanceof as?j.points:j;E.isArray(rt)||(rt=[]);for(var yt=[],xt=0,kt=rt.length;xt<kt;xt++)yt[xt]=E.transformPoint(rt[xt],k);return new as(yt)},E.styleToObject=function(j){for(var k={},rt=j.split(";"),yt=0;yt<rt.length;yt++){var xt=rt[yt],kt=xt.split("=");k[kt[0].trim()]=kt[1].trim()}return k},E.createSlicePathData=function(j,k,rt,yt){var xt=2*l-1e-6,kt=j,de=k,Et=rt,te=yt,ht=(te<Et&&(ht=Et,Et=te,te=ht),te-Et),ie=ht<l?"0":"1",ln=M(Et),Le=N(Et),_e=M(te),Me=N(te);return ht>=xt?kt?"M0,"+de+"A"+de+","+de+" 0 1,1 0,"+-de+"A"+de+","+de+" 0 1,1 0,"+de+"M0,"+kt+"A"+kt+","+kt+" 0 1,0 0,"+-kt+"A"+kt+","+kt+" 0 1,0 0,"+kt+"Z":"M0,"+de+"A"+de+","+de+" 0 1,1 0,"+-de+"A"+de+","+de+" 0 1,1 0,"+de+"Z":kt?"M"+de*ln+","+de*Le+"A"+de+","+de+" 0 "+ie+",1 "+de*_e+","+de*Me+"L"+kt*_e+","+kt*Me+"A"+kt+","+kt+" 0 "+ie+",0 "+kt*ln+","+kt*Le+"Z":"M"+de*ln+","+de*Le+"A"+de+","+de+" 0 "+ie+",1 "+de*_e+","+de*Me+"L0,0Z"},E.mergeAttrs=function(j,k){for(var rt in k)rt==="class"?j[rt]=j[rt]?j[rt]+" "+k[rt]:k[rt]:rt==="style"?E.isObject(j[rt])&&E.isObject(k[rt])?j[rt]=E.mergeAttrs(j[rt],k[rt]):E.isObject(j[rt])?j[rt]=E.mergeAttrs(j[rt],E.styleToObject(k[rt])):E.isObject(k[rt])?j[rt]=E.mergeAttrs(E.styleToObject(j[rt]),k[rt]):j[rt]=E.mergeAttrs(E.styleToObject(j[rt]),E.styleToObject(k[rt])):j[rt]=k[rt];return j},E.annotateString=function(j,k,rt){k=k||[],rt=rt||{};for(var yt=rt.offset||0,xt=[],kt,de=[],Et,te,ht=0;ht<j.length;ht++){Et=de[ht]=j[ht];for(var ie=0;ie<k.length;ie++){var ln=k[ie],Le=ln.start+yt,_e=ln.end+yt;ht>=Le&&ht<_e&&(E.isObject(Et)?Et.attrs=E.mergeAttrs(E.mergeAttrs({},Et.attrs),ln.attrs):Et=de[ht]={t:j[ht],attrs:ln.attrs},rt.includeAnnotationIndices&&(Et.annotations||(Et.annotations=[])).push(ie))}te=de[ht-1],te?E.isObject(Et)&&E.isObject(te)?JSON.stringify(Et.attrs)===JSON.stringify(te.attrs)?kt.t+=Et.t:(xt.push(kt),kt=Et):E.isObject(Et)||E.isObject(te)?(xt.push(kt),kt=Et):kt=(kt||"")+Et:kt=Et}return kt&&xt.push(kt),xt},E.findAnnotationsAtIndex=function(j,k){var rt=[];return j&&j.forEach(function(yt){yt.start<k&&k<=yt.end&&rt.push(yt)}),rt},E.findAnnotationsBetweenIndexes=function(j,k,rt){var yt=[];return j&&j.forEach(function(xt){(k>=xt.start&&k<xt.end||rt>xt.start&&rt<=xt.end||xt.start>=k&&xt.end<rt)&&yt.push(xt)}),yt},E.shiftAnnotations=function(j,k,rt){return j&&j.forEach(function(yt){yt.start<k&&yt.end>=k?yt.end+=rt:yt.start>=k&&(yt.start+=rt,yt.end+=rt)}),j},E.convertLineToPathData=function(j){j=E(j);var k=["M",j.attr("x1"),j.attr("y1"),"L",j.attr("x2"),j.attr("y2")].join(" ");return k},E.convertPolygonToPathData=function(j){var k=E.getPointsFromSvgNode(j);return k.length===0?null:E.svgPointsToPath(k)+" Z"},E.convertPolylineToPathData=function(j){var k=E.getPointsFromSvgNode(j);return k.length===0?null:E.svgPointsToPath(k)},E.svgPointsToPath=function(j){for(var k=0,rt=j.length;k<rt;k++)j[k]=j[k].x+" "+j[k].y;return"M "+j.join(" L")},E.getPointsFromSvgNode=function(j){j=E.toNode(j);var k=[],rt=j.points;if(rt)for(var yt=0,xt=rt.numberOfItems;yt<xt;yt++)k.push(rt.getItem(yt));return k},E.KAPPA=.551784,E.convertCircleToPathData=function(j){j=E(j);var k=parseFloat(j.attr("cx"))||0,rt=parseFloat(j.attr("cy"))||0,yt=parseFloat(j.attr("r")),xt=yt*E.KAPPA,kt=["M",k,rt-yt,"C",k+xt,rt-yt,k+yt,rt-xt,k+yt,rt,"C",k+yt,rt+xt,k+xt,rt+yt,k,rt+yt,"C",k-xt,rt+yt,k-yt,rt+xt,k-yt,rt,"C",k-yt,rt-xt,k-xt,rt-yt,k,rt-yt,"Z"].join(" ");return kt},E.convertEllipseToPathData=function(j){j=E(j);var k=parseFloat(j.attr("cx"))||0,rt=parseFloat(j.attr("cy"))||0,yt=parseFloat(j.attr("rx")),xt=parseFloat(j.attr("ry"))||yt,kt=yt*E.KAPPA,de=xt*E.KAPPA,Et=["M",k,rt-xt,"C",k+kt,rt-xt,k+yt,rt-de,k+yt,rt,"C",k+yt,rt+de,k+kt,rt+xt,k,rt+xt,"C",k-kt,rt+xt,k-yt,rt+de,k-yt,rt,"C",k-yt,rt-de,k-kt,rt-xt,k,rt-xt,"Z"].join(" ");return Et},E.convertRectToPathData=function(j){return j=E(j),E.rectToPath({x:parseFloat(j.attr("x"))||0,y:parseFloat(j.attr("y"))||0,width:parseFloat(j.attr("width"))||0,height:parseFloat(j.attr("height"))||0,rx:parseFloat(j.attr("rx"))||0,ry:parseFloat(j.attr("ry"))||0})},E.rectToPath=function(j){var k,rt=j.x,yt=j.y,xt=j.width,kt=j.height,de=r(j.rx||j["top-rx"]||0,xt/2),Et=r(j.rx||j["bottom-rx"]||0,xt/2),te=r(j.ry||j["top-ry"]||0,kt/2),ht=r(j.ry||j["bottom-ry"]||0,kt/2);return de||Et||te||ht?k=["M",rt,yt+te,"v",kt-te-ht,"a",Et,ht,0,0,0,Et,ht,"h",xt-2*Et,"a",Et,ht,0,0,0,Et,-ht,"v",-(kt-ht-te),"a",de,te,0,0,0,-de,-te,"h",-(xt-2*de),"a",de,te,0,0,0,-de,te,"Z"]:k=["M",rt,yt,"H",rt+xt,"V",yt+kt,"H",rt,"V",yt,"Z"],k.join(" ")},E.normalizePathData=function(){var j=`	
\v\f\r   ᠎             　\u2028\u2029`,k=new RegExp("([a-z])["+j+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+j+"]*,?["+j+"]*)+)","ig"),rt=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+j+"]*,?["+j+"]*","ig"),yt=Math,xt=yt.PI,kt=yt.sin,de=yt.cos,Et=yt.tan,te=yt.asin,ht=yt.sqrt,ie=yt.abs;function ln(Yt,Ee,ve,ye,fe,mn){var Ue=.3333333333333333,Cn=2/3;return[Ue*Yt+Cn*ve,Ue*Ee+Cn*ye,Ue*fe+Cn*ve,Ue*mn+Cn*ye,fe,mn]}function Le(Yt,Ee,ve){var ye=Yt*de(ve)-Ee*kt(ve),fe=Yt*kt(ve)+Ee*de(ve);return{x:ye,y:fe}}function _e(Yt,Ee,ve,ye,fe,mn,Ue,Cn,Bn,Pn){var cn=xt*120/180,Un=xt/180*(+fe||0),R=[],st;if(Pn)Ye=Pn[0],Ge=Pn[1],pe=Pn[2],un=Pn[3];else{st=Le(Yt,Ee,-Un),Yt=st.x,Ee=st.y,st=Le(Cn,Bn,-Un),Cn=st.x,Bn=st.y;var gt=(Yt-Cn)/2,dt=(Ee-Bn)/2,wt=gt*gt/(ve*ve)+dt*dt/(ye*ye);wt>1&&(wt=ht(wt),ve=wt*ve,ye=wt*ye);var Zt=ve*ve,we=ye*ye,We=(mn==Ue?-1:1)*ht(ie((Zt*we-Zt*dt*dt-we*gt*gt)/(Zt*dt*dt+we*gt*gt))),pe=We*ve*dt/ye+(Yt+Cn)/2,un=We*-ye*gt/ve+(Ee+Bn)/2,Ye=te(((Ee-un)/ye).toFixed(9)),Ge=te(((Bn-un)/ye).toFixed(9));Ye=Yt<pe?xt-Ye:Ye,Ge=Cn<pe?xt-Ge:Ge,Ye<0&&(Ye=xt*2+Ye),Ge<0&&(Ge=xt*2+Ge),Ue&&Ye>Ge&&(Ye=Ye-xt*2),!Ue&&Ge>Ye&&(Ge=Ge-xt*2)}var Gn=Ge-Ye;if(ie(Gn)>cn){var _i=Ge,ui=Cn,ji=Bn;Ge=Ye+cn*(Ue&&Ge>Ye?1:-1),Cn=pe+ve*de(Ge),Bn=un+ye*kt(Ge),R=_e(Cn,Bn,ve,ye,fe,0,Ue,ui,ji,[Ge,_i,pe,un])}Gn=Ge-Ye;var Hi=de(Ye),vr=kt(Ye),Jr=de(Ge),$i=kt(Ge),uo=Et(Gn/4),Go=4/3*(ve*uo),Ir=4/3*(ye*uo),Ar=[Yt,Ee],Ro=[Yt+Go*vr,Ee-Ir*Hi],Qo=[Cn+Go*$i,Bn-Ir*Jr],_s=[Cn,Bn];if(Ro[0]=2*Ar[0]-Ro[0],Ro[1]=2*Ar[1]-Ro[1],Pn)return[Ro,Qo,_s].concat(R);R=[Ro,Qo,_s].concat(R).join().split(",");for(var bo=[],co=R.length,io=0;io<co;io++)bo[io]=io%2?Le(R[io-1],R[io],Un).y:Le(R[io],R[io+1],Un).x;return bo}function Me(Yt){if(!Yt)return null;var Ee={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},ve=[];return String(Yt).replace(k,function(ye,fe,mn){var Ue=[],Cn=fe.toLowerCase();for(mn.replace(rt,function(Bn,Pn){Pn&&Ue.push(+Pn)}),Cn==="m"&&Ue.length>2&&(ve.push([fe].concat(Ue.splice(0,2))),Cn="l",fe=fe==="m"?"l":"L");Ue.length>=Ee[Cn]&&(ve.push([fe].concat(Ue.splice(0,Ee[Cn]))),!!Ee[Cn]););}),ve}function be(Yt){if((!Array.isArray(Yt)||!Array.isArray(Yt&&Yt[0]))&&(Yt=Me(Yt)),!Yt||!Yt.length)return[["M",0,0]];for(var Ee=[],ve=0,ye=0,fe=0,mn=0,Ue=0,Cn,Bn=Yt.length,Pn=Ue;Pn<Bn;Pn++){var cn=[];Ee.push(cn);var Un=Yt[Pn];if(Cn=Un[0],Cn!=Cn.toUpperCase()){cn[0]=Cn.toUpperCase();var R,st;switch(cn[0]){case"A":cn[1]=Un[1],cn[2]=Un[2],cn[3]=Un[3],cn[4]=Un[4],cn[5]=Un[5],cn[6]=+Un[6]+ve,cn[7]=+Un[7]+ye;break;case"V":cn[1]=+Un[1]+ye;break;case"H":cn[1]=+Un[1]+ve;break;case"M":for(fe=+Un[1]+ve,mn=+Un[2]+ye,R=Un.length,st=1;st<R;st++)cn[st]=+Un[st]+(st%2?ve:ye);break;default:for(R=Un.length,st=1;st<R;st++)cn[st]=+Un[st]+(st%2?ve:ye);break}}else for(var gt=Un.length,dt=0;dt<gt;dt++)cn[dt]=Un[dt];switch(cn[0]){case"Z":ve=+fe,ye=+mn;break;case"H":ve=cn[1];break;case"V":ye=cn[1];break;case"M":fe=cn[cn.length-2],mn=cn[cn.length-1],ve=cn[cn.length-2],ye=cn[cn.length-1];break;default:ve=cn[cn.length-2],ye=cn[cn.length-1];break}}return Ee}function ue(Yt){var Ee=be(Yt),ve={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function ye(R,st,gt){var dt,wt;if(!R)return["C",st.x,st.y,st.x,st.y,st.x,st.y];switch(R[0]in{T:1,Q:1}||(st.qx=null,st.qy=null),R[0]){case"M":st.X=R[1],st.Y=R[2];break;case"A":parseFloat(R[1])===0||parseFloat(R[2])===0?R=["L",R[6],R[7]]:R=["C"].concat(_e.apply(0,[st.x,st.y].concat(R.slice(1))));break;case"S":gt==="C"||gt==="S"?(dt=st.x*2-st.bx,wt=st.y*2-st.by):(dt=st.x,wt=st.y),R=["C",dt,wt].concat(R.slice(1));break;case"T":gt==="Q"||gt==="T"?(st.qx=st.x*2-st.qx,st.qy=st.y*2-st.qy):(st.qx=st.x,st.qy=st.y),R=["C"].concat(ln(st.x,st.y,st.qx,st.qy,R[1],R[2]));break;case"Q":st.qx=R[1],st.qy=R[2],R=["C"].concat(ln(st.x,st.y,R[1],R[2],R[3],R[4]));break;case"H":R=["L"].concat(R[1],st.y);break;case"V":R=["L"].concat(st.x,R[1]);break}return R}function fe(R,st){if(R[st].length>7){R[st].shift();for(var gt=R[st];gt.length;)mn[st]="A",R.splice(st++,0,["C"].concat(gt.splice(0,6)));R.splice(st,1),Bn=Ee.length}}for(var mn=[],Ue="",Cn="",Bn=Ee.length,Pn=0;Pn<Bn;Pn++){Ee[Pn]&&(Ue=Ee[Pn][0]),Ue!=="C"&&(mn[Pn]=Ue,Pn>0&&(Cn=mn[Pn-1])),Ee[Pn]=ye(Ee[Pn],ve,Cn),mn[Pn]!=="A"&&Ue==="C"&&(mn[Pn]="C"),fe(Ee,Pn);var cn=Ee[Pn],Un=cn.length;ve.x=cn[Un-2],ve.y=cn[Un-1],ve.bx=parseFloat(cn[Un-4])||ve.x,ve.by=parseFloat(cn[Un-3])||ve.y}return(!Ee[0][0]||Ee[0][0]!=="M")&&Ee.unshift(["M",0,0]),Ee}return function(Yt){return ue(Yt).join(",").split(",").join(" ")}}(),E.namespace=e,E.g=hO,E}(),yn=_O,Nc={useCSSSelectors:!0,classNamePrefix:"joint-",defaultTheme:"default",doubleTapInterval:300},oh=function(t){return t&&t.toString().split(" ").map(function(e){return e.substr(0,Nc.classNamePrefix.length)!==Nc.classNamePrefix&&(e=Nc.classNamePrefix+e),e}).join(" ")},vO=function(t){return t&&t.toString().split(" ").map(function(e){return e.substr(0,Nc.classNamePrefix.length)===Nc.classNamePrefix&&(e=e.substr(Nc.classNamePrefix.length)),e}).join(" ")},ax=function(t,e){for(var n={},o={},l=yn.namespace.svg,c=e||l,p=document.createDocumentFragment(),r=[t,p,c];r.length>0;){c=r.pop();for(var w=r.pop(),M=r.pop(),N=0,E=M.length;N<E;N++){var Z=M[N];if(!Z.hasOwnProperty("tagName"))throw new Error("json-dom-parser: missing tagName");var Y=Z.tagName;Z.hasOwnProperty("namespaceURI")&&(c=Z.namespaceURI);var K=document.createElementNS(c,Y),q=c===l,at=q?yn:lo,J=Z.attributes;J&&at(K).attr(J);var Q=Z.style;if(Q&&lo(K).css(Q),Z.hasOwnProperty("className")){var lt=Z.className;q?K.className.baseVal=lt:K.className=lt}if(Z.hasOwnProperty("textContent")&&(K.textContent=Z.textContent),Z.hasOwnProperty("selector")){var Ct=Z.selector;if(n[Ct])throw new Error("json-dom-parser: selector must be unique");n[Ct]=K,at(K).attr("joint-selector",Ct)}if(Z.hasOwnProperty("groupSelector")){var j=Z.groupSelector;Array.isArray(j)||(j=[j]);for(var k=0,rt=j.length;k<rt;k++){var yt=j[k],xt=o[yt];xt||(xt=o[yt]=[]),xt.push(K)}}w.appendChild(K);var kt=Z.children;Array.isArray(kt)&&r.push(kt,K,c)}}return{fragment:p,selectors:n,groupSelectors:o}},i1=function(t){let e=0;if(t.length===0)return e;for(let n=0;n<t.length;n++){const o=t.charCodeAt(n);e=(e<<5)-e+o,e=e&e}return e},Kv=function(t,e,n){for(var o=Array.isArray(e)?e:e.split(n||"/"),l,c=0,p=o.length;c<p;)if(l=o[c++],Object(t)===t&&l in t)t=t[l];else return;return t},pk=function(t,e){return typeof e!="string"&&typeof e!="number"&&(e=String(e)),!(e==="constructor"&&typeof t[e]=="function"||e==="__proto__")},VC=function(t,e,n,o){const l=Array.isArray(e)?e:e.split(o||"/"),c=l.length-1;let p=t,r=0;for(;r<c;r++){const w=l[r];if(!pk(p,w))return t;p=p[w]||(p[w]={})}return p[l[c]]=n,t},TS=function(t,e,n){const o=Array.isArray(e)?e:e.split(n||"/"),l=o.length-1;let c=t,p=0;for(;p<l;p++){const r=o[p];if(!pk(c,r))return t;const w=c[r];if(!w)return t;c=w}return delete c[o[l]],t},yO=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})},sg=function(t){return sg.id=sg.id||1,t===void 0?"j_"+sg.id++:(t.id=t.id===void 0?"j_"+sg.id++:t.id,t.id)},xO=function(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()},cu=function(t){var e=t,n=t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0];if(n){for(var o in t)n[o]===void 0&&(n[o]=t[o]);e=n}var l=e.target;if(l){var c=l.correspondingUseElement;c&&(e.target=c)}return e},wO=function(t){let l=0,c=0,p=0,r=0;return"detail"in t&&(c=t.detail),"wheelDelta"in t&&(c=-t.wheelDelta/120),"wheelDeltaY"in t&&(c=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(l=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(l=c,c=0),p="deltaX"in t?t.deltaX:l*10,r="deltaY"in t?t.deltaY:c*10,(p||r)&&t.deltaMode&&(t.deltaMode==1?(p*=40,r*=40):(p*=800,r*=800)),t.deltaX===0&&t.deltaY!==0&&t.shiftKey&&(p=r,r=0,l=c,c=0),p&&!l&&(l=p<1?-1:1),r&&!c&&(c=r<1?-1:1),{spinX:l,spinY:c,deltaX:p,deltaY:r}},bO=function(t,e){return t>e?e:t<-e?-e:t},WC=function(){var t;if(typeof window<"u"&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!t){var e=0;t=function(n){var o=new Date().getTime(),l=Math.max(0,16-(o-e)),c=setTimeout(function(){n(o+l)},l);return e=o+l,c}}return function(n,o,...l){return t(o!==void 0?n.bind(o,...l):n)}}(),YC=function(){var t,e=typeof window<"u";return e&&(t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),t=t||clearTimeout,e?t.bind(window):t}(),Gu=function(t){return mu(t)&&t.slice(-1)==="%"},IO=function(t,e){function n(r){var w=new RegExp("(?:\\d+(?:\\.\\d+)*)("+r+")$").exec(t);return w?w[1]:null}var o=parseFloat(t);if(Number.isNaN(o))return null;var l={};l.value=o;var c;if(e==null)c="[A-Za-z]*";else if(Array.isArray(e)){if(e.length===0)return null;c=e.join("|")}else mu(e)&&(c=e);var p=n(c);return p===null?null:(l.unit=p,l)},lx=0;function CO(t,e){const n=t.split(e);let o=1;for(let l=0,c=n.length-1;l<c;l++){const p=[];(l>0||n[0]!=="")&&p.push(lx),p.push(e),(l<c-1||n[c]!=="")&&p.push(lx),n.splice(o,0,...p),o+=p.length+1}return n.filter(l=>l!=="")}const mk=function(t,e,n={},o={}){var l=e.width,c=e.height,p=o.svgDocument||yn("svg").node,r=yn("tspan").node,w=yn("text").attr(n).append(r).node,M=document.createTextNode("");w.style.opacity=0,w.style.display="block",r.style.display="block",r.appendChild(M),p.appendChild(w),o.svgDocument||document.body.appendChild(p);const N=o.preserveSpaces,E=" ";var Z=o.separator||E,Y=o.eol||`
`,K=o.hyphen?new RegExp(o.hyphen):/[^\w\d]/,q=o.maxLineCount;Du(q)||(q=1/0);var at=t.split(Z),J=[],Q=[],lt,Ct,j;N&&yn(r).attr("xml:space","preserve");for(var k=0,rt=0,yt=at.length;k<yt;k++){var xt=at[k];if(!(!xt&&!N)&&typeof xt=="string"){var kt=!1;if(Y&&xt.indexOf(Y)>=0)if(xt.length>1){const ue=CO(at[k],Y);at.splice(k,1,...ue),k--,yt=at.length;continue}else{if(N&&typeof at[k-1]=="string"){at.splice(k,lx,"",lx),yt+=2,k--;continue}Q[++rt]=!N||typeof at[k+1]=="string"?"":void 0,kt=!0}if(!kt){let ue;if(N?ue=Q[rt]!==void 0?Q[rt]+E+xt:xt:ue=Q[rt]?Q[rt]+E+xt:xt,M.data=ue,r.getComputedTextLength()<=l)Q[rt]=ue,(lt||Ct)&&(J[rt++]=!0,lt=0,Ct=0);else{if(!Q[rt]||lt){var de=!!lt;if(lt=xt.length-1,de||!lt){if(!lt){if(!Q[rt]){Q=[];break}at.splice(k,2,xt+at[k+1]),yt--,J[rt++]=!0,k--;continue}at[k]=xt.substring(0,lt),at[k+1]=xt.substring(lt)+(at[k+1]===void 0?"":at[k+1])}else{if(Ct)at.splice(k,2,at[k]+at[k+1]),Ct=0;else{var Et=xt.search(K);Et>-1&&Et!==xt.length-1&&Et!==0&&(Ct=Et+1,lt=0),at.splice(k,1,xt.substring(0,Ct||lt),xt.substring(Ct||lt)),yt++}rt&&!J[rt-1]&&rt--}(!N||Q[rt]!=="")&&k--;continue}rt++,k--}}var te=null;if(Q.length>q)te=q-1;else if(c!==void 0){if(j===void 0&&M.data!==""){var ht;n.lineHeight==="auto"?ht={value:1.5,unit:"em"}:ht=IO(n.lineHeight,["em"])||{value:1,unit:"em"},j=ht.value,ht.unit==="em"&&(j*=w.getBBox().height)}j*Q.length>c&&(te=Math.floor(c/j)-1)}if(te!==null){Q.splice(te+1);var ie=o.ellipsis;if(!ie||te<0)break;typeof ie!="string"&&(ie="…");var ln=Q[te];if(!ln&&!kt)break;var Le=ln.length,_e,Me,be;do{if(Me=ln[Le],_e=ln.substring(0,Le),Me?Me.match(Z)&&(_e+=Me):(be=typeof Z=="string"?Z:" ",_e+=be),_e+=ie,M.data=_e,r.getComputedTextLength()<=l){Q[te]=_e;break}Le--}while(Le>=0);break}}}return o.svgDocument?p.removeChild(w):document.body.removeChild(p),Q.join(Y)},AO=function(t){var e=lo(lo.parseHTML("<div>"+t+"</div>",null,!1));return e.find("*").each(function(){var n=this;lo.each(n.attributes,function(){var o=this,l=o.name,c=o.value;(l.startsWith("on")||c.startsWith("javascript:")||c.startsWith("data:")||c.startsWith("vbscript:"))&&lo(n).removeAttr(l)})}),e.html()},TO=function(t,e){var n=lo(t),o=n.map(function(){var l=this,c=l.parentNode,p=c.insertBefore(document.createTextNode(""),l.nextSibling);return function(){if(c===this)throw new Error("You can't sort elements if any one is a descendant of another.");c.insertBefore(this,p),c.removeChild(p)}});return Array.prototype.sort.call(n,e).each(function(l){o[l].call(this)})},Dp=function(t){if(Object(t)!==t){var e=0;return isFinite(t)&&(e=+t),{top:e,right:e,bottom:e,left:e}}var n,o,l,c;return n=o=l=c=0,isFinite(t.vertical)&&(n=l=+t.vertical),isFinite(t.horizontal)&&(o=c=+t.horizontal),isFinite(t.top)&&(n=+t.top),isFinite(t.right)&&(o=+t.right),isFinite(t.bottom)&&(l=+t.bottom),isFinite(t.left)&&(c=+t.left),{top:n,right:o,bottom:l,left:c}},SO={linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,n=1;;e+=n,n/=2)if(t>=(7-4*e)/11){var o=(11-6*e-11*t)/4;return-o*o+n*n}},reverse:function(t){return function(e){return 1-t(1-e)}},reflect:function(t){return function(e){return .5*(e<.5?t(2*e):2-t(2-2*e))}},clamp:function(t,e,n){return e=e||0,n=n||1,function(o){var l=t(o);return l<e?e:l>n?n:l}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},elastic:function(t){return t||(t=1.5),function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}},gk={number:function(t,e){var n=e-t;return function(o){return t+n*o}},object:function(t,e){var n=Object.keys(t);return function(o){var l,c,p={};for(l=n.length-1;l!=-1;l--)c=n[l],p[c]=t[c]+(e[c]-t[c])*o;return p}},hexColor:function(t,e){var n=parseInt(t.slice(1),16),o=parseInt(e.slice(1),16),l=n&255,c=(o&255)-l,p=n&65280,r=(o&65280)-p,w=n&16711680,M=(o&16711680)-w;return function(N){var E=l+c*N&255,Z=p+r*N&65280,Y=w+M*N&16711680;return"#"+(1<<24|E|Z|Y).toString(16).slice(1)}},unit:function(t,e){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,o=n.exec(t),l=n.exec(e),c=l[1].indexOf("."),p=c>0?l[1].length-c-1:0;t=+o[1];var r=+l[1]-t,w=o[2];return function(M){return(t+r*M).toFixed(p)+w}}},EO={outline:function(t){var e='<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>',n=Number.isFinite(t.margin)?t.margin:2,o=Number.isFinite(t.width)?t.width:1;return hu(e)({color:t.color||"blue",opacity:Number.isFinite(t.opacity)?t.opacity:1,outerRadius:n+o,innerRadius:n})},highlight:function(t){var e='<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>';return hu(e)({color:t.color||"red",width:Number.isFinite(t.width)?t.width:1,blur:Number.isFinite(t.blur)?t.blur:0,opacity:Number.isFinite(t.opacity)?t.opacity:1})},blur:function(t){var e=Number.isFinite(t.x)?t.x:2;return hu('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({stdDeviation:Number.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return hu(e)({dx:t.dx||0,dy:t.dy||0,opacity:Number.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:Number.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return hu('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return hu('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return hu('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({amount:1-e})},hueRotate:function(t){return hu('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({angle:t.angle||0})},invert:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return hu('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:1-e})},brightness:function(t){return hu('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({amount:Number.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return hu('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:.5-e/2})}},hu=function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^{} ]+) ?\}|\{\{([^{} ]+)\}\}/g;return function(n){return n=n||{},t.replace(e,function(o){for(var l=Array.from(arguments),c=l.slice(1,4).find(function(w){return!!w}),p=c.split("."),r=n[p.shift()];r!==void 0&&p.length;)r=r[p.shift()];return r!==void 0?r:""})}};Gr.assign;Gr.defaults;Gr.defaultsDeep;const Wi=Gr.assign,Eh=Gr.defaults,mA=Gr.defaultsDeep,Ph=Gr.invokeMap||Gr.invoke,_k=Gr.sortedIndexBy||Gr.sortedIndex,Sg=Gr.uniqBy||Gr.uniq,Sh=Gr.clone,kc=Gr.cloneDeep,ud=Gr.isEmpty,ag=Gr.isEqual,Jo=Gr.isFunction,rl=Gr.isPlainObject,Ur=Gr.toArray,MO=Gr.debounce,LO=Gr.groupBy;Gr.sortBy;const kO=Gr.flattenDeep,XC=Gr.without,vk=Gr.difference;Gr.intersection;const HC=Gr.union,mf=Gr.has,ca=Gr.result,Np=Gr.omit,PO=Gr.pick;Gr.bindAll;const ih=Gr.forIn,zO=Gr.camelCase,DO=Gr.uniqueId,sl=function(){if(Gr.mergeWith){var t=Array.from(arguments),e=t[t.length-1],n=Jo(e)?e:OO;return t.push(function(o,l){var c=n(o,l);if(c!==void 0)return c;if(Array.isArray(o)&&!Array.isArray(l))return l}),Gr.mergeWith.apply(this,t)}return Gr.merge.apply(this,arguments)},NO=function(t){var e=Object.prototype.toString;return t===!0||t===!1||!!t&&typeof t=="object"&&e.call(t)==="[object Boolean]"},As=function(t){return!!t&&(typeof t=="object"||typeof t=="function")},Du=function(t){var e=Object.prototype.toString;return typeof t=="number"||!!t&&typeof t=="object"&&e.call(t)==="[object Number]"},mu=function(t){var e=Object.prototype.toString;return typeof t=="string"||!!t&&typeof t=="object"&&e.call(t)==="[object String]"},OO=function(){};function yk(t){t=Sg(t);const e=Ur(t).reduce(function(n,o){return n[o.id]=o.clone(),n},{});return Ur(t).forEach(function(n){const o=e[n.id];if(o.isLink()){const p=o.source(),r=o.target();p.id&&e[p.id]&&o.prop("source/id",e[p.id].id),r.id&&e[r.id]&&o.prop("target/id",e[r.id].id)}const l=n.get("parent");l&&e[l]&&o.set("parent",e[l].id);const c=Ur(n.get("embeds")).reduce(function(p,r){return e[r]&&p.push(e[r].id),p},[]);ud(c)||o.set("embeds",c)}),e}function ed(t,e){return function(n,o){var l=Gu(n);n=parseFloat(n),l&&(n/=100);var c={};if(isFinite(n)){var p=l||n>=0&&n<=1?n*o[e]:Math.max(n+o[e],0);c[t]=p}return c}}function r1(t,e,n){return function(o,l){var c=Gu(o);o=parseFloat(o),c&&(o/=100);var p;if(isFinite(o)){var r=l[n]();c||o>0&&o<1?p=r[t]+l[e]*o:p=r[t]+o}var w=Te();return w[t]=p||0,w}}function SS(t,e,n){return function(o,l){var c;o==="middle"?c=l[e]/2:o===n?c=l[e]:isFinite(o)?c=o>-1&&o<1?-l[e]*o:-o:Gu(o)?c=l[e]*parseFloat(o)/100:c=0;var p=Te();return p[t]=-(l[t]+c),p}}function xk(t,e){var n="joint-shape",o=e&&e.resetOffset;return function(l,c,p){var r=lo(p),w=r.data(n);if(!w||w.value!==l){var M=t(l);w={value:l,shape:M,shapeBBox:M.bbox()},r.data(n,w)}var N=w.shape.clone(),E=w.shapeBBox.clone(),Z=E.origin(),Y=c.origin();E.x=Y.x,E.y=Y.y;var K=c.maxRectScaleToFit(E,Y),q=E.width===0||c.width===0?1:K.sx,at=E.height===0||c.height===0?1:K.sy;return N.scale(q,at,Z),o&&N.translate(-Z.x,-Z.y),N}}function ES(t){function e(o){return new zi(yn.normalizePathData(o))}var n=xk(e,t);return function(o,l,c){var p=n(o,l,c);return{d:p.serialize()}}}function MS(t){var e=xk(as,t);return function(n,o,l){var c=e(n,o,l);return{points:c.serialize()}}}function o1(t,e){var n=new Te(1,0);return function(o){var l,c,p=this[t](o);return p?(c=e.rotate?p.vector().vectorAngle(n):0,l=p.start):(l=this.path.start,c=0),c===0?{transform:"translate("+l.x+","+l.y+")"}:{transform:"translate("+l.x+","+l.y+") rotate("+c+")"}}}function LS(t){return function(n,o,l){const c=yn(l);c.attr(t)!==n&&c.attr(t,n)}}function Vm(t,e,n){return n.text!==void 0}function dv(){return this.model.isLink()}function EI(t){var e={},n=t.stroke;typeof n=="string"&&(e.stroke=n,e.fill=n);var o=t.strokeOpacity;return o===void 0&&(o=t["stroke-opacity"]),o===void 0&&(o=t.opacity),o!==void 0&&(e["stroke-opacity"]=o,e["fill-opacity"]=o),e}function kS(t){const{paper:e}=this;return`url(#${t.type==="pattern"?e.definePattern(t):e.defineGradient(t)})`}const _r={xlinkShow:{set:"xlink:show"},xlinkRole:{set:"xlink:role"},xlinkType:{set:"xlink:type"},xlinkArcrole:{set:"xlink:arcrole"},xlinkTitle:{set:"xlink:title"},xlinkActuate:{set:"xlink:actuate"},xmlSpace:{set:"xml:space"},xmlBase:{set:"xml:base"},xmlLang:{set:"xml:lang"},preserveAspectRatio:{set:"preserveAspectRatio"},requiredExtension:{set:"requiredExtension"},requiredFeatures:{set:"requiredFeatures"},systemLanguage:{set:"systemLanguage"},externalResourcesRequired:{set:"externalResourceRequired"},href:{set:LS("href")},xlinkHref:{set:LS("xlink:href")},filter:{qualify:rl,set:function(t){return"url(#"+this.paper.defineFilter(t)+")"}},fill:{qualify:rl,set:kS},stroke:{qualify:rl,set:kS},sourceMarker:{qualify:rl,set:function(t,e,n,o){return t=Wi(EI(o),t),{"marker-start":"url(#"+this.paper.defineMarker(t)+")"}}},targetMarker:{qualify:rl,set:function(t,e,n,o){return t=Wi(EI(o),{transform:"rotate(180)"},t),{"marker-end":"url(#"+this.paper.defineMarker(t)+")"}}},vertexMarker:{qualify:rl,set:function(t,e,n,o){return t=Wi(EI(o),t),{"marker-mid":"url(#"+this.paper.defineMarker(t)+")"}}},text:{qualify:function(t,e,n){return!n.textWrap||!rl(n.textWrap)},set:function(t,e,n,o){var l=lo(n),c="joint-text",p=l.data(c),r=PO(o,"lineHeight","annotations","textPath","x","textVerticalAnchor","eol","displayEmpty");const{x:w}=r;Lh(w)&&(r.x=kh(w,e));let M=o["font-size"]||o.fontSize;Lh(M)&&(M=kh(M,e));var N=r.fontSize=M,E=JSON.stringify([t,r]);if(p===void 0||p!==E){N&&n.setAttribute("font-size",N);var Z=r.textPath;if(As(Z)){var Y=Z.selector;if(typeof Y=="string"){var K=this.findBySelector(Y)[0];K instanceof SVGPathElement&&(r.textPath=Wi({"xlink:href":"#"+K.id},Z))}}yn(n).text(""+t,r),l.data(c,E)}}},textWrap:{qualify:rl,set:function(t,e,n,o){var l={},c=t.width||0;Gu(c)?l.width=e.width*parseFloat(c)/100:Lh(c)?l.width=Number(kh(c,e)):t.width===null?l.width=1/0:c<=0?l.width=e.width+c:l.width=c;var p=t.height||0;Gu(p)?l.height=e.height*parseFloat(p)/100:Lh(p)?l.height=Number(kh(p,e)):t.height===null||(p<=0?l.height=e.height+p:l.height=p);var r,w=t.text;if(w===void 0&&(w=o.text),w!==void 0){const M=t.breakText||mk,N=o["font-size"]||o.fontSize;r=M(""+w,l,{"font-weight":o["font-weight"]||o.fontWeight,"font-size":Lh(N)?kh(N,e):N,"font-family":o["font-family"]||o.fontFamily,lineHeight:o.lineHeight,"letter-spacing":"letter-spacing"in o?o["letter-spacing"]:o.letterSpacing},{svgDocument:this.paper.svg,ellipsis:t.ellipsis,hyphen:t.hyphen,maxLineCount:t.maxLineCount,preserveSpaces:t.preserveSpaces})}else r="";_r.text.set.call(this,r,e,n,o)}},title:{qualify:function(t,e){return e instanceof SVGElement},set:function(t,e,n){var o=lo(n),l="joint-title",c=o.data(l);if(c===void 0||c!==t){o.data(l,t);var p=n.firstChild;if(p&&p.tagName.toUpperCase()==="TITLE")p.textContent=t;else{var r=document.createElementNS(n.namespaceURI,"title");r.textContent=t,n.insertBefore(r,p)}}}},lineHeight:{qualify:Vm},textVerticalAnchor:{qualify:Vm},textPath:{qualify:Vm},annotations:{qualify:Vm},eol:{qualify:Vm},displayEmpty:{qualify:Vm},port:{set:function(t){return t===null||t.id===void 0?t:t.id}},style:{qualify:rl,set:function(t,e,n){lo(n).css(t)}},html:{set:function(t,e,n){lo(n).html(t+"")}},ref:{},refX:{position:r1("x","width","origin")},refY:{position:r1("y","height","origin")},refDx:{position:r1("x","width","corner")},refDy:{position:r1("y","height","corner")},refWidth:{set:ed("width","width")},refHeight:{set:ed("height","height")},refRx:{set:ed("rx","width")},refRy:{set:ed("ry","height")},refRInscribed:{set:function(t){var e=ed(t,"width"),n=ed(t,"height");return function(o,l){var c=l.height>l.width?e:n;return c(o,l)}}("r")},refRCircumscribed:{set:function(t,e){var n=Gu(t);t=parseFloat(t),n&&(t/=100);var o=Math.sqrt(e.height*e.height+e.width*e.width),l;return isFinite(t)&&(n||t>=0&&t<=1?l=t*o:l=Math.max(t+o,0)),{r:l}}},refCx:{set:ed("cx","width")},refCy:{set:ed("cy","height")},xAlignment:{offset:SS("x","width","right")},yAlignment:{offset:SS("y","height","bottom")},resetOffset:{offset:function(t,e){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}},refDResetOffset:{set:ES({resetOffset:!0})},refDKeepOffset:{set:ES({resetOffset:!1})},refPointsResetOffset:{set:MS({resetOffset:!0})},refPointsKeepOffset:{set:MS({resetOffset:!1})},connection:{qualify:dv,set:function({stubs:t=0}){let e;if(isFinite(t)&&t!==0){let n;t<0?n=(this.getConnectionLength()+t)/2:n=t;const o=this.getConnection(),l=this.getConnectionSubdivisions(),c=o.divideAtLength(n,{segmentSubdivisions:l}),p=o.divideAtLength(-n,{segmentSubdivisions:l});c&&p&&(e=`${c[0].serialize()} ${p[1].serialize()}`)}return{d:e||this.getSerializedConnection()}}},atConnectionLengthKeepGradient:{qualify:dv,set:o1("getTangentAtLength",{rotate:!0})},atConnectionLengthIgnoreGradient:{qualify:dv,set:o1("getTangentAtLength",{rotate:!1})},atConnectionRatioKeepGradient:{qualify:dv,set:o1("getTangentAtRatio",{rotate:!0})},atConnectionRatioIgnoreGradient:{qualify:dv,set:o1("getTangentAtRatio",{rotate:!1})}};_r["xlink:href"]=_r.xlinkHref;["transform","d","points","cx","cy","x1","x2","y1","y2","x","y","dx","dy"].forEach(t=>{_r[t]={qualify:Lh,set:function(n,o){return{[t]:kh(n,o)}}}});["width","height","r","rx","ry","font-size","stroke-width"].forEach(t=>{_r[t]={qualify:Lh,set:function(n,o){return{[t]:Math.max(0,kh(n,o))}}}});_r.refR=_r.refRInscribed;_r.refD=_r.refDResetOffset;_r.refPoints=_r.refPointsResetOffset;_r.atConnectionLength=_r.atConnectionLengthKeepGradient;_r.atConnectionRatio=_r.atConnectionRatioKeepGradient;_r.fontSize=_r["font-size"];_r.strokeWidth=_r["stroke-width"];_r.refX2=_r.refX;_r.refY2=_r.refY;_r.refWidth2=_r.refWidth;_r.refHeight2=_r.refHeight;_r["ref-x"]=_r.refX;_r["ref-y"]=_r.refY;_r["ref-dy"]=_r.refDy;_r["ref-dx"]=_r.refDx;_r["ref-width"]=_r.refWidth;_r["ref-height"]=_r.refHeight;_r["x-alignment"]=_r.xAlignment;_r["y-alignment"]=_r.yAlignment;const wk=_r,Oh=Yl.Model.extend({constructor:function(t,e){var n,o=t||{};typeof this.preinitialize=="function"&&this.preinitialize.apply(this,arguments),this.cid=DO("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(o=this.parse(o,e)||{}),(n=ca(this,"defaults"))&&(o=sl({},n,o)),this.set(o,e),this.changed={},this.initialize.apply(this,arguments)},translate:function(t,e,n){throw new Error("Must define a translate() method.")},toJSON:function(){const e=ca(this.constructor.prototype,"defaults").attrs||{},n=this.attributes.attrs,o={};ih(n,function(c,p){const r=e[p];ih(c,function(w,M){As(w)&&!Array.isArray(w)?ih(w,function(N,E){(!r||!r[M]||!ag(r[M][E],N))&&(o[p]=o[p]||{},(o[p][M]||(o[p][M]={}))[E]=N)}):(!r||!ag(r[M],w))&&(o[p]=o[p]||{},o[p][M]=w)})});const l=kc(Np(this.attributes,"attrs"));return l.attrs=o,l},initialize:function(t){const e=this.getIdAttribute();(!t||!(e in t))&&this.set(e,this.generateId(),{silent:!0}),this._transitionIds={},this._scheduledTransitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},getIdAttribute:function(){return this.idAttribute||"id"},generateId:function(){return yO()},processPorts:function(){var t=this.ports,e={};ih(this.get("attrs"),function(c,p){c&&c.port&&(c.port.id!==void 0?e[c.port.id]=c.port:e[c.port]={id:c.port})});var n={};if(ih(t,function(c,p){e[p]||(n[p]=!0)}),this.graph&&!ud(n)){var o=this.graph.getConnectedLinks(this,{inbound:!0});o.forEach(function(c){n[c.get("target").port]&&c.remove()});var l=this.graph.getConnectedLinks(this,{outbound:!0});l.forEach(function(c){n[c.get("source").port]&&c.remove()})}this.ports=e},remove:function(t={}){const{graph:e,collection:n}=this;if(!e)return n&&n.remove(this,t),this;e.startBatch("remove");const o=this.getParentCell();o&&o.unembed(this,t);const l=this.getEmbeddedCells();for(let c=0,p=l.length;c<p;c++){const r=l[c];r&&r.remove(t)}return this.trigger("remove",this,e.attributes.cells,t),e.stopBatch("remove"),this},toFront:function(t){var e=this.graph;if(e){t=t||{};var n=e.maxZIndex(),o;t.deep?(o=this.getEmbeddedCells({deep:!0,breadthFirst:t.breadthFirst!==!1}),o.unshift(this)):o=[this],n=n-o.length+1;var l=e.get("cells"),c=l.indexOf(this)!==l.length-o.length;c||(c=o.some(function(p,r){return p.get("z")!==n+r})),c&&(this.startBatch("to-front"),n=n+o.length,o.forEach(function(p,r){p.set("z",n+r,t)}),this.stopBatch("to-front"))}return this},toBack:function(t){var e=this.graph;if(e){t=t||{};var n=e.minZIndex(),o;t.deep?(o=this.getEmbeddedCells({deep:!0,breadthFirst:t.breadthFirst!==!1}),o.unshift(this)):o=[this];var l=e.get("cells"),c=l.indexOf(this)!==0;c||(c=o.some(function(p,r){return p.get("z")!==n+r})),c&&(this.startBatch("to-back"),n-=o.length,o.forEach(function(p,r){p.set("z",n+r,t)}),this.stopBatch("to-back"))}return this},parent:function(t,e){return t===void 0?this.get("parent"):this.set("parent",t,e)},embed:function(t,e){const n=Array.isArray(t)?t:[t];if(!this.canEmbed(n))throw new Error("Recursive embedding not allowed.");if(n.some(o=>o.isEmbedded()&&this.id!==o.parent()))throw new Error("Embedding of already embedded cells is not allowed.");return this._embedCells(n,e),this},unembed:function(t,e){const n=Array.isArray(t)?t:[t];return this._unembedCells(n,e),this},canEmbed:function(t){return(Array.isArray(t)?t:[t]).every(n=>this!==n&&!this.isEmbeddedIn(n))},_embedCells:function(t,e){const n="embed";this.startBatch(n);const o=Wi([],this.get("embeds"));t.forEach(l=>{o[l.isLink()?"unshift":"push"](l.id),l.parent(this.id,e)}),this.set("embeds",Sg(o),e),this.stopBatch(n)},_unembedCells:function(t,e){const n="unembed";this.startBatch(n),t.forEach(o=>o.unset("parent",e)),this.set("embeds",XC(this.get("embeds"),...t.map(o=>o.id)),e),this.stopBatch(n)},getParentCell:function(){var t=this.parent(),e=this.graph;return t&&e&&e.getCell(t)||null},getAncestors:function(){var t=[];if(!this.graph)return t;for(var e=this.getParentCell();e;)t.push(e),e=e.getParentCell();return t},getEmbeddedCells:function(t){if(t=t||{},this.graph){var e;if(t.deep)if(t.breadthFirst){e=[];for(var n=this.getEmbeddedCells();n.length>0;){var o=n.shift();e.push(o),n.push.apply(n,o.getEmbeddedCells())}}else e=this.getEmbeddedCells(),e.forEach(function(l){e.push.apply(e,l.getEmbeddedCells(t))});else e=Ur(this.get("embeds")).map(this.graph.getCell,this.graph);return e}return[]},isEmbeddedIn:function(t,e){var n=mu(t)?t:t.id,o=this.parent();if(e=Wi({deep:!0},e),this.graph&&e.deep){for(;o;){if(o===n)return!0;o=this.graph.getCell(o).parent()}return!1}else return o===n},isEmbedded:function(){return!!this.parent()},clone:function(t){if(t=t||{},t.deep)return Ur(yk([this].concat(this.getEmbeddedCells({deep:!0}))));var e=Yl.Model.prototype.clone.apply(this,arguments);return e.set(this.getIdAttribute(),this.generateId()),e.unset("embeds"),e.unset("parent"),e},prop:function(t,e,n){var o="/",l=mu(t);if(l||Array.isArray(t))if(arguments.length>1){var c,p;l?(c=t,p=c.split("/")):(c=t.join(o),p=t.slice());var r=p[0],w=p.length;if(n=n||{},n.propertyPath=c,n.propertyValue=e,n.propertyPathArray=p,w===1)return this.set(r,e,n);for(var M={},N=M,E=r,Z=1;Z<w;Z++){var Y=p[Z],K=Number.isFinite(l?Number(Y):Y);N=N[E]=K?[]:{},E=Y}M=VC(M,p,e,"/");var q=sl({},this.attributes);n.rewrite&&TS(q,c,"/");var at=sl(q,M);return this.set(r,at[r],n)}else return Kv(this.attributes,t,o);return this.set(sl({},this.attributes,t),e)},removeProp:function(t,e){e=e||{};var n=Array.isArray(t)?t:t.split("/"),o=n[0];if(o==="attrs"&&(e.dirty=!0),n.length===1)return this.unset(t,e);var l=n.slice(1),c=this.get(o);return c==null?this:(c=kc(c),TS(c,l,"/"),this.set(o,c,e))},attr:function(t,e,n){var o=Array.from(arguments);return o.length===0?this.get("attrs"):(Array.isArray(t)?o[0]=["attrs"].concat(t):mu(t)?o[0]="attrs/"+t:o[0]={attrs:t},this.prop.apply(this,o))},removeAttr:function(t,e){return Array.isArray(t)?this.removeProp(["attrs"].concat(t)):this.removeProp("attrs/"+t,e)},transition:function(t,e,n,o){o=o||"/";var l={duration:100,delay:10,timingFunction:SO.linear,valueFunction:gk.number};n=Wi(l,n);var c=0,p,r=function(E){var Z,Y,K;c=c||E,E-=c,Y=E/n.duration,Y<1?this._transitionIds[t]=Z=WC(r):(Y=1,delete this._transitionIds[t]),K=p(n.timingFunction(Y)),n.transitionId=Z,this.prop(t,K,n),Z||this.trigger("transition:end",this,t)}.bind(this);const{_scheduledTransitionIds:w}=this;let M;var N=E=>{w[t]&&(w[t]=XC(w[t],M),w[t].length===0&&delete w[t]),this.stopPendingTransitions(t,o),p=n.valueFunction(Kv(this.attributes,t,o),e),this._transitionIds[t]=WC(E),this.trigger("transition:start",this,t)};return M=setTimeout(N,n.delay,r),w[t]||(w[t]=[]),w[t].push(M),M},getTransitions:function(){return HC(Object.keys(this._transitionIds),Object.keys(this._scheduledTransitionIds))},stopScheduledTransitions:function(t,e="/"){const{_scheduledTransitionIds:n={}}=this;let o=Object.keys(n);if(t){const l=t.split(e);o=o.filter(c=>ag(l,c.split(e).slice(0,l.length)))}return o.forEach(l=>{n[l].forEach(p=>clearTimeout(p)),delete n[l]}),this},stopPendingTransitions(t,e="/"){const{_transitionIds:n={}}=this;let o=Object.keys(n);if(t){const l=t.split(e);o=o.filter(c=>ag(l,c.split(e).slice(0,l.length)))}o.forEach(l=>{const c=n[l];YC(c),delete n[l],this.trigger("transition:end",this,l)})},stopTransitions:function(t,e="/"){return this.stopScheduledTransitions(t,e),this.stopPendingTransitions(t,e),this},addTo:function(t,e){return t.addCell(this,e),this},findView:function(t){return t.findViewByModel(this)},isElement:function(){return!1},isLink:function(){return!1},startBatch:function(t,e){return this.graph&&this.graph.startBatch(t,Wi({},e,{cell:this})),this},stopBatch:function(t,e){return this.graph&&this.graph.stopBatch(t,Wi({},e,{cell:this})),this},getChangeFlag:function(t){var e=0;if(!t)return e;for(var n in t)!t.hasOwnProperty(n)||!this.hasChanged(n)||(e|=t[n]);return e},angle:function(){return 0},position:function(){return new Te(0,0)},getPointFromConnectedLink:function(){return new Te},getBBox:function(){return new ai(0,0,0,0)},getPointRotatedAroundCenter(t,e,n){const o=new Te(e,n);return t&&o.rotate(this.getBBox().center(),t),o},getAbsolutePointFromRelative(t,e){return this.getPointRotatedAroundCenter(-this.angle(),this.position().offset(t,e))},getRelativePointFromAbsolute(t,e){return this.getPointRotatedAroundCenter(this.angle(),t,e).difference(this.position())}},{getAttributeDefinition:function(t){var e=this.attributes,n=wk;return e&&e[t]||n[t]},define:function(t,e,n,o){n=Wi({defaults:mA({type:t},e,this.prototype.defaults)},n);var l=this.extend(n,o);return typeof joint<"u"&&mf(joint,"shapes")&&VC(joint.shapes,t,l,"."),l}}),RO=function(t,e,n){if(mu(n)){if(!$C[n])throw new Error('Unknown wrapper: "'+n+'"');n=$C[n]}if(!Jo(n))throw new Error("Wrapper must be a function.");Ur(e).forEach(function(o){t[o]=n(t[o])})},$C={cells:function(t){return function(){var e=Array.from(arguments),n=e.length,o=n>0&&e[0]||[],l=n>1&&e[n-1]||{};return Array.isArray(o)||(l instanceof Oh?o=e:o instanceof Oh&&(e.length>1&&e.pop(),o=e)),l instanceof Oh&&(l={}),t.call(this,o,l)}}},$s={TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",CENTER:"center"};function bk(t,e){const n=new ai(t);switch(e){case void 0:throw new Error("Position required");case $s.LEFT:case"leftMiddle":return n.leftMiddle();case $s.RIGHT:case"rightMiddle":return n.rightMiddle();case $s.TOP:case"topMiddle":return n.topMiddle();case $s.BOTTOM:case"bottomMiddle":return n.bottomMiddle();case $s.TOP_LEFT:case"topLeft":case"origin":return n.topLeft();case $s.TOP_RIGHT:case"topRight":return n.topRight();case $s.BOTTOM_LEFT:case"bottomLeft":return n.bottomLeft();case $s.BOTTOM_RIGHT:case"bottomRight":case"corner":return n.bottomRight();case $s.CENTER:return n.center();default:throw new Error(`Unknown position: ${e}`)}}function Ik(t,e,n){var o=t.toJSON();return o.angle=e||0,Eh({},n,o)}function ay(t,e,n,o){return t.map(function(l,c,p){var r=this.pointAt((c+.5)/p.length);return(l.dx||l.dy)&&r.offset(l.dx||0,l.dy||0),Ik(r.round(),0,gA(o,l))},Ap(e,n))}function Ck(t,e,n,o){var l=e.center(),c=e.width/e.height,p=e.topMiddle(),r=pu.fromRect(e);return t.map(function(w,M,N){var E=n+o(M,N.length),Z=p.clone().rotate(l,-E).scale(c,1,l),Y=w.compensateRotation?-r.tangentTheta(Z):0;return(w.dx||w.dy)&&Z.offset(w.dx||0,w.dy||0),w.dr&&Z.move(l,w.dr),Ik(Z.round(),Y,gA(e,w))})}function gA(t,e){let{x:n,y:o,angle:l}=e;return Gu(n)?n=parseFloat(n)/100*t.width:Lh(n)&&(n=Number(kh(n,t))),Gu(o)?o=parseFloat(o)/100*t.height:Lh(o)&&(o=Number(kh(o,t))),{x:n,y:o,angle:l}}function qC(t,e){const{x:n,y:o}=gA(t,e);return new Te(n||0,o||0)}const BO=function(t,e){return t.map(n=>{const o=qC(e,n).round().toJSON();return o.angle=n.angle||0,o})},FO=function(t,e,n){return n.fn(t,e,n)},jO=function(t,e,n){var o=qC(e,n.start||e.origin()),l=qC(e,n.end||e.corner());return ay(t,o,l,e)},UO=function(t,e,n){return ay(t,e.origin(),e.bottomLeft(),e)},GO=function(t,e,n){return ay(t,e.topRight(),e.corner(),e)},ZO=function(t,e,n){return ay(t,e.origin(),e.topRight(),e)},VO=function(t,e,n){return ay(t,e.bottomLeft(),e.corner(),e)},WO=function(t,e,n){var o=n.startAngle||0,l=n.step||360/t.length;return Ck(t,e,o,function(c){return c*l})},YO=function(t,e,n){var o=n.startAngle||0,l=n.step||20;return Ck(t,e,o,function(c,p){return(c+.5-p/2)*l})},XO=Object.freeze(Object.defineProperty({__proto__:null,absolute:BO,bottom:VO,ellipse:YO,ellipseSpread:WO,fn:FO,left:UO,line:jO,right:GO,top:ZO},Symbol.toStringTag,{value:"Module"}));function Td(t,e){return mA({},t,e,{x:0,y:0,angle:0,attrs:{".":{y:"0","text-anchor":"start"}}})}function Ak(t,e,n,o){o=Eh({},o,{offset:15});var l=e.center().theta(t),c=Tk(e),p,r,w,M,N=o.offset,E=0;l<c[1]||l>c[2]?(w=".3em",p=N,r=0,M="start"):l<c[0]?(w="0",p=0,r=-N,n?(E=-90,M="start"):M="middle"):l<c[3]?(w=".3em",p=-N,r=0,M="end"):(w=".6em",p=0,r=N,n?(E=90,M="start"):M="middle");var Z=Math.round;return Td({x:Z(p),y:Z(r),angle:E,attrs:{".":{y:w,"text-anchor":M}}})}function Tk(t){var e=t.center(),n=e.theta(t.origin()),o=e.theta(t.bottomLeft()),l=e.theta(t.corner()),c=e.theta(t.topRight());return[n,c,l,o]}function Sk(t,e,n,o){var l=e.center().theta(t);o=Eh({},o,{offset:15});var c,p,r,w,M=o.offset,N=0,E=Tk(e);l<E[1]||l>E[2]?(r=".3em",c=-M,p=0,w="end"):l<E[0]?(r=".6em",c=0,p=M,n?(N=90,w="start"):w="middle"):l<E[3]?(r=".3em",c=M,p=0,w="start"):(r="0em",c=0,p=-M,n?(N=-90,w="start"):w="middle");var Z=Math.round;return Td({x:Z(c),y:Z(p),angle:N,attrs:{".":{y:r,"text-anchor":w}}})}function Ek(t,e,n){n=Eh({},n,{offset:20});var o=ix(0,0),l=-t.theta(o),c=l,p=t.clone().move(o,n.offset).difference(t).round(),r=".3em",w;(l+90)%180===0?(w=e?"end":"middle",!e&&l===-270&&(r="0em")):l>-270&&l<-90?(w="start",c=l-180):w="end";var M=Math.round;return Td({x:M(p.x),y:M(p.y),angle:e?c:0,attrs:{".":{y:r,"text-anchor":w}}})}const HO=function(t,e,n){return Td(n,e)},$O=function(t,e,n){return Td(n,{x:-15,attrs:{".":{y:".3em","text-anchor":"end"}}})},qO=function(t,e,n){return Td(n,{x:15,attrs:{".":{y:".3em","text-anchor":"start"}}})},JO=function(t,e,n){return Td(n,{y:-15,attrs:{".":{"text-anchor":"middle"}}})},KO=function(t,e,n){return Td(n,{y:15,attrs:{".":{y:".6em","text-anchor":"middle"}}})},QO=function(t,e,n){return Ak(t,e,!0,n)},t5=function(t,e,n){return Ak(t,e,!1,n)},e5=function(t,e,n){return Sk(t,e,!0,n)},n5=function(t,e,n){return Sk(t,e,!1,n)},i5=function(t,e,n){return Ek(t.difference(e.center()),!1,n)},r5=function(t,e,n){return Ek(t.difference(e.center()),!0,n)},o5=Object.freeze(Object.defineProperty({__proto__:null,bottom:KO,inside:n5,insideOriented:e5,left:$O,manual:HO,outside:t5,outsideOriented:QO,radial:i5,radialOriented:r5,right:qO,top:JO},Symbol.toStringTag,{value:"Module"})),cl=Oh.extend({markup:['<path class="connection" stroke="black" d="M 0 0 0 0"/>','<path class="marker-source" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="marker-target" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="connection-wrap" d="M 0 0 0 0"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),doubleToolMarkup:void 0,vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaultLabel:void 0,labelMarkup:void 0,_builtins:{defaultLabel:{markup:[{tagName:"rect",selector:"rect"},{tagName:"text",selector:"text"}],attrs:{text:{fill:"#000000",fontSize:14,textAnchor:"middle",yAlignment:"middle",pointerEvents:"none"},rect:{ref:"text",fill:"#ffffff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}}},defaults:{type:"link",source:{},target:{}},isLink:function(){return!0},disconnect:function(t){return this.set({source:{x:0,y:0},target:{x:0,y:0}},t)},source:function(t,e,n){if(t===void 0)return Sh(this.get("source"));var o,l,c=t instanceof Oh;if(c)return o=Sh(e)||{},o.id=t.id,l=n,this.set("source",o,l);var p=!rl(t);return p?(o=Sh(e)||{},o.x=t.x,o.y=t.y,l=n,this.set("source",o,l)):(o=t,l=e,this.set("source",o,l))},target:function(t,e,n){if(t===void 0)return Sh(this.get("target"));var o,l,c=t instanceof Oh;if(c)return o=Sh(e)||{},o.id=t.id,l=n,this.set("target",o,l);var p=!rl(t);return p?(o=Sh(e)||{},o.x=t.x,o.y=t.y,l=n,this.set("target",o,l)):(o=t,l=e,this.set("target",o,l))},router:function(t,e,n){if(t===void 0){var o=this.get("router");return o?typeof o=="object"?Sh(o):o:this.get("manhattan")?{name:"orthogonal"}:null}var l=typeof t=="object"||typeof t=="function",c=l?t:{name:t,args:e},p=l?e:n;return this.set("router",c,p)},connector:function(t,e,n){if(t===void 0){var o=this.get("connector");return o?typeof o=="object"?Sh(o):o:this.get("smooth")?{name:"smooth"}:null}var l=typeof t=="object"||typeof t=="function",c=l?t:{name:t,args:e},p=l?e:n;return this.set("connector",c,p)},label:function(t,e,n){var o=this.labels();return t=isFinite(t)&&t!==null?t|0:0,t<0&&(t=o.length+t),arguments.length<=1?this.prop(["labels",t]):this.prop(["labels",t],e,n)},labels:function(t,e){return arguments.length===0?(t=this.get("labels"),Array.isArray(t)?t.slice():[]):(Array.isArray(t)||(t=[]),this.set("labels",t,e))},hasLabels:function(){const{labels:t}=this.attributes;return Array.isArray(t)&&t.length>0},insertLabel:function(t,e,n){if(!e)throw new Error("dia.Link: no label provided");var o=this.labels(),l=o.length;return t=isFinite(t)&&t!==null?t|0:l,t<0&&(t=l+t+1),o.splice(t,0,e),this.labels(o,n)},appendLabel:function(t,e){return this.insertLabel(-1,t,e)},removeLabel:function(t,e){var n=this.labels();return t=isFinite(t)&&t!==null?t|0:-1,n.splice(t,1),this.labels(n,e)},vertex:function(t,e,n){var o=this.vertices();if(t=isFinite(t)&&t!==null?t|0:0,t<0&&(t=o.length+t),arguments.length<=1)return this.prop(["vertices",t]);var l=this._normalizeVertex(e);return this.prop(["vertices",t],l,n)},vertices:function(t,e){if(arguments.length===0)return t=this.get("vertices"),Array.isArray(t)?t.slice():[];Array.isArray(t)||(t=[]);for(var n=[],o=0;o<t.length;o++){var l=t[o],c=this._normalizeVertex(l);n.push(c)}return this.set("vertices",n,e)},insertVertex:function(t,e,n){if(!e)throw new Error("dia.Link: no vertex provided");var o=this.vertices(),l=o.length;t=isFinite(t)&&t!==null?t|0:l,t<0&&(t=l+t+1);var c=this._normalizeVertex(e);return o.splice(t,0,c),this.vertices(o,n)},removeVertex:function(t,e){var n=this.vertices();return t=isFinite(t)&&t!==null?t|0:-1,n.splice(t,1),this.vertices(n,e)},_normalizeVertex:function(t){var e=!rl(t);return e?{x:t.x,y:t.y}:t},translate:function(t,e,n){return n=n||{},n.translateBy=n.translateBy||this.id,n.tx=t,n.ty=e,this.applyToPoints(function(o){return{x:(o.x||0)+t,y:(o.y||0)+e}},n)},scale:function(t,e,n,o){return this.applyToPoints(function(l){return Te(l).scale(t,e,n).toJSON()},o)},applyToPoints:function(t,e){if(!Jo(t))throw new TypeError("dia.Link: applyToPoints expects its first parameter to be a function.");var n={},{source:o,target:l}=this.attributes;o.id||(n.source=t(o)),l.id||(n.target=t(l));var c=this.vertices();return c.length>0&&(n.vertices=c.map(t)),this.set(n,e)},getSourcePoint:function(){var t=this.getSourceCell();return t?t.getPointFromConnectedLink(this,"source"):new Te(this.source())},getTargetPoint:function(){var t=this.getTargetCell();return t?t.getPointFromConnectedLink(this,"target"):new Te(this.target())},getPointFromConnectedLink:function(){return this.getPolyline().pointAt(.5)},getPolyline:function(){const t=[this.getSourcePoint(),...this.vertices().map(Te),this.getTargetPoint()];return new as(t)},getBBox:function(){return this.getPolyline().bbox()},reparent:function(t){var e;if(this.graph){var n=this.getSourceElement(),o=this.getTargetElement(),l=this.getParentCell();n&&o&&(n===o||n.isEmbeddedIn(o)?e=o:o.isEmbeddedIn(n)?e=n:e=this.graph.getCommonAncestor(n,o)),l&&(!e||e.id!==l.id)&&l.unembed(this,t),e&&e.embed(this,t)}return e},hasLoop:function(t){t=t||{};var{source:e,target:n}=this.attributes,o=e.id,l=n.id;if(!o||!l)return!1;var c=o===l;if(!c&&t.deep&&this.graph){var p=this.getSourceCell(),r=this.getTargetCell();c=p.isEmbeddedIn(r)||r.isEmbeddedIn(p)}return c},getSourceCell:function(){const{graph:t,attributes:e}=this;var n=e.source;return n&&n.id&&t&&t.getCell(n.id)||null},getSourceElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getSourceCell()}while(t&&t.isLink());return t},getTargetCell:function(){const{graph:t,attributes:e}=this;var n=e.target;return n&&n.id&&t&&t.getCell(n.id)||null},getTargetElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getTargetCell()}while(t&&t.isLink());return t},getRelationshipAncestor:function(){var t;if(this.graph){var e=[this,this.getSourceElement(),this.getTargetElement()].filter(function(n){return!!n});t=this.graph.getCommonAncestor.apply(this.graph,e)}return t||null},isRelationshipEmbeddedIn:function(t){var e=mu(t)||Du(t)?t:t.id,n=this.getRelationshipAncestor();return!!n&&(n.id===e||n.isEmbeddedIn(e))},_getDefaultLabel:function(){var t=this.get("defaultLabel")||this.defaultLabel||{},e={};return e.markup=t.markup||this.get("labelMarkup")||this.labelMarkup,e.position=t.position,e.attrs=t.attrs,e.size=t.size,e}},{endsEqual:function(t,e){var n=t.port===e.port||!t.port&&!e.port;return t.id===e.id&&n}});var Mk=function(t){var e=kc(t)||{};this.ports=[],this.groups={},this.portLayoutNamespace=XO,this.portLabelLayoutNamespace=o5,this._init(e)};Mk.prototype={getPorts:function(){return this.ports},getGroup:function(t){return this.groups[t]||{}},getPortsByGroup:function(t){return this.ports.filter(function(e){return e.group===t})},getGroupPortsMetrics:function(t,e){var n=this.getGroup(t),o=this.getPortsByGroup(t),l=n.position||{},c=l.name,p=this.portLayoutNamespace;p[c]||(c="left");var r=l.args||{},w=o.map(function(E){return E&&E.position&&E.position.args}),M=p[c](w,e,r),N={ports:o,result:[]};return Ur(M).reduce(function(E,Z,Y){var K=E.ports[Y];return E.result.push({portId:K.id,portTransformation:Z,labelTransformation:this._getPortLabelLayout(K,Te(Z),e),portAttrs:K.attrs,portSize:K.size,labelSize:K.label.size}),E}.bind(this),N),N.result},_getPortLabelLayout:function(t,e,n){var o=this.portLabelLayoutNamespace,l=t.label.position.name||"left";return o[l]?o[l](e,n,t.label.position.args):null},_init:function(t){if(As(t.groups))for(var e=Object.keys(t.groups),n=0,o=e.length;n<o;n++){var l=e[n];this.groups[l]=this._evaluateGroup(t.groups[l])}for(var c=Ur(t.items),p=0,r=c.length;p<r;p++)this.ports.push(this._evaluatePort(c[p]))},_evaluateGroup:function(t){return sl(t,{position:this._getPosition(t.position,!0),label:this._getLabel(t,!0)})},_evaluatePort:function(t){var e=Wi({},t),n=this.getGroup(t.group);return e.markup=e.markup||n.markup,e.attrs=sl({},n.attrs,e.attrs),e.position=this._createPositionNode(n,e),e.label=sl({},n.label,this._getLabel(e)),e.z=this._getZIndex(n,e),e.size=Wi({},n.size,e.size),e},_getZIndex:function(t,e){return Du(e.z)?e.z:Du(t.z)||t.z==="auto"?t.z:"auto"},_createPositionNode:function(t,e){return sl({name:"left",args:{}},t.position,{args:e.args})},_getPosition:function(t,e){var n={},o;Jo(t)?(o="fn",n.fn=t):mu(t)?o=t:t===void 0?o=e?"left":null:Array.isArray(t)?(o="absolute",n.x=t[0],n.y=t[1]):As(t)&&(o=t.name,Wi(n,t.args));var l={args:n};return o&&(l.name=o),l},_getLabel:function(t,e){var n=t.label||{},o=n;return o.position=this._getPosition(n.position,e),o}};const s5={_initializePorts:function(){this._createPortData(),this.on("change:ports",function(){this._processRemovedPort(),this._createPortData()},this)},_processRemovedPort:function(){var t=this.get("ports")||{},e={};Ur(t.items).forEach(function(r){e[r.id]=!0});var n=this.previous("ports")||{},o={};Ur(n.items).forEach(function(r){e[r.id]||(o[r.id]=!0)});var l=this.graph;if(l&&!ud(o)){var c=l.getConnectedLinks(this,{inbound:!0});c.forEach(function(r){o[r.get("target").port]&&r.remove()});var p=l.getConnectedLinks(this,{outbound:!0});p.forEach(function(r){o[r.get("source").port]&&r.remove()})}},hasPorts:function(){var t=this.prop("ports/items");return Array.isArray(t)&&t.length>0},hasPort:function(t){return this.getPortIndex(t)!==-1},getPorts:function(){return kc(this.prop("ports/items"))||[]},getGroupPorts:function(t){const e=Ur(this.prop(["ports","items"])).filter(n=>n.group===t);return kc(e)},getPort:function(t){return kc(Ur(this.prop("ports/items")).find(function(e){return e.id&&e.id===t}))},getPortsPositions:function(t){var e=this._portSettingsData.getGroupPortsMetrics(t,ai(this.size()));return e.reduce(function(n,o){var l=o.portTransformation;return n[o.portId]={x:l.x,y:l.y,angle:l.angle},n},{})},getPortIndex:function(t){var e=As(t)?t.id:t;return this._isValidPortId(e)?Ur(this.prop("ports/items")).findIndex(function(n){return n.id===e}):-1},addPort:function(t,e){if(!As(t)||Array.isArray(t))throw new Error("Element: addPort requires an object.");var n=Wi([],this.prop("ports/items"));return n.push(t),this.prop("ports/items",n,e),this},insertPort:function(t,e,n){const o=typeof t=="number"?t:this.getPortIndex(t);if(!As(e)||Array.isArray(e))throw new Error("dia.Element: insertPort requires an object.");const l=Wi([],this.prop("ports/items"));return l.splice(o,0,e),this.prop("ports/items",l,n),this},portProp:function(t,e,n,o){var l=this.getPortIndex(t);if(l===-1)throw new Error("Element: unable to find port with id "+t);var c=Array.prototype.slice.call(arguments,1);return Array.isArray(e)?c[0]=["ports","items",l].concat(e):mu(e)?c[0]=["ports/items/",l,"/",e].join(""):(c=["ports/items/"+l],rl(e)&&(c.push(e),c.push(n))),this.prop.apply(this,c)},_validatePorts:function(){var t=this.get("ports")||{},e=[];t=t||{};var n=Ur(t.items);return n.forEach(function(o){typeof o!="object"&&e.push("Element: invalid port ",o),this._isValidPortId(o.id)||(o.id=this.generatePortId())},this),Sg(n,"id").length!==n.length&&e.push("Element: found id duplicities in ports."),e},generatePortId:function(){return this.generateId()},_isValidPortId:function(t){return t!=null&&!As(t)},addPorts:function(t,e){return t.length&&this.prop("ports/items",Wi([],this.prop("ports/items")).concat(t),e),this},removePort:function(t,e){const n=e||{},o=this.getPortIndex(t);if(o!==-1){const l=Wi([],this.prop(["ports","items"]));l.splice(o,1),n.rewrite=!0,this.startBatch("port-remove"),this.prop(["ports","items"],l,n),this.stopBatch("port-remove")}return this},removePorts:function(t,e){let n,o;if(Array.isArray(t)){if(n=e||{},t.length===0)return this.this;o=Wi([],this.prop(["ports","items"])).filter(function(c){return!t.some(function(p){const r=As(p)?p.id:p;return c.id===r})})}else n=t||{},o=[];return this.startBatch("port-remove"),n.rewrite=!0,this.prop(["ports","items"],o,n),this.stopBatch("port-remove"),this},_createPortData:function(){var t=this._validatePorts();if(t.length>0)throw this.set("ports",this.previous("ports")),new Error(t.join(" "));var e;this._portSettingsData&&(e=this._portSettingsData.getPorts()),this._portSettingsData=new Mk(this.get("ports"));var n=this._portSettingsData.getPorts();if(e){var o=n.filter(function(c){if(!e.find(function(p){return p.id===c.id}))return c}),l=e.filter(function(c){if(!n.find(function(p){return p.id===c.id}))return c});l.length>0&&this.trigger("ports:remove",this,l),o.length>0&&this.trigger("ports:add",this,o)}}},a5={portContainerMarkup:"g",portMarkup:[{tagName:"circle",selector:"circle",attributes:{r:10,fill:"#FFFFFF",stroke:"#000000"}}],portLabelMarkup:[{tagName:"text",selector:"text",attributes:{fill:"#000000"}}],_portElementsCache:null,_initializePorts:function(){this._cleanPortsCache()},_refreshPorts:function(){this._removePorts(),this._cleanPortsCache(),this._renderPorts()},_cleanPortsCache:function(){this._portElementsCache={}},_renderPorts:function(){for(var t=[],e=this._getContainerElement(),n=0,o=e.node.childNodes.length;n<o;n++)t.push(e.node.childNodes[n]);var l=LO(this.model._portSettingsData.getPorts(),"z"),c="auto";Ur(l[c]).forEach(function(N){var E=this._getPortElement(N);e.append(E),t.push(E)},this);for(var p=Object.keys(l),r=0;r<p.length;r++){var w=p[r];if(w!==c){var M=parseInt(w,10);this._appendPorts(l[w],M,t)}}this._updatePorts()},_getContainerElement:function(){return this.rotatableNode||this.vel},_appendPorts:function(t,e,n){var o=this._getContainerElement(),l=Ur(t).map(this._getPortElement,this);n[e]||e<0?yn(n[Math.max(e,0)]).before(l):o.append(l)},_getPortElement:function(t){return this._portElementsCache[t.id]?this._portElementsCache[t.id].portElement:this._createPortElement(t)},findPortNode:function(t,e){const n=this._portElementsCache[t];if(!n)return null;if(!e)return n.portContentElement.node;const o=n.portElement.node,l=n.portSelectors,[c=null]=this.findBySelector(e,o,l);return c},_updatePorts:function(){this._updatePortGroup(void 0);var t=Object.keys(this.model._portSettingsData.groups);t.forEach(this._updatePortGroup,this)},_removePorts:function(){Ph(this._portElementsCache,"portElement.remove")},_createPortElement:function(t){let e,n,o,l;var c=yn(this.portContainerMarkup).addClass("joint-port"),p=this._getPortMarkup(t);if(Array.isArray(p)){var r=this.parseDOMJSON(p,c.node),w=r.fragment;w.childNodes.length>1?e=yn("g").append(w):e=yn(w.firstChild),l=r.selectors}else e=yn(p),Array.isArray(e)&&(e=yn("g").append(e));if(!e)throw new Error("ElementView: Invalid port markup.");e.attr({port:t.id,"port-group":t.group});const M=this._getPortLabelMarkup(t.label);if(Array.isArray(M)){const{fragment:K,selectors:q}=this.parseDOMJSON(M,c.node),at=K.childNodes.length;at>0&&(o=q,n=at===1?yn(K.firstChild):yn("g").append(K))}else n=yn(M),Array.isArray(n)&&(n=yn("g").append(n));var N;if(l&&o){for(var E in o)if(l[E]&&E!==this.selector)throw new Error("ElementView: selectors within port must be unique.");N=Wi({},l,o)}else N=l||o||{};const Z="portRoot";Z in N||(N[Z]=e.node);const Y="labelRoot";return n&&!(Y in N)&&(N[Y]=n.node),c.append(e.addClass("joint-port-body")),n&&c.append(n.addClass("joint-port-label")),this._portElementsCache[t.id]={portElement:c,portLabelElement:n,portSelectors:N,portLabelSelectors:o,portContentElement:e,portContentSelectors:l},c},_updatePortGroup:function(t){for(var e=ai(this.model.size()),n=this.model._portSettingsData.getGroupPortsMetrics(t,e),o=0,l=n.length;o<l;o++){var c=n[o],p=c.portId,r=this._portElementsCache[p]||{},w=c.portTransformation;this.applyPortTransform(r.portElement,w),this.updateDOMSubtreeAttributes(r.portElement.node,c.portAttrs,{rootBBox:new ai(c.portSize),selectors:r.portSelectors});var M=c.labelTransformation;M&&r.portLabelElement&&(this.applyPortTransform(r.portLabelElement,M,-w.angle||0),this.updateDOMSubtreeAttributes(r.portLabelElement.node,M.attrs,{rootBBox:new ai(c.labelSize),selectors:r.portLabelSelectors}))}},applyPortTransform:function(t,e,n){var o=yn.createSVGMatrix().rotate(n||0).translate(e.x||0,e.y||0).rotate(e.angle||0);t.transform(o,{absolute:!0})},_getPortMarkup:function(t){return t.markup||this.model.get("portMarkup")||this.model.portMarkup||this.portMarkup},_getPortLabelMarkup:function(t){return t.markup||this.model.get("portLabelMarkup")||this.model.portLabelMarkup||this.portLabelMarkup}},Fs=Oh.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts(),Oh.prototype.initialize.apply(this,arguments)},_initializePorts:function(){},_refreshPorts:function(){},isElement:function(){return!0},position:function(t,e,n){const o=Du(e);n=(o?n:t)||{};const{parentRelative:l,deep:c,restrictedArea:p}=n;let r;if(l){if(!this.graph)throw new Error("Element must be part of a graph.");const w=this.getParentCell();w&&!w.isLink()&&(r=w.get("position"))}if(o){if(r&&(t+=r.x,e+=r.y),c||p){const{x:w,y:M}=this.get("position");this.translate(t-w,e-M,n)}else this.set("position",{x:t,y:e},n);return this}else{const w=Te(this.get("position"));return l?w.difference(r):w}},translate:function(t,e,n){if(t=t||0,e=e||0,t===0&&e===0)return this;n=n||{},n.translateBy=n.translateBy||this.id;var o=this.get("position")||{x:0,y:0},l=n.restrictedArea;if(l&&n.translateBy===this.id)if(typeof l=="function"){var c=l.call(this,o.x+t,o.y+e,n);t=c.x-o.x,e=c.y-o.y}else{var p=this.getBBox({deep:!0}),r=o.x-p.x,w=o.y-p.y,M=Math.max(l.x+r,Math.min(l.x+l.width+r-p.width,o.x+t)),N=Math.max(l.y+w,Math.min(l.y+l.height+w-p.height,o.y+e));t=M-o.x,e=N-o.y}var E={x:o.x+t,y:o.y+e};return n.tx=t,n.ty=e,n.transition?(As(n.transition)||(n.transition={}),this.transition("position",E,Wi({},n.transition,{valueFunction:gk.object})),Ph(this.getEmbeddedCells(),"translate",t,e,n)):(this.startBatch("translate",n),this.set("position",E,n),Ph(this.getEmbeddedCells(),"translate",t,e,n),this.stopBatch("translate",n)),this},size:function(t,e,n){var o=this.get("size");return t===void 0?{width:o.width,height:o.height}:(As(t)&&(n=e,e=Du(t.height)?t.height:o.height,t=Du(t.width)?t.width:o.width),this.resize(t,e,n))},resize:function(t,e,n){if(n=n||{},this.startBatch("resize",n),n.direction){var o=this.get("size");switch(n.direction){case"left":case"right":e=o.height;break;case"top":case"bottom":t=o.width;break}var l=Rh(this.get("angle")||0),c=this.getBBox(),p;if(l){var r={"top-right":0,right:0,"top-left":1,top:1,"bottom-left":2,left:2,"bottom-right":3,bottom:3}[n.direction];n.absolute&&(r+=Math.floor((l+45)/90),r%=4);var w=c[["bottomLeft","corner","topRight","origin"][r]](),M=Te(w).rotate(c.center(),-l),N=Math.sqrt(t*t+e*e)/2,E=r*Math.PI/2;E+=Math.atan(r%2==0?e/t:t/e),E-=ju(l);var Z=Te.fromPolar(N,E,M);p=Te(Z).offset(t/-2,e/-2)}else switch(p=c.topLeft(),n.direction){case"top":case"top-right":p.offset(0,c.height-e);break;case"left":case"bottom-left":p.offset(c.width-t,0);break;case"top-left":p.offset(c.width-t,c.height-e);break}this.set("size",{width:t,height:e},n),this.position(p.x,p.y,n)}else this.set("size",{width:t,height:e},n);return this.stopBatch("resize",n),this},scale:function(t,e,n,o){var l=this.getBBox().scale(t,e,n);return this.startBatch("scale",o),this.position(l.x,l.y,o),this.resize(l.width,l.height,o),this.stopBatch("scale"),this},fitEmbeds:function(t={}){const{graph:e}=this;if(!e)throw new Error("Element must be part of a graph.");const n=this.getEmbeddedCells().filter(E=>E.isElement());if(n.length===0)return this;this.startBatch("fit-embeds",t),t.deep&&Ph(n,"fitEmbeds",t);const{left:o,right:l,top:c,bottom:p}=Dp(t.padding);let{x:r,y:w,width:M,height:N}=e.getCellsBBox(n);return r-=o,w-=c,M+=o+l,N+=p+c,this.set({position:{x:r,y:w},size:{width:M,height:N}},t),this.stopBatch("fit-embeds"),this},rotate:function(t,e,n,o){if(n){var l=this.getBBox().center(),c=this.get("size"),p=this.get("position");l.rotate(n,this.get("angle")-t);var r=l.x-c.width/2-p.x,w=l.y-c.height/2-p.y;this.startBatch("rotate",{angle:t,absolute:e,origin:n}),this.position(p.x+r,p.y+w,o),this.rotate(t,e,null,o),this.stopBatch("rotate")}else this.set("angle",e?t:(this.get("angle")+t)%360,o);return this},angle:function(){return Rh(this.get("angle")||0)},getBBox:function(t={}){const{graph:e,attributes:n}=this,{deep:o,rotate:l}=t;if(o&&e){const E=this.getEmbeddedCells({deep:!0,breadthFirst:!0});return E.push(this),e.getCellsBBox(E,t)}const{angle:c=0,position:{x:p,y:r},size:{width:w,height:M}}=n,N=new ai(p,r,w,M);return l&&N.rotateAroundCenter(c),N},getPointFromConnectedLink:function(t,e){var n=this.getBBox(),o=n.center(),l=t.get(e);if(!l)return o;var c=l.port;if(!c||!this.hasPort(c))return o;var p=this.portProp(c,["group"]),r=this.getPortsPositions(p),w=new Te(r[c]).offset(n.origin()),M=this.angle();return M&&w.rotate(o,-M),w}});Wi(Fs.prototype,s5);const l5=Yl.Collection.extend({initialize:function(t,e){e.cellNamespace?this.cellNamespace=e.cellNamespace:this.cellNamespace=typeof joint<"u"&&mf(joint,"shapes")?joint.shapes:null,this.graph=e.graph},model:function(t,e){var n=e.collection,o=n.cellNamespace,l=t.type==="link"?cl:Kv(o,t.type,".")||Fs,c=new l(t,e);return e.dry||(c.graph=n.graph),c},comparator:function(t){return t.get("z")||0}}),_A=Yl.Model.extend({initialize:function(t,e){e=e||{};var n=new l5([],{model:e.cellModel,cellNamespace:e.cellNamespace,graph:this});Yl.Model.prototype.set.call(this,"cells",n),n.on("all",this.trigger,this),this.on("change:z",this._sortOnChangeZ,this),this._out={},this._in={},this._nodes={},this._edges={},this._batches={},n.on("add",this._restructureOnAdd,this),n.on("remove",this._restructureOnRemove,this),n.on("reset",this._restructureOnReset,this),n.on("change:source",this._restructureOnChangeSource,this),n.on("change:target",this._restructureOnChangeTarget,this),n.on("remove",this._removeCell,this)},_sortOnChangeZ:function(){this.get("cells").sort()},_restructureOnAdd:function(t){if(t.isLink()){this._edges[t.id]=!0;var{source:e,target:n}=t.attributes;e.id&&((this._out[e.id]||(this._out[e.id]={}))[t.id]=!0),n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)}else this._nodes[t.id]=!0},_restructureOnRemove:function(t){if(t.isLink()){delete this._edges[t.id];var{source:e,target:n}=t.attributes;e.id&&this._out[e.id]&&this._out[e.id][t.id]&&delete this._out[e.id][t.id],n.id&&this._in[n.id]&&this._in[n.id][t.id]&&delete this._in[n.id][t.id]}else delete this._nodes[t.id]},_restructureOnReset:function(t){t=t.models,this._out={},this._in={},this._nodes={},this._edges={},t.forEach(this._restructureOnAdd,this)},_restructureOnChangeSource:function(t){var e=t.previous("source");e.id&&this._out[e.id]&&delete this._out[e.id][t.id];var n=t.attributes.source;n.id&&((this._out[n.id]||(this._out[n.id]={}))[t.id]=!0)},_restructureOnChangeTarget:function(t){var e=t.previous("target");e.id&&this._in[e.id]&&delete this._in[e.id][t.id];var n=t.get("target");n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)},getOutboundEdges:function(t){return this._out&&this._out[t]||{}},getInboundEdges:function(t){return this._in&&this._in[t]||{}},toJSON:function(){var t=Yl.Model.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(!t.cells)throw new Error("Graph JSON must contain cells array.");return this.set(t,e)},set:function(t,e,n){var o;return typeof t=="object"?(o=t,n=e):(o={})[t]=e,o.hasOwnProperty("cells")&&(this.resetCells(o.cells,n),o=Np(o,"cells")),Yl.Model.prototype.set.call(this,o,n)},clear:function(t){t=Wi({},t,{clear:!0});var e=this.get("cells");if(e.length===0)return this;this.startBatch("clear",t);var n=e.sortBy(function(o){return o.isLink()?1:2});do n.shift().remove(t);while(n.length>0);return this.stopBatch("clear"),this},_prepareCell:function(t,e){var n;if(t instanceof Yl.Model?(n=t.attributes,!t.graph&&(!e||!e.dry)&&(t.graph=this)):n=t,!mu(n.type))throw new TypeError("dia.Graph: cell type must be a string.");return t},minZIndex:function(){var t=this.get("cells").first();return t&&t.get("z")||0},maxZIndex:function(){var t=this.get("cells").last();return t&&t.get("z")||0},addCell:function(t,e){return Array.isArray(t)?this.addCells(t,e):(t instanceof Yl.Model?t.has("z")||t.set("z",this.maxZIndex()+1):t.z===void 0&&(t.z=this.maxZIndex()+1),this.get("cells").add(this._prepareCell(t,e),e||{}),this)},addCells:function(t,e){return t.length===0?this:(t=kO(t),e.maxPosition=e.position=t.length-1,this.startBatch("add",e),t.forEach(function(n){this.addCell(n,e),e.position--},this),this.stopBatch("add",e),this)},resetCells:function(t,e){var n=Ur(t).map(function(o){return this._prepareCell(o,e)},this);return this.get("cells").reset(n,e),this},removeCells:function(t,e){return t.length&&(this.startBatch("remove"),Ph(t,"remove",e),this.stopBatch("remove")),this},_removeCell:function(t,e,n){n=n||{},n.clear||(n.disconnectLinks?this.disconnectLinks(t,n):this.removeLinks(t,n)),this.get("cells").remove(t,{silent:!0}),t.graph===this&&(t.graph=null)},getCell:function(t){return this.get("cells").get(t)},getCells:function(){return this.get("cells").toArray()},getElements:function(){return this.get("cells").filter(t=>t.isElement())},getLinks:function(){return this.get("cells").filter(t=>t.isLink())},getFirstCell:function(){return this.get("cells").first()},getLastCell:function(){return this.get("cells").last()},getConnectedLinks:function(t,e){e=e||{};var n=e.indirect,o=e.inbound,l=e.outbound;o===void 0&&l===void 0&&(o=l=!0);var c=[],p={};l&&r(this,t),o&&w(this,t);function r(E,Z){if(ih(E.getOutboundEdges(Z.id),function(K,q){if(!p[q]){var at=E.getCell(q);c.push(at),p[q]=!0,n&&(o&&w(E,at),l&&r(E,at))}}.bind(E)),n&&Z.isLink()){var Y=Z.getTargetCell();Y&&Y.isLink()&&(p[Y.id]||(c.push(Y),r(E,Y)))}}function w(E,Z){if(ih(E.getInboundEdges(Z.id),function(K,q){if(!p[q]){var at=E.getCell(q);c.push(at),p[q]=!0,n&&(o&&w(E,at),l&&r(E,at))}}.bind(E)),n&&Z.isLink()){var Y=Z.getSourceCell();Y&&Y.isLink()&&(p[Y.id]||(c.push(Y),w(E,Y)))}}if(e.deep){var M=t.getEmbeddedCells({deep:!0}),N={};M.forEach(function(E){E.isElement()&&(N[E.id]=!0)}),M.forEach(function(E){E.isLink()||(l&&ih(this.getOutboundEdges(E.id),function(Z,Y){if(!p[Y]){var K=this.getCell(Y),{source:q,target:at}=K.attributes,J=q.id,Q=at.id;if(!e.includeEnclosed&&J&&N[J]&&Q&&N[Q])return;c.push(this.getCell(Y)),p[Y]=!0}}.bind(this)),o&&ih(this.getInboundEdges(E.id),function(Z,Y){if(!p[Y]){var K=this.getCell(Y),{source:q,target:at}=K.attributes,J=q.id,Q=at.id;if(!e.includeEnclosed&&J&&N[J]&&Q&&N[Q])return;c.push(this.getCell(Y)),p[Y]=!0}}.bind(this)))},this)}return c},getNeighbors:function(t,e){e||(e={});var n=e.inbound,o=e.outbound;n===void 0&&o===void 0&&(n=o=!0);var l=this.getConnectedLinks(t,e).reduce(function(r,w){var{source:M,target:N}=w.attributes,E=w.hasLoop(e);if(n&&mf(M,"id")&&!r[M.id]){var Z=this.getCell(M.id);Z.isElement()&&(E||Z&&Z!==t&&(!e.deep||!Z.isEmbeddedIn(t)))&&(r[M.id]=Z)}if(o&&mf(N,"id")&&!r[N.id]){var Y=this.getCell(N.id);Y.isElement()&&(E||Y&&Y!==t&&(!e.deep||!Y.isEmbeddedIn(t)))&&(r[N.id]=Y)}return r}.bind(this),{});if(t.isLink()){if(n){var c=t.getSourceCell();c&&c.isElement()&&!l[c.id]&&(l[c.id]=c)}if(o){var p=t.getTargetCell();p&&p.isElement()&&!l[p.id]&&(l[p.id]=p)}}return Ur(l)},getCommonAncestor:function(){var t=Array.from(arguments).map(function(n){for(var o=[],l=n.get("parent");l;)o.push(l),l=this.getCell(l).get("parent");return o},this);t=t.sort(function(n,o){return n.length-o.length});var e=Ur(t.shift()).find(function(n){return t.every(function(o){return o.includes(n)})});return this.getCell(e)},getSuccessors:function(t,e){e=e||{};var n=[];return this.search(t,function(o){o!==t&&n.push(o)},Wi({},e,{outbound:!0})),n},cloneCells:yk,cloneSubgraph:function(t,e){var n=this.getSubgraph(t,e);return this.cloneCells(n)},getSubgraph:function(t,e){e=e||{};var n=[],o={},l=[],c=[];return Ur(t).forEach(function(p){if(o[p.id]||(n.push(p),o[p.id]=p,p.isLink()?c.push(p):l.push(p)),e.deep){var r=p.getEmbeddedCells({deep:!0});r.forEach(function(w){o[w.id]||(n.push(w),o[w.id]=w,w.isLink()?c.push(w):l.push(w))})}}),c.forEach(function(p){var{source:r,target:w}=p.attributes;if(r.id&&!o[r.id]){var M=this.getCell(r.id);n.push(M),o[M.id]=M,l.push(M)}if(w.id&&!o[w.id]){var N=this.getCell(w.id);n.push(this.getCell(w.id)),o[N.id]=N,l.push(N)}},this),l.forEach(function(p){var r=this.getConnectedLinks(p,e);r.forEach(function(w){var{source:M,target:N}=w.attributes;!o[w.id]&&M.id&&o[M.id]&&N.id&&o[N.id]&&(n.push(w),o[w.id]=w)})},this),n},getPredecessors:function(t,e){e=e||{};var n=[];return this.search(t,function(o){o!==t&&n.push(o)},Wi({},e,{inbound:!0})),n},search:function(t,e,n){n=n||{},n.breadthFirst?this.bfs(t,e,n):this.dfs(t,e,n)},bfs:function(t,e,n={}){const o={},l={},c=[];for(c.push(t),l[t.id]=0;c.length>0;){var p=c.shift();if(o[p.id]||(o[p.id]=!0,e.call(this,p,l[p.id])===!1))continue;const r=this.getNeighbors(p,n);for(let w=0,M=r.length;w<M;w++){const N=r[w];l[N.id]=l[p.id]+1,c.push(N)}}},dfs:function(t,e,n={}){const o={},l={},c=[];for(c.push(t),l[t.id]=0;c.length>0;){const p=c.pop();if(o[p.id]||(o[p.id]=!0,e.call(this,p,l[p.id])===!1))continue;const r=this.getNeighbors(p,n),w=c.length;for(let M=0,N=r.length;M<N;M++){const E=r[M];l[E.id]=l[p.id]+1,c.splice(w,0,E)}}},getSources:function(){var t=[];return ih(this._nodes,function(e,n){(!this._in[n]||ud(this._in[n]))&&t.push(this.getCell(n))}.bind(this)),t},getSinks:function(){var t=[];return ih(this._nodes,function(e,n){(!this._out[n]||ud(this._out[n]))&&t.push(this.getCell(n))}.bind(this)),t},isSource:function(t){return!this._in[t.id]||ud(this._in[t.id])},isSink:function(t){return!this._out[t.id]||ud(this._out[t.id])},isSuccessor:function(t,e){var n=!1;return this.search(t,function(o){if(o===e&&o!==t)return n=!0,!1},{outbound:!0}),n},isPredecessor:function(t,e){var n=!1;return this.search(t,function(o){if(o===e&&o!==t)return n=!0,!1},{inbound:!0}),n},isNeighbor:function(t,e,n){n=n||{};var o=n.inbound,l=n.outbound;o===void 0&&l===void 0&&(o=l=!0);var c=!1;return this.getConnectedLinks(t,n).forEach(function(p){var{source:r,target:w}=p.attributes;if(o&&mf(r,"id")&&r.id===e.id||l&&mf(w,"id")&&w.id===e.id)return c=!0,!1}),c},disconnectLinks:function(t,e){this.getConnectedLinks(t).forEach(function(n){n.set(n.attributes.source.id===t.id?"source":"target",{x:0,y:0},e)})},removeLinks:function(t,e){Ph(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(t){return this.getElements().filter(e=>e.getBBox({rotate:!0}).containsPoint(t))},findModelsInArea:function(t,e={}){const n=new ai(t),{strict:o=!1}=e,l=o?"containsRect":"intersect";return this.getElements().filter(c=>n[l](c.getBBox({rotate:!0})))},findModelsUnderElement:function(t,e={}){const{searchBy:n="bbox"}=e,o=t.getBBox().rotateAroundCenter(t.angle());return(n==="bbox"?this.findModelsInArea(o):this.findModelsFromPoint(bk(o,n))).filter(c=>t.id!==c.id&&!c.isEmbeddedIn(t))},getBBox:function(){return this.getCellsBBox(this.getCells())},getCellsBBox:function(t,e={}){const{rotate:n=!0}=e;return Ur(t).reduce(function(o,l){const c=l.getBBox({rotate:n});return c?o?o.union(c):c:o},null)},translate:function(t,e,n){var o=this.getCells().filter(function(l){return!l.isEmbedded()});return Ph(o,"translate",t,e,n),this},resize:function(t,e,n){return this.resizeCells(t,e,this.getCells(),n)},resizeCells:function(t,e,n,o){var l=this.getCellsBBox(n);if(l){var c=Math.max(t/l.width,0),p=Math.max(e/l.height,0);Ph(n,"scale",c,p,l.origin(),o)}return this},startBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)+1,this.trigger("batch:start",Wi({},e,{batchName:t}))},stopBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)-1,this.trigger("batch:stop",Wi({},e,{batchName:t}))},hasActiveBatch:function(t){const e=this._batches;let n;return arguments.length===0?n=Object.keys(e):Array.isArray(t)?n=t:n=[t],n.some(o=>e[o]>0)}},{validations:{multiLinks:function(t,e){var{source:n,target:o}=e.attributes;if(n.id&&o.id){var l=e.getSourceCell();if(l){var c=t.getConnectedLinks(l,{outbound:!0}),p=c.filter(function(r){var{source:w,target:M}=r.attributes;return w&&w.id===n.id&&(!w.port||w.port===n.port)&&M&&M.id===o.id&&(!M.port||M.port===o.port)});if(p.length>1)return!1}}return!0},linkPinning:function(t,e){var{source:n,target:o}=e.attributes;return n.id&&o.id}}});RO(_A.prototype,["resetCells","addCells","removeCells"],$C.cells);const _p={},pg=Yl.View.extend({options:{},theme:null,themeClassNamePrefix:oh("theme-"),requireSetThemeOverride:!1,defaultTheme:Nc.defaultTheme,children:null,childNodes:null,DETACHABLE:!0,UPDATE_PRIORITY:2,FLAG_INSERT:1<<30,FLAG_REMOVE:1<<29,constructor:function(t){this.requireSetThemeOverride=t&&!!t.theme,this.options=Wi({},this.options,t),Yl.View.call(this,t)},initialize:function(){_p[this.cid]=this,this.setTheme(this.options.theme||this.defaultTheme),this.init()},unmount:function(){this.svgElement?this.vel.remove():this.$el.remove()},renderChildren:function(t){if(t||(t=ca(this,"children")),t){var e=this.svgElement,n=yn.namespace[e?"svg":"xhtml"],o=ax(t,n);(e?this.vel:this.$el).empty().append(o.fragment),this.childNodes=o.selectors}return this},findAttribute:function(t,e){for(var n=e;n&&n.nodeType===1;){var o=n.getAttribute(t);if(o)return o;if(n===this.el)return null;n=n.parentNode}return null},_ensureElement:function(){if(this.el)this.setElement(ca(this,"el"));else{var t=ca(this,"tagName"),e=Wi({},ca(this,"attributes")),n=Wi({},ca(this,"style"));this.id&&(e.id=ca(this,"id")),this.setElement(this._createElement(t)),this._setAttributes(e),this._setStyle(n)}this._ensureElClassName()},_setAttributes:function(t){this.svgElement?this.vel.attr(t):this.$el.attr(t)},_setStyle:function(t){this.$el.css(t)},_createElement:function(t){return this.svgElement?document.createElementNS(yn.namespace.svg,t):document.createElement(t)},_setElement:function(t){this.$el=t instanceof Yl.$?t:Yl.$(t),this.el=this.$el[0],this.svgElement&&(this.vel=yn(this.el))},_ensureElClassName:function(){var t=ca(this,"className");if(t){var e=oh(t);this.svgElement?this.vel.removeClass(t).addClass(e):this.$el.removeClass(t).addClass(e)}},init:function(){},onRender:function(){},confirmUpdate:function(){return 0},setTheme:function(t,e){return e=e||{},this.theme&&this.requireSetThemeOverride&&!e.override?this:(this.removeThemeClassName(),this.addThemeClassName(t),this.onSetTheme(this.theme,t),this.theme=t,this)},addThemeClassName:function(t){if(t=t||this.theme,!t)return this;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.addClass(e):this.$el.addClass(e),this},removeThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.removeClass(e):this.$el.removeClass(e),this},onSetTheme:function(t,e){},remove:function(){return this.onRemove(),this.undelegateDocumentEvents(),_p[this.cid]=null,Yl.View.prototype.remove.apply(this,arguments),this},onRemove:function(){},getEventNamespace:function(){return".joint-event-ns-"+this.cid},delegateElementEvents:function(t,e,n){if(!e)return this;n||(n={});var o=this.getEventNamespace();for(var l in e){var c=e[l];typeof c!="function"&&(c=this[c]),c&&lo(t).on(l+o,n,c.bind(this))}return this},undelegateElementEvents:function(t){return lo(t).off(this.getEventNamespace()),this},delegateDocumentEvents:function(t,e){return t||(t=ca(this,"documentEvents")),this.delegateElementEvents(document,t,e)},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document)},eventData:function(t,e){if(!t)throw new Error("eventData(): event object required.");var n=t.data,o="__"+this.cid+"__";return e===void 0?n?n[o]||{}:{}:(n||(n=t.data={}),n[o]||(n[o]={}),Wi(n[o],e),this)},stopPropagation:function(t){return this.eventData(t,{propagationStopped:!0}),this},isPropagationStopped:function(t){return!!this.eventData(t).propagationStopped}},{extend:function(){var t=Array.from(arguments),e=t[0]&&Wi({},t[0])||{},n=t[1]&&Wi({},t[1])||{},o=e.render||this.prototype&&this.prototype.render||null;return e.render=function(){return typeof o=="function"&&o.apply(this,arguments),this.render.__render__===o&&this.onRender(),this},e.render.__render__=o,Yl.View.extend.call(this,e,n)}}),PS="dbltap";if(lo.event&&!(PS in lo.event.special)){const t=Nc.doubleTapInterval,e=30;lo.event.special[PS]={bindType:"touchend",delegateType:"touchend",handle:function(n,...o){const{handleObj:l,target:c}=n,p=lo.data(c),r=new Date().getTime(),w="lastTouch"in p?r-p.lastTouch:0;w<t&&w>e?(p.lastTouch=null,n.type=l.origType,l.handler.call(this,n,...o)):p.lastTouch=r}}}const rh={CELLS:"cells",BACK:"back",FRONT:"front",TOOLS:"tools",LABELS:"labels"},u5=pg.extend({tagName:"g",svgElement:!0,pivotNodes:null,defaultTheme:null,options:{name:""},className:function(){return oh(`${this.options.name}-layer`)},init:function(){this.pivotNodes={}},insertSortedNode:function(t,e){this.el.insertBefore(t,this.insertPivot(e))},insertNode:function(t){const{el:e}=this;t.parentNode!==e&&e.appendChild(t)},insertPivot:function(t){const{el:e,pivotNodes:n}=this;t=+t,t||(t=0);let o=n[t];if(o)return o;o=n[t]=document.createComment("z-index:"+(t+1));let l=-1/0;for(let c in n)c=+c,c<t&&c>l&&(l=c,t-1);if(l!==-1/0){const c=n[l];e.insertBefore(o,c.nextSibling)}else e.insertBefore(o,e.firstChild);return o},removePivots:function(){const{el:t,pivotNodes:e}=this;for(let n in e)t.removeChild(e[n]);this.pivotNodes={}}});function MI(t){return t?Array.isArray(t)?t:[t]:[]}const _f=pg.extend({tagName:"g",svgElement:!0,className:"highlight",HIGHLIGHT_FLAG:1,UPDATE_PRIORITY:3,DETACHABLE:!1,UPDATABLE:!0,MOUNTABLE:!0,cellView:null,nodeSelector:null,node:null,updateRequested:!1,transformGroup:null,requestUpdate(t,e){const{paper:n}=t;this.cellView=t,this.nodeSelector=e,n&&(this.updateRequested=!0,n.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY))},confirmUpdate(){this.updateRequested=!1;const{cellView:t,nodeSelector:e}=this;return this.update(t,e),this.mount(),this.transform(),0},findNode(t,e=null){let n;if(typeof e=="string")[n]=t.findBySelector(e);else if(rl(e)){const o=t.model.isLink(),{label:l=null,port:c,selector:p}=e;o&&l!==null?n=t.findLabelNode(l,p):!o&&c?n=t.findPortNode(c,p):[n]=t.findBySelector(p)}else e&&(n=yn.toNode(e),n instanceof SVGElement||(n=null));return n||null},getNodeMatrix(t,e){const{options:n}=this,{layer:o}=n,{rotatableNode:l}=t,c=t.getNodeMatrix(e);return l?o?l.contains(e)?c:t.getRootRotateMatrix().inverse().multiply(c):t.getNodeRotateMatrix(e).multiply(c):c},mount(){const{MOUNTABLE:t,cellView:e,el:n,options:o,transformGroup:l}=this;if(!t||l)return;const{vel:c,paper:p}=e,{layer:r}=o;if(r){const w=this.transformGroup=yn("g").addClass("highlight-transform").append(n);p.getLayerView(r).insertSortedNode(w.node,o.z)}else(!n.parentNode||n.nextSibling)&&c.append(n)},unmount(){const{MOUNTABLE:t,transformGroup:e,vel:n}=this;t&&(e?(this.transformGroup=null,e.remove()):n.remove())},transform(){const{transformGroup:t,cellView:e,updateRequested:n}=this;if(!t||e.model.isLink()||n)return;const o=e.getRootTranslateMatrix(),l=e.getRootRotateMatrix(),c=o.multiply(l);t.attr("transform",yn.matrixToTransformString(c))},update(){const{node:t,cellView:e,nodeSelector:n,updateRequested:o,id:l}=this;if(o)return;const c=this.node=this.findNode(e,n);t&&this.unhighlight(e,t),c?(this.highlight(e,c),this.mount()):(this.unmount(),e.notify("cell:highlight:invalid",l,this))},onRemove(){const{node:t,cellView:e,id:n,constructor:o}=this;t&&this.unhighlight(e,t),this.unmount(),o._removeRef(e,n)},highlight(t,e){},unhighlight(t,e){},listenToUpdateAttributes(t){const e=ca(this,"UPDATE_ATTRIBUTES");!Array.isArray(e)||e.length===0||this.listenTo(t.model,"change",this.onCellAttributeChange)},onCellAttributeChange(){const{cellView:t}=this;if(!t)return;const{model:e,paper:n}=t;ca(this,"UPDATE_ATTRIBUTES").some(l=>e.hasChanged(l))&&n.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY)}},{_views:{},highlight:function(t,e,n){const o=this.uniqueId(e,n);this.add(t,e,o,n)},unhighlight:function(t,e,n){const o=this.uniqueId(e,n);this.remove(t,o)},get(t,e=null){const{cid:n}=t,{_views:o}=this,l=o[n];if(e===null){const c=[];if(!l)return c;for(let p in l){const r=l[p];r instanceof this&&c.push(r)}return c}else{if(!l)return null;if(e in l){const c=l[e];if(c instanceof this)return c}return null}},add(t,e,n,o={}){if(!n)throw new Error("dia.HighlighterView: An ID required.");const l=_f.get(t,n);l&&l.remove();const c=new this(o);return c.id=n,this._addRef(t,n,c),c.requestUpdate(t,e),c.listenToUpdateAttributes(t),c},_addRef(t,e,n){const{cid:o}=t,{_views:l}=this;let c=l[o];c||(c=l[o]={}),c[e]=n},_removeRef(t,e){const{cid:n}=t,{_views:o}=this,l=o[n];if(l){e&&delete l[e];for(let c in l)return;delete o[n]}},remove(t,e=null){MI(this.get(t,e)).forEach(n=>{n.remove()})},removeAll(t,e=null){const{_views:n}=this;for(let o in n)for(let l in n[o]){const c=n[o][l];c.cellView.paper===t&&c instanceof this&&(e===null||l===e)&&c.remove()}},update(t,e=null,n=!1){MI(this.get(t,e)).forEach(o=>{(n||o.UPDATABLE)&&o.update()})},transform(t,e=null){MI(this.get(t,e)).forEach(n=>{n.UPDATABLE&&n.transform()})},uniqueId(t,e=""){return yn.ensureId(t)+JSON.stringify(e)}}),Wm={DEFAULT:"default",EMBEDDING:"embedding",CONNECTING:"connecting",MAGNET_AVAILABILITY:"magnetAvailability",ELEMENT_AVAILABILITY:"elementAvailability"},no=pg.extend({tagName:"g",svgElement:!0,selector:"root",metrics:null,className:function(){var t=["cell"],e=this.model.get("type");return e&&e.toLowerCase().split(".").forEach(function(n,o,l){t.push("type-"+l.slice(0,o+1).join("-"))}),t.join(" ")},_presentationAttributes:null,_flags:null,setFlags:function(){var t={},e={},n=0,o,l,c,p=ca(this,"presentationAttributes");for(var r in p)if(p.hasOwnProperty(r)){var w=p[r];for(Array.isArray(w)||(w=[w]),o=0,l=w.length;o<l;o++){c=w[o];var M=t[c];M||(M=t[c]=1<<n++),e[r]|=M}}var N=ca(this,"initFlag");for(Array.isArray(N)||(N=[N]),o=0,l=N.length;o<l;o++)c=N[o],t[c]||(t[c]=1<<n++);if(n>25)throw new Error("dia.CellView: Maximum number of flags exceeded.");this._flags=t,this._presentationAttributes=e},hasFlag:function(t,e){return t&this.getFlag(e)},removeFlag:function(t,e){return t^t&this.getFlag(e)},getFlag:function(t){var e=this._flags;if(!e)return 0;var n=0;if(Array.isArray(t))for(var o=0,l=t.length;o<l;o++)n|=e[t[o]];else n|=e[t];return n},attributes:function(){var t=this.model;return{"model-id":t.id,"data-type":t.attributes.type}},constructor:function(t){t.id=t.id||sg(this),pg.call(this,t)},initialize:function(){this.setFlags(),pg.prototype.initialize.apply(this,arguments),this.cleanNodesCache(),this.$el.data("view",this),this.startListening()},onMount(){},startListening:function(){this.listenTo(this.model,"change",this.onAttributesChange)},onAttributesChange:function(t,e){var n=t.getChangeFlag(this._presentationAttributes);e.updateHandled||!n||(e.dirty&&this.hasFlag(n,"UPDATE")&&(n|=this.getFlag("RENDER")),e.tool&&(e.async=!1),this.requestUpdate(n,e))},requestUpdate:function(t,e){const{paper:n}=this;n&&t>0&&n.requestViewUpdate(this,t,this.UPDATE_PRIORITY,e)},parseDOMJSON:function(t,e){var n=ax(t),o=n.selectors,l=n.groupSelectors;for(var c in l){if(o[c])throw new Error("dia.CellView: ambiguous group selector");o[c]=l[c]}if(e){var p=this.selector;if(o[p])throw new Error("dia.CellView: ambiguous root selector.");o[p]=e}return{fragment:n.fragment,selectors:o}},can:function(t){var e=Jo(this.options.interactive)?this.options.interactive(this):this.options.interactive;return As(e)&&e[t]!==!1||NO(e)&&e!==!1},findBySelector:function(t,e,n){if(e||(e=this.el),n||(n=this.selectors),!t||t===".")return[e];if(n){var o=n[t];if(o)return Array.isArray(o)?o:[o]}return Nc.useCSSSelectors?lo(e).find(t).toArray():[]},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getBBox:function(t){var e;if(t&&t.useModelGeometry){var n=this.model;e=n.getBBox().bbox(n.angle())}else e=this.getNodeBBox(this.el);return this.paper.localToPaperRect(e)},getNodeBBox:function(t){const e=this.getNodeBoundingRect(t),n=this.getRootTranslateMatrix().multiply(this.getNodeRotateMatrix(t)),o=this.getNodeMatrix(t);return yn.transformRect(e,n.multiply(o))},getNodeRotateMatrix(t){return!this.rotatableNode||this.rotatableNode.contains(t)?this.getRootRotateMatrix():yn.createSVGMatrix()},getNodeUnrotatedBBox:function(t){var e=this.getNodeBoundingRect(t),n=this.getNodeMatrix(t),o=this.getRootTranslateMatrix();return yn.transformRect(e,o.multiply(n))},getRootTranslateMatrix:function(){var t=this.model,e=t.position(),n=yn.createSVGMatrix().translate(e.x,e.y);return n},getRootRotateMatrix:function(){var t=yn.createSVGMatrix(),e=this.model,n=e.angle();if(n){var o=e.getBBox(),l=o.width/2,c=o.height/2;t=t.translate(l,c).rotate(n).translate(-l,-c)}return t},_notifyHighlight:function(t,e,n={}){const{el:o}=this;let l;if(typeof e=="string"?[l=o]=this.findBySelector(e):[l=o]=this.$(e),n.partial=l!==o,n.type===void 0){let c;switch(!0){case n.embedding:c=Wm.EMBEDDING;break;case n.connecting:c=Wm.CONNECTING;break;case n.magnetAvailability:c=Wm.MAGNET_AVAILABILITY;break;case n.elementAvailability:c=Wm.ELEMENT_AVAILABILITY;break;default:c=Wm.DEFAULT;break}n.type=c}return this.notify(t,l,n),this},highlight:function(t,e){return this._notifyHighlight("cell:highlight",t,e)},unhighlight:function(t,e={}){return this._notifyHighlight("cell:unhighlight",t,e)},findMagnet:function(t){const e=this.el;let n=this.$(t)[0];n||(n=e);do{const o=n.getAttribute("magnet"),l=n===e;if((o||l)&&o!=="false")return n;if(l)return;n=n.parentNode}while(n)},findProxyNode:function(t,e){t||(t=this.el);const n=t.getAttribute(`${e}-selector`);if(n){const[o]=this.findBySelector(n);if(o)return o}return t},getSelector:function(t,e){var n;if(t===this.el)return typeof e=="string"&&(n="> "+e),n;if(t){var o=yn(t).index()+1;n=t.tagName+":nth-child("+o+")",e&&(n+=" > "+e),n=this.getSelector(t.parentNode,n)}return n},addLinkFromMagnet:function(t,e,n){var o=this.paper,l=o.model,c=o.getDefaultLink(this,t);return c.set({source:this.getLinkEnd(t,e,n,c,"source"),target:{x:e,y:n}}).addTo(l,{async:!1,ui:!0}),c.findView(o)},getLinkEnd:function(t,...e){var n=this.model,o=n.id,l=this.findAttribute("port",t),c=t.getAttribute("joint-selector"),p={id:o};return c!=null&&(p.magnet=c),l!=null?(p.port=l,!n.hasPort(l)&&!c&&(p.selector=this.getSelector(t))):c==null&&this.el!==t&&(p.selector=this.getSelector(t)),this.customizeLinkEnd(p,t,...e)},customizeLinkEnd:function(t,e,n,o,l,c){const{paper:p}=this,{connectionStrategy:r}=p.options;if(typeof r=="function"){var w=r.call(p,t,this,e,new Te(n,o),l,c,p);if(w)return w}return t},getMagnetFromLinkEnd:function(t){var e=this.el,n=t.port,o=t.magnet,l=this.model,c;return n!=null&&l.isElement()&&l.hasPort(n)?c=this.findPortNode(n,o)||e:(o||(o=t.selector),!o&&n!=null&&(o='[port="'+n+'"]'),c=this.findBySelector(o,e,this.selectors)[0]),this.findProxyNode(c,"magnet")},dragLinkStart:function(t,e,n,o){this.model.startBatch("add-link");const l=this.addLinkFromMagnet(e,n,o);l.notifyPointerdown(t,n,o),l.eventData(t,l.startArrowheadMove("target",{whenNotAllowed:"remove"})),this.eventData(t,{linkView:l})},dragLink:function(t,e,n){var o=this.eventData(t),l=o.linkView;if(l)l.pointermove(t,e,n);else{var c=this.paper,p=c.options.magnetThreshold,r=this.getEventTarget(t),w=o.targetMagnet;if(p==="onleave"){if(w===r||yn(w).contains(r))return}else if(c.eventData(t).mousemoved<=p)return;this.dragLinkStart(t,w,e,n)}},dragLinkEnd:function(t,e,n){var o=this.eventData(t),l=o.linkView;l&&(l.pointerup(t,e,n),this.model.stopBatch("add-link"))},getAttributeDefinition:function(t){return this.model.constructor.getAttributeDefinition(t)},setNodeAttributes:function(t,e){ud(e)||(t instanceof SVGElement?yn(t).attr(e):lo(t).attr(e))},processNodeAttributes:function(t,e){var n,o,l,c,p,r,w,M,N,E=[];for(n in e)e.hasOwnProperty(n)&&(o=e[n],l=this.getAttributeDefinition(n),l&&(!Jo(l.qualify)||l.qualify.call(this,o,t,e,this))?(mu(l.set)&&(r||(r={}),r[l.set]=o),o!==null&&E.push(n,l)):(r||(r={}),r[xO(n)]=o));for(c=0,p=E.length;c<p;c+=2)n=E[c],l=E[c+1],o=e[n],Jo(l.set)&&(w||(w={}),w[n]=o),Jo(l.position)&&(M||(M={}),M[n]=o),Jo(l.offset)&&(N||(N={}),N[n]=o);return{raw:e,normal:r,set:w,position:M,offset:N}},updateRelativeAttributes:function(t,e,n,o){o||(o={});var l,c,p,r=e.raw||{},w=e.normal||{},M=e.set,N=e.position,E=e.offset;for(l in M){c=M[l],p=this.getAttributeDefinition(l);var Z=p.set.call(this,c,n.clone(),t,r,this);As(Z)?Wi(w,Z):Z!==void 0&&(w[l]=Z)}if(t instanceof HTMLElement){this.setNodeAttributes(t,w);return}var Y=w.transform,K=yn.transformStringToMatrix(Y),q=Te(K.e,K.f);Y&&(w=Np(w,"transform"),K.e=K.f=0);var at,J,Q;if(N||E){var lt=this.getNodeScale(t,o.scalableNode);at=lt.sx,J=lt.sy}var Ct=!1;for(l in N)c=N[l],p=this.getAttributeDefinition(l),Q=p.position.call(this,c,n.clone(),t,r,this),Q&&(q.offset(Te(Q).scale(at,J)),Ct||(Ct=!0));this.setNodeAttributes(t,w);var j=!1;if(E){var k=this.getNodeBoundingRect(t);if(k.width>0&&k.height>0){var rt=yn.transformRect(k,K).scale(1/at,1/J);for(l in E)c=E[l],p=this.getAttributeDefinition(l),Q=p.offset.call(this,c,rt,t,r,this),Q&&(q.offset(Te(Q).scale(at,J)),j||(j=!0))}}(Y!==void 0||Ct||j)&&(q.round(1),K.e=q.x,K.f=q.y,t.setAttribute("transform",yn.matrixToTransformString(K)))},getNodeScale:function(t,e){var n,o;if(e&&e.contains(t)){var l=e.scale();n=1/l.sx,o=1/l.sy}else n=1,o=1;return{sx:n,sy:o}},cleanNodesCache:function(){this.metrics={}},nodeCache:function(t){var e=this.metrics;if(!e)return{};var n=yn.ensureId(t),o=e[n];return o||(o=e[n]={}),o},getNodeData:function(t){var e=this.nodeCache(t);return e.data||(e.data={}),e.data},getNodeBoundingRect:function(t){var e=this.nodeCache(t);return e.boundingRect===void 0&&(e.boundingRect=yn(t).getBBox()),new ai(e.boundingRect)},getNodeMatrix:function(t){const e=this.nodeCache(t);if(e.magnetMatrix===void 0){const{rotatableNode:n,el:o}=this;let l;n&&n.contains(t)?l=n:l=o,e.magnetMatrix=yn(t).getTransformToElement(l)}return yn.createSVGMatrix(e.magnetMatrix)},getNodeShape:function(t){var e=this.nodeCache(t);return e.geometryShape===void 0&&(e.geometryShape=yn(t).toGeometryShape()),e.geometryShape.clone()},isNodeConnection:function(t){return this.model.isLink()&&(!t||t===this.el)},findNodesAttributes:function(t,e,n,o){var l,c,p,r,w={},M=[];for(var N in t)if(t.hasOwnProperty(N)&&(p=t[N],!!rl(p))){var E=n[N]=this.findBySelector(N,e,o);for(l=0,c=E.length;l<c;l++){var Z=E[l];r=yn.ensureId(Z);var Y=o&&o[N]===Z,K=w[r];if(K){K.array||(M.push(r),K.array=!0,K.attributes=[K.attributes],K.selectedLength=[K.selectedLength]);var q=K.attributes,at=K.selectedLength;if(Y)q.unshift(p),at.unshift(-1);else{var J=_k(at,c);q.splice(J,0,p),at.splice(J,0,c)}}else w[r]={attributes:p,selectedLength:Y?-1:c,node:Z,array:!1}}}for(l=0,c=M.length;l<c;l++)r=M[l],p=w[r],p.attributes=sl({},...p.attributes.reverse());return w},getEventTarget:function(t,e={}){const{target:n,type:o,clientX:l=0,clientY:c=0}=t;return e.fromPoint||o==="touchmove"||o==="touchend"?document.elementFromPoint(l,c):n},updateDOMSubtreeAttributes:function(t,e,n){n||(n={}),n.rootBBox||(n.rootBBox=ai()),n.selectors||(n.selectors=this.selectors);var o={},l={},c=[],p=[],r,w,M,N,E,Z=n.roAttributes,Y=this.findNodesAttributes(Z||e,t,o,n.selectors),K=Z?this.findNodesAttributes(e,t,o,n.selectors):Y;for(var q in Y)if(N=Y[q],M=N.attributes,w=N.node,E=this.processNodeAttributes(w,M),!E.set&&!E.position&&!E.offset)this.setNodeAttributes(w,E.normal);else{var at=K[q]&&K[q].attributes,J=at&&M.ref===void 0?at.ref:M.ref,Q;if(J){if(Q=(o[J]||this.findBySelector(J,t,n.selectors))[0],!Q)throw new Error('dia.CellView: "'+J+'" reference does not exist.')}else Q=null;if(r={node:w,refNode:Q,processedAttributes:E,allAttributes:at},Q){var lt=p.findIndex(function(te){return te.refNode===w});lt>-1?p.splice(lt,0,r):p.push(r)}else c.push(r)}c.push(...p);for(var Ct,j=0,k=c.length;j<k;j++){r=c[j],w=r.node,Q=r.refNode;var rt=yn(n.rotatableNode),yt=Q?yn.ensureId(Q):"",xt=!!rt&&!!Q&&rt.contains(Q),kt=l[yt];if(!kt){var de=xt?rt:t;kt=l[yt]=Q?yn(Q).getBBox({target:de}):n.rootBBox}Z?(E=this.processNodeAttributes(w,r.allAttributes),this.mergeProcessedAttributes(E,r.processedAttributes)):E=r.processedAttributes;var Et=kt;xt&&!rt.contains(w)&&(Ct||(Ct=yn.transformStringToMatrix(rt.attr("transform"))),Et=yn.transformRect(kt,Ct)),this.updateRelativeAttributes(w,E,Et,n)}},mergeProcessedAttributes:function(t,e){t.set||(t.set={}),t.position||(t.position={}),t.offset||(t.offset={}),Wi(t.set,e.set),Wi(t.position,e.position),Wi(t.offset,e.offset);var n=t.normal&&t.normal.transform;n!==void 0&&e.normal&&(e.normal.transform=n),t.normal=e.normal},onRemove:function(){this.removeTools(),this.removeHighlighters()},_toolsView:null,hasTools:function(t){var e=this._toolsView;return e?t?e.getName()===t:!0:!1},addTools:function(t){return this.removeTools(),t&&(this._toolsView=t,t.configure({relatedView:this}),t.listenTo(this.paper,"tools:event",this.onToolEvent.bind(this))),this},updateTools:function(t){var e=this._toolsView;return e&&e.update(t),this},removeTools:function(){var t=this._toolsView;return t&&(t.remove(),this._toolsView=null),this},hideTools:function(){var t=this._toolsView;return t&&t.hide(),this},showTools:function(){var t=this._toolsView;return t&&t.show(),this},onToolEvent:function(t){switch(t){case"remove":this.removeTools();break;case"hide":this.hideTools();break;case"show":this.showTools();break}},removeHighlighters:function(){_f.remove(this)},updateHighlighters:function(t=!1){_f.update(this,null,t)},transformHighlighters:function(){_f.transform(this)},pointerdblclick:function(t,e,n){this.notify("cell:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){this.notify("cell:pointerclick",t,e,n)},contextmenu:function(t,e,n){this.notify("cell:contextmenu",t,e,n)},pointerdown:function(t,e,n){const{model:o}=this,{graph:l}=o;l&&(o.startBatch("pointer"),this.eventData(t,{graph:l})),this.notify("cell:pointerdown",t,e,n)},pointermove:function(t,e,n){this.notify("cell:pointermove",t,e,n)},pointerup:function(t,e,n){const{graph:o}=this.eventData(t);this.notify("cell:pointerup",t,e,n),o&&o.stopBatch("pointer",{cell:this.model})},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)},mouseenter:function(t){this.notify("cell:mouseenter",t)},mouseleave:function(t){this.notify("cell:mouseleave",t)},mousewheel:function(t,e,n,o){this.notify("cell:mousewheel",t,e,n,o)},onevent:function(t,e,n,o){this.notify(e,t,n,o)},onmagnet:function(){},magnetpointerdblclick:function(){},magnetcontextmenu:function(){},checkMouseleave(t){const{paper:e}=this;e.isAsync()&&e.dumpView(this);const n=this.getEventTarget(t,{fromPoint:!0}),o=e.findView(n);o!==this&&(this.mouseleave(t),o&&o.mouseenter(t))},setInteractivity:function(t){this.options.interactive=t}},{Highlighting:Wm,addPresentationAttributes:function(t){return sl({},ca(this.prototype,"presentationAttributes"),t,function(e,n){if(!(!e||!n)&&(typeof e=="string"&&(e=[e]),typeof n=="string"&&(n=[n]),Array.isArray(e)&&Array.isArray(n)))return Sg(e.concat(n))})}}),eo={UPDATE:"UPDATE",TRANSLATE:"TRANSLATE",TOOLS:"TOOLS",RESIZE:"RESIZE",PORTS:"PORTS",ROTATE:"ROTATE",RENDER:"RENDER"},Ia=no.extend({_removePorts:function(){},_renderPorts:function(){},className:function(){var t=no.prototype.className.apply(this).split(" ");return t.push("element"),t.join(" ")},initialize:function(){no.prototype.initialize.apply(this,arguments),this._initializePorts()},presentationAttributes:{attrs:[eo.UPDATE],position:[eo.TRANSLATE,eo.TOOLS],size:[eo.RESIZE,eo.PORTS,eo.TOOLS],angle:[eo.ROTATE,eo.TOOLS],markup:[eo.RENDER],ports:[eo.PORTS]},initFlag:[eo.RENDER],UPDATE_PRIORITY:0,confirmUpdate:function(t,e){const{useCSSSelectors:n}=Nc;this.hasFlag(t,eo.PORTS)&&(this._removePorts(),this._cleanPortsCache());let o=!1;if(this.hasFlag(t,eo.RENDER))this.render(),this.updateTools(e),this.updateHighlighters(!0),o=!0,t=this.removeFlag(t,[eo.RENDER,eo.UPDATE,eo.RESIZE,eo.TRANSLATE,eo.ROTATE,eo.PORTS,eo.TOOLS]);else{let l=!1;this.hasFlag(t,eo.RESIZE)&&(this.resize(e),l=!0,t=this.removeFlag(t,[eo.RESIZE,eo.UPDATE])),this.hasFlag(t,eo.UPDATE)&&(this.update(this.model,null,e),t=this.removeFlag(t,eo.UPDATE),l=!0,n&&(t=this.removeFlag(t,eo.PORTS))),this.hasFlag(t,eo.TRANSLATE)&&(this.translate(),t=this.removeFlag(t,eo.TRANSLATE),o=!0),this.hasFlag(t,eo.ROTATE)&&(this.rotate(),t=this.removeFlag(t,eo.ROTATE),o=!0),this.hasFlag(t,eo.PORTS)&&(this._renderPorts(),l=!0,t=this.removeFlag(t,eo.PORTS)),l&&this.updateHighlighters(!1)}return o&&this.transformHighlighters(),this.hasFlag(t,eo.TOOLS)&&(this.updateTools(e),t=this.removeFlag(t,eo.TOOLS)),t},_initializePorts:function(){},update:function(t,e){this.cleanNodesCache();const{useCSSSelectors:n}=Nc;n&&this._removePorts();var o=this.model,l=o.attr();this.updateDOMSubtreeAttributes(this.el,l,{rootBBox:new ai(o.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,roAttributes:e===l?null:e}),n&&this._renderPorts()},rotatableSelector:"rotatable",scalableSelector:"scalable",scalableNode:null,rotatableNode:null,renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.ElementView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if(typeof e=="string")return this.renderStringMarkup(e);throw new Error("dia.ElementView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el),n=this.selectors=e.selectors;this.rotatableNode=yn(n[this.rotatableSelector])||null,this.scalableNode=yn(n[this.scalableSelector])||null,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=this.vel;e.append(yn(t)),this.rotatableNode=e.findOne(".rotatable"),this.scalableNode=e.findOne(".scalable");var n=this.selectors={};n[this.selector]=this.el},render:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransformation(),Nc.useCSSSelectors||this._renderPorts(),this},resize:function(t){if(this.scalableNode)return this.sgResize(t);this.model.attributes.angle&&this.rotate(),this.update()},translate:function(){if(this.rotatableNode)return this.rgTranslate();this.updateTransformation()},rotate:function(){if(this.rotatableNode){this.rgRotate(),this.update();return}this.updateTransformation()},updateTransformation:function(){var t=this.getTranslateString(),e=this.getRotateString();e&&(t+=" "+e),this.vel.attr("transform",t)},getTranslateString:function(){var t=this.model.attributes.position;return"translate("+t.x+","+t.y+")"},getRotateString:function(){var t=this.model.attributes,e=t.angle;if(!e)return null;var n=t.size;return"rotate("+e+","+n.width/2+","+n.height/2+")"},rgRotate:function(){this.rotatableNode.attr("transform",this.getRotateString())},rgTranslate:function(){this.vel.attr("transform",this.getTranslateString())},sgResize:function(t){var e=this.model,n=e.angle(),o=e.size(),l=this.scalableNode,c=!1;l.node.getElementsByTagName("path").length>0&&(c=!0);var p=l.getBBox({recursive:c}),r=o.width/(p.width||1),w=o.height/(p.height||1);l.attr("transform","scale("+r+","+w+")");var M=this.rotatableNode,N=M&&M.attr("transform");if(N){M.attr("transform",N+" rotate("+-n+","+o.width/2+","+o.height/2+")");var E=l.getBBox({target:this.paper.cells});e.set("position",{x:E.x,y:E.y},Wi({updateHandled:!0},t)),this.translate(),this.rotate()}this.update()},prepareEmbedding:function(t={}){const e=t.model||this.model,o=(t.paper||this.paper).model,l=t.initialZIndices={},c=e.getEmbeddedCells({deep:!0}),p=o.getConnectedLinks(e,{deep:!0,includeEnclosed:!0});[e,...c,...p].forEach(M=>l[M.id]=M.attributes.z),e.startBatch("to-front"),e.toFront({deep:!0,ui:!0});const r=o.getElements().reduce((M,N)=>Math.max(M,N.attributes.z||0),0);p.forEach(M=>{M.attributes.z<=r&&M.set("z",r+1,{ui:!0})}),e.stopBatch("to-front");const w=e.parent();w?(o.getCell(w).unembed(e,{ui:!0}),t.initialParentId=w):t.initialParentId=null},processEmbedding:function(t={},e,n,o){const l=t.model||this.model,c=t.paper||this.paper,p=c.model,{findParentBy:r,frontParentOnly:w,validateEmbedding:M}=c.options;let N;Jo(r)?N=Ur(r.call(p,this,e,n,o)):r==="pointer"?N=Ur(p.findModelsFromPoint({x:n,y:o})):N=p.findModelsUnderElement(l,{searchBy:r}),N=N.filter(Y=>Y instanceof Oh&&l.id!==Y.id&&!Y.isEmbeddedIn(l)),w&&(N=N.slice(-1));let E=null;const Z=t.candidateEmbedView;for(let Y=N.length-1;Y>=0;Y--){const K=N[Y];if(Z&&Z.model.id==K.id){E=Z;break}else{const q=K.findView(c);if(!Jo(M)||M.call(c,this,q)){E=q;break}}}E&&E!=Z&&(this.clearEmbedding(t),t.candidateEmbedView=E.highlight(E.findProxyNode(null,"container"),{embedding:!0})),!E&&Z&&this.clearEmbedding(t)},clearEmbedding:function(t){t||(t={});var e=t.candidateEmbedView;e&&(e.unhighlight(e.findProxyNode(null,"container"),{embedding:!0}),t.candidateEmbedView=null)},finalizeEmbedding:function(t={}){const e=t.candidateEmbedView,n=t.model||this.model,o=t.paper||this.paper;if(e)e.model.embed(n,{ui:!0}),e.unhighlight(e.findProxyNode(null,"container"),{embedding:!0}),t.candidateEmbedView=null;else{const{validateUnembedding:l}=o.options,{initialParentId:c}=t;if(c&&typeof l=="function"&&!l.call(o,this)){this._disallowUnembed(t);return}}o.model.getConnectedLinks(n,{deep:!0}).forEach(l=>{l.reparent({ui:!0})})},_disallowUnembed:function(t){const{model:e,whenNotAllowed:n="revert"}=t,o=e||this.model,c=(t.paper||this.paper).model;switch(n){case"remove":{o.remove({ui:!0});break}case"revert":{const{initialParentId:p,initialPosition:r,initialZIndices:w}=t;if(r){const{x:N,y:E}=r;o.position(N,E,{deep:!0,ui:!0})}w&&Object.keys(w).forEach(N=>{const E=c.getCell(N);E&&E.set("z",w[N],{ui:!0})});const M=c.getCell(p);M&&M.embed(o,{ui:!0});break}}},getDelegatedView:function(){for(var t=this,e=t.model,n=t.paper;t&&!e.isLink();){if(!e.isEmbedded()||t.can("stopDelegation"))return t;e=e.getParentCell(),t=n.findViewByModel(e)}return null},findProxyNode:function(t,e){t||(t=this.el);const n=t.getAttribute(`${e}-selector`);if(n){const o=this.findAttribute("port",t);if(o){const l=this.findPortNode(o,n);if(l)return l}else{const[l]=this.findBySelector(n);if(l)return l}}return t},notifyPointerdown(t,e,n){no.prototype.pointerdown.call(this,t,e,n),this.notify("element:pointerdown",t,e,n)},notifyPointermove(t,e,n){no.prototype.pointermove.call(this,t,e,n),this.notify("element:pointermove",t,e,n)},notifyPointerup(t,e,n){this.notify("element:pointerup",t,e,n),no.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){no.prototype.pointerdblclick.apply(this,arguments),this.notify("element:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){no.prototype.pointerclick.apply(this,arguments),this.notify("element:pointerclick",t,e,n)},contextmenu:function(t,e,n){no.prototype.contextmenu.apply(this,arguments),this.notify("element:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.isPropagationStopped(t)||(this.notifyPointerdown(t,e,n),this.dragStart(t,e,n))},pointermove:function(t,e,n){var o=this.eventData(t);switch(o.action){case"magnet":this.dragMagnet(t,e,n);break;case"move":(o.delegatedView||this).drag(t,e,n);default:this.notifyPointermove(t,e,n);break}this.eventData(t,o)},pointerup:function(t,e,n){var o=this.eventData(t);switch(o.action){case"magnet":this.dragMagnetEnd(t,e,n);break;case"move":(o.delegatedView||this).dragEnd(t,e,n);default:this.notifyPointerup(t,e,n)}var l=o.targetMagnet;l&&this.magnetpointerclick(t,l,e,n),this.checkMouseleave(t)},mouseover:function(t){no.prototype.mouseover.apply(this,arguments),this.notify("element:mouseover",t)},mouseout:function(t){no.prototype.mouseout.apply(this,arguments),this.notify("element:mouseout",t)},mouseenter:function(t){no.prototype.mouseenter.apply(this,arguments),this.notify("element:mouseenter",t)},mouseleave:function(t){no.prototype.mouseleave.apply(this,arguments),this.notify("element:mouseleave",t)},mousewheel:function(t,e,n,o){no.prototype.mousewheel.apply(this,arguments),this.notify("element:mousewheel",t,e,n,o)},onmagnet:function(t,e,n){this.dragMagnetStart(t,e,n)},magnetpointerdblclick:function(t,e,n,o){this.notify("element:magnet:pointerdblclick",t,e,n,o)},magnetcontextmenu:function(t,e,n,o){this.notify("element:magnet:contextmenu",t,e,n,o)},dragStart:function(t,e,n){var o=this.getDelegatedView();if(!o||!o.can("elementMove"))return;this.eventData(t,{action:"move",delegatedView:o});const l=o.model.position();o.eventData(t,{initialPosition:l,pointerOffset:l.difference(e,n),restrictedArea:this.paper.getRestrictedArea(o,e,n)})},dragMagnetStart:function(t,e,n){if(this.can("addLinkFromMagnet")){var o=t.currentTarget,l=this.paper;this.eventData(t,{targetMagnet:o}),t.stopPropagation(),l.options.validateMagnet(this,o,t)?(l.options.magnetThreshold<=0&&this.dragLinkStart(t,o,e,n),this.eventData(t,{action:"magnet"}),this.stopPropagation(t)):this.pointerdown(t,e,n),l.delegateDragEvents(this,t.data)}},drag:function(t,e,n){var o=this.paper,l=o.options.gridSize,c=this.model,p=this.eventData(t),{pointerOffset:r,restrictedArea:w,embedding:M}=p,N=zp(e+r.x,l),E=zp(n+r.y,l);c.position(N,E,{restrictedArea:w,deep:!0,ui:!0}),o.options.embeddingMode&&(M||(this.prepareEmbedding(p),M=!0),this.processEmbedding(p,t,e,n)),this.eventData(t,{embedding:M})},dragMagnet:function(t,e,n){this.dragLink(t,e,n)},dragEnd:function(t,e,n){var o=this.eventData(t);o.embedding&&this.finalizeEmbedding(o)},dragMagnetEnd:function(t,e,n){this.dragLinkEnd(t,e,n)},magnetpointerclick:function(t,e,n,o){var l=this.paper;l.eventData(t).mousemoved>l.options.clickThreshold||this.notify("element:magnet:pointerclick",t,e,n,o)}},{Flags:eo});Wi(Ia.prototype,a5);const c5=function(t,e,n){return t},h5=function(t,e,n){var o=e.side||"bottom",l=Dp(e.padding||40),c=n.sourceBBox,p=n.targetBBox,r=c.center(),w=p.center(),M,N,E;switch(o){case"bottom":E=1,M="y",N="height";break;case"top":E=-1,M="y",N="height";break;case"left":E=-1,M="x",N="width";break;case"right":E=1,M="x",N="width";break;default:throw new Error("Router: invalid side")}return r[M]+=E*(c[N]/2+l[o]),w[M]+=E*(p[N]/2+l[o]),E*(r[M]-w[M])>0?w[M]=r[M]:r[M]=w[M],[r].concat(t,w)};var f5={N:"S",S:"N",E:"W",W:"E"},d5={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function ux(t,e,n){var o=new Te(t.x,e.y);return n.containsPoint(o)&&(o=new Te(e.x,t.y)),o}function JC(t,e){return t[e==="W"||e==="E"?"width":"height"]}function gu(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function s1(t){return new ai(t.x,t.y,0,0)}function cx(t){var e=Dp(t.padding||t.elementPadding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function Lk(t,e){return t.sourceBBox.clone().moveAndExpand(cx(e))}function kk(t,e){return t.targetBBox.clone().moveAndExpand(cx(e))}function p5(t,e){if(t.sourceAnchor)return t.sourceAnchor;var n=Lk(t,e);return n.center()}function m5(t,e){if(t.targetAnchor)return t.targetAnchor;var n=kk(t,e);return n.center()}function Pk(t,e,n){var o=new Te(t.x,e.y),l=new Te(e.x,t.y),c=gu(t,o),p=gu(t,l),r=f5[n],w=c===n||c!==r&&(p===r||p!==n)?o:l;return{points:[w],direction:gu(w,e)}}function I1(t,e,n){var o=ux(t,e,n);return{points:[o],direction:gu(o,e)}}function g5(t,e,n,o){var l={},c=[new Te(t.x,e.y),new Te(e.x,t.y)],p=c.filter(function(E){return!n.containsPoint(E)}),r=p.filter(function(E){return gu(E,t)!==o}),w;if(r.length>0)w=r.filter(function(E){return gu(t,E)===o}).pop(),w=w||r[0],l.points=[w],l.direction=gu(w,e);else{w=vk(c,p)[0];var M=new Te(e).move(w,-JC(n,o)/2),N=ux(M,t,n);l.points=[N,M],l.direction=gu(M,e)}return l}function _5(t,e,n,o){var l=I1(e,t,o),c=l.points[0];if(n.containsPoint(c)){l=I1(t,e,n);var p=l.points[0];if(o.containsPoint(p)){var r=new Te(t).move(p,-JC(n,gu(t,p))/2),w=new Te(e).move(c,-JC(o,gu(e,c))/2),M=new di(r,w).midpoint(),N=I1(t,M,n),E=Pk(M,e,N.direction);l.points=[N.points[0],E.points[0]],l.direction=E.direction}}return l}function LI(t,e,n,o,l){var c={},p=n.union(o).inflate(1),r=p.center().distance(e)>p.center().distance(t),w=r?e:t,M=r?t:e,N,E,Z;return l?(N=Te.fromPolar(p.width+p.height,d5[l],w),N=p.pointNearestToPoint(N).move(N,-1)):N=p.pointNearestToPoint(w).move(w,1),E=ux(N,M,p),N.round().equals(E.round())?(E=Te.fromPolar(p.width+p.height,ju(N.theta(w))+Math.PI/2,M),E=p.pointNearestToPoint(E).move(M,1).round(),Z=ux(N,E,p),c.points=r?[E,Z,N]:[N,Z,E]):c.points=r?[E,N]:[N,E],c.direction=gu(r?N:E,e),c}function KC(t,e,n){var o=Lk(n,e),l=kk(n,e),c=p5(n,e),p=m5(n,e);o=o.union(s1(c)),l=l.union(s1(p)),t=Ur(t).map(Te),t.unshift(c),t.push(p);for(var r,w=[],M=0,N=t.length-1;M<N;M++){var E=null,Z=t[M],Y=t[M+1],K=!!gu(Z,Y);if(M===0)M+1===N?o.intersect(l.clone().inflate(1))?E=LI(Z,Y,o,l):K||(E=_5(Z,Y,o,l)):o.containsPoint(Y)?E=LI(Z,Y,o,s1(Y).moveAndExpand(cx(e))):K||(E=I1(Z,Y,o));else if(M+1===N){var q=K&&gu(Y,Z)===r;l.containsPoint(Z)||q?E=LI(Z,Y,s1(Z).moveAndExpand(cx(e)),l,r):K||(E=g5(Z,Y,l,r))}else K||(E=Pk(Z,Y,r));E?(Array.prototype.push.apply(w,E.points),r=E.direction):r=gu(Z,Y),M+1<N&&w.push(Y)}return w}var zk={step:10,maximumLoops:2e3,precision:1,maxAllowedDirectionChange:90,perpendicular:!0,excludeEnds:[],excludeTypes:["basic.Text"],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return this.step},directions:function(){var t=this.step,e=this.cost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:-t,offsetY:0,cost:e},{offsetX:0,offsetY:t,cost:e},{offsetX:0,offsetY:-t,cost:e}]},penalties:function(){return{0:0,45:this.step/2,90:this.step/2}},paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},isPointObstacle:null,fallbackRouter:function(t,e,n){if(!Jo(KC))throw new Error("Manhattan requires the orthogonal router as default fallback.");return KC(t,Wi({},zk,e),n)},fallbackRoute:function(t,e,n){return null},draggingRoute:null};function vA(t){this.map={},this.options=t,this.mapGridSize=100}vA.prototype.build=function(t,e){var n=this.options,o=Ur(n.excludeEnds).reduce(function(w,M){var N=e.get(M);if(N){var E=t.getCell(N.id);E&&w.push(E)}return w},[]),l=[],c=t.getCell(e.get("source").id);c&&(l=HC(l,c.getAncestors().map(function(w){return w.id})));var p=t.getCell(e.get("target").id);p&&(l=HC(l,p.getAncestors().map(function(w){return w.id})));var r=this.mapGridSize;return t.getElements().reduce(function(w,M){var N=Ur(n.excludeTypes).includes(M.get("type")),E=o.find(function(Ct){return Ct.id===M.id}),Z=l.includes(M.id),Y=N||E||Z;if(!Y)for(var K=M.getBBox().moveAndExpand(n.paddingBox),q=K.origin().snapToGrid(r),at=K.corner().snapToGrid(r),J=q.x;J<=at.x;J+=r)for(var Q=q.y;Q<=at.y;Q+=r){var lt=J+"@"+Q;w[lt]=w[lt]||[],w[lt].push(K)}return w},this.map),this};vA.prototype.isPointAccessible=function(t){var e=t.clone().snapToGrid(this.mapGridSize).toString();return Ur(this.map[e]).every(function(n){return!n.containsPoint(t)})};function jp(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}jp.prototype.add=function(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=this.OPEN,this.values[t]=e;var n=_k(this.items,t,function(o){return this.values[o]}.bind(this));this.items.splice(n,0,t)};jp.prototype.remove=function(t){this.hash[t]=this.CLOSE};jp.prototype.isOpen=function(t){return this.hash[t]===this.OPEN};jp.prototype.isClose=function(t){return this.hash[t]===this.CLOSE};jp.prototype.isEmpty=function(){return this.items.length===0};jp.prototype.pop=function(){var t=this.items.shift();return this.remove(t),t};function Dk(t,e){return e&&e.paddingBox?t.sourceBBox.clone().moveAndExpand(e.paddingBox):t.sourceBBox.clone()}function Nk(t,e){return e&&e.paddingBox?t.targetBBox.clone().moveAndExpand(e.paddingBox):t.targetBBox.clone()}function Ok(t,e){if(t.sourceAnchor)return t.sourceAnchor;var n=Dk(t,e);return n.center()}function v5(t,e){if(t.targetAnchor)return t.targetAnchor;var n=Nk(t,e);return n.center()}function kI(t,e,n,o,l){var c=360/n,p=t.theta(y5(t,e,o,l)),r=Rh(p+c/2);return c*Math.floor(r/c)}function y5(t,e,n,o){var l=o.step,c=e.x-t.x,p=e.y-t.y,r=c/n.x,w=p/n.y,M=r*l,N=w*l;return new Te(t.x+M,t.y+N)}function zS(t,e){var n=Math.abs(t-e);return n>180?360-n:n}function x5(t,e,n){var o=n.step;Ur(n.directions).forEach(function(l){l.gridOffsetX=l.offsetX/o*e.x,l.gridOffsetY=l.offsetY/o*e.y})}function w5(t,e,n){return{source:e.clone(),x:DS(n.x-e.x,t),y:DS(n.y-e.y,t)}}function DS(t,e){if(!t)return e;var n=Math.abs(t),o=Math.round(n/e);if(!o)return n;var l=o*e,c=n-l,p=c/o;return e+p}function b5(t,e){var n=e.source,o=zp(t.x-n.x,e.x)+n.x,l=zp(t.y-n.y,e.y)+n.y;return new Te(o,l)}function vv(t,e){return t.round(e)}function C1(t,e,n){return vv(b5(t.clone(),e),n)}function Lv(t){return t.clone().toString()}function PI(t){return new Te(t.x===0?0:Math.abs(t.x)/t.x,t.y===0?0:Math.abs(t.y)/t.y)}function I5(t,e,n,o,l,c,p){for(var r=[],w=PI(l.difference(n)),M=Lv(n),N=t[M],E;N;){E=e[M];var Z=PI(E.difference(N));Z.equals(w)||(r.unshift(E),w=Z),M=Lv(N),N=t[M]}var Y=e[M],K=PI(Y.difference(o));return K.equals(w)||r.unshift(Y),r}function NS(t,e){for(var n=1/0,o=0,l=e.length;o<l;o++){var c=t.manhattanDistance(e[o]);c<n&&(n=c)}return n}function OS(t,e,n,o,l){var c=l.precision,p=l.directionMap,r=t.difference(e.center()),w=As(p)?Object.keys(p):[],M=Ur(n),N=w.reduce(function(E,Z){if(M.includes(Z)){for(var Y=p[Z],K=new Te(t.x+Y.x*(Math.abs(r.x)+e.width),t.y+Y.y*(Math.abs(r.y)+e.height)),q=new di(t,K),at=q.intersect(e)||[],J=at.length,Q,lt=null,Ct=0;Ct<J;Ct++){var j=at[Ct],k=t.squaredDistance(j);(Q===void 0||k>Q)&&(Q=k,lt=j)}if(lt){var rt=C1(lt,o,c);e.containsPoint(rt)&&(rt=C1(rt.offset(Y.x*o.x,Y.y*o.y),o,c)),E.push(rt)}}return E},[]);return e.containsPoint(t)||N.push(C1(t,o,c)),N}function C5(t,e,n,o){var l=o.precision,c,p;t instanceof ai?c=vv(Ok(this,o).clone(),l):c=vv(t.clone(),l),e instanceof ai?p=vv(v5(this,o).clone(),l):p=vv(e.clone(),l);var r=w5(o.step,c,p),w,M,N,E;if(t instanceof ai?(w=c,N=OS(w,t,o.startDirections,r,o)):(w=c,N=[w]),e instanceof ai?(M=p,E=OS(p,e,o.endDirections,r,o)):(M=p,E=[M]),N=N.filter(Pn=>!n(Pn)),E=E.filter(Pn=>!n(Pn)),N.length>0&&E.length>0){for(var Z=new jp,Y={},K={},q={},at=0,J=N.length;at<J;at++){var Q=N[at],lt=Lv(Q);Z.add(lt,NS(Q,E)),Y[lt]=Q,q[lt]=0}var Ct=o.previousDirectionAngle,j=Ct===void 0,k,rt,yt=o.directions;x5(yt,r,o);for(var xt=yt.length,kt=Ur(E).reduce(function(Pn,cn){var Un=Lv(cn);return Pn.push(Un),Pn},[]),de=o.maximumLoops;!Z.isEmpty()&&de>0;){var Et=Z.pop(),te=Y[Et],ht=K[Et],ie=q[Et],ln=ht===void 0,Le=te.equals(w),_e;ln?j?Le?_e=null:_e=kI(w,te,xt,r,o):_e=Ct:_e=kI(ht,te,xt,r,o);var Me=N.length===E.length;if(Me){for(var be=0;be<N.length;be++)if(!N[be].equals(E[be])){Me=!1;break}}var ue=ln&&Me;if(!ue&&kt.indexOf(Et)>=0)return o.previousDirectionAngle=_e,I5(K,Y,te,w,M);for(at=0;at<xt;at++){k=yt[at];var Yt=k.angle;if(rt=zS(_e,Yt),!(!(j&&Le)&&rt>o.maxAllowedDirectionChange)){var Ee=C1(te.clone().offset(k.gridOffsetX,k.gridOffsetY),r,l),ve=Lv(Ee);if(!(Z.isClose(ve)||n(Ee))){if(kt.indexOf(ve)>=0){var ye=Ee.equals(M);if(!ye){var fe=kI(Ee,M,xt,r,o),mn=zS(Yt,fe);if(mn>o.maxAllowedDirectionChange)continue}}var Ue=k.cost,Cn=Le?0:o.penalties[rt],Bn=ie+Ue+Cn;(!Z.isOpen(ve)||Bn<q[ve])&&(Y[ve]=Ee,K[ve]=te,q[ve]=Bn,Z.add(ve,Bn+NS(Ee,E)))}}}de--}}return o.fallbackRoute.call(this,w,M,o)}function A5(t){if(t.directions=ca(t,"directions"),t.penalties=ca(t,"penalties"),t.paddingBox=ca(t,"paddingBox"),t.padding=ca(t,"padding"),t.padding){var e=Dp(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}Ur(t.directions).forEach(function(n){var o=new Te(0,0),l=new Te(n.offsetX,n.offsetY);n.angle=Rh(o.theta(l))})}function T5(t,e,n){A5(e),n.options.perpendicular=!!e.perpendicular;var o=Dk(n,e),l=Nk(n,e),c=Ok(n,e);let p;if(typeof e.isPointObstacle=="function")p=e.isPointObstacle;else{const lt=new vA(e);lt.build(n.paper.model,n.model),p=Ct=>!lt.isPointAccessible(Ct)}for(var r=Ur(t).map(Te),w=[],M=c,N,E,Z=0,Y=r.length;Z<=Y;Z++){var K=null;if(E=N||o,N=r[Z],!N){N=l;var q=!n.model.get("source").id||!n.model.get("target").id;if(q&&Jo(e.draggingRoute)){var at=E===o?c:E,J=N.origin();K=e.draggingRoute.call(n,at,J,e)}}if(K=K||C5.call(n,E,N,p,e),K===null)return e.fallbackRouter(t,e,n);var Q=K[0];Q&&Q.equals(M)&&K.shift(),M=K[K.length-1]||M,Array.prototype.push.apply(w,K)}return w}const QC=function(t,e,n){return T5(t,Wi({},zk,e),n)};var S5={maxAllowedDirectionChange:45,diagonalCost:function(){var t=this.step;return Math.ceil(Math.sqrt(t*t<<1))},directions:function(){var t=this.step,e=this.cost(),n=this.diagonalCost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:t,offsetY:t,cost:n},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:t,cost:n},{offsetX:-t,offsetY:0,cost:e},{offsetX:-t,offsetY:-t,cost:n},{offsetX:0,offsetY:-t,cost:e},{offsetX:t,offsetY:-t,cost:n}]},fallbackRoute:function(t,e,n){var o=t.theta(e),l=[],c={x:e.x,y:t.y},p={x:t.x,y:e.y};if(o%180>90){var r=c;c=p,p=r}var w=o%90<45?c:p,M=new di(t,w),N=90*Math.ceil(o/90),E=Te.fromPolar(M.squaredLength(),ju(N+135),w),Z=new di(e,E),Y=M.intersection(Z),K=Y||e,q=Y?K:t,at=360/n.directions.length,J=q.theta(e),Q=Rh(J+at/2),lt=at*Math.floor(Q/at);return n.previousDirectionAngle=lt,K&&l.push(K.round()),l.push(e),l}};const E5=function(t,e,n){if(!Jo(QC))throw new Error("Metro requires the manhattan router.");return QC(t,Wi({},S5,e),n)},M5=Object.freeze(Object.defineProperty({__proto__:null,manhattan:QC,metro:E5,normal:c5,oneSide:h5,orthogonal:KC},Symbol.toStringTag,{value:"Module"}));var L5=5,RS=["arc","gap","cubic"],k5=0,BS=1,P5=["smooth"],a1=1/3,l1=2/3;function zI(t,e,n){var o=[].concat(t,n,e);return o.reduce(function(l,c,p){var r=o[p+1];return r!=null&&(l[p]=Ap(c,r)),l},[])}function z5(t){var e=t.paper,n=e._jumpOverUpdateList;if(n==null){n=e._jumpOverUpdateList=[];var o=e.model;o.on("batch:stop",function(){this.hasActiveBatch()||D5(e)}),o.on("reset",function(){n=e._jumpOverUpdateList=[]})}n.indexOf(t)<0&&(n.push(t),t.listenToOnce(t.model,"change:connector remove",function(){n.splice(n.indexOf(t),1)}))}function D5(t){for(var e=t._jumpOverUpdateList,n=0;n<e.length;n++){const o=e[n],l=o.getFlag(o.constructor.Flags.CONNECTOR);o.requestUpdate(l)}}function N5(t,e){return Ur(e).reduce(function(n,o){var l=t.intersection(o);return l&&n.push(l),n},[])}function FS(t,e){return Ap(t,e).squaredLength()}function O5(t,e,n){return e.reduce(function(o,l,c){if(l.skip===!0)return o;var p=o.pop()||t,r=ix(l).move(p.start,-n),w=ix(l).move(p.start,+n),M=e[c+1];if(M!=null){var N=w.distance(M);N<=n&&(w=M.move(p.start,N),M.skip=!0)}else{var E=r.distance(p.end);if(E<n*2+BS)return o.push(p),o}var Z=w.distance(p.start);if(Z<n*2+BS)return o.push(p),o;var Y=Ap(r,w);return Y.isJump=!0,o.push(Ap(p.start,r),Y,Ap(w,p.end)),o},[])}function jS(t,e,n,o){var l=new zi,c;return c=zi.createSegment("M",t[0].start),l.appendSegment(c),Ur(t).forEach(function(p,r){if(p.isJump){var w,M,N,E;if(n==="arc"){w=-90,M=p.start.difference(p.end);var Z=Number(M.x<0||M.x===0&&M.y<0);Z&&(w+=180);var Y=p.midpoint(),K=new di(Y,p.end).rotate(Y,w),q;q=new di(p.start,Y),N=q.pointAt(2/3).rotate(p.start,w),E=K.pointAt(1/3).rotate(K.end,-w),c=zi.createSegment("C",N,E,K.end),l.appendSegment(c),q=new di(Y,p.end),N=K.pointAt(1/3).rotate(K.end,w),E=q.pointAt(1/3).rotate(p.end,-w),c=zi.createSegment("C",N,E,p.end),l.appendSegment(c)}else if(n==="gap")c=zi.createSegment("M",p.end),l.appendSegment(c);else if(n==="cubic"){w=p.start.theta(p.end);var at=e*.6,J=e*1.35;M=p.start.difference(p.end),Z=Number(M.x<0||M.x===0&&M.y<0),Z&&(J*=-1),N=Te(p.start.x+at,p.start.y+J).rotate(p.start,w),E=Te(p.end.x-at,p.end.y+J).rotate(p.end,w),c=zi.createSegment("C",N,E,p.end),l.appendSegment(c)}}else{var Q=t[r+1];o==0||!Q||Q.isJump?(c=zi.createSegment("L",p.end),l.appendSegment(c)):R5(o,l,p.end,p.start,Q.end)}}),l}function R5(t,e,n,o,l){var c=n.distance(o)/2,p=n.distance(l)/2,r=-Math.min(t,c),w=-Math.min(t,p),M=n.clone().move(o,r).round(),N=n.clone().move(l,w).round(),E=new Te(a1*M.x+l1*n.x,l1*n.y+a1*M.y),Z=new Te(a1*N.x+l1*n.x,l1*n.y+a1*N.y),Y;Y=zi.createSegment("L",M),e.appendSegment(Y),Y=zi.createSegment("C",E,Z,N),e.appendSegment(Y)}const B5=function(t,e,n,o){z5(this);var l=o.raw,c=o.size||L5,p=o.jump&&(""+o.jump).toLowerCase(),r=o.radius||k5,w=o.ignoreConnectors||P5;RS.indexOf(p)===-1&&(p=RS[0]);var M=this.paper,N=M.model,E=N.getLinks();if(E.length===1)return jS(zI(t,e,n),c,p,r);var Z=this.model,Y=E.indexOf(Z),K=M.options.defaultConnector||{},q=E.filter(function(j,k){var rt=j.get("connector")||K;return Ur(w).includes(rt.name)?!1:k>Y?rt.name!=="jumpover":!0}),at=q.map(function(j){return M.findViewByModel(j)}),J=zI(t,e,n),Q=at.map(function(j){return j==null?[]:j===this?J:zI(j.sourcePoint,j.targetPoint,j.route)},this),lt=J.reduce(function(j,k){var rt=q.reduce(function(yt,xt,kt){if(xt!==Z){var de=N5(k,Q[kt]);yt.push.apply(yt,de)}return yt},[]).sort(function(yt,xt){return FS(k.start,yt)-FS(k.start,xt)});return rt.length>0?j.push.apply(j,O5(k,rt,c)):j.push(k),j},[]),Ct=jS(lt,c,p,r);return l?Ct:Ct.serialize()},F5=function(t,e,n,o){var l=o&&o.raw,c=[t].concat(n).concat([e]),p=new as(c),r=new zi(p);return l?r:r.serialize()},j5=function(t,e,n,o){o||(o={});var l=o.radius||10,c=o.raw,p=new zi,r;r=zi.createSegment("M",t),p.appendSegment(r);for(var w=1/3,M=2/3,N,E,Z,Y,K,q,at,J,Q,lt,Ct,j=0,k=n.length;j<k;j++)N=new Te(n[j]),E=n[j-1]||t,Z=n[j+1]||e,Y=K||N.distance(E)/2,K=N.distance(Z)/2,q=-Math.min(l,Y),at=-Math.min(l,K),J=N.clone().move(E,q).round(),Q=N.clone().move(Z,at).round(),lt=new Te(w*J.x+M*N.x,M*N.y+w*J.y),Ct=new Te(w*Q.x+M*N.x,M*N.y+w*Q.y),r=zi.createSegment("L",J),p.appendSegment(r),r=zi.createSegment("C",lt,Ct,Q),p.appendSegment(r);return r=zi.createSegment("L",e),p.appendSegment(r),c?p:p.serialize()},U5=function(t,e,n,o){var l=o&&o.raw,c;if(n&&n.length!==0){var p=[t].concat(n).concat([e]),r=Mo.throughPoints(p);c=new zi(r)}else{c=new zi;var w;if(w=zi.createSegment("M",t),c.appendSegment(w),Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)){var M=(t.x+e.x)/2;w=zi.createSegment("C",M,t.y,M,e.y,e.x,e.y),c.appendSegment(w)}else{var N=(t.y+e.y)/2;w=zi.createSegment("C",t.x,N,e.x,N,e.x,e.y),c.appendSegment(w)}}return l?c:c.serialize()},Pc={AUTO:"auto",HORIZONTAL:"horizontal",VERTICAL:"vertical",CLOSEST_POINT:"closest-point",OUTWARDS:"outwards"},du={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",AUTO:"auto",CLOSEST_POINT:"closest-point",OUTWARDS:"outwards"},yA=function(t,e,n=[],o={},l){const c=Boolean(o.raw),{direction:p=Pc.AUTO,precision:r=3}=o,w={coeff:o.distanceCoefficient||.6,angleTangentCoefficient:o.angleTangentCoefficient||80,tau:o.tension||.5,sourceTangent:o.sourceTangent?new Te(o.sourceTangent):null,targetTangent:o.targetTangent?new Te(o.targetTangent):null,rotate:Boolean(o.rotate)};typeof o.sourceDirection=="string"?w.sourceDirection=o.sourceDirection:typeof o.sourceDirection=="number"?w.sourceDirection=new Te(1,0).rotate(null,o.sourceDirection):w.sourceDirection=o.sourceDirection?new Te(o.sourceDirection).normalize():null,typeof o.targetDirection=="string"?w.targetDirection=o.targetDirection:typeof o.targetDirection=="number"?w.targetDirection=new Te(1,0).rotate(null,o.targetDirection):w.targetDirection=o.targetDirection?new Te(o.targetDirection).normalize():null;const M=[t,...n.map(q=>new Te(q)),e];let N;if(w.sourceTangent)N=w.sourceTangent;else{const q=Y5(l,M,p,w),at=M[0].distance(M[1])*w.coeff,J=M[1].difference(M[0]).normalize(),Q=t2(q,J);if(Q>Math.PI/4){const lt=at+(Q-Math.PI/4)*w.angleTangentCoefficient;N=q.clone().scale(lt,lt)}else N=q.clone().scale(at,at)}let E;if(w.targetTangent)E=w.targetTangent;else{const q=X5(l,M,p,w),at=M.length-1,J=M[at-1].distance(M[at])*w.coeff,Q=M[at-1].difference(M[at]).normalize(),lt=t2(q,Q);if(lt>Math.PI/4){const Ct=J+(lt-Math.PI/4)*w.angleTangentCoefficient;E=q.clone().scale(Ct,Ct)}else E=q.clone().scale(J,J)}const Y=$5(M,N,E,w).map(q=>q5(q,w)),K=new zi(Y).round(r);return c?K:K.serialize()};yA.Directions=Pc;yA.TangentDirections=du;function G5(t,e,n){const{sourceBBox:o}=t;let l,c;if(!t.sourceView)o.x>e[1].x?l="right":l="left";else if(c=t.sourceView.model.angle(),n.rotate&&c){const r=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),w=e[0].clone();w.rotate(o.center(),c),l=r.sideNearestToPoint(w)}else l=o.sideNearestToPoint(e[0]);let p;switch(l){case"left":p=new Te(-1,0);break;case"right":default:p=new Te(1,0);break}return n.rotate&&c&&p.rotate(null,-c),p}function Z5(t,e,n){const{targetBBox:o}=t;let l,c;if(!t.targetView)o.x>e[e.length-2].x?l="left":l="right";else if(c=t.targetView.model.angle(),n.rotate&&c){const r=t.targetView.getNodeUnrotatedBBox(t.targetView.el),w=e[e.length-1].clone();w.rotate(o.center(),c),l=r.sideNearestToPoint(w)}else l=o.sideNearestToPoint(e[e.length-1]);let p;switch(l){case"left":p=new Te(-1,0);break;case"right":default:p=new Te(1,0);break}return n.rotate&&c&&p.rotate(null,-c),p}function V5(t,e,n){const{sourceBBox:o}=t;let l,c;if(!t.sourceView)o.y>e[1].y?l="bottom":l="top";else if(c=t.sourceView.model.angle(),n.rotate&&c){const r=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),w=e[0].clone();w.rotate(o.center(),c),l=r.sideNearestToPoint(w)}else l=o.sideNearestToPoint(e[0]);let p;switch(l){case"top":p=new Te(0,-1);break;case"bottom":default:p=new Te(0,1);break}return n.rotate&&c&&p.rotate(null,-c),p}function W5(t,e,n){const{targetBBox:o}=t;let l,c;if(!t.targetView)o.y>e[e.length-2].y?l="top":l="bottom";else if(c=t.targetView.model.angle(),n.rotate&&c){const r=t.targetView.getNodeUnrotatedBBox(t.targetView.el),w=e[e.length-1].clone();w.rotate(o.center(),c),l=r.sideNearestToPoint(w)}else l=o.sideNearestToPoint(e[e.length-1]);let p;switch(l){case"top":p=new Te(0,-1);break;case"bottom":default:p=new Te(0,1);break}return n.rotate&&c&&p.rotate(null,-c),p}function US(t,e,n){const{sourceBBox:o}=t;let l,c;if(!t.sourceView)l=o.sideNearestToPoint(e[1]);else if(c=t.sourceView.model.angle(),n.rotate&&c){const r=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),w=e[0].clone();w.rotate(o.center(),c),l=r.sideNearestToPoint(w)}else l=o.sideNearestToPoint(e[0]);let p;switch(l){case"top":p=new Te(0,-1);break;case"bottom":p=new Te(0,1);break;case"right":p=new Te(1,0);break;case"left":p=new Te(-1,0);break}return n.rotate&&c&&p.rotate(null,-c),p}function GS(t,e,n){const{targetBBox:o}=t;let l,c;if(!t.targetView)l=o.sideNearestToPoint(e[e.length-2]);else if(c=t.targetView.model.angle(),n.rotate&&c){const r=t.targetView.getNodeUnrotatedBBox(t.targetView.el),w=e[e.length-1].clone();w.rotate(o.center(),c),l=r.sideNearestToPoint(w)}else l=o.sideNearestToPoint(e[e.length-1]);let p;switch(l){case"top":p=new Te(0,-1);break;case"bottom":p=new Te(0,1);break;case"right":p=new Te(1,0);break;case"left":p=new Te(-1,0);break}return n.rotate&&c&&p.rotate(null,-c),p}function ZS(t,e,n){return e[1].difference(e[0]).normalize()}function VS(t,e,n){const o=e.length-1;return e[o-1].difference(e[o]).normalize()}function WS(t,e,n){const{sourceBBox:o}=t,l=o.center();return e[0].difference(l).normalize()}function YS(t,e,n){const{targetBBox:o}=t,l=o.center();return e[e.length-1].difference(l).normalize()}function Y5(t,e,n,o){if(o.sourceDirection)switch(o.sourceDirection){case du.UP:return new Te(0,-1);case du.DOWN:return new Te(0,1);case du.LEFT:return new Te(-1,0);case du.RIGHT:return new Te(1,0);case du.AUTO:return US(t,e,o);case du.CLOSEST_POINT:return ZS(t,e);case du.OUTWARDS:return WS(t,e);default:return o.sourceDirection}switch(n){case Pc.HORIZONTAL:return G5(t,e,o);case Pc.VERTICAL:return V5(t,e,o);case Pc.CLOSEST_POINT:return ZS(t,e);case Pc.OUTWARDS:return WS(t,e);case Pc.AUTO:default:return US(t,e,o)}}function X5(t,e,n,o){if(o.targetDirection)switch(o.targetDirection){case du.UP:return new Te(0,-1);case du.DOWN:return new Te(0,1);case du.LEFT:return new Te(-1,0);case du.RIGHT:return new Te(0,1);case du.AUTO:return GS(t,e,o);case du.CLOSEST_POINT:return VS(t,e);case du.OUTWARDS:return YS(t,e);default:return o.targetDirection}switch(n){case Pc.HORIZONTAL:return Z5(t,e,o);case Pc.VERTICAL:return W5(t,e,o);case Pc.CLOSEST_POINT:return VS(t,e);case Pc.OUTWARDS:return YS(t,e);case Pc.AUTO:default:return GS(t,e,o)}}function H5(t,e){const n=Math.cos(e),o=Math.sin(e),l=n*t.x-o*t.y,c=o*t.x+n*t.y;t.x=l,t.y=c}function t2(t,e){let n=t.dot(e)/(t.magnitude()*e.magnitude());return n<-1&&(n=-1),n>1&&(n=1),Math.acos(n)}function XS(t,e){return t.x*e.y-t.y*e.x}function $5(t,e,n,o){const{tau:l,coeff:c}=o,p=[],r=[],w=[],M=t.length-1;for(let N=0;N<M;N++)p[N]=t[N].distance(t[N+1]);r[0]=e,r[M]=n;for(let N=1;N<M;N++){let E,Z;N===1?E=t[N-1].clone().offset(r[N-1].x,r[N-1].y):E=t[N-1].clone(),N===M-1?Z=t[N+1].clone().offset(r[N+1].x,r[N+1].y):Z=t[N+1].clone();const Y=E.difference(t[N]).normalize(),K=Z.difference(t[N]).normalize(),q=t2(Y,K);let at=(Math.PI-q)/2,J;const Q=XS(Y,K);let lt;lt=XS(t[N].difference(t[N+1]),t[N].difference(t[N-1])),Q<0&&(at=-at),q<Math.PI/2&&(at<0&&lt<0||at>0&&lt>0)&&(at=at-Math.PI),J=K.clone(),H5(J,at);const Ct=J.clone(),j=J.clone(),k=p[N-1]*c,rt=p[N]*c;Ct.scale(k,k),j.scale(rt,rt),r[N]=[Ct,j]}for(let N=0;N<M;N++){let E,Z;N===0?E=t[N+1].difference(r[N].x/l,r[N].y/l):E=t[N+1].difference(r[N][1].x/l,r[N][1].y/l),N===M-1?Z=t[N].clone().offset(r[N+1].x/l,r[N+1].y/l):Z=t[N].difference(r[N+1][0].x/l,r[N+1][0].y/l),w[N]=[E,t[N],t[N+1],Z]}return w}function q5(t,e){const{tau:n}=e,o=new Te;o.x=t[1].x+(t[2].x-t[0].x)/(6*n),o.y=t[1].y+(t[2].y-t[0].y)/(6*n);const l=new Te;return l.x=t[2].x+(t[3].x-t[1].x)/(6*n),l.y=t[2].y+(t[3].y-t[1].y)/(6*n),new Mo(t[1],o,l,t[2])}const J5=Object.freeze(Object.defineProperty({__proto__:null,curve:yA,jumpover:B5,normal:F5,rounded:j5,smooth:U5},Symbol.toStringTag,{value:"Module"})),lr={RENDER:"RENDER",UPDATE:"UPDATE",TOOLS:"TOOLS",LEGACY_TOOLS:"LEGACY_TOOLS",LABELS:"LABELS",VERTICES:"VERTICES",SOURCE:"SOURCE",TARGET:"TARGET",CONNECTOR:"CONNECTOR"},kv=no.extend({className:function(){var t=no.prototype.className.apply(this).split(" ");return t.push("link"),t.join(" ")},options:{shortLinkLength:105,doubleLinkTools:!1,longLinkLength:155,linkToolsOffset:40,doubleLinkToolsOffset:65,sampleInterval:50},_labelCache:null,_labelSelectors:null,_markerCache:null,_V:null,_dragData:null,metrics:null,decimalsRounding:2,initialize:function(){no.prototype.initialize.apply(this,arguments),this._labelCache={},this._labelSelectors={},this._markerCache={},this._V={},this.cleanNodesCache()},presentationAttributes:{markup:[lr.RENDER],attrs:[lr.UPDATE],router:[lr.UPDATE],connector:[lr.CONNECTOR],smooth:[lr.UPDATE],manhattan:[lr.UPDATE],toolMarkup:[lr.LEGACY_TOOLS],labels:[lr.LABELS],labelMarkup:[lr.LABELS],vertices:[lr.VERTICES,lr.UPDATE],vertexMarkup:[lr.VERTICES],source:[lr.SOURCE,lr.UPDATE],target:[lr.TARGET,lr.UPDATE]},initFlag:[lr.RENDER,lr.SOURCE,lr.TARGET,lr.TOOLS],UPDATE_PRIORITY:1,confirmUpdate:function(t,e){if(e||(e={}),this.hasFlag(t,lr.SOURCE)){if(!this.updateEndProperties("source"))return t;t=this.removeFlag(t,lr.SOURCE)}if(this.hasFlag(t,lr.TARGET)){if(!this.updateEndProperties("target"))return t;t=this.removeFlag(t,lr.TARGET)}const{paper:n,sourceView:o,targetView:l}=this;if(n&&(o&&!n.isViewMounted(o)||l&&!n.isViewMounted(l)))return t;if(this.hasFlag(t,lr.RENDER))return this.render(),this.updateHighlighters(!0),this.updateTools(e),t=this.removeFlag(t,[lr.RENDER,lr.UPDATE,lr.VERTICES,lr.LABELS,lr.TOOLS,lr.LEGACY_TOOLS,lr.CONNECTOR]),t;let c=!1;this.hasFlag(t,lr.VERTICES)&&(this.renderVertexMarkers(),t=this.removeFlag(t,lr.VERTICES));const{model:p}=this,{attributes:r}=p;let w=this.hasFlag(t,lr.LABELS),M=this.hasFlag(t,lr.LEGACY_TOOLS);w&&(this.onLabelsChange(p,r.labels,e),t=this.removeFlag(t,lr.LABELS),c=!0),M&&(this.renderTools(),t=this.removeFlag(t,lr.LEGACY_TOOLS));const N=this.hasFlag(t,lr.UPDATE),E=this.hasFlag(t,lr.CONNECTOR);return(N||E)&&(N?e.translateBy&&p.isRelationshipEmbeddedIn(e.translateBy)?this.translate(e.tx,e.ty):this.update():(this.updatePath(),this.updateDOM()),this.updateTools(e),t=this.removeFlag(t,[lr.UPDATE,lr.TOOLS,lr.CONNECTOR]),w=!1,M=!1,c=!0),w&&this.updateLabelPositions(),M&&this.updateToolsPosition(),c&&this.updateHighlighters(),this.hasFlag(t,lr.TOOLS)&&(this.updateTools(e),t=this.removeFlag(t,lr.TOOLS)),t},requestConnectionUpdate:function(t){this.requestUpdate(this.getFlag(lr.UPDATE),t)},isLabelsRenderRequired:function(t={}){const e=this.model.previous("labels");if(!e)return!0;if("propertyPathArray"in t&&"propertyValue"in t){var n=t.propertyPathArray||[],o=n.length;if(o>1){var l=!!e[n[1]];if(l){if(o===2)return"markup"in Object(t.propertyValue);if(n[2]!=="markup")return!1}}}return!0},onLabelsChange:function(t,e,n){this.isLabelsRenderRequired(n)?this.renderLabels():this.updateLabels()},render:function(){return this.vel.empty(),this.unmountLabels(),this._V={},this.renderMarkup(),this.renderLabels(),this.update(),this},renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.LinkView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if(typeof e=="string")return this.renderStringMarkup(e);throw new Error("dia.LinkView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el);this.selectors=e.selectors,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=yn(t);Array.isArray(e)||(e=[e]);for(var n=this._V,o=0,l=e.length;o<l;o++){var c=e[o],p=c.attr("class");p&&(p=vO(p),n[lo.camelCase(p)]=c)}this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),this.vel.append(e)},_getLabelMarkup:function(t){if(t){if(Array.isArray(t))return this.parseDOMJSON(t,null);if(typeof t=="string")return this._getLabelStringMarkup(t);throw new Error("dia.linkView: invalid label markup")}},_getLabelStringMarkup:function(t){var e=yn(t),n=document.createDocumentFragment();if(!Array.isArray(e))n.appendChild(e.node);else for(var o=0,l=e.length;o<l;o++){var c=e[o].node;n.appendChild(c)}return{fragment:n,selectors:{}}},_normalizeLabelMarkup:function(t){if(t){var e=t.fragment;if(!(t.fragment instanceof DocumentFragment)||!t.fragment.hasChildNodes())throw new Error("dia.LinkView: invalid label markup.");var n,o=e.childNodes;return o.length>1||o[0].nodeName.toUpperCase()!=="G"?n=yn("g").append(e):n=yn(o[0]),n.addClass("label"),{node:n.node,selectors:t.selectors}}},renderLabels:function(){var t=this._V,e=t.labels,n=this._labelCache={},o=this._labelSelectors={},l=this.model,c=l.attributes.labels||[],p=c.length;if(p===0)return e&&e.remove(),this;e?e.empty():(e=t.labels=yn("g").addClass("labels"),this.options.labelsLayer&&(e.addClass(oh(ca(this,"className"))),e.attr("model-id",l.id)));for(var r=0;r<p;r++){var w=c[r],M=this._normalizeLabelMarkup(this._getLabelMarkup(w.markup)),N,E;if(M)N=M.node,E=M.selectors;else{var Z=l._builtins.defaultLabel,Y=this._normalizeLabelMarkup(this._getLabelMarkup(Z.markup)),K=l._getDefaultLabel(),q=this._normalizeLabelMarkup(this._getLabelMarkup(K.markup)),at=q||Y;N=at.node,E=at.selectors}N.setAttribute("label-idx",r),e.append(N),n[r]=N;var J=this.selector;if(E[J])throw new Error("dia.LinkView: ambiguous label root selector.");E[J]=N,o[r]=E}return e.parent()||this.mountLabels(),this.updateLabels(),this},mountLabels:function(){const{el:t,paper:e,model:n,_V:o,options:l}=this,{labels:c}=o;if(!c||!n.hasLabels())return;const{node:p}=c;l.labelsLayer?e.getLayerView(l.labelsLayer).insertSortedNode(p,n.get("z")):p.parentNode!==t&&t.appendChild(p)},unmountLabels:function(){const{options:t,_V:e}=this;if(!e)return;const{labels:n}=e;n&&t.labelsLayer&&n.remove()},onMount:function(){this.mountLabels()},unmount:function(){no.prototype.unmount.apply(this,arguments),this.unmountLabels()},findLabelNode:function(t,e){const n=this._labelCache[t];if(!n)return null;const o=this._labelSelectors[t],[l=null]=this.findBySelector(e,n,o);return l},_mergeLabelAttrs:function(t,e,n,o){return e===null?null:e===void 0?n===null?null:n===void 0?t?void 0:o:t?n:sl({},o,n):t?sl({},n,e):sl({},o,n,e)},updateLabels:function(){if(!this._V.labels)return this;for(var t=this.model,e=t.get("labels")||[],n=this.can("labelMove"),o=t._builtins.defaultLabel,l=o.attrs,c=t._getDefaultLabel(),p=c.markup,r=c.attrs,w=0,M=e.length;w<M;w++){var N=this._labelCache[w];N.setAttribute("cursor",n?"move":"default");var E=this._labelSelectors[w],Z=e[w],Y=Z.markup,K=Z.attrs,q=this._mergeLabelAttrs(Y||p,K,r,l);this.updateDOMSubtreeAttributes(N,q,{rootBBox:new ai(Z.size),selectors:E})}return this},renderTools:function(){if(!this._V.linkTools)return this;var t=lo(this._V.linkTools.node).empty(),e=hu(this.model.get("toolMarkup")||this.model.toolMarkup),n=yn(e());if(t.append(n.node),this._toolCache=n,this.options.doubleLinkTools){var o;this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup?(e=hu(this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup),o=yn(e())):o=n.clone(),t.append(o.node),this._tool2Cache=o}return this},renderVertexMarkers:function(){if(!this._V.markerVertices)return this;var t=lo(this._V.markerVertices.node).empty(),e=hu(this.model.get("vertexMarkup")||this.model.vertexMarkup);return this.model.vertices().forEach(function(n,o){t.append(yn(e(Wi({idx:o},n))).node)}),this},renderArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;var t=lo(this._V.markerArrowheads.node);t.empty();var e=hu(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup);return this._V.sourceArrowhead=yn(e({end:"source"})),this._V.targetArrowhead=yn(e({end:"target"})),t.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node),this},removeRedundantLinearVertices:function(t){const n=this.model,o=n.vertices(),l=[this.sourceAnchor,...o,this.targetAnchor],c=l.length,p=new as(l);p.simplify({threshold:.001});const r=p.points.map(M=>M.toJSON()),w=r.length;return c===w?0:(n.vertices(r.slice(1,w-1),t),c-w)},updateDefaultConnectionPath:function(){var t=this._V;t.connection&&t.connection.attr("d",this.getSerializedConnection()),t.connectionWrap&&t.connectionWrap.attr("d",this.getSerializedConnection()),t.markerSource&&t.markerTarget&&this._translateAndAutoOrientArrows(t.markerSource,t.markerTarget)},getEndView:function(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("dia.LinkView: type parameter required.")}},getEndAnchor:function(t){switch(t){case"source":return new Te(this.sourceAnchor);case"target":return new Te(this.targetAnchor);default:throw new Error("dia.LinkView: type parameter required.")}},getEndConnectionPoint:function(t){switch(t){case"source":return new Te(this.sourcePoint);case"target":return new Te(this.targetPoint);default:throw new Error("dia.LinkView: type parameter required.")}},getEndMagnet:function(t){switch(t){case"source":var e=this.sourceView;if(!e)break;return this.sourceMagnet||e.el;case"target":var n=this.targetView;if(!n)break;return this.targetMagnet||n.el;default:throw new Error("dia.LinkView: type parameter required.")}},update:function(){return this.updateRoute(),this.updatePath(),this.updateDOM(),this},translate:function(t=0,e=0){const{route:n,path:o}=this;if(!n||!o)return;const l=new as(n);l.translate(t,e),this.route=l.points,this._translateConnectionPoints(t,e),o.translate(t,e),this.updateDOM()},updateDOM(){const{el:t,model:e,selectors:n}=this;this.cleanNodesCache(),this.updateDOMSubtreeAttributes(t,e.attr(),{selectors:n}),this.updateDefaultConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),this.options.perpendicular=null},updateRoute:function(){const{model:t}=this,e=t.vertices(),n=this.findAnchors(e),o=this.sourceAnchor=n.source,l=this.targetAnchor=n.target,c=this.findRoute(e);this.route=c;var p=this.findConnectionPoints(c,o,l);this.sourcePoint=p.source,this.targetPoint=p.target},updatePath:function(){const{route:t,sourcePoint:e,targetPoint:n}=this,o=this.findMarkerPoints(t,e,n),l=this.findPath(t,o.source||e,o.target||n);this.path=l},findMarkerPoints:function(t,e,n){var o=t[0],l=t[t.length-1],c=this._markerCache,p,r;return this._V.markerSource&&(c.sourceBBox=c.sourceBBox||this._V.markerSource.getBBox(),p=Te(e).move(o||n,c.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()),this._V.markerTarget&&(c.targetBBox=c.targetBBox||this._V.markerTarget.getBBox(),r=Te(n).move(l||e,c.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()),c.sourcePoint=p||e.clone(),c.targetPoint=r||n.clone(),{source:p,target:r}},findAnchorsOrdered:function(t,e,n,o){var l,c,p,r,w=this.model,M=w.get(t),N=w.get(n),E=this.getEndView(t),Z=this.getEndView(n),Y=this.getEndMagnet(t),K=this.getEndMagnet(n);E?(e?p=new Te(e):Z?p=K:p=new Te(N),l=this.getAnchor(M.anchor,E,Y,p,t)):l=new Te(M),Z?(r=new Te(o||l),c=this.getAnchor(N.anchor,Z,K,r,n)):c=new Te(N);var q={};return q[t]=l,q[n]=c,q},findAnchors:function(t){var e=this.model,n=t[0],o=t[t.length-1];return e.target().priority&&!e.source().priority?this.findAnchorsOrdered("target",o,"source",n):this.findAnchorsOrdered("source",n,"target",o)},findConnectionPoints:function(t,e,n){var o=t[0],l=t[t.length-1],c=this.model,p=c.get("source"),r=c.get("target"),w=this.sourceView,M=this.targetView,N=this.paper.options,E,Z,Y;if(w&&!w.isNodeConnection(this.sourceMagnet)){E=this.sourceMagnet||w.el;var K=p.connectionPoint||N.defaultConnectionPoint,q=o||n,at=new di(q,e);Y=this.getConnectionPoint(K,w,E,at,"source")}else Y=e;var J;if(M&&!M.isNodeConnection(this.targetMagnet)){Z=this.targetMagnet||M.el;var Q=r.connectionPoint||N.defaultConnectionPoint,lt=l||e,Ct=new di(lt,n);J=this.getConnectionPoint(Q,M,Z,Ct,"target")}else J=n;return{source:Y,target:J}},getAnchor:function(t,e,n,o,l){var c=e.isNodeConnection(n),p=this.paper.options;if(t||(c?t=p.defaultLinkAnchor:p.perpendicularLinks||this.options.perpendicular?t={name:"perpendicular"}:t=p.defaultAnchor),!t)throw new Error("Anchor required.");var r;if(typeof t=="function")r=t;else{var w=t.name,M=c?"linkAnchorNamespace":"anchorNamespace";if(r=p[M][w],typeof r!="function")throw new Error("Unknown anchor: "+w)}var N=r.call(this,e,n,o,t.args||{},l,this);return N?N.round(this.decimalsRounding):new Te},getConnectionPoint:function(t,e,n,o,l){var c,p=o.end,r=this.paper.options;if(typeof r.linkConnectionPoint=="function"){var w=n===e.el?void 0:n;if(c=r.linkConnectionPoint(this,e,w,o.start,l),c)return c}if(!t)return p;var M;if(typeof t=="function")M=t;else{var N=t.name;if(M=r.connectionPointNamespace[N],typeof M!="function")throw new Error("Unknown connection point: "+N)}return c=M.call(this,o,e,n,t.args||{},l,this),c?c.round(this.decimalsRounding):p},_translateConnectionPoints:function(t,e){var n=this._markerCache;n.sourcePoint.offset(t,e),n.targetPoint.offset(t,e),this.sourcePoint.offset(t,e),this.targetPoint.offset(t,e),this.sourceAnchor.offset(t,e),this.targetAnchor.offset(t,e)},_normalizeLabelPosition:function(t){return typeof t=="number"?{distance:t,offset:null,angle:0,args:null}:t},updateLabelPositions:function(){if(!this._V.labels)return this;var t=this.path;if(!t)return this;var e=this.model,n=e.get("labels")||[];if(!n.length)return this;for(var o=e._builtins.defaultLabel,l=o.position,c=e._getDefaultLabel(),p=this._normalizeLabelPosition(c.position),r=sl({},l,p),w=0,M=n.length;w<M;w++){var N=this._labelCache[w];if(N){var E=n[w],Z=this._normalizeLabelPosition(E.position),Y=sl({},r,Z),K=this._getLabelTransformationMatrix(Y);N.setAttribute("transform",yn.matrixToTransformString(K)),this._cleanLabelMatrices(w)}}return this},_cleanLabelMatrices:function(t){const{metrics:e,_labelSelectors:n}=this,o=n[t];if(o)for(let l in o){const{id:c}=o[l];c&&c in e&&delete e[c].magnetMatrix}},updateToolsPosition:function(){if(!this._V.linkTools)return this;var t="",e=this.options.linkToolsOffset,n=this.getConnectionLength();if(!Number.isNaN(n)){n<this.options.shortLinkLength&&(t="scale(.5)",e/=2);var o=this.getPointAtLength(e);if(this._toolCache.attr("transform","translate("+o.x+", "+o.y+") "+t),this.options.doubleLinkTools&&n>=this.options.longLinkLength){var l=this.options.doubleLinkToolsOffset||e;o=this.getPointAtLength(n-l),this._tool2Cache.attr("transform","translate("+o.x+", "+o.y+") "+t),this._tool2Cache.attr("visibility","visible")}else this.options.doubleLinkTools&&this._tool2Cache.attr("visibility","hidden")}return this},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;if(lo.css(this._V.markerArrowheads.node,"display")==="none")return this;var t=this.getConnectionLength()<this.options.shortLinkLength?.5:1;return this._V.sourceArrowhead.scale(t),this._V.targetArrowhead.scale(t),this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead),this},updateEndProperties:function(t){const{model:e,paper:n}=this,o=`${t}View`,l=e.get(t),c=l&&l.id;if(!c)return this[o]=null,this.updateEndMagnet(t),!0;const p=n.getModelById(c);if(!p)throw new Error("LinkView: invalid "+t+" cell.");const r=p.findView(n);return r?(this[o]=r,this.updateEndMagnet(t),!0):!1},updateEndMagnet:function(t){const e=`${t}Magnet`,n=this.getEndView(t);if(n){let o=n.getMagnetFromLinkEnd(this.model.get(t));o===n.el&&(o=null),this[e]=o}else this[e]=null},_translateAndAutoOrientArrows:function(t,e){var n=Ur(this.route);t&&t.translateAndAutoOrient(this.sourcePoint,n[0]||this.targetPoint,this.paper.cells),e&&e.translateAndAutoOrient(this.targetPoint,n[n.length-1]||this.sourcePoint,this.paper.cells)},_getLabelPositionAngle:function(t){var e=this.model.label(t).position||{};return e.angle||0},_getLabelPositionArgs:function(t){var e=this.model.label(t).position||{};return e.args},_getDefaultLabelPositionArgs:function(){var t=this.model._getDefaultLabel(),e=t.position||{};return e.args},_mergeLabelPositionArgs:function(t,e){return t===null?null:t===void 0?e===null?null:e:sl({},e,t)},addLabel:function(t,e,n,o){var l,c,p=0,r;typeof t!="number"?(l=t.x,c=t.y,typeof e=="number"?(p=e,r=n):r=e):(l=t,c=e,typeof n=="number"?(p=n,r=o):r=n);var w=this._getDefaultLabelPositionArgs(),M=r,N=this._mergeLabelPositionArgs(M,w),E={position:this.getLabelPosition(l,c,p,N)},Z=-1;return this.model.insertLabel(Z,E,r),Z},addVertex:function(t,e,n){var o=typeof t!="number",l=o?t.x:t,c=o?t.y:e,p=o?e:n,r={x:l,y:c},w=this.getVertexIndex(l,c);return this.model.insertVertex(w,r,p),w},sendToken:function(t,e,n){function o(E,Z){return function(){E.remove(),typeof Z=="function"&&Z()}}var l,c,p;As(e)?(l=e.duration,c=e.direction==="reverse",p=e.connection):(l=e,c=!1,p=null),l=l||1e3;var r={dur:l+"ms",repeatCount:1,calcMode:"linear",fill:"freeze"};c&&(r.keyPoints="1;0",r.keyTimes="0;1");var w=yn(t),M;if(typeof p=="string")M=this.findBySelector(p,this.el,this.selectors)[0];else{var N=this._V;M=N.connection?N.connection.node:this.el.querySelector("path")}if(!(M instanceof SVGPathElement))throw new Error("dia.LinkView: token animation requires a valid connection path.");w.appendTo(this.paper.cells).animateAlongPath(r,M),setTimeout(o(w,n),l)},findRoute:function(t){t||(t=[]);var e=this.paper.options.routerNamespace||M5,n=this.model.router(),o=this.paper.options.defaultRouter;if(!n)if(o)n=o;else return t.map(Te);var l=Jo(n)?n:e[n.name];if(!Jo(l))throw new Error('dia.LinkView: unknown router: "'+n.name+'".');var c=n.args||{},p=l.call(this,t,c,this);return p||t.map(Te)},findPath:function(t,e,n){var o=this.paper.options.connectorNamespace||J5,l=this.model.connector(),c=this.paper.options.defaultConnector;l||(l=c||{});var p=Jo(l)?l:o[l.name];if(!Jo(p))throw new Error('dia.LinkView: unknown connector: "'+l.name+'".');var r=Sh(l.args||{});r.raw=!0;var w=p.call(this,e,n,t,r,this);return typeof w=="string"&&(w=new zi(yn.normalizePathData(w))),w},getConnection:function(){var t=this.path;return t?t.clone():null},getSerializedConnection:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("data"))return e.data;var n=t.serialize();return e.data=n,n},getConnectionSubdivisions:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("segmentSubdivisions"))return e.segmentSubdivisions;var n=t.getSegmentSubdivisions();return e.segmentSubdivisions=n,n},getConnectionLength:function(){var t=this.path;if(!t)return 0;var e=this.metrics;if(e.hasOwnProperty("length"))return e.length;var n=t.length({segmentSubdivisions:this.getConnectionSubdivisions()});return e.length=n,n},getPointAtLength:function(t){var e=this.path;return e?e.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getPointAtRatio:function(t){var e=this.path;return e?(Gu(t)&&(t=parseFloat(t)/100),e.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})):null},getTangentAtLength:function(t){var e=this.path;return e?e.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getTangentAtRatio:function(t){var e=this.path;return e?e.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPoint:function(t){var e=this.path;return e?e.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointLength:function(t){var e=this.path;return e?e.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointRatio:function(t){var e=this.path;return e?e.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getLabelPosition:function(t,e,n,o){var l={},c=0,p;typeof n=="number"?(c=n,p=o):p=n,p&&(l.args=p);var r=!(p&&p.absoluteDistance),w=p&&p.absoluteDistance&&p.reverseDistance,M=p&&p.absoluteOffset,N=this.path,E={segmentSubdivisions:this.getConnectionSubdivisions()},Z=new Te(t,e),Y=N.closestPointT(Z,E),K=N.lengthAtT(Y,E);r&&(K=K/this.getConnectionLength()||0),w&&(K=-1*(this.getConnectionLength()-K)||1),l.distance=K;var q;M||(q=N.tangentAtT(Y));var at;if(q)at=q.pointOffset(Z);else{var J=N.pointAtT(Y),Q=Z.difference(J);at={x:Q.x,y:Q.y}}return l.offset=at,l.angle=c,l},_getLabelTransformationMatrix:function(t){var e,n=0,o={};if(typeof t=="number")e=t;else if(typeof t.distance=="number")o=t.args||{},e=t.distance,n=t.angle||0;else throw new Error("dia.LinkView: invalid label position distance.");var l=e>0&&e<=1,c=0,p={x:0,y:0};if(t.offset){var r=t.offset;typeof r=="number"&&(c=r),r.x&&(p.x=r.x),r.y&&(p.y=r.y)}var w=p.x!==0||p.y!==0||c===0,M=o.keepGradient,N=o.ensureLegibility,E=this.path,Z={segmentSubdivisions:this.getConnectionSubdivisions()},Y=l?e*this.getConnectionLength():e,K=E.tangentAtLength(Y,Z),q,at=n;if(K){if(w)q=K.start,q.offset(p);else{var J=K.clone();J.rotate(K.start,-90),J.setLength(c),q=J.end}M&&(at=K.angle()+n,N&&(at=Rh((at+90)%180-90)))}else q=E.start,w&&q.offset(p);return yn.createSVGMatrix().translate(q.x,q.y).rotate(at)},getLabelCoordinates:function(t){var e=this._getLabelTransformationMatrix(t);return new Te(e.e,e.f)},getVertexIndex:function(t,e){for(var n=this.model,o=n.vertices(),l=this.getClosestPointLength(new Te(t,e)),c=0,p=o.length;c<p;c++){var r=o[c],w=this.getClosestPointLength(r);if(l<w)break}return c},notifyPointerdown(t,e,n){no.prototype.pointerdown.call(this,t,e,n),this.notify("link:pointerdown",t,e,n)},notifyPointermove(t,e,n){no.prototype.pointermove.call(this,t,e,n),this.notify("link:pointermove",t,e,n)},notifyPointerup(t,e,n){this.notify("link:pointerup",t,e,n),no.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){no.prototype.pointerdblclick.apply(this,arguments),this.notify("link:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){no.prototype.pointerclick.apply(this,arguments),this.notify("link:pointerclick",t,e,n)},contextmenu:function(t,e,n){no.prototype.contextmenu.apply(this,arguments),this.notify("link:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.notifyPointerdown(t,e,n);var o=t.target.getAttribute("class");switch(o){case"marker-vertex":this.dragVertexStart(t,e,n);return;case"marker-vertex-remove":case"marker-vertex-remove-area":this.dragVertexRemoveStart(t,e,n);return;case"marker-arrowhead":this.dragArrowheadStart(t,e,n);return;case"connection":case"connection-wrap":this.dragConnectionStart(t,e,n);return;case"marker-source":case"marker-target":return}this.dragStart(t,e,n)},pointermove:function(t,e,n){var o=this._dragData;o&&this.eventData(t,o);var l=this.eventData(t);switch(l.action){case"vertex-move":this.dragVertex(t,e,n);break;case"label-move":this.dragLabel(t,e,n);break;case"arrowhead-move":this.dragArrowhead(t,e,n);break;case"move":this.drag(t,e,n);break}o&&Wi(o,this.eventData(t)),this.notifyPointermove(t,e,n)},pointerup:function(t,e,n){var o=this._dragData;o&&(this.eventData(t,o),this._dragData=null);var l=this.eventData(t);switch(l.action){case"vertex-move":this.dragVertexEnd(t,e,n);break;case"label-move":this.dragLabelEnd(t,e,n);break;case"arrowhead-move":this.dragArrowheadEnd(t,e,n);break;case"move":this.dragEnd(t,e,n)}this.notifyPointerup(t,e,n),this.checkMouseleave(t)},mouseover:function(t){no.prototype.mouseover.apply(this,arguments),this.notify("link:mouseover",t)},mouseout:function(t){no.prototype.mouseout.apply(this,arguments),this.notify("link:mouseout",t)},mouseenter:function(t){no.prototype.mouseenter.apply(this,arguments),this.notify("link:mouseenter",t)},mouseleave:function(t){no.prototype.mouseleave.apply(this,arguments),this.notify("link:mouseleave",t)},mousewheel:function(t,e,n,o){no.prototype.mousewheel.apply(this,arguments),this.notify("link:mousewheel",t,e,n,o)},onevent:function(t,e,n,o){var l=yn(t.target).findParentByClass("link-tool",this.el);if(l){if(t.stopPropagation(),this.can("useLinkTools"))if(e==="remove"){this.model.remove({ui:!0});return}else this.notify(e,t,n,o);this.notifyPointerdown(t,n,o),this.paper.delegateDragEvents(this,t.data)}else no.prototype.onevent.apply(this,arguments)},onlabel:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragLabelStart(t,e,n);var o=this.eventData(t).stopPropagation;o&&t.stopPropagation()},dragConnectionStart:function(t,e,n){if(this.can("vertexAdd")){var o=this.addVertex({x:e,y:n},{ui:!0});this.eventData(t,{action:"vertex-move",vertexIdx:o})}},dragLabelStart:function(t,e,n){if(this.can("labelMove")){var o=t.currentTarget,l=parseInt(o.getAttribute("label-idx"),10),c=this._getLabelPositionAngle(l),p=this._getLabelPositionArgs(l),r=this._getDefaultLabelPositionArgs(),w=this._mergeLabelPositionArgs(p,r);this.eventData(t,{action:"label-move",labelIdx:l,positionAngle:c,positionArgs:w,stopPropagation:!0})}else this.eventData(t,{stopPropagation:!0});this.paper.delegateDragEvents(this,t.data)},dragVertexStart:function(t,e,n){if(this.can("vertexMove")){var o=t.target,l=parseInt(o.getAttribute("idx"),10);this.eventData(t,{action:"vertex-move",vertexIdx:l})}},dragVertexRemoveStart:function(t,e,n){if(this.can("vertexRemove")){var o=t.target,l=parseInt(o.getAttribute("idx"),10);this.model.removeVertex(l)}},dragArrowheadStart:function(t,e,n){if(this.can("arrowheadMove")){var o=t.target,l=o.getAttribute("end"),c=this.startArrowheadMove(l,{ignoreBackwardsCompatibility:!0});this.eventData(t,c)}},dragStart:function(t,e,n){this.can("linkMove")&&this.eventData(t,{action:"move",dx:e,dy:n})},dragLabel:function(t,e,n){var o=this.eventData(t),l={position:this.getLabelPosition(e,n,o.positionAngle,o.positionArgs)};this.paper.options.snapLabels&&delete l.position.offset,this.model.label(o.labelIdx,l)},dragVertex:function(t,e,n){var o=this.eventData(t);this.model.vertex(o.vertexIdx,{x:e,y:n},{ui:!0})},dragArrowhead:function(t,e,n){this.paper.options.snapLinks?!this._snapArrowhead(t,e,n)&&this.paper.options.snapLinksSelf&&this._snapArrowheadSelf(t,e,n):this.paper.options.snapLinksSelf?this._snapArrowheadSelf(t,e,n):this._connectArrowhead(this.getEventTarget(t),e,n,this.eventData(t))},drag:function(t,e,n){var o=this.eventData(t);this.model.translate(e-o.dx,n-o.dy,{ui:!0}),this.eventData(t,{dx:e,dy:n})},dragLabelEnd:function(){},dragVertexEnd:function(){},dragArrowheadEnd:function(t,e,n){var o=this.eventData(t),l=this.paper;l.options.snapLinks?this._snapArrowheadEnd(o):this._connectArrowheadEnd(o,e,n),l.linkAllowed(this)?(this._finishEmbedding(o),this._notifyConnectEvent(o,t)):this._disallow(o),this._afterArrowheadMove(o)},dragEnd:function(){},_disallow:function(t){switch(t.whenNotAllowed){case"remove":this.model.remove({ui:!0});break;case"revert":default:this.model.set(t.arrowhead,t.initialEnd,{ui:!0});break}},_finishEmbedding:function(t){this.paper.options.embeddingMode&&this.model.reparent()&&(t.z=null)},_notifyConnectEvent:function(t,e){var n=t.arrowhead,o=t.initialEnd,l=this.model.prop(n),c=l&&!cl.endsEqual(o,l);if(c){var p=this.paper;o.id&&this.notify("link:disconnect",e,p.findViewByModel(o.id),t.initialMagnet,n),l.id&&this.notify("link:connect",e,p.findViewByModel(l.id),t.magnetUnderPointer,n)}},_snapToPoints:function(t,e,n){let o=null,l=1/0,c=null,p=1/0,r=t.x,w=t.y;for(let M=0;M<e.length;M++){const N=Math.abs(e[M].x-t.x);N<l&&(l=N,o=e[M]);const E=Math.abs(e[M].y-t.y);E<p&&(p=E,c=e[M])}return l<n&&(r=o.x),p<n&&(w=c.y),{x:r,y:w}},_snapArrowheadSelf:function(t,e,n){const{paper:o,model:l}=this,{snapLinksSelf:c}=o.options,p=this.eventData(t),r=c.radius||20,w=this.getEndAnchor(p.arrowhead==="source"?"target":"source"),M=l.vertices(),N=[w,...M],E=this._snapToPoints({x:e,y:n},N,r);this._connectArrowhead(document.elementFromPoint(E.x,E.y),E.x,E.y,this.eventData(t))},_snapArrowhead:function(t,e,n){const{paper:o}=this,{snapLinks:l,connectionStrategy:c}=o.options,p=this.eventData(t);let r=!1;var w=l.radius||50,M=o.findViewsInArea({x:e-w,y:n-w,width:2*w,height:2*w}),N=p.closestView||null,E=p.closestMagnet||null,Z=p.magnetProxy||null;p.closestView=p.closestMagnet=p.magnetProxy=null;var Y=Number.MAX_VALUE,K=new Te(e,n);M.forEach(function(j){const k=[];j.el.getAttribute("magnet")!=="false"&&k.push({bbox:j.model.getBBox(),magnet:j.el}),j.$("[magnet]").toArray().forEach(rt=>{k.push({bbox:j.getNodeBBox(rt),magnet:rt})}),k.forEach(rt=>{const{magnet:yt,bbox:xt}=rt,kt=xt.center().squaredDistance(K);kt<Y&&(E===yt||o.options.validateConnection.apply(o,p.validateConnectionArgs(j,j.el===yt?null:yt)))&&(Y=kt,p.closestView=j,p.closestMagnet=yt)})},this);var q,at=null,J=p.closestView,Q=p.closestMagnet;Q&&(at=p.magnetProxy=J.findProxyNode(Q,"highlighter"));var lt=p.arrowhead,Ct=E!==Q;if(N&&Ct&&N.unhighlight(Z,{connecting:!0,snapping:!0}),J){const{prevEnd:j,prevX:k,prevY:rt}=p;if(p.prevX=e,p.prevY=n,r=!0,!Ct&&(typeof c!="function"||k===e&&rt===n)||(q=J.getLinkEnd(Q,e,n,this.model,lt),!Ct&&ag(j,q)))return r;p.prevEnd=q,Ct&&J.highlight(at,{connecting:!0,snapping:!0})}else q={x:e,y:n};return this.model.set(lt,q||{x:e,y:n},{ui:!0}),N&&this.notify("link:snap:disconnect",t,N,E,lt),J&&this.notify("link:snap:connect",t,J,Q,lt),r},_snapArrowheadEnd:function(t){var e=t.closestView,n=t.closestMagnet;e&&n&&(e.unhighlight(t.magnetProxy,{connecting:!0,snapping:!0}),t.magnetUnderPointer=e.findMagnet(n)),t.closestView=t.closestMagnet=null},_connectArrowhead:function(t,e,n,o){const{paper:l,model:c}=this;if(o.eventTarget!==t){o.magnetProxy&&o.viewUnderPointer.unhighlight(o.magnetProxy,{connecting:!0});const p=o.viewUnderPointer=l.findView(t);if(p){const r=o.magnetUnderPointer=p.findMagnet(t),w=o.magnetProxy=p.findProxyNode(r,"highlighter");r&&this.paper.options.validateConnection.apply(l,o.validateConnectionArgs(p,r))?w&&p.highlight(w,{connecting:!0}):(o.magnetUnderPointer=null,o.magnetProxy=null)}else o.magnetUnderPointer=null,o.magnetProxy=null}o.eventTarget=t,c.set(o.arrowhead,{x:e,y:n},{ui:!0})},_connectArrowheadEnd:function(t={},e,n){const{model:o}=this,{viewUnderPointer:l,magnetUnderPointer:c,magnetProxy:p,arrowhead:r}=t;if(!c||!p||!l)return;l.unhighlight(p,{connecting:!0});const w=l.getLinkEnd(c,e,n,o,r);o.set(r,w,{ui:!0})},_beforeArrowheadMove:function(t){t.z=this.model.get("z"),this.model.toFront();var e=this.el.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets(t)},_afterArrowheadMove:function(t){t.z!==null&&(this.model.set("z",t.z,{ui:!0}),t.z=null),this.el.style.pointerEvents=t.pointerEvents,this.paper.options.markAvailable&&this._unmarkAvailableMagnets(t)},_createValidateConnectionArgs:function(t){var e=[];e[4]=t,e[5]=this;var n,o=0,l=0;t==="source"?(o=2,n="target"):(l=2,n="source");var c=this.model.get(n);if(c.id){var p=e[o]=this.paper.findViewByModel(c.id),r=p.getMagnetFromLinkEnd(c);r===p.el&&(r=void 0),e[o+1]=r}function w(M,N){return e[l]=M,e[l+1]=M.el===N?void 0:N,e}return w},_markAvailableMagnets:function(t){function e(E,Z){var Y=E.paper,K=Y.options.validateConnection;return K.apply(Y,this.validateConnectionArgs(E,Z))}var n=this.paper,o=n.model.getCells();t.marked={};for(var l=0,c=o.length;l<c;l++){var p=o[l].findView(n);if(p){var r=Array.prototype.slice.call(p.el.querySelectorAll("[magnet]"));p.el.getAttribute("magnet")!=="false"&&r.push(p.el);var w=r.filter(e.bind(t,p));if(w.length>0){for(var M=0,N=w.length;M<N;M++)p.highlight(w[M],{magnetAvailability:!0});p.highlight(null,{elementAvailability:!0}),t.marked[p.model.id]=w}}}},_unmarkAvailableMagnets:function(t){for(var e=Object.keys(t.marked),n,o,l=0,c=e.length;l<c;l++){n=e[l],o=t.marked[n];var p=this.paper.findViewByModel(n);if(p){for(var r=0,w=o.length;r<w;r++)p.unhighlight(o[r],{magnetAvailability:!0});p.unhighlight(null,{elementAvailability:!0})}}t.marked=null},startArrowheadMove:function(t,e){e||(e={});var n={action:"arrowhead-move",arrowhead:t,whenNotAllowed:e.whenNotAllowed||"revert",initialMagnet:this[t+"Magnet"]||(this[t+"View"]?this[t+"View"].el:null),initialEnd:Sh(this.model.get(t)),validateConnectionArgs:this._createValidateConnectionArgs(t)};return this._beforeArrowheadMove(n),e.ignoreBackwardsCompatibility!==!0&&(this._dragData=n),n},onRemove:function(){no.prototype.onRemove.apply(this,arguments),this.unmountLabels()}},{Flags:lr});Object.defineProperty(kv.prototype,"sourceBBox",{enumerable:!0,get:function(){var t=this.sourceView;if(!t){var e=this.model.source();return new ai(e.x,e.y)}var n=this.sourceMagnet;return t.isNodeConnection(n)?new ai(this.sourceAnchor):t.getNodeBBox(n||t.el)}});Object.defineProperty(kv.prototype,"targetBBox",{enumerable:!0,get:function(){var t=this.targetView;if(!t){var e=this.model.target();return new ai(e.x,e.y)}var n=this.targetMagnet;return t.isNodeConnection(n)?new ai(this.targetAnchor):t.getNodeBBox(n||t.el)}});const K5=_f.extend({tagName:"path",className:"highlight-stroke",attributes:{"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},options:{padding:3,rx:0,ry:0,useFirstSubpath:!1,attrs:{"stroke-width":3,stroke:"#FEB663"}},getPathData(t,e){const{options:n}=this,{useFirstSubpath:o}=n;let l;try{const c=yn(e);if(l=c.convertToPathData().trim(),c.tagName()==="PATH"&&o){const p=l.search(/.M/i)+1;p>0&&(l=l.substr(0,p))}}catch{const p=t.getNodeBoundingRect(e);l=yn.rectToPath(Wi({},n,p.toJSON()))}return l},highlightConnection(t){this.vel.attr("d",t.getSerializedConnection())},highlightNode(t,e){const{vel:n,options:o}=this,{padding:l,layer:c}=o;let p=this.getNodeMatrix(t,e);if(l){!c&&e===t.el&&n.remove();let r=t.getNodeBoundingRect(e);const w=r.x+r.width/2,M=r.y+r.height/2;r=yn.transformRect(r,p);const N=Math.max(r.width,1),E=Math.max(r.height,1),Z=(N+l)/N,Y=(E+l)/E,K=yn.createSVGMatrix({a:Z,b:0,c:0,d:Y,e:w-Z*w,f:M-Y*M});p=p.multiply(K)}n.attr({d:this.getPathData(t,e),transform:yn.matrixToTransformString(p)})},highlight(t,e){const{vel:n,options:o}=this;n.attr(o.attrs),t.isNodeConnection(e)?this.highlightConnection(t):this.highlightNode(t,e)}}),HS=20;function Q5(t,e){const n=t.children();for(;n.length>0;){const o=n.shift();e(o)&&n.push(...o.children())}}const tR=_f.extend({tagName:"rect",className:"highlight-mask",attributes:{"pointer-events":"none"},options:{padding:3,maskClip:HS,deep:!1,attrs:{stroke:"#FEB663","stroke-width":3,"stroke-linecap":"butt","stroke-linejoin":"miter"}},VISIBLE:"white",INVISIBLE:"black",MASK_ROOT_ATTRIBUTE_BLACKLIST:["marker-start","marker-end","marker-mid","transform","stroke-dasharray"],MASK_CHILD_ATTRIBUTE_BLACKLIST:["stroke","fill","stroke-width","stroke-opacity","stroke-dasharray","fill-opacity","marker-start","marker-end","marker-mid"],MASK_REPLACE_TAGS:["FOREIGNOBJECT","IMAGE","USE","TEXT","TSPAN","TEXTPATH"],MASK_REMOVE_TAGS:["TEXT","TSPAN","TEXTPATH"],transformMaskChild(t,e){const{MASK_CHILD_ATTRIBUTE_BLACKLIST:n,MASK_REPLACE_TAGS:o,MASK_REMOVE_TAGS:l}=this,c=e.tagName();if(!yn.isSVGGraphicsElement(e)||l.includes(c))return e.remove(),!1;if(o.includes(c)){const p=t.vel.findOne(`#${e.id}`);if(p){const{node:r}=p;let w=t.getNodeBoundingRect(r);t.model.isElement()&&(w=yn.transformRect(w,t.getNodeMatrix(r)));const M=yn("rect",w.toJSON()),{x:N,y:E}=w.center(),{angle:Z,cx:Y=N,cy:K=E}=p.rotate();Z&&M.rotate(Z,Y,K),e.parent().append(M)}return e.remove(),!1}return n.forEach(p=>{p==="fill"&&e.attr("fill")==="none"||e.removeAttr(p)}),!0},transformMaskRoot(t,e){const{MASK_ROOT_ATTRIBUTE_BLACKLIST:n}=this;n.forEach(o=>{e.removeAttr(o)})},getMaskShape(t,e){const{options:n,MASK_REPLACE_TAGS:o}=this,{deep:l}=n,c=e.tagName();let p;if(c==="G"){if(!l)return null;p=e.clone(),Q5(p,r=>this.transformMaskChild(t,r))}else{if(o.includes(c))return null;p=e.clone()}return this.transformMaskRoot(t,p),p},getMaskId(){return`highlight-mask-${this.cid}`},getMask(t,e){const{VISIBLE:n,INVISIBLE:o,options:l}=this,{padding:c,attrs:p}=l,r="stroke-width"in p?p["stroke-width"]:1,w=e.attr("fill")!=="none";let M=parseFloat(e.attr("stroke-width"));isNaN(M)&&(M=1);const N=M+c*2,E=N+r*2;let Z=this.getMaskShape(t,e);if(!Z){const Y=t.getNodeBoundingRect(e.node);Y.inflate(Y.width?0:.5,Y.height?0:.5),Z=yn("rect",Y.toJSON())}return Z.attr(p),yn("mask",{id:this.getMaskId()}).append([Z.clone().attr({fill:w?n:"none",stroke:n,"stroke-width":E}),Z.clone().attr({fill:w?o:"none",stroke:o,"stroke-width":N})])},removeMask(t){const e=t.svg.getElementById(this.getMaskId());e&&t.defs.removeChild(e)},addMask(t,e){t.defs.appendChild(e.node)},highlight(t,e){const{options:n,vel:o}=this,{padding:l,attrs:c,maskClip:p=HS,layer:r}=n,w="stroke"in c?c.stroke:"#000000";!r&&e===t.el&&o.remove();const M=t.getNodeBoundingRect(e).inflate(l+p),N=this.getNodeMatrix(t,e),E=this.getMask(t,yn(e));this.addMask(t.paper,E),o.attr(M.toJSON()),o.attr({transform:yn.matrixToTransformString(N),mask:`url(#${E.id})`,fill:w})},unhighlight(t){this.removeMask(t.paper)}}),eR=_f.extend({UPDATABLE:!1,MOUNTABLE:!1,opacityClassName:oh("highlight-opacity"),highlight:function(t,e){yn(e).addClass(this.opacityClassName)},unhighlight:function(t,e){yn(e).removeClass(this.opacityClassName)}}),$S=oh("highlighted"),nR=_f.extend({UPDATABLE:!1,MOUNTABLE:!1,options:{className:$S},highlight:function(t,e){yn(e).addClass(this.options.className)},unhighlight:function(t,e){yn(e).removeClass(this.options.className)}},{className:$S}),DI={ROW:"row",COLUMN:"column"},iR=_f.extend({tagName:"g",MOUNTABLE:!0,UPDATE_ATTRIBUTES:function(){return[this.options.attribute]},_prevItems:null,highlight(t,e){const n=t.model,{attribute:o,size:l=20,gap:c=5,direction:p=DI.ROW}=this.options;if(!o)throw new Error("List: attribute is required");const r=typeof l=="number"?{width:l,height:l}:l,w=p===DI.ROW,M=w?r.width:r.height;let N=n.get(o);Array.isArray(N)||(N=[]);const E=this._prevItems||[],Z=N.map((at,J)=>ag(E[J],N[J]));if(E.length!==N.length||Z.some(at=>!at)){const at=this.vel.children(),J=N.map((Q,lt)=>{const Ct=lt in at?at[lt].node:null;if(Z[lt])return Ct;const j=this.createListItem(Q,r,Ct);if(!j)return null;if(!(j instanceof SVGElement))throw new Error("List: item must be an SVGElement");j.dataset.index=lt,j.dataset.attribute=o;const k=lt*(M+c);return j.setAttribute("transform",w?`translate(${k}, 0)`:`translate(0, ${k})`),j});this.vel.empty().append(J),this._prevItems=N}const Y=N.length,K=Y===0?0:Y*M+(Y-1)*c,q=w?{width:K,height:r.height}:{width:r.width,height:K};this.position(n,q)},position(t,e){const{vel:n,options:o}=this,{margin:l=5,position:c="top-left"}=o,{width:p,height:r}=t.size(),{left:w,right:M,top:N,bottom:E}=Dp(l),Z=new ai(w,N,p-(w+M),r-(N+E));let{x:Y,y:K}=bk(Z,c);switch(c){case $s.CENTER:case $s.TOP:case $s.BOTTOM:{Y-=e.width/2;break}case $s.RIGHT:case $s.BOTTOM_RIGHT:case $s.TOP_RIGHT:{Y-=e.width;break}}switch(c){case $s.CENTER:case $s.RIGHT:case $s.LEFT:{K-=e.height/2;break}case $s.BOTTOM:case $s.BOTTOM_RIGHT:case $s.BOTTOM_LEFT:{K-=e.height;break}}n.attr("transform",`translate(${Y}, ${K})`)}},{Directions:DI,Positions:$s}),rR=Object.freeze(Object.defineProperty({__proto__:null,addClass:nR,list:iR,mask:tR,opacity:eR,stroke:K5},Symbol.toStringTag,{value:"Module"}));function oR(t,e,n,o){var l="ratio"in o?o.ratio:.5;return t.getPointAtRatio(l)}function sR(t,e,n,o){var l="length"in o?o.length:20;return t.getPointAtLength(l)}function aR(t,e,n,o){var l=1e6,c=t.getConnection(),p=t.getConnectionSubdivisions(),r=new di(n.clone().offset(0,l),n.clone().offset(0,-l)),w=new di(n.clone().offset(l,0),n.clone().offset(-l,0)),M=r.intersect(c,{segmentSubdivisions:p}),N=w.intersect(c,{segmentSubdivisions:p}),E=[];return M&&Array.prototype.push.apply(E,M),N&&Array.prototype.push.apply(E,N),E.length>0?n.chooseClosest(E):"fallbackAt"in o?Rk(t,o.fallbackAt):Bk(t,e,n,o)}function lR(t,e,n,o){var l=t.getClosestPoint(n);return l||new Te}function ly(t){return function(e,n,o,l){if(o instanceof Element){var c=this.paper.findView(o),p;if(c)if(c.isNodeConnection(o)){var r="fixedAt"in l?l.fixedAt:"50%";p=Rk(c,r)}else p=c.getNodeBBox(o).center();else p=new Te;return t.call(this,e,n,p,l)}return t.apply(this,arguments)}}function Rk(t,e){var n=parseFloat(e);return Gu(e)?t.getPointAtRatio(n/100):t.getPointAtLength(n)}const uR=ly(aR),Bk=ly(lR),cR=Object.freeze(Object.defineProperty({__proto__:null,connectionClosest:Bk,connectionLength:sR,connectionPerpendicular:uR,connectionRatio:oR,resolveRef:ly},Symbol.toStringTag,{value:"Module"}));function ew(t,e,n){if(rl(n)){const{x:l,y:c}=n;if(isFinite(c)){const p=new di(e,t),{start:r,end:w}=p.parallel(c);e=r,t=w}n=l}if(!isFinite(n))return t;var o=t.distance(e);return n===0&&o>0?t:t.move(e,-Math.min(n,o-1))}function xA(t){var e=t.getAttribute("stroke-width");return e===null?0:parseFloat(e)||0}function hR(t,e,n=0){let o,l,c,p;const{start:r,end:w}=t;switch(e){case"left":o="x",l=w,c=r,p=-1;break;case"right":o="x",l=r,c=w,p=1;break;case"top":o="y",l=w,c=r,p=-1;break;case"bottom":o="y",l=r,c=w,p=1;break;default:return}r[o]<w[o]?l[o]=c[o]:c[o]=l[o],isFinite(n)&&(l[o]+=p*n,c[o]+=p*n)}function fR(t,e,n,o){let{offset:l,alignOffset:c,align:p}=o;return p&&hR(t,p,c),ew(t.end,t.start,l)}function Fk(t,e,n,o){var l=e.getNodeBBox(n);o.stroke&&l.inflate(xA(n)/2);var c=t.intersect(l),p=c?t.start.chooseClosest(c):t.end;return ew(p,t.start,o.offset)}function dR(t,e,n,o){var l=e.model.angle();if(l===0)return Fk(t,e,n,o);var c=e.getNodeUnrotatedBBox(n);o.stroke&&c.inflate(xA(n)/2);var p=c.center(),r=t.clone().rotate(p,l),w=r.setLength(1e6).intersect(c),M=w?r.start.chooseClosest(w).rotate(p,-l):t.end;return ew(M,t.start,o.offset)}function pR(t){if(!t)return null;var e=t;do{var n=e.tagName;if(typeof n!="string")return null;if(n=n.toUpperCase(),n==="G")e=e.firstElementChild;else if(n==="TITLE")e=e.nextElementSibling;else break}while(e);return e}var NI="segmentSubdivisons",OI="shapeBBox";function mR(t,e,n,o){var l,c,p=o.selector,r=t.end;if(typeof p=="string"?l=e.findBySelector(p)[0]:Array.isArray(p)?l=Kv(n,p):l=pR(n),!yn.isSVGGraphicsElement(l)){if(l===n||!yn.isSVGGraphicsElement(n))return r;l=n}var w=e.getNodeShape(l),M=e.getNodeMatrix(l),N=e.getRootTranslateMatrix(),E=e.getRootRotateMatrix(),Z=N.multiply(E).multiply(M),Y=Z.inverse(),K=yn.transformLine(t,Y),q=K.start.clone(),at=e.getNodeData(l);if(o.insideout===!1){at[OI]||(at[OI]=w.bbox());var J=at[OI];if(J.containsPoint(q))return r}var Q;if(w instanceof zi){var lt=o.precision||2;at[NI]||(at[NI]=w.getSegmentSubdivisions({precision:lt})),Q={precision:lt,segmentSubdivisions:at[NI]}}o.extrapolate===!0&&K.setLength(1e6),c=K.intersect(w,Q),c?yn.isArray(c)&&(c=q.chooseClosest(c)):o.sticky===!0&&(w instanceof ai?c=w.pointNearestToPoint(q):w instanceof pu?c=w.intersectionWithLineFromCenterToPoint(q):c=w.closestPoint(q,Q));var Ct=c?yn.transformPoint(c,Z):r,j=o.offset||0;return o.stroke&&(j+=xA(l)/2),ew(Ct,t.start,j)}const gR=fR,_R=Fk,vR=dR,yR=mR,xR=Object.freeze(Object.defineProperty({__proto__:null,anchor:gR,bbox:_R,boundary:yR,rectangle:vR},Symbol.toStringTag,{value:"Module"}));function Af(t){return function(e,n,o,l){var c=!!l.rotate,p=c?e.getNodeUnrotatedBBox(n):e.getNodeBBox(n),r=p[t](),w=l.dx;if(w){var M=Gu(w);w=parseFloat(w),isFinite(w)&&(M&&(w/=100,w*=p.width),r.x+=w)}var N=l.dy;if(N){var E=Gu(N);N=parseFloat(N),isFinite(N)&&(E&&(N/=100,N*=p.height),r.y+=N)}return c?r.rotate(e.model.getBBox().center(),-e.model.angle()):r}}function wR(t,e,n,o){var l=t.model.angle(),c=t.getNodeBBox(e),p=c.center(),r=c.origin(),w=c.corner(),M=o.padding;if(isFinite(M)||(M=0),r.y+M<=n.y&&n.y<=w.y-M){var N=n.y-p.y;p.x+=l===0||l===180?0:N*1/Math.tan(ju(l)),p.y+=N}else if(r.x+M<=n.x&&n.x<=w.x-M){var E=n.x-p.x;p.y+=l===90||l===270?0:E*Math.tan(ju(l)),p.x+=E}return p}function bR(t,e,n,o){var l=!!o.rotate,c,p,r;l?(c=t.getNodeUnrotatedBBox(e),r=t.model.getBBox().center(),p=t.model.angle()):c=t.getNodeBBox(e);var w=o.padding;isFinite(w)&&c.inflate(w),l&&n.rotate(r,p);var M=c.sideNearestToPoint(n),N;switch(M){case"left":N=c.leftMiddle();break;case"right":N=c.rightMiddle();break;case"top":N=c.topMiddle();break;case"bottom":N=c.bottomMiddle();break}return l?N.rotate(r,-p):N}function IR(t,e,n,o,l){return t.model.getPointFromConnectedLink(this.model,l).offset(o.dx,o.dy)}const CR=Af("center"),AR=Af("topMiddle"),TR=Af("bottomMiddle"),SR=Af("leftMiddle"),ER=Af("rightMiddle"),MR=Af("origin"),LR=Af("topRight"),kR=Af("bottomLeft"),PR=Af("corner"),zR=ly(wR),DR=ly(bR),NR=IR,OR=Object.freeze(Object.defineProperty({__proto__:null,bottom:TR,bottomLeft:kR,bottomRight:PR,center:CR,left:SR,midSide:DR,modelCenter:NR,perpendicular:zR,right:ER,top:AR,topLeft:MR,topRight:LR},Symbol.toStringTag,{value:"Module"})),Ym={NONE:"sorting-none",APPROX:"sorting-approximate",EXACT:"sorting-exact"},RR=50,qS=20,JS=1e3,BR=1/0,u1=9007199254740991,RI=no.Highlighting,KS={[RI.DEFAULT]:{name:"stroke",options:{padding:3}},[RI.MAGNET_AVAILABILITY]:{name:"addClass",options:{className:"available-magnet"}},[RI.ELEMENT_AVAILABILITY]:{name:"addClass",options:{className:"available-cell"}}},FR=[{name:rh.BACK},{name:rh.CELLS},{name:rh.LABELS},{name:rh.FRONT},{name:rh.TOOLS}],jR=pg.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:1,drawGrid:!1,background:!1,perpendicularLinks:!1,elementView:Ia,linkView:kv,snapLabels:!1,snapLinks:!1,snapLinksSelf:!1,labelsLayer:!1,multiLinks:!0,guard:function(t,e){return!1},highlighting:KS,preventContextMenu:!0,preventDefaultBlankAction:!0,restrictTranslate:!1,markAvailable:!1,defaultLink:new cl,defaultConnector:{name:"normal"},defaultRouter:{name:"normal"},defaultAnchor:{name:"center"},defaultLinkAnchor:{name:"connectionRatio"},defaultConnectionPoint:{name:"bbox"},connectionStrategy:null,validateMagnet:function(t,e,n){return e.getAttribute("magnet")!=="passive"},validateConnection:function(t,e,n,o,l,c){return(l==="target"?n:t)instanceof Ia},embeddingMode:!1,validateEmbedding:function(t,e){return!0},validateUnembedding:function(t){return!0},findParentBy:"bbox",frontParentOnly:!0,interactive:{labelMove:!1},linkPinning:!0,allowLink:null,clickThreshold:0,moveThreshold:0,magnetThreshold:0,sorting:Ym.EXACT,frozen:!1,onViewUpdate:function(t,e,n,o,l){e&(t.FLAG_INSERT|t.FLAG_REMOVE)||o.mounting||o.isolate||l.requestConnectedLinksUpdate(t,n,o)},onViewPostponed:function(t,e,n){return n.forcePostponedViewUpdate(t,e)},beforeRender:null,afterRender:null,viewport:null,cellViewNamespace:null,routerNamespace:null,connectorNamespace:null,highlighterNamespace:rR,anchorNamespace:OR,linkAnchorNamespace:cR,connectionPointNamespace:xR},events:{dblclick:"pointerdblclick",dbltap:"pointerdblclick",contextmenu:"contextmenu",mousedown:"pointerdown",touchstart:"pointerdown",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",wheel:"mousewheel","mouseenter .joint-cell":"mouseenter","mouseleave .joint-cell":"mouseleave","mouseenter .joint-tools":"mouseenter","mouseleave .joint-tools":"mouseleave","mousedown .joint-cell [event]":"onevent","touchstart .joint-cell [event]":"onevent","mousedown .joint-cell [magnet]":"onmagnet","touchstart .joint-cell [magnet]":"onmagnet","dblclick .joint-cell [magnet]":"magnetpointerdblclick","contextmenu .joint-cell [magnet]":"magnetcontextmenu","mousedown .joint-link .label":"onlabel","touchstart .joint-link .label":"onlabel","dragstart .joint-cell image":"onImageDragStart"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},svg:null,viewport:null,defs:null,tools:null,$background:null,layers:null,$grid:null,$document:null,_viewportMatrix:null,_viewportTransformString:null,_updates:null,_layers:null,SORT_DELAYING_BATCHES:["add","to-front","to-back"],UPDATE_DELAYING_BATCHES:["translate"],MIN_SCALE:1e-6,init:function(){const{options:t,el:e}=this;t.cellViewNamespace||(t.cellViewNamespace=typeof joint<"u"&&mf(joint,"shapes")?joint.shapes:null);const n=this.model=t.model||new _A;this._layers={},this.setGrid(t.drawGrid),this.cloneOptions(),this.render(),this._setDimensions(),this.startListening(),this._views={},this._mw_evt_buffer={event:null,deltas:[]},this.$document=lo(e.ownerDocument),this.resetViews(n.attributes.cells.models),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()},_resetUpdates:function(){return this._updates={id:null,priorities:[{},{},{}],unmountedCids:[],mountedCids:[],unmounted:{},mounted:{},count:0,keyFrozen:!1,freezeKey:null,sort:!1}},startListening:function(){var t=this.model;this.listenTo(t,"add",this.onCellAdded).listenTo(t,"remove",this.onCellRemoved).listenTo(t,"change",this.onCellChange).listenTo(t,"reset",this.onGraphReset).listenTo(t,"sort",this.onGraphSort).listenTo(t,"batch:stop",this.onGraphBatchStop),this.on("cell:highlight",this.onCellHighlight).on("cell:unhighlight",this.onCellUnhighlight).on("scale translate",this.update)},onCellAdded:function(t,e,n){var o=n.position;this.isAsync()||!Du(o)?this.renderView(t,n):(n.maxPosition===o&&this.freeze({key:"addCells"}),this.renderView(t,n),o===0&&this.unfreeze({key:"addCells"}))},onCellRemoved:function(t,e,n){const o=this.findViewByModel(t);o&&this.requestViewUpdate(o,o.FLAG_REMOVE,o.UPDATE_PRIORITY,n)},onCellChange:function(t,e){if(t!==this.model.attributes.cells&&t.hasChanged("z")&&this.options.sorting===Ym.APPROX){const n=this.findViewByModel(t);n&&this.requestViewUpdate(n,n.FLAG_INSERT,n.UPDATE_PRIORITY,e)}},onGraphReset:function(t,e){this.resetLayers(),this.resetViews(t.models,e)},onGraphSort:function(){this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)||this.sortViews()},onGraphBatchStop:function(t){if(!this.isFrozen()){var e=t&&t.batchName,n=this.model;if(!this.isAsync()){var o=this.UPDATE_DELAYING_BATCHES;o.includes(e)&&!n.hasActiveBatch(o)&&this.updateViews(t)}var l=this.SORT_DELAYING_BATCHES;l.includes(e)&&!n.hasActiveBatch(l)&&this.sortViews()}},cloneOptions:function(){const{options:t}=this,{defaultConnector:e,defaultRouter:n,defaultConnectionPoint:o,defaultAnchor:l,defaultLinkAnchor:c,origin:p,highlighting:r,cellViewNamespace:w,interactive:M}=t;!w&&typeof joint<"u"&&mf(joint,"shapes")&&(t.cellViewNamespace=joint.shapes),Jo(e)||(t.defaultConnector=kc(e)),Jo(n)||(t.defaultRouter=kc(n)),Jo(o)||(t.defaultConnectionPoint=kc(o)),Jo(l)||(t.defaultAnchor=kc(l)),Jo(c)||(t.defaultLinkAnchor=kc(c)),rl(M)&&(t.interactive=Wi({},M)),rl(r)&&(t.highlighting=mA({},r,KS)),t.origin=Wi({},p)},children:function(){var t=yn.namespace;return[{namespaceURI:t.xhtml,tagName:"div",className:oh("paper-background"),selector:"background"},{namespaceURI:t.xhtml,tagName:"div",className:oh("paper-grid"),selector:"grid"},{namespaceURI:t.svg,tagName:"svg",attributes:{width:"100%",height:"100%","xmlns:xlink":t.xlink},selector:"svg",children:[{tagName:"defs",selector:"defs"},{tagName:"g",className:oh("layers"),selector:"layers"}]}]},hasLayerView(t){return t in this._layers},getLayerView(t){const{_layers:e}=this;if(t in e)return e[t];throw new Error(`dia.Paper: Unknown layer "${t}"`)},getLayerNode(t){return this.getLayerView(t).el},render:function(){this.renderChildren();const{childNodes:t,options:e}=this,{svg:n,defs:o,layers:l,background:c,grid:p}=t;return this.svg=n,this.defs=o,this.layers=l,this.$background=lo(c),this.$grid=lo(p),this.renderLayers(),yn.ensureId(n),e.background&&this.drawBackground(e.background),e.drawGrid&&this.drawGrid(),this},renderLayers:function(t=FR){this.removeLayers(),t.forEach(({name:l,sorted:c})=>{const p=new u5({name:l});this.layers.appendChild(p.el),this._layers[l]=p});const e=this.getLayerView(rh.CELLS),n=this.getLayerView(rh.TOOLS),o=this.getLayerView(rh.LABELS);this.tools=n.el,this.cells=this.viewport=e.el,e.vel.addClass(oh("viewport")),o.vel.addClass(oh("viewport"))},removeLayers:function(){const{_layers:t}=this;Object.keys(t).forEach(e=>{t[e].remove(),delete t[e]})},resetLayers:function(){const{_layers:t}=this;Object.keys(t).forEach(e=>{t[e].removePivots()})},update:function(){return this.options.drawGrid&&this.drawGrid(),this._background&&this.updateBackgroundImage(this._background),this},matrix:function(t){var e=this.layers;if(t===void 0){var n=e.getAttribute("transform");return(this._viewportTransformString||null)===n?t=this._viewportMatrix:(t=e.getCTM(),this._viewportMatrix=t,this._viewportTransformString=n),yn.createSVGMatrix(t)}t=yn.createSVGMatrix(t);var o=yn.matrixToTransformString(t);return e.setAttribute("transform",o),this._viewportMatrix=t,this._viewportTransformString=e.getAttribute("transform"),this},clientMatrix:function(){return yn.createSVGMatrix(this.cells.getScreenCTM())},requestConnectedLinksUpdate:function(t,e,n){if(t instanceof no)for(var o=t.model,l=this.model.getConnectedLinks(o),c=0,p=l.length;c<p;c++){var r=l[c],w=this.findViewByModel(r);if(w){var M=["UPDATE"];r.getTargetCell()===o&&M.push("TARGET"),r.getSourceCell()===o&&M.push("SOURCE");var N=Math.max(e+1,w.UPDATE_PRIORITY);this.scheduleViewUpdate(w,w.getFlag(M),N,n)}}},forcePostponedViewUpdate:function(t,e){if(!t||!(t instanceof no))return!1;var n=t.model;if(n.isElement())return!1;if(!(e&t.getFlag(["SOURCE","TARGET"]))){var o=0,l=this.findViewByModel(n.getSourceCell());l&&!this.isViewMounted(l)&&(o=this.dumpView(l),t.updateEndMagnet("source"));var c=0,p=this.findViewByModel(n.getTargetCell());if(p&&!this.isViewMounted(p)&&(c=this.dumpView(p),t.updateEndMagnet("target")),o===0&&c===0)return!this.dumpView(t)}return!1},requestViewUpdate:function(t,e,n,o){o||(o={}),this.scheduleViewUpdate(t,e,n,o);var l=this.isAsync();if(!(this.isFrozen()||l&&o.async!==!1)&&!this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES)){var c=this.updateViews(o);l&&this.notifyAfterRender(c,o)}},scheduleViewUpdate:function(t,e,n,o){const{_updates:l,options:c}=this,{FLAG_REMOVE:p,FLAG_INSERT:r,UPDATE_PRIORITY:w,cid:M}=t;let N=l.priorities[n];if(N||(N=l.priorities[n]={}),n>w)for(let Y=n-1;Y>=w;Y--){const K=l.priorities[Y];!K||!(M in K)||(N[M]|=K[M],delete K[M])}let E=N[M]||0;if((E&e)===e)return;E||l.count++,e&p&&E&r?N[M]^=r:e&r&&E&p&&(N[M]^=p),N[M]|=e;const Z=c.onViewUpdate;typeof Z=="function"&&Z.call(this,t,e,n,o||{},this)},dumpViewUpdate:function(t){if(!t)return 0;var e=this._updates,n=t.cid,o=e.priorities[t.UPDATE_PRIORITY],l=this.registerMountedView(t)|o[n];return delete o[n],l},dumpView:function(t,e){var n=this.dumpViewUpdate(t);return n?this.updateView(t,n,e):0},updateView:function(t,e,n){if(!t)return 0;const{FLAG_REMOVE:o,FLAG_INSERT:l,model:c}=t;if(t instanceof no){if(e&o)return this.removeView(c),0;e&l&&(this.insertView(t),e^=l)}return e?t.confirmUpdate(e,n||{}):0},requireView:function(t,e){var n=this.findViewByModel(t);return n?(this.dumpView(n,e),n):null},registerUnmountedView:function(t){var e=t.cid,n=this._updates;if(e in n.unmounted)return 0;var o=n.unmounted[e]|=t.FLAG_INSERT;return n.unmountedCids.push(e),delete n.mounted[e],o},registerMountedView:function(t){var e=t.cid,n=this._updates;if(e in n.mounted)return 0;n.mounted[e]=!0,n.mountedCids.push(e);var o=n.unmounted[e]||0;return delete n.unmounted[e],o},isViewMounted:function(t){if(!t)return!1;var e=t.cid,n=this._updates;return e in n.mounted},dumpViews:function(t){var e=Eh({},t,{viewport:null});this.checkViewport(e),this.updateViews(e)},updateViews:function(t){this.notifyBeforeRender(t);let e,n=0,o=0,l=u1;do o++,e=this.updateViewsBatch(t),n+=e.updated,l=Math.min(e.priority,l);while(!e.empty);const c={updated:n,batches:o,priority:l};return this.notifyAfterRender(c,t),c},hasScheduledUpdates:function(){const t=this._updates.priorities,e=Object.keys(t);let n=e.length;for(;n>0&&n--;)for(let o in t[e[n]])return!0;return!1},updateViewsAsync:function(t,e){t||(t={}),e||(e={processed:0,priority:u1});var n=this._updates,o=n.id;if(o){YC(o),e.processed===0&&this.hasScheduledUpdates()&&this.notifyBeforeRender(t);var l=this.updateViewsBatch(t),c=Eh({},t,{mountBatchSize:JS-l.mounted,unmountBatchSize:JS-l.unmounted}),p=this.checkViewport(c),r=p.unmounted,w=p.mounted,M=e.processed,N=n.count;l.updated>0&&(M+=l.updated+l.unmounted,l.processed=M,e.priority=Math.min(l.priority,e.priority),l.empty&&w===0?(l.unmounted+=r,l.mounted+=w,l.priority=e.priority,this.notifyAfterRender(l,t),e.processed=0,e.priority=u1,n.count=0):e.processed=M);var E=t.progress;if(N&&typeof E=="function"&&E.call(this,l.empty,M,N,l,this),n.id!==o)return}n.id=WC(this.updateViewsAsync,this,t,e)},notifyBeforeRender:function(t={}){let e=t.beforeRender;typeof e!="function"&&(e=this.options.beforeRender,typeof e!="function")||e.call(this,t,this)},notifyAfterRender:function(t,e={}){let n=e.afterRender;typeof n!="function"&&(n=this.options.afterRender),typeof n=="function"&&n.call(this,t,e,this),this.trigger("render:done",t,e)},updateViewsBatch:function(t){t||(t={});var e=t.batchSize||BR,n=this._updates,o=0,l=0,c=0,p=0,r=u1,w=!0,M=this.options,N=n.priorities,E="viewport"in t?t.viewport:M.viewport;typeof E!="function"&&(E=null);var Z=M.onViewPostponed;typeof Z!="function"&&(Z=null);var Y=Object.keys(N);t:for(var K=0,q=Y.length;K<q;K++){var at=+Y[K],J=N[at];for(var Q in J){if(o>=e){w=!1;break t}var lt=_p[Q];if(!lt){delete J[Q];continue}var Ct=J[Q];if(!(Ct&lt.FLAG_REMOVE)){var j=Q in n.unmounted;if(lt.DETACHABLE&&E&&!E.call(this,lt,!j,this)){j||(this.registerUnmountedView(lt),lt.unmount()),n.unmounted[Q]|=Ct,delete J[Q],c++;continue}j&&(Ct|=lt.FLAG_INSERT,p++),Ct|=this.registerMountedView(lt)}var k=this.updateView(lt,Ct,t);if(k>0&&(J[Q]=k,!Z||!Z.call(this,lt,k,this)||J[Q])){l++,w=!1;continue}r>at&&(r=at),o++,delete J[Q]}}return{priority:r,updated:o,postponed:l,unmounted:c,mounted:p,empty:w}},getUnmountedViews:function(){const t=this._updates,e=Object.keys(t.unmounted),n=e.length,o=new Array(n);for(var l=0;l<n;l++)o[l]=_p[e[l]];return o},getMountedViews:function(){const t=this._updates,e=Object.keys(t.mounted),n=e.length,o=new Array(n);for(var l=0;l<n;l++)o[l]=_p[e[l]];return o},checkUnmountedViews:function(t,e){e||(e={});var n=0;typeof t!="function"&&(t=null);for(var o=("mountBatchSize"in e)?e.mountBatchSize:1/0,l=this._updates,c=l.unmountedCids,p=l.unmounted,r=0,w=Math.min(c.length,o);r<w;r++){var M=c[r];if(M in p){var N=_p[M];if(N){if(N.DETACHABLE&&t&&!t.call(this,N,!1,this)){c.push(M);continue}n++;var E=this.registerMountedView(N);E&&this.scheduleViewUpdate(N,E,N.UPDATE_PRIORITY,{mounting:!0})}}}return c.splice(0,r),n},checkMountedViews:function(t,e){e||(e={});var n=0;if(typeof t!="function")return n;for(var o=("unmountBatchSize"in e)?e.unmountBatchSize:1/0,l=this._updates,c=l.mountedCids,p=l.mounted,r=0,w=Math.min(c.length,o);r<w;r++){var M=c[r];if(M in p){var N=_p[M];if(N){if(!N.DETACHABLE||t.call(this,N,!0,this)){c.push(M);continue}n++;var E=this.registerUnmountedView(N);E&&N.unmount()}}}return c.splice(0,r),n},checkViewport:function(t){var e=Eh({},t,{mountBatchSize:1/0,unmountBatchSize:1/0}),n="viewport"in e?e.viewport:this.options.viewport,o=this.checkMountedViews(n,e);if(o>0){var l=this._updates.unmountedCids;e.mountBatchSize=Math.min(l.length-o,e.mountBatchSize)}var c=this.checkUnmountedViews(n,e);return{mounted:c,unmounted:o}},freeze:function(t){t||(t={});var e=this._updates,n=t.key,o=this.options.frozen,l=e.freezeKey;if(n&&n!==l){if(o&&l)return;e.freezeKey=n,e.keyFrozen=o}this.options.frozen=!0;var c=e.id;e.id=null,this.isAsync()&&c&&YC(c)},unfreeze:function(t){t||(t={});var e=this._updates,n=t.key,o=e.freezeKey;n&&o&&n!==o||(e.freezeKey=null,!(n&&n===o&&e.keyFrozen)&&(this.isAsync()?(this.freeze(),this.updateViewsAsync(t)):this.updateViews(t),this.options.frozen=e.keyFrozen=!1,e.sort&&(this.sortViews(),e.sort=!1)))},isAsync:function(){return!!this.options.async},isFrozen:function(){return!!this.options.frozen},isExactSorting:function(){return this.options.sorting===Ym.EXACT},onRemove:function(){this.freeze(),this.removeLayers(),this.removeViews()},getComputedSize:function(){var t=this.options,e=t.width,n=t.height;return Du(e)||(e=this.el.clientWidth),Du(n)||(n=this.el.clientHeight),{width:e,height:n}},setDimensions:function(t,e){const{options:n}=this,{width:o,height:l}=n;let c=t===void 0?o:t,p=e===void 0?l:e;if(o===c&&l===p)return;n.width=c,n.height=p,this._setDimensions();const r=this.getComputedSize();this.trigger("resize",r.width,r.height)},_setDimensions:function(){const{options:t}=this;let e=t.width,n=t.height;Du(e)&&(e=Math.round(e)),Du(n)&&(n=Math.round(n)),this.$el.css({width:e===null?"":e,height:n===null?"":n})},setOrigin:function(t,e){return this.translate(t||0,e||0)},fitToContent:function(t,e,n,o){As(t)?o=t:o=Wi({gridWidth:t,gridHeight:e,padding:n},o);const{x:l,y:c,width:p,height:r}=this.getFitToContentArea(o),{sx:w,sy:M}=this.scale();return this.setOrigin(-l*w,-c*M),this.setDimensions(p*w,r*M),new ai(l,c,p,r)},getFitToContentArea:function(t={}){const e=t.gridWidth||1,n=t.gridHeight||1,o=Dp(t.padding||0),l=Math.max(t.minWidth||0,e),c=Math.max(t.minHeight||0,n),p=t.maxWidth||Number.MAX_VALUE,r=t.maxHeight||Number.MAX_VALUE,w=t.allowNewOrigin,M="contentArea"in t?new ai(t.contentArea):this.getContentArea(t),{sx:N,sy:E}=this.scale();M.x*=N,M.y*=E,M.width*=N,M.height*=E;let Z=Math.ceil((M.width+M.x)/e),Y=Math.ceil((M.height+M.y)/n);t.allowNegativeBottomRight||(Z=Math.max(Z,1),Y=Math.max(Y,1)),Z*=e,Y*=n;let K=0;(w==="negative"&&M.x<0||w==="positive"&&M.x>=0||w==="any")&&(K=Math.ceil(-M.x/e)*e,K+=o.left,Z+=K);let q=0;return(w==="negative"&&M.y<0||w==="positive"&&M.y>=0||w==="any")&&(q=Math.ceil(-M.y/n)*n,q+=o.top,Y+=q),Z+=o.right,Y+=o.bottom,Z=Math.max(Z,l),Y=Math.max(Y,c),Z=Math.min(Z,p),Y=Math.min(Y,r),new ai(-K/N,-q/E,Z/N,Y/E)},scaleContentToFit:function(t){t||(t={});var e,n;if("contentArea"in t){var o=t.contentArea;e=this.localToPaperRect(o),n=new Te(o)}else e=this.getContentBBox(t),n=this.paperToLocalPoint(e);if(!(!e.width||!e.height)){Eh(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE});var l=Dp(t.padding),c=t.minScaleX||t.minScale,p=t.maxScaleX||t.maxScale,r=t.minScaleY||t.minScale,w=t.maxScaleY||t.maxScale,M;if(t.fittingBBox)M=t.fittingBBox;else{var N=this.translate(),E=this.getComputedSize();M={x:N.tx,y:N.ty,width:E.width,height:E.height}}M=new ai(M).moveAndExpand({x:l.left,y:l.top,width:-l.left-l.right,height:-l.top-l.bottom});var Z=this.scale(),Y=M.width/e.width*Z.sx,K=M.height/e.height*Z.sy;if(t.preserveAspectRatio&&(Y=K=Math.min(Y,K)),t.scaleGrid){var q=t.scaleGrid;Y=q*Math.floor(Y/q),K=q*Math.floor(K/q)}Y=Math.min(p,Math.max(c,Y)),K=Math.min(w,Math.max(r,K));var at=this.options.origin,J=M.x-n.x*Y-at.x,Q=M.y-n.y*K-at.y;this.scale(Y,K),this.translate(J,Q)}},getContentArea:function(t){return t&&t.useModelGeometry?this.model.getBBox()||new ai:yn(this.cells).getBBox()},getContentBBox:function(t){return this.localToPaperRect(this.getContentArea(t))},getArea:function(){return this.paperToLocalRect(this.getComputedSize())},getRestrictedArea:function(...t){const{restrictTranslate:e}=this.options;let n;return Jo(e)?n=e.apply(this,t):e===!0?n=this.getArea():e?n=new ai(e):n=null,n},createViewForModel:function(t){const{options:e}=this;var n,o,l=e.cellViewNamespace,c=t.get("type")+"View",p=Kv(l,c,".");t.isLink()?(n=e.linkView,o=kv):(n=e.elementView,o=Ia);var r=n.prototype instanceof Yl.View?p||n:n.call(this,t)||p||o;return new r({model:t,interactive:e.interactive,labelsLayer:e.labelsLayer===!0?rh.LABELS:e.labelsLayer})},removeView:function(t){const{id:e}=t,{_views:n,_updates:o}=this,l=n[e];if(l){var{cid:c}=l;const{mounted:p,unmounted:r}=o;l.remove(),delete n[e],delete p[c],delete r[c]}return l},renderView:function(t,e){const{id:n}=t,o=this._views;let l,c,p=!0;return n in o&&(l=o[n],l.model===t?(c=l.FLAG_INSERT,p=!1):this.removeView(t)),p&&(l=o[n]=this.createViewForModel(t),l.paper=this,c=this.registerUnmountedView(l)|l.getFlag(ca(l,"initFlag"))),this.requestViewUpdate(l,c,l.UPDATE_PRIORITY,e),l},onImageDragStart:function(){return!1},resetViews:function(t,e){e||(e={}),t||(t=[]),this._resetUpdates(),this.removeViews(),this.freeze({key:"reset"});for(var n=0,o=t.length;n<o;n++)this.renderView(t[n],e);this.unfreeze({key:"reset"}),this.sortViews()},removeViews:function(){Ph(this._views,"remove"),this._views={}},sortViews:function(){if(this.isExactSorting()){if(this.isFrozen()){this._updates.sort=!0;return}this.sortViewsExact()}},sortViewsExact:function(){var t=lo(this.cells).children("[model-id]"),e=this.model.get("cells");TO(t,function(n,o){var l=e.get(n.getAttribute("model-id")),c=e.get(o.getAttribute("model-id")),p=l.attributes.z||0,r=c.attributes.z||0;return p===r?0:p<r?-1:1})},insertView:function(t){const e=this.getLayerView(rh.CELLS),{el:n,model:o}=t;switch(this.options.sorting){case Ym.APPROX:e.insertSortedNode(n,o.get("z"));break;case Ym.EXACT:default:e.insertNode(n);break}t.onMount()},scale:function(t,e,n,o){if(t===void 0)return yn.matrixToScale(this.matrix());e===void 0&&(e=t),n===void 0&&(n=0,o=0);var l=this.translate();if(n||o||l.tx||l.ty){var c=l.tx-n*(t-1),p=l.ty-o*(e-1);this.translate(c,p)}t=Math.max(t||0,this.MIN_SCALE),e=Math.max(e||0,this.MIN_SCALE);var r=this.matrix();return r.a=t,r.d=e,this.matrix(r),this.trigger("scale",t,e,n,o),this},rotate:function(t,e,n){if(t===void 0)return yn.matrixToRotate(this.matrix());if(e===void 0){var o=this.cells.getBBox();e=o.width/2,n=o.height/2}var l=this.matrix().translate(e,n).rotate(t).translate(-e,-n);return this.matrix(l),this},translate:function(t,e){if(t===void 0)return yn.matrixToTranslate(this.matrix());const{options:n}=this,{origin:o,drawGrid:l}=n;t||(t=0),e||(e=0);const c=this.matrix();if(c.e===t&&c.f===e)return this;c.e=t,c.f=e,this.matrix(c);const{tx:p,ty:r}=this.translate();return o.x=p,o.y=r,this.trigger("translate",p,r),l&&this.drawGrid(),this},findView:function(t){var e=mu(t)?this.cells.querySelector(t):t instanceof lo?t[0]:t,n=this.findAttribute("model-id",e);if(n)return this._views[n]},findViewByModel:function(t){var e=mu(t)||Du(t)?t:t&&t.id;return this._views[e]},findViewsFromPoint:function(t){t=new Te(t);var e=this.model.getElements().map(this.findViewByModel,this);return e.filter(function(n){return n&&n.vel.getBBox({target:this.cells}).containsPoint(t)},this)},findViewsInArea:function(t,e){e=Eh(e||{},{strict:!1}),t=new ai(t);var n=this.model.getElements().map(this.findViewByModel,this),o=e.strict?"containsRect":"intersect";return n.filter(function(l){return l&&t[o](l.vel.getBBox({target:this.cells}))},this)},removeTools:function(){return this.dispatchToolsEvent("remove"),this},hideTools:function(){return this.dispatchToolsEvent("hide"),this},showTools:function(){return this.dispatchToolsEvent("show"),this},dispatchToolsEvent:function(t,...e){typeof t=="string"&&this.trigger("tools:event",t,...e)},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t,e){return this.clientToLocalPoint(t,e).snapToGrid(this.options.gridSize)},localToPaperPoint:function(t,e){var n=new Te(t,e),o=yn.transformPoint(n,this.matrix());return o},localToPaperRect:function(t,e,n,o){var l=new ai(t,e,n,o),c=yn.transformRect(l,this.matrix());return c},paperToLocalPoint:function(t,e){var n=new Te(t,e),o=yn.transformPoint(n,this.matrix().inverse());return o},paperToLocalRect:function(t,e,n,o){var l=new ai(t,e,n,o),c=yn.transformRect(l,this.matrix().inverse());return c},localToClientPoint:function(t,e){var n=new Te(t,e),o=yn.transformPoint(n,this.clientMatrix());return o},localToClientRect:function(t,e,n,o){var l=new ai(t,e,n,o),c=yn.transformRect(l,this.clientMatrix());return c},clientToLocalPoint:function(t,e){var n=new Te(t,e),o=yn.transformPoint(n,this.clientMatrix().inverse());return o},clientToLocalRect:function(t,e,n,o){var l=new ai(t,e,n,o),c=yn.transformRect(l,this.clientMatrix().inverse());return c},localToPagePoint:function(t,e){return this.localToPaperPoint(t,e).offset(this.pageOffset())},localToPageRect:function(t,e,n,o){return this.localToPaperRect(t,e,n,o).offset(this.pageOffset())},pageToLocalPoint:function(t,e){var n=new Te(t,e),o=n.difference(this.pageOffset());return this.paperToLocalPoint(o)},pageToLocalRect:function(t,e,n,o){var l=this.pageOffset(),c=new ai(t,e,n,o);return c.x-=l.x,c.y-=l.y,this.paperToLocalRect(c)},clientOffset:function(){var t=this.svg.getBoundingClientRect();return new Te(t.left,t.top)},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY)},linkAllowed:function(t){if(!(t instanceof kv))throw new Error("Must provide a linkView.");var e=t.model,n=this.options,o=this.model,l=o.constructor.validations;return!(!n.multiLinks&&!l.multiLinks.call(this,o,e)||!n.linkPinning&&!l.linkPinning.call(this,o,e)||typeof n.allowLink=="function"&&!n.allowLink.call(this,t,this))},getDefaultLink:function(t,e){return Jo(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},resolveHighlighter:function(t={}){let{highlighter:e,type:n}=t;const{highlighting:o,highlighterNamespace:l}=this.options;if(e===void 0){if(!o||n&&(e=o[n],e===!1))return!1;e||(e=o.default)}if(!e)return!1;mu(e)&&(e={name:e});const c=e.name,p=l[c];if(!p)throw new Error('Unknown highlighter ("'+c+'")');if(typeof p.highlight!="function")throw new Error('Highlighter ("'+c+'") is missing required highlight() method');if(typeof p.unhighlight!="function")throw new Error('Highlighter ("'+c+'") is missing required unhighlight() method');return{highlighter:p,options:e.options||{},name:c}},onCellHighlight:function(t,e,n){const o=this.resolveHighlighter(n);if(!o)return;const{highlighter:l,options:c}=o;l.highlight(t,e,c)},onCellUnhighlight:function(t,e,n){const o=this.resolveHighlighter(n);if(!o)return;const{highlighter:l,options:c}=o;l.unhighlight(t,e,c)},pointerdblclick:function(t){t.preventDefault(),t=cu(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.pointerdblclick(t,n.x,n.y):this.trigger("blank:pointerdblclick",t,n.x,n.y)}},pointerclick:function(t){var e=this.eventData(t);if(e.mousemoved<=this.options.clickThreshold){t=cu(t);var n=this.findView(t.target);if(this.guard(t,n))return;var o=this.snapToGrid(t.clientX,t.clientY);n?n.pointerclick(t,o.x,o.y):this.trigger("blank:pointerclick",t,o.x,o.y)}},contextmenu:function(t){if(this.options.preventContextMenu&&t.preventDefault(),this.contextMenuFired){this.contextMenuFired=!1;return}t=cu(t),this.contextMenuTrigger(t)},contextMenuTrigger:function(t){var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.contextmenu(t,n.x,n.y):this.trigger("blank:contextmenu",t,n.x,n.y)}},pointerdown:function(t){if(t=cu(t),t.button===2){this.contextMenuFired=!0;const o=lo.Event(t,{type:"contextmenu",data:t.data});this.contextMenuTrigger(o)}else{var e=this.findView(t.target);if(this.guard(t,e))return;var n=this.snapToGrid(t.clientX,t.clientY);e?(t.preventDefault(),e.pointerdown(t,n.x,n.y)):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.trigger("blank:pointerdown",t,n.x,n.y)),this.delegateDragEvents(e,t.data)}},pointermove:function(t){var e=this.eventData(t);e.mousemoved||(e.mousemoved=0,this.undelegateEvents());var n=++e.mousemoved;if(!(n<=this.options.moveThreshold)){t=cu(t);var o=this.snapToGrid(t.clientX,t.clientY),l=e.sourceView;l?l.pointermove(t,o.x,o.y):this.trigger("blank:pointermove",t,o.x,o.y),this.eventData(t,e)}},pointerup:function(t){this.undelegateDocumentEvents();var e=cu(t),n=this.snapToGrid(e.clientX,e.clientY),o=this.eventData(t).sourceView;o?o.pointerup(e,n.x,n.y):this.trigger("blank:pointerup",e,n.x,n.y),e.isPropagationStopped()||this.pointerclick(lo.Event(t,{type:"click",data:t.data})),t.stopImmediatePropagation(),this.delegateEvents()},mouseover:function(t){t=cu(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseover(t);else{if(this.el===t.target)return;this.trigger("blank:mouseover",t)}},mouseout:function(t){t=cu(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseout(t);else{if(this.el===t.target)return;this.trigger("blank:mouseout",t)}},mouseenter:function(t){t=cu(t);const{target:e,relatedTarget:n,currentTarget:o}=t,l=this.findView(e);if(this.guard(t,l))return;const c=this.findView(n);l&&(c===l||(l.mouseenter(t),this.el.contains(n)))||c||o===this.el&&this.trigger("paper:mouseenter",t)},mouseleave:function(t){t=cu(t);const{target:e,relatedTarget:n,currentTarget:o}=t,l=this.findView(e);if(this.guard(t,l))return;const c=this.findView(n);l&&(c===l||(l.mouseleave(t),this.el.contains(n)))||c||o===this.el&&this.trigger("paper:mouseleave",t)},_processMouseWheelEvtBuf:MO(function(){const{event:t,deltas:e}=this._mw_evt_buffer,n=e.reduce((p,r)=>p+bO(r,RR),0),o=Math.pow(.995,n),{x:l,y:c}=this.clientToLocalPoint(t.clientX,t.clientY);this.trigger("paper:pinch",t,l,c,o),this._mw_evt_buffer={event:null,deltas:[]}},qS,{maxWait:qS}),mousewheel:function(t){t=cu(t);const e=this.findView(t.target);if(this.guard(t,e))return;const n=t.originalEvent,o=this.snapToGrid(n.clientX,n.clientY),{deltaX:l,deltaY:c}=wO(n);if(t.ctrlKey){const p=this._events["paper:pinch"];p&&p.length>0&&(n.preventDefault(),this._mw_evt_buffer.event=n,this._mw_evt_buffer.deltas.push(c),this._processMouseWheelEvtBuf())}else{const p=Math.max(-1,Math.min(1,n.wheelDelta));e?e.mousewheel(t,o.x,o.y,p):this.trigger("blank:mousewheel",t,o.x,o.y,p),this.trigger("paper:pan",t,l,c)}},onevent:function(t){var e=t.currentTarget,n=e.getAttribute("event");if(n){var o=this.findView(e);if(o){if(t=cu(t),this.guard(t,o))return;var l=this.snapToGrid(t.clientX,t.clientY);o.onevent(t,n,l.x,l.y)}}},magnetEvent:function(t,e){var n=t.currentTarget,o=n.getAttribute("magnet");if(o){var l=this.findView(n);if(l){if(t=cu(t),this.guard(t,l))return;var c=this.snapToGrid(t.clientX,t.clientY);e.call(this,l,t,n,c.x,c.y)}}},onmagnet:function(t){if(t.button===2){this.contextMenuFired=!0,this.magnetContextMenuFired=!0;const e=lo.Event(t,{type:"contextmenu",data:t.data});this.magnetContextMenuTrigger(e),e.isPropagationStopped()&&t.stopPropagation()}else this.magnetEvent(t,function(e,n,o,l,c){e.onmagnet(n,l,c)})},magnetpointerdblclick:function(t){this.magnetEvent(t,function(e,n,o,l,c){e.magnetpointerdblclick(n,o,l,c)})},magnetcontextmenu:function(t){if(this.options.preventContextMenu&&t.preventDefault(),this.magnetContextMenuFired){this.magnetContextMenuFired=!1;return}this.magnetContextMenuTrigger(t)},magnetContextMenuTrigger:function(t){this.magnetEvent(t,function(e,n,o,l,c){e.magnetcontextmenu(n,o,l,c)})},onlabel:function(t){var e=t.currentTarget,n=this.findView(e);if(n){if(t=cu(t),this.guard(t,n))return;var o=this.snapToGrid(t.clientX,t.clientY);n.onlabel(t,o.x,o.y)}},getPointerArgs(t){const e=cu(t),{x:n,y:o}=this.snapToGrid(e.clientX,e.clientY);return[e,n,o]},delegateDragEvents:function(t,e){e||(e={}),this.eventData({data:e},{sourceView:t||null,mousemoved:0}),this.delegateDocumentEvents(null,e)},guard:function(t,e){return t.type==="mousedown"&&t.button===2||this.options.guard&&this.options.guard(t,e)?!0:t.data&&t.data.guarded!==void 0?t.data.guarded:!(e&&e.model&&e.model instanceof Oh||this.svg===t.target||this.el===t.target||lo.contains(this.svg,t.target))},setGridSize:function(t){return this.options.gridSize=t,this.options.drawGrid&&this.drawGrid(),this},clearGrid:function(){return this.$grid&&this.$grid.css("backgroundImage","none"),this},_getGridRefs:function(){return this._gridCache||(this._gridCache={root:yn("svg",{width:"100%",height:"100%"},yn("defs")),patterns:{},add:function(t,e){yn(this.root.node.childNodes[0]).append(e),this.patterns[t]=e,this.root.append(yn("rect",{width:"100%",height:"100%",fill:"url(#"+t+")"}))},get:function(t){return this.patterns[t]},exist:function(t){return this.patterns[t]!==void 0}}),this._gridCache},setGrid:function(t){this.clearGrid(),this._gridCache=null,this._gridSettings=[];var e=Array.isArray(t)?t:[t||{}];return e.forEach(function(n){this._gridSettings.push.apply(this._gridSettings,this._resolveDrawGridOption(n))},this),this},_resolveDrawGridOption:function(t){var e=this.constructor.gridPatterns;if(mu(t)&&Array.isArray(e[t]))return e[t].map(function(w){return Wi({},w)});var n=t||{args:[{}]},o=Array.isArray(n),l=n.name;if(!o&&!l&&!n.markup&&(l="dot"),l&&Array.isArray(e[l])){var c=e[l].map(function(w){return Wi({},w)}),p=Array.isArray(n.args)?n.args:[n.args||{}];Eh(p[0],Np(t,"args"));for(var r=0;r<p.length;r++)c[r]&&Wi(c[r],p[r]);return c}return o?n:[n]},drawGrid:function(t){var e=this.options.gridSize;if(e<=1)return this.clearGrid();var n=Array.isArray(t)?t:[t],o=this.matrix(),l=this._getGridRefs();this._gridSettings.forEach(function(p,r){var w="pattern_"+r,M=sl(p,n[r],{sx:o.a||1,sy:o.d||1,ox:o.e||0,oy:o.f||0});M.width=e*(o.a||1)*(M.scaleFactor||1),M.height=e*(o.d||1)*(M.scaleFactor||1),l.exist(w)||l.add(w,yn("pattern",{id:w,patternUnits:"userSpaceOnUse"},yn(M.markup)));var N=l.get(w);Jo(M.update)&&M.update(N.node.childNodes[0],M);var E=M.ox%M.width;E<0&&(E+=M.width);var Z=M.oy%M.height;Z<0&&(Z+=M.height),N.attr({x:E,y:Z,width:M.width,height:M.height})});var c=new XMLSerializer().serializeToString(l.root.node);return c="url(data:image/svg+xml;base64,"+btoa(c)+")",this.$grid.css("backgroundImage",c),this},updateBackgroundImage:function(t){t=t||{};var e=t.position||"center",n=t.size||"auto auto",o=this.scale(),l=this.translate();if(As(e)){var c=l.tx+o.sx*(e.x||0),p=l.ty+o.sy*(e.y||0);e=c+"px "+p+"px"}As(n)&&(n=new ai(n).scale(o.sx,o.sy),n=n.width+"px "+n.height+"px"),this.$background.css({backgroundSize:n,backgroundPosition:e})},drawBackgroundImage:function(t,e){if(!(t instanceof HTMLImageElement)){this.$background.css("backgroundImage","");return}if(!(!this._background||this._background.id!==e.id)){e=e||{};var n,o=e.size,l=e.repeat||"no-repeat",c=e.opacity||1,p=Math.abs(e.quality)||1,r=this.constructor.backgroundPatterns[zO(l)];if(Jo(r)){t.width*=p,t.height*=p;var w=r(t,e);if(!(w instanceof HTMLCanvasElement))throw new Error("dia.Paper: background pattern must return an HTML Canvas instance");n=w.toDataURL("image/png"),l="repeat",As(o)?(o.width*=w.width/t.width,o.height*=w.height/t.height):o===void 0&&(e.size={width:w.width/p,height:w.height/p})}else n=t.src,o===void 0&&(e.size={width:t.width,height:t.height});this.$background.css({opacity:c,backgroundRepeat:l,backgroundImage:"url("+n+")"}),this.updateBackgroundImage(e)}},updateBackgroundColor:function(t){this.$el.css("backgroundColor",t||"")},drawBackground:function(t){if(t=t||{},this.updateBackgroundColor(t.color),t.image){t=this._background=kc(t),sg(t);var e=document.createElement("img");e.onload=this.drawBackgroundImage.bind(this,e,t),e.src=t.image}else this.drawBackgroundImage(null),this._background=null;return this},setInteractivity:function(t){this.options.interactive=t,Ph(this._views,"setInteractivity",t)},isDefined:function(t){return!!this.svg.getElementById(t)},defineFilter:function(t){if(!As(t))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var e=t.id,n=t.name;if(e||(e=n+this.svg.id+i1(JSON.stringify(t))),!this.isDefined(e)){var o=EO,l=o[n]&&o[n](t.args||{});if(!l)throw new Error("Non-existing filter "+n);var c=Wi({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3},t.attrs,{id:e});yn(l,c).appendTo(this.defs)}return e},defineGradient:function(t){if(!As(t))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");const{svg:e,defs:n}=this,{type:o,id:l=o+e.id+i1(JSON.stringify(t)),stops:c,attrs:p={}}=t;if(this.isDefined(l))return l;const r=Ur(c).map(({offset:M,color:N,opacity:E})=>yn("stop").attr({offset:M,"stop-color":N,"stop-opacity":Number.isFinite(E)?E:1})),w=yn(o,p,r);return w.id=l,w.appendTo(n),l},definePattern:function(t){if(!As(t))throw new TypeError("dia.Paper: definePattern() requires 1. argument to be an object.");const{svg:e,defs:n}=this,{id:o=e.id+i1(JSON.stringify(t)),markup:l,attrs:c={}}=t;if(!l)throw new TypeError("dia.Paper: definePattern() requires markup.");if(this.isDefined(o))return o;const p=yn("pattern",{patternUnits:"userSpaceOnUse"});if(p.id=o,p.attr(c),typeof l=="string")p.append(yn(l));else{const{fragment:r}=ax(l);p.append(r)}return p.appendTo(n),o},defineMarker:function(t){if(!As(t))throw new TypeError("dia.Paper: defineMarker() requires 1. argument to be an object.");const{svg:e,defs:n}=this,{id:o=e.id+i1(JSON.stringify(t)),markup:l,attrs:c={},markerUnits:p="userSpaceOnUse"}=t;if(this.isDefined(o))return o;const r=yn("marker",{orient:"auto",overflow:"visible",markerUnits:p});if(r.id=o,r.attr(c),l)if(typeof l=="string")r.append(yn(l));else{const{fragment:w}=ax(l);r.append(w)}else{const{type:w="path"}=t,M=yn(w,Np(t,"type","id","markup","attrs","markerUnits"));r.append(M)}return r.appendTo(n),o}},{sorting:Ym,Layers:rh,backgroundPatterns:{flipXy:function(t){var e=document.createElement("canvas"),n=t.width,o=t.height;e.width=2*n,e.height=2*o;var l=e.getContext("2d");return l.drawImage(t,0,0,n,o),l.setTransform(-1,0,0,-1,e.width,e.height),l.drawImage(t,0,0,n,o),l.setTransform(-1,0,0,1,e.width,0),l.drawImage(t,0,0,n,o),l.setTransform(1,0,0,-1,0,e.height),l.drawImage(t,0,0,n,o),e},flipX:function(t){var e=document.createElement("canvas"),n=t.width,o=t.height;e.width=n*2,e.height=o;var l=e.getContext("2d");return l.drawImage(t,0,0,n,o),l.translate(2*n,0),l.scale(-1,1),l.drawImage(t,0,0,n,o),e},flipY:function(t){var e=document.createElement("canvas"),n=t.width,o=t.height;e.width=n,e.height=o*2;var l=e.getContext("2d");return l.drawImage(t,0,0,n,o),l.translate(0,2*o),l.scale(1,-1),l.drawImage(t,0,0,n,o),e},watermark:function(t,e){e=e||{};var n=t.width,o=t.height,l=document.createElement("canvas");l.width=n*3,l.height=o*3;for(var c=l.getContext("2d"),p=Du(e.watermarkAngle)?-e.watermarkAngle:-20,r=ju(p),w=l.width/4,M=l.height/4,N=0;N<4;N++)for(var E=0;E<4;E++)(N+E)%2>0&&(c.setTransform(1,0,0,1,(2*N-1)*w,(2*E-1)*M),c.rotate(r),c.drawImage(t,-n/2,-o/2,n,o));return l}},gridPatterns:{dot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){yn(t).attr({width:e.thickness*e.sx,height:e.thickness*e.sy,fill:e.color})}}],fixedDot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){var n=e.sx<=1?e.thickness*e.sx:e.thickness;yn(t).attr({width:n,height:n,fill:e.color})}}],mesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var n,o=e.width,l=e.height,c=e.thickness;o-c>=0&&l-c>=0?n=["M",o,0,"H0 M0 0 V0",l].join(" "):n="M 0 0 0 0",yn(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}],doubleMesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var n,o=e.width,l=e.height,c=e.thickness;o-c>=0&&l-c>=0?n=["M",o,0,"H0 M0 0 V0",l].join(" "):n="M 0 0 0 0",yn(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}},{color:"#000000",thickness:3,scaleFactor:4,markup:"path",update:function(t,e){var n,o=e.width,l=e.height,c=e.thickness;o-c>=0&&l-c>=0?n=["M",o,0,"H0 M0 0 V0",l].join(" "):n="M 0 0 0 0",yn(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}]}}),jk={_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")))}},addTest:function(t,e){return this._tests[t]=e},test:function(t){var e=this._tests[t];if(!e)throw new Error('Test not defined ("'+t+'"). Use `joint.env.addTest(name, fn) to add a new test.`');var n=this._results[t];if(typeof n<"u")return n;try{n=e()}catch{n=!1}return this._results[t]=n,n}},wo=Fs.define("basic.Generic",{attrs:{".":{fill:"#ffffff",stroke:"none"}}}),UR=wo.define("basic.Rect",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:100,height:60},text:{fill:"#000000",text:"","font-size":14,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>'}),GR=Ia.extend({presentationAttributes:Ia.addPresentationAttributes({attrs:["SCALE"]}),confirmUpdate:function(){var t=Ia.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"SCALE")&&(this.resize(),t=this.removeFlag(t,"SCALE")),t}}),ZR=wo.define("basic.Text",{attrs:{text:{"font-size":18,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><text/></g></g>'}),wA=wo.define("basic.Circle",{size:{width:60,height:60},attrs:{circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>'}),VR=wo.define("basic.Ellipse",{size:{width:60,height:40},attrs:{ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>'}),WR=wo.define("basic.Polygon",{size:{width:60,height:40},attrs:{polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),YR=wo.define("basic.Polyline",{size:{width:60,height:40},attrs:{polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>'}),XR=wo.define("basic.Image",{attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>'}),Uk=wo.define("basic.Path",{size:{width:60,height:60},attrs:{path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>'}),HR=Uk.define("basic.Rhombus",{attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"ref-dy":null,"y-alignment":"middle"}}}),hx=jk.test("svgforeignobject"),$R=wo.define("basic.TextBlock",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},{markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',hx?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>',"</g>"].join(""),initialize:function(){this.listenTo(this,"change:size",this.updateSize),this.listenTo(this,"change:content",this.updateContent),this.updateSize(this,this.get("size")),this.updateContent(this,this.get("content")),wo.prototype.initialize.apply(this,arguments)},updateSize:function(t,e){this.attr({".fobj":Wi({},e),div:{style:Wi({},e)}})},updateContent:function(t,e){hx?this.attr({".content":{html:AO(e)}}):this.attr({".content":{text:e}})},setForeignObjectSize:function(){this.updateSize.apply(this,arguments)},setDivContent:function(){this.updateContent.apply(this,arguments)}}),qR=Ia.extend({presentationAttributes:hx?Ia.prototype.presentationAttributes:Ia.addPresentationAttributes({content:["CONTENT"],size:["CONTENT"]}),initFlag:["RENDER","CONTENT"],confirmUpdate:function(){var t=Ia.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"CONTENT")&&(this.updateContent(this.model),t=this.removeFlag(t,"CONTENT")),t},update:function(t,e){var n=this.model;if(hx)Ia.prototype.update.call(this,n,e);else{var o=Np(e||n.get("attrs"),".content");Ia.prototype.update.call(this,n,o),(!e||mf(e,".content"))&&this.updateContent(n,e)}},updateContent:function(t,e){var n=sl({},(e||t.get("attrs"))[".content"]);n=Np(n,"text");var o=mk(t.get("content"),t.get("size"),n,{svgDocument:this.paper.svg}),l=VC({},".content",n,"/");l[".content"].text=o,Ia.prototype.update.call(this,t,l)}}),JR=Object.freeze(Object.defineProperty({__proto__:null,Circle:wA,Ellipse:VR,Generic:wo,Image:XR,Path:Uk,Polygon:WR,Polyline:YR,Rect:UR,Rhombus:HR,Text:ZR,TextBlock:$R,TextBlockView:qR,TextView:GR},Symbol.toStringTag,{value:"Module"})),Gk=Fs.define("standard.Rectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}]}),KR=Fs.define("standard.Circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]}),QR=Fs.define("standard.Ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]}),tB=Fs.define("standard.Path",{attrs:{body:{refD:"M 0 0 L 10 0 10 10 0 10 Z",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]}),eB=Fs.define("standard.Polygon",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"}]}),nB=Fs.define("standard.Polyline",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10 0 0",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polyline",selector:"body"},{tagName:"text",selector:"label"}]}),iB=Fs.define("standard.Image",{attrs:{image:{refWidth:"100%",refHeight:"100%"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),rB=Fs.define("standard.BorderedImage",{attrs:{border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#FFFFFF"},image:{refWidth:-1,refHeight:-1,x:.5,y:.5},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"background",attributes:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),oB=Fs.define("standard.EmbeddedImage",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"},label:{textVerticalAnchor:"top",textAnchor:"left",refX:"30%",refX2:20,refY:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),sB=Fs.define("standard.InscribedImage",{attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#FFFFFF"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),aB=Fs.define("standard.HeaderedRectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},headerText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:15,fontSize:16,fill:"#333333"},bodyText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}]});var BI=10;const lB=Fs.define("standard.Cylinder",{attrs:{body:{lateralArea:BI,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:BI,refRx:"50%",ry:BI,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"100%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){if(t===void 0)return this.attr("body/lateralArea");var n=Gu(t),o={lateralArea:t},l=n?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t};return this.attr({body:o,top:l},e)}},{attributes:{lateralArea:{set:function(t,e){var n=Gu(t);n&&(t=parseFloat(t)/100);var o=e.x,l=e.y,c=e.width,p=e.height,r=c/2,w=n?p*t:t,M=yn.KAPPA,N=M*r,E=M*(n?p*t:t),Z=o,Y=o+c/2,K=o+c,q=l+w,at=q-w,J=l+p-w,Q=l+p,lt=["M",Z,q,"L",Z,J,"C",o,J+E,Y-N,Q,Y,Q,"C",Y+N,Q,K,J+E,K,J,"L",K,q,"C",K,q-E,Y+N,at,Y,at,"C",Y-N,at,Z,q-E,Z,q,"Z"];return{d:lt.join(" ")}}}}});var uB={tagName:"foreignObject",selector:"foreignObject",attributes:{overflow:"hidden"},children:[{tagName:"div",namespaceURI:"http://www.w3.org/1999/xhtml",selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]},cB={tagName:"text",selector:"label",attributes:{"text-anchor":"middle"}},hB=jk.test("svgforeignobject")?uB:cB;const fB=Fs.define("standard.TextBlock",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#ffffff",strokeWidth:2},foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}}},{markup:[{tagName:"rect",selector:"body"},hB]},{attributes:{text:{set:function(t,e,n,o){if(n instanceof HTMLElement)n.textContent=t;else{var l=o.style||{},c={text:t,width:-5,height:"100%"},p=Wi({textVerticalAnchor:"middle"},l);return wk.textWrap.set.call(this,c,e,n,p),{fill:l.color||null}}},position:function(t,e,n){if(n instanceof SVGElement)return e.center()}}}}),Zk=cl.define("standard.Link",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),dB=cl.define("standard.DoubleLink",{attrs:{line:{connection:!0,stroke:"#DDDDDD",strokeWidth:4,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"outline",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]}),pB=cl.define("standard.ShadowLink",{attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}}}},{markup:[{tagName:"path",selector:"shadow",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]}),mB=Object.freeze(Object.defineProperty({__proto__:null,BorderedImage:rB,Circle:KR,Cylinder:lB,DoubleLink:dB,Ellipse:QR,EmbeddedImage:oB,HeaderedRectangle:aB,Image:iB,InscribedImage:sB,Link:Zk,Path:tB,Polygon:eB,Polyline:nB,Rectangle:Gk,ShadowLink:pB,TextBlock:fB},Symbol.toStringTag,{value:"Module"})),bA=wo.define("devs.Model",{inPorts:[],outPorts:[],size:{width:80,height:80},attrs:{".":{magnet:!1},".label":{text:"Model","ref-x":.5,"ref-y":10,"font-size":18,"text-anchor":"middle",fill:"#000"},".body":{"ref-width":"100%","ref-height":"100%",stroke:"#000"}},ports:{groups:{in:{position:{name:"left"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:!0}},label:{position:{name:"left",args:{y:10}}}},out:{position:{name:"right"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:!0}},label:{position:{name:"right",args:{y:10}}}}}}},{markup:'<g class="rotatable"><rect class="body"/><text class="label"/></g>',portMarkup:'<circle class="port-body"/>',portLabelMarkup:'<text class="port-label"/>',initialize:function(){wo.prototype.initialize.apply(this,arguments),this.on("change:inPorts change:outPorts",this.updatePortItems,this),this.updatePortItems()},updatePortItems:function(t,e,n){var o=Sg(this.get("inPorts")),l=vk(Sg(this.get("outPorts")),o),c=this.createPortItems("in",o),p=this.createPortItems("out",l);this.prop("ports/items",c.concat(p),Wi({rewrite:!0},n))},createPortItem:function(t,e){return{id:e,group:t,attrs:{".port-label":{text:e}}}},createPortItems:function(t,e){return Ur(e).map(this.createPortItem.bind(this,t))},_addGroupPort:function(t,e,n){var o=this.get(e);return this.set(e,Array.isArray(o)?o.concat(t):[t],n)},addOutPort:function(t,e){return this._addGroupPort(t,"outPorts",e)},addInPort:function(t,e){return this._addGroupPort(t,"inPorts",e)},_removeGroupPort:function(t,e,n){return this.set(e,XC(this.get(e),t),n)},removeOutPort:function(t,e){return this._removeGroupPort(t,"outPorts",e)},removeInPort:function(t,e){return this._removeGroupPort(t,"inPorts",e)},_changeGroup:function(t,e,n){return this.prop("ports/groups/"+t,As(e)?e:{},n)},changeInGroup:function(t,e){return this._changeGroup("in",t,e)},changeOutGroup:function(t,e){return this._changeGroup("out",t,e)}}),gB=bA.define("devs.Atomic",{size:{width:80,height:80},attrs:{".label":{text:"Atomic"}}}),_B=bA.define("devs.Coupled",{size:{width:200,height:300},attrs:{".label":{text:"Coupled"}}}),vB=cl.define("devs.Link",{attrs:{".connection":{"stroke-width":2}}}),yB=Object.freeze(Object.defineProperty({__proto__:null,Atomic:gB,Coupled:_B,Link:vB,Model:bA},Symbol.toStringTag,{value:"Module"})),nw=wo.define("logic.Gate",{size:{width:80,height:40},attrs:{".":{magnet:!1},".body":{width:100,height:50},circle:{r:7,stroke:"black",fill:"transparent","stroke-width":2}}},{operation:function(){return!0}}),IA=nw.define("logic.IO",{size:{width:60,height:30},attrs:{".body":{fill:"white",stroke:"black","stroke-width":2},".wire":{ref:".body","ref-y":.5,stroke:"black"},text:{fill:"black",ref:".body","ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle","font-weight":"bold","font-variant":"small-caps","text-transform":"capitalize","font-size":"14px"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><path class="wire"/><circle/><text/></g>'}),xB=IA.define("logic.Input",{attrs:{".wire":{"ref-dx":0,d:"M 0 0 L 23 0"},circle:{ref:".body","ref-dx":30,"ref-y":.5,magnet:!0,class:"output",port:"out"},text:{text:"input"}}}),wB=IA.define("logic.Output",{attrs:{".wire":{"ref-x":0,d:"M 0 0 L -23 0"},circle:{ref:".body","ref-x":-30,"ref-y":.5,magnet:"passive",class:"input",port:"in"},text:{text:"output"}}}),CA=nw.define("logic.Gate11",{attrs:{".input":{ref:".body","ref-x":-2,"ref-y":.5,magnet:"passive",port:"in"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input"/><circle class="output"/></g>'}),Up=nw.define("logic.Gate21",{attrs:{".input1":{ref:".body","ref-x":-2,"ref-y":.3,magnet:"passive",port:"in1"},".input2":{ref:".body","ref-x":-2,"ref-y":.7,magnet:"passive",port:"in2"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input input1"/><circle  class="input input2"/><circle class="output"/></g>'}),bB=CA.define("logic.Repeater",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t){return t}}),IB=CA.define("logic.Not",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t){return!t}}),CB=Up.define("logic.Or",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t,e){return t||e}}),AB=Up.define("logic.And",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return t&&e}}),TB=Up.define("logic.Nor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return!(t||e)}}),SB=Up.define("logic.Nand",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return!(t&&e)}}),EB=Up.define("logic.Xor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return(!t||e)&&(t||!e)}}),MB=Up.define("logic.Xnor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return(!t||!e)&&(t||e)}}),LB=cl.define("logic.Wire",{attrs:{".connection":{"stroke-width":2},".marker-vertex":{r:7}},router:{name:"orthogonal"},connector:{name:"rounded",args:{radius:10}}},{arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<circle class="marker-arrowhead" end="<%= end %>" r="7"/>',"</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<g class="marker-vertex-remove-group">','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>","</g>"].join("")}),kB=Object.freeze(Object.defineProperty({__proto__:null,And:AB,Gate:nw,Gate11:CA,Gate21:Up,IO:IA,Input:xB,Nand:SB,Nor:TB,Not:IB,Or:CB,Output:wB,Repeater:bB,Wire:LB,Xnor:MB,Xor:EB},Symbol.toStringTag,{value:"Module"})),PB=wo.define("chess.KingWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;"><path      d="M 22.5,11.63 L 22.5,6"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 20,8 L 25,8"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"      style="fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 11.5,30 C 17,27 27,27 32.5,30"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,37 C 17,34 27,34 32.5,37"      style="fill:none; stroke:#000000;" />  </g></g></g>'}),zB=wo.define("chess.KingBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path       d="M 22.5,11.63 L 22.5,6"       style="fill:none; stroke:#000000; stroke-linejoin:miter;"       id="path6570" />    <path       d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"       style="fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;" />    <path       d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "       style="fill:#000000; stroke:#000000;" />    <path       d="M 20,8 L 25,8"       style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path       d="M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'}),DB=wo.define("chess.QueenWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(-1,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(15.5,-5.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(32,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(7,-4.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(24,-4)" />    <path      d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 11.5,30 C 15,29 30,29 33.5,30"      style="fill:none;" />    <path      d="M 12,33.5 C 18,32.5 27,32.5 33,33.5"      style="fill:none;" />  </g></g></g>'}),NB=wo.define("chess.QueenBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:none;">      <circle cx="6"    cy="12" r="2.75" />      <circle cx="14"   cy="9"  r="2.75" />      <circle cx="22.5" cy="8"  r="2.75" />      <circle cx="31"   cy="9"  r="2.75" />      <circle cx="39"   cy="12" r="2.75" />    </g>    <path       d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"       style="stroke-linecap:butt; stroke:#000000;" />    <path       d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"       style="stroke-linecap:butt;" />    <path       d="M 11,38.5 A 35,35 1 0 0 34,38.5"       style="fill:none; stroke:#000000; stroke-linecap:butt;" />    <path       d="M 11,29 A 35,35 1 0 1 34,29"       style="fill:none; stroke:#ffffff;" />    <path       d="M 12.5,31.5 L 32.5,31.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'}),OB=wo.define("chess.RookWhite",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14"      style="stroke-linecap:butt;" />    <path      d="M 34,14 L 31,17 L 14,17 L 11,14" />    <path      d="M 31,17 L 31,29.5 L 14,29.5 L 14,17"      style="stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'}),RB=wo.define("chess.RookBlack",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z "      style="stroke-linecap:butt;stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z "      style="stroke-linecap:butt;" />    <path      d="M 12,35.5 L 33,35.5 L 33,35.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 13,31.5 L 32,31.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,29.5 L 31,29.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 31,16.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />  </g></g></g>'}),BB=wo.define("chess.BishopWhite",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#ffffff; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path      d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'}),FB=wo.define("chess.BishopBlack",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path       d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"       style="fill:none; stroke:#ffffff; stroke-linejoin:miter;" />  </g></g></g>'}),jB=wo.define("chess.KnightWhite",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#000000; stroke:#000000;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#000000; stroke:#000000;" />  </g></g></g>'}),UB=wo.define("chess.KnightBlack",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#000000; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#000000; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z "      style="fill:#ffffff; stroke:none;" />  </g></g></g>'}),GB=wo.define("chess.PawnWhite",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'}),ZB=wo.define("chess.PawnBlack",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'}),VB=Object.freeze(Object.defineProperty({__proto__:null,BishopBlack:FB,BishopWhite:BB,KingBlack:zB,KingWhite:PB,KnightBlack:UB,KnightWhite:jB,PawnBlack:ZB,PawnWhite:GB,QueenBlack:NB,QueenWhite:DB,RookBlack:RB,RookWhite:OB},Symbol.toStringTag,{value:"Module"})),Vk=Fs.define("erd.Entity",{size:{width:150,height:60},attrs:{".outer":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"100,0 100,60 0,60 0,0"},".inner":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"95,5 95,55 5,55 5,5",display:"none"},text:{text:"Entity","font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'}),WB=Vk.define("erd.WeakEntity",{attrs:{".inner":{display:"auto"},text:{text:"Weak Entity"}}}),Wk=Fs.define("erd.Relationship",{size:{width:80,height:80},attrs:{".outer":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,0 80,40 40,80 0,40"},".inner":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,5 75,40 40,75 5,40",display:"none"},text:{text:"Relationship","font-family":"Arial","font-size":12,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'}),YB=Wk.define("erd.IdentifyingRelationship",{attrs:{".inner":{display:"auto"},text:{text:"Identifying"}}}),uy=Fs.define("erd.Attribute",{size:{width:100,height:50},attrs:{ellipse:{transform:"translate(50, 25)"},".outer":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:50,ry:25,fill:"#E67E22"},".inner":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:45,ry:20,fill:"#E67E22",display:"none"},text:{"font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>'}),XB=uy.define("erd.Multivalued",{attrs:{".inner":{display:"block"},text:{text:"multivalued"}}}),HB=uy.define("erd.Derived",{attrs:{".outer":{"stroke-dasharray":"3,5"},text:{text:"derived"}}}),$B=uy.define("erd.Key",{attrs:{ellipse:{"stroke-width":4},text:{text:"key","font-weight":"800","text-decoration":"underline"}}}),qB=uy.define("erd.Normal",{attrs:{text:{text:"Normal"}}}),JB=Fs.define("erd.ISA",{type:"erd.ISA",size:{width:100,height:50},attrs:{polygon:{points:"0,0 50,50 100,0",fill:"#F1C40F",stroke:"#F39C12","stroke-width":2},text:{text:"ISA","font-size":18,"ref-x":.5,"ref-y":.3,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),KB=cl.define("erd.Line",{},{cardinality:function(t){this.set("labels",[{position:-20,attrs:{text:{dy:-8,text:t}}}])}}),QB=Object.freeze(Object.defineProperty({__proto__:null,Attribute:uy,Derived:HB,Entity:Vk,ISA:JB,IdentifyingRelationship:YB,Key:$B,Line:KB,Multivalued:XB,Normal:qB,Relationship:Wk,WeakEntity:WB},Symbol.toStringTag,{value:"Module"})),t4=wA.define("fsa.State",{attrs:{circle:{"stroke-width":3},text:{"font-weight":"800"}}}),e4=Fs.define("fsa.StartState",{size:{width:20,height:20},attrs:{circle:{transform:"translate(10, 10)",r:10,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g></g>'}),n4=Fs.define("fsa.EndState",{size:{width:20,height:20},attrs:{".outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#000000"},".inner":{transform:"translate(10, 10)",r:6,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'}),i4=cl.define("fsa.Arrow",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}},smooth:!0}),r4=Object.freeze(Object.defineProperty({__proto__:null,Arrow:i4,EndState:n4,StartState:e4,State:t4},Symbol.toStringTag,{value:"Module"})),o4=Fs.define("org.Member",{size:{width:180,height:70},attrs:{rect:{width:170,height:60},".card":{fill:"#FFFFFF",stroke:"#000000","stroke-width":2,"pointer-events":"visiblePainted",rx:10,ry:10},image:{width:48,height:48,ref:".card","ref-x":10,"ref-y":5},".rank":{"text-decoration":"underline",ref:".card","ref-x":.9,"ref-y":.2,"font-family":"Courier New","font-size":14,"text-anchor":"end"},".name":{"font-weight":"800",ref:".card","ref-x":.9,"ref-y":.6,"font-family":"Courier New","font-size":14,"text-anchor":"end"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="card"/><image/></g><text class="rank"/><text class="name"/></g>'}),s4=cl.define("org.Arrow",{source:{selector:".card"},target:{selector:".card"},attrs:{".connection":{stroke:"#585858","stroke-width":3}},z:-1}),a4=Object.freeze(Object.defineProperty({__proto__:null,Arrow:s4,Member:o4},Symbol.toStringTag,{value:"Module"})),l4=wo.define("pn.Place",{size:{width:50,height:50},attrs:{".root":{r:25,fill:"#ffffff",stroke:"#000000",transform:"translate(25, 25)"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:".root",fill:"#000000","font-size":12},".tokens > circle":{fill:"#000000",r:5},".tokens.one > circle":{transform:"translate(25, 25)"},".tokens.two > circle:nth-child(1)":{transform:"translate(19, 25)"},".tokens.two > circle:nth-child(2)":{transform:"translate(31, 25)"},".tokens.three > circle:nth-child(1)":{transform:"translate(18, 29)"},".tokens.three > circle:nth-child(2)":{transform:"translate(25, 19)"},".tokens.three > circle:nth-child(3)":{transform:"translate(32, 29)"},".tokens.alot > text":{transform:"translate(25, 18)","text-anchor":"middle",fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="root"/><g class="tokens" /></g><text class="label"/></g>'}),u4=Ia.extend({presentationAttributes:Ia.addPresentationAttributes({tokens:["TOKENS"]}),initFlag:Ia.prototype.initFlag.concat(["TOKENS"]),confirmUpdate:function(...t){let e=Ia.prototype.confirmUpdate.call(this,...t);return this.hasFlag(e,"TOKENS")&&(this.renderTokens(),this.update(),e=this.removeFlag(e,"TOKENS")),e},renderTokens:function(){const t=this.vel.findOne(".tokens").empty();["one","two","three","alot"].forEach(function(n){t.removeClass(n)});var e=this.model.get("tokens");if(e)switch(e){case 1:t.addClass("one"),t.append(yn("circle"));break;case 2:t.addClass("two"),t.append([yn("circle"),yn("circle")]);break;case 3:t.addClass("three"),t.append([yn("circle"),yn("circle"),yn("circle")]);break;default:t.addClass("alot"),t.append(yn("text").text(e+""));break}}}),c4=wo.define("pn.Transition",{size:{width:12,height:50},attrs:{rect:{width:12,height:50,fill:"#000000",stroke:"#000000"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:"rect",fill:"#000000","font-size":12}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="root"/></g></g><text class="label"/>'}),h4=cl.define("pn.Link",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}}}),f4=Object.freeze(Object.defineProperty({__proto__:null,Link:h4,Place:l4,PlaceView:u4,Transition:c4},Symbol.toStringTag,{value:"Module"})),AA=wo.define("uml.Class",{attrs:{rect:{width:200},".uml-class-name-rect":{stroke:"black","stroke-width":2,fill:"#3498db"},".uml-class-attrs-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-methods-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-name-text":{ref:".uml-class-name-rect","ref-y":.5,"ref-x":.5,"text-anchor":"middle","y-alignment":"middle","font-weight":"bold",fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-attrs-text":{ref:".uml-class-attrs-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-methods-text":{ref:".uml-class-methods-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"}},name:[],attributes:[],methods:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-class-name-rect"/><rect class="uml-class-attrs-rect"/><rect class="uml-class-methods-rect"/>',"</g>",'<text class="uml-class-name-text"/><text class="uml-class-attrs-text"/><text class="uml-class-methods-text"/>',"</g>"].join(""),initialize:function(){this.on("change:name change:attributes change:methods",function(){this.updateRectangles(),this.trigger("uml-update")},this),this.updateRectangles(),wo.prototype.initialize.apply(this,arguments)},getClassName:function(){return this.get("name")},updateRectangles:function(){var t=this.get("attrs"),e=[{type:"name",text:this.getClassName()},{type:"attrs",text:this.get("attributes")},{type:"methods",text:this.get("methods")}],n=0;e.forEach(function(o){var l=Array.isArray(o.text)?o.text:[o.text],c=l.length*20+20;t[".uml-class-"+o.type+"-text"].text=l.join(`
`),t[".uml-class-"+o.type+"-rect"].height=c,t[".uml-class-"+o.type+"-rect"].transform="translate(0,"+n+")",n+=c})}}),TA=Ia.extend({initialize:function(){Ia.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"uml-update",function(){this.update(),this.resize()})}}),d4=AA.define("uml.Abstract",{attrs:{".uml-class-name-rect":{fill:"#e74c3c"},".uml-class-attrs-rect":{fill:"#c0392b"},".uml-class-methods-rect":{fill:"#c0392b"}}},{getClassName:function(){return["<<Abstract>>",this.get("name")]}}),p4=TA,m4=AA.define("uml.Interface",{attrs:{".uml-class-name-rect":{fill:"#f1c40f"},".uml-class-attrs-rect":{fill:"#f39c12"},".uml-class-methods-rect":{fill:"#f39c12"}}},{getClassName:function(){return["<<Interface>>",this.get("name")]}}),g4=TA,_4=cl.define("uml.Generalization",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"}}}),v4=cl.define("uml.Implementation",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"},".connection":{"stroke-dasharray":"3,3"}}}),y4=cl.define("uml.Aggregation",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"white"}}}),x4=cl.define("uml.Composition",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"black"}}}),w4=cl.define("uml.Association"),b4=wo.define("uml.State",{attrs:{".uml-state-body":{width:200,height:200,rx:10,ry:10,fill:"#ecf0f1",stroke:"#bdc3c7","stroke-width":3},".uml-state-separator":{stroke:"#bdc3c7","stroke-width":2},".uml-state-name":{ref:".uml-state-body","ref-x":.5,"ref-y":5,"text-anchor":"middle",fill:"#000000","font-family":"Courier New","font-size":14},".uml-state-events":{ref:".uml-state-separator","ref-x":5,"ref-y":5,fill:"#000000","font-family":"Courier New","font-size":14}},name:"State",events:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-state-body"/>',"</g>",'<path class="uml-state-separator"/>','<text class="uml-state-name"/>','<text class="uml-state-events"/>',"</g>"].join(""),initialize:function(){this.on({"change:name":this.updateName,"change:events":this.updateEvents,"change:size":this.updatePath},this),this.updateName(),this.updateEvents(),this.updatePath(),wo.prototype.initialize.apply(this,arguments)},updateName:function(){this.attr(".uml-state-name/text",this.get("name"))},updateEvents:function(){this.attr(".uml-state-events/text",this.get("events").join(`
`))},updatePath:function(){var t="M 0 20 L "+this.get("size").width+" 20";this.attr(".uml-state-separator/d",t,{silent:!0})}}),I4=wA.define("uml.StartState",{type:"uml.StartState",attrs:{circle:{fill:"#34495e",stroke:"#2c3e50","stroke-width":2,rx:1}}}),C4=wo.define("uml.EndState",{size:{width:20,height:20},attrs:{"circle.outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#2c3e50"},"circle.inner":{transform:"translate(10, 10)",r:6,fill:"#34495e"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'}),A4=cl.define("uml.Transition",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#34495e",stroke:"#2c3e50"},".connection":{stroke:"#2c3e50"}}}),T4=Object.freeze(Object.defineProperty({__proto__:null,Abstract:d4,AbstractView:p4,Aggregation:y4,Association:w4,Class:AA,ClassView:TA,Composition:x4,EndState:C4,Generalization:_4,Implementation:v4,Interface:m4,InterfaceView:g4,StartState:I4,State:b4,Transition:A4},Symbol.toStringTag,{value:"Module"})),S4=Object.freeze(Object.defineProperty({__proto__:null,basic:JR,chess:VB,devs:yB,erd:QB,fsa:r4,logic:kB,org:a4,pn:f4,standard:mB,uml:T4},Symbol.toStringTag,{value:"Module"}));function E4(){const t=Jn.useRef(null);return Jn.useEffect(()=>{var e=S4,n=new _A({},{cellNamespace:e});new jR({el:t.current,model:n,width:300,height:300,cellViewNamespace:e});var o=new Gk;o.position(100,30),o.resize(100,40),o.attr({body:{fill:"blue"},label:{text:"Hello",fill:"white"}}),o.addTo(n);var l=o.clone();l.position(200,30),l.attr("label/text","World!"),l.addTo(n);var c=new Zk;c.source(o),c.target(l),c.addTo(n)},[]),In("div",{ref:t})}function M4({geojsonCtos:t}){return In(hh.Overlay,{name:"Caixas",checked:!0,children:In(cc,{children:t.features.map(e=>In(If,{data:e,style:()=>({color:"#000",weight:0}),pointToLayer:(n,o)=>ll.circle(o,{radius:8,fillColor:"blue",fillOpacity:.7}),children:In(Cf,{autoClose:!1,closeOnClick:!1,children:In(E4,{})})},e.id))})})}function L4({geojsonCabos:t}){return In(hh.Overlay,{name:"Cabos",checked:!0,children:In(cc,{children:t.features.map(e=>In(If,{data:e,style:()=>({color:"#00ff00",weight:4,opacity:.6}),children:In(Cf,{children:Ko(Ad,{children:[In("p",{style:{color:"#000"},children:e.properties.name}),Ko("p",{style:{color:"#000"},children:[Math.ceil(ex(e)),"m"]})]})})},e.id))})})}const FI={type:"FeatureCollection",features:[]};function k4({fileContent:t}){const e=Jn.useRef(null),n=Jn.useMemo(()=>new Yx,[]),[o,l]=Jn.useState(Wx(t)),[c,p]=Jn.useState(FI),[r,w]=Jn.useState(FI),[M,N]=Jn.useState(FI);Jn.useEffect(()=>{p(Z=>({...Z,features:o.features.filter(Y=>Y.properties.folderName==="Postes"&&Y.geometry.type==="Point")})),N(Z=>({...Z,features:o.features.filter(Y=>Y.properties.folderName==="Caixas"&&Y.geometry.type==="Point")})),w(Z=>({...Z,features:o.features.filter(Y=>Y.properties.folderName==="Cabos"&&Y.geometry.type==="LineString")}))},[o]);const E=()=>{n.changeMap(),e.current.setUrl(n.getUrl())};return Ko(UN,{zoomControl:!1,center:Vx(o),zoom:14,doubleClickZoom:!1,children:[In(Zx,{ref:e,attribution:n.getAttribution(),url:n.getUrl()}),In(hh,{position:"bottomleft",children:Ko(cc,{children:[In(L4,{geojsonCabos:r}),In(M4,{geojsonCtos:M}),In(GN,{geojsonPostes:c})]})}),In(Hx,{children:In(Xx,{changeMap:E})}),In($x,{})]})}function P4(){const[t,e]=Jn.useState(null),[n,o]=Jn.useState("app3"),[l,c]=Jn.useState(_N),p=Jn.useMemo(()=>In(Cz,{theme:l}),[]),r=Y=>o(Y),w=Y=>e(Y),M=()=>!t&&!n?In(ED,{handleAppSelected:r}):null,N=()=>!t&&n?In(AD,{handleFileContent:w,handleAppSelected:r,namefile:"projeto.kml"}):null,E=()=>!n||!t?p:null,Z=()=>{if(t&&n)switch(n){case"app1":return In(gN,{fileContent:t});case"app2":return In(bN,{fileContent:t});case"app3":return In(jN,{fileContent:t});case"app4":return In(k4,{fileContent:t})}return null};return Ko(yD,{theme:l,children:[N(),M(),Z(),E(),In(TD,{})]})}jI.createRoot(document.getElementById("root")).render(In(Aa.StrictMode,{children:In(P4,{})}));
